function cursorCss(n, t, i) {
    return i || (i = "light"), n = TradingView.wrapUrl("url(" + TradingView.resourceFullPath(i + "/" + n + ".cur") + ")"), $.browser.msie ? n + ", default" : n + " " + t + ", default"
}
function isInteger(n) {
    return"number" == typeof n && 0 == n % 1
}
function isNumber(n) {
    return"number" == typeof n && isFinite(n)
}
function parseBool(n) {
    return!0 === n || "true" === n
}
function isBoolean(n) {
    return!0 === n || !1 === n
}
function isString(n) {
    return null === n || void 0 === n ? !1 : n.constructor == String
}
function isFunction(n) {
    return null === n || void 0 === n ? !1 : n.constructor == Function
}
function inherit(n, t) {
    n.prototype = Object.create(t.prototype, {constructor: {value: n, enumerable: !1, writable: !0, configurable: !0}});
    n.prototype.superclass = t
}
function declareClassAsPureInterface(n, t) {
    for (var i in n.prototype)"function" == typeof n.prototype[i] && n.prototype.hasOwnProperty(i) && (n.prototype[i] = function () {
        throw t + "::" + i + " is an interface member declaration and must be overloaded in order to be called";
    })
}
function requireFullInterfaceImplementation(n, t, i, r) {
    for (var u in i.prototype)if ("function" == typeof i.prototype[u] && !n.prototype[u])throw"Interface implementation assertion failed: " + t + " does not implement " + r + "::" + u + " function";
}
function isInherited(n, t) {
    return n === t ? !0 : n && n.prototype ? void 0 === n.prototype.superclass || null === n.prototype.superclass ? !1 : n.prototype.superclass === t ? !0 : isInherited(n.prototype.superclass, t) : !1
}
function TypeValidator(n) {
    this.m_type = n
}
function PredicateValidator(n) {
    this.m_predicate = n
}
function OrderedHash(n, t) {
    this.array = [];
    for (var i in n)n[i].key = i, this.array.push(n[i]);
    this.rearrange(t)
}
function List(n) {
    if (void 0 == n)this.m_values = []; else if (isArray(n))this.m_values = n; else throw new TypeError("invalid values");
    this.m_validator = null
}
function loadScript(n) {
    function u() {
        i.reject()
    }

    function t() {
        var f, n;
        if (r.length) {
            if (f = r.shift(), null == f)return t();
            n = document.createElement("script");
            n.addEventListener("load", t, !0);
            n.addEventListener("error", u, !0);
            n.async = !0;
            n.defer = !0;
            n.src = f;
            document.body.appendChild(n)
        } else i.resolve()
    }

    var i = $.Deferred(), r = [].concat(n);
    return t(), i.promise()
}
function Delegate() {
    this._listeners = new List
}
function RGBColor(n) {
    var i, t, u, r;
    this.ok = !1;
    "#" == n.charAt(0) && (n = n.substr(1, 6));
    n = n.replace(/ /g, "");
    n = n.toLowerCase();
    i = {aliceblue: "f0f8ff", antiquewhite: "faebd7", aqua: "00ffff", aquamarine: "7fffd4", azure: "f0ffff", beige: "f5f5dc", bisque: "ffe4c4", black: "000000", blanchedalmond: "ffebcd", blue: "0000ff", blueviolet: "8a2be2", brown: "a52a2a", burlywood: "deb887", cadetblue: "5f9ea0", chartreuse: "7fff00", chocolate: "d2691e", coral: "ff7f50", cornflowerblue: "6495ed", cornsilk: "fff8dc", crimson: "dc143c", cyan: "00ffff", darkblue: "00008b", darkcyan: "008b8b", darkgoldenrod: "b8860b", darkgray: "a9a9a9", darkgreen: "006400", darkkhaki: "bdb76b", darkmagenta: "8b008b", darkolivegreen: "556b2f", darkorange: "ff8c00", darkorchid: "9932cc", darkred: "8b0000", darksalmon: "e9967a", darkseagreen: "8fbc8f", darkslateblue: "483d8b", darkslategray: "2f4f4f", darkturquoise: "00ced1", darkviolet: "9400d3", deeppink: "ff1493", deepskyblue: "00bfff", dimgray: "696969", dodgerblue: "1e90ff", feldspar: "d19275", firebrick: "b22222", floralwhite: "fffaf0", forestgreen: "228b22", fuchsia: "ff00ff", gainsboro: "dcdcdc", ghostwhite: "f8f8ff", gold: "ffd700", goldenrod: "daa520", gray: "808080", green: "008000", greenyellow: "adff2f", honeydew: "f0fff0", hotpink: "ff69b4", indianred: "cd5c5c", indigo: "4b0082", ivory: "fffff0", khaki: "f0e68c", lavender: "e6e6fa", lavenderblush: "fff0f5", lawngreen: "7cfc00", lemonchiffon: "fffacd", lightblue: "add8e6", lightcoral: "f08080", lightcyan: "e0ffff", lightgoldenrodyellow: "fafad2", lightgrey: "d3d3d3", lightgreen: "90ee90", lightpink: "ffb6c1", lightsalmon: "ffa07a", lightseagreen: "20b2aa", lightskyblue: "87cefa", lightslateblue: "8470ff", lightslategray: "778899", lightsteelblue: "b0c4de", lightyellow: "ffffe0", lime: "00ff00", limegreen: "32cd32", linen: "faf0e6", magenta: "ff00ff", maroon: "800000", mediumaquamarine: "66cdaa", mediumblue: "0000cd", mediumorchid: "ba55d3", mediumpurple: "9370d8", mediumseagreen: "3cb371", mediumslateblue: "7b68ee", mediumspringgreen: "00fa9a", mediumturquoise: "48d1cc", mediumvioletred: "c71585", midnightblue: "191970", mintcream: "f5fffa", mistyrose: "ffe4e1", moccasin: "ffe4b5", navajowhite: "ffdead", navy: "000080", oldlace: "fdf5e6", olive: "808000", olivedrab: "6b8e23", orange: "ffa500", orangered: "ff4500", orchid: "da70d6", palegoldenrod: "eee8aa", palegreen: "98fb98", paleturquoise: "afeeee", palevioletred: "d87093", papayawhip: "ffefd5", peachpuff: "ffdab9", peru: "cd853f", pink: "ffc0cb", plum: "dda0dd", powderblue: "b0e0e6", purple: "800080", red: "ff0000", rosybrown: "bc8f8f", royalblue: "4169e1", saddlebrown: "8b4513", salmon: "fa8072", sandybrown: "f4a460", seagreen: "2e8b57", seashell: "fff5ee", sienna: "a0522d", silver: "c0c0c0", skyblue: "87ceeb", slateblue: "6a5acd", slategray: "708090", snow: "fffafa", springgreen: "00ff7f", steelblue: "4682b4", tan: "d2b48c", teal: "008080", thistle: "d8bfd8", tomato: "ff6347", turquoise: "40e0d0", violet: "ee82ee", violetred: "d02090", wheat: "f5deb3", white: "ffffff", whitesmoke: "f5f5f5", yellow: "ffff00", yellowgreen: "9acd32"};
    for (t in i)n == t && (n = i[t]);
    for (i = [
        {re: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/, example: ["rgb(123, 234, 45)", "rgb(255,234,245)"], process: function (n) {
            return[parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3], 10)]
        }},
        {re: /^(\w{2})(\w{2})(\w{2})$/, example: ["#00ff00", "336699"], process: function (n) {
            return[parseInt(n[1], 16), parseInt(n[2], 16), parseInt(n[3], 16)]
        }},
        {re: /^(\w{1})(\w{1})(\w{1})$/, example: ["#fb0", "f0f"], process: function (n) {
            return[parseInt(n[1] + n[1], 16), parseInt(n[2] + n[2], 16), parseInt(n[3] + n[3], 16)]
        }}
    ], t = 0; t < i.length; t++)u = i[t].process, r = i[t].re.exec(n), r && (channels = u(r), this.r = channels[0], this.g = channels[1], this.b = channels[2], this.ok = !0);
    this.cleanupRGB = function () {
        this.r = 0 > this.r || isNaN(this.r) ? 0 : 255 < this.r ? 255 : this.r;
        this.g = 0 > this.g || isNaN(this.g) ? 0 : 255 < this.g ? 255 : this.g;
        this.b = 0 > this.b || isNaN(this.b) ? 0 : 255 < this.b ? 255 : this.b
    };
    this.cleanupRGB();
    this.toRGB = function () {
        return"rgb(" + this.r + ", " + this.g + ", " + this.b + ")"
    };
    this.toHex = function () {
        var n = this.r.toString(16), t = this.g.toString(16), i = this.b.toString(16);
        return 1 == n.length && (n = "0" + n), 1 == t.length && (t = "0" + t), 1 == i.length && (i = "0" + i), "#" + n + t + i
    };
    this.grayChannel = function () {
        var n = [.199, .687, .114];
        return n[0] * this.r + n[1] * this.g + n[2] * this.b
    };
    this.blackWhiteContrast = function () {
        return 150 > this.grayChannel() ? "white" : "black"
    };
    this.darken = function (n) {
        var t = TradingView.rgbToHsl(this.r, this.g, this.b);
        return n = TradingView.hslToRgb(t[0], t[1], t[2] - n / 100), this.r = n[0], this.g = n[1], this.b = n[2], this.cleanupRGB(), this
    }
}
function PixelSet(n, t, i) {
    this._rawData = n ? n : Array(t * i * 4);
    this._width = t;
    this._height = i
}
function ReadonlyWatchedValue() {
}
function WatchedValue(n) {
    if (!(this instanceof WatchedValue))return new WatchedValue(n);
    0 < arguments.length && (this._value = n);
    this._listeners = []
}
function HandlerInfo(n, t) {
    this.handler = n;
    this.customId = t;
    this.requestHook = null
}
function J98() {
}
function ChartSession(n, t) {
    this._chartApi = n;
    this._sessionid = "cs_" + TradingView.randomHash();
    this._sessionDisabled = !1;
    this._disableStatistics = !!t
}
function TimeIndexes() {
    this._zoffset = 0;
    this._items = [];
    this._lastTimePointIndex = null
}
function PlotList(n) {
    this._items = [];
    this._columns = n ? n : [];
    this._end = this._start = 0;
    this._shareread = !1
}
function StudyMetaInfo(n) {
    TradingView.merge(this, {palettes: {}, inputs: [], plots: [], graphics: {}, defaults: {}});
    TradingView.merge(this, n);
    TradingView.merge(this, StudyMetaInfo.parseIdString(n.id));
    this.name = this.id
}
function HitTestResult(n, t, i) {
    this._result = n;
    this._data = t;
    this._eraseMarker = i
}
function DataSource() {
    this._zorder = 0;
    this.m_priceScale = null;
    this._id = TradingView.guid();
    this._ownerSource = null;
    this._userEditEnabled = !0
}
function PriceDataSource() {
    DataSource.call(this);
    this._isOverlay = null
}
function Property(n) {
    if (this._listeners = new Delegate, this._childs = [], void 0 !== n && null !== n)if (this.isPrimitiveType(n))this._value = n; else for (var t in n)this.addProperty(t, n[t])
}
function _52(n, t, i) {
    this._defaultName = n;
    i ? i = t : (i = TradingView.clone(defaults(n)), t && TradingView.merge(i, t));
    Property.call(this, i);
    this._defaultName = n;
    this.listeners().subscribe(this, _52.prototype.onPropertyChanged);
    this._exclusions = []
}
function factoryDefaults(n) {
    "undefined" == typeof defaultProperties && (defaultProperties = {chartproperties: {timezone: "UTC", timeScale: {barSpacing: DEFAULT_BAR_SPACING, rightOffset: DEFAULT_RIGHT_OFFSET}, dataWindowProperties: {background: "#FFFECE", border: "#606090", font: "Verdana", fontBold: !1, fontItalic: !1, fontSize: 10, transparency: 80, visible: !0}, paneProperties: {background: "#ffffff", gridProperties: {color: "#E6E6E6", style: CanvasEx.LINESTYLE_SOLID}, crossHairProperties: {color: "#B7B7B7", style: CanvasEx.LINESTYLE_DASHED, transparency: 0, width: 1}, topMargin: 5, bottomMargin: 5, leftAxisProperties: {autoScale: !0, autoScaleDisabled: !1, percentage: !1, percentageDisabled: !1, log: !1, logDisabled: !1, showSymbolLabels: !1, alignLabels: !0}, rightAxisProperties: {autoScale: !0, autoScaleDisabled: !1, percentage: !1, percentageDisabled: !1, log: !1, logDisabled: !1, showSymbolLabels: !1, alignLabels: !0}, overlayPropreties: {autoScale: !0, autoScaleDisabled: !1, percentage: !1, percentageDisabled: !1, log: !1, logDisabled: !1, showSymbolLabels: !1, alignLabels: !0}}, scalesProperties: {showLeftScale: !1, showRightScale: !0, backgroundColor: "#ffffff", lineColor: "#555", textColor: "#555", scaleSeriesOnly: !1}, mainSeriesProperties: {style: TradingView.Series.STYLE_CANDLES, esdShowDividends: !0, esdShowSplits: !0, esdShowEarnings: !0, esdShowBreaks: !1, esdBreaksStyle: {color: "#E2745B", style: CanvasEx.LINESTYLE_DASHED, width: 1}, esdFlagSize: 2, showCountdown: !0, showInDataWindow: !0, showLastValue: !0, visible: !0, silentIntervalChange: !1, showPriceLine: !0, priceLineWidth: 1, lockScale: !1, minTick: "default", extendedHours: !1, sessVis: !1, candleStyle: {upColor: "#6ba583", downColor: "#d75442", drawWick: !0, drawBorder: !0, borderColor: "#378658", borderUpColor: "#225437", borderDownColor: "#5b1a13", wickColor: "#737375", barColorsOnPrevClose: !1}, hollowCandleStyle: {upColor: "#6ba583", downColor: "#d75442", drawWick: !0, drawBorder: !0, borderColor: "#378658", borderUpColor: "#225437", borderDownColor: "#5b1a13", wickColor: "#737375"}, haStyle: {upColor: "#6ba583", downColor: "#d75442", drawWick: !0, drawBorder: !0, borderColor: "#378658", borderUpColor: "#225437", borderDownColor: "#5b1a13", wickColor: "#737375", barColorsOnPrevClose: !1}, barStyle: {upColor: "#6ba583", downColor: "#d75442", barColorsOnPrevClose: !1, dontDrawOpen: !1}, lineStyle: {color: "#3C78D8", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, priceSource: "close", styleType: TradingView.Series.STYLE_LINE_TYPE_SIMPLE}, areaStyle: {color1: "#606090", color2: "#01F6F5", linecolor: "#0094FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, priceSource: "close", transparency: 50}, priceAxisProperties: {autoScale: !0, autoScaleDisabled: !1, percentage: !1, percentageDisabled: !1, log: !1, logDisabled: !1}, renkoStyle: {upColor: "#6ba583", downColor: "#d75442", borderUpColor: "#225437", borderDownColor: "#5b1a13", upColorProjection: "#4ad6be", downColorProjection: "#d649cf", borderUpColorProjection: "#225437", borderDownColorProjection: "#5b1a13", inputs: {source: "close", boxSize: 3, style: "ATR", atrLength: 14}, inputInfo: {source: {name: "Source"}, boxSize: {name: "Box size"}, style: {name: "Style"}, atrLength: {name: "ATR Length"}}}, pbStyle: {upColor: "#6ba583", downColor: "#d75442", borderUpColor: "#225437", borderDownColor: "#5b1a13", upColorProjection: "#4ad6be", downColorProjection: "#d649cf", borderUpColorProjection: "#225437", borderDownColorProjection: "#5b1a13", inputs: {source: "close", lb: 3}, inputInfo: {source: {name: "Source"}, lb: {name: "Number of line"}}}, kagiStyle: {upColor: "#6ba583", downColor: "#d75442", upColorProjection: "#4ad6be", downColorProjection: "#d649cf", inputs: {source: "close", reversalAmount: 1}, inputInfo: {source: {name: "Source"}, reversalAmount: {name: "Reversal amount"}}}, pnfStyle: {upColor: "#6ba583", downColor: "#d75442", upColorProjection: "#4ad6be", downColorProjection: "#d649cf", inputs: {sources: "HL", reversalAmount: 3, boxSize: 1, style: "ATR", atrLength: 14}, inputInfo: {sources: {name: "Source"}, boxSize: {name: "Box size"}, reversalAmount: {name: "Reversal amount"}, style: {name: "Style"}, atrLength: {name: "ATR Length"}}}}, symbolWatermarkProperties: {color: "#555", transparency: 85}, tradingProperties: {showPositions: !0, showOrders: !0, showExecutions: !0, extendLeft: !0, lineLength: 5, lineWidth: 1, lineStyle: CanvasEx.LINESTYLE_DASHED}, alertsProperties: {labels: {visible: !0, color: "#d75442", highlightColor: "#ffff33", hoverColor: "#f5e387", line: {visible: !0, style: CanvasEx.LINESTYLE_DASHED, width: 1}}, fakeLabels: {visible: !0, color: "#777", line: {visible: !0, style: CanvasEx.LINESTYLE_DASHED, width: 1}}}, editorFontsList: ["Verdana", "Courier New", "Times New Roman", "Arial"], volumePaneSize: "large"}, drawings: {magnet: !1, stayInDrawingMode: !1, crossHairColor: "#B7B7B7", crossHairStyle: CanvasEx.LINESTYLE_DASHED, crossHairWidth: 1}, linetoolorder: {extendLeft: "inherit", lineLength: "inherit", lineColor: "#F00", lineTransparency: 0, lineStyle: "inherit", lineWidth: "inherit", bodyBorderColor: "#F00", bodyBorderTransparency: 0, bodyBackgroundColor: "#FFF", bodyBackgroundTransparency: 25, bodyTextColor: "#F00", bodyTextTransparency: 0, bodyFontFamily: "Verdana", bodyFontSize: 7, bodyFontBold: !0, bodyFontItalic: !1, quantityBorderColor: "#F00", quantityBorderTransparency: 0, quantityBackgroundColor: "#F00", quantityBackgroundTransparency: 25, quantityTextColor: "#FFF", quantityTextTransparency: 0, quantityFontFamily: "Verdana", quantityFontSize: 7, quantityFontBold: !0, quantityFontItalic: !1, cancelButtonBorderColor: "#F00", cancelButtonBorderTransparency: 0, cancelButtonBackgroundColor: "#FFF", cancelButtonBackgroundTransparency: 25, cancelButtonIconColor: "#F00", cancelButtonIconTransparency: 0}, linetoolposition: {extendLeft: "inherit", lineLength: "inherit", lineColor: "#0071E0", lineTransparency: 0, lineStyle: "inherit", lineWidth: "inherit", bodyBorderColor: "#0071E0", bodyBorderTransparency: 0, bodyBackgroundColor: "#FFF", bodyBackgroundTransparency: 25, bodyTextColor: "#0071E0", bodyTextTransparency: 0, bodyFontFamily: "Verdana", bodyFontSize: 7, bodyFontBold: !0, bodyFontItalic: !1, quantityBorderColor: "#0071E0", quantityBorderTransparency: 0, quantityBackgroundColor: "#0071E0", quantityBackgroundTransparency: 25, quantityTextColor: "#FFF", quantityTextTransparency: 0, quantityFontFamily: "Verdana", quantityFontSize: 7, quantityFontBold: !0, quantityFontItalic: !1, reverseButtonBorderColor: "#0071E0", reverseButtonBorderTransparency: 0, reverseButtonBackgroundColor: "#FFF", reverseButtonBackgroundTransparency: 25, reverseButtonIconColor: "#0071E0", reverseButtonIconTransparency: 0, closeButtonBorderColor: "#0071E0", closeButtonBorderTransparency: 0, closeButtonBackgroundColor: "#FFF", closeButtonBackgroundTransparency: 25, closeButtonIconColor: "#0071E0", closeButtonIconTransparency: 0}, linetoolexecution: {direction: "buy", arrowHeight: 8, arrowSpacing: 1, arrowColor: "#00F", arrowTransparency: 0, text: "", textColor: "#000", textTransparency: 0, fontFamily: "Verdana", fontSize: 8, fontBold: !1, fontItalic: !1, tooltip: ""}, linetoolicon: {clonable: !0, color: "#3D85C6", snapTo45Degrees: !0, size: 40, icon: 9786, angle: .5 * Math.PI, scale: 1}, linetooltrendline: {clonable: !0, linecolor: "#159980", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendLeft: !1, extendRight: !1, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_NORMAL, font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, snapTo45Degrees: !0, alwaysShowStats: !1, showPriceRange: !1, showBarsRange: !1, showDateTimeRange: !1, showDistance: !1, showAngle: !1}, linetooltrendangle: {clonable: !0, linecolor: "#159980", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, snapTo45Degrees: !0, font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !0, italic: !1, alwaysShowStats: !1, showPriceRange: !1, showBarsRange: !1, extendRight: !1, extendLeft: !1}, linetooldisjointangle: {clonable: !0, linecolor: "#129f5c", linewidth: 2, linestyle: CanvasEx.LINESTYLE_SOLID, fillBackground: !0, backgroundColor: "#6AA84F", transparency: 50, extendLeft: !1, extendRight: !1, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_NORMAL, font: "Verdana", textcolor: "#129f5c", fontsize: 12, bold: !1, italic: !1, showPrices: !1, showPriceRange: !1, showDateTimeRange: !1, showBarsRange: !1}, linetoolflatbottom: {clonable: !0, linecolor: "#4985e7", linewidth: 2, linestyle: CanvasEx.LINESTYLE_SOLID, fillBackground: !0, backgroundColor: "#153899", transparency: 50, extendLeft: !1, extendRight: !1, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_NORMAL, font: "Verdana", textcolor: "#4985e7", fontsize: 12, bold: !1, italic: !1, showPrices: !1, showPriceRange: !1, showDateTimeRange: !1, showBarsRange: !1}, linetoolfibspiral: {clonable: !0, linecolor: "#159980", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, linetooldaterange: {clonable: !0, linecolor: "#585858", linewidth: 1, font: "Verdana", textcolor: "#FFFFFF", fontsize: 12, fillLabelBackground: !0, labelBackgroundColor: "#585858", labelBackgroundTransparency: 0, fillBackground: !0, backgroundColor: "#BADAFF", backgroundTransparency: 60, drawBorder: !1, borderColor: "#667B8B"}, linetoolpricerange: {clonable: !0, linecolor: "#585858", linewidth: 1, font: "Verdana", textcolor: "#FFFFFF", fontsize: 12, fillLabelBackground: !0, labelBackgroundColor: "#585858", labelBackgroundTransparency: 0, fillBackground: !0, backgroundColor: "#BADAFF", backgroundTransparency: 60, drawBorder: !1, borderColor: "#667B8B"}, linetoolriskrewardshort: {isShort: !0, clonable: !0, linecolor: "#585858", linewidth: 1, font: "Verdana", textcolor: "white", fontsize: 12, fillLabelBackground: !0, labelBackgroundColor: "#585858", labelBackgroundTransparency: 0, fillBackground: !0, stopBackground: "#FF0000", profitBackground: "#00A000", stopBackgroundTransparency: 80, profitBackgroundTransparency: 80, drawBorder: !1, borderColor: "#667B8B"}, linetoolriskrewardlong: {isShort: !1, clonable: !0, linecolor: "#585858", linewidth: 1, font: "Verdana", textcolor: "white", fontsize: 12, fillLabelBackground: !0, labelBackgroundColor: "#585858", labelBackgroundTransparency: 0, fillBackground: !0, stopBackground: "#FF0000", profitBackground: "#00A000", stopBackgroundTransparency: 80, profitBackgroundTransparency: 80, drawBorder: !1, borderColor: "#667B8B"}, linetoolarrow: {clonable: !0, linecolor: "#6F88C6", linewidth: 2, linestyle: CanvasEx.LINESTYLE_SOLID, extendLeft: !1, extendRight: !1, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_ARROW, font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, alwaysShowStats: !1, showPriceRange: !1, showBarsRange: !1, showDateTimeRange: !1, showDistance: !1, showAngle: !1}, linetoolray: {clonable: !0, linecolor: "#159980", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendLeft: !1, extendRight: !0, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_NORMAL, font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, alwaysShowStats: !1, showPriceRange: !1, showBarsRange: !1, showDateTimeRange: !1, showDistance: !1, showAngle: !1}, linetoolextended: {clonable: !0, linecolor: "#159980", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendLeft: !0, extendRight: !0, leftEnd: J47.LINEEND_NORMAL, rightEnd: J47.LINEEND_NORMAL, font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, alwaysShowStats: !1, showPriceRange: !1, showBarsRange: !1, showDateTimeRange: !1, showDistance: !1, showAngle: !1}, linetoolhorzline: {clonable: !0, linecolor: "#80CCDB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, showPrice: !0, showLabel: !1, text: "", font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, horzLabelsAlign: "center", vertLabelsAlign: "top"}, linetoolhorzray: {clonable: !0, linecolor: "#80CCDB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, showPrice: !0, showLabel: !1, text: "", font: "Verdana", textcolor: "#157760", fontsize: 12, bold: !1, italic: !1, horzLabelsAlign: "center", vertLabelsAlign: "top"}, linetoolvertline: {clonable: !0, linecolor: "#80CCDB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, showTime: !0}, linetoolcirclelines: {clonable: !0, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, linecolor: "#80CCDB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, linetoolfibtimezone: {horzLabelsAlign: "right", vertLabelsAlign: "bottom", clonable: !0, baselinecolor: "#808080", linecolor: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, showLabels: !0, font: "Verdana", fillBackground: !1, transparency: 80, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 0}, level2: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level3: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}, level4: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3}, level5: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 5}, level6: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 8}, level7: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 13}, level8: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 21}, level9: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 34}, level10: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 55}, level11: {visible: !0, color: "#0055DB", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 89}}, linetooltext: {clonable: !0, color: "#667B8B", text: $.t("Text"), font: "Verdana", fontsize: 20, fillBackground: !1, backgroundColor: "#9BBED5", backgroundTransparency: 70, drawBorder: !1, borderColor: "#667B8B", bold: !1, italic: !1, locked: !1, fixedSize: !0, wordWrap: !1, wordWrapWidth: 400}, linetooltextabsolute: {clonable: !0, color: "#667B8B", text: $.t("Text"), font: "Verdana", fontsize: 20, fillBackground: !1, backgroundColor: "#9BBED5", backgroundTransparency: 70, drawBorder: !1, borderColor: "#667B8B", bold: !1, italic: !1, locked: !0, wordWrap: !1, wordWrapWidth: 400}, linetoolballoon: {clonable: !0, color: "#667b8b", backgroundColor: "#fffece", borderColor: "#8c8c8c", fontWeight: "bold", fontsize: 12, font: "Arial", transparency: 30, text: $.t("Comment")}, linetoolbrush: {clonable: !0, linecolor: "#353535", linewidth: 2, linestyle: CanvasEx.LINESTYLE_SOLID, smooth: 5, fillBackground: !1, backgroundColor: "#153899", transparency: 50}, linetoolpolyline: {clonable: !0, linecolor: "#353535", linewidth: 2, linestyle: CanvasEx.LINESTYLE_SOLID, fillBackground: !0, backgroundColor: "#153899", transparency: 50, filled: !1}, linetoolarrowmark: {clonable: !0, color: "#787878", text: "", fontsize: 20, font: "Verdana"}, linetoolarrowmarkleft: {clonable: !0, color: "#787878", text: "", fontsize: 20, font: "Verdana"}, linetoolarrowmarkup: {clonable: !0, color: "#787878", text: "", fontsize: 20, font: "Verdana"}, linetoolarrowmarkright: {clonable: !0, color: "#787878", text: "", fontsize: 20, font: "Verdana"}, linetoolarrowmarkdown: {clonable: !0, color: "#787878", text: "", fontsize: 20, font: "Verdana"}, linetoolflagmark: {clonable: !0, color: "#ff0000"}, linetoolnote: {clonable: !0, markerColor: "#2E66FF", textColor: "#000000", backgroundColor: "#FFFFFF", backgroundTransparency: 0, text: $.t("Text"), font: "Arial", fontSize: 12, bold: !1, italic: !1, locked: !1, fixedSize: !0}, linetoolnoteabsolute: {clonable: !0, markerColor: "#2E66FF", textColor: "#000000", backgroundColor: "#FFFFFF", backgroundTransparency: 0, text: $.t("Text"), font: "Arial", fontSize: 12, bold: !1, italic: !1, locked: !0, fixedSize: !0}, linetoolthumbup: {clonable: !0, color: "#008000"}, linetoolthumbdown: {clonable: !0, color: "#FF0000"}, linetoolpricelabel: {clonable: !0, color: "#667b8b", backgroundColor: "#ffffff", borderColor: "#8c8c8c", fontWeight: "bold", fontsize: 11, font: "Arial", transparency: 30}, linetoolrectangle: {clonable: !0, color: "#153899", fillBackground: !0, backgroundColor: "#153899", transparency: 50, linewidth: 1, snapTo45Degrees: !0}, linetoolrotatedrectangle: {clonable: !0, color: "#9800ff", fillBackground: !0, backgroundColor: "#8e7cc3", transparency: 50, linewidth: 1, snapTo45Degrees: !0}, linetoolellipse: {clonable: !0, color: "#999915", fillBackground: !0, backgroundColor: "#999915", transparency: 50, linewidth: 1}, linetoolarc: {clonable: !0, color: "#999915", fillBackground: !0, backgroundColor: "#999915", transparency: 50, linewidth: 1}, linetoolprediction: {linecolor: "#1c73db", linewidth: 2, sourceBackColor: "#f1f1f1", sourceTextColor: "#6e6e6e", sourceStrokeColor: "#6e6e6e", targetStrokeColor: "#2fa8ff", targetBackColor: "#0b6fde", targetTextColor: "#ffffff", successBackground: "#36a02a", successTextColor: "#ffffff", failureBackground: "#e74545", failureTextColor: "#ffffff", intermediateBackColor: "#ead289", intermediateTextColor: "#6d4d22", transparency: 10, centersColor: "#202020"}, linetooltriangle: {clonable: !0, color: "#991515", fillBackground: !0, backgroundColor: "#991515", transparency: 50, linewidth: 1}, linetoolcallout: {clonable: !0, color: "#FFFFFF", backgroundColor: "#991515", transparency: 50, linewidth: 2, fontsize: 12, font: "Verdana", text: $.t("Text"), bordercolor: "#991515", bold: !1, italic: !1, wordWrap: !1, wordWrapWidth: 400}, linetoolparallelchannel: {clonable: !0, linecolor: "#773499", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendLeft: !1, extendRight: !1, fillBackground: !0, backgroundColor: "#b4a7d6", transparency: 50, showMidline: !1, midlinecolor: "#773499", midlinewidth: 1, midlinestyle: CanvasEx.LINESTYLE_DASHED}, linetoolelliottsubminuette: {clonable: !0, showWave: !0, color: "#3d85c6", wavesize: 0, showBackground: !0}, linetoolelliottminor: {clonable: !0, showWave: !0, color: "#ff9800", wavesize: 3, showBackground: !0}, linetoolelliottcircle: {clonable: !0, showWave: !0, color: "#6aa84f", wavesize: 6, showBackground: !0}, linetoolelliottminorretr: {clonable: !0, showWave: !0, color: "#a64d79", wavesize: 0, showBackground: !0}, linetoolelliottmajorretr: {clonable: !0, showWave: !0, color: "#bf9000", wavesize: 1, showBackground: !0}, linetoolbarspattern: {color: "#5091CC", clonable: !0, mode: TradingView.LineToolBarsPattern.BARS_MODE, mirrored: !1, flipped: !1}, study: {inputs: {}, styles: {}, palettes: {}, bands: {}, area: {}, graphics: {}, showInDataWindow: !0, showLastValue: !0, visible: !0, showStudyArguments: !0, precision: "default"}, linetoolpitchfork: {clonable: !0, fillBackground: !0, transparency: 80, style: TradingView.LineToolPitchfork.STYLE_ORIGINAL, median: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level0: {visible: !1, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .25}, level1: {visible: !1, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level2: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level3: {visible: !1, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level4: {visible: !1, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .75}, level5: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !1, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.5}, level7: {visible: !1, color: "#990066", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.75}, level8: {visible: !1, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}}, linetoolpitchfan: {clonable: !0, fillBackground: !0, transparency: 80, median: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level0: {visible: !1, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .25}, level1: {visible: !1, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level2: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level3: {visible: !1, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level4: {visible: !1, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .75}, level5: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !1, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.5}, level7: {visible: !1, color: "#990066", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.75}, level8: {visible: !1, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}}, linetoolgannfan: {clonable: !0, showLabels: !0, font: "Verdana", fillBackground: !0, transparency: 80, level1: {visible: !0, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 1, coeff2: 8}, level2: {visible: !0, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 1, coeff2: 4}, level3: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 1, coeff2: 3}, level4: {visible: !0, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 1, coeff2: 2}, level5: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 1, coeff2: 1}, level6: {visible: !0, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 2, coeff2: 1}, level7: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 3, coeff2: 1}, level8: {visible: !0, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 4, coeff2: 1}, level9: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff1: 8, coeff2: 1}}, linetoolganncomplex: {clonable: !0, fillBackground: !1, arcsBackground: {fillBackground: !0, transparency: 50}, levels: [
        {width: 1, color: "#808080", visible: !0},
        {width: 1, color: "#A06B00", visible: !0},
        {width: 1, color: "#699E00", visible: !0},
        {width: 1, color: "#009B00", visible: !0},
        {width: 1, color: "#009965", visible: !0},
        {width: 1, color: "#808080", visible: !0}
    ], fanlines: [
        {width: 1, color: "#A500FF", visible: !1, x: 8, y: 1},
        {width: 1, color: "#A50000", visible: !1, x: 5, y: 1},
        {width: 1, color: "#808080", visible: !1, x: 4, y: 1},
        {width: 1, color: "#A06B00", visible: !1, x: 3, y: 1},
        {width: 1, color: "#699E00", visible: !0, x: 2, y: 1},
        {width: 1, color: "#009B00", visible: !0, x: 1, y: 1},
        {width: 1, color: "#009965", visible: !0, x: 1, y: 2},
        {width: 1, color: "#009965", visible: !1, x: 1, y: 3},
        {width: 1, color: "#000099", visible: !1, x: 1, y: 4},
        {width: 1, color: "#660099", visible: !1, x: 1, y: 5},
        {width: 1, color: "#A500FF", visible: !1, x: 1, y: 8}
    ], arcs: [
        {width: 1, color: "#A06B00", visible: !0, x: 1, y: 0},
        {width: 1, color: "#A06B00", visible: !0, x: 1, y: 1},
        {width: 1, color: "#A06B00", visible: !0, x: 1.5, y: 0},
        {width: 1, color: "#699E00", visible: !0, x: 2, y: 0},
        {width: 1, color: "#699E00", visible: !0, x: 2, y: 1},
        {width: 1, color: "#009B00", visible: !0, x: 3, y: 0},
        {width: 1, color: "#009B00", visible: !0, x: 3, y: 1},
        {width: 1, color: "#009965", visible: !0, x: 4, y: 0},
        {width: 1, color: "#009965", visible: !0, x: 4, y: 1},
        {width: 1, color: "#000099", visible: !0, x: 5, y: 0},
        {width: 1, color: "#000099", visible: !0, x: 5, y: 1}
    ]}, linetoolgannsquare: {clonable: !0, color: "#153899", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, font: "Verdana", showTopLabels: !0, showBottomLabels: !0, showLeftLabels: !0, showRightLabels: !0, fillHorzBackground: !0, horzTransparency: 80, fillVertBackground: !0, vertTransparency: 80, hlevel1: {color: "#808080", coeff: 0, visible: !0}, hlevel2: {color: "#A06B00", coeff: .25, visible: !0}, hlevel3: {color: "#699E00", coeff: .382, visible: !0}, hlevel4: {color: "#009B00", coeff: .5, visible: !0}, hlevel5: {color: "#009965", coeff: .618, visible: !0}, hlevel6: {color: "#006599", coeff: .75, visible: !0}, hlevel7: {color: "#808080", coeff: 1, visible: !0}, vlevel1: {color: "#808080", coeff: 0, visible: !0}, vlevel2: {color: "#A06B00", coeff: .25, visible: !0}, vlevel3: {color: "#699E00", coeff: .382, visible: !0}, vlevel4: {color: "#009B00", coeff: .5, visible: !0}, vlevel5: {color: "#009965", coeff: .618, visible: !0}, vlevel6: {color: "#006599", coeff: .75, visible: !0}, vlevel7: {color: "#808080", coeff: 1, visible: !0}}, linetoolfibspeedresistancefan: {clonable: !0, fillBackground: !0, transparency: 80, grid: {color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, visible: !0}, linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, font: "Verdana", showTopLabels: !0, showBottomLabels: !0, showLeftLabels: !0, showRightLabels: !0, snapTo45Degrees: !0, hlevel1: {color: "#808080", coeff: 0, visible: !0}, hlevel2: {color: "#A06B00", coeff: .25, visible: !0}, hlevel3: {color: "#699E00", coeff: .382, visible: !0}, hlevel4: {color: "#009B00", coeff: .5, visible: !0}, hlevel5: {color: "#009965", coeff: .618, visible: !0}, hlevel6: {color: "#006599", coeff: .75, visible: !0}, hlevel7: {color: "#808080", coeff: 1, visible: !0}, vlevel1: {color: "#808080", coeff: 0, visible: !0}, vlevel2: {color: "#A06B00", coeff: .25, visible: !0}, vlevel3: {color: "#699E00", coeff: .382, visible: !0}, vlevel4: {color: "#009B00", coeff: .5, visible: !0}, vlevel5: {color: "#009965", coeff: .618, visible: !0}, vlevel6: {color: "#006599", coeff: .75, visible: !0}, vlevel7: {color: "#808080", coeff: 1, visible: !0}}, linetoolfibretracement: {clonable: !0, showCoeffs: !0, showPrices: !0, font: "Verdana", fillBackground: !0, transparency: 80, extendLines: !1, horzLabelsAlign: "left", vertLabelsAlign: "middle", reverse: !1, coeffsAsPercents: !1, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 0}, level2: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level3: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level4: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level5: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level6: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level7: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level8: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level9: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level10: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}}, linetoolfibchannel: {clonable: !0, showCoeffs: !0, showPrices: !0, font: "Verdana", fillBackground: !0, transparency: 80, extendLeft: !1, extendRight: !1, horzLabelsAlign: "left", vertLabelsAlign: "middle", reverse: !1, coeffsAsPercents: !1, level1: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 0}, level2: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level3: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level4: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level5: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level6: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level7: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level8: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level9: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level10: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}}, linetoolprojection: {clonable: !0, showCoeffs: !0, font: "Verdana", fillBackground: !0, transparency: 80, color1: "#008000", color2: "#FF0000", linewidth: 1, trendline: {visible: !0, color: "#808080", linestyle: CanvasEx.LINESTYLE_SOLID}, level1: {color: "#808080", visible: !0, linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}}, linetool5pointspattern: {clonable: !0, color: "#CC2895", textcolor: "#FFFFFF", fillBackground: !0, backgroundColor: "#CC2895", font: "Verdana", fontsize: 12, bold: !1, italic: !1, transparency: 50, linewidth: 1}, linetooltrianglepattern: {clonable: !0, color: "#9528FF", textcolor: "#FFFFFF", fillBackground: !0, backgroundColor: "#9528CC", font: "Verdana", fontsize: 12, bold: !1, italic: !1, transparency: 50, linewidth: 1}, linetoolabcd: {clonable: !0, color: "#009B00", textcolor: "#FFFFFF", font: "Verdana", fontsize: 12, bold: !1, italic: !1, linewidth: 2}, linetoolthreedrivers: {clonable: !0, color: "#9528FF", textcolor: "#FFFFFF", fillBackground: !0, backgroundColor: "#9528CC", font: "Verdana", fontsize: 12, bold: !1, italic: !1, transparency: 50, linewidth: 2}, linetoolheadandshoulders: {clonable: !0, color: "#45682F", textcolor: "#FFFFFF", fillBackground: !0, backgroundColor: "#45A82F", font: "Verdana", fontsize: 12, bold: !1, italic: !1, transparency: 50, linewidth: 2}, linetoolfibwedge: {clonable: !0, showCoeffs: !0, font: "Verdana", fillBackground: !0, transparency: 80, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level1: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level2: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level3: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level4: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level5: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level6: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level7: {visible: !1, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level8: {visible: !1, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level9: {visible: !1, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level10: {visible: !1, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}, level11: {visible: !1, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.618}}, linetoolfibcircles: {clonable: !0, showCoeffs: !0, font: "Verdana", fillBackground: !0, transparency: 80, snapTo45Degrees: !0, coeffsAsPercents: !1, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level2: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level3: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level4: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level5: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level6: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level7: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level8: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level9: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level10: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.618}}, linetoolfibspeedresistancearcs: {clonable: !0, showCoeffs: !0, font: "Verdana", fillBackground: !0, transparency: 80, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level2: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level3: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level4: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level5: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level6: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level7: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level8: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level9: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level10: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.618}}, linetooltrendbasedfibextension: {clonable: !0, showCoeffs: !0, showPrices: !0, font: "Verdana", fillBackground: !0, transparency: 80, extendLines: !1, horzLabelsAlign: "left", vertLabelsAlign: "middle", reverse: !1, coeffsAsPercents: !1, trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 0}, level2: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .236}, level3: {visible: !0, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level4: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level5: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level6: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .764}, level7: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level8: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level9: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level10: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3.618}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 4.236}}, linetooltrendbasedfibtime: {clonable: !0, showCoeffs: !0, font: "Verdana", fillBackground: !0, transparency: 80, horzLabelsAlign: "right", vertLabelsAlign: "bottom", trendline: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED}, level1: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 0}, level2: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level3: {visible: !1, color: "#95CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level4: {visible: !0, color: "#28CC28", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level5: {visible: !0, color: "#28CC95", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !0, color: "#2895CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.382}, level7: {visible: !0, color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.618}, level8: {visible: !0, color: "#2828CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}, level9: {visible: !0, color: "#CC2828", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.382}, level10: {visible: !0, color: "#9528CC", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2.618}, level11: {visible: !0, color: "#CC2895", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 3}}, linetoolschiffpitchfork: {clonable: !0, fillBackground: !0, transparency: 80, style: TradingView.LineToolPitchfork.STYLE_SCHIFF, median: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level0: {visible: !1, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .25}, level1: {visible: !1, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level2: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level3: {visible: !1, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level4: {visible: !1, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .75}, level5: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !1, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.5}, level7: {visible: !1, color: "#990066", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.75}, level8: {visible: !1, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}}, linetoolschiffpitchfork2: {clonable: !0, fillBackground: !0, transparency: 80, style: TradingView.LineToolPitchfork.STYLE_SCHIFF2, median: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level0: {visible: !1, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .25}, level1: {visible: !1, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level2: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level3: {visible: !1, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level4: {visible: !1, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .75}, level5: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !1, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.5}, level7: {visible: !1, color: "#990066", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.75}, level8: {visible: !1, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}}, linetoolinsidepitchfork: {clonable: !0, fillBackground: !0, transparency: 80, style: TradingView.LineToolPitchfork.STYLE_INSIDE, median: {visible: !0, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID}, level0: {visible: !1, color: "#A06B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .25}, level1: {visible: !1, color: "#699E00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .382}, level2: {visible: !0, color: "#009B00", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .5}, level3: {visible: !1, color: "#009965", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .618}, level4: {visible: !1, color: "#006599", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: .75}, level5: {visible: !0, color: "#000099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1}, level6: {visible: !1, color: "#660099", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.5}, level7: {visible: !1, color: "#990066", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 1.75}, level8: {visible: !1, color: "#A50000", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, coeff: 2}}, linetool: {frozen: !1, visible: !0}}, applyDefaultsOverrides(defaultProperties.chartproperties));
    "undefined" == typeof defaultProperties["study_MA@tv-basicstudies"] && (defaultProperties["study_MA@tv-basicstudies"] = {description: "Moving Average", shortDescription: "MA", inputs: {length: 9, source: "close"}, styles: {MovAvg: {visible: !0, color: "#0496FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, title: "MA"}}});
    "undefined" == typeof defaultProperties["study_ErrorOnUpdate@tv-basicstudies"] && (defaultProperties["study_ErrorOnUpdate@tv-basicstudies"] = {description: "Error On Update", styles: {ErrorOnUpdate: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0}}});
    "undefined" == typeof defaultProperties["study_ErrorOnCreate@tv-basicstudies"] && (defaultProperties["study_ErrorOnCreate@tv-basicstudies"] = {description: "Error On Create", styles: {ErrorOnUpdate: {visible: !0, color: "#00ff00", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0}}});
    "undefined" == typeof defaultProperties["study_ErrorOnNewBar@tv-basicstudies"] && (defaultProperties["study_ErrorOnNewBar@tv-basicstudies"] = {description: "Error On New Bar", styles: {ErrorOnUpdate: {visible: !0, color: "#0000ff", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0}}});
    "undefined" == typeof defaultProperties["study_PivotPointsHighLow@tv-basicstudies"] && (defaultProperties["study_PivotPointsHighLow@tv-basicstudies"] = {font: "Arial", fontsize: 10, borderColor: "#538F1F", backColor: "#F0FFCC", textColor: "#000000"});
    "undefined" == typeof defaultProperties["study_PivotPointsStandard@tv-basicstudies"] && (defaultProperties["study_PivotPointsStandard@tv-basicstudies"] = {_hardCodedDefaultsVersion: 1, font: "Arial", fontsize: 11, levelsStyle: {showLabels: !0, visibility: {P: !0, "S1/R1": !0, "S2/R2": !0, "S3/R3": !0, "S4/R4": !0, "S5/R5": !0}, colors: {P: "#D47928", "S1/R1": "#D47928", "S2/R2": "#D47928", "S3/R3": "#D47928", "S4/R4": "#D47928", "S5/R5": "#D47928"}, widths: {P: 1, "S1/R1": 1, "S2/R2": 1, "S3/R3": 1, "S4/R4": 1, "S5/R5": 1}}});
    "undefined" == typeof defaultProperties["study_ZigZag@tv-basicstudies"] && (defaultProperties["study_ZigZag@tv-basicstudies"] = {color: "#56871D", linewidth: 2});
    "undefined" == typeof defaultProperties["study_ElliottWave@tv-basicstudies"] && (defaultProperties["study_ElliottWave@tv-basicstudies"] = {inputs: {}, level0: {visible: !1, color: "#ff0000"}, level1: {visible: !1, color: "#008000"}, level2: {visible: !1, color: "#0000ff"}, level3: {visible: !1, color: "#ff00ff"}, level4: {visible: !0, color: "#0080ff"}, level5: {visible: !0, color: "#ff0000"}, level6: {visible: !0, color: "#008000"}, level7: {visible: !0, color: "#0000ff"}, level8: {visible: !0, color: "#ff00ff"}});
    "undefined" == typeof defaultProperties["study_LinearRegression@tv-basicstudies"] && (defaultProperties["study_LinearRegression@tv-basicstudies"] = {styles: {upLine: {visible: !0, color: "#0000ff", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, downLine: {visible: !0, color: "#0000ff", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, baseLine: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, extendLines: !0, showPearsons: !0, backgroundColor: "#991515", transparency: 70}});
    "undefined" == typeof defaultProperties["study_RegressionTrend@tv-basicstudies"] && (defaultProperties["study_RegressionTrend@tv-basicstudies"] = {linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, styles: {upLine: {visible: !0, color: "#0000FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, downLine: {visible: !0, color: "#0000FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, baseLine: {visible: !0, color: "#FF0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1}, extendLines: !1, showPearsons: !0, transparency: 70}});
    "undefined" == typeof defaultProperties["study_Compare@tv-basicstudies"] && (defaultProperties["study_Compare@tv-basicstudies"] = {minTick: "default"});
    "undefined" == typeof defaultProperties["study_Overlay@tv-basicstudies"] && (defaultProperties["study_Overlay@tv-basicstudies"] = {style: TradingView.Series.STYLE_BARS, showPriceLine: !1, minTick: "default", candleStyle: {upColor: "#6ba583", downColor: "#d75442", drawWick: !0, drawBorder: !0, borderColor: "#378658", borderUpColor: "#225437", borderDownColor: "#5b1a13", wickColor: "#737375", barColorsOnPrevClose: !1}, hollowCandleStyle: {upColor: "#6ba583", downColor: "#d75442", drawWick: !0, drawBorder: !0, borderColor: "#378658", borderUpColor: "#225437", borderDownColor: "#5b1a13", wickColor: "#737375", barColorsOnPrevClose: !1}, barStyle: {upColor: "#6ba583", downColor: "#d75442", barColorsOnPrevClose: !1, dontDrawOpen: !1}, lineStyle: {color: "#0303F7", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, priceSource: "close", styleType: TradingView.Series.STYLE_LINE_TYPE_SIMPLE}, areaStyle: {color1: "#606090", color2: "#01F6F5", linecolor: "#0094FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, priceSource: "close", transparency: 50}, styles: {open: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, title: "open"}, high: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, title: "high"}, low: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, title: "low"}, close: {visible: !0, color: "#ff0000", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 1, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, title: "close"}}});
    n = n.split(".");
    for (var t = defaultProperties, i = 0; i < n.length; i++)t && (t = t[n[i]]);
    return t ? TradingView.clone(t) : {}
}
function applyDefaultsOverrides(n, t, i) {
    function u(n, i, r) {
        var f = i.split(".");
        if (i = f[0], t && t[i] && (i = t[i]), !n.hasOwnProperty(i))throw"illegal path";
        1 < f.length ? (f = f.splice(1).join("."), u(n[i], f, r)) : n[i] && n[i].serValue ? n[i].setValue(r) : n[i] = r
    }

    if ("undefined" != typeof __defaultsOverrides && __defaultsOverrides)for (var r in __defaultsOverrides)try {
        u(n, r, __defaultsOverrides[r])
    } catch (f) {
        "undefined" != typeof i && i || console.warn("Path `" + r + "` does not exist.")
    }
}
function defaults(n, t) {
    return t ? _defaultsUpdated(n, t) : _defaultsAsIs(n)
}
function _defaultsAsIs(n) {
    var t = factoryDefaults(n);
    return window._UNIT_TESTS || (n = TradingView.clone(TVSettings.getJSON(n, null)), TradingView.merge(t, n)), t
}
function _defaultsUpdated(n, t) {
    var r = factoryDefaults(n), i;
    return window._UNIT_TESTS || (i = TradingView.clone(TVSettings.getJSON(n, null)), n.startsWith("study_") && i && D0.isVersionHead(i.version) && (i = t.updateStudyState(i, i)), TradingView.merge(r, i)), r
}
function saveDefaults(n, t) {
    TVSettings.setJSON(n, t)
}
function PriceFormatter(n, t, i, r) {
    if (t || (t = 1), isInteger(n) || (n = 100), 0 > n)throw new TypeError("invalid base");
    this._priceScale = n;
    this._minMove = t;
    this._minMove2 = r;
    0 < r && 2 !== r && 4 !== r ? TradingView.logDebug("invalid minmove2") : (this._fractional = i, this.calculateDecimal())
}
function numberToStringWithLeadingZero(n, t) {
    if (!isNumber(n))return"n/a";
    if (!isInteger(t))throw new TypeError("invalid length");
    if (0 > t || 16 < t)throw new TypeError("invalid length");
    return 0 === t ? n.toString() : ("0000000000000000" + n.toString()).right(t)
}
function PercentageFormatter() {
    PriceFormatter.call(this, 100)
}
function DateFormatter() {
}
function TimeFormatter(n) {
    this._format_str = n || "%h:%m:%s"
}
function DateTimeFormatter(n) {
    this._dwm = n
}
function VolumeFormatter(n) {
    this._precision = n;
    this._fractionalValues = 0 < n
}
function TimeSpanFormatter() {
}
function PriceColorer() {
    this._prev = null
}
function AbstractBarColorer() {
    this.backColorers = []
}
function SeriesBarColorer(n) {
    AbstractBarColorer.call(this);
    this._series = n
}
function StudyBarColorer(n, t) {
    AbstractBarColorer.call(this);
    this.Q1 = n;
    this._plotIndex = t
}
function BarItem() {
    this.close = this.low = this.high = this.open = this.time = 0
}
function BarsRange(n, t) {
    null === n || isInteger(n) ? null === t || isInteger(t) ? (this.m_firstBar = n, this.m_lastBar = t) : TradingView.logDebug("BarsRange: incorrect lastBar") : TradingView.logDebug("BarsRange: incorrect firstBar")
}
function SetChartLayoutCommand(n, t) {
    UndoCommand.call(this, "Change Chart Layout to " + D8.LayoutTemplates[t].title);
    this.Q5 = n;
    this._newLayoutId = t;
    this._oldLayoutId = n.layout.value()
}
function J78(n, t, i, r, u, f, e, o) {
    this.Q4 = o;
    this.m_model = new J79(n, t, i, r, u, f, e, this);
    this.m_undoStack = new UndoStack;
    this.m_redoStack = new UndoStack;
    this.m_zoomStack = new UndoStack;
    this._onSimpleZoomIn = new Delegate;
    this._onSimpleZoomOut = new Delegate
}
function UndoCommand(n) {
    this._text = n
}
function UndoStack() {
    this.m_commands = new List;
    this.m_commands.setValidator(new TypeValidator(UndoCommand));
    this._onChange = new Delegate
}
function UndoMacroCommand(n) {
    UndoCommand.call(this, n);
    this._subcommands = new List
}
function SetPropertyCommand(n, t, i, r) {
    UndoCommand.call(this, i);
    this._targetObj = n;
    this._newValue = t;
    this.Q0 = r
}
function SetAutoScalePropertyCommand(n, t, i, r, u) {
    UndoCommand.call(this, r);
    this._property = n;
    this._priceScale = i;
    this._newValue = t;
    this.Q0 = u
}
function SetPercentagePropertyCommand(n, t, i, r, u) {
    UndoCommand.call(this, r);
    this._percentage = n;
    this._priceScale = i;
    this._newValue = t;
    this.Q0 = u
}
function SetLogPropertyCommand(n, t, i, r, u) {
    UndoCommand.call(this, r);
    this._log = n;
    this._priceScale = i;
    this._newValue = t;
    this.Q0 = u
}
function SetChartStyleCommand(n, t, i, r, u, f) {
    UndoCommand.call(this, r);
    this._style = n;
    this._mainSeries = i;
    this._priceAxisProperties = i.properties().priceAxisProperties;
    this._newValue = t;
    this.Q0 = u;
    this.Q4 = f
}
function SetLockScaleCommand(n, t, i, r, u) {
    UndoCommand.call(this, r);
    this._property = n;
    this._mainSeries = i;
    this._priceAxisProperties = i.properties().priceAxisProperties;
    this._newValue = t;
    this.Q0 = u
}
function RemoveSourceCommand(n, t) {
    this.Q0 = n;
    this.J99 = t
}
function J88(n, t, i, r, u) {
    this.Q0 = n;
    this.J99 = t;
    this._scale = u;
    this._sources = new List;
    this._sources.append(t);
    this._sources.appendAll(this.Q0.children(t));
    this._oldPane = i;
    this._oldPaneIndex = n.panes().indexOf(i);
    this._oldPaneState = this._oldPane.state();
    this._oldScaleName = i.priceScaleName(t.priceScale());
    this._pane = r;
    this._samePane = this._pane === this._oldPane
}
function J83(n, t, i, r) {
    UndoCommand.call(this, "Create line " + t.toolname);
    this.Q0 = n;
    this._line = t;
    this._paneIndex = n.panes().indexOf(i);
    this._points = new List;
    this._points.append({point: r})
}
function J80(n, t) {
    this.Q0 = n;
    this.J99 = t;
    this._nextState = this._prevState = t.state(!0)
}
function J87(n, t, i, r) {
    this.Q0 = n;
    this.J99 = t;
    this._origPoint = i instanceof MathEx.Point ? i.clone() : TradingView.clone(i);
    this._pointIndex = r
}
function ChangeZOrderCommand(n, t, i) {
    UndoCommand.call(this, "Change " + t.title() + " Z order");
    this.Q0 = n;
    this.J99 = t;
    this._shift = i
}
function SendToBackCommand(n, t) {
    UndoCommand.call(this, "Change " + t.title() + " Z order");
    this.Q0 = n;
    this.J99 = t
}
function BringToFrontCommand(n, t) {
    UndoCommand.call(this, "Change " + t.title() + " Z order");
    this.Q0 = n;
    this.J99 = t
}
function RemovePaneCommand(n, t, i) {
    UndoCommand.call(this, "Remove pane");
    this.Q0 = n;
    this._index = t;
    this._pane = this.Q0.panes().item(t);
    this._chart = i
}
function RearrangePanesCommand(n, t, i, r) {
    UndoCommand.call(this, "Rearrange panes");
    this.Q0 = n;
    this._index = t;
    this._direction = i;
    this._chart = r
}
function ZoomCommand(n, t, i, r, u, f) {
    this.Q0 = n;
    this._startBar = t;
    this._endBar = i;
    this._startPrice = r;
    this._endPrice = u;
    this._pane = f
}
function J95(n, t, i) {
    this._baseCmd = n;
    this._zoomStack = t;
    this._inOut = i
}
function J91(n, t, i, r, u) {
    this.Q0 = n;
    this._paneA = t;
    this._paneB = i;
    this._prevStretchA = r;
    this._currStretchA = u
}
function J90(n, t) {
    UndoCommand.call(this, "Restore Defaults");
    this.Q0 = n;
    this._defaultProperty = t;
    this._state = t.state(t._exclusions)
}
function J81(n, t) {
    UndoCommand.call(this, "Apply Chart Theme");
    this.Q0 = n;
    this._newChartProps = t.chartProperties;
    this._newSeriesProps = t.mainSourceProperties;
    this._newChartProps.symbolWatermarkProperties || (this._newChartProps.symbolWatermarkProperties = defaults("chartproperties.symbolWatermarkProperties"), this._newChartProps.symbolWatermarkProperties.color = this._newChartProps.scalesProperties.textColor);
    this._oldChartProps = n.properties().state();
    delete this._oldChartProps.paneProperties.topMargin;
    delete this._oldChartProps.paneProperties.bottomMargin;
    this._oldSeriesProps = n.properties().state().mainSeriesProperties
}
function J84(n, t) {
    UndoCommand.call(this, "Apply Drawing Template");
    this.J99 = n;
    this._oldProps = n.properties().state();
    this._newProps = t
}
function J93(n, t, i, r) {
    UndoCommand.call(this, (" " + r || "") + " Study template");
    this.Q0 = n;
    this._oldProps = t;
    this._newProps = i
}
function SetPriceScaleMarginsCommand(n, t, i, r, u) {
    this.Q0 = n;
    this._pane = t;
    this._priceScale = i;
    this._topMargin = r;
    this._bottomMargin = u;
    this._oldTopMargin = i.topMargin();
    this._oldBottomMargin = i.bottomMargin()
}
function J85(n, t) {
    this.Q0 = n;
    this._range = t
}
function J92(n, t, i, r, u) {
    UndoCommand.call(this, n);
    this._property = t;
    this._value = i;
    this._forceSetProperty = u;
    this._prevValue = t.value();
    this._cw = r
}
function J82(n, t) {
    UndoCommand.call(this, "clone " + t.title());
    this.Q0 = n;
    this.J99 = t;
    this._points = new List
}
function SetWatchedValueCommand(n, t, i) {
    UndoCommand.call(this, i);
    this._wv = n;
    this._newValue = t;
    this._oldValue = n.value()
}
function J79(n, t, i, r, u, f, e, o) {
    var s, h, c;
    this._version = J79.version;
    this._readOnly = r;
    this._undoModel = o;
    this._studiesMetaData = f;
    this._studyVersioning = new D0(this._studiesMetaData, e);
    this.m_timeScale = new J49(this, i.timeScale);
    this.m_panes = new List;
    this.m_gridSource = new Grid;
    this.m_crossHairSource = new CrossHair(this, TradingView.drawingState.properties());
    this.m_width = 0;
    this._tagsChanged = new Delegate;
    this.Q2 = i;
    this._lineCancelled = new Delegate;
    this._magnet = new D47(TradingView.drawingState.properties().magnet, this.m_timeScale, i.paneProperties.magnetSensivity);
    this._alertsList = new List;
    s = new _52("chartproperties.mainSeriesProperties");
    s.addExclusion("lockScale");
    s.addExclusion("minTick");
    s.addExclusion("priceAxisProperties.percentage");
    s.addExclusion("priceAxisProperties.log");
    this.createPane(void 0, !1, {rightAxisProperties: s.priceAxisProperties.state(["autoScale"])});
    this.m_panes.item(0)._stretchFactor = 2 * J75.DEFAULT_STRETCH_FACTOR;
    this.m_panes.item(0)._isMainPane = !0;
    this.m_selectedSource = null;
    this._selectedSourceChanged = new Delegate;
    this._chartApi = n;
    this._invalidateHandler = t;
    this.m_hoveredSource = null;
    this.Q2.listeners().subscribe(this, J79.prototype.propertyChangeHandler);
    h = this;
    this.Q2.timezone.listeners().subscribe(null, function () {
        h._chartApi && h._chartApi.connected() && h._chartApi.switchTimezone(h.timezone())
    });
    this.Q2.timeScale.rightOffset.listeners().subscribe(null, function () {
        h.m_timeScale.setOffset(h.Q2.timeScale.rightOffset.value());
        h.recalculateAllPanes()
    });
    s.merge(i.mainSeriesProperties.state());
    this.m_mainSeries = new TradingView.Series(this, s, u);
    this.panes().item(0).addDataSource(this.m_mainSeries, this.panes().item(0).rightPriceScale());
    this.m_mainSeries.onCompleted().subscribe(this, function () {
        h.clearCurrentPosition()
    });
    r || (s.addChild("priceAxisProperties", this.m_mainSeries.m_priceScale.properties()), s.lockScale.listeners().subscribe(this, function (n) {
        (n = n.value()) && (s.priceAxisProperties.percentage.setValue(!1), s.priceAxisProperties.logDisabled.setValue(!1));
        s.priceAxisProperties.percentageDisabled.setValue(n);
        s.priceAxisProperties.logDisabled.setValue(n)
    }));
    this._barsMarksSources = [];
    n = J77.enabled("charting_library") ? new UserDefinedBarsMarks(this) : new PublishedChartsTimeline(this);
    n.setOwnerSource(this.m_mainSeries);
    this._barsMarksSources.push(n);
    this.m_watermarkSource = new Watermark(this.m_mainSeries);
    c = this._undoModel.Q4;
    TradingView.Q18("alerts") && !c.onWidget() && TradingView.alertsDispatcher && (this._alertsList.onAdd = new Delegate, this._alertsList.onRemove = new Delegate, this._alertsList.onChange = new Delegate, this._alertsList.onAdd.subscribe(this, function (n) {
        function r(i) {
            if (i) {
                var r = i.rightPriceScale() || i.leftPriceScale();
                r && i.addDataSource(new TradingView.AlertLabel(t, n), r)
            }
        }

        var t = this, i;
        if (n.isOHLC())r(t.paneForSource(t.m_mainSeries)); else for (i = t.m_panes.size() - 1; 0 <= i; i--)r(t.m_panes.item(i));
        c.update();
        t._alertsList.onChange.fire()
    }), this._alertsList.onRemove.subscribe(this, function (n) {
        for (var i, r, t = this.m_panes.size() - 1; 0 <= t; t--)i = this.m_panes.item(t), r = i.Q19().find(function (t) {
            return t.alert && t.alert() && t.alert().id() === n.id()
        }), r && i.removeDataSource && i.removeDataSource(r);
        c.update();
        this._alertsList.onChange.fire()
    }), this._prepareAlertsList());
    this._oldEndVisibleIndex = this._oldStartVisibleIndex = -1;
    this._currentTool = "";
    TradingView.drawingState.hideAllDrawings().subscribe(this, J79.prototype.visibilityChangeHandler)
}
function DataWindowItem(n, t) {
    this.m_title = n;
    this.m_value = t;
    this._visible = !0;
    this._color = void 0
}
function DataWindowView() {
    this._title = this._header = "";
    this._items = new List
}
function StatusView(n) {
    this._props = n;
    this._text = "";
    this._size = "12px";
    this._bold = !1
}
function PriceAxisView() {
    this._text = "";
    this._background = "#585858";
    this._coordinate = 0
}
function PriceAxisViewRenderer(n) {
    this._data = n;
    this._data.borderColor || (this._data.borderColor = this._data.background)
}
function TimeAxisView() {
    this._text = "";
    this._background = "#585858";
    this._coordinate = 0
}
function TimeAxisViewRenderer(n) {
    this._data = n
}
function CrossHair(n, t) {
    var i = this;
    DataSource.call(this);
    this.Q2 = t;
    this.Q0 = n;
    this._dataWindowView = new CrossHairDataWindowView(this, n);
    this._priceAxisView = new CrossHairPriceAxisView(this, n);
    this._startMeasurePriceAxisView = new CrossHairPriceAxisView(this, n, "measureStartY");
    this._endMeasurePriceAxisView = new CrossHairPriceAxisView(this, n, "measureEndY");
    this._timeAxisView = new CrossHairTimeAxisView(this, n);
    this._startMeasureTimeAxisView = new CrossHairTimeAxisView(this, n, "measureStartX");
    this._endMeasureTimeAxisView = new CrossHairTimeAxisView(this, n, "measureEndX");
    this.visible = !0;
    n.readOnly() ? this.areLinesVisible = !0 : TradingView.drawingState.cursorTool.subscribe(function (n) {
        i.areLinesVisible = "arrow" !== n
    }, {callWithLast: !0});
    this._subscribed = !1
}
function _64(n, t) {
    this.J99 = n;
    this._pane = t;
    this._rendererCache = {}
}
function _65(n, t, i) {
    this.source = n;
    this.pane = t;
    this._horzVisible = i
}
function J62(n) {
    this.data = n
}
function CrossHairPriceAxisView(n, t) {
    this._crossHair = n;
    this.Q0 = t;
    this._rendererData = {background: "#585858", color: "white", textHeight: 14, visible: !0};
    this._defaultFormatter = new PriceFormatter(100)
}
function CrossHairTimeAxisView(n, t) {
    TimeAxisView.call(this);
    this._crosshair = n;
    this.Q0 = t;
    this._rendererData = {visible: !1, background: "#585858", color: "white", textHeight: 14, text: ""}
}
function CrossHairDataWindowView(n, t) {
    DataWindowView.call(this);
    this._header = null;
    this._crossHair = n;
    this.Q0 = t;
    this._items.append(new DataWindowItem("Date", ""));
    this._items.append(new DataWindowItem("Time", ""));
    this._items.append(new DataWindowItem("Price", ""));
    this._defaultFormatter = new PriceFormatter(100)
}
function MAMetaInfo() {
    return new StudyMetaInfo({id: "MASimple", inputs: [
        {id: "length", type: "integer", defval: 10},
        {id: "source", type: "text", defval: "close"}
    ], plots: [
        {id: "MovAvg", type: "line"}
    ], properties: [
        {id: "is_price_study", type: "bool", value: "true"}
    ], palettes: {}})
}
function VolumeMetaInfo() {
    return new StudyMetaInfo({id: "Volume", inputs: [], plots: [
        {id: "Volume", type: "histogram"},
        {id: "Color", type: "colorer", palette: "volumePalette", target: "Volume"}
    ], properties: [
        {id: "is_price_study", type: "bool", value: "false"}
    ], palettes: {volumePalette: {colors: {0: {color: "#007F0E", width: 1, style: CanvasEx.LINESTYLE_SOLID, name: "Up Volume"}, 1: {color: "#872323", width: 1, style: CanvasEx.LINESTYLE_SOLID, name: "Down Volume"}}}}})
}
function DMMetaInfo() {
    return new StudyMetaInfo({id: "DM", inputs: [
        {id: "ADX smoothing", max: 50, min: 1, type: "integer", defval: 14},
        {id: "DI Length", max: 500, min: 1, type: "integer", defval: 14}
    ], plots: [
        {id: "ADX", type: "line"},
        {id: "DI_P", type: "line"},
        {id: "DI_N", type: "line"}
    ], properties: [
        {id: "is_price_study", type: "bool", value: "false"}
    ], palettes: {}})
}
function RSIMetaInfo() {
    return new StudyMetaInfo({id: "RSI", inputs: [
        {id: "length", type: "integer", defval: 14}
    ], plots: [
        {id: "RelativeStrengthIndex", type: "line"}
    ], properties: [
        {id: "is_price_study", type: "bool", value: "false"}
    ], palettes: {}})
}
function makeDefaultChartModel(n, t, i, r, u, f, e, o) {
    return n = new J78(n, t, i, r, u, f, e, o), n.model().Q20(new D22(D22.FULL_UPDATE)), n
}
function Grid() {
    this.horzLinesVisible = this.visible = !0;
    this.horzLinesColor = "white";
    this.horzLinesStyle = "";
    this.vertLinesVisible = !0;
    this.vertLinesColor = "white";
    this.vertLinesStyle = ""
}
function _83(n, t) {
    this.source = n;
    this.pane = t
}
function J65(n) {
    this.data = n
}
function Watermark(n) {
    function u() {
        var u = i.width(), f = i.height();
        return{draw: function () {
            var i;
            return
        }}
    }

    var i = null, f = new Function, t = {}, r = n.model().properties().symbolWatermarkProperties;
    this.paneViews = function (n) {
        return n.containsMainSeries() ? (i = n, (new List).append({renderer: u, update: f})) : new List
    }
}
function Legend() {
    this.m_items = new List
}
function LegendItem(n, t) {
    this.m_title = t;
    this.m_color = "white";
    this.m_dataSource = n
}
function J75(n, t, i) {
    var r = this;
    this.m_timeScale = n;
    n = t.rightAxisProperties.state();
    n.autoScale = !0;
    this.m_rightPriceScale = new J76(new Property(n));
    this.m_rightPriceScale.properties().percentage.listeners().subscribe(null, function () {
        r._needRecalc = !0;
        r._recalculateImpl();
        i.Q20(new D22(D22.LIGHT_UPDATE))
    });
    this.m_rightPriceScale.properties().log.listeners().subscribe(null, function () {
        r._needRecalc = !0;
        r._recalculateImpl();
        i.Q20(new D22(D22.LIGHT_UPDATE))
    });
    n = t.leftAxisProperties.state();
    n.autoScale = !0;
    this.m_leftPriceScale = new J76(new Property(n));
    this.m_leftPriceScale.properties().log.listeners().subscribe(null, function () {
        r._needRecalc = !0;
        r._recalculateImpl();
        i.Q20(new D22(D22.LIGHT_UPDATE))
    });
    this.m_leftPriceScale.properties().percentage.listeners().subscribe(null, function () {
        r._needRecalc = !0;
        r._recalculateImpl();
        i.Q20(new D22(D22.LIGHT_UPDATE))
    });
    this.m_dataSources = new List;
    this.m_legend = new Legend;
    this.m_width = this.m_height = 0;
    this.m_mainDataSource = null;
    this.Q2 = t;
    this.Q0 = i;
    this._tagsChanged = new Delegate;
    t.topMargin.listeners().subscribe(this, J75.prototype._updateMargins);
    t.bottomMargin.listeners().subscribe(this, J75.prototype._updateMargins);
    this._updateMargins();
    this._stretchFactor = J75.DEFAULT_STRETCH_FACTOR
}
function optimalBarWidth(n) {
    return.3 * n
}
function selectionTolerance(n) {
    return 2 + .5 * n
}
function paneRendererCoordinateIsValid(n) {
    return null !== n && void 0 !== n && !isNaN(n)
}
function J56(n) {
    this.bars = n.bars;
    this.barSpacing = n.barSpacing;
    this.barWidth = optimalBarWidth(n.barSpacing);
    this.barLineWidth = Math.max(1, Math.round(this.barWidth));
    this.dontDrawOpen = n.dontDrawOpen
}
function J70(n) {
    this.bars = n.bars;
    this.barWidth = n.barWidth;
    this.barLineWidth = 1
}
function J67(n) {
    this.bars = n.bars;
    this.barSpacing = n.barSpacing;
    this.barLineWidth = Math.max(1, optimalBarWidth(n.barSpacing))
}
function J69(n) {
    this.bars = n.bars;
    this.barSpacing = n.barSpacing;
    this.blockSize = n.blockSize;
    this.barWidth = n.barSpacing
}
function J66(n) {
    this.items = n.items;
    this.barSpacing = n.barSpacing;
    this.histogramBase = n.histogramBase;
    this.lineColor = n.lineColor;
    this.lineWidth = n.lineWidth
}
function J60(n) {
    this.items = n.items;
    this.barSpacing = n.barSpacing;
    this.histogramBase = n.histogramBase;
    this.lineColor = n.lineColor;
    this.lineWidth = n.lineWidth
}
function J68(n) {
    this.items = n.items;
    this._simpleMode = n.simpleMode;
    this.barSpacing = n.barSpacing;
    this.lineColor = n.lineColor;
    this.lineWidth = n.lineWidth;
    this.lineStyle = n.lineStyle;
    this.withMarkers = n.withMarkers;
    this.withSteps = n.withSteps;
    this.hittest = n.hittest;
    this.ignorePaletteLineWidth = n.ignorePaletteLineWidth;
    this.forceLineColor = !!n.forceLineColor
}
function J53(n) {
    n.forceLineColor = !0;
    J68.call(this, n);
    this.color1 = n.color1;
    this.color2 = n.color2;
    this.bottom = n.bottom;
    this._simpleMode = n.simpleMode
}
function J57(n) {
    this._data = n;
    this._barWidth = optimalBarWidth(n.barSpacing);
    this._barBorderWidth = 1
}
function J61(n) {
    this.items = n.items;
    this.barSpacing = n.barSpacing;
    this.lineColor = n.lineColor;
    this.lineWidth = n.lineWidth;
    this.lineStyle = n.lineStyle
}
function J58(n) {
    this.items = n.items;
    this.barSpacing = n.barSpacing;
    this.lineColor = n.lineColor || n.color;
    this.radius = n.lineWidth || n.height / 2;
    this.vertOffset = n.vertOffset || 0
}
function PaneRendererArrowsUpDownItem(n, t, i, r) {
    this.x = n;
    this.y = t;
    this.height = i;
    this.isUp = r
}
function J54(n) {
    this.items = n.items;
    this.barSpacing = n.barSpacing;
    this.colorUp = n.colorup;
    this.colorDn = n.colordown;
    this.colorBorder = n.colorBorder;
    this.width = this._calculateWidth(n.barSpacing);
    this.minHeight = n.minHeight;
    this.vertOffset = this._calculateVerticalOffset(n.barSpacing)
}
function J73(n) {
    this.items = n.items;
    this.ch = n.char[0];
    this.color = n.color;
    this.vertOffset = n.vertOffset;
    this.height = Math.round(n.height)
}
function J52(n) {
    this.items = n.items;
    this.height = n.height || n.width;
    this.width = n.width || n.height;
    this.color = n.color;
    this.vertOffset = n.vertOffset || 0
}
function J74(n) {
    J52.call(this, n)
}
function J72(n) {
    J52.call(this, n)
}
function J71(n) {
    J52.call(this, n)
}
function PaneRendererTriangleApexLeft(n) {
    J52.call(this, n)
}
function J64(n) {
    J52.call(this, n)
}
function J63(n) {
    J52.call(this, n)
}
function J59(n) {
    J52.call(this, n)
}
function J55(n) {
    this._items = n.items;
    this._y = n.y;
    this._h = n.h;
    this._w = n.w
}
function PriceRange(n, t) {
    this.m_minValue = n;
    this.m_maxValue = t
}
function TickMark(n, t, i) {
    this.coord = n;
    this.label = t;
    this.major = i
}
function PriceTickSpanCalculator(n, t) {
    if (this.m_base = n, this.m_integralDividers = t, this.m_fractionalDividers = [], MathEx.isBaseDecimal(this.m_base))this.m_fractionalDividers = [2, 2.5, 2]; else for (var i = this.m_base; 1 !== i;) {
        if (0 == i % 2)this.m_fractionalDividers.push(2), i /= 2; else if (0 == i % 5)this.m_fractionalDividers.push(2), this.m_fractionalDividers.push(2.5), i /= 5; else throw new RangeError("unexpected base");
        if (100 < this.m_fractionalDividers.length)throw Error("something wrong with base");
    }
}
function PriceTickMarkBuilder(n, t, i) {
    this.m_marks = [];
    this.m_base = t;
    this.m_priceScale = n;
    this.m_fontHeight = 14;
    this._formatter = i
}
function calculateBaseForTickSpan(n) {
    for (var t = 1; n * t !== Math.round(n * t);)t *= 10;
    return t
}
function J76(n) {
    function i() {
        for (var r, i = t.m_dataSources, n = 0; n < i.size(); n++)r = i.item(n), r.priceScaleChanged && r.priceScaleChanged.fire(t)
    }

    this.Q2 = n;
    this.m_height = 0;
    this.m_priceRange = null;
    this.m_dataSources = new List;
    this._studyBottomMargin = this._studyTopMargin = this.m_bottomMargin = this.m_topMargin = 0;
    this.m_priceRangeSnapshot = this.m_scaleStartPoint = this.m_scrollStartPoint = null;
    this.m_markBuilder = new PriceTickMarkBuilder(this, 100, new PriceFormatter(100));
    this.Q2.percentage.listeners().subscribe(this, J76.prototype.updateFormatter);
    this.Q2.showSymbolLabels.listeners().subscribe(this, J76.prototype.updateShowSymbolLabels);
    var t = this;
    this.Q2.log.listeners().subscribe(null, function (n) {
        if (t.m_priceRange) {
            var i = t.m_priceRange;
            t.m_priceRange = n.value() ? new PriceRange(t._toLog(i.minValue()), t._toLog(i.maxValue())) : new PriceRange(t._fromLog(i.minValue()), t._fromLog(i.maxValue()))
        }
    });
    this.Q2.percentage.listeners().subscribe(null, function () {
        t.Q2.autoScale.setValue(!0)
    });
    this.Q2.percentage.listeners().subscribe(null, function () {
        var i, n;
        t.Q2.autoScaleDisabled.setValue(t.Q2.percentage.value());
        i = t.priceRange();
        !t.mainSource() || t.mainSource().model().timeScale().isEmpty() || t.mainSource().data().isEmpty() || t.mainSource()instanceof TradingView.Series && !t.mainSource().properties().lockScale.value() || !i || (n = t.mainSource().model().timeScale().visibleBars(), n = t.mainSource().data().search(n.firstBar(), SEARCH_NEAREST_RIGHT).value[CLOSE_PLOT], null != i && void 0 !== n && (t.Q2.percentage.value() ? t.setPriceRange(i.convertToPercents(n)) : t.setPriceRange(i.convertFromPercents(n))))
    });
    this._sourcesToUpdateViews = this._sourcesForAutoscale = null;
    this._hasSeries = !1;
    this.Q2.percentage.listeners().subscribe(null, i);
    this.Q2.log.listeners().subscribe(null, i)
}
function J23(n) {
    this._series = n;
    this.Q0 = n.m_model;
    this._points = (new List).append(new MathEx.Point(0, 0));
    this._invalidated = !0
}
function SeriesDataWindowView(n, t) {
    DataWindowView.call(this);
    this._series = n;
    this.Q0 = t;
    this._items.append(new DataWindowItem($.t("Open", {context: "in_legend"}), ""));
    this._items.append(new DataWindowItem($.t("High", {context: "in_legend"}), ""));
    this._items.append(new DataWindowItem($.t("Low", {context: "in_legend"}), ""));
    this._items.append(new DataWindowItem($.t("Close", {context: "in_legend"}), ""));
    this._invalidated = !0;
    this.update()
}
function J14(n, t) {
    this.m_series = n;
    this.m_model = t;
    this.m_bars = new List;
    this._invalidated = !0
}
function J15(n, t) {
    J14.call(this, n, t)
}
function J16(n, t) {
    J14.call(this, n, t)
}
function J17(n, t) {
    J14.call(this, n, t)
}
function J18(n, t) {
    J14.call(this, n, t)
}
function J29(n, t, i) {
    this.m_series = n;
    this.m_priceSource = t;
    this.m_model = i;
    this.m_items = new List;
    this._barGetter = {open: function (n) {
        return n[OPEN_PLOT]
    }, high: function (n) {
        return n[HIGH_PLOT]
    }, low: function (n) {
        return n[LOW_PLOT]
    }, close: function (n) {
        return n[CLOSE_PLOT]
    }, hl2: function (n) {
        return(n[HIGH_PLOT] + n[LOW_PLOT]) / 2
    }, hlc3: function (n) {
        return(n[HIGH_PLOT] + n[LOW_PLOT] + n[CLOSE_PLOT]) / 3
    }, ohlc4: function (n) {
        return(n[OPEN_PLOT] + n[HIGH_PLOT] + n[LOW_PLOT] + n[CLOSE_PLOT]) / 4
    }}[this.m_priceSource]
}
function J20(n, t, i) {
    J29.call(this, n, t, i);
    this._invaidated = !0
}
function J13(n, t, i) {
    J29.call(this, n, t, i);
    this._invaidated = !0
}
function SeriesStatusView(n, t) {
    StatusView.call(this, t);
    this._series = n;
    this._series.onRestarted().subscribe(this, SeriesStatusView.prototype.Q20);
    this._series.onSymbolResolved().subscribe(this, SeriesStatusView.prototype.Q20);
    this._series.onBoxSizeChanged().subscribe(this, SeriesStatusView.prototype.Q20)
}
function SeriesPriceAxisView(n, t) {
    this._series = n;
    this.Q0 = t;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._textHeight = 14;
    this._invalidated = !0
}
function ProjectionSeriesPriceAxisView(n, t) {
    SeriesPriceAxisView.call(this, n, t)
}
function J37(n, t, i, r) {
    this.Q1 = n;
    this.m_series = t;
    this.m_model = i;
    this._plotName = r;
    this._visible = !1;
    this._points = (new List).append(new MathEx.Point(0, 0))
}
function defaultPlotOptions() {
    return{visible: !0, color: "#0496FF", linestyle: CanvasEx.LINESTYLE_SOLID, linewidth: 2, plottype: TradingView.Study.PLOT_LINE, histogramBase: 0, transparency: 50, trackPrice: !1, joinPoints: !1}
}
function LocationToYMixin() {
}
function J33(n, t, i, r) {
    for (this.m_study = n, this.m_series = t, this.m_model = i, this._plotName = r, this.m_items = new List, this._invalidated = !0, n = this.m_study.metaInfo().plots, this._paletterProps = this._palette = this._colorer = null, t = this._plotIndex = 0; t < n.length; t++)n[t].id === this._plotName && (this._plotIndex = t), this.m_study.isSelfColorerPlot(t) && n[t].target === this._plotName && (this._colorer = t, this._palette = this.m_study.metaInfo().palettes[n[t].palette], this._paletterProps = this.m_study.properties().palettes[n[t].palette])
}
function J30(n, t, i, r) {
    for (this.Q1 = n, this._series = t, this.Q0 = i, this._plotName = r, this._items = new List, this._invalidated = !0, n = this.Q1.metaInfo().plots, t = 0; t < n.length; t++)n[t].id === this._plotName && (this._plotIndex = t, assert(this.Q1.isBgColorerPlot(t), "Plot '" + this._plotName + "' is not a background colorer!"))
}
function J36(n, t, i, r) {
    for (this.m_study = n, this.m_series = t, this.m_model = i, this.m_plotName = r, this.m_items = new List, this.m_invalidated = !0, this.m_plotIndex = null, n = this.m_study.metaInfo().plots, t = 0; t < n.length; t++)if (n[t].id === this.m_plotName) {
        this.m_plotIndex = t;
        break
    }
    for (n = this.m_study.metaInfo().plots, this._paletterProps = this._palette = this._colorer = null, t = this._plotIndex = 0; t < n.length; t++)n[t].id === this.m_plotName && (this._plotIndex = t), this.m_study.isSelfColorerPlot(t) && n[t].target === this.m_plotName && (this._colorer = t, this._palette = this.m_study.metaInfo().palettes[n[t].palette], this._paletterProps = this.m_study.properties().palettes[n[t].palette])
}
function J35(n, t, i, r) {
    J36.call(this, n, t, i, r)
}
function J34(n, t, i, r) {
    J36.call(this, n, t, i, r);
    this._maxAbsValue = 0
}
function J51(n, t, i) {
    this.Q1 = n;
    this.Q0 = t;
    this._plotIndex = i;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._color = "white";
    this._textHeight = 14;
    this._invalidated = !0
}
function StudyDataWindowView(n, t) {
    var u, i, f, r;
    if (DataWindowView.call(this), this.Q1 = n, this.Q0 = t, u = n.metaInfo().plots, u) {
        for (i = 0; i < u.length; ++i)if (!(this.Q1.isSelfColorerPlot(i) || this.Q1.isBarColorerPlot(i) || this.Q1.isBgColorerPlot(i) || this.Q1.isDataOffsetPlot(i))) {
            if (f = u[i].id, "Compare@tv-basicstudies" === this.Q1.metaInfo().id)r = new DataWindowItem(this.Q1.inputsForGUI()[1], ""); else {
                r = this.Q1.title();
                try {
                    r = this.Q1.properties().styles[f].title.value()
                } catch (e) {
                }
                r = new DataWindowItem(r, "")
            }
            r.plotId = f;
            r.plotIndex = i;
            this._items.append(r)
        }
        this.update();
        this._invalidated = !0
    }
}
function DataVendorStudyDataWindowView(n, t) {
    StudyDataWindowView.call(this, n, t)
}
function StudyStatusView(n, t) {
    StatusView.call(this, t);
    this.Q1 = n
}
function _90(n, t) {
    this.J99 = n;
    this.Q0 = t;
    this._points = new List;
    this._floatPoints = new List
}
function AreaBackgroundRenderer(n) {
    this._data = n
}
function BandBackgroundRenderer(n) {
    this._data = n
}
function J50() {
    this._marksByIndex = {};
    this._marksBySpan = []
}
function TimePoint(n) {
    this.m_date = n
}
function _createMonthNames() {
    return[$.t("دی"), $.t("بهمن"), $.t("اسفند"), $.t("فروردین"), $.t("اردیبهشت"), $.t("خرداد"), $.t("تیر"), $.t("مرداد"), $.t("شهریور"), $.t("مهر"), $.t("آبان"), $.t("آذر")]
}
function J49(n, t) {
    this.Q0 = n;
    this.Q2 = t;
    this.m_width = 0;
    this._defaultRightOffset = this.Q2.rightOffset.value();
    this.m_rightOffset = this.Q2.rightOffset.value();
    this.m_points = new TimeIndexes;
    this.m_barSpacing = this.Q2.barSpacing.value();
    this.m_stateSnapshot = this.m_scaleStartPoint = this.m_scrollStartPoint = null;
    this.m_tickmarks = new J50;
    this._locked = !1
}
function SelectionRenderer(n) {
    this._data = n
}
function LineAnchor(n, t) {
    this._data = n;
    this.Q0 = t;
    this.radius = this._data.radius || LineAnchor.OUTER_RADIUS
}
function CompositeRenderer() {
    this._renderers = new List
}
function SelectionIndexes() {
}
function J48(n, t) {
    PriceAxisView.call(this, n, t);
    this._linetool = n;
    this._pointIndex = t;
    this._text = "";
    this._coordinate = 0;
    this._background = "#5592C9";
    this._activeBackground = "#0F6DBF";
    this._borderColor = "#2E84A6";
    this._color = "white";
    this._textHeight = 14;
    this._invalidated = !0;
    this.Q0 = n.Q0
}
function LineToolTimeAxisView(n, t) {
    TimeAxisView.call(this);
    this._linetool = n;
    this._pointindex = t;
    this.Q0 = n.Q0;
    this._text = "";
    this._coordinate = 0;
    this._background = "#5592C9";
    this._activeBackground = "#0F6DBF";
    this._borderColor = "#2E84A6";
    this._color = "white";
    this._visible = !1;
    this._textHeight = 14;
    this._invalidated = !0
}
function J47(n, t, i) {
    if (DataSource.call(this), this.Q0 = n, this.Q2 = i, i.visible && i.frozen || this.Q2.merge(defaults("linetool")), this._paneViews = $.isArray(t) ? t : [t], this._points = new List, this._fixedPoints = new List, this._timePoint = new List, this.Q2.symbol || (this.Q2.merge({symbol: n.mainSeries().symbol()}), (t = n.mainSeries().symbolInfo()) && this.Q2.merge({symbolInfo: {listed_exchange: t.listed_exchange, short_name: t.name}})), this.Q2.interval || this.Q2.merge({interval: n.mainSeries().interval()}), this.Q2.addExclusion && (this.Q2.addExclusion("symbol"), this.Q2.addExclusion("symbolInfo"), this.Q2.addExclusion("points"), this.Q2.addExclusion("interval"), this.Q2.addExclusion("visible")), this.calcIsActualSymbol(), this.Q2.listeners().subscribe(this, J47.prototype.propertiesChanged), this._createPointsProperties(), "_tooltipFieldsHash"in this && !this.hasOwnProperty("_tooltipFieldsHash") && (this._tooltipFieldsHash = $.extend(!0, {}, this._tooltipFieldsHash)), this.m_priceAxisViews = new List, this.m_timeAxisViews = new List, 0 < this.pointsCount())for (n = 0; n < this.pointsCount(); n++)this.m_priceAxisViews.append(this.createPriceAxisView(n)), this.m_timeAxisViews.append(new LineToolTimeAxisView(this, n));
    this.Q2.visible.listeners().subscribe(this, function (n) {
        n.value() || this.Q0.selectedSource() != this || this.Q0.setSelectedSource(null)
    });
    this.customization = this.customization || {forcePriceAxisLabel: !1, disableSelection: !1, disableErasing: !1};
    $(window).resize(function () {
        this.isFixed() && this.restoreFixedPoints()
    }.bind(this))
}
function _92(n, t) {
    _90.call(this, n, t)
}
function J31(n, t) {
    _90.call(this, n, t)
}
function PoligonRenderer(n, t) {
    this._data = n;
    this._hittest = t ? t : new HitTestResult(HitTestResult.MOVEPOINT)
}
function _66(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function J6(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function ParallelChannelRenderer(n) {
    this._data = n
}
function _98(n, t) {
    _90.call(this, n, t)
}
function TrendLineStatsRenderer(n, t, i) {
    this._textSizeCache = t;
    this._data = n;
    this._fontSize = n.fontsize ? n.fontsize : n.fontSize ? n.fontSize : 12;
    this._lineSpacing = "number" == typeof this._data.lineSpacing && this._data.lineSpacing ? this._data.lineSpacing : 0;
    n.lines = this._lines = TextRenderer.prototype.wordWrap.call(this, n.text, n.wordWrapWidth);
    this._hittest = i ? i : new HitTestResult(HitTestResult.MOVEPOINT)
}
function TrendLineRenderer(n, t) {
    this._data = n;
    this._hittest = t ? t : new HitTestResult(HitTestResult.MOVEPOINT)
}
function J43(n, t) {
    _90.call(this, n, t);
    this._label = null;
    this._rendererCache = {};
    this._invalidated = !0
}
function RectangleRenderer(n) {
    this._data = n
}
function J8(n, t) {
    _90.call(this, n, t)
}
function EllipseRenderer(n) {
    this._data = n;
    this._data.angleFrom = 0;
    this._data.angleTo = 2 * Math.PI;
    this._data.clockwise = !1
}
function _69(n, t) {
    _90.call(this, n, t)
}
function HorzLineRenderer(n) {
    this._data = n
}
function _85(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function LineToolHorzLinePriceAxisView(n, t) {
    this.J99 = n;
    this.Q0 = t;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._textHeight = 14;
    this._invaildated = !0
}
function HorzRayRenderer(n) {
    this._data = n
}
function _86(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function LineToolHorzRayPriceAxisView(n, t) {
    this.J99 = n;
    this.Q0 = t;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._textHeight = 14
}
function VertLineRenderer(n, t) {
    this._data = n;
    this._hittest = t
}
function J45(n, t) {
    _90.call(this, n, t)
}
function LineToolVertLineTimeAxisView(n, t) {
    TimeAxisView.call(this);
    this.J99 = n;
    this.Q0 = t;
    this._invalidated = !0
}
function ChannelRenderer(n) {
    this._data = n
}
function J1(n, t) {
    _90.call(this, n, t)
}
function J12(n, t) {
    J1.call(this, n, t)
}
function J11(n, t) {
    J12.call(this, n, t)
}
function _88(n, t) {
    J1.call(this, n, t)
}
function J0(n, t) {
    _90.call(this, n, t)
}
function TextRenderer(n, t, i) {
    this._textSizeCache = t;
    this._data = n;
    this._fontSize = n.fontsize ? n.fontsize : n.fontSize ? n.fontSize : 20;
    n.lines = this._lines = this.wordWrap(n.text, n.wordWrapWidth);
    this._hittest = i ? i : new HitTestResult(HitTestResult.MOVEPOINT)
}
function J39(n, t, i, r, u, f) {
    _90.call(this, n, t);
    this._offsetX = i;
    this._offsetY = r;
    this._vertAlign = u;
    this._horzAlign = f;
    this._rendererCache = {};
    this._renderer = null
}
function BalloonRenderer(n, t) {
    this._measureCache = t;
    this._data = n
}
function _56(n, t) {
    _90.call(this, n, t);
    this._image = TradingView.getImage("balloon", TradingView.wrapUrl("/static/images/balloon.png"));
    $(this._image).load(function () {
        t.updateSource(n)
    });
    this._rendererCache = {}
}
function CalloutRenderer(n, t) {
    this._data = n;
    n.lines = this.wordWrap(n.text, n.wordWrapWidth);
    this._textSizeCache = t
}
function _62(n, t) {
    _90.call(this, n, t);
    this._textSizeCache = {}
}
function TriangleRenderer(n) {
    this._data = n
}
function J44(n, t) {
    _90.call(this, n, t)
}
function ArcRenderer(n) {
    this._data = n;
    this._data.angleFrom = 0;
    this._data.angleTo = Math.PI;
    this._data.clockwise = !1
}
function _54(n, t) {
    _90.call(this, n, t)
}
function _61(n, t) {
    _90.call(this, n, t);
    this._invalidated = !0;
    this.Q0 = t;
    this.J99 = n
}
function NoteRendererSource() {
}
function NoteRenderer(n, t) {
    this.J99 = n;
    this._data = t
}
function NotePaneView(n, t) {
    _90.call(this, n, t);
    this._rendererSource = new NoteRendererSource
}
function PriceLabelRenderer(n, t, i) {
    this._data = n;
    this._measureCache = t;
    this._chartModel = i
}
function J5(n, t) {
    _90.call(this, n, t);
    this._image = TradingView.getImage("price_label", TradingView.wrapUrl("/static/images/price_label.png"));
    this._rendererCache = {}
}
function PredictionRenderer(n) {
    this._data = n;
    this._targetFontSize2 = this._targetFontSize1 = 11;
    this._targetFontSize3 = 14;
    this._font = "Arial";
    this._sourceFontSize1 = 12;
    this._sourceFontSize2 = 10
}
function J4(n, t) {
    _90.call(this, n, t);
    this._clockWhite = TradingView.getImage("prediction-clock-white", TradingView.wrapUrl("/static/images/prediction-clock-white.png"));
    this._clockBlack = TradingView.getImage("prediction-clock-black", TradingView.wrapUrl("/static/images/prediction-clock-black.png"));
    this._successIcon = TradingView.getImage("prediction-success-white", TradingView.wrapUrl("/static/images/prediction-success-white.png"));
    this._failureIcon = TradingView.getImage("prediction-failure-white", TradingView.wrapUrl("/static/images/prediction-failure-white.png"))
}
function J3(n, t) {
    _90.call(this, n, t)
}
function _82(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _81(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _72(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function J41(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _74(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function FibArcRenderer(n, t) {
    this._data = n;
    this._hittest = t
}
function _73(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _76(n, t) {
    _90.call(this, n, t);
    this._levels = [];
    this._rendererCache = {}
}
function EllipseRendererSimple(n, t) {
    this._data = n;
    this._hittest = t
}
function _71(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function ArcWedgeRenderer(n, t) {
    this._data = n;
    this._hittest = t;
    this._rendererCache = {}
}
function _77(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {};
    this._levels = []
}
function J7(n, t) {
    _77.call(this, n, t)
}
function _68(n, t) {
    _90.call(this, n, t);
    this._rendererCache = [
        {},
        {},
        {},
        {},
        {},
        {}
    ]
}
function _93(n, t) {
    _90.call(this, n, t);
    this._lines = []
}
function LineToolRiskRewardPriceAxisView(n, t, i, r) {
    this.J99 = n;
    this.Q0 = t;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._textHeight = 14;
    this._pricePropName = i;
    this._colorPropName = r
}
function _99(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _91(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _96(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _95(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _94(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function J42(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function GannArcRenderer(n) {
    this._data = n
}
function _80(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function _70(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function FibSpiralRenderer(n) {
    this._data = n
}
function _75(n, t) {
    _90.call(this, n, t)
}
function _67(n, t) {
    _90.call(this, n, t);
    this._label = null;
    this._rendererCache = {}
}
function _78(n, t) {
    _90.call(this, n, t);
    this._label2 = this._label1 = null;
    this._rendererCache = {}
}
function IconRenderer(n, t) {
    this._data = n;
    this._cache = t
}
function _87(n, t) {
    _90.call(this, n, t);
    this._cache = {}
}
function J10(n, t) {
    _90.call(this, n, t)
}
function AngleRenderer(n) {
    this._data = n
}
function J40(n, t) {
    _90.call(this, n, t);
    this._label = null;
    this._rendererCache = {}
}
function OrderLineAdapter(n) {
    this._line = n;
    this._data = {bodyText: "order", quantityText: "0"}
}
function OrderRenderer(n, t, i) {
    this._data = n;
    this._cache = t;
    this._adapter = i
}
function OrderPriceAxisView(n, t) {
    J48.call(this, n, t)
}
function OrderPaneView(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function PositionLineAdapter(n) {
    this._line = n;
    this._data = {bodyText: "position", quantityText: "0"}
}
function PositionRenderer(n, t, i) {
    this._data = n;
    this._cache = t;
    this._adapter = i
}
function PositionPriceAxisView(n, t) {
    J48.call(this, n, t)
}
function PositionPaneView(n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
}
function ExecutionsPositionController(n, t) {
    this._pane = n;
    this._timeScale = t
}
function ExecutionLineAdapter(n) {
    this._line = n
}
function ExecutionRenderer(n, t) {
    this._data = n;
    this._adapter = t
}
function ExecutionPaneView(n, t) {
    _90.call(this, n, t)
}
function MarkRenderer(n) {
    this._data = n
}
function _97(n, t, i, r, u, f, e) {
    _90.call(this, n, t);
    this._image = i;
    this._offsetX = f || 0;
    this._offsetY = e || 0;
    this._width = r;
    this._height = u
}
function fixLineToolsPositions(n, t, i) {
    var e = n.allLineTools(), c = e.size(), u, r;
    for (n = n.timeScale(), n.points(), u = 0; u < c; ++u) {
        for (var o = e.item(u), s = 0, h = o.points(), l = h.size(), f = 0; f < l; ++f)r = h.item(f), r.time > t && r.time <= i && (r.index = n.m_points.indexOf(r.time), ++s);
        0 < s && o.updateAllViews()
    }
}
function FutureBarsRenderer(n) {
    this._data = n
}
function J96(n, t) {
    var i = n._undoModel.Q4, u = i.onWidget(), f = !1, f = u ? i._options && !i._options.hideIdeas : TVSettings.getBool("J96.visibile", !1), r;
    t ? t.merge({visible: f, frozen: !1}) : t = new Property({visible: f, frozen: !1});
    r = this;
    t.visible.listeners().subscribe(null, function (n) {
        u || i._containsData || TVSettings.setValue("J96.visibile", !!n.value());
        r._tooltip && r._tooltip.removeAll()
    });
    J47.call(this, n, null, t);
    this.onNeedRepaint = new Delegate;
    this._requests = [];
    this._marks = {};
    this._collectedRange = this._getDataTimeout = this._loadedRange = null;
    this.Q0.mainSeries().onSymbolIntervalChanged().subscribe(this, this.getNewData);
    this.Q0.mainSeries().onSymbolResolved().subscribe(this, this.getNewData);
    this.Q0.mainSeries().onTickmarksRangeChanged().subscribe(this, this.getData);
    this._initialize();
    this.pinnedTooltips = {};
    this._tooltip = new TooltipRenderer(this._createTooltip.bind(this), this)
}
function _59(n, t, i) {
    this.source = n;
    this.pane = t;
    this._rendererFactory = i
}
function BarsMarksContainerRenderer(n, t) {
    this._barWidth = n.barWidth;
    this._plates = n.plates;
    this._tooltip = n.tooltip;
    this.Q0 = t
}
function J97() {
    this._layout = [];
    this._currentId = void 0;
    this.tooltipHovered = !1
}
function UserDefinedBarsMarks(n) {
    J96.call(this, n);
    var t = this;
    TradingView.drawingState.hideMarksOnBars().subscribe(this, function () {
        t.Q2.visible.setValue(!TradingView.drawingState.hideMarksOnBars().value())
    })
}
function UserDefinedBarsMarksTooltip() {
    J97.call(this)
}
function J32(n, t) {
    this.J99 = n;
    this.Q0 = t;
    this._points = (new List).append(new MathEx.Point(0, 0))
}
function TriangleTextMarkRenderer(n, t) {
    this._data = n;
    this._textCache = t
}
function RectangleTextMarkRenderer(n, t) {
    this._data = n;
    this._textCache = t
}
function CircleShapeMarkRenderer(n, t) {
    this._data = n;
    this._textCache = t
}
function SquareShapeMarkRenderer(n, t) {
    this._data = n;
    this._textCache = t
}
function ArrowShapeMarkRenderer(n, t, i) {
    this._data = n;
    this._textCache = t;
    this._arrowDirection = i
}
function BackgroundRenderer(n) {
    this._data = n
}
function HorizHistogramRenderer(n) {
    this._data = n
}
function searchCoord(n, t) {
    for (var r = 0, u = n.length - 1; r <= u;) {
        var i = r + u >>> 1, f = n[i].y1, e = n[i].y2;
        if (f > t)r = i + 1; else if (e < t)u = i - 1; else return n[i + 1] && f == n[i + 1].y1 ? i + 1 : i
    }
    return-1
}
function PropertyGroup(n, t, i, r) {
    this._property = n;
    this._name = t;
    this._children = i;
    this._propertyPage = r
}
function Q7(n, t) {
    this.Q0 = t;
    this._bindings = new List;
    this._property = n
}
function Binding(n, t, i, r, u) {
    n ? (this._control = n, this._property = t, this._applyOnFly = i, this._undoModel = r, this._undoText = u, t && (this.setValue(t.value()), t.listeners().subscribe(this, Binding.prototype.propertyChanged))) : TradingView.logDebug("Binding: missing control")
}
function UppercaseTransformer(n) {
    return n.toUpperCase()
}
function GreateTransformer(n) {
    return function (t) {
        return t < n ? n : t
    }
}
function LessTransformer(n) {
    return function (t) {
        return t > n ? n : t
    }
}
function ToIntTransformer(n) {
    return function (t) {
        return t = parseInt(t, 10), isNaN(t) ? n : t
    }
}
function ToFloatTransformer(n) {
    return function (t) {
        return t = parseFloat(t), isNaN(t) ? n : t
    }
}
function ToAsciiTransformer() {
    return function (n) {
        var t = n;
        for (n = n.replace(/[^\u0000-\u007F]/, ""); n.length !== t.length;)t = n, n = t.replace(/[^\u0000-\u007F]/, "");
        return n
    }
}
function ReplaceEmptyTransformer(n) {
    return function (t) {
        return 0 === t.length ? n : t
    }
}
function SimpleStringBinder(n, t, i, r, u, f) {
    Binding.call(this, n, t, r, u, f);
    this._transformFunction = i;
    this._attachToControl(n, r)
}
function Q8(n, t, i, r, u, f) {
    this._subControlIds = t;
    Binding.call(this, n, i, r, u, f);
    this._forEachSubControl(function (n) {
        this._attachToControl(n, r)
    })
}
function Q9(n, t, i, r, u, f, e) {
    this.Q0 = r;
    this._mainSeries = f;
    this._toIntTransformer = ToIntTransformer(e);
    this._disabled = !1;
    Binding.call(this, n, t, i, r, u);
    var o = this;
    i && n.change(function () {
        o.setValueToProperty(o.value())
    });
    this._mainSeries.onBarReceived().subscribe(this, function () {
        o.setValue(this.property().value())
    })
}
function Q10(n, t, i, r, u) {
    if (Binding.call(this, n, t, i, r, u), i)n.on("accept-symbol", function (n, t) {
        this.setValueToProperty(t)
    }.bind(this))
}
function Q11(n, t, i, r, u, f, e) {
    Binding.call(this, n, t, r, u, f);
    this._transformFunction = i;
    this._setter = e;
    var o = this;
    r && n.change(function () {
        o._setter ? o._setter.call(o, o.value()) : o.setValueToProperty(o.value())
    })
}
function StaticContentBinder(n, t) {
    Binding.call(this, n, t)
}
function Q12(n, t, i, r, u, f) {
    if (!n.is(":checkbox, :radio"))return new Q12.PushButtonBinder(n, t, i, r, u);
    Binding.call(this, n, t, i, r, u);
    this._setter = f;
    var e = this;
    i && n.change(function () {
        e._setter ? e._setter.call(e, e.value()) : e.setValueToProperty(e.value())
    })
}
function DisabledBinder(n, t, i, r, u) {
    Binding.call(this, n, t, i, r, u)
}
function Q14(n, t, i, r, u) {
    i ? (Binding.call(this, n, t, !0, i, r), u ? n.callbacks().subscribe(this, u) : n.callbacks().subscribe(this, Q14.prototype.onActionCallback)) : TradingView.logDebug("Q14: Missed undo model")
}
function ColorBinding(n, t, i, r) {
    Binding.call(this, n, t, i, r);
    var u = this;
    i && n.change(function () {
        u.setValueToProperty(u.value())
    })
}
function SliderBinder(n, t, i, r, u) {
    isNumber(t.value()) || (console.warn("Property cannot be binded to control, bad value (expect number): " + t.value()), t = new Property);
    Binding.call(this, n, t, i, r, u);
    var f = this;
    i && (n.bind("slidechange", function (n, t) {
        f.setValueToProperty(t.value)
    }), n.bind("slide", function (n, t) {
        f.setValueToProperty(t.value)
    }));
    n.bind("slidestart", function () {
        r.beginUndoMacro(u)
    });
    n.bind("slidestop", function () {
        r.endUndoMacro()
    })
}
function Q15(n, t, i, r, u, f) {
    Q12.call(this, n, t, r, u, f);
    this._intervalProperty = i;
    this._intervalProperty.listeners().subscribe(this, this.onIntervalChanged);
    this.onIntervalChanged()
}
function WVBinding(n, t, i, r) {
    this._control = n;
    this._wv = t.spawn();
    this._transformFunction = i;
    this._undoText = r;
    this._attachToControl(this._control)
}
function CheckboxWVBinding(n, t, i, r, u) {
    this._not = !!u;
    WVBinding.apply(this, arguments)
}
function SeriesStylePropertyPageMixin() {
}
function _49(n, t, i) {
    Q7.call(this, n, t);
    this._linetool = i;
    this._templateList = new TradingView.LinetoolTemplatesList(this._linetool._constructor, this.applyTemplate.bind(this))
}
function clearRect(n, t, i, r, u, f) {
    n.save();
    "undefined" == typeof FlashCanvas && n.translate(-.5, -.5);
    n.fillStyle = f;
    n.fillRect(t, i, r, u);
    n.restore()
}
function _applyLocalizationToMetadata(n) {
    return n.description_localized = $.t(n.description, {context: "study"}), n
}
function CompareWidget(n) {
    this.Q5 = n;
    this.predefines = {"": {"S&P 500 Trust": "AMEX:SPY", "Nasdaq Composite": "INDEX:NASX", "Diamonds Trust": "AMEX:DIA", "Gold Trust": "AMEX:GLD", "Euro Currency Trust": "AMEX:FXE", "Nasdaq 100": "INDEX:IUXX", "Nasdaq Financial 100": "INDEX:IXF"}};
    this.symbolAlias = {"BATS:SPY": "AMEX:SPY", "BATS:DIA": "AMEX:DIA", "BATS:GLD": "AMEX:GLD", "BATS:FXE": "AMEX:FXE"}
}
function CompareDialog(n) {
    this.Q6 = n
}
function AddSymbolWidget(n) {
    this.Q5 = n;
    this.init()
}
function EditObjectDialog(n, t, i) {
    this.J99 = n;
    this.Q0 = t;
    this._undoCheckpoint = i
}
function ObjectTreeDialog(n, t) {
    this._defaultOptions = {maxHeight: 550, padding: 20, minHeight: 258};
    this.options = $.extend({}, this._defaultOptions, n || {});
    this.Q0 = t
}
function ManageDrawingsTab(n, t, i) {
    this.dialog = n;
    this.options = t || {};
    this.model = i
}
function ObjectsTreeTab(n, t, i) {
    this.dialog = n;
    this.options = t || {};
    this.model = i
}
function ObjectsTreeTabFilter(n) {
    this.$container = n;
    this.$button = $('<div class="button-filter">').click(function (n) {
        this.$button.trigger("button-popup", [this._getActions()]);
        n.stopPropagation()
    }.bind(this)).appendTo(n);
    TradingView.bindPopupMenu(this.$button, null, {event: "button-popup", addClass: "tree-tab-filter"});
    this.onChange = new Delegate
}
function _41(n, t, i, r) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this._showOnlyConfirmInputs = r;
    this.prepareLayout()
}
function _47(n, t, i) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this.prepareLayout()
}
function _39(n, t, i) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this._property = n;
    var r = null;
    $.each(t.m_model.panes().toArray(), function (n, t) {
        $.each(t.Q19().toArray(), function (n, u) {
            if (u == i)return r = t, !1
        })
    });
    this._pane = r;
    this.prepareLayout()
}
function D85(n, t, i) {
    var r, u;
    n = t.m_model.properties();
    Q7.call(this, n, t);
    r = this._series = t.mainSeries();
    this._chart = t.m_model;
    this.Q0 = t;
    this.J99 = i;
    this._property = n;
    this._seriesProperty = r.properties();
    this._scaleProperty = r.m_priceScale.properties();
    this._mainAxisProperty = r.properties().priceAxisProperties;
    u = null;
    $.each(t.m_model.panes().toArray(), function (n, t) {
        $.each(t.Q19().toArray(), function (n, i) {
            if (i == r)return u = t, !1
        })
    });
    this._pane = u;
    this.prepareLayout();
    this._themes = TradingView.getThemesList() || []
}
function _38(n, t) {
    Q7.call(this, n, t);
    this.prepareLayout()
}
function _14(n, t, i) {
    Q7.call(this, n, t);
    this._linetool = i;
    this.prepareLayout()
}
function D91(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D90(n, t, i) {
    _14.call(this, n, t, i)
}
function D93(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _32(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _12(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _11(n, t, i) {
    _14.call(this, n, t, i)
}
function _36(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _35(n, t, i) {
    _14.call(this, n, t, i)
}
function _18(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _17(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function LineToolTextInplaceEditor(n, t) {
    this.Q4 = n;
    this._undoModel = t
}
function _27(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _23(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D98(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D87(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _34(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _16(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D88(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _21(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D89(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D92(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _20(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _19(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _10(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _8(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _9(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D84(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _1(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D99(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _30(n, t, i) {
    _1.call(this, n, t, i)
}
function _31(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _3(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _2(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _4(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _5(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _6(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D94(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _24(n, t, i) {
    Q7.call(this, n, t);
    this._linetool = i;
    this.prepareLayout()
}
function D95(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _22(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _15(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D86(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function LineToolNotePropertyPage(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _43(n, t, i) {
    Q7.call(this, n, t);
    this._linetool = i;
    this.prepareLayout()
}
function _44(n, t, i) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this.prepareLayout()
}
function D97(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _25(n, t, i) {
    _14.call(this, n, t, i);
    this.prepareLayout()
}
function _26(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _33(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function D96(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _7(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _13(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _29(n, t, i) {
    _49.call(this, n, t, i);
    this.prepareLayout()
}
function _28(n, t, i) {
    _14.call(this, n, t, i)
}
function _42(n, t, i) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this.prepareLayout()
}
function _50(n, t, i) {
    Q7.call(this, n, t);
    this.Q1 = i;
    this.prepareLayout()
}
function RenameChartDialog(n, t, i) {
    this.title = n || $.t("Rename Chart Layout");
    this.label = t || $.t("Enter a new chart layout name");
    this.maxlength = i || ""
}
function LoadChartDialog() {
    this.title = $.t("Load Chart Layout");
    this.options = {};
    this.inputDelegate = new Delegate;
    this.matchedItems = [];
    this.itemsData = [];
    this.qs = new LoadChartDialog.QuickSearch(this.inputDelegate, this.fieldsExtractor, this.searchResult.bind(this));
    this.sortObj = new LoadChartDialog.SortObject(this.modifiedCompare);
    this.nameSort = new LoadChartDialog.SortObject(this.nameCompare);
    this.symbolSort = new LoadChartDialog.SortObject(this.symbolCompare);
    this.toolsSort = new LoadChartDialog.SortObject(this.toolsCompare);
    Q17.on("chart_loaded", LoadChartDialog.onChartLoaded, this)
}
function ChangeIntervalDialog(n) {
    this._options = n || {};
    this._setInput();
    this._caption = $('<i class="interval-caption">').html("&nbsp;");
    this._helpTooltipTrigger = $('<i class="help-tooltip-trigger">').text("?").blueTooltip($.t("interval_dialog_description"), "bottom");
    this._dialogTitle = $.t("Change Interval")
}
function strip_tags(n) {
    return n && n.replace ? n.replace(/(<([^>]+)>)/ig, "") : n
}
function encodeSpread(n) {
    return encodeURIComponent(n)
}
function truncate(n, t) {
    return n ? (t = void 0 === t ? 140 : t, n.length > t ? n.substr(0, n.indexOf(" ", t)) + "…" : n) : n
}
function changeLoginState(n) {
    is_authenticated = n ? !0 : !1;
    TVXWindowEvents.emit("loginStateChange", JSON.stringify({is_authenticated: is_authenticated, user: user}));
    loginStateChange.fire()
}
function loginUser(n) {
    user = $.extend({}, n);
    changeLoginState(!0);
    "function" == typeof D83.onSigninSuccess && (D83.onSigninSuccess(), D83.onSigninSuccess = void 0);
    D83.modalDialog && "Log in" == D83.modalDialog.data("title") && D83.destroy()
}
function signOut() {
    $.get("/accounts/logout/", function () {
        changeLoginState(!1)
    })
}
function runOrSignIn(n) {
    is_authenticated ? n() : D83.showSignInDialog(n)
}
function runOrGoPro(n, t) {
    user && user.is_pro ? n() : D83.showGoProDialog(t)
}
function following() {
    runOrSignIn(function () {
        document.location = "/following/"
    })
}
function followers() {
    runOrSignIn(function () {
        document.location = "/followers/"
    })
}
function handleIfNotError(n, t) {
    n.error ? console.log(n.error) : t(n)
}
function handleIfNotErrorFunc(n) {
    return function (t) {
        handleIfNotError(t, n)
    }
}
function relationChange(n, t, i) {
    var r = $(n);
    runOrSignIn(function () {
        var n;
        n = void 0 === r.data("type") ? t : r.data("type");
        $.post("/social/follow-the-user/", {targetId: i, follow: n}, function () {
            n ? (r.addClass("unfollow").removeClass("follow"), user.following++) : (r.removeClass("unfollow").addClass("follow"), user.following--);
            r.mouseleave();
            r.hasClass("follow-big") || followButtonTooltip(r);
            $(".following_count").text(user.following);
            r.data("type", 1 - n)
        }, "json")
    })
}
function followButtonsHandler(n) {
    n.on("click", ".follow-big", function () {
        var n = $(this);
        n.hasClass("unfollow") ? relationChange(n, 0, n.data("userid")) : (relationChange(n, 1, n.data("userid")), n.hover())
    }).on("mouseenter", ".follow-big", function () {
        $(this).hasClass("unfollow") && $(this).text("Unfollow")
    }).on("mouseleave", ".follow-big", function () {
        $(this).hasClass("unfollow") && $(this).text("Following")
    })
}
function bindIdeasStreamFilter(n, t) {
    t = t || {};
    var i = n.find(".filter").map(function () {
        function c(n, o) {
            var s = $(this), a = s.data("name"), v, p, b, c;
            if (!0 === r || r[a])n && n.preventDefault(); else {
                if (f && e.find(".temp").remove(), !is_authenticated && s.hasClass("authorization-required"))return D83.showSignInDialog(null, 0), !1;
                if (v = a ? h.filter("[name=" + a + "]") : h, p = s.data("value"), (v && v.val() != p || t.forceChange) && (u.filter(".active").filter(a ? "[data-name=" + a + "]" : "*").removeClass("active").find(".active-underline").remove(), s.addClass("active"), v.val(p).change(), o || "function" != typeof t.onChange || setTimeout(function () {
                    t.onChange(n, v.attr("name"), p)
                }, 0)), b = s.data("hook"), b)for (key in b)i.forEach(function (n) {
                    -1 < n.inputs.indexOf(key) && n.obj.setValue(b[key], key)
                });
                f && 0 == e.find("a[data-value=" + p + "]").length && s.clone(!0).addClass("temp item").append('<span class="active-underline"><\/span>').appendTo(e);
                !t.notPreventDefault && t.onChange && n && n.preventDefault();
                f || (c = u.filter(".active[data-filter-title]:first").data("filter-title") || w, c ? u.filter(".active").each(function () {
                    c = c.replace("%" + $(this).data("name") + "%", $(this).contents(":first").text())
                }) : c = s.contents(":first").text(), y.text(c));
                l(!0)
            }
        }

        function l(t) {
            "boolean" != typeof t && (t = a);
            t ? (s.stop(!0, !1).fadeOut(p), n.unbind("clickoutside").removeClass("active"), a = !1) : (s.stop(!0, !1).fadeIn(p), n.one("clickoutside", l).addClass("active"), a = !0)
        }

        var n = $(this), s = n.find(".dropdown"), a = !1, h = n.find("input"), y = n.find(".selected"), f = !1, p = "undefined" == typeof t.speed ? 50 : t.speed, w = n.data("filter-title"), u, o, e, r, v;
        n.find(".selected").on("click", l);
        s.on("click", "a", c);
        return u = s.find("a"), o = n.parent(".filter-tabbed"), o.length && (f = !0, e = o.find(".tabs"), u = u.add(e.find("a:not(.temp)")), e.on("click", "a", c)), r = {}, n.find(".sub-group.inactive").find("a:first").each(function (n, t) {
            r[$(t).data("name")] = !0
        }.bind(this)), v = {setValue: function (n, t) {
            var i = u.filter("a[data-value=" + n + "]" + (1 < h.length && t ? "[data-name=" + t + "]" : ""));
            c.apply(i, [void 0, !0])
        }, getActiveTitle: function () {
            return y.text()
        }, disabled: function (t, i) {
            i ? $("[data-name=" + i + "]", n).closest(".sub-group").addClass("inactive") : f ? o.addClass("inactive ") : n.addClass("inactive ");
            t || (i ? ("object" != typeof r && (r = {}), r[i] = !0) : r = !0)
        }, enabled: function (t) {
            t ? ($("[data-name=" + t + "]", n).closest(".sub-group").removeClass("inactive"), "object" == typeof r && (r[t] = !1)) : (f ? o.removeClass("inactive ") : n.removeClass("inactive "), r = !1)
        }}, n.data("interface", v), {inputs: h.map(function (n, t) {
            return $(t).attr("name")
        }).get(), obj: v}
    }).get()
}
function chartWithCover(n) {
    n.find(".date").each(function () {
        var n = $(this), t = new Date(n.text());
        TradingView.agoDateFormatter(n, t)
    });
    n.find(".desc").each(function () {
        var n = $(this);
        n.height(n.parent().outerHeight() - n.position().top - 5)
    }).ellipsis()
}
function deleteChart(n, t) {
    var i = [n];
    D83.showConfirm($.t("Confirmation"), $.t("Are you sure you want to delete this chart?"), function () {
        if (J77.enabled("saveload_storage_customization"))return ChartsStorage.removeChart(n, t);
        $.post("/deletechart/", {uid: i}, function (n) {
            n.error || ("string" == typeof t ? document.location = t : "function" == typeof t ? t() : window.location.reload())
        })
    })
}
function saveChart(n, t, i, r) {
    if (J77.enabled("saveload_storage_customization"))return ChartsStorage.saveChart(n.name, n.short_name, n.resolution, n, t.id.value(), function (n) {
        t.id.value() || (t.id.setValue(n), t.uid.setValue(n));
        i()
    }, r);
    $.post("/savechart/", n, function (n) {
        "ok:" === n.substr(0, 3) ? (json = n.substr(3), res = JSON.parse(json), t.id.value() || (t.id.setValue(res.id), t.uid.setValue(res.uid)), "function" == typeof i && i({uid: t.uid.value()}, res.count || 0)) : "saved_chart_limit_reached" == n || "" == n ? ("function" == typeof r && r(), D83.showGoProDialog({feature: "savedChartsLimit"})) : ("function" == typeof r && r(), $("#error").html(n));
        $(window).off("beforeunload.savechart")
    })
}
function openSavedChart(n) {
    J77.enabled("saveload_storage_customization") ? ChartsStorage.loadChart(n) : open("/e/" + n.url + "/" + (TradingView.isMobileView ? "?mobile=1" : ""), "_blank")
}
function toggleTitleOfModerationButton(n, t, i) {
    i ? (n.attr("title", t), n.addClass("apply-common-tooltip")) : (n.removeAttr("title"), n.removeClass("apply-common-tooltip"))
}
function recommendChart(n, t) {
    var i = t ? $(t) : $("#chart-recommend-button");
    i.toggleClass("active");
    $.post("/recommend/", {id: n, type: "recommend"}, function (n) {
        i.toggleClass("active", !!n.state)
    })
}
function bullseyeChart(n, t) {
    var i = t ? $(t) : $("#chart-bullseye-button");
    i.hasClass("disabled") || (i.toggleClass("active"), $.post("/recommend/", {id: n, type: "bullseye"}, function (n) {
        i.toggleClass("active", !!n.state)
    }))
}
function updateSuggestedView(n, t) {
    var i = $("#chart-" + n + "-suggested-button"), r = $("#chart-" + n + "-not-suggested-button");
    i.toggleClass("active", !!t);
    r.toggleClass("active", !t);
    toggleTitleOfModerationButton(i, "By " + user.username, !!t);
    toggleTitleOfModerationButton(r, "By " + user.username, !t);
    $("#chart-" + n).removeClass("not-moderated")
}
function suggestChart(n, t) {
    updateSuggestedView(n, t);
    $.post("/recommend/", {id: n, type: "hot", state: (!!t).toString()}, function (t) {
        updateSuggestedView(n, t.state)
    })
}
function chartTogglePublic(n, t) {
    var i = t ? $(t) : $("#chart-public-button");
    i.toggleClass("active");
    $.post("/togglepublic/", {id: n}, function (n) {
        toggleTitleOfModerationButton(i, "By " + user.username, n.state);
        i.toggleClass("active", !!n.state)
    })
}
function chartRepostSTTW(n, t) {
    var i = $(t);
    i.addClass("active");
    $.post("/repoststtw/", {id: n}, function (n) {
        i.toggleClass("active", !!n.state)
    })
}
function chartToggleIOTD(n, t) {
    function u() {
        i.toggleClass("active", r)
    }

    var i = t ? $(t) : $("#chart-iotd-button"), r;
    i.is(".disabled") || (r = i.hasClass("active"), i.toggleClass("active", !r), $.post("/toggle-iotd/", {id: n}, function (t) {
        t.state && updateSuggestedView(n, !0)
    }).done(function (n) {
        if (n.error)return u();
        i.toggleClass("active", !!n.state).toggleClass("disabled", !!n.disabled)
    }).fail(u))
}
function trendingPeople(n) {
    n.on("click", ".column-trending-people .tabs a", function (t) {
        var i = $(this);
        if (i.hasClass("active"))return!1;
        i.addClass("active").siblings("a").removeClass("active");
        n.find(".top-user-group").hide().filter("." + i.attr("href").slice(1)).show();
        t.preventDefault()
    })
}
function showDisconnectedMessage() {
    "MozWebSocket"in window && WEB_SOCKET_WAS_CONNECTED ? setTimeout("showDisconnectedMessageImpl()", "15000") : showDisconnectedMessageImpl()
}
function showDisconnectedMessageImpl() {
    TradingView.trackEvent("System", "Disconnect");
    D83.showNotice("Connection is lost", {html: '<p class="tv-dialog-left">Connection to server was lost<br/><br/>How to fix:<ol class="tv-dialog-left"><li>Check firewall settings and make sure access to websocket (' + WEBSOCKET_HOST + " port " + WEBSOCKET_PORT + ') is open. Then click Reconnect or press F5.<\/li><li>Your browser doesn’t support <strong>WebSocket<\/strong> technology and does not have <strong>Adobe Flash<\/strong> plugin installed.<br/>Please, <a href="http://get.adobe.com/flashplayer/" target="_blank">install Flash plugin<\/a> or consider updating to one of these modern browsers with WebSocket support:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome<\/a><\/li><li><a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank">Firefox<\/a><\/li><\/ul><\/li><li>Server broke the connection. Click Reconnect or press F5.<\/li><\/ol><\/p><input class="tv-button xwide" type="button" value="Reconnect" onclick="D83.destroy();"/>', doNotCloseOnBgClick: !0}).on("destroy", function () {
        Q16.connect()
    })
}
function showCriticalErrorMessage() {
    TradingView.trackEvent("System", "Critical Error");
    D83.showNotice("Critical error appeared", {html: '<input class="tv-dialog-button" type="button" value="Retry" onclick="D83.destroy();"/>', doNotCloseOnBgClick: !0}).on("destroy", function () {
        Q16.connect()
    })
}
function toggleUserSavedCharts(n) {
    var t = $(n).toggleClass("active");
    $(".my-saved-charts").toggle();
    t.is(".active") ? $(document).bind("click.toggleUserSavedCharts", function (t) {
        $(t.target).is(".saved-charts-button") || toggleUserSavedCharts(n)
    }) : $(document).unbind("click.toggleUserSavedCharts")
}
function makeDirectionName() {
    return function (n, t) {
        var i = t(n);
        return"0" == i ? "Neutral" : "1" == i ? "Long" : "Short"
    }
}
function gotochart(n) {
    location.href = "/v/" + n + "/"
}
function closeGlobalNotification(n) {
    $.cookie("notification_id", n, {expires: 365, path: "/"});
    $(".tv-global-notification").slideUp(400, function () {
        $(window).resize()
    })
}
function getImage(n, t, i) {
    function s(i) {
        i = J77.enabled("charting_library") ? (t.snapshotUrl ? "" : "http://www.tradingview.com/x/") + i + "/" : window.location.protocol + "//" + window.location.host + "/x/" + i;
        o.attr({href: i});
        u.val(i);
        h.remove();
        r.css({visibility: "visible"});
        setTimeout(function () {
            var n = u.get(0);
            n.focus && n.focus();
            n.select && n.select()
        }, 0);
        i = ShareTwitterSnapshot.getStatus(n.activeChartWidget.value().symbolProperty().value(), i);
        $('<a class="twitter-share-button tv-dialog-social tv-dialog-social-twitter"><\/a>').attr({href: "https://twitter.com/share?count=none&text=" + encodeURIComponent(i) + "&url=%20"}).appendTo(f);
        $('<script src="//platform.twitter.com/widgets.js"><\/script>').appendTo(f)
    }

    var f;
    t = t || {};
    D83.createModalDialog($.t("Image URL"), {addClass: "tv-dialog-min-width"});
    dialog = D83.modalDialog;
    var e = dialog.find(".tv-dialog-content"), h = $("<p><img src=" + TradingView.wrapUrl('"/static/images/loading-small.gif"') + "/><\/p>").css({textAlign: "center", position: "absolute", width: "100%"}).appendTo(e), r = $('<div class="main">').css({visibility: "hidden"}).appendTo(e), o = $("<a>").text($.t("Save image")).attr({target: "_blank"}).css("text-decoration", "underline"), u = $("<input>").attr({type: "text", readonly: !0}).bind("click focus", function () {
        this.select && this.select()
    });
    return $("<p>").appendTo(r).append(o, " " + $.t("or copy url:")), $("<p>").appendTo(r).append($("<form>").append(u)), f = $('<p class="tv-dialog-socials">').appendTo(r), D83.positionDialog(), D83.applyHandlers(), TradingView.trackEvent("GUI", "Get image button"), takeSnapshot(n, function (n) {
        i && i(n);
        s(n)
    }, function () {
        dialog.find(".tv-dialog-error").text("URL cannot be recieved.").show()
    }, {snapshotUrl: t.snapshotUrl}), !1
}
function onLoginStateChange(a) {
    if ($("html").toggleClass("is-authenticated", is_authenticated).toggleClass("is-not-authenticated", !is_authenticated).toggleClass("is-pro", is_authenticated && user && !!user.is_pro).toggleClass("is-not-pro", !(is_authenticated && user && user.is_pro)).toggleClass("is-trial", is_authenticated && user && "pro_realtime_trial" === user.pro_plan).toggleClass("is-not-trial", !(is_authenticated && user && "pro_realtime_trial" === user.pro_plan)).toggleClass("is-mobile", !!TradingView.isMobileView), TVSettings.sync(user.settings), is_authenticated) {
        if (a || ($(".header-item-profile strong.user-badge").remove(), $(".header-item-profile > a").append(userBadge(user, !0, "strong"))), $(".user-info-username").html(user.username), $(".following_count").html(user.following), $(".followers_count").html(user.followers), $(".saved_charts_count").html(user.saved_charts), $(".published_charts_count").html(user.published_charts), $(".treated_charts_count").html(user.treated_charts_count), $("img.user-picture, .user-picture img").attr("src", user.userpic), $(".trial-days-left").html(user.trial_days_left || ""), $(".header-item-profile").find("a").each(function (n, t) {
            t = $(t);
            var i = t.attr("rel");
            i && t.attr("href", i.replace("%u", user.username))
        }), "undefined" != typeof carouselModels)for (var b in carouselModels)carouselModels[b].reload();
        user.fastpass_script && eval(user.fastpass_script);
        user.is_first_login && (TradingView.trackEvent("Conversion", "First login"), user.prort_trial_started && (D83.showTrialMessageSuccess(), delete user.prort_trial_started), delete user.is_first_login);
        setTrialAvailiable(user.trial_availiable)
    } else user = {username: "Guest", following: "0", followers: "0", ignore_list: {}}, $(".user-info-username").html(user.username), window.localStorage && localStorage.removeItem("trial_availiable");
    window.studyTemplates && (studyTemplates.refreshStudyTemplateList(), studyTemplates.refreshFavoriteDropdownMenu())
}
function markNewsAsRead() {
    $(".user-picture .notifications-counter").hide().addClass("hide");
    $(".notifications-counter.counter").removeClass("new").text("0");
    TVXWindowEvents.emit("zero-notification-counter")
}
function followButtonTooltip(n) {
    var t = n.hasClass("unfollow") ? "Unfollow" : "Follow";
    n.attr("title", t)
}
function followButtonToolipAll() {
    $(".follow-link").each(function (n, t) {
        t = $(t);
        t.data("tv_tooltip") || followButtonTooltip(t)
    })
}
function getSavedChartsList(n) {
    return J77.enabled("charting_library") ? ChartsStorage.getCharts(n) : $.getJSON("/my-charts/", n)
}
function isOnChartEditPage() {
    return"/e/" == location.pathname.substr(0, 3)
}
function refreshChartMenuState() {
    function r(r) {
        if (r = {charts: r}, r.charts && r.charts.length) {
            n.append(Mustache.render(TradingView.templates.lists.savedCharts, r));
            var u = new D59(n, n.find("ul").eq(0), {additionalClass: "gray", alwaysVisible: !0});
            n.parent().one("hover", function () {
                u.updateScrollBar()
            });
            n.find("li").each(function (t, i) {
                var u, f;
                i = $(i);
                u = i.find(".name").text();
                20 < u.length && i.attr("title", u);
                f = r.charts[t].image_url;
                $("span.icon", i).click(function (t) {
                    return n.mouseleave(), deleteChart(f, function () {
                        user.saved_charts--;
                        var n = $(t.target).parent().attr("href");
                        $(t.target).parent().parent().remove();
                        !isOnChartEditPage() || user.saved_charts && "/e/" + Q3.metaInfo().uid + "/" != n ? refreshChartMenuState() : location.href = "/e/"
                    }), !1
                })
            })
        } else t.hide(), i.show()
    }

    var i = $(".header-button.header-item-chart"), t = $(".header-menu.header-item-chart"), n = t.find(".popup-subblock");
    t.length && n.length && (t.on("click", function () {
        getSavedChartsList(r)
    }), is_authenticated && user.saved_charts ? (i.hide(), t.show(), n.empty()) : (t.hide(), i.show()))
}
function urlize(n) {
    var t, u = [], f = 0, i = "", r;
    if (i = n.match(/(https:\/\/|http:\/\/)(www.tradingview.com|beta\d?.tradingview.com|webcharts\d?|localhost\:6285)\/(x|i)\/[0-9a-z]{8}\//gi))for (t = 0; t < i.length; t++)n = n.replace(i[t], "<" + f++ + ">"), u.push('<div class="ch-item-snapshot-link"><i class="icon icon-snapshot-small" title="Chart Snapshot"><\/i> <a href="' + i[t] + '" target="_blank">Chart Snapshot<\/a><\/div><a target="_blank" href="' + i[t] + '" class="ch-item-snapshot-preview"><img src="' + i[t] + '" alt="" class="snapshot-preview"/><\/a>');
    if (r = n.match(/(https:\/\/|http:\/\/)(www.tradingview.com|beta\d?.tradingview.com|webcharts\d?|localhost\:6285)\/v\/[0-9a-z]{8}\//gi), r)for (t = 0; t < r.length; t++)n = n.replace(r[t], "<" + f++ + ">"), i = r[t].match(/\/v\/([0-9a-z]{8})\//i)[1], u.push('<div class="ch-item-chart-link"><i class="icon icon-snapshot-small" title="Published Idea"><\/i> <a href="' + r[t] + '" target="_blank" data-id="' + i + '">Published Idea<\/a><\/div><a target="_blank" href="' + r[t] + '" class="ch-item-chart-preview" data-id="' + i + '"><img src="' + r[t].replace("/v/", "/i/") + '" alt="" class="idea-preview"/><\/a>');
    if (i = n.match(/(http:\/\/|http:\/\/www\.|https:\/\/www\.|https:\/\/)[^ <\n]{2,200}/g))for (t = 0; t < i.length; t++)r = 0 === i[t].indexOf("http://") || 0 === i[t].indexOf("https://") ? "" : "http://", n = n.replace(i[t], "<" + f++ + ">"), u.push("<a target='_blank' href='" + r + i[t] + "'>" + i[t] + "<\/a>");
    if (i = n.match(/(\$)[^0-9][a-z0-9\._-]{2,20}/gi))for (t = 0; t < i.length; t++)n = n.replace(new RegExp("\\" + i[t], "gi"), "<" + f++ + ">"), u.push("<a target='_blank' href='/s/?q=" + i[t].substr(1) + "'>" + i[t] + "<\/a>");
    if (i = n.match(/\@[a-z0-9\._-\u00A0]{2,50}/gi))for (t = 0; t < i.length; t++)n = n.replace(new RegExp(i[t], "gi"), "<" + f++ + ">"), u.push("<a target='_blank' href='/u/" + i[t].substr(1).replace(" ", " ") + "/'>" + i[t] + "<\/a>");
    return 0 < u.length && (n = n.replace(/<(\d+)>/g, function (n, t) {
        return u[t] ? u[t] : ""
    })), n
}
function ShareTwitterSnapshot(n) {
    function t(n, t) {
        return"https://twitter.com/intent/tweet?&status=" + encodeURIComponent(ShareTwitterSnapshot.getStatus(n, window.location.protocol + "//" + window.location.host + "/x/" + t + "/"))
    }

    if (TradingView.winMobileMode)this.onSuccess = function (i) {
        try {
            JsBridge.sendEvent(t(n, i), "sharing_ready")
        } catch (r) {
        }
    }, this.onFailure = function () {
        try {
            JsBridge.sendEvent("sharing_error")
        } catch (n) {
        }
    }; else {
        var i = open("about:blank", "snapshot_tweet", "scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left=" + Math.round(screen.width / 2 - 275) + ",top=" + Math.round(screen.height / 2 - 210));
        this.onSuccess = function (r) {
            i.location.href = t(n, r)
        };
        this.onFailure = function () {
            i.close()
        }
    }
}
function ShareStocktwitsSnapshot(n) {
    function t(n, t) {
        return"https://stocktwits.com/widgets/share?body=" + encodeURIComponent(ShareStocktwitsSnapshot.getStatus(n, window.location.protocol + "//" + window.location.host + "/x/" + t + "/"))
    }

    if (TradingView.winMobileMode)this.onSuccess = function (i) {
        try {
            JsBridge.sendEvent(t(n, i), "sharing_ready")
        } catch (r) {
        }
    }, this.onFailure = function () {
        try {
            JsBridge.sendEvent("sharing_error")
        } catch (n) {
        }
    }; else {
        var i = open("about:blank", "snapshot_tweet", "scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,left=" + Math.round(screen.width / 2 - 275) + ",top=" + Math.round(screen.height / 2 - 210));
        this.onSuccess = function (r) {
            i.location.href = t(n, r)
        };
        this.onFailure = function () {
            i.close()
        }
    }
}
function authInStocktwits(n) {
    runOrSignIn(function () {
        user.has_stocktwits ? "function" == typeof n && n() : ("function" == typeof n && (user.on_stocktwits_auth_success = function () {
            n.apply(this, Array.prototype.slice.call(arguments));
            this.user.on_stocktwits_auth_success && delete this.user.on_stocktwits_auth_success
        }.bind(window)), window.open("https://api.stocktwits.com/api/2/oauth/authorize?client_id=" + stocktwits_consumer_key + "&response_type=code&redirect_uri=" + location.protocol + "//" + location.host + "/accounts/return/stocktwits/&scope=publish_messages", "stocktwits_permission_request", "scrollbars=yes,height=400,width=700").focus())
    })
}
function userlink(n, t) {
    return Mustache.render(TradingView.templates.userlink, {username: n, is_pro: function () {
        return!!t
    }, is_realtime: function () {
        return"pro_realtime" == t
    }, is_premium: function () {
        return"pro_premium" == t
    }, is_trial: function () {
        return"pro_realtime_trial" == t
    }}, TradingView.templates)
}
function proBadge(n, t) {
    return void 0 === n || n ? Mustache.render(TradingView.templates.proBadge, {is_realtime: "pro_realtime" == n, is_premium: "pro_premium" == n, is_trial: "pro_realtime_trial" == n, large_badge: !!t}) : ""
}
function userBadge(n, t, i) {
    var r = "", u = "";
    if (n.top_user_info) {
        if (r = n.top_user_info.badge ? n.top_user_info.badge.title : "", u = n.top_user_info.badge ? n.top_user_info.badge["class"] : "", n.is_pro)switch (r += " | ", n.pro_plan) {
            case"pro_realtime_trial":
                r += "Pro Trial";
                break;
            case"pro_premium":
                r += "Premium";
                break;
            case"pro_realtime_trial":
                r += "Pro Plus";
                break;
            default:
                r += "Pro"
        }
        n.is_moderator && (r += " | Moderator")
    }
    return Mustache.render(TradingView.templates.userBadge, {is_moderator: n.is_moderator, is_pro: n.is_pro, is_realtime: "pro_realtime" == n.pro_plan, is_premium: "pro_premium" == n.pro_plan, is_trial: "pro_realtime_trial" == n.pro_plan, is_top: !!n.top_user_info, badge_class: u, badge_title: r, large_badge: !!t, badge_tag: i}, TradingView.templates)
}
function updateChartActiveLabel(n, t) {
    null == n && (n = $(".chart-activity-label"));
    n = $(n);
    n.each(function () {
        var i = $(this), n;
        null == t ? n = i.hasClass("chart-activity-label-active") : (n = t, i.toggleClass("chart-activity-label-active", n));
        i.find(".chart-activity-label-plate").text(n ? "Active" : "Closed")
    })
}
function hash(n) {
    var t = 0;
    if (0 == n.length)return t;
    for (i = 0; i < n.length; i++)code = n.charCodeAt(i), t = (t << 5) - t + code, t &= t;
    return t
}
function uniq(n) {
    return n.reduce(function (n, t) {
        return~n.indexOf(t) ? null : n.push(t), n
    }, [])
}
function bindLate(n, t) {
    return function () {
        return n[t].apply(n, arguments)
    }
}
function debounce(n, t) {
    var i;
    return function () {
        clearTimeout(i);
        i = setTimeout(n.bind.apply(n, [this].concat(Array.prototype.slice.call(arguments))), t)
    }
}
function isLatin(n) {
    return!/[^\u0000-\u00FF\u00A0\u2013-\u2122\u2200-\u23FF]/g.test(n)
}
function isASCII(n, t) {
    return(t ? /^[\x00-\xFF]*$/ : /^[\x00-\x7F]*$/).test(n)
}
function RegExpEscape(n) {
    return n.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&")
}
function loadMorePeople(n, t, i) {
    var u = t.$loading || $(), f = t.$button || $(), r = t.$container, e, o;
    u.show();
    f.hide();
    e = i ? 0 : r.children().length;
    n.data || (n.data = {});
    n.data = $.extend({}, n.data, {offset: e});
    $.ajax(n).done(function (n) {
        var e = n.total, u = n.items;
        i && (r.data("loaded", !1), r.empty());
        0 < u.length ? u.forEach(function (n) {
            n.follow_button = !is_authenticated || user.id != n.id;
            n.links = n.profile.location || n.profile.twitter_username || n.profile.website;
            n.badge = userBadge(n, !0);
            n.reputation_delta && (n.reputation_delta = Math.round(n.reputation_delta));
            $(Mustache.render(o, n)).appendTo(r)
        }) : i && t.empty && r.append($('<div class="empty"><\/div>').text(t.empty));
        r.children().length < e && f.show();
        n.thats_all && r.data("loaded", !0)
    }).always(function () {
        u.hide()
    });
    o = "<div class='item follow-list-item'>\t<a href='/u/{{ username }}/'><img src='{{ mid_picture_url}}'><\/a>\t<div class='indent'>\t<div class='description'>\t\t<div class='user-stats'>\t\t\t<span class='user-stats-followers' title='Followers'><a href='/u/{{ username }}/#followers'>{{ followers_count }}<\/a><\/span>\t\t\t<span class='user-stats-charts' title='Charts'><a href='/u/{{ username }}/#charts'>{{ charts_count }}<\/a><\/span>\t\t\t<span class='user-stats-reputation' title='Reputation'>{{ reputation }}{{# reputation_delta }} (+{{reputation_delta}}){{/ reputation_delta }}<\/span>\t\t<\/div>\t\t<div class='username'><a href='/u/{{ username }}/' class='userlink'>{{ username }}<\/a>{{& badge }}<\/div>\t\t{{# links }}\t\t<div class='links'>\t\t\t{{# profile.location }}<span class='contact location'>{{ profile.location }}<\/span>{{/ profile.location }}\t\t\t{{# profile.twitter_username }}<span class='contact twitter'><a href='//twitter.com/{{ profile.twitter_username }}' target='_blank'>{{ profile.twitter_username }}<\/a><\/span>{{/ profile.twitter_username }}\t\t\t{{# profile.website }}<span class='contact webpage'><a href='{{ profile.website }}' target='_blank'>{{ profile.website }}<\/a><\/span>{{/ profile.website }}\t\t<\/div>\t\t{{/ links }}\t\t{{# profile.about }}\t\t<div class='about'>{{ profile.about }}<\/div>\t\t{{/ profile.about }}\t\t{{# follow_button }}\t<\/div>\t\t<div class='action-buttons'>\t\t\t<button class='follow-user follow-user-{{ id }}{{# follow_status }} active{{/ follow_status }}'  title='{{#follow_status}}Unfollow{{/follow_status}}{{^follow_status}}Follow{{/follow_status}}' data-id='{{ id }}'>\t\t\t\t<span class='follow'>Follow<\/span>\t\t\t\t<span class='following'>Followed<\/span>\t\t\t\t<span class='unfollow'>Unfollow<\/span>\t\t\t<\/button> \t\t\t<button class='message-user message active' title='Send message' data-id='{{ id }}' data-username='{{ username }}'><span class='message'>Message<\/span><\/button>\t\t<\/div>\t\t{{/ follow_button }}\t<\/div><\/div>"
}
function follow(n) {
    runOrSignIn(function () {
        var t = $(n.currentTarget), r = t.data("id"), i;
        t.is(".self") || (i = t.is(".active") ? 0 : 1, $.ajax({url: "/social/follow-the-user/", type: "POST", data: {targetId: r, follow: i}}).done(function () {
            $(".follow-user-" + r).toggleClass("active").attr("title", i ? "Unfollow" : "Follow")
        }))
    })
}
function chartRelationButtons(n) {
    var t = n.closest("[data-chart-id]").data("chart-id");
    if (!t)throw Error("chartRelationButtons can`t find data-chart-id attribute");
    n.on("click", ".agree", function (n) {
        function r() {
            i.toggleClass("active", u)
        }

        n.preventDefault();
        var i = $(this), u = i.hasClass("active");
        runOrSignIn(function () {
            i.toggleClass("active", !u);
            $.post("/vote-for-chart/", {id: t, vote: 1}).done(function (n) {
                if (n.error)return r();
                void 0 !== n.result_score && i.text(n.result_score || "").toggleClass("with-counter", 0 !== n.result_score)
            }).fail(r)
        })
    });
    n.on("click", ".fav", function (n) {
        function u() {
            i.toggleClass("active", r)
        }

        n.preventDefault();
        var i = $(this), r = i.hasClass("active");
        runOrSignIn(function () {
            i.toggleClass("active", !r);
            $.post(r ? "/remove-from-favorites/" : "/add-to-favorites/", {id: t}).done(function (n) {
                if (n.error)return u();
                void 0 !== n.followers && i.text(n.followers || "").toggleClass("with-counter", 0 !== n.followers)
            }).fail(u)
        })
    })
}
function makeTextContainerEditable(n, t, i) {
    function r(t) {
        n.removeClass("tv-editable-active").on("click", function () {
            f(i)
        }).off("mousedownoutside");
        t && n.empty().text(t)
    }

    function u(t) {
        n.addClass("tv-editable-active").off("click").on("mousedownoutside", function () {
            r(t)
        })
    }

    function f(i) {
        var e = {okButtonText: $.t("OK"), okButtonClass: "tv-button ok", cancelButtonText: $.t("Cancel"), cancelButtonClass: "tv-button cancel"}, s, h;
        i = $.extend({}, e, i);
        var o = n.text(), e = Modernizr.touch ? "" : o, f = "textarea" === i.replaceWith ? $("<textarea" + (i.inputClass ? 'class="' + i.inputClass + '" ' : "") + "><\/textarea>") : $('<input type="text" ' + (i.inputClass ? 'class="' + i.inputClass + '" ' : "") + 'value="">');
        f.val(e);
        var e = $('<div class="buttons"><\/div>'), c = $('<div class="' + i.okButtonClass + '">' + i.okButtonText + "<\/div>").appendTo(e), l = $('<div class="' + i.cancelButtonClass + '">' + i.cancelButtonText + "<\/div>").appendTo(e);
        u(o);
        s = "function" == typeof i.onCancel ? function () {
            i.onCancel();
            r()
        } : function () {
            r(o)
        };
        h = function (n, i, u) {
            /^\s+$/.test(i) && (i = "");
            f.attr("disabled", "disabled");
            c.addClass("process");
            t(n, i, u, function () {
                r()
            })
        };
        c.click(function (t) {
            t.preventDefault();
            t.stopPropagation();
            h(n, f.val(), o)
        });
        l.click(function (n) {
            n.preventDefault();
            n.stopPropagation();
            s()
        });
        f.keyup(function (t) {
            t.preventDefault();
            t.stopPropagation();
            13 != t.keyCode || t.shiftKey ? 27 == t.keyCode && s() : h(n, f.val(), o)
        });
        n.empty().append(f, e);
        f.select()
    }

    !n instanceof $ ? console.error("$container should be jQuery object") : t ? "function" != typeof t ? console.error("onOk should be function") : (n.addClass("tv-editable"), r()) : console.error("onOk required")
}
function changeUserProfileField(n) {
    function t(n) {
        var t = Array.prototype.slice.call(arguments);
        t.shift();
        "function" == typeof n && n.apply(this, t)
    }

    if (n && n.name && "undefined" != typeof n.value) {
        var i = {};
        i[n.name] = n.value;
        $.post("/accounts/change_data_json/", i, function (i) {
            !i.errors || $.isEmptyObject(i.errors) ? (i = i[n.name], user[n.name] = i, t(n.onSuccess, i)) : t(n.onError, i.errors[n.name])
        }).error(function (i) {
            403 === i.status ? t(n.onError, "Please, try to reoload page to edit user data") : t(n.onError, D13.isProd() ? "Sorry, an error has occurred" : i.responseText)
        }).always(function () {
            t(n.onComplete)
        })
    } else console.warn("Required options.name and options.value")
}
function setTrialAvailiable(n) {
    window.localStorage && (window.localStorage.trial_availiable = n ? 1 : 0)
}
function translatedIntervalString(n) {
    var t = ("" + n).match(/(.*)([DWM])/);
    return t ? t[1] + $.t(t[2], {context: "dates"}) : n
}
function capitalizeFirstLetter(n) {
    return n.charAt(0).toUpperCase() + n.slice(1)
}
function generateColor(n, t) {
    if (0 <= t && 100 >= t) {
        var i = parseInt(n.substr(1, 2), 16), r = parseInt(n.substr(3, 2), 16), u = parseInt(n.substr(5, 2), 16);
        return"rgba(" + i + ", " + r + ", " + u + ", " + (1 - t / 100).toFixed(2) + ")"
    }
    throw"invalid transparency";
}
function pow10Increment(n, t, i) {
    var u = 1, r;
    return 0 > n && (u = -1, t = !t), i = Math.abs(i), isFinite(i) || (i = 1), n = Math.abs(n), r = Math.pow(10, Math.floor(Math.log(n) / Math.LN10)) || i || 0, 10 * r <= n && (r *= 10), t && n === r && (r /= 10), r < i && (r = i), t ? Math.ceil(n / r - 1) * r * u : Math.floor(n / r + 1) * r * u
}
function abbreviatedNumber(n) {
    var i = 0, t;
    if (n = +n, isFinite(n))for (; 1e3 <= n && 0 == n % 100;)i++, n /= 1e3;
    return t = " K M G T Y".split(" ")[i], null == t && (t = "e" + 3 * i), n + t
}
function makeFont(n, t, i) {
    return i + " " + n + "px " + t
}
function ChartSaver(n) {
    this.Q5 = n
}
function takeSnapshot(n, t, i, r) {
    r = r || {};
    var u = {wl: r.wl, images: JSON.stringify(n.images()), previews: r.previews};
    (r.cme || n.activeChartWidget.value().onCmeWidget()) && (u.cme = !0);
    n = J77.enabled("charting_library") ? r.snapshotUrl || "https://www.tradingview.com/snapshot/" : "/snapshot/";
    $.post(n, u, function (n) {
        n ? t(n) : i()
    }).fail(function () {
        i()
    })
}
function linkingSetSymbol(n) {
    n && "string" == typeof n && ($(".header-chart-panel .symbol-edit-wrap input").val(D68.shortName(n)), D45.symbol.setValue(n))
}
function PublishedChartsTimeline() {
}
function postMessageToParent(n, t) {
    window && window.parent && pm.post(window.parent, n, t)
}
function customizeUI(n) {
    var t, i;
    if (n.disabledFeatures.map(function (n) {
        J77.setEnabled(n, !1)
    }), n.enabledFeatures.map(function (n) {
        J77.setEnabled(n, !0)
    }), n.studiesOverrides) {
        t = n.studiesOverrides;
        for (i in t)MetainfoTuner.setProperty(i, t[i])
    }
    __defaultsOverrides = n.defaultsOverrides
}
function createChart() {
    var n, e, o, i, r, f, u, h, t, s;
    if (!Modernizr.canvas || !Modernizr.canvastext)throw"Charting library cannot be running under this browser";
    J77.setEnabled("charting_library_debug_mode", urlParams.debug == "true");
    is_authenticated = !1;
    headerChartPanel = $(".header-chart-panel");
    widgetContainer = $("#library-container");
    tvHeader = $(".tv-header");
    footer = $("#footer-chart-panel");
    customizeUI({studiesOverrides: urlParams.studiesOverrides ? JSON.parse(urlParams.studiesOverrides) : undefined, disabledFeatures: JSON.parse(urlParams.disabledFeatures), enabledFeatures: JSON.parse(urlParams.enabledFeatures), defaultsOverrides: JSON.parse(urlParams.overrides)});
    J77.enabled("saveload_storage_customization") && (typeof urlParams.chartsStorageUrl != "undefined" && urlParams.chartsStorageUrl && typeof urlParams.clientId != "undefined" && urlParams.clientId ? ChartsStorage.initialize(urlParams.clientId, urlParams.userId, urlParams.chartsStorageUrl) : (J77.setEnabled("saveload_storage_customization", !1), J77.setEnabled("header_saveload", !1)));
    Q16 = new D82.ChartApi(window.parent[urlParams.uid].datafeed);
    Q16.setTimeFramesList(JSON.parse(urlParams.timeFrames));
    Q16.setStudiesAccessController(Q16.createStudiesAccessController(urlParams.studiesAccess, urlParams.enabledStudies, urlParams.disabledStudies));
    J77.enabled("narrow_chart_enabled") && $(".chart-page").css("min-width", "240px");
    J77.enabled("use_localstorage_for_settings") && TVSettings.sync();
    n = !window.parent.__TVSavedChart ? undefined : window.parent.__TVSavedChart;
    delete window.parent.__TVSavedChart;
    e = urlParams.interval || "D";
    o = {jqParent: $("#chart-area"), onResize: function (n) {
        var i = $(document.body).height() - 2, r, t;
        widgetContainer.height(i);
        r = J77.enabled("header_widget") ? headerChartPanel.outerHeight() : 0;
        t = i - r - tvHeader.outerHeight() - (footer.length ? footer.outerHeight() : 0);
        t = Math.max(50, t);
        n.height(t)
    }, padding: J77.enabled("border_around_the_chart") ? 5 : 0, edge: J77.enabled("border_around_the_chart") ? 5 : 0, content: n ? n.json : undefined, widgetOptions: {hideIdeas: !0, addVolume: !0, handleSessionErrors: !0, muteSessionErrors: !0, timezone: urlParams.timezone, defSymbol: urlParams.symbol, defInterval: e, hideSymbolSearch: JSON.parse(urlParams.hideSymbolSearch)}};
    n && typeof n.extendedData != "undefined" && (i = n.extendedData, o.metaInfo = {id: i.uid, name: i.name, description: i.description, uid: i.uid, username: "", tags: ""});
    Q6 = new D8(o);
    ChartSaverInstance = saver = new ChartSaver(Q6);
    Q3 = Q6.activeChartWidget.value();
    pro = new D55;
    r = JSON.parse(urlParams.favorites);
    r.intervals = r.intervals.map(function (n) {
        return n.match(/1[DWMYdwmy]/) && (n = n.slice(1)), n
    });
    headerWidget = new D5({Q6: Q6, headerChartPanel: headerChartPanel, hideStudyTemplates: !0, favoriteIntervals: r.intervals, interval_options: {interval: e}, favoriteChartTypes: r.chartTypes, snapshotUrl: urlParams.snapshotUrl});
    D45.bindToChartWidgetCollection(Q6);
    f = function () {
    };
    u = JSON.parse(urlParams.logo);
    f = u.image ? function (n, t, i) {
        var o;
        $(".onchart-custom-logo").remove();
        var r = $('<img src="' + u.image + '">'), s = u.link ? $('<a href="' + u.link + '" target="_blank"/>').append(r) : r, h = $('<span class="text">Powered&nbsp;by&nbsp;<span><a href="https://www.tradingview.com/" target="_blank"><span class="text logo-highlighted">TradingView<\/span><\/a>'), f = $('<div class="onchart-custom-logo"/>').appendTo(t || Q3._jqMainDiv), c = $('<div class="wrapper"/>').appendTo(f), e = $('<table class="inner">').appendTo(c), l = $("<tr>").appendTo(e);
        $('<td class="custom-logo">').append(s).appendTo(l);
        o = $("<tr>").appendTo(e);
        J77.enabled("link_to_tradingview") && $('<td class="tv-link">').append(h).appendTo(o);
        i && f.addClass("on-pane")
    } : function (n, t, i) {
        if (J77.enabled("link_to_tradingview")) {
            $(".onchart-tv-logo").remove();
            var r = $('<div class="onchart-tv-logo wrapper"><div class="wrapper"><a class="inner" href="https://www.tradingview.com/" target="_blank"><img class="solid" src="images/logo-widget-copyright.png" alt="TradingView Logo"><img class="faded" src="images/logo-widget-copyright-faded.png" alt="TradingView Logo"><span class="text">charts&nbsp;by&nbsp;<span class="logo-highlighted">TradingView<\/span><\/span><\/a><\/div><\/div>').appendTo(t || Q3._jqMainDiv);
            if (J77.enabled("minimalistic_logo"))r.on("mouseenter", function () {
                $(this).addClass("expanded")
            }).on("mouseleave", function () {
                $(this).removeClass("expanded")
            }); else r.addClass("expanded");
            i && r.addClass("on-pane")
        }
    };
    h = J77.enabled("widget_logo") && urlParams.disableLogo != "true";
    h && (Q3.createLogo = f, J77.enabled("move_logo_to_main_pane") || Q3.withModel(null, f));
    TradingView.tokenInitialized.resolve();
    urlParams.toolbarbg && (t = "#" + urlParams.toolbarbg, $(".tv-side-toolbar").css("background-color", t), $(".chart-controls-bar").css("background-color", t), $("#chart-area").css("background-color", t), headerChartPanel.css("background-color", t), $("#footer-chart-panel").css("background-color", t));
    s = new D6({container: $(".tv-side-toolbar"), Q6: Q6, onWidget: !0, enabledDrawings: urlParams.enabledDrawings ? JSON.parse(urlParams.enabledDrawings) : [], disabledDrawings: urlParams.disabledDrawings ? JSON.parse(urlParams.disabledDrawings) : [], drawingsAccess: urlParams.drawingsAccess ? JSON.parse(urlParams.drawingsAccess) : undefined});
    window.sideToolbar = s;
    urlParams.hideSideToolbar != "true" && J77.enabled("left_toolbar") || s._fold(!0);
    window.lineToolPropertiesToolbar = new TradingView.LineToolPropertiesWidget(Q6);
    Q3.onDisconnected().subscribe(null, function (n) {
        if (n) {
            showCriticalErrorMessage();
            return
        }
    });
    $(".tv-content").bind("contextmenu", function (n) {
        var t = $(n.originalEvent.target);
        if (!t.is("input") && !t.is("textarea"))return!1
    });
    chartApiInitializationTimePassed.resolve(), function () {
        function t(n, t) {
            Q3.withModel(null, function () {
                if (Q3.model().mainSeries().bars().size() > 0)t(); else {
                    var n = function () {
                        t();
                        Q3.model().mainSeries().onBarReceived().unsubscribe(null, n)
                    };
                    Q3.model().mainSeries().onBarReceived().subscribe(null, n)
                }
            })
        }

        pm.on("symbolInfo", function (n, t) {
            var i = Q3.model().mainSeries().symbolInfo(), r = Q3.model().mainSeries().properties().interval.value(), u = {name: i.name, exchange: i.exchange, description: i.description, type: i.type, interval: r};
            t(u)
        });
        pm.on("resize", function () {
            $(window).resize()
        });
        pm.on("initializationFinished", function () {
            D77.clearStack()
        });
        pm.on("widgetReady", function (n, i) {
            t(n, i)
        });
        for (var n = 0; n < pm.__delayedMesssages.length; ++n)t(pm.__delayedMesssages[n].data, pm.__delayedMesssages[n].cb);
        pm.on("executeAction", function (n) {
            Q3.executeActionByName(n.action)
        });
        pm.on("removeAllStudies", function () {
            Q3.removeAllStudies()
        });
        pm.on("refreshMarks", function () {
            Q3.refreshMarks()
        });
        pm.on("removeAllShapes", function () {
            Q3.removeAllDrawingTools()
        });
        pm.on("saveChart", function () {
            var n = ChartSaverInstance.saveToJSON(), t = JSON.parse(n.content), i = Q6.images(Q6), r = [t, i];
            postMessageToParent("onChartSaved", r)
        });
        pm.on("loadChart", function () {
            var n = window.parent.__TVSavedChart;
            Q3.loadContent(n.json.charts[0], n.extendedData);
            Q17.emit("chart_loaded")
        });
        pm.on("changeSymbol", function (n) {
            function t() {
                Q3.model().mainSeries().onDataLoaded().unsubscribe(null, t);
                pm.post(window.parent, "symbolChangeFinished", {})
            }

            D45.interval.setValue(n.interval);
            D45.symbol.setValue(n.symbol);
            Q3.model().mainSeries().onDataLoaded().subscribe(null, t)
        });
        pm.on("symbolIntervalRequest", function () {
            pm.post(window.parent, "symbolInterval", JSON.stringify({symbol: D45.symbol.value(), interval: D45.interval.value()}))
        });
        pm.on("removeEntity", function (n) {
            var t = Q3.model().chartModel().dataSourceForId(n);
            if (!t) {
                console.warn("Can't find a source with id: " + n);
                return
            }
            Q3.model().chartModel().removeSource(t, !0)
        })
    }();
    Q3.withModel(null, function () {
        Q3.model().mainSeries().onSymbolResolved().subscribe(null, function () {
            var n = Q3.model().mainSeries().symbolInfo(), t = Q3.model().mainSeries().properties().interval.value(), i = {name: n.name, exchange: n.exchange, description: n.description, type: n.type, interval: t};
            postMessageToParent("onSymbolChange", i)
        });
        D45.interval.subscribe(function (n) {
            postMessageToParent("onIntervalChange", n)
        });
        Q16.on("realtime_tick", function (n) {
            postMessageToParent("onTick", n)
        });
        Q16.on("onAutoSaveNeeded", function () {
            postMessageToParent("onAutoSaveNeeded")
        });
        Q17.subscribe("onMarkClick", function (n) {
            postMessageToParent("onMarkClick", n)
        })
    });
    headerWidget.onScreenshotReady(function (n) {
        postMessageToParent("onScreenshotReady", n)
    })
}
function createStudy(n) {
    var t, i, r;
    n.name = n.name.toLowerCase();
    t = StudyMetaInfo.findStudyMetaInfoByDescription(Q3.model().studiesMetaData(), n.name);
    t || console.warn("Study `" + n.name + "` not found.");
    i = {};
    n.inputs && (i.inputs = StudyInputsHelper.getStudyRecordFromArray([n.name].concat(n.inputs), Q3).inputs);
    r = Q3.model().chartModel().insertStudy(t, i, n.forceOverlay);
    !!n.lock && n.lock && r.setUserEditEnabled(!1);
    n.callback && n.callback(r.id())
}
function createShape(n) {
    var o = Q3.model().timeScale().timePointToIndex(n.point.time), u = {index: o}, s, t, r, e;
    n.point.price ? u.price = n.point.price : (s = ["open", "high", "low", "close"], t = !n.point.channel ? 1 : s.indexOf(n.point.channel) + 1, t <= 0 && (t = 1), u.price = Q3.model().mainSeries().data().valueAt(o)[t]);
    var c = Q3._paneWidgets[0]._state, h = {arrow_up: {name: "LineToolArrowMarkUp", supportsText: !0}, arrow_down: {name: "LineToolArrowMarkDown", supportsText: !0}, flag: {name: "LineToolFlagMark", supportsText: !1}, vertical_line: {name: "LineToolVertLine", supportsText: !1}, horizontal_line: {name: "LineToolHorzLine", supportsText: !1}}, f = h[n.options.shape] || h.flag, i = new _52(f.name.toLowerCase());
    if (n.options.overrides)for (r in n.options.overrides)i[r] && i[r].setValue(n.options.overrides[r]);
    f.supportsText && !!n.options.text && i.text.setValue(n.options.text);
    e = Q3.model().createLineTool(c, u, f.name, i);
    n.options.lock && e.setUserEditEnabled(!1);
    n.callback && n.callback(e.id())
}
function setVisibleRange(n, t) {
    if (typeof n == "undefined" || !n.from || !n.to || isNaN(n.from) || isNaN(n.to)) {
        console.warn("Wrong time range: " + JSON.stringify(n));
        return
    }
    Q3.setVisibleTimeRange(parseInt(n.from), parseInt(n.to), t)
}
function getVisibleRange(n) {
    if (!n) {
        console.warn("Callback expected as argument");
        return
    }
    var t = Q3.model().timeScale(), i = t.visibleBars();
    n({from: t.indexToUserTime(i.firstBar()).valueOf() / 1e3, to: t.indexToUserTime(i.lastBar()).valueOf() / 1e3})
}
function gregorianToJalali(n) {
    for (var t, c, f, l = n.substring(0, 4), a = n.substring(5, 7), v = n.substring(8, 10), e = parseInt(l), o = parseInt(a), s = parseInt(v), r = e - 1600, h = o - 1, y = s - 2, u = 365 * r + parseInt((r + 3) / 4) - parseInt((r + 99) / 100) + parseInt((r + 399) / 400), i = 0; i < h; ++i)u += g_days[i];
    for (h > 1 && (r % 4 == 0 && r % 100 != 0 || r % 400 == 0) && ++u, u += y, t = u - 79, c = parseInt(t / 12053), t %= 12053, f = 979 + 33 * c + 4 * parseInt(t / 1461), t %= 1461, t >= 366 && (f += parseInt((t - 1) / 365), t = (t - 1) % 365), i = 0; i < 11 && t >= j_days[i]; ++i)t -= j_days[i];
    var p = i + 1, w = t + 1, b = new Date(e, o - 1, s), k = ["شنبه", "یک شنبه", "دو شنبه", "سه شنبه", "چهار شنبه", "پنج شنبه", "جمعه"][b.getDay()];
    return[k + "  " + f + "/" + p + "/" + w + "  " + n.substring(11, n.length)]
}
function getPersianDate(n, t, i) {
    for (var r, h, o, c, l, f = n - 1600, s = t - 1, a = i - 1, e = 365 * f + parseInt((f + 3) / 4) - parseInt((f + 99) / 100) + parseInt((f + 399) / 400), u = 0; u < s; ++u)e += g_days[u];
    for (s > 1 && (f % 4 == 0 && f % 100 != 0 || f % 400 == 0) && ++e, e += a, r = e - 79, h = parseInt(r / 12053), r %= 12053, o = 979 + 33 * h + 4 * parseInt(r / 1461), r %= 1461, r >= 366 && (o += parseInt((r - 1) / 365), r = (r - 1) % 365), u = 0; u < 11 && r >= j_days[u]; ++u)r -= j_days[u];
    return c = u + 1, l = r + 1, [o, c, l]
}
var J77 = function () {
    var t = {}, e, r, n, i, o, u, s, f;
    if ("undefined" != typeof J77)return J77;
    e = {custom_items_in_context_menu: {}, websocket_connection: {}, countdown: {}, extended_hours: {}, symbol_search_parser_mixin: {}, show_pro_features: {}, daily_timeframe_suffix: {}, symbollist_context_menu: {}, pay_attention_to_ticker_not_symbol: {}, graying_disabled_tools_enabled: {}, update_study_formatter_on_symbol_resolve: {}, constraint_dialogs_movement: {}, same_data_requery: {}, show_interval_dialog_on_key_press: {}, header_interval_dialog_button: {subsets: ["show_interval_dialog_on_key_press"]}, header_fullscreen_button: {}, header_symbol_search: {}, header_resolutions: {subsets: ["header_interval_dialog_button"]}, header_chart_type: {}, header_settings: {}, header_indicators: {}, header_compare: {}, header_undo_redo: {}, header_screenshot: {}, header_saveload: {}, header_widget: {subsets: "header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_settings header_indicators header_compare header_undo_redo header_screenshot header_fullscreen_button".split(" ")}, left_toolbar: {}, control_bar: {}, widget_logo: {}, timeframes_toolbar: {}, edit_buttons_in_legend: {}, pane_context_menu: {}, scales_context_menu: {}, legend_context_menu: {}, context_menus: {subsets: ["pane_context_menu", "scales_context_menu", "legend_context_menu"]}, items_favoriting: {}, use_localstorage_for_settings: {subsets: ["items_favoriting"]}, plain_studymarket: {}, trading_options: {}, disable_resolution_rebuild: {}, border_around_the_chart: {}, narrow_chart_enabled: {}, charting_library_debug_mode: {}, log_data_request_time: {}, saveload_requires_authentication: {}, saveload_storage_customization: {}, new_chart_creation_available: {}, volume_force_overlay: {}, create_volume_indicator_by_default: {}, saved_charts_count_restriction: {}, lean_chart_load: {}, stop_study_on_restart: {}, star_some_intervals_by_default: {}, predefined_items_only_may_be_starred: {}, move_logo_to_main_pane: {}, link_to_tradingview: {}, right_bar_stays_on_scroll: {}, short_name_may_differ_from_fullname: {}, chart_content_overrides_by_deafults: {}, google_analytics: {}, alerts: {}, tv_production: {subsets: "show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection header_fullscreen_button header_widget left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay new_chart_creation_available saved_charts_count_restriction create_volume_indicator_by_default charts_auto_save save_old_chart_before_save_as trading_options chart_content_overrides_by_deafults alerts".split(" ")}, widget: {subsets: "show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay create_volume_indicator_by_default header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_indicators header_compare star_some_intervals_by_default".split(" ")}, charting_library: {subsets: "daily_timeframe_suffix custom_items_in_context_menu pay_attention_to_ticker_not_symbol graying_disabled_tools_enabled update_study_formatter_on_symbol_resolve constraint_dialogs_movement header_widget left_toolbar control_bar widget_logo timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings plain_studymarket border_around_the_chart saveload_storage_customization volume_force_overlay lean_chart_load stop_study_on_restart header_saveload create_volume_indicator_by_default adapt_onchart_logo_background update_timeframes_set_on_symbol_resolve refresh_saved_charts_list_on_dialog_show predefined_items_only_may_be_starred link_to_tradingview right_bar_stays_on_scroll short_name_may_differ_from_fullname google_analytics".split(" ")}, static_charts_service: {subsets: ["charting_library", "disable_resolution_rebuild", "log_data_request_time", "same_data_requery"]}, charting_platform: {subsets: ["charting_library", "trading_options"]}};
    r = {};
    for (n in e) {
        for (i = e[n].subsets || [], o = 0; o < i.length; ++o)r[i[o]] = 1;
        r[n] = 1
    }
    u = {};
    for (n in r)for (s in r)i = e[s], "undefined" != typeof i && i.subsets && 0 <= i.subsets.indexOf(n) && (u.hasOwnProperty(n) || (u[n] = []), u[n].push(s));
    return f = {}, t.enabled = function (n) {
        var i = u.hasOwnProperty(n) ? u[n] : [], t;
        if (0 == f[n])return!1;
        for (n = f[n], t = 0; t < i.length; ++t)n |= J77.enabled(i[t]);
        return n
    }, t._uniqueSets = function () {
        return Object.keys(r)
    }, t.enable = function (n) {
        f[n] = !0
    }, t.setEnabled = function (n, t) {
        f[n] = t
    }, "undefined" != typeof __initialDisabledFeaturesets && __initialDisabledFeaturesets && __initialDisabledFeaturesets.map(function (n) {
        t.setEnabled(n, !1)
    }), "undefined" != typeof __initialEnabledFeaturesets && __initialEnabledFeaturesets && __initialEnabledFeaturesets.map(function (n) {
        t.enable(n)
    }), t
}(), Mustache, TradingView, PineAddons, HTMLHelper, loadTVScript, MathEx, ChartTradingUtils, PropertyPagesFactory, Action, ContextMenu, counter, loginStateChange, assert, TVSettings, noop, MarketStatusWatcher, localizationReady, datafeedReady, g_days, j_days;
"undefined" != typeof module && (module.exports = J77), function () {
    var f = function () {
    }, t, i;
    "undefined" == typeof console && (window.console = {});
    for (var r = window.console, u = "dir log time info warn count clear debug error group trace assert dirxml profile timeEnd groupEnd profileEnd timeStamp exception table notifyFirebug groupCollapsed getFirebugElement firebug userObjects".split(" "), n = 0, e = u.length; n < e; n++)if (t = u[n], "undefined" == typeof r[t])try {
        r[t] = f
    } catch (o) {
    }
    i = window.onerror;
    window.__tv_js_errors = [];
    window.onerror = function (n, t, r) {
        if (window.__tv_js_errors.push(n + " (found at " + t + ", line " + r + ")"), i)try {
            i.apply(window, arguments)
        } catch (u) {
        }
    }
}(), function (n, t) {
    function dr(n) {
        var i = hi[n] = {}, t, r;
        for (n = n.split(/\s+/), t = 0, r = n.length; t < r; t++)i[n[t]] = !0;
        return i
    }

    function yt(n, r, u) {
        if (u === t && 1 === n.nodeType)if (u = "data-" + r.replace(li, "-$1").toLowerCase(), u = n.getAttribute(u), "string" == typeof u) {
            try {
                u = "true" === u ? !0 : "false" === u ? !1 : "null" === u ? null : i.isNumeric(u) ? +u : ci.test(u) ? i.parseJSON(u) : u
            } catch (f) {
            }
            i.data(n, r, u)
        } else u = t;
        return u
    }

    function ut(n) {
        for (var t in n)if (("data" !== t || !i.isEmptyObject(n[t])) && "toJSON" !== t)return!1;
        return!0
    }

    function pt(n, t, r) {
        var u = t + "defer", f = t + "queue", e = t + "mark", o = i._data(n, u);
        !o || "queue" !== r && i._data(n, f) || "mark" !== r && i._data(n, e) || setTimeout(function () {
            i._data(n, f) || i._data(n, e) || (i.removeData(n, u, !0), o.fire())
        }, 0)
    }

    function c() {
        return!1
    }

    function w() {
        return!0
    }

    function wt(n) {
        return!n || !n.parentNode || 11 === n.parentNode.nodeType
    }

    function bt(n, t, r) {
        if (t = t || 0, i.isFunction(t))return i.grep(n, function (n, i) {
            return!!t.call(n, i, n) === r
        });
        if (t.nodeType)return i.grep(n, function (n) {
            return n === t === r
        });
        if ("string" == typeof t) {
            var u = i.grep(n, function (n) {
                return 1 === n.nodeType
            });
            if (pu.test(t))return i.filter(t, u, !r);
            t = i.filter(t, u)
        }
        return i.grep(n, function (n) {
            return 0 <= i.inArray(n, t) === r
        })
    }

    function kt(n) {
        var t = nr.split("|");
        if (n = n.createDocumentFragment(), n.createElement)for (; t.length;)n.createElement(t.pop());
        return n
    }

    function gr(n) {
        return i.nodeName(n, "table") ? n.getElementsByTagName("tbody")[0] || n.appendChild(n.ownerDocument.createElement("tbody")) : n
    }

    function dt(n, t) {
        var e, r, o, u, f;
        if (1 === t.nodeType && i.hasData(n)) {
            if (r = i._data(n), u = i._data(t, r), f = r.events, f)for (e in delete u.handle, u.events = {}, f)for (r = 0, o = f[e].length; r < o; r++)i.event.add(t, e, f[e][r]);
            u.data && (u.data = i.extend({}, u.data))
        }
    }

    function gt(n, t) {
        var r;
        1 === t.nodeType && (t.clearAttributes && t.clearAttributes(), t.mergeAttributes && t.mergeAttributes(n), r = t.nodeName.toLowerCase(), "object" === r ? t.outerHTML = n.outerHTML : "input" !== r || "checkbox" !== n.type && "radio" !== n.type ? "option" === r ? t.selected = n.defaultSelected : "input" === r || "textarea" === r ? t.defaultValue = n.defaultValue : "script" === r && t.text !== n.text && (t.text = n.text) : (n.checked && (t.defaultChecked = t.checked = n.checked), t.value !== n.value && (t.value = n.value)), t.removeAttribute(i.expando), t.removeAttribute("_submit_attached"), t.removeAttribute("_change_attached"))
    }

    function b(n) {
        return"undefined" != typeof n.getElementsByTagName ? n.getElementsByTagName("*") : "undefined" != typeof n.querySelectorAll ? n.querySelectorAll("*") : []
    }

    function ni(n) {
        ("checkbox" === n.type || "radio" === n.type) && (n.defaultChecked = n.checked)
    }

    function ti(n) {
        var t = (n.nodeName || "").toLowerCase();
        "input" === t ? ni(n) : "script" !== t && "undefined" != typeof n.getElementsByTagName && i.grep(n.getElementsByTagName("input"), ni)
    }

    function ii(n, t, r) {
        var u = "width" === t ? n.offsetWidth : n.offsetHeight, f = "width" === t ? 1 : 0;
        if (0 < u) {
            if ("border" !== r)for (; 4 > f; f += 2)r || (u -= parseFloat(i.css(n, "padding" + o[f])) || 0), u = "margin" === r ? u + (parseFloat(i.css(n, r + o[f])) || 0) : u - (parseFloat(i.css(n, "border" + o[f] + "Width")) || 0);
            return u + "px"
        }
        if (u = a(n, t), (0 > u || null == u) && (u = n.style[t]), ct.test(u))return u;
        if (u = parseFloat(u) || 0, r)for (; 4 > f; f += 2)u += parseFloat(i.css(n, "padding" + o[f])) || 0, "padding" !== r && (u += parseFloat(i.css(n, "border" + o[f] + "Width")) || 0), "margin" === r && (u += parseFloat(i.css(n, r + o[f])) || 0);
        return u + "px"
    }

    function ri(n) {
        return function (t, r) {
            if ("string" != typeof t && (r = t, t = "*"), i.isFunction(r))for (var e = t.toLowerCase().split(cr), f = 0, s = e.length, u, o; f < s; f++)u = e[f], (o = /^\+/.test(u)) && (u = u.substr(1) || "*"), u = n[u] = n[u] || [], u[o ? "unshift" : "push"](r)
        }
    }

    function k(n, i, r, u, f, e) {
        f = f || i.dataTypes[0];
        e = e || {};
        e[f] = !0;
        f = n[f];
        for (var s = 0, c = f ? f.length : 0, h = n === lt, o; s < c && (h || !o); s++)o = f[s](i, r, u), "string" == typeof o && (!h || e[o] ? o = t : (i.dataTypes.unshift(o), o = k(n, i, r, u, o, e)));
        return!h && o || e["*"] || (o = k(n, i, r, u, "*", e)), o
    }

    function ui(n, r) {
        var u, f, e = i.ajaxSettings.flatOptions || {};
        for (u in r)r[u] !== t && ((e[u] ? n : f || (f = {}))[u] = r[u]);
        f && i.extend(!0, n, f)
    }

    function ft(n, t, r, u) {
        if (i.isArray(t))i.each(t, function (t, i) {
            r || lf.test(n) ? u(n, i) : ft(n + "[" + ("object" == typeof i ? t : "") + "]", i, r, u)
        }); else if (r || "object" !== i.type(t))u(n, t); else for (var f in t)ft(n + "[" + f + "]", t[f], r, u)
    }

    function fi() {
        try {
            return new n.XMLHttpRequest
        } catch (t) {
        }
    }

    function ei() {
        return setTimeout(nu, 0), rt = i.now()
    }

    function nu() {
        rt = t
    }

    function l(n, t) {
        var r = {};
        return i.each(it.concat.apply([], it.slice(0, t)), function () {
            r[this] = n
        }), r
    }

    function oi(n) {
        if (!at[n]) {
            var e = r.body, t = i("<" + n + ">").appendTo(e), u = t.css("display");
            t.remove();
            ("none" === u || "" === u) && (f || (f = r.createElement("iframe"), f.frameBorder = f.width = f.height = 0), e.appendChild(f), y && f.createElement || (y = (f.contentWindow || f.contentDocument).document, y.write((i.support.boxModel ? "<!doctype html>" : "") + "<html><body>"), y.close()), t = y.createElement(n), y.body.appendChild(t), u = i.css(t, "display"), e.removeChild(f));
            at[n] = u
        }
        return at[n]
    }

    function si(n) {
        return i.isWindow(n) ? n : 9 === n.nodeType ? n.defaultView || n.parentWindow : !1
    }

    var r = n.document, tu = n.navigator, iu = n.location, i = function () {
        function c() {
            if (!i.isReady) {
                try {
                    r.documentElement.doScroll("left")
                } catch (n) {
                    setTimeout(c, 1);
                    return
                }
                i.ready()
            }
        }

        var i = function (n, t) {
            return new i.fn.init(n, t, l)
        }, k = n.jQuery, d = n.$, l, g = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, a = /\S/, v = /^\s+/, y = /\s+$/, nt = /^<(\w+)\s*\/?>(?:<\/\1>)?$/, tt = /^[\],:{}\s]*$/, it = /\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, rt = /"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ut = /(?:^|:|,)(?:\s*\[)+/g, ft = /(webkit)[ \/]([\w.]+)/, et = /(opera)(?:.*version)?[ \/]([\w.]+)/, ot = /(msie) ([\w.]+)/, st = /(mozilla)(?:.*? rv:([\w.]+))?/, ht = /-([a-z]|[0-9])/ig, ct = /^-ms-/, lt = function (n, t) {
            return(t + "").toUpperCase()
        }, f = tu.userAgent, o, u, at = Object.prototype.toString, s = Object.prototype.hasOwnProperty, h = Array.prototype.push, e = Array.prototype.slice, p = String.prototype.trim, w = Array.prototype.indexOf, b = {};
        return i.fn = i.prototype = {constructor: i, init: function (n, u, f) {
            var e;
            if (!n)return this;
            if (n.nodeType)return this.context = this[0] = n, this.length = 1, this;
            if ("body" === n && !u && r.body)return this.context = r, this[0] = r.body, this.selector = n, this.length = 1, this;
            if ("string" == typeof n) {
                if (e = "<" === n.charAt(0) && ">" === n.charAt(n.length - 1) && 3 <= n.length ? [null, n, null] : g.exec(n), !e || !e[1] && u)return!u || u.jquery ? (u || f).find(n) : this.constructor(u).find(n);
                if (e[1])return f = (u = u instanceof i ? u[0] : u) ? u.ownerDocument || u : r, (n = nt.exec(n)) ? i.isPlainObject(u) ? (n = [r.createElement(n[1])], i.fn.attr.call(n, u, !0)) : n = [f.createElement(n[1])] : (n = i.buildFragment([e[1]], [f]), n = (n.cacheable ? i.clone(n.fragment) : n.fragment).childNodes), i.merge(this, n);
                if ((u = r.getElementById(e[2])) && u.parentNode) {
                    if (u.id !== e[2])return f.find(n);
                    this.length = 1;
                    this[0] = u
                }
                return this.context = r, this.selector = n, this
            }
            return i.isFunction(n) ? f.ready(n) : (n.selector !== t && (this.selector = n.selector, this.context = n.context), i.makeArray(n, this))
        }, selector: "", jquery: "1.7.2", length: 0, size: function () {
            return this.length
        }, toArray: function () {
            return e.call(this, 0)
        }, get: function (n) {
            return null == n ? this.toArray() : 0 > n ? this[this.length + n] : this[n]
        }, pushStack: function (n, t, r) {
            var u = this.constructor();
            return i.isArray(n) ? h.apply(u, n) : i.merge(u, n), u.prevObject = this, u.context = this.context, "find" === t ? u.selector = this.selector + (this.selector ? " " : "") + r : t && (u.selector = this.selector + "." + t + "(" + r + ")"), u
        }, each: function (n, t) {
            return i.each(this, n, t)
        }, ready: function (n) {
            return i.bindReady(), o.add(n), this
        }, eq: function (n) {
            return n = +n, -1 === n ? this.slice(n) : this.slice(n, n + 1)
        }, first: function () {
            return this.eq(0)
        }, last: function () {
            return this.eq(-1)
        }, slice: function () {
            return this.pushStack(e.apply(this, arguments), "slice", e.call(arguments).join(","))
        }, map: function (n) {
            return this.pushStack(i.map(this, function (t, i) {
                return n.call(t, i, t)
            }))
        }, end: function () {
            return this.prevObject || this.constructor(null)
        }, push: h, sort: [].sort, splice: [].splice}, i.fn.init.prototype = i.fn, i.extend = i.fn.extend = function () {
            var o, e, r, u, s, n = arguments[0] || {}, f = 1, c = arguments.length, h = !1;
            for ("boolean" == typeof n && (h = n, n = arguments[1] || {}, f = 2), "object" == typeof n || i.isFunction(n) || (n = {}), c === f && (n = this, --f); f < c; f++)if (null != (o = arguments[f]))for (e in o)r = n[e], u = o[e], n !== u && (h && u && (i.isPlainObject(u) || (s = i.isArray(u))) ? (s ? (s = !1, r = r && i.isArray(r) ? r : []) : r = r && i.isPlainObject(r) ? r : {}, n[e] = i.extend(h, r, u)) : u !== t && (n[e] = u));
            return n
        }, i.extend({noConflict: function (t) {
            return n.$ === i && (n.$ = d), t && n.jQuery === i && (n.jQuery = k), i
        }, isReady: !1, readyWait: 1, holdReady: function (n) {
            n ? i.readyWait++ : i.ready(!0)
        }, ready: function (n) {
            if (!0 === n && !--i.readyWait || !0 !== n && !i.isReady) {
                if (!r.body)return setTimeout(i.ready, 1);
                i.isReady = !0;
                !0 !== n && 0 < --i.readyWait || (o.fireWith(r, [i]), i.fn.trigger && i(r).trigger("ready").off("ready"))
            }
        }, bindReady: function () {
            if (!o) {
                if (o = i.Callbacks("once memory"), "complete" === r.readyState)return setTimeout(i.ready, 1);
                if (r.addEventListener)r.addEventListener("DOMContentLoaded", u, !1), n.addEventListener("load", i.ready, !1); else if (r.attachEvent) {
                    r.attachEvent("onreadystatechange", u);
                    n.attachEvent("onload", i.ready);
                    var t = !1;
                    try {
                        t = null == n.frameElement
                    } catch (f) {
                    }
                    r.documentElement.doScroll && t && c()
                }
            }
        }, isFunction: function (n) {
            return"function" === i.type(n)
        }, isArray: Array.isArray || function (n) {
            return"array" === i.type(n)
        }, isWindow: function (n) {
            return null != n && n == n.window
        }, isNumeric: function (n) {
            return!isNaN(parseFloat(n)) && isFinite(n)
        }, type: function (n) {
            return null == n ? String(n) : b[at.call(n)] || "object"
        }, isPlainObject: function (n) {
            if (!n || "object" !== i.type(n) || n.nodeType || i.isWindow(n))return!1;
            try {
                if (n.constructor && !s.call(n, "constructor") && !s.call(n.constructor.prototype, "isPrototypeOf"))return!1
            } catch (u) {
                return!1
            }
            for (var r in n);
            return r === t || s.call(n, r)
        }, isEmptyObject: function (n) {
            for (var t in n)return!1;
            return!0
        }, error: function (n) {
            throw Error(n);
        }, parseJSON: function (t) {
            if ("string" != typeof t || !t)return null;
            if (t = i.trim(t), n.JSON && n.JSON.parse)return n.JSON.parse(t);
            if (tt.test(t.replace(it, "@").replace(rt, "]").replace(ut, "")))return new Function("return " + t)();
            i.error("Invalid JSON: " + t)
        }, parseXML: function (r) {
            if ("string" != typeof r || !r)return null;
            var u, f;
            try {
                n.DOMParser ? (f = new DOMParser, u = f.parseFromString(r, "text/xml")) : (u = new ActiveXObject("Microsoft.XMLDOM"), u.async = "false", u.loadXML(r))
            } catch (e) {
                u = t
            }
            return u && u.documentElement && !u.getElementsByTagName("parsererror").length || i.error("Invalid XML: " + r), u
        }, noop: function () {
        }, globalEval: function (t) {
            t && a.test(t) && (n.execScript || function (t) {
                n.eval.call(n, t)
            })(t)
        }, camelCase: function (n) {
            return n.replace(ct, "ms-").replace(ht, lt)
        }, nodeName: function (n, t) {
            return n.nodeName && n.nodeName.toUpperCase() === t.toUpperCase()
        }, each: function (n, r, u) {
            var f, e = 0, o = n.length, s = o === t || i.isFunction(n);
            if (u)if (s) {
                for (f in n)if (!1 === r.apply(n[f], u))break
            } else for (; e < o && !1 !== r.apply(n[e++], u);); else if (s) {
                for (f in n)if (!1 === r.call(n[f], f, n[f]))break
            } else for (; e < o && !1 !== r.call(n[e], e, n[e++]););
            return n
        }, trim: p ? function (n) {
            return null == n ? "" : p.call(n)
        } : function (n) {
            return null == n ? "" : n.toString().replace(v, "").replace(y, "")
        }, makeArray: function (n, t) {
            var u = t || [], r;
            return null != n && (r = i.type(n), null == n.length || "string" === r || "function" === r || "regexp" === r || i.isWindow(n) ? h.call(u, n) : i.merge(u, n)), u
        }, inArray: function (n, t, i) {
            var r;
            if (t) {
                if (w)return w.call(t, n, i);
                for (r = t.length, i = i ? 0 > i ? Math.max(0, r + i) : i : 0; i < r; i++)if (i in t && t[i] === n)return i
            }
            return-1
        }, merge: function (n, i) {
            var u = n.length, r = 0, f;
            if ("number" == typeof i.length)for (f = i.length; r < f; r++)n[u++] = i[r]; else for (; i[r] !== t;)n[u++] = i[r++];
            return n.length = u, n
        }, grep: function (n, t, i) {
            var u = [], f, r, e;
            for (i = !!i, r = 0, e = n.length; r < e; r++)f = !!t(n[r], r), i !== f && u.push(n[r]);
            return u
        }, map: function (n, r, u) {
            var f, h, e = [], s = 0, o = n.length;
            if (n instanceof i || o !== t && "number" == typeof o && (0 < o && n[0] && n[o - 1] || 0 === o || i.isArray(n)))for (; s < o; s++)f = r(n[s], s, u), null != f && (e[e.length] = f); else for (h in n)f = r(n[h], h, u), null != f && (e[e.length] = f);
            return e.concat.apply([], e)
        }, guid: 1, proxy: function (n, r) {
            var f, u;
            return("string" == typeof r && (u = n[r], r = n, n = u), !i.isFunction(n)) ? t : (f = e.call(arguments, 2), u = function () {
                return n.apply(r, f.concat(e.call(arguments)))
            }, u.guid = n.guid = n.guid || u.guid || i.guid++, u)
        }, access: function (n, r, u, f, e, o, s) {
            var c, l = null == u, h = 0, a = n.length;
            if (u && "object" == typeof u) {
                for (h in u)i.access(n, r, h, u[h], 1, o, f);
                e = 1
            } else if (f !== t) {
                if (c = s === t && i.isFunction(f), l && (c ? (c = r, r = function (n, t, r) {
                    return c.call(i(n), r)
                }) : (r.call(n, f), r = null)), r)for (; h < a; h++)r(n[h], u, c ? f.call(n[h], h, r(n[h], u)) : f, s);
                e = 1
            }
            return e ? n : l ? r.call(n) : a ? r(n[0], u) : o
        }, now: function () {
            return(new Date).getTime()
        }, uaMatch: function (n) {
            return n = n.toLowerCase(), n = ft.exec(n) || et.exec(n) || ot.exec(n) || 0 > n.indexOf("compatible") && st.exec(n) || [], {browser: n[1] || "", version: n[2] || "0"}
        }, sub: function () {
            function n(t, i) {
                return new n.fn.init(t, i)
            }

            i.extend(!0, n, this);
            n.superclass = this;
            n.fn = n.prototype = this();
            n.fn.constructor = n;
            n.sub = this.sub;
            n.fn.init = function (r, u) {
                return u && u instanceof i && !(u instanceof n) && (u = n(u)), i.fn.init.call(this, r, u, t)
            };
            n.fn.init.prototype = n.fn;
            var t = n(r);
            return n
        }, browser: {}}), i.each("Boolean Number String Function Array Date RegExp Object".split(" "), function (n, t) {
            b["[object " + t + "]"] = t.toLowerCase()
        }), f = i.uaMatch(f), f.browser && (i.browser[f.browser] = !0, i.browser.version = f.version), i.browser.webkit && (i.browser.safari = !0), a.test(" ") && (v = /^[\s\xA0]+/, y = /[\s\xA0]+$/), l = i(r), r.addEventListener ? u = function () {
            r.removeEventListener("DOMContentLoaded", u, !1);
            i.ready()
        } : r.attachEvent && (u = function () {
            "complete" === r.readyState && (r.detachEvent("onreadystatechange", u), i.ready())
        }), i
    }(), hi = {}, d, ci, li, pr, p, nt, wr, v, br, kr, vt;
    i.Callbacks = function (n) {
        n = n ? hi[n] || dr(n) : {};
        var r = [], f = [], u, l, s, c, h, e, a = function (t) {
            for (var u, e, f = 0, s = t.length; f < s; f++)u = t[f], e = i.type(u), "array" === e ? a(u) : "function" === e && (n.unique && o.has(u) || r.push(u))
        }, v = function (t, i) {
            for (i = i || [], u = !n.memory || [t, i], s = l = !0, e = c || 0, c = 0, h = r.length; r && e < h; e++)if (!1 === r[e].apply(t, i) && n.stopOnFalse) {
                u = !0;
                break
            }
            s = !1;
            r && (n.once ? !0 === u ? o.disable() : r = [] : f && f.length && (u = f.shift(), o.fireWith(u[0], u[1])))
        }, o = {add: function () {
            if (r) {
                var n = r.length;
                a(arguments);
                s ? h = r.length : u && !0 !== u && (c = n, v(u[0], u[1]))
            }
            return this
        }, remove: function () {
            var t;
            if (r)for (var u = arguments, i = 0, f = u.length; i < f; i++)for (t = 0; t < r.length && (u[i] !== r[t] || (s && t <= h && (h--, t <= e && e--), r.splice(t--, 1), !n.unique)); t++);
            return this
        }, has: function (n) {
            if (r)for (var t = 0, i = r.length; t < i; t++)if (n === r[t])return!0;
            return!1
        }, empty: function () {
            return r = [], this
        }, disable: function () {
            return r = f = u = t, this
        }, disabled: function () {
            return!r
        }, lock: function () {
            return f = t, u && !0 !== u || o.disable(), this
        }, locked: function () {
            return!f
        }, fireWith: function (t, i) {
            return f && (s ? n.once || f.push([t, i]) : n.once && u || v(t, i)), this
        }, fire: function () {
            return o.fireWith(this, arguments), this
        }, fired: function () {
            return!!l
        }};
        return o
    };
    d = [].slice;
    i.extend({Deferred: function (n) {
        var r = i.Callbacks("once memory"), u = i.Callbacks("once memory"), f = i.Callbacks("memory"), s = "pending", h = {resolve: r, reject: u, notify: f}, e = {done: r.add, fail: u.add, progress: f.add, state: function () {
            return s
        }, isResolved: r.fired, isRejected: u.fired, then: function (n, i, r) {
            return t.done(n).fail(i).progress(r), this
        }, always: function () {
            return t.done.apply(t, arguments).fail.apply(t, arguments), this
        }, pipe: function (n, r, u) {
            return i.Deferred(function (f) {
                i.each({done: [n, "resolve"], fail: [r, "reject"], progress: [u, "notify"]}, function (n, r) {
                    var e = r[0], o = r[1], u;
                    i.isFunction(e) ? t[n](function () {
                        (u = e.apply(this, arguments)) && i.isFunction(u.promise) ? u.promise().then(f.resolve, f.reject, f.notify) : f[o + "With"](this === t ? f : this, [u])
                    }) : t[n](f[o])
                })
            }).promise()
        }, promise: function (n) {
            if (null == n)n = e; else for (var t in e)n[t] = e[t];
            return n
        }}, t = e.promise({});
        for (var o in h)t[o] = h[o].fire, t[o + "With"] = h[o].fireWith;
        return t.done(function () {
            s = "resolved"
        }, u.disable, f.lock).fail(function () {
            s = "rejected"
        }, r.disable, f.lock), n && n.call(t, t), t
    }, when: function (n) {
        function h(n) {
            return function (i) {
                r[n] = 1 < arguments.length ? d.call(arguments, 0) : i;
                --e || t.resolveWith(t, r)
            }
        }

        function c(n) {
            return function (i) {
                o[n] = 1 < arguments.length ? d.call(arguments, 0) : i;
                t.notifyWith(s, o)
            }
        }

        var r = d.call(arguments, 0), u = 0, f = r.length, o = Array(f), e = f, t = 1 >= f && n && i.isFunction(n.promise) ? n : i.Deferred(), s = t.promise();
        if (1 < f) {
            for (; u < f; u++)r[u] && r[u].promise && i.isFunction(r[u].promise) ? r[u].promise().then(h(u), t.reject, c(u)) : --e;
            e || t.resolveWith(t, r)
        } else t !== n && t.resolveWith(t, f ? [n] : []);
        return s
    }});
    i.support = function () {
        var f, u, e, h, c, s, l, o, t = r.createElement("div");
        if (t.setAttribute("className", "t"), t.innerHTML = "   <link/><table><\/table><a href='/a' style='top:1px;float:left;opacity:.55;'>a<\/a><input type='checkbox'/>", u = t.getElementsByTagName("*"), e = t.getElementsByTagName("a")[0], !u || !u.length || !e)return{};
        h = r.createElement("select");
        c = h.appendChild(r.createElement("option"));
        u = t.getElementsByTagName("input")[0];
        f = {leadingWhitespace: 3 === t.firstChild.nodeType, tbody: !t.getElementsByTagName("tbody").length, htmlSerialize: !!t.getElementsByTagName("link").length, style: /top/.test(e.getAttribute("style")), hrefNormalized: "/a" === e.getAttribute("href"), opacity: /^0.55/.test(e.style.opacity), cssFloat: !!e.style.cssFloat, checkOn: "on" === u.value, optSelected: c.selected, getSetAttribute: "t" !== t.className, enctype: !!r.createElement("form").enctype, html5Clone: "<:nav><\/:nav>" !== r.createElement("nav").cloneNode(!0).outerHTML, submitBubbles: !0, changeBubbles: !0, focusinBubbles: !1, deleteExpando: !0, noCloneEvent: !0, inlineBlockNeedsLayout: !1, shrinkWrapBlocks: !1, reliableMarginRight: !0, pixelMargin: !0};
        i.boxModel = f.boxModel = "CSS1Compat" === r.compatMode;
        u.checked = !0;
        f.noCloneChecked = u.cloneNode(!0).checked;
        h.disabled = !0;
        f.optDisabled = !c.disabled;
        try {
            delete t.test
        } catch (a) {
            f.deleteExpando = !1
        }
        if (!t.addEventListener && t.attachEvent && t.fireEvent && (t.attachEvent("onclick", function () {
            f.noCloneEvent = !1
        }), t.cloneNode(!0).fireEvent("onclick")), u = r.createElement("input"), u.value = "t", u.setAttribute("type", "radio"), f.radioValue = "t" === u.value, u.setAttribute("checked", "checked"), u.setAttribute("name", "t"), t.appendChild(u), e = r.createDocumentFragment(), e.appendChild(t.lastChild), f.checkClone = e.cloneNode(!0).cloneNode(!0).lastChild.checked, f.appendChecked = u.checked, e.removeChild(u), e.appendChild(t), t.attachEvent)for (l in{submit: 1, change: 1, focusin: 1})u = "on" + l, o = u in t, o || (t.setAttribute(u, "return;"), o = "function" == typeof t[u]), f[l + "Bubbles"] = o;
        return e.removeChild(t), e = h = c = t = u = null, i(function () {
            var h, u, e, c, l = r.getElementsByTagName("body")[0];
            l && (h = r.createElement("div"), h.style.cssText = "padding:0;margin:0;border:0;visibility:hidden;width:0;height:0;position:static;top:0;margin-top:1px", l.insertBefore(h, l.firstChild), t = r.createElement("div"), h.appendChild(t), t.innerHTML = "<table><tr><td style='padding:0;margin:0;border:0;display:none'><\/td><td>t<\/td><\/tr><\/table>", s = t.getElementsByTagName("td"), o = 0 === s[0].offsetHeight, s[0].style.display = "", s[1].style.display = "none", f.reliableHiddenOffsets = o && 0 === s[0].offsetHeight, n.getComputedStyle && (t.innerHTML = "", u = r.createElement("div"), u.style.width = "0", u.style.marginRight = "0", t.style.width = "2px", t.appendChild(u), f.reliableMarginRight = 0 === (parseInt((n.getComputedStyle(u, null) || {marginRight: 0}).marginRight, 10) || 0)), "undefined" != typeof t.style.zoom && (t.innerHTML = "", t.style.width = t.style.padding = "1px", t.style.border = 0, t.style.overflow = "hidden", t.style.display = "inline", t.style.zoom = 1, f.inlineBlockNeedsLayout = 3 === t.offsetWidth, t.style.display = "block", t.style.overflow = "visible", t.innerHTML = "<div style='width:5px;'><\/div>", f.shrinkWrapBlocks = 3 !== t.offsetWidth), t.style.cssText = "position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:0;visibility:hidden;", t.innerHTML = "<div style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;display:block;'><div style='padding:0;margin:0;border:0;display:block;overflow:hidden;'><\/div><\/div><table style='position:absolute;top:0;left:0;width:1px;height:1px;padding:0;margin:0;border:5px solid #000;' cellpadding='0' cellspacing='0'><tr><td><\/td><\/tr><\/table>", u = t.firstChild, e = u.firstChild, c = u.nextSibling.firstChild.firstChild, c = {doesNotAddBorder: 5 !== e.offsetTop, doesAddBorderForTableAndCells: 5 === c.offsetTop}, e.style.position = "fixed", e.style.top = "20px", c.fixedPosition = 20 === e.offsetTop || 15 === e.offsetTop, e.style.position = e.style.top = "", u.style.overflow = "hidden", u.style.position = "relative", c.subtractsBorderForOverflowNotVisible = -5 === e.offsetTop, c.doesNotIncludeMarginInBodyOffset = 1 !== l.offsetTop, n.getComputedStyle && (t.style.marginTop = "1%", f.pixelMargin = "1%" !== (n.getComputedStyle(t, null) || {marginTop: 0}).marginTop), "undefined" != typeof h.style.zoom && (h.style.zoom = 1), l.removeChild(h), t = null, i.extend(f, c))
        }), f
    }();
    ci = /^(?:\{.*\}|\[.*\])$/;
    li = /([A-Z])/g;
    i.extend({cache: {}, uuid: 0, expando: "jQuery" + (i.fn.jquery + Math.random()).replace(/\D/g, ""), noData: {embed: !0, object: "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000", applet: !0}, hasData: function (n) {
        return n = n.nodeType ? i.cache[n[i.expando]] : n[i.expando], !!n && !ut(n)
    }, data: function (n, r, u, f) {
        var s;
        if (i.acceptData(n)) {
            s = i.expando;
            var c = "string" == typeof r, h = n.nodeType, o = h ? i.cache : n, e = h ? n[s] : n[s] && s, l = "events" === r;
            if (e && o[e] && (l || f || o[e].data) || !c || u !== t)return(e || (h ? n[s] = e = ++i.uuid : e = s), o[e] || (o[e] = {}, h || (o[e].toJSON = i.noop)), ("object" == typeof r || "function" == typeof r) && (f ? o[e] = i.extend(o[e], r) : o[e].data = i.extend(o[e].data, r)), s = n = o[e], f || (n.data || (n.data = {}), n = n.data), u !== t && (n[i.camelCase(r)] = u), l && !n[r]) ? s.events : (c ? (u = n[r], null == u && (u = n[i.camelCase(r)])) : u = n, u)
        }
    }, removeData: function (n, t, r) {
        if (i.acceptData(n)) {
            var e, s, c, o = i.expando, h = n.nodeType, u = h ? i.cache : n, f = h ? n[o] : o;
            if (u[f]) {
                if (t && (e = r ? u[f] : u[f].data)) {
                    for (i.isArray(t) || ((t in e) ? t = [t] : (t = i.camelCase(t), t = (t in e) ? [t] : t.split(" "))), s = 0, c = t.length; s < c; s++)delete e[t[s]];
                    if (!(r ? ut : i.isEmptyObject)(e))return
                }
                if (!r && (delete u[f].data, !ut(u[f])))return;
                i.support.deleteExpando || !u.setInterval ? delete u[f] : u[f] = null;
                h && (i.support.deleteExpando ? delete n[o] : n.removeAttribute ? n.removeAttribute(o) : n[o] = null)
            }
        }
    }, _data: function (n, t, r) {
        return i.data(n, t, r, !0)
    }, acceptData: function (n) {
        if (n.nodeName) {
            var t = i.noData[n.nodeName.toLowerCase()];
            if (t)return!(!0 === t || n.getAttribute("classid") !== t)
        }
        return!0
    }});
    i.fn.extend({data: function (n, r) {
        var u, s, h, o, l, e = this[0], c = 0, f = null;
        if (n === t) {
            if (this.length && (f = i.data(e), 1 === e.nodeType && !i._data(e, "parsedAttrs"))) {
                for (h = e.attributes, l = h.length; c < l; c++)o = h[c].name, 0 === o.indexOf("data-") && (o = i.camelCase(o.substring(5)), yt(e, o, f[o]));
                i._data(e, "parsedAttrs", !0)
            }
            return f
        }
        return"object" == typeof n ? this.each(function () {
            i.data(this, n)
        }) : (u = n.split(".", 2), u[1] = u[1] ? "." + u[1] : "", s = u[1] + "!", i.access(this, function (r) {
            if (r === t)return f = this.triggerHandler("getData" + s, [u[0]]), f === t && e && (f = i.data(e, n), f = yt(e, n, f)), f === t && u[1] ? this.data(u[0]) : f;
            u[1] = r;
            this.each(function () {
                var t = i(this);
                t.triggerHandler("setData" + s, u);
                i.data(this, n, r);
                t.triggerHandler("changeData" + s, u)
            })
        }, null, r, 1 < arguments.length, null, !1))
    }, removeData: function (n) {
        return this.each(function () {
            i.removeData(this, n)
        })
    }});
    i.extend({_mark: function (n, t) {
        n && (t = (t || "fx") + "mark", i._data(n, t, (i._data(n, t) || 0) + 1))
    }, _unmark: function (n, t, r) {
        if (!0 !== n && (r = t, t = n, n = !1), t) {
            r = r || "fx";
            var u = r + "mark";
            (n = n ? 0 : (i._data(t, u) || 1) - 1) ? i._data(t, u, n) : (i.removeData(t, u, !0), pt(t, r, "mark"))
        }
    }, queue: function (n, t, r) {
        var u;
        if (n)return t = (t || "fx") + "queue", u = i._data(n, t), r && (!u || i.isArray(r) ? u = i._data(n, t, i.makeArray(r)) : u.push(r)), u || []
    }, dequeue: function (n, t) {
        t = t || "fx";
        var r = i.queue(n, t), u = r.shift(), f = {};
        "inprogress" === u && (u = r.shift());
        u && ("fx" === t && r.unshift("inprogress"), i._data(n, t + ".run", f), u.call(n, function () {
            i.dequeue(n, t)
        }, f));
        r.length || (i.removeData(n, t + "queue " + t + ".run", !0), pt(n, t, "queue"))
    }});
    i.fn.extend({queue: function (n, r) {
        var u = 2;
        return"string" != typeof n && (r = n, n = "fx", u--), arguments.length < u ? i.queue(this[0], n) : r === t ? this : this.each(function () {
            var t = i.queue(this, n, r);
            "fx" === n && "inprogress" !== t[0] && i.dequeue(this, n)
        })
    }, dequeue: function (n) {
        return this.each(function () {
            i.dequeue(this, n)
        })
    }, delay: function (n, t) {
        return n = i.fx ? i.fx.speeds[n] || n : n, this.queue(t || "fx", function (t, i) {
            var r = setTimeout(t, n);
            i.stop = function () {
                clearTimeout(r)
            }
        })
    }, clearQueue: function (n) {
        return this.queue(n || "fx", [])
    }, promise: function (n, r) {
        function e() {
            --s || o.resolveWith(u, [u])
        }

        "string" != typeof n && (r = n, n = t);
        n = n || "fx";
        for (var o = i.Deferred(), u = this, f = u.length, s = 1, h = n + "defer", l = n + "queue", a = n + "mark", c; f--;)(c = i.data(u[f], h, t, !0) || (i.data(u[f], l, t, !0) || i.data(u[f], a, t, !0)) && i.data(u[f], h, i.Callbacks("once memory"), !0)) && (s++, c.add(e));
        return e(), o.promise(r)
    }});
    var ai = /[\n\t\r]/g, g = /\s+/, ru = /\r/g, uu = /^(?:button|input)$/i, fu = /^(?:button|input|object|select|textarea)$/i, eu = /^a(?:rea)?$/i, vi = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, yi = i.support.getSetAttribute, e, pi, wi;
    i.fn.extend({attr: function (n, t) {
        return i.access(this, i.attr, n, t, 1 < arguments.length)
    }, removeAttr: function (n) {
        return this.each(function () {
            i.removeAttr(this, n)
        })
    }, prop: function (n, t) {
        return i.access(this, i.prop, n, t, 1 < arguments.length)
    }, removeProp: function (n) {
        return n = i.propFix[n] || n, this.each(function () {
            try {
                this[n] = t;
                delete this[n]
            } catch (i) {
            }
        })
    }, addClass: function (n) {
        var r, f, o, t, e, u, s;
        if (i.isFunction(n))return this.each(function (t) {
            i(this).addClass(n.call(this, t, this.className))
        });
        if (n && "string" == typeof n)for (r = n.split(g), f = 0, o = this.length; f < o; f++)if (t = this[f], 1 === t.nodeType)if (t.className || 1 !== r.length) {
            for (e = " " + t.className + " ", u = 0, s = r.length; u < s; u++)~e.indexOf(" " + r[u] + " ") || (e += r[u] + " ");
            t.className = i.trim(e)
        } else t.className = n;
        return this
    }, removeClass: function (n) {
        var o, u, s, r, f, e, h;
        if (i.isFunction(n))return this.each(function (t) {
            i(this).removeClass(n.call(this, t, this.className))
        });
        if (n && "string" == typeof n || n === t)for (o = (n || "").split(g), u = 0, s = this.length; u < s; u++)if (r = this[u], 1 === r.nodeType && r.className)if (n) {
            for (f = (" " + r.className + " ").replace(ai, " "), e = 0, h = o.length; e < h; e++)f = f.replace(" " + o[e] + " ", " ");
            r.className = i.trim(f)
        } else r.className = "";
        return this
    }, toggleClass: function (n, t) {
        var r = typeof n, u = "boolean" == typeof t;
        return i.isFunction(n) ? this.each(function (r) {
            i(this).toggleClass(n.call(this, r, this.className, t), t)
        }) : this.each(function () {
            if ("string" === r)for (var f, s = 0, o = i(this), e = t, h = n.split(g); f = h[s++];)e = u ? e : !o.hasClass(f), o[e ? "addClass" : "removeClass"](f); else("undefined" === r || "boolean" === r) && (this.className && i._data(this, "__className__", this.className), this.className = this.className || !1 === n ? "" : i._data(this, "__className__") || "")
        })
    }, hasClass: function (n) {
        n = " " + n + " ";
        for (var t = 0, i = this.length; t < i; t++)if (1 === this[t].nodeType && -1 < (" " + this[t].className + " ").replace(ai, " ").indexOf(n))return!0;
        return!1
    }, val: function (n) {
        var r, u, e, f = this[0];
        return arguments.length ? (e = i.isFunction(n), this.each(function (u) {
            var f = i(this);
            1 === this.nodeType && (u = e ? n.call(this, u, f.val()) : n, null == u ? u = "" : "number" == typeof u ? u += "" : i.isArray(u) && (u = i.map(u, function (n) {
                return null == n ? "" : n + ""
            })), r = i.valHooks[this.type] || i.valHooks[this.nodeName.toLowerCase()], r && "set"in r && r.set(this, u, "value") !== t || (this.value = u))
        })) : f ? (r = i.valHooks[f.type] || i.valHooks[f.nodeName.toLowerCase()]) && "get"in r && (u = r.get(f, "value")) !== t ? u : (u = f.value, "string" == typeof u ? u.replace(ru, "") : null == u ? "" : u) : void 0
    }});
    i.extend({valHooks: {option: {get: function (n) {
        var t = n.attributes.value;
        return!t || t.specified ? n.value : n.text
    }}, select: {get: function (n) {
        var t, o, r = n.selectedIndex, e = [], u = n.options, f = "select-one" === n.type;
        if (0 > r)return null;
        for (n = f ? r : 0, o = f ? r + 1 : u.length; n < o; n++)if (t = u[n], !(!t.selected || (i.support.optDisabled ? t.disabled : null !== t.getAttribute("disabled")) || t.parentNode.disabled && i.nodeName(t.parentNode, "optgroup"))) {
            if (t = i(t).val(), f)return t;
            e.push(t)
        }
        return f && !e.length && u.length ? i(u[r]).val() : e
    }, set: function (n, t) {
        var r = i.makeArray(t);
        return i(n).find("option").each(function () {
            this.selected = 0 <= i.inArray(i(this).val(), r)
        }), r.length || (n.selectedIndex = -1), r
    }}}, attrFn: {val: !0, css: !0, html: !0, text: !0, data: !0, width: !0, height: !0, offset: !0}, attr: function (n, r, u, f) {
        var o, s, h = n.nodeType;
        if (n && 3 !== h && 8 !== h && 2 !== h) {
            if (f && r in i.attrFn)return i(n)[r](u);
            if ("undefined" == typeof n.getAttribute)return i.prop(n, r, u);
            if ((f = 1 !== h || !i.isXMLDoc(n)) && (r = r.toLowerCase(), s = i.attrHooks[r] || (vi.test(r) ? pi : e)), u !== t)if (null === u)i.removeAttr(n, r); else return s && "set"in s && f && (o = s.set(n, u, r)) !== t ? o : (n.setAttribute(r, "" + u), u); else return s && "get"in s && f && null !== (o = s.get(n, r)) ? o : (o = n.getAttribute(r), null === o ? t : o)
        }
    }, removeAttr: function (n, t) {
        var u, f, r, o, s, e = 0;
        if (t && 1 === n.nodeType)for (f = t.toLowerCase().split(g), o = f.length; e < o; e++)(r = f[e]) && (u = i.propFix[r] || r, (s = vi.test(r)) || i.attr(n, r, ""), n.removeAttribute(yi ? r : u), s && u in n && (n[u] = !1))
    }, attrHooks: {type: {set: function (n, t) {
        if (uu.test(n.nodeName) && n.parentNode)i.error("type property can't be changed"); else if (!i.support.radioValue && "radio" === t && i.nodeName(n, "input")) {
            var r = n.value;
            return n.setAttribute("type", t), r && (n.value = r), t
        }
    }}, value: {get: function (n, t) {
        return e && i.nodeName(n, "button") ? e.get(n, t) : t in n ? n.value : null
    }, set: function (n, t, r) {
        if (e && i.nodeName(n, "button"))return e.set(n, t, r);
        n.value = t
    }}}, propFix: {tabindex: "tabIndex", readonly: "readOnly", "for": "htmlFor", "class": "className", maxlength: "maxLength", cellspacing: "cellSpacing", cellpadding: "cellPadding", rowspan: "rowSpan", colspan: "colSpan", usemap: "useMap", frameborder: "frameBorder", contenteditable: "contentEditable"}, prop: function (n, r, u) {
        var o, f, e;
        return e = n.nodeType, n && 3 !== e && 8 !== e && 2 !== e ? ((e = 1 !== e || !i.isXMLDoc(n)) && (r = i.propFix[r] || r, f = i.propHooks[r]), u !== t ? f && "set"in f && (o = f.set(n, u, r)) !== t ? o : n[r] = u : f && "get"in f && null !== (o = f.get(n, r)) ? o : n[r]) : void 0
    }, propHooks: {tabIndex: {get: function (n) {
        var i = n.getAttributeNode("tabindex");
        return i && i.specified ? parseInt(i.value, 10) : fu.test(n.nodeName) || eu.test(n.nodeName) && n.href ? 0 : t
    }}}});
    i.attrHooks.tabindex = i.propHooks.tabIndex;
    pi = {get: function (n, r) {
        var u, f = i.prop(n, r);
        return!0 === f || "boolean" != typeof f && (u = n.getAttributeNode(r)) && !1 !== u.nodeValue ? r.toLowerCase() : t
    }, set: function (n, t, r) {
        return!1 === t ? i.removeAttr(n, r) : (t = i.propFix[r] || r, t in n && (n[t] = !0), n.setAttribute(r, r.toLowerCase())), r
    }};
    yi || (wi = {name: !0, id: !0, coords: !0}, e = i.valHooks.button = {get: function (n, i) {
        var r;
        return(r = n.getAttributeNode(i)) && (wi[i] ? "" !== r.nodeValue : r.specified) ? r.nodeValue : t
    }, set: function (n, t, i) {
        var u = n.getAttributeNode(i);
        return u || (u = r.createAttribute(i), n.setAttributeNode(u)), u.nodeValue = t + ""
    }}, i.attrHooks.tabindex.set = e.set, i.each(["width", "height"], function (n, t) {
        i.attrHooks[t] = i.extend(i.attrHooks[t], {set: function (n, i) {
            if ("" === i)return n.setAttribute(t, "auto"), i
        }})
    }), i.attrHooks.contenteditable = {get: e.get, set: function (n, t, i) {
        "" === t && (t = "false");
        e.set(n, t, i)
    }});
    i.support.hrefNormalized || i.each(["href", "src", "width", "height"], function (n, r) {
        i.attrHooks[r] = i.extend(i.attrHooks[r], {get: function (n) {
            return n = n.getAttribute(r, 2), null === n ? t : n
        }})
    });
    i.support.style || (i.attrHooks.style = {get: function (n) {
        return n.style.cssText.toLowerCase() || t
    }, set: function (n, t) {
        return n.style.cssText = "" + t
    }});
    i.support.optSelected || (i.propHooks.selected = i.extend(i.propHooks.selected, {get: function (n) {
        return(n = n.parentNode) && (n.selectedIndex, n.parentNode && n.parentNode.selectedIndex), null
    }}));
    i.support.enctype || (i.propFix.enctype = "encoding");
    i.support.checkOn || i.each(["radio", "checkbox"], function () {
        i.valHooks[this] = {get: function (n) {
            return null === n.getAttribute("value") ? "on" : n.value
        }}
    });
    i.each(["radio", "checkbox"], function () {
        i.valHooks[this] = i.extend(i.valHooks[this], {set: function (n, t) {
            if (i.isArray(t))return n.checked = 0 <= i.inArray(i(n).val(), t)
        }})
    });
    var et = /^(?:textarea|input|select)$/i, bi = /^([^\.]*)?(?:\.(.+))?$/, ou = /(?:^|\s)hover(\.\S+)?\b/, su = /^key/, hu = /^(?:mouse|contextmenu)|click/, ki = /^(?:focusinfocus|focusoutblur)$/, cu = /^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/, lu = function (n) {
        return(n = cu.exec(n)) && (n[1] = (n[1] || "").toLowerCase(), n[3] = n[3] && new RegExp("(?:^|\\s)" + n[3] + "(?:\\s|$)")), n
    }, di = function (n) {
        return i.event.special.hover ? n : n.replace(ou, "mouseenter$1 mouseleave$1")
    };
    i.event = {add: function (n, r, u, f, e) {
        var h, c, v, s, o, p, y, a, l;
        if (3 !== n.nodeType && 8 !== n.nodeType && r && u && (h = i._data(n))) {
            for (u.handler && (y = u, u = y.handler, e = y.selector), u.guid || (u.guid = i.guid++), v = h.events, v || (h.events = v = {}), c = h.handle, c || (h.handle = c = function (n) {
                return"undefined" == typeof i || n && i.event.triggered === n.type ? t : i.event.dispatch.apply(c.elem, arguments)
            }, c.elem = n), r = i.trim(di(r)).split(" "), h = 0; h < r.length; h++)s = bi.exec(r[h]) || [], o = s[1], p = (s[2] || "").split(".").sort(), l = i.event.special[o] || {}, o = (e ? l.delegateType : l.bindType) || o, l = i.event.special[o] || {}, s = i.extend({type: o, origType: s[1], data: f, handler: u, guid: u.guid, selector: e, quick: e && lu(e), namespace: p.join(".")}, y), a = v[o], a || (a = v[o] = [], a.delegateCount = 0, l.setup && !1 !== l.setup.call(n, f, p, c) || (n.addEventListener ? n.addEventListener(o, c, !1) : n.attachEvent && n.attachEvent("on" + o, c))), l.add && (l.add.call(n, s), s.handler.guid || (s.handler.guid = u.guid)), e ? a.splice(a.delegateCount++, 0, s) : a.push(s), i.event.global[o] = !0;
            n = null
        }
    }, global: {}, remove: function (n, t, r, u, f) {
        var y = i.hasData(n) && i._data(n), l, e, o, p, w, a, v, c, s, h;
        if (y && (v = y.events)) {
            for (t = i.trim(di(t || "")).split(" "), l = 0; l < t.length; l++)if (e = bi.exec(t[l]) || [], o = p = e[1], e = e[2], o) {
                for (c = i.event.special[o] || {}, o = (u ? c.delegateType : c.bindType) || o, s = v[o] || [], w = s.length, e = e ? new RegExp("(^|\\.)" + e.split(".").sort().join("\\.(?:.*\\.)?") + "(\\.|$)") : null, a = 0; a < s.length; a++)h = s[a], !f && p !== h.origType || r && r.guid !== h.guid || e && !e.test(h.namespace) || u && u !== h.selector && ("**" !== u || !h.selector) || (s.splice(a--, 1), h.selector && s.delegateCount--, c.remove && c.remove.call(n, h));
                0 === s.length && w !== s.length && (c.teardown && !1 !== c.teardown.call(n, e) || i.removeEvent(n, o, y.handle), delete v[o])
            } else for (o in v)i.event.remove(n, o + t[l], r, u, !0);
            i.isEmptyObject(v) && ((t = y.handle) && (t.elem = null), i.removeData(n, ["events", "handle"], !0))
        }
    }, customEvent: {getData: !0, setData: !0, changeData: !0}, trigger: function (r, u, f, e) {
        if (!f || 3 !== f.nodeType && 8 !== f.nodeType) {
            var o = r.type || r, s = [], c, h, l, a, v;
            if (!ki.test(o + i.event.triggered) && (0 <= o.indexOf("!") && (o = o.slice(0, -1), c = !0), 0 <= o.indexOf(".") && (s = o.split("."), o = s.shift(), s.sort()), f && !i.event.customEvent[o] || i.event.global[o]))if (r = "object" == typeof r ? r[i.expando] ? r : new i.Event(o, r) : new i.Event(o), r.type = o, r.isTrigger = !0, r.exclusive = c, r.namespace = s.join("."), r.namespace_re = r.namespace ? new RegExp("(^|\\.)" + s.join("\\.(?:.*\\.)?") + "(\\.|$)") : null, c = 0 > o.indexOf(":") ? "on" + o : "", f) {
                if (r.result = t, r.target || (r.target = f), u = null != u ? i.makeArray(u) : [], u.unshift(r), l = i.event.special[o] || {}, !l.trigger || !1 !== l.trigger.apply(f, u)) {
                    if (v = [
                        [f, l.bindType || o]
                    ], !e && !l.noBubble && !i.isWindow(f)) {
                        for (a = l.delegateType || o, s = ki.test(a + o) ? f : f.parentNode, h = null; s; s = s.parentNode)v.push([s, a]), h = s;
                        h && h === f.ownerDocument && v.push([h.defaultView || h.parentWindow || n, a])
                    }
                    for (h = 0; h < v.length && !r.isPropagationStopped(); h++)s = v[h][0], r.type = v[h][1], (a = (i._data(s, "events") || {})[r.type] && i._data(s, "handle")) && a.apply(s, u), (a = c && s[c]) && i.acceptData(s) && !1 === a.apply(s, u) && r.preventDefault();
                    return r.type = o, e || r.isDefaultPrevented() || l._default && !1 !== l._default.apply(f.ownerDocument, u) || "click" === o && i.nodeName(f, "a") || !i.acceptData(f) || !c || !f[o] || ("focus" === o || "blur" === o) && 0 === r.target.offsetWidth || i.isWindow(f) || ((h = f[c]) && (f[c] = null), i.event.triggered = o, f[o](), i.event.triggered = t, h && (f[c] = h)), r.result
                }
            } else for (h in f = i.cache, f)f[h].events && f[h].events[o] && i.event.trigger(r, u, f[h].handle.elem, !0)
        }
    }, dispatch: function (r) {
        var k, d, f, w;
        r = i.event.fix(r || n.event);
        var s = (i._data(this, "events") || {})[r.type] || [], e = s.delegateCount, b = [].slice.call(arguments, 0), g = !r.exclusive && !r.namespace, l = i.event.special[r.type] || {}, a = [], h, o, v, u, y, p, c;
        if (b[0] = r, r.delegateTarget = this, !l.preDispatch || !1 !== l.preDispatch.call(this, r)) {
            if (e && (!r.button || "click" !== r.type))for (v = i(this), v.context = this.ownerDocument || this, o = r.target; o != this; o = o.parentNode || this)if (!0 !== o.disabled) {
                for (y = {}, p = [], v[0] = o, h = 0; h < e; h++)u = s[h], c = u.selector, y[c] === t && (k = y, d = c, u.quick ? (f = u.quick, w = o.attributes || {}, f = (!f[1] || o.nodeName.toLowerCase() === f[1]) && (!f[2] || (w.id || {}).value === f[2]) && (!f[3] || f[3].test((w["class"] || {}).value))) : f = v.is(c), k[d] = f), y[c] && p.push(u);
                p.length && a.push({elem: o, matches: p})
            }
            for (s.length > e && a.push({elem: this, matches: s.slice(e)}), h = 0; h < a.length && !r.isPropagationStopped(); h++)for (e = a[h], r.currentTarget = e.elem, s = 0; s < e.matches.length && !r.isImmediatePropagationStopped(); s++)(u = e.matches[s], g || !r.namespace && !u.namespace || r.namespace_re && r.namespace_re.test(u.namespace)) && (r.data = u.data, r.handleObj = u, u = ((i.event.special[u.origType] || {}).handle || u.handler).apply(e.elem, b), u !== t && (r.result = u, !1 === u && (r.preventDefault(), r.stopPropagation())));
            return l.postDispatch && l.postDispatch.call(this, r), r.result
        }
    }, props: "attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks: {}, keyHooks: {props: ["char", "charCode", "key", "keyCode"], filter: function (n, t) {
        return null == n.which && (n.which = null != t.charCode ? t.charCode : t.keyCode), n
    }}, mouseHooks: {props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter: function (n, i) {
        var u, f, e = i.button, o = i.fromElement;
        return null == n.pageX && null != i.clientX && (u = n.target.ownerDocument || r, f = u.documentElement, u = u.body, n.pageX = i.clientX + (f && f.scrollLeft || u && u.scrollLeft || 0) - (f && f.clientLeft || u && u.clientLeft || 0), n.pageY = i.clientY + (f && f.scrollTop || u && u.scrollTop || 0) - (f && f.clientTop || u && u.clientTop || 0)), !n.relatedTarget && o && (n.relatedTarget = o === n.target ? i.toElement : o), n.which || e === t || (n.which = e & 1 ? 1 : e & 2 ? 3 : e & 4 ? 2 : 0), n
    }}, fix: function (n) {
        if (n[i.expando])return n;
        var e, o, u = n, f = i.event.fixHooks[n.type] || {}, s = f.props ? this.props.concat(f.props) : this.props;
        for (n = i.Event(u), e = s.length; e;)o = s[--e], n[o] = u[o];
        return n.target || (n.target = u.srcElement || r), 3 === n.target.nodeType && (n.target = n.target.parentNode), n.metaKey === t && (n.metaKey = n.ctrlKey), f.filter ? f.filter(n, u) : n
    }, special: {ready: {setup: i.bindReady}, load: {noBubble: !0}, focus: {delegateType: "focusin"}, blur: {delegateType: "focusout"}, beforeunload: {setup: function (n, t, r) {
        i.isWindow(this) && (this.onbeforeunload = r)
    }, teardown: function (n, t) {
        this.onbeforeunload === t && (this.onbeforeunload = null)
    }}}, simulate: function (n, t, r, u) {
        n = i.extend(new i.Event, r, {type: n, isSimulated: !0, originalEvent: {}});
        u ? i.event.trigger(n, null, t) : i.event.dispatch.call(t, n);
        n.isDefaultPrevented() && r.preventDefault()
    }};
    i.event.handle = i.event.dispatch;
    i.removeEvent = r.removeEventListener ? function (n, t, i) {
        n.removeEventListener && n.removeEventListener(t, i, !1)
    } : function (n, t, i) {
        n.detachEvent && n.detachEvent("on" + t, i)
    };
    i.Event = function (n, t) {
        if (!(this instanceof i.Event))return new i.Event(n, t);
        n && n.type ? (this.originalEvent = n, this.type = n.type, this.isDefaultPrevented = n.defaultPrevented || !1 === n.returnValue || n.getPreventDefault && n.getPreventDefault() ? w : c) : this.type = n;
        t && i.extend(this, t);
        this.timeStamp = n && n.timeStamp || i.now();
        this[i.expando] = !0
    };
    i.Event.prototype = {preventDefault: function () {
        this.isDefaultPrevented = w;
        var n = this.originalEvent;
        n && (n.preventDefault ? n.preventDefault() : n.returnValue = !1)
    }, stopPropagation: function () {
        this.isPropagationStopped = w;
        var n = this.originalEvent;
        n && (n.stopPropagation && n.stopPropagation(), n.cancelBubble = !0)
    }, stopImmediatePropagation: function () {
        this.isImmediatePropagationStopped = w;
        this.stopPropagation()
    }, isDefaultPrevented: c, isPropagationStopped: c, isImmediatePropagationStopped: c};
    i.each({mouseenter: "mouseover", mouseleave: "mouseout"}, function (n, t) {
        i.event.special[n] = {delegateType: t, bindType: t, handle: function (n) {
            var r = n.relatedTarget, u = n.handleObj, f;
            return r && (r === this || i.contains(this, r)) || (n.type = u.origType, f = u.handler.apply(this, arguments), n.type = t), f
        }}
    });
    i.support.submitBubbles || (i.event.special.submit = {setup: function () {
        if (i.nodeName(this, "form"))return!1;
        i.event.add(this, "click._submit keypress._submit", function (n) {
            n = n.target;
            (n = i.nodeName(n, "input") || i.nodeName(n, "button") ? n.form : t) && !n._submit_attached && (i.event.add(n, "submit._submit", function (n) {
                n._submit_bubble = !0
            }), n._submit_attached = !0)
        })
    }, postDispatch: function (n) {
        n._submit_bubble && (delete n._submit_bubble, this.parentNode && !n.isTrigger && i.event.simulate("submit", this.parentNode, n, !0))
    }, teardown: function () {
        if (i.nodeName(this, "form"))return!1;
        i.event.remove(this, "._submit")
    }});
    i.support.changeBubbles || (i.event.special.change = {setup: function () {
        if (et.test(this.nodeName))return("checkbox" === this.type || "radio" === this.type) && (i.event.add(this, "propertychange._change", function (n) {
            "checked" === n.originalEvent.propertyName && (this._just_changed = !0)
        }), i.event.add(this, "click._change", function (n) {
            this._just_changed && !n.isTrigger && (this._just_changed = !1, i.event.simulate("change", this, n, !0))
        })), !1;
        i.event.add(this, "beforeactivate._change", function (n) {
            n = n.target;
            et.test(n.nodeName) && !n._change_attached && (i.event.add(n, "change._change", function (n) {
                !this.parentNode || n.isSimulated || n.isTrigger || i.event.simulate("change", this.parentNode, n, !0)
            }), n._change_attached = !0)
        })
    }, handle: function (n) {
        var t = n.target;
        if (this !== t || n.isSimulated || n.isTrigger || "radio" !== t.type && "checkbox" !== t.type)return n.handleObj.handler.apply(this, arguments)
    }, teardown: function () {
        return i.event.remove(this, "._change"), et.test(this.nodeName)
    }});
    i.support.focusinBubbles || i.each({focus: "focusin", blur: "focusout"}, function (n, t) {
        var u = 0, f = function (n) {
            i.event.simulate(t, n.target, i.event.fix(n), !0)
        };
        i.event.special[t] = {setup: function () {
            0 == u++ && r.addEventListener(n, f, !0)
        }, teardown: function () {
            0 == --u && r.removeEventListener(n, f, !0)
        }}
    });
    i.fn.extend({on: function (n, r, u, f, e) {
        var o, s;
        if ("object" == typeof n) {
            "string" != typeof r && (u = u || r, r = t);
            for (s in n)this.on(s, r, u, n[s], e);
            return this
        }
        if (null == u && null == f ? (f = r, u = r = t) : null == f && ("string" == typeof r ? (f = u, u = t) : (f = u, u = r, r = t)), !1 === f)f = c; else if (!f)return this;
        return 1 === e && (o = f, f = function (n) {
            return i().off(n), o.apply(this, arguments)
        }, f.guid = o.guid || (o.guid = i.guid++)), this.each(function () {
            i.event.add(this, n, f, u, r)
        })
    }, one: function (n, t, i, r) {
        return this.on(n, t, i, r, 1)
    }, off: function (n, r, u) {
        if (n && n.preventDefault && n.handleObj) {
            var f = n.handleObj;
            return i(n.delegateTarget).off(f.namespace ? f.origType + "." + f.namespace : f.origType, f.selector, f.handler), this
        }
        if ("object" == typeof n) {
            for (f in n)this.off(f, r, n[f]);
            return this
        }
        return(!1 === r || "function" == typeof r) && (u = r, r = t), !1 === u && (u = c), this.each(function () {
            i.event.remove(this, n, u, r)
        })
    }, bind: function (n, t, i) {
        return this.on(n, null, t, i)
    }, unbind: function (n, t) {
        return this.off(n, null, t)
    }, live: function (n, t, r) {
        i(this.context).on(n, this.selector, t, r);
        return this
    }, die: function (n, t) {
        return i(this.context).off(n, this.selector || "**", t), this
    }, delegate: function (n, t, i, r) {
        return this.on(t, n, i, r)
    }, undelegate: function (n, t, i) {
        return 1 == arguments.length ? this.off(n, "**") : this.off(t, n, i)
    }, trigger: function (n, t) {
        return this.each(function () {
            i.event.trigger(n, t, this)
        })
    }, triggerHandler: function (n, t) {
        if (this[0])return i.event.trigger(n, t, this[0], !0)
    }, toggle: function (n) {
        var t = arguments, u = n.guid || i.guid++, r = 0, f = function (u) {
            var f = (i._data(this, "lastToggle" + n.guid) || 0) % r;
            return i._data(this, "lastToggle" + n.guid, f + 1), u.preventDefault(), t[f].apply(this, arguments) || !1
        };
        for (f.guid = u; r < t.length;)t[r++].guid = u;
        return this.click(f)
    }, hover: function (n, t) {
        return this.mouseenter(n).mouseleave(t || n)
    }});
    i.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (n, t) {
        i.fn[t] = function (n, i) {
            return null == i && (i = n, n = null), 0 < arguments.length ? this.on(t, null, n, i) : this.trigger(t)
        };
        i.attrFn && (i.attrFn[t] = !0);
        su.test(t) && (i.event.fixHooks[t] = i.event.keyHooks);
        hu.test(t) && (i.event.fixHooks[t] = i.event.mouseHooks)
    }), function () {
        function b(n, t, i, r, u, f) {
            var h, s, o;
            for (u = 0, h = r.length; u < h; u++)if (o = r[u], o) {
                for (s = !1, o = o[n]; o;) {
                    if (o[e] === i) {
                        s = r[o.sizset];
                        break
                    }
                    if (1 !== o.nodeType || f || (o[e] = i, o.sizset = u), o.nodeName.toLowerCase() === t) {
                        s = o;
                        break
                    }
                    o = o[n]
                }
                r[u] = s
            }
        }

        function k(t, i, r, u, f, o) {
            var c, h, s;
            for (f = 0, c = u.length; f < c; f++)if (s = u[f], s) {
                for (h = !1, s = s[t]; s;) {
                    if (s[e] === r) {
                        h = u[s.sizset];
                        break
                    }
                    if (1 === s.nodeType)if (o || (s[e] = r, s.sizset = f), "string" != typeof i) {
                        if (s === i) {
                            h = !0;
                            break
                        }
                    } else if (0 < n.filter(i, [s]).length) {
                        h = s;
                        break
                    }
                    s = s[t]
                }
                u[f] = h
            }
        }

        var v = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, e = "sizcache" + (Math.random() + "").replace(".", ""), y = 0, d = Object.prototype.toString, h = !1, g = !0, o = /\\/g, tt = /\r\n/g, c = /\W/, n, f, a, s, w;
        [0, 0].sort(function () {
            return g = !1, 0
        });
        n = function (t, i, e, o) {
            var b;
            if (e = e || [], b = i = i || r, 1 !== i.nodeType && 9 !== i.nodeType)return[];
            if (!t || "string" != typeof t)return e;
            var h, l, c, p, a, k = !0, y = n.isXML(i), s = [], g = t;
            do if ((v.exec(""), h = v.exec(g)) && (g = h[3], s.push(h[1]), h[2])) {
                p = h[3];
                break
            } while (h);
            if (1 < s.length && nt.exec(t))if (2 === s.length && u.relative[s[0]])l = w(s[0] + s[1], i, o); else for (l = u.relative[s[0]] ? [i] : n(s.shift(), i); s.length;)t = s.shift(), u.relative[t] && (t += s.shift()), l = w(t, l, o); else if (!o && 1 < s.length && 9 === i.nodeType && !y && u.match.ID.test(s[0]) && !u.match.ID.test(s[s.length - 1]) && (h = n.find(s.shift(), i, y), i = h.expr ? n.filter(h.expr, h.set)[0] : h.set[0]), i)for (h = o ? {expr: s.pop(), set: f(o)} : n.find(s.pop(), 1 !== s.length || "~" !== s[0] && "+" !== s[0] || !i.parentNode ? i : i.parentNode, y), l = h.expr ? n.filter(h.expr, h.set) : h.set, 0 < s.length ? c = f(l) : k = !1; s.length;)h = a = s.pop(), u.relative[a] ? h = s.pop() : a = "", null == h && (h = i), u.relative[a](c, h, y); else c = [];
            if (c || (c = l), c || n.error(a || t), "[object Array]" === d.call(c))if (k)if (i && 1 === i.nodeType)for (t = 0; null != c[t]; t++)c[t] && (!0 === c[t] || 1 === c[t].nodeType && n.contains(i, c[t])) && e.push(l[t]); else for (t = 0; null != c[t]; t++)c[t] && 1 === c[t].nodeType && e.push(l[t]); else e.push.apply(e, c); else f(c, e);
            return p && (n(p, b, e, o), n.uniqueSort(e)), e
        };
        n.uniqueSort = function (n) {
            if (a && (h = g, n.sort(a), h))for (var t = 1; t < n.length; t++)n[t] === n[t - 1] && n.splice(t--, 1);
            return n
        };
        n.matches = function (t, i) {
            return n(t, null, null, i)
        };
        n.matchesSelector = function (t, i) {
            return 0 < n(i, null, null, [t]).length
        };
        n.find = function (n, t, i) {
            var f, e, c, r, s, h;
            if (!n)return[];
            for (e = 0, c = u.order.length; e < c; e++)if ((s = u.order[e], r = u.leftMatch[s].exec(n)) && (h = r[1], r.splice(1, 1), "\\" !== h.substr(h.length - 1) && (r[1] = (r[1] || "").replace(o, ""), f = u.find[s](r, t, i), null != f))) {
                n = n.replace(u.match[s], "");
                break
            }
            return f || (f = "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName("*") : []), {set: f, expr: n}
        };
        n.filter = function (i, r, f, e) {
            for (var o, c, l, a, s, w, v, p, b = i, y = [], h = r, k = r && r[0] && n.isXML(r[0]); i && r.length;) {
                for (l in u.filter)if (null != (o = u.leftMatch[l].exec(i)) && o[2] && (w = u.filter[l], s = o[1], c = !1, o.splice(1, 1), "\\" !== s.substr(s.length - 1))) {
                    if (h === y && (y = []), u.preFilter[l])if (o = u.preFilter[l](o, h, f, y, e, k), o) {
                        if (!0 === o)continue
                    } else c = a = !0;
                    if (o)for (v = 0; null != (s = h[v]); v++)s && (a = w(s, o, v, h), p = e ^ a, f && null != a ? p ? c = !0 : h[v] = !1 : p && (y.push(s), c = !0));
                    if (a !== t) {
                        if (f || (h = y), i = i.replace(u.match[l], ""), !c)return[];
                        break
                    }
                }
                if (i === b)if (null == c)n.error(i); else break;
                b = i
            }
            return h
        };
        n.error = function (n) {
            throw Error("Syntax error, unrecognized expression: " + n);
        };
        var p = n.getText = function (n) {
            var t, r, i;
            if (t = n.nodeType, i = "", t) {
                if (1 === t || 9 === t || 11 === t) {
                    if ("string" == typeof n.textContent)return n.textContent;
                    if ("string" == typeof n.innerText)return n.innerText.replace(tt, "");
                    for (n = n.firstChild; n; n = n.nextSibling)i += p(n)
                } else if (3 === t || 4 === t)return n.nodeValue
            } else for (t = 0; r = n[t]; t++)8 !== r.nodeType && (i += p(r));
            return i
        }, u = n.selectors = {order: ["ID", "NAME", "TAG"], match: {ID: /#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, CLASS: /\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/, NAME: /\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/, ATTR: /\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/, TAG: /^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/, CHILD: /:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/, POS: /:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/, PSEUDO: /:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/}, leftMatch: {}, attrMap: {"class": "className", "for": "htmlFor"}, attrHandle: {href: function (n) {
            return n.getAttribute("href")
        }, type: function (n) {
            return n.getAttribute("type")
        }}, relative: {"+": function (t, i) {
            var f = "string" == typeof i, u = f && !c.test(i), f = f && !u, e, r;
            for (u && (i = i.toLowerCase()), u = 0, e = t.length; u < e; u++)if (r = t[u]) {
                for (; (r = r.previousSibling) && 1 !== r.nodeType;);
                t[u] = f || r && r.nodeName.toLowerCase() === i ? r || !1 : r === i
            }
            f && n.filter(i, t, !0)
        }, ">": function (t, i) {
            var r, f = "string" == typeof i, u = 0, e = t.length;
            if (f && !c.test(i))for (i = i.toLowerCase(); u < e; u++)(r = t[u]) && (r = r.parentNode, t[u] = r.nodeName.toLowerCase() === i ? r : !1); else {
                for (; u < e; u++)(r = t[u]) && (t[u] = f ? r.parentNode : r.parentNode === i);
                f && n.filter(i, t, !0)
            }
        }, "": function (n, t, i) {
            var r, f = y++, u = k;
            "string" != typeof t || c.test(t) || (r = t = t.toLowerCase(), u = b);
            u("parentNode", t, f, n, r, i)
        }, "~": function (n, t, i) {
            var r, f = y++, u = k;
            "string" != typeof t || c.test(t) || (r = t = t.toLowerCase(), u = b);
            u("previousSibling", t, f, n, r, i)
        }}, find: {ID: function (n, t, i) {
            if ("undefined" != typeof t.getElementById && !i)return(n = t.getElementById(n[1])) && n.parentNode ? [n] : []
        }, NAME: function (n, t) {
            if ("undefined" != typeof t.getElementsByName) {
                for (var r = [], u = t.getElementsByName(n[1]), i = 0, f = u.length; i < f; i++)u[i].getAttribute("name") === n[1] && r.push(u[i]);
                return 0 === r.length ? null : r
            }
        }, TAG: function (n, t) {
            if ("undefined" != typeof t.getElementsByTagName)return t.getElementsByTagName(n[1])
        }}, preFilter: {CLASS: function (n, t, i, r, u, f) {
            if (n = " " + n[1].replace(o, "") + " ", f)return n;
            f = 0;
            for (var e; null != (e = t[f]); f++)e && (u ^ (e.className && 0 <= (" " + e.className + " ").replace(/[\t\n\r]/g, " ").indexOf(n)) ? i || r.push(e) : i && (t[f] = !1));
            return!1
        }, ID: function (n) {
            return n[1].replace(o, "")
        }, TAG: function (n) {
            return n[1].replace(o, "").toLowerCase()
        }, CHILD: function (t) {
            if ("nth" === t[1]) {
                t[2] || n.error(t[0]);
                t[2] = t[2].replace(/^\+|\s*/g, "");
                var i = /(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even" === t[2] && "2n" || "odd" === t[2] && "2n+1" || !/\D/.test(t[2]) && "0n+" + t[2] || t[2]);
                t[2] = i[1] + (i[2] || 1) - 0;
                t[3] = i[3] - 0
            } else t[2] && n.error(t[0]);
            return t[0] = y++, t
        }, ATTR: function (n, t, i, r, f, e) {
            return t = n[1] = n[1].replace(o, ""), !e && u.attrMap[t] && (n[1] = u.attrMap[t]), n[4] = (n[4] || n[5] || "").replace(o, ""), "~=" === n[2] && (n[4] = " " + n[4] + " "), n
        }, PSEUDO: function (t, i, r, f, e) {
            if ("not" === t[1])if (1 < (v.exec(t[3]) || "").length || /^\w/.test(t[3]))t[3] = n(t[3], null, null, i); else return t = n.filter(t[3], i, r, 1 ^ e), r || f.push.apply(f, t), !1; else if (u.match.POS.test(t[0]) || u.match.CHILD.test(t[0]))return!0;
            return t
        }, POS: function (n) {
            return n.unshift(!0), n
        }}, filters: {enabled: function (n) {
            return!1 === n.disabled && "hidden" !== n.type
        }, disabled: function (n) {
            return!0 === n.disabled
        }, checked: function (n) {
            return!0 === n.checked
        }, selected: function (n) {
            return n.parentNode && n.parentNode.selectedIndex, !0 === n.selected
        }, parent: function (n) {
            return!!n.firstChild
        }, empty: function (n) {
            return!n.firstChild
        }, has: function (t, i, r) {
            return!!n(r[3], t).length
        }, header: function (n) {
            return/h\d/i.test(n.nodeName)
        }, text: function (n) {
            var t = n.getAttribute("type"), i = n.type;
            return"input" === n.nodeName.toLowerCase() && "text" === i && (t === i || null === t)
        }, radio: function (n) {
            return"input" === n.nodeName.toLowerCase() && "radio" === n.type
        }, checkbox: function (n) {
            return"input" === n.nodeName.toLowerCase() && "checkbox" === n.type
        }, file: function (n) {
            return"input" === n.nodeName.toLowerCase() && "file" === n.type
        }, password: function (n) {
            return"input" === n.nodeName.toLowerCase() && "password" === n.type
        }, submit: function (n) {
            var t = n.nodeName.toLowerCase();
            return("input" === t || "button" === t) && "submit" === n.type
        }, image: function (n) {
            return"input" === n.nodeName.toLowerCase() && "image" === n.type
        }, reset: function (n) {
            var t = n.nodeName.toLowerCase();
            return("input" === t || "button" === t) && "reset" === n.type
        }, button: function (n) {
            var t = n.nodeName.toLowerCase();
            return"input" === t && "button" === n.type || "button" === t
        }, input: function (n) {
            return/input|select|textarea|button/i.test(n.nodeName)
        }, focus: function (n) {
            return n === n.ownerDocument.activeElement
        }}, setFilters: {first: function (n, t) {
            return 0 === t
        }, last: function (n, t, i, r) {
            return t === r.length - 1
        }, even: function (n, t) {
            return 0 == t % 2
        }, odd: function (n, t) {
            return 1 == t % 2
        }, lt: function (n, t, i) {
            return t < i[3] - 0
        }, gt: function (n, t, i) {
            return t > i[3] - 0
        }, nth: function (n, t, i) {
            return i[3] - 0 === t
        }, eq: function (n, t, i) {
            return i[3] - 0 === t
        }}, filter: {PSEUDO: function (t, i, r, f) {
            var e = i[1], o = u.filters[e];
            if (o)return o(t, r, i, f);
            if ("contains" === e)return 0 <= (t.textContent || t.innerText || p([t]) || "").indexOf(i[3]);
            if ("not" === e) {
                for (i = i[3], r = 0, f = i.length; r < f; r++)if (i[r] === t)return!1;
                return!0
            }
            n.error(e)
        }, CHILD: function (n, t) {
            var r, f, o, u, s, i;
            r = t[1];
            i = n;
            switch (r) {
                case"only":
                case"first":
                    for (; i = i.previousSibling;)if (1 === i.nodeType)return!1;
                    if ("first" === r)return!0;
                    i = n;
                case"last":
                    for (; i = i.nextSibling;)if (1 === i.nodeType)return!1;
                    return!0;
                case"nth":
                    if (r = t[2], f = t[3], 1 === r && 0 === f)return!0;
                    if (o = t[0], (u = n.parentNode) && (u[e] !== o || !n.nodeIndex)) {
                        for (s = 0, i = u.firstChild; i; i = i.nextSibling)1 === i.nodeType && (i.nodeIndex = ++s);
                        u[e] = o
                    }
                    return i = n.nodeIndex - f, 0 === r ? 0 === i : 0 == i % r && 0 <= i / r
            }
        }, ID: function (n, t) {
            return 1 === n.nodeType && n.getAttribute("id") === t
        }, TAG: function (n, t) {
            return"*" === t && 1 === n.nodeType || !!n.nodeName && n.nodeName.toLowerCase() === t
        }, CLASS: function (n, t) {
            return-1 < (" " + (n.className || n.getAttribute("class")) + " ").indexOf(t)
        }, ATTR: function (t, i) {
            var f = i[1], f = n.attr ? n.attr(t, f) : u.attrHandle[f] ? u.attrHandle[f](t) : null != t[f] ? t[f] : t.getAttribute(f), e = f + "", o = i[2], r = i[4];
            return null == f ? "!=" === o : !o && n.attr ? null != f : "=" === o ? e === r : "*=" === o ? 0 <= e.indexOf(r) : "~=" === o ? 0 <= (" " + e + " ").indexOf(r) : r ? "!=" === o ? e !== r : "^=" === o ? 0 === e.indexOf(r) : "$=" === o ? e.substr(e.length - r.length) === r : "|=" === o ? e === r || e.substr(0, r.length + 1) === r + "-" : !1 : e && !1 !== f
        }, POS: function (n, t, i, r) {
            var f = u.setFilters[t[2]];
            if (f)return f(n, i, t, r)
        }}}, nt = u.match.POS, it = function (n, t) {
            return"\\" + (+t + 1)
        };
        for (var l in u.match)u.match[l] = new RegExp(u.match[l].source + /(?![^\[]*\])(?![^\(]*\))/.source), u.leftMatch[l] = new RegExp(/(^(?:.|\r|\n)*?)/.source + u.match[l].source.replace(/\\(\d+)/g, it));
        u.match.globalPOS = nt;
        f = function (n, t) {
            return n = Array.prototype.slice.call(n, 0), t ? (t.push.apply(t, n), t) : n
        };
        try {
            Array.prototype.slice.call(r.documentElement.childNodes, 0)[0].nodeType
        } catch (rt) {
            f = function (n, t) {
                var i = 0, r = t || [], u;
                if ("[object Array]" === d.call(n))Array.prototype.push.apply(r, n); else if ("number" == typeof n.length)for (u = n.length; i < u; i++)r.push(n[i]); else for (; n[i]; i++)r.push(n[i]);
                return r
            }
        }
        r.documentElement.compareDocumentPosition ? a = function (n, t) {
            return n === t ? (h = !0, 0) : n.compareDocumentPosition && t.compareDocumentPosition ? n.compareDocumentPosition(t) & 4 ? -1 : 1 : n.compareDocumentPosition ? -1 : 1
        } : (a = function (n, t) {
            var r, u, f, e, i;
            if (n === t)return h = !0, 0;
            if (n.sourceIndex && t.sourceIndex)return n.sourceIndex - t.sourceIndex;
            if (f = [], e = [], r = n.parentNode, u = t.parentNode, i = r, r === u)return s(n, t);
            if (!r)return-1;
            if (!u)return 1;
            for (; i;)f.unshift(i), i = i.parentNode;
            for (i = u; i;)e.unshift(i), i = i.parentNode;
            for (r = f.length, u = e.length, i = 0; i < r && i < u; i++)if (f[i] !== e[i])return s(f[i], e[i]);
            return i === r ? s(n, e[i], -1) : s(f[i], t, 1)
        }, s = function (n, t, i) {
            if (n === t)return i;
            for (n = n.nextSibling; n;) {
                if (n === t)return-1;
                n = n.nextSibling
            }
            return 1
        }), function () {
            var n = r.createElement("div"), f = "script" + (new Date).getTime(), i = r.documentElement;
            n.innerHTML = "<a name='" + f + "'/>";
            i.insertBefore(n, i.firstChild);
            r.getElementById(f) && (u.find.ID = function (n, i, r) {
                if ("undefined" != typeof i.getElementById && !r)return(i = i.getElementById(n[1])) ? i.id === n[1] || "undefined" != typeof i.getAttributeNode && i.getAttributeNode("id").nodeValue === n[1] ? [i] : t : []
            }, u.filter.ID = function (n, t) {
                var i = "undefined" != typeof n.getAttributeNode && n.getAttributeNode("id");
                return 1 === n.nodeType && i && i.nodeValue === t
            });
            i.removeChild(n);
            i = n = null
        }(), function () {
            var n = r.createElement("div");
            n.appendChild(r.createComment(""));
            0 < n.getElementsByTagName("*").length && (u.find.TAG = function (n, t) {
                var i = t.getElementsByTagName(n[1]), u, r;
                if ("*" === n[1]) {
                    for (u = [], r = 0; i[r]; r++)1 === i[r].nodeType && u.push(i[r]);
                    i = u
                }
                return i
            });
            n.innerHTML = "<a href='#'><\/a>";
            n.firstChild && "undefined" != typeof n.firstChild.getAttribute && "#" !== n.firstChild.getAttribute("href") && (u.attrHandle.href = function (n) {
                return n.getAttribute("href", 2)
            });
            n = null
        }();
        r.querySelectorAll && function () {
            var i = n, t = r.createElement("div"), e;
            if (t.innerHTML = "<p class='TEST'><\/p>", !t.querySelectorAll || 0 !== t.querySelectorAll(".TEST").length) {
                n = function (t, e, o, s) {
                    var h, c;
                    if (e = e || r, !s && !n.isXML(e)) {
                        if (h = /^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(t), h && (1 === e.nodeType || 9 === e.nodeType)) {
                            if (h[1])return f(e.getElementsByTagName(t), o);
                            if (h[2] && u.find.CLASS && e.getElementsByClassName)return f(e.getElementsByClassName(h[2]), o)
                        }
                        if (9 === e.nodeType) {
                            if ("body" === t && e.body)return f([e.body], o);
                            if (h && h[3])if (c = e.getElementById(h[3]), c && c.parentNode) {
                                if (c.id === h[3])return f([c], o)
                            } else return f([], o);
                            try {
                                return f(e.querySelectorAll(t), o)
                            } catch (y) {
                            }
                        } else if (1 === e.nodeType && "object" !== e.nodeName.toLowerCase()) {
                            var h = e, l = (c = e.getAttribute("id")) || "__sizzle__", a = e.parentNode, v = /^\s*[+~]/.test(t);
                            c ? l = l.replace(/'/g, "\\$&") : e.setAttribute("id", l);
                            v && a && (e = e.parentNode);
                            try {
                                if (!v || a)return f(e.querySelectorAll("[id='" + l + "'] " + t), o)
                            } catch (p) {
                            } finally {
                                c || h.removeAttribute("id")
                            }
                        }
                    }
                    return i(t, e, o, s)
                };
                for (e in i)n[e] = i[e];
                t = null
            }
        }(), function () {
            var t = r.documentElement, i = t.matchesSelector || t.mozMatchesSelector || t.webkitMatchesSelector || t.msMatchesSelector, e, f;
            if (i) {
                e = !i.call(r.createElement("div"), "div");
                f = !1;
                try {
                    i.call(r.documentElement, "[test!='']:sizzle")
                } catch (o) {
                    f = !0
                }
                n.matchesSelector = function (t, r) {
                    if (r = r.replace(/\=\s*([^'"\]]*)\s*\]/g, "='$1']"), !n.isXML(t))try {
                        if (f || !u.match.PSEUDO.test(r) && !/!=/.test(r)) {
                            var o = i.call(t, r);
                            if (o || !e || t.document && 11 !== t.document.nodeType)return o
                        }
                    } catch (s) {
                    }
                    return 0 < n(r, null, null, [t]).length
                }
            }
        }(), function () {
            var n = r.createElement("div");
            n.innerHTML = "<div class='test e'><\/div><div class='test'><\/div>";
            n.getElementsByClassName && 0 !== n.getElementsByClassName("e").length && (n.lastChild.className = "e", 1 !== n.getElementsByClassName("e").length && (u.order.splice(1, 0, "CLASS"), u.find.CLASS = function (n, t, i) {
                if ("undefined" != typeof t.getElementsByClassName && !i)return t.getElementsByClassName(n[1])
            }, n = null))
        }();
        n.contains = r.documentElement.contains ? function (n, t) {
            return n !== t && (n.contains ? n.contains(t) : !0)
        } : r.documentElement.compareDocumentPosition ? function (n, t) {
            return!!(n.compareDocumentPosition(t) & 16)
        } : function () {
            return!1
        };
        n.isXML = function (n) {
            return(n = (n ? n.ownerDocument || n : 0).documentElement) ? "HTML" !== n.nodeName : !1
        };
        w = function (t, i, r) {
            var f, e = [], o = "", s;
            for (i = i.nodeType ? [i] : i; f = u.match.PSEUDO.exec(t);)o += f[0], t = t.replace(u.match.PSEUDO, "");
            for (t = u.relative[t] ? t + "*" : t, f = 0, s = i.length; f < s; f++)n(t, i[f], e, r);
            return n.filter(o, e)
        };
        n.attr = i.attr;
        n.selectors.attrMap = {};
        i.find = n;
        i.expr = n.selectors;
        i.expr[":"] = i.expr.filters;
        i.unique = n.uniqueSort;
        i.text = n.getText;
        i.isXMLDoc = n.isXML;
        i.contains = n.contains
    }();
    var au = /Until$/, vu = /^(?:parents|prevUntil|prevAll)/, yu = /,/, pu = /^.[^:#\[\.,]*$/, wu = Array.prototype.slice, gi = i.expr.match.globalPOS, bu = {children: !0, contents: !0, next: !0, prev: !0};
    i.fn.extend({find: function (n) {
        var s = this, t, f, r, o, u, e;
        if ("string" != typeof n)return i(n).filter(function () {
            for (t = 0, f = s.length; t < f; t++)if (i.contains(s[t], this))return!0
        });
        for (r = this.pushStack("", "find", n), t = 0, f = this.length; t < f; t++)if (o = r.length, i.find(n, this[t], r), 0 < t)for (u = o; u < r.length; u++)for (e = 0; e < o; e++)if (r[e] === r[u]) {
            r.splice(u--, 1);
            break
        }
        return r
    }, has: function (n) {
        var t = i(n);
        return this.filter(function () {
            for (var n = 0, r = t.length; n < r; n++)if (i.contains(this, t[n]))return!0
        })
    }, not: function (n) {
        return this.pushStack(bt(this, n, !1), "not", n)
    }, filter: function (n) {
        return this.pushStack(bt(this, n, !0), "filter", n)
    }, is: function (n) {
        return!!n && ("string" == typeof n ? gi.test(n) ? 0 <= i(n, this.context).index(this[0]) : 0 < i.filter(n, this).length : 0 < this.filter(n).length)
    }, closest: function (n, t) {
        var f = [], u, e, r = this[0], o;
        if (i.isArray(n)) {
            for (e = 1; r && r.ownerDocument && r !== t;) {
                for (u = 0; u < n.length; u++)i(r).is(n[u]) && f.push({selector: n[u], elem: r, level: e});
                r = r.parentNode;
                e++
            }
            return f
        }
        for (o = gi.test(n) || "string" != typeof n ? i(n, t || this.context) : 0, u = 0, e = this.length; u < e; u++)for (r = this[u]; r;)if (o ? -1 < o.index(r) : i.find.matchesSelector(r, n)) {
            f.push(r);
            break
        } else if (r = r.parentNode, !r || !r.ownerDocument || r === t || 11 === r.nodeType)break;
        return f = 1 < f.length ? i.unique(f) : f, this.pushStack(f, "closest", n)
    }, index: function (n) {
        return n ? "string" == typeof n ? i.inArray(this[0], i(n)) : i.inArray(n.jquery ? n[0] : n, this) : this[0] && this[0].parentNode ? this.prevAll().length : -1
    }, add: function (n, t) {
        var u = "string" == typeof n ? i(n, t) : i.makeArray(n && n.nodeType ? [n] : n), r = i.merge(this.get(), u);
        return this.pushStack(wt(u[0]) || wt(r[0]) ? r : i.unique(r))
    }, andSelf: function () {
        return this.add(this.prevObject)
    }});
    i.each({parent: function (n) {
        return(n = n.parentNode) && 11 !== n.nodeType ? n : null
    }, parents: function (n) {
        return i.dir(n, "parentNode")
    }, parentsUntil: function (n, t, r) {
        return i.dir(n, "parentNode", r)
    }, next: function (n) {
        return i.nth(n, 2, "nextSibling")
    }, prev: function (n) {
        return i.nth(n, 2, "previousSibling")
    }, nextAll: function (n) {
        return i.dir(n, "nextSibling")
    }, prevAll: function (n) {
        return i.dir(n, "previousSibling")
    }, nextUntil: function (n, t, r) {
        return i.dir(n, "nextSibling", r)
    }, prevUntil: function (n, t, r) {
        return i.dir(n, "previousSibling", r)
    }, siblings: function (n) {
        return i.sibling((n.parentNode || {}).firstChild, n)
    }, children: function (n) {
        return i.sibling(n.firstChild)
    }, contents: function (n) {
        return i.nodeName(n, "iframe") ? n.contentDocument || n.contentWindow.document : i.makeArray(n.childNodes)
    }}, function (n, t) {
        i.fn[n] = function (r, u) {
            var f = i.map(this, t, r);
            return au.test(n) || (u = r), u && "string" == typeof u && (f = i.filter(u, f)), f = 1 < this.length && !bu[n] ? i.unique(f) : f, (1 < this.length || yu.test(u)) && vu.test(n) && (f = f.reverse()), this.pushStack(f, n, wu.call(arguments).join(","))
        }
    });
    i.extend({filter: function (n, t, r) {
        return r && (n = ":not(" + n + ")"), 1 === t.length ? i.find.matchesSelector(t[0], n) ? [t[0]] : [] : i.find.matches(n, t)
    }, dir: function (n, r, u) {
        var f = [];
        for (n = n[r]; n && 9 !== n.nodeType && (u === t || 1 !== n.nodeType || !i(n).is(u));)1 === n.nodeType && f.push(n), n = n[r];
        return f
    }, nth: function (n, t, i, r) {
        for (t = t || 1, r = 0; n && (1 !== n.nodeType || ++r !== t); n = n[i]);
        return n
    }, sibling: function (n, t) {
        for (var i = []; n; n = n.nextSibling)1 === n.nodeType && n !== t && i.push(n);
        return i
    }});
    var nr = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video", ku = / jQuery\d+="(?:\d+|null)"/g, ot = /^\s+/, tr = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig, ir = /<([\w:]+)/, du = /<tbody/i, gu = /<|&#?\w+;/, nf = /<(?:script|style)/i, tf = /<(?:script|object|embed|option|style)/i, rr = new RegExp("<(?:" + nr + ")[\\s/>]", "i"), ur = /checked\s*(?:[^=]|=\s*.checked.)/i, fr = /\/(java|ecma)script/i, rf = /^\s*<!(?:\[CDATA\[|\-\-)/, u = {option: [1, "<select multiple='multiple'>", "<\/select>"], legend: [1, "<fieldset>", "<\/fieldset>"], thead: [1, "<table>", "<\/table>"], tr: [2, "<table><tbody>", "<\/tbody><\/table>"], td: [3, "<table><tbody><tr>", "<\/tr><\/tbody><\/table>"], col: [2, "<table><tbody><\/tbody><colgroup>", "<\/colgroup><\/table>"], area: [1, "<map>", "<\/map>"], _default: [0, "", ""]}, st = kt(r);
    u.optgroup = u.option;
    u.tbody = u.tfoot = u.colgroup = u.caption = u.thead;
    u.th = u.td;
    i.support.htmlSerialize || (u._default = [1, "div<div>", "<\/div>"]);
    i.fn.extend({text: function (n) {
        return i.access(this, function (n) {
            return n === t ? i.text(this) : this.empty().append((this[0] && this[0].ownerDocument || r).createTextNode(n))
        }, null, n, arguments.length)
    }, wrapAll: function (n) {
        if (i.isFunction(n))return this.each(function (t) {
            i(this).wrapAll(n.call(this, t))
        });
        if (this[0]) {
            var t = i(n, this[0].ownerDocument).eq(0).clone(!0);
            this[0].parentNode && t.insertBefore(this[0]);
            t.map(function () {
                for (var n = this; n.firstChild && 1 === n.firstChild.nodeType;)n = n.firstChild;
                return n
            }).append(this)
        }
        return this
    }, wrapInner: function (n) {
        return i.isFunction(n) ? this.each(function (t) {
            i(this).wrapInner(n.call(this, t))
        }) : this.each(function () {
            var t = i(this), r = t.contents();
            r.length ? r.wrapAll(n) : t.append(n)
        })
    }, wrap: function (n) {
        var t = i.isFunction(n);
        return this.each(function (r) {
            i(this).wrapAll(t ? n.call(this, r) : n)
        })
    }, unwrap: function () {
        return this.parent().each(function () {
            i.nodeName(this, "body") || i(this).replaceWith(this.childNodes)
        }).end()
    }, append: function () {
        return this.domManip(arguments, !0, function (n) {
            1 === this.nodeType && this.appendChild(n)
        })
    }, prepend: function () {
        return this.domManip(arguments, !0, function (n) {
            1 === this.nodeType && this.insertBefore(n, this.firstChild)
        })
    }, before: function () {
        if (this[0] && this[0].parentNode)return this.domManip(arguments, !1, function (n) {
            this.parentNode.insertBefore(n, this)
        });
        if (arguments.length) {
            var n = i.clean(arguments);
            return n.push.apply(n, this.toArray()), this.pushStack(n, "before", arguments)
        }
    }, after: function () {
        if (this[0] && this[0].parentNode)return this.domManip(arguments, !1, function (n) {
            this.parentNode.insertBefore(n, this.nextSibling)
        });
        if (arguments.length) {
            var n = this.pushStack(this, "after", arguments);
            return n.push.apply(n, i.clean(arguments)), n
        }
    }, remove: function (n, t) {
        for (var u = 0, r; null != (r = this[u]); u++)(!n || i.filter(n, [r]).length) && (t || 1 !== r.nodeType || (i.cleanData(r.getElementsByTagName("*")), i.cleanData([r])), r.parentNode && r.parentNode.removeChild(r));
        return this
    }, empty: function () {
        for (var t = 0, n; null != (n = this[t]); t++)for (1 === n.nodeType && i.cleanData(n.getElementsByTagName("*")); n.firstChild;)n.removeChild(n.firstChild);
        return this
    }, clone: function (n, t) {
        return n = null == n ? !1 : n, t = null == t ? n : t, this.map(function () {
            return i.clone(this, n, t)
        })
    }, html: function (n) {
        return i.access(this, function (n) {
            var r = this[0] || {}, f = 0, e = this.length;
            if (n === t)return 1 === r.nodeType ? r.innerHTML.replace(ku, "") : null;
            if (!("string" != typeof n || nf.test(n) || !i.support.leadingWhitespace && ot.test(n) || u[(ir.exec(n) || ["", ""])[1].toLowerCase()])) {
                n = n.replace(tr, "<$1><\/$2>");
                try {
                    for (; f < e; f++)r = this[f] || {}, 1 === r.nodeType && (i.cleanData(r.getElementsByTagName("*")), r.innerHTML = n);
                    r = 0
                } catch (o) {
                }
            }
            r && this.empty().append(n)
        }, null, n, arguments.length)
    }, replaceWith: function (n) {
        return this[0] && this[0].parentNode ? i.isFunction(n) ? this.each(function (t) {
            var r = i(this), u = r.html();
            r.replaceWith(n.call(this, t, u))
        }) : ("string" != typeof n && (n = i(n).detach()), this.each(function () {
            var t = this.nextSibling, r = this.parentNode;
            i(this).remove();
            t ? i(t).before(n) : i(r).append(n)
        })) : this.length ? this.pushStack(i(i.isFunction(n) ? n() : n), "replaceWith", n) : this
    }, detach: function (n) {
        return this.remove(n, !0)
    }, domManip: function (n, r, u) {
        var f, h, e, o = n[0], c = [];
        if (!i.support.checkClone && 3 === arguments.length && "string" == typeof o && ur.test(o))return this.each(function () {
            i(this).domManip(n, r, u, !0)
        });
        if (i.isFunction(o))return this.each(function (f) {
            var e = i(this);
            n[0] = o.call(this, f, r ? e.html() : t);
            e.domManip(n, r, u)
        });
        if (this[0]) {
            if (f = o && o.parentNode, f = i.support.parentNode && f && 11 === f.nodeType && f.childNodes.length === this.length ? {fragment: f} : i.buildFragment(n, this, c), e = f.fragment, h = 1 === e.childNodes.length ? e = e.firstChild : e.firstChild) {
                r = r && i.nodeName(h, "tr");
                for (var s = 0, l = this.length, a = l - 1; s < l; s++)u.call(r ? gr(this[s], h) : this[s], f.cacheable || 1 < l && s < a ? i.clone(e, !0, !0) : e)
            }
            c.length && i.each(c, function (n, t) {
                t.src ? i.ajax({type: "GET", global: !1, url: t.src, async: !1, dataType: "script"}) : i.globalEval((t.text || t.textContent || t.innerHTML || "").replace(rf, "/*$0*/"));
                t.parentNode && t.parentNode.removeChild(t)
            })
        }
        return this
    }});
    i.buildFragment = function (n, t, u) {
        var e, h, s, o, f = n[0];
        return t && t[0] && (o = t[0].ownerDocument || t[0]), o.createDocumentFragment || (o = r), 1 === n.length && "string" == typeof f && 512 > f.length && o === r && "<" === f.charAt(0) && !tf.test(f) && (i.support.checkClone || !ur.test(f)) && (i.support.html5Clone || !rr.test(f)) && (h = !0, (s = i.fragments[f]) && 1 !== s && (e = s)), e || (e = o.createDocumentFragment(), i.clean(n, o, e, u)), h && (i.fragments[f] = s ? e : 1), {fragment: e, cacheable: h}
    };
    i.fragments = {};
    i.each({appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith"}, function (n, t) {
        i.fn[n] = function (r) {
            var f = [], u, o, e;
            if (r = i(r), u = 1 === this.length && this[0].parentNode, u && 11 === u.nodeType && 1 === u.childNodes.length && 1 === r.length)return r[t](this[0]), this;
            for (u = 0, o = r.length; u < o; u++)e = (0 < u ? this.clone(!0) : this).get(), i(r[u])[t](e), f = f.concat(e);
            return this.pushStack(f, n, r.selector)
        }
    });
    i.extend({clone: function (n, t, u) {
        var f, s, e, o;
        if (i.support.html5Clone || i.isXMLDoc(n) || !rr.test("<" + n.nodeName + ">") ? f = n.cloneNode(!0) : (f = r.createElement("div"), st.appendChild(f), f.innerHTML = n.outerHTML, f = f.firstChild), o = f, !(i.support.noCloneEvent && i.support.noCloneChecked || 1 !== n.nodeType && 11 !== n.nodeType || i.isXMLDoc(n)))for (gt(n, o), f = b(n), s = b(o), e = 0; f[e]; ++e)s[e] && gt(f[e], s[e]);
        if (t && (dt(n, o), u))for (f = b(n), s = b(o), e = 0; f[e]; ++e)dt(f[e], s[e]);
        return o
    }, clean: function (n, t, f, e) {
        var h, l = [], a, o, p;
        for (t = t || r, "undefined" == typeof t.createElement && (t = t.ownerDocument || t[0] && t[0].ownerDocument || r), a = 0; null != (o = n[a]); a++)if ("number" == typeof o && (o += ""), o) {
            if ("string" == typeof o)if (gu.test(o)) {
                o = o.replace(tr, "<$1><\/$2>");
                h = (ir.exec(o) || ["", ""])[1].toLowerCase();
                var c = u[h] || u._default, v = c[0], s = t.createElement("div"), y = st.childNodes;
                for (t === r ? st.appendChild(s) : kt(t).appendChild(s), s.innerHTML = c[1] + o + c[2]; v--;)s = s.lastChild;
                if (!i.support.tbody)for (v = du.test(o), c = "table" !== h || v ? "<table>" !== c[1] || v ? [] : s.childNodes : s.firstChild && s.firstChild.childNodes, h = c.length - 1; 0 <= h; --h)i.nodeName(c[h], "tbody") && !c[h].childNodes.length && c[h].parentNode.removeChild(c[h]);
                !i.support.leadingWhitespace && ot.test(o) && s.insertBefore(t.createTextNode(ot.exec(o)[0]), s.firstChild);
                o = s.childNodes;
                s && (s.parentNode.removeChild(s), 0 < y.length && (s = y[y.length - 1]) && s.parentNode && s.parentNode.removeChild(s))
            } else o = t.createTextNode(o);
            if (!i.support.appendChecked)if (o[0] && "number" == typeof(p = o.length))for (h = 0; h < p; h++)ti(o[h]); else ti(o);
            o.nodeType ? l.push(o) : l = i.merge(l, o)
        }
        if (f)for (n = function (n) {
            return!n.type || fr.test(n.type)
        }, a = 0; l[a]; a++)t = l[a], e && i.nodeName(t, "script") && (!t.type || fr.test(t.type)) ? e.push(t.parentNode ? t.parentNode.removeChild(t) : t) : (1 === t.nodeType && (o = i.grep(t.getElementsByTagName("script"), n), l.splice.apply(l, [a + 1, 0].concat(o))), f.appendChild(t));
        return l
    }, cleanData: function (n) {
        for (var u, r, f, e = i.cache, s = i.event.special, h = i.support.deleteExpando, o = 0, t; null != (t = n[o]); o++)if ((!t.nodeName || !i.noData[t.nodeName.toLowerCase()]) && (f = t[i.expando])) {
            if ((r = e[f]) && r.events) {
                for (u in r.events)s[u] ? i.event.remove(t, u) : i.removeEvent(t, u, r.handle);
                r.handle && (r.handle.elem = null)
            }
            h ? delete t[i.expando] : t.removeAttribute && t.removeAttribute(i.expando);
            delete e[f]
        }
    }});
    var ht = /alpha\([^)]*\)/i, uf = /opacity=([^)]*)/, ff = /([A-Z]|^ms)/g, ef = /^[\-+]?(?:\d*\.)?\d+$/i, ct = /^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i, of = /^([\-+])=([\-+.\de]+)/, sf = /^margin/, hf = {position: "absolute", visibility: "hidden", display: "block"}, o = ["Top", "Right", "Bottom", "Left"], a, er, or;
    i.fn.css = function (n, r) {
        return i.access(this, function (n, r, u) {
            return u !== t ? i.style(n, r, u) : i.css(n, r)
        }, n, r, 1 < arguments.length)
    };
    i.extend({cssHooks: {opacity: {get: function (n, t) {
        if (t) {
            var i = a(n, "opacity");
            return"" === i ? "1" : i
        }
        return n.style.opacity
    }}}, cssNumber: {fillOpacity: !0, fontWeight: !0, lineHeight: !0, opacity: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0}, cssProps: {float: i.support.cssFloat ? "cssFloat" : "styleFloat"}, style: function (n, r, u, f) {
        if (n && 3 !== n.nodeType && 8 !== n.nodeType && n.style) {
            var o, s = i.camelCase(r), h = n.style, e = i.cssHooks[s];
            if (r = i.cssProps[s] || s, u !== t) {
                if (f = typeof u, "string" === f && (o = of.exec(u)) && (u = +(o[1] + 1) * +o[2] + parseFloat(i.css(n, r)), f = "number"), !(null == u || "number" === f && isNaN(u) || ("number" !== f || i.cssNumber[s] || (u += "px"), e && "set"in e && (u = e.set(n, u)) === t)))try {
                    h[r] = u
                } catch (c) {
                }
            } else return e && "get"in e && (o = e.get(n, !1, f)) !== t ? o : h[r]
        }
    }, css: function (n, r, u) {
        var e, f;
        return(r = i.camelCase(r), f = i.cssHooks[r], r = i.cssProps[r] || r, "cssFloat" === r && (r = "float"), f && "get"in f && (e = f.get(n, !0, u)) !== t) ? e : a ? a(n, r) : void 0
    }, swap: function (n, t, i) {
        var u = {};
        for (var r in t)u[r] = n.style[r], n.style[r] = t[r];
        i = i.call(n);
        for (r in t)n.style[r] = u[r];
        return i
    }});
    i.curCSS = i.css;
    r.defaultView && r.defaultView.getComputedStyle && (er = function (n, t) {
        var r, u, f, e = n.style;
        return t = t.replace(ff, "-$1").toLowerCase(), (u = n.ownerDocument.defaultView) && (f = u.getComputedStyle(n, null)) && (r = f.getPropertyValue(t), "" !== r || i.contains(n.ownerDocument.documentElement, n) || (r = i.style(n, t))), !i.support.pixelMargin && f && sf.test(t) && ct.test(r) && (u = e.width, e.width = r, r = f.width, e.width = u), r
    });
    r.documentElement.currentStyle && (or = function (n, t) {
        var u, f, i = n.currentStyle && n.currentStyle[t], r = n.style;
        return null == i && r && (u = r[t]) && (i = u), ct.test(i) && (u = r.left, (f = n.runtimeStyle && n.runtimeStyle.left) && (n.runtimeStyle.left = n.currentStyle.left), r.left = "fontSize" === t ? "1em" : i, i = r.pixelLeft + "px", r.left = u, f && (n.runtimeStyle.left = f)), "" === i ? "auto" : i
    });
    a = er || or;
    i.each(["height", "width"], function (n, t) {
        i.cssHooks[t] = {get: function (n, r, u) {
            if (r)return 0 !== n.offsetWidth ? ii(n, t, u) : i.swap(n, hf, function () {
                return ii(n, t, u)
            })
        }, set: function (n, t) {
            return ef.test(t) ? t + "px" : t
        }}
    });
    i.support.opacity || (i.cssHooks.opacity = {get: function (n, t) {
        return uf.test((t && n.currentStyle ? n.currentStyle.filter : n.style.filter) || "") ? parseFloat(RegExp.$1) / 100 + "" : t ? "1" : ""
    }, set: function (n, t) {
        var r = n.style, u = n.currentStyle, e = i.isNumeric(t) ? "alpha(opacity=" + 100 * t + ")" : "", f = u && u.filter || r.filter || "";
        (r.zoom = 1, 1 <= t && "" === i.trim(f.replace(ht, "")) && (r.removeAttribute("filter"), u && !u.filter)) || (r.filter = ht.test(f) ? f.replace(ht, e) : f + " " + e)
    }});
    i(function () {
        i.support.reliableMarginRight || (i.cssHooks.marginRight = {get: function (n, t) {
            return i.swap(n, {display: "inline-block"}, function () {
                return t ? a(n, "margin-right") : n.style.marginRight
            })
        }})
    });
    i.expr && i.expr.filters && (i.expr.filters.hidden = function (n) {
        var t = n.offsetHeight;
        return 0 === n.offsetWidth && 0 === t || !i.support.reliableHiddenOffsets && "none" === (n.style && n.style.display || i.css(n, "display"))
    }, i.expr.filters.visible = function (n) {
        return!i.expr.filters.hidden(n)
    });
    i.each({margin: "", padding: "", border: "Width"}, function (n, t) {
        i.cssHooks[n + t] = {expand: function (i) {
            var r = "string" == typeof i ? i.split(" ") : [i], u = {};
            for (i = 0; 4 > i; i++)u[n + o[i] + t] = r[i] || r[i - 2] || r[0];
            return u
        }}
    });
    var cf = /%20/g, lf = /\[\]$/, sr = /\r?\n/g, af = /#.*$/, vf = /^(.*?):[ \t]*([^\r\n]*)\r?$/mg, yf = /^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i, pf = /^(?:GET|HEAD)$/, wf = /^\/\//, hr = /\?/, bf = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, kf = /^(?:select|textarea)/i, cr = /\s+/, df = /([?&])_=[^&]*/, lr = /^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/, ar = i.fn.load, lt = {}, vr = {}, s, h, yr = ["*/"] + ["*"];
    try {
        s = iu.href
    } catch (te) {
        s = r.createElement("a");
        s.href = "";
        s = s.href
    }
    h = lr.exec(s.toLowerCase()) || [];
    i.fn.extend({load: function (n, r, u) {
        var f, e, o;
        return"string" != typeof n && ar ? ar.apply(this, arguments) : this.length ? (f = n.indexOf(" "), 0 <= f && (e = n.slice(f, n.length), n = n.slice(0, f)), f = "GET", r && (i.isFunction(r) ? (u = r, r = t) : "object" == typeof r && (r = i.param(r, i.ajaxSettings.traditional), f = "POST")), o = this, i.ajax({url: n, type: f, dataType: "html", data: r, complete: function (n, t, r) {
            r = n.responseText;
            n.isResolved() && (n.done(function (n) {
                r = n
            }), o.html(e ? i("<div>").append(r.replace(bf, "")).find(e) : r));
            u && o.each(u, [r, t, n])
        }}), this) : this
    }, serialize: function () {
        return i.param(this.serializeArray())
    }, serializeArray: function () {
        return this.map(function () {
            return this.elements ? i.makeArray(this.elements) : this
        }).filter(function () {
            return this.name && !this.disabled && (this.checked || kf.test(this.nodeName) || yf.test(this.type))
        }).map(function (n, t) {
            var r = i(this).val();
            return null == r ? null : i.isArray(r) ? i.map(r, function (n) {
                return{name: t.name, value: n.replace(sr, "\r\n")}
            }) : {name: t.name, value: r.replace(sr, "\r\n")}
        }).get()
    }});
    i.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "), function (n, t) {
        i.fn[t] = function (n) {
            return this.on(t, n)
        }
    });
    i.each(["get", "post"], function (n, r) {
        i[r] = function (n, u, f, e) {
            return i.isFunction(u) && (e = e || f, f = u, u = t), i.ajax({type: r, url: n, data: u, success: f, dataType: e})
        }
    });
    i.extend({getScript: function (n, r) {
        return i.get(n, t, r, "script")
    }, getJSON: function (n, t, r) {
        return i.get(n, t, r, "json")
    }, ajaxSetup: function (n, t) {
        return t ? ui(n, i.ajaxSettings) : (t = n, n = i.ajaxSettings), ui(n, t), n
    }, ajaxSettings: {url: s, isLocal: /^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(h[1]), global: !0, type: "GET", contentType: "application/x-www-form-urlencoded; charset=UTF-8", processData: !0, async: !0, accepts: {xml: "application/xml, text/xml", html: "text/html", text: "text/plain", json: "application/json, text/javascript", "*": yr}, contents: {xml: /xml/, html: /html/, json: /json/}, responseFields: {xml: "responseXML", text: "responseText"}, converters: {"* text": n.String, "text html": !0, "text json": i.parseJSON, "text xml": i.parseXML}, flatOptions: {context: !0, url: !0}}, ajaxPrefilter: ri(lt), ajaxTransport: ri(vr), ajax: function (n, r) {
        function y(n, r, s, h) {
            var ot, yt, ct, lt, ht, at, gt, vt, k, ft, bt, rt, ut, et;
            if (2 !== e) {
                if (e = 2, nt && clearTimeout(nt), a = t, g = h || "", f.readyState = 0 < n ? 4 : 0, h = r, s) {
                    var st = u, kt = f, pt = st.contents, w = st.dataTypes, dt = st.responseFields, y, l, tt, wt;
                    for (l in dt)l in s && (kt[dt[l]] = s[l]);
                    for (; "*" === w[0];)w.shift(), y === t && (y = st.mimeType || kt.getResponseHeader("content-type"));
                    if (y)for (l in pt)if (pt[l] && pt[l].test(y)) {
                        w.unshift(l);
                        break
                    }
                    if (w[0]in s)tt = w[0]; else {
                        for (l in s) {
                            if (!w[0] || st.converters[l + " " + w[0]]) {
                                tt = l;
                                break
                            }
                            wt || (wt = l)
                        }
                        tt = tt || wt
                    }
                    tt ? (tt !== w[0] && w.unshift(tt), s = s[tt]) : s = void 0
                } else s = t;
                if (200 <= n && 300 > n || 304 === n)if (u.ifModified && ((y = f.getResponseHeader("Last-Modified")) && (i.lastModified[o] = y), (y = f.getResponseHeader("Etag")) && (i.etag[o] = y)), 304 === n)h = "notmodified", ot = !0; else try {
                    for (y = u, y.dataFilter && (s = y.dataFilter(s, y.dataType)), lt = y.dataTypes, l = {}, gt = lt.length, k = lt[0], ht = 1; ht < gt; ht++) {
                        if (1 === ht)for (at in y.converters)"string" == typeof at && (l[at.toLowerCase()] = y.converters[at]);
                        if (ft = k, k = lt[ht], "*" === k)k = ft; else if ("*" !== ft && ft !== k) {
                            if (bt = ft + " " + k, rt = l[bt] || l["* " + k], !rt)for (ut in et = t, l)if ((vt = ut.split(" "), vt[0] === ft || "*" === vt[0]) && (et = l[vt[1] + " " + k])) {
                                ut = l[ut];
                                !0 === ut ? rt = et : !0 === et && (rt = ut);
                                break
                            }
                            rt || et || i.error("No conversion from " + bt.replace(" ", " to "));
                            !0 !== rt && (s = rt ? rt(s) : et(ut(s)))
                        }
                    }
                    yt = s;
                    h = "success";
                    ot = !0
                } catch (ni) {
                    h = "parsererror";
                    ct = ni
                } else(ct = h, !h || n) && (h = "error", 0 > n && (n = 0));
                f.status = n;
                f.statusText = "" + (r || h);
                ot ? d.resolveWith(c, [yt, h, f]) : d.rejectWith(c, [f, h, ct]);
                f.statusCode(p);
                p = t;
                v && b.trigger("ajax" + (ot ? "Success" : "Error"), [f, u, ot ? yt : ct]);
                it.fireWith(c, [f, h]);
                v && (b.trigger("ajaxComplete", [f, u]), --i.active || i.event.trigger("ajaxStop"))
            }
        }

        var tt;
        "object" == typeof n && (r = n, n = t);
        r = r || {};
        var u = i.ajaxSetup({}, r), c = u.context || u, b = c !== u && (c.nodeType || c instanceof i) ? i(c) : i.event, d = i.Deferred(), it = i.Callbacks("once memory"), p = u.statusCode || {}, o, rt = {}, ut = {}, g, w, a, nt, s, e = 0, v, l, f = {readyState: 0, setRequestHeader: function (n, t) {
            if (!e) {
                var i = n.toLowerCase();
                n = ut[i] = ut[i] || n;
                rt[n] = t
            }
            return this
        }, getAllResponseHeaders: function () {
            return 2 === e ? g : null
        }, getResponseHeader: function (n) {
            var i;
            if (2 === e) {
                if (!w)for (w = {}; i = vf.exec(g);)w[i[1].toLowerCase()] = i[2];
                i = w[n.toLowerCase()]
            }
            return i === t ? null : i
        }, overrideMimeType: function (n) {
            return e || (u.mimeType = n), this
        }, abort: function (n) {
            return n = n || "abort", a && a.abort(n), y(0, n), this
        }};
        if (d.promise(f), f.success = f.done, f.error = f.fail, f.complete = it.add, f.statusCode = function (n) {
            if (n) {
                var t;
                if (2 > e)for (t in n)p[t] = [p[t], n[t]]; else t = n[f.status], f.then(t, t)
            }
            return this
        }, u.url = ((n || u.url) + "").replace(af, "").replace(wf, h[1] + "//"), u.dataTypes = i.trim(u.dataType || "*").toLowerCase().split(cr), null == u.crossDomain && (s = lr.exec(u.url.toLowerCase()), u.crossDomain = !(!s || s[1] == h[1] && s[2] == h[2] && (s[3] || ("http:" === s[1] ? 80 : 443)) == (h[3] || ("http:" === h[1] ? 80 : 443)))), u.data && u.processData && "string" != typeof u.data && (u.data = i.param(u.data, u.traditional)), k(lt, u, r, f), 2 === e)return!1;
        v = u.global;
        u.type = u.type.toUpperCase();
        u.hasContent = !pf.test(u.type);
        v && 0 == i.active++ && i.event.trigger("ajaxStart");
        u.hasContent || (u.data && (u.url += (hr.test(u.url) ? "&" : "?") + u.data, delete u.data), o = u.url, !1 !== u.cache) || (s = i.now(), tt = u.url.replace(df, "$1_=" + s), u.url = tt + (tt === u.url ? (hr.test(u.url) ? "&" : "?") + "_=" + s : ""));
        (u.data && u.hasContent && !1 !== u.contentType || r.contentType) && f.setRequestHeader("Content-Type", u.contentType);
        u.ifModified && (o = o || u.url, i.lastModified[o] && f.setRequestHeader("If-Modified-Since", i.lastModified[o]), i.etag[o] && f.setRequestHeader("If-None-Match", i.etag[o]));
        f.setRequestHeader("Accept", u.dataTypes[0] && u.accepts[u.dataTypes[0]] ? u.accepts[u.dataTypes[0]] + ("*" !== u.dataTypes[0] ? ", " + yr + "; q=0.01" : "") : u.accepts["*"]);
        for (l in u.headers)f.setRequestHeader(l, u.headers[l]);
        if (u.beforeSend && (!1 === u.beforeSend.call(c, f, u) || 2 === e))return f.abort(), !1;
        for (l in{success: 1, error: 1, complete: 1})f[l](u[l]);
        if (a = k(vr, u, r, f)) {
            f.readyState = 1;
            v && b.trigger("ajaxSend", [f, u]);
            u.async && 0 < u.timeout && (nt = setTimeout(function () {
                f.abort("timeout")
            }, u.timeout));
            try {
                e = 1;
                a.send(rt, y)
            } catch (ft) {
                if (2 > e)y(-1, ft); else throw ft;
            }
        } else y(-1, "No Transport");
        return f
    }, param: function (n, r) {
        var u = [], e = function (n, t) {
            t = i.isFunction(t) ? t() : t;
            u[u.length] = encodeURIComponent(n) + "=" + encodeURIComponent(t)
        }, f;
        if (r === t && (r = i.ajaxSettings.traditional), i.isArray(n) || n.jquery && !i.isPlainObject(n))i.each(n, function () {
            e(this.name, this.value)
        }); else for (f in n)ft(f, n[f], r, e);
        return u.join("&").replace(cf, "+")
    }});
    i.extend({active: 0, lastModified: {}, etag: {}});
    pr = i.now();
    p = /(\=)\?(&|$)|\?\?/i;
    i.ajaxSetup({jsonp: "callback", jsonpCallback: function () {
        return i.expando + "_" + pr++
    }});
    i.ajaxPrefilter("json jsonp", function (t, r, u) {
        if (r = "string" == typeof t.data && /^application\/x\-www\-form\-urlencoded/.test(t.contentType), "jsonp" === t.dataTypes[0] || !1 !== t.jsonp && (p.test(t.url) || r && p.test(t.data))) {
            var o, f = t.jsonpCallback = i.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, h = n[f], e = t.url, s = t.data, c = "$1" + f + "$2";
            return!1 !== t.jsonp && (e = e.replace(p, c), t.url === e && (r && (s = s.replace(p, c)), t.data === s && (e += (/\?/.test(e) ? "&" : "?") + t.jsonp + "=" + f))), t.url = e, t.data = s, n[f] = function (n) {
                o = [n]
            }, u.always(function () {
                n[f] = h;
                o && i.isFunction(h) && n[f](o[0])
            }), t.converters["script json"] = function () {
                return o || i.error(f + " was not called"), o[0]
            }, t.dataTypes[0] = "json", "script"
        }
    });
    i.ajaxSetup({accepts: {script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}, contents: {script: /javascript|ecmascript/}, converters: {"text script": function (n) {
        return i.globalEval(n), n
    }}});
    i.ajaxPrefilter("script", function (n) {
        n.cache === t && (n.cache = !1);
        n.crossDomain && (n.type = "GET", n.global = !1)
    });
    i.ajaxTransport("script", function (n) {
        if (n.crossDomain) {
            var i, u = r.head || r.getElementsByTagName("head")[0] || r.documentElement;
            return{send: function (f, e) {
                i = r.createElement("script");
                i.async = "async";
                n.scriptCharset && (i.charset = n.scriptCharset);
                i.src = n.url;
                i.onload = i.onreadystatechange = function (n, r) {
                    (r || !i.readyState || /loaded|complete/.test(i.readyState)) && (i.onload = i.onreadystatechange = null, u && i.parentNode && u.removeChild(i), i = t, r || e(200, "success"))
                };
                u.insertBefore(i, u.firstChild)
            }, abort: function () {
                if (i)i.onload(0, 1)
            }}
        }
    });
    nt = n.ActiveXObject ? function () {
        for (var n in v)v[n](0, 1)
    } : !1;
    wr = 0;
    i.ajaxSettings.xhr = n.ActiveXObject ? function () {
        var t;
        if (!(t = !this.isLocal && fi()))n:{
            try {
                t = new n.ActiveXObject("Microsoft.XMLHTTP");
                break n
            } catch (i) {
            }
            t = void 0
        }
        return t
    } : fi, function (n) {
        i.extend(i.support, {ajax: !!n, cors: !!n && "withCredentials"in n})
    }(i.ajaxSettings.xhr());
    i.support.ajax && i.ajaxTransport(function (r) {
        if (!r.crossDomain || i.support.cors) {
            var u;
            return{send: function (f, e) {
                var o = r.xhr(), h, s;
                if (r.username ? o.open(r.type, r.url, r.async, r.username, r.password) : o.open(r.type, r.url, r.async), r.xhrFields)for (s in r.xhrFields)o[s] = r.xhrFields[s];
                r.mimeType && o.overrideMimeType && o.overrideMimeType(r.mimeType);
                r.crossDomain || f["X-Requested-With"] || (f["X-Requested-With"] = "XMLHttpRequest");
                try {
                    for (s in f)o.setRequestHeader(s, f[s])
                } catch (c) {
                }
                o.send(r.hasContent && r.data || null);
                u = function (n, f) {
                    var s, l, y, c, a;
                    try {
                        if (u && (f || 4 === o.readyState))if (u = t, h && (o.onreadystatechange = i.noop, nt && delete v[h]), f)4 !== o.readyState && o.abort(); else {
                            s = o.status;
                            y = o.getAllResponseHeaders();
                            c = {};
                            (a = o.responseXML) && a.documentElement && (c.xml = a);
                            try {
                                c.text = o.responseText
                            } catch (w) {
                            }
                            try {
                                l = o.statusText
                            } catch (b) {
                                l = ""
                            }
                            s || !r.isLocal || r.crossDomain ? 1223 === s && (s = 204) : s = c.text ? 200 : 404
                        }
                    } catch (p) {
                        f || e(-1, p)
                    }
                    c && e(s, l, c, y)
                };
                r.async && 4 !== o.readyState ? (h = ++wr, nt && (v || (v = {}, i(n).unload(nt)), v[h] = u), o.onreadystatechange = u) : u()
            }, abort: function () {
                u && u(0, 1)
            }}
        }
    });
    var at = {}, f, y, gf = /^(?:toggle|show|hide)$/, ne = /^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i, tt, it = [
        ["height", "marginTop", "marginBottom", "paddingTop", "paddingBottom"],
        ["width", "marginLeft", "marginRight", "paddingLeft", "paddingRight"],
        ["opacity"]
    ], rt;
    i.fn.extend({show: function (n, t, r) {
        if (n || 0 === n)return this.animate(l("show", 3), n, t, r);
        r = 0;
        for (var u = this.length; r < u; r++)n = this[r], n.style && (t = n.style.display, i._data(n, "olddisplay") || "none" !== t || (t = n.style.display = ""), ("" === t && "none" === i.css(n, "display") || !i.contains(n.ownerDocument.documentElement, n)) && i._data(n, "olddisplay", oi(n.nodeName)));
        for (r = 0; r < u; r++)(n = this[r], n.style && (t = n.style.display, "" === t || "none" === t)) && (n.style.display = i._data(n, "olddisplay") || "");
        return this
    }, hide: function (n, t, r) {
        if (n || 0 === n)return this.animate(l("hide", 3), n, t, r);
        r = 0;
        for (var u = this.length; r < u; r++)n = this[r], n.style && (t = i.css(n, "display"), "none" === t || i._data(n, "olddisplay") || i._data(n, "olddisplay", t));
        for (r = 0; r < u; r++)this[r].style && (this[r].style.display = "none");
        return this
    }, _toggle: i.fn.toggle, toggle: function (n, t, r) {
        var u = "boolean" == typeof n;
        return i.isFunction(n) && i.isFunction(t) ? this._toggle.apply(this, arguments) : null == n || u ? this.each(function () {
            var t = u ? n : i(this).is(":hidden");
            i(this)[t ? "show" : "hide"]()
        }) : this.animate(l("toggle", 3), n, t, r), this
    }, fadeTo: function (n, t, i, r) {
        return this.filter(":hidden").css("opacity", 0).show().end().animate({opacity: t}, n, i, r)
    }, animate: function (n, t, r, u) {
        function e() {
            !1 === f.queue && i._mark(this);
            var e = i.extend({}, f), o = 1 === this.nodeType, c = o && i(this).is(":hidden"), t, r, u, s, h;
            e.animatedProperties = {};
            for (u in n)if (t = i.camelCase(u), u !== t && (n[t] = n[u], delete n[u]), (r = i.cssHooks[t]) && "expand"in r)for (u in s = r.expand(n[t]), delete n[t], s)u in n || (n[u] = s[u]);
            for (t in n) {
                if (r = n[t], i.isArray(r) ? (e.animatedProperties[t] = r[1], r = n[t] = r[0]) : e.animatedProperties[t] = e.specialEasing && e.specialEasing[t] || e.easing || "swing", "hide" === r && c || "show" === r && !c)return e.complete.call(this);
                o && ("height" === t || "width" === t) && (e.overflow = [this.style.overflow, this.style.overflowX, this.style.overflowY], "inline" === i.css(this, "display") && "none" === i.css(this, "float") && (i.support.inlineBlockNeedsLayout && "inline" !== oi(this.nodeName) ? this.style.zoom = 1 : this.style.display = "inline-block"))
            }
            null != e.overflow && (this.style.overflow = "hidden");
            for (u in n)(o = new i.fx(this, e, u), r = n[u], gf.test(r)) ? (t = i._data(this, "toggle" + u) || ("toggle" === r ? c ? "show" : "hide" : 0)) ? (i._data(this, "toggle" + u, "show" === t ? "hide" : "show"), o[t]()) : o[r]() : (t = ne.exec(r), s = o.cur(), t ? (r = parseFloat(t[2]), h = t[3] || (i.cssNumber[u] ? "" : "px"), "px" !== h && (i.style(this, u, (r || 1) + h), s *= (r || 1) / o.cur(), i.style(this, u, s + h)), t[1] && (r = ("-=" === t[1] ? -1 : 1) * r + s), o.custom(s, r, h)) : o.custom(s, r, ""));
            return!0
        }

        var f = i.speed(t, r, u);
        return i.isEmptyObject(n) ? this.each(f.complete, [!1]) : (n = i.extend({}, n), !1 === f.queue ? this.each(e) : this.queue(f.queue, e))
    }, stop: function (n, r, u) {
        return"string" != typeof n && (u = r, r = n, n = t), r && !1 !== n && this.queue(n || "fx", []), this.each(function () {
            var t, e = !1, f = i.timers, r = i._data(this), o;
            if (u || i._unmark(!0, this), null == n)for (t in r)r[t] && r[t].stop && t.indexOf(".run") === t.length - 4 && (o = r[t], i.removeData(this, t, !0), o.stop(u)); else r[t = n + ".run"] && r[t].stop && (r = r[t], i.removeData(this, t, !0), r.stop(u));
            for (t = f.length; t--;)f[t].elem === this && (null == n || f[t].queue === n) && (u ? f[t](!0) : f[t].saveState(), e = !0, f.splice(t, 1));
            u && e || i.dequeue(this, n)
        })
    }});
    i.each({slideDown: l("show", 1), slideUp: l("hide", 1), slideToggle: l("toggle", 1), fadeIn: {opacity: "show"}, fadeOut: {opacity: "hide"}, fadeToggle: {opacity: "toggle"}}, function (n, t) {
        i.fn[n] = function (n, i, r) {
            return this.animate(t, n, i, r)
        }
    });
    i.extend({speed: function (n, t, r) {
        var u = n && "object" == typeof n ? i.extend({}, n) : {complete: r || !r && t || i.isFunction(n) && n, duration: n, easing: r && t || t && !i.isFunction(t) && t};
        return u.duration = i.fx.off ? 0 : "number" == typeof u.duration ? u.duration : u.duration in i.fx.speeds ? i.fx.speeds[u.duration] : i.fx.speeds._default, (null == u.queue || !0 === u.queue) && (u.queue = "fx"), u.old = u.complete, u.complete = function (n) {
            i.isFunction(u.old) && u.old.call(this);
            u.queue ? i.dequeue(this, u.queue) : !1 !== n && i._unmark(this)
        }, u
    }, easing: {linear: function (n) {
        return n
    }, swing: function (n) {
        return-Math.cos(n * Math.PI) / 2 + .5
    }}, timers: [], fx: function (n, t, i) {
        this.options = t;
        this.elem = n;
        this.prop = i;
        t.orig = t.orig || {}
    }});
    i.fx.prototype = {update: function () {
        this.options.step && this.options.step.call(this.elem, this.now, this);
        (i.fx.step[this.prop] || i.fx.step._default)(this)
    }, cur: function () {
        if (null != this.elem[this.prop] && (!this.elem.style || null == this.elem.style[this.prop]))return this.elem[this.prop];
        var t, n = i.css(this.elem, this.prop);
        return isNaN(t = parseFloat(n)) ? n && "auto" !== n ? n : 0 : t
    }, custom: function (n, r, u) {
        function e(n) {
            return f.step(n)
        }

        var f = this, o = i.fx;
        this.startTime = rt || ei();
        this.end = r;
        this.now = this.start = n;
        this.pos = this.state = 0;
        this.unit = u || this.unit || (i.cssNumber[this.prop] ? "" : "px");
        e.queue = this.options.queue;
        e.elem = this.elem;
        e.saveState = function () {
            i._data(f.elem, "fxshow" + f.prop) === t && (f.options.hide ? i._data(f.elem, "fxshow" + f.prop, f.start) : f.options.show && i._data(f.elem, "fxshow" + f.prop, f.end))
        };
        e() && i.timers.push(e) && !tt && (tt = setInterval(o.tick, o.interval))
    }, show: function () {
        var n = i._data(this.elem, "fxshow" + this.prop);
        this.options.orig[this.prop] = n || i.style(this.elem, this.prop);
        this.options.show = !0;
        n !== t ? this.custom(this.cur(), n) : this.custom("width" === this.prop || "height" === this.prop ? 1 : 0, this.cur());
        i(this.elem).show()
    }, hide: function () {
        this.options.orig[this.prop] = i._data(this.elem, "fxshow" + this.prop) || i.style(this.elem, this.prop);
        this.options.hide = !0;
        this.custom(this.cur(), 0)
    }, step: function (n) {
        var r, f = rt || ei(), e = !0, u = this.elem, t = this.options;
        if (n || f >= t.duration + this.startTime) {
            this.now = this.end;
            this.pos = this.state = 1;
            this.update();
            t.animatedProperties[this.prop] = !0;
            for (r in t.animatedProperties)!0 !== t.animatedProperties[r] && (e = !1);
            if (e) {
                if (null == t.overflow || i.support.shrinkWrapBlocks || i.each(["", "X", "Y"], function (n, i) {
                    u.style["overflow" + i] = t.overflow[n]
                }), t.hide && i(u).hide(), t.hide || t.show)for (r in t.animatedProperties)i.style(u, r, t.orig[r]), i.removeData(u, "fxshow" + r, !0), i.removeData(u, "toggle" + r, !0);
                (n = t.complete) && (t.complete = !1, n.call(u))
            }
            return!1
        }
        return Infinity == t.duration ? this.now = f : (n = f - this.startTime, this.state = n / t.duration, this.pos = i.easing[t.animatedProperties[this.prop]](this.state, n, 0, 1, t.duration), this.now = this.start + (this.end - this.start) * this.pos), this.update(), !0
    }};
    i.extend(i.fx, {tick: function () {
        for (var r, n = i.timers, t = 0; t < n.length; t++)r = n[t], r() || n[t] !== r || n.splice(t--, 1);
        n.length || i.fx.stop()
    }, interval: 13, stop: function () {
        clearInterval(tt);
        tt = null
    }, speeds: {slow: 600, fast: 200, _default: 400}, step: {opacity: function (n) {
        i.style(n.elem, "opacity", n.now)
    }, _default: function (n) {
        n.elem.style && null != n.elem.style[n.prop] ? n.elem.style[n.prop] = n.now + n.unit : n.elem[n.prop] = n.now
    }}});
    i.each(it.concat.apply([], it), function (n, t) {
        t.indexOf("margin") && (i.fx.step[t] = function (n) {
            i.style(n.elem, t, Math.max(0, n.now) + n.unit)
        })
    });
    i.expr && i.expr.filters && (i.expr.filters.animated = function (n) {
        return i.grep(i.timers, function (t) {
            return n === t.elem
        }).length
    });
    kr = /^t(?:able|d|h)$/i;
    vt = /^(?:body|html)$/i;
    br = "getBoundingClientRect"in r.documentElement ? function (n, t, r, u) {
        try {
            u = n.getBoundingClientRect()
        } catch (f) {
        }
        return!u || !i.contains(r, n) ? u ? {top: u.top, left: u.left} : {top: 0, left: 0} : (n = t.body, t = si(t), {top: u.top + (t.pageYOffset || i.support.boxModel && r.scrollTop || n.scrollTop) - (r.clientTop || n.clientTop || 0), left: u.left + (t.pageXOffset || i.support.boxModel && r.scrollLeft || n.scrollLeft) - (r.clientLeft || n.clientLeft || 0)})
    } : function (n, t, r) {
        var u, s = n.offsetParent, o = t.body, f, e;
        for (u = (t = t.defaultView) ? t.getComputedStyle(n, null) : n.currentStyle, f = n.offsetTop, e = n.offsetLeft; (n = n.parentNode) && n !== o && n !== r && (!i.support.fixedPosition || "fixed" !== u.position);)u = t ? t.getComputedStyle(n, null) : n.currentStyle, f -= n.scrollTop, e -= n.scrollLeft, n === s && (f += n.offsetTop, e += n.offsetLeft, !i.support.doesNotAddBorder || i.support.doesAddBorderForTableAndCells && kr.test(n.nodeName) || (f += parseFloat(u.borderTopWidth) || 0, e += parseFloat(u.borderLeftWidth) || 0), s = n.offsetParent), i.support.subtractsBorderForOverflowNotVisible && "visible" !== u.overflow && (f += parseFloat(u.borderTopWidth) || 0, e += parseFloat(u.borderLeftWidth) || 0);
        return("relative" === u.position || "static" === u.position) && (f += o.offsetTop, e += o.offsetLeft), i.support.fixedPosition && "fixed" === u.position && (f += Math.max(r.scrollTop, o.scrollTop), e += Math.max(r.scrollLeft, o.scrollLeft)), {top: f, left: e}
    };
    i.fn.offset = function (n) {
        if (arguments.length)return n === t ? this : this.each(function (t) {
            i.offset.setOffset(this, n, t)
        });
        var r = this[0], u = r && r.ownerDocument;
        return u ? r === u.body ? i.offset.bodyOffset(r) : br(r, u, u.documentElement) : null
    };
    i.offset = {bodyOffset: function (n) {
        var t = n.offsetTop, r = n.offsetLeft;
        return i.support.doesNotIncludeMarginInBodyOffset && (t += parseFloat(i.css(n, "marginTop")) || 0, r += parseFloat(i.css(n, "marginLeft")) || 0), {top: t, left: r}
    }, setOffset: function (n, t, r) {
        var u = i.css(n, "position");
        "static" === u && (n.style.position = "relative");
        var o = i(n), s = o.offset(), c = i.css(n, "top"), f = i.css(n, "left"), e = {}, h = {};
        ("absolute" === u || "fixed" === u) && -1 < i.inArray("auto", [c, f]) ? (h = o.position(), u = h.top, f = h.left) : (u = parseFloat(c) || 0, f = parseFloat(f) || 0);
        i.isFunction(t) && (t = t.call(n, r, s));
        null != t.top && (e.top = t.top - s.top + u);
        null != t.left && (e.left = t.left - s.left + f);
        "using"in t ? t.using.call(n, e) : o.css(e)
    }};
    i.fn.extend({position: function () {
        if (!this[0])return null;
        var u = this[0], n = this.offsetParent(), t = this.offset(), r = vt.test(n[0].nodeName) ? {top: 0, left: 0} : n.offset();
        return t.top -= parseFloat(i.css(u, "marginTop")) || 0, t.left -= parseFloat(i.css(u, "marginLeft")) || 0, r.top += parseFloat(i.css(n[0], "borderTopWidth")) || 0, r.left += parseFloat(i.css(n[0], "borderLeftWidth")) || 0, {top: t.top - r.top, left: t.left - r.left}
    }, offsetParent: function () {
        return this.map(function () {
            for (var n = this.offsetParent || r.body; n && !vt.test(n.nodeName) && "static" === i.css(n, "position");)n = n.offsetParent;
            return n
        })
    }});
    i.each({scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function (n, r) {
        var u = /Y/.test(r);
        i.fn[n] = function (f) {
            return i.access(this, function (n, f, e) {
                var o = si(n);
                if (e === t)return o ? r in o ? o[r] : i.support.boxModel && o.document.documentElement[f] || o.document.body[f] : n[f];
                o ? o.scrollTo(u ? i(o).scrollLeft() : e, u ? e : i(o).scrollTop()) : n[f] = e
            }, n, f, arguments.length, null)
        }
    });
    i.each({Height: "height", Width: "width"}, function (n, r) {
        var u = "client" + n, f = "scroll" + n, e = "offset" + n;
        i.fn["inner" + n] = function () {
            var n = this[0];
            return n ? n.style ? parseFloat(i.css(n, r, "padding")) : this[r]() : null
        };
        i.fn["outer" + n] = function (n) {
            var t = this[0];
            return t ? t.style ? parseFloat(i.css(t, r, n ? "margin" : "border")) : this[r]() : null
        };
        i.fn[r] = function (n) {
            return i.access(this, function (n, r, o) {
                if (i.isWindow(n))return r = n.document, n = r.documentElement[u], i.support.boxModel && n || r.body && r.body[u] || n;
                if (9 === n.nodeType)return r = n.documentElement, r[u] >= r[f] ? r[u] : Math.max(n.body[f], r[f], n.body[e], r[e]);
                if (o === t)return n = i.css(n, r), r = parseFloat(n), i.isNumeric(r) ? r : n;
                i(n).css(r, o)
            }, r, n, arguments.length, null)
        }
    });
    n.jQuery = n.$ = i;
    "function" == typeof define && define.amd && define.amd.jQuery && define("jquery", [], function () {
        return i
    })
}(window);
jQuery.cookie = function (n, t, i) {
    if (1 < arguments.length && "[object Object]" !== String(t)) {
        if (i = jQuery.extend({}, i), (null === t || void 0 === t) && (i.expires = -1), "number" == typeof i.expires) {
            var u = i.expires, r = i.expires = new Date;
            r.setDate(r.getDate() + u)
        }
        return t = String(t), document.cookie = [encodeURIComponent(n), "=", i.raw ? t : encodeURIComponent(t), i.expires ? "; expires=" + i.expires.toUTCString() : "", i.path ? "; path=" + i.path : "", i.domain ? "; domain=" + i.domain : "", i.secure ? "; secure" : ""].join("")
    }
    return i = t || {}, r = i.raw ? function (n) {
        return n
    } : decodeURIComponent, (u = new RegExp("(?:^|; )" + encodeURIComponent(n) + "=([^;]*)").exec(document.cookie)) ? r(u[1]) : null
}, function (n) {
    function i(t) {
        var i = t || window.event, e = [].slice.call(arguments, 1), r = 0, f = 0, u = 0;
        return t = n.event.fix(i), t.type = "mousewheel", i.wheelDelta && (r = i.wheelDelta / 120), i.detail && (r = -i.detail / 3), u = r, void 0 !== i.axis && i.axis === i.HORIZONTAL_AXIS && (u = 0, f = -1 * r), void 0 !== i.wheelDeltaY && (u = i.wheelDeltaY / 120), void 0 !== i.wheelDeltaX && (f = i.wheelDeltaX / -120), e.unshift(t, r, f, u), (n.event.dispatch || n.event.handle).apply(this, e)
    }

    var t = ["DOMMouseScroll", "mousewheel"], r;
    if (n.event.fixHooks)for (r = t.length; r;)n.event.fixHooks[t[--r]] = n.event.mouseHooks;
    n.event.special.mousewheel = {setup: function () {
        if (this.addEventListener)for (var n = t.length; n;)this.addEventListener(t[--n], i, !1); else this.onmousewheel = i
    }, teardown: function () {
        if (this.removeEventListener)for (var n = t.length; n;)this.removeEventListener(t[--n], i, !1); else this.onmousewheel = null
    }};
    n.fn.extend({mousewheel: function (n) {
        return n ? this.bind("mousewheel", n) : this.trigger("mousewheel")
    }, unmousewheel: function (n) {
        return this.unbind("mousewheel", n)
    }})
}(jQuery), function (n, t) {
    function i() {
        this._state = [];
        this._defaults = {classHolder: "sbHolder", classHolderDisabled: "sbHolderDisabled", classHolderOpen: "sbHolderOpen", classSelector: "sbSelector", classOptions: "sbOptions", classGroup: "sbGroup", classSub: "sbSub", classDisabled: "sbDisabled", classToggleOpen: "sbToggleOpen", classToggle: "sbToggle", speed: 200, slidesUp: !1, effect: "slide", onChange: null, onOpen: null, onClose: null}
    }

    n.extend(i.prototype, {_isOpenSelectbox: function (n) {
        return n ? this._getInst(n).isOpen : !1
    }, _isDisabledSelectbox: function (n) {
        return n ? this._getInst(n).isDisabled : !1
    }, _attachSelectbox: function (i, r) {
        function v() {
            var t, i = this.attr("id").split("_")[1];
            for (t in u._state)t !== i && u._state.hasOwnProperty(t) && n(":input[sb='" + t + "']")[0] && u._closeSelectbox(n(":input[sb='" + t + "']")[0])
        }

        function y(t) {
            f.children().each(function (r) {
                if (n(this).is(":selected")) {
                    if (38 == t && 0 < r)return r = n(f.children()[r - 1]), u._changeSelectbox(i, r.val(), r.text()), !1;
                    if (40 == t && r < f.children().length - 1)return r = n(f.children()[r + 1]), u._changeSelectbox(i, r.val(), r.text()), !1
                }
            })
        }

        function p(r, f) {
            var o = f && f.sub ? !0 : !1, l = f && f.disabled ? !0 : !1;
            r.each(function (r) {
                var f = n(this), v = n("<li>"), a;
                f.is(":selected") && (h.text(f.text()), w = !0);
                r === b - 1 && v.addClass("last"), function () {
                    var h = f.text(), r = f.data("custom-option-text"), r = r != t ? r : h;
                    f.is(":disabled") || l ? a = n("<span>", {text: r}).addClass(e.settings.classDisabled) : (a = n("<a>", {href: "#" + f.val(), rel: f.val(), text: r, click: function (t) {
                        t.preventDefault();
                        t = s;
                        t.attr("id").split("_");
                        u._closeSelectbox(i);
                        u._changeSelectbox(i, n(this).attr("rel"), h);
                        t.focus()
                    }}), f.is(":selected") && a.addClass("active"));
                    o && a.addClass(e.settings.classSub);
                    a.appendTo(v)
                }();
                v.appendTo(c)
            })
        }

        var l, b, a;
        if (this._getInst(i))return!1;
        var f = n(i), u = this, e = u._newInst(f), o, h, s, c, w = !1;
        f.find("optgroup");
        l = f.find("option");
        b = l.length;
        f.attr("sb", e.uid);
        n.extend(e.settings, u._defaults, r);
        u._state[e.uid] = !1;
        f.hide();
        o = n("<div>", {id: "sbHolder_" + e.uid, "class": e.settings.classHolder});
        a = f.data("selectbox-css");
        a && o.css(a);
        h = n("<a>", {id: "sbSelector_" + e.uid, href: "#", "class": e.settings.classSelector, click: function (t) {
            t.preventDefault();
            t.stopPropagation();
            v.apply(n(this), []);
            t = n(this).attr("id").split("_")[1];
            u._state[t] ? u._closeSelectbox(i) : (u._openSelectbox(i), s.focus())
        }, keyup: function (n) {
            y(n.keyCode)
        }});
        s = n("<a>", {id: "sbToggle_" + e.uid, href: "#", "class": e.settings.classToggle, click: function (t) {
            t.preventDefault();
            t.stopPropagation();
            v.apply(n(this), []);
            t = n(this).attr("id").split("_")[1];
            u._state[t] ? u._closeSelectbox(i) : (u._openSelectbox(i), s.focus())
        }, keyup: function (n) {
            y(n.keyCode)
        }});
        s.appendTo(o);
        c = n("<ul>", {id: "sbOptions_" + e.uid, "class": e.settings.classOptions, css: {display: "none"}});
        f.children().each(function (t) {
            t = n(this);
            var i, r = {};
            t.is("option") ? p(t) : t.is("optgroup") && (i = n("<li>"), n("<span>", {text: t.attr("label")}).addClass(e.settings.classGroup).appendTo(i), i.appendTo(c), t.is(":disabled") && (r.disabled = !0), r.sub = !0, p(t.find("option"), r))
        });
        w || h.text(l.first().text());
        n.data(i, "selectbox", e);
        h.appendTo(o);
        c.appendTo(o);
        o.insertAfter(f);
        f.is(":disabled") && n.selectbox._disableSelectbox(i);
        f.change(function () {
            var t = n(this).val(), r = f.find("option[value='" + t + "']").text();
            u._changeSelectbox(i, t, r)
        })
    }, _detachSelectbox: function (t) {
        var i = this._getInst(t);
        if (!i)return!1;
        n("#sbHolder_" + i.uid).remove();
        delete this._state[i.uid];
        n.data(t, "selectbox", null);
        n(t).show()
    }, _changeSelectbox: function (t, i, r) {
        var u = this._getInst(t), f = this._get(u, "onChange");
        alreadySelected = n("#sbSelector_" + u.uid).text() === r && n("#sbOptions_" + u.uid).find('a[rel="' + i + '"]').hasClass("active");
        alreadySelected || (n("#sbSelector_" + u.uid).text(r), n("#sbOptions_" + u.uid).find(".active").removeClass("active"), n("#sbOptions_" + u.uid).find('a[rel="' + i + '"]').addClass("active"), n(t).find("option").attr("selected", !1), n(t).find("option[value='" + i + "']").attr("selected", !0), f ? f.apply(u.input ? u.input[0] : null, [i, u]) : u.input && u.input.trigger("change"))
    }, _enableSelectbox: function (t) {
        var i = this._getInst(t);
        if (!i || !i.isDisabled)return!1;
        n("#sbHolder_" + i.uid).removeClass(i.settings.classHolderDisabled);
        i.isDisabled = !1;
        n.data(t, "selectbox", i)
    }, _disableSelectbox: function (t) {
        var i = this._getInst(t);
        if (!i || i.isDisabled)return!1;
        n("#sbHolder_" + i.uid).addClass(i.settings.classHolderDisabled);
        i.isDisabled = !0;
        n.data(t, "selectbox", i)
    }, _optionSelectbox: function (t, i, r) {
        var u = this._getInst(t);
        if (!u)return!1;
        u[i] = r;
        n.data(t, "selectbox", u)
    }, _openSelectbox: function (t) {
        var i = this._getInst(t), h = this;
        if (i && !i.isOpen && !i.isDisabled) {
            var r = n("#sbOptions_" + i.uid), f = parseInt(n(window).height(), 10), c = parseInt(n(window).width(), 10), e = n("#sbHolder_" + i.uid).offset(), o = n(window).scrollTop(), u = r.prev().height(), f = f - (e.top - o) - u / 2, s = this._get(i, "onOpen");
            50 < f && !i.settings.slidesUp ? r.css({bottom: "auto", top: u + 2 + "px", maxHeight: f - u + "px"}) : r.css({top: "auto", bottom: u + 2 + "px", maxHeight: e.top - o - u / 2 + "px"});
            e.left + r.width() > c ? r.css("left", "-" + (r.width() - r.parent().width() + 3) + "px") : r.css("left", "-1px");
            "fade" === i.settings.effect ? r.fadeIn(i.settings.speed) : r.slideDown(i.settings.speed);
            n("#sbToggle_" + i.uid).addClass(i.settings.classToggleOpen);
            n("#sbHolder_" + i.uid).addClass(i.settings.classHolderOpen);
            this._state[i.uid] = !0;
            i.isOpen = !0;
            s && s.apply(i.input ? i.input[0] : null, [i]);
            n.data(t, "selectbox", i);
            n("html").unbind("click.sbClose").one("click.sbClose", function () {
                h._closeSelectbox(t)
            })
        }
    }, _closeSelectbox: function (t) {
        var i = this._getInst(t), r;
        i && i.isOpen && (r = this._get(i, "onClose"), n("#sbOptions_" + i.uid).hide(), n("#sbToggle_" + i.uid).removeClass(i.settings.classToggleOpen), n("#sbHolder_" + i.uid).removeClass(i.settings.classHolderOpen), this._state[i.uid] = !1, i.isOpen = !1, r && r.apply(i.input ? i.input[0] : null, [i]), n.data(t, "selectbox", i), n("html").unbind("click.sbClose"))
    }, _newInst: function (n) {
        return{id: n[0].id.replace(/([^A-Za-z0-9_-])/g, "\\\\$1"), input: n, uid: Math.floor(99999999 * Math.random()), isOpen: !1, isDisabled: !1, settings: {}}
    }, _getInst: function (t) {
        try {
            return n.data(t, "selectbox")
        } catch (i) {
            throw"Missing instance data for this selectbox";
        }
    }, _get: function (n, i) {
        return n.settings[i] !== t ? n.settings[i] : this._defaults[i]
    }});
    n.fn.selectbox = function (t) {
        var i = Array.prototype.slice.call(arguments, 1);
        return"string" == typeof t && "isDisabled" == t || "option" == t && 2 == arguments.length && "string" == typeof arguments[1] ? n.selectbox["_" + t + "Selectbox"].apply(n.selectbox, [this[0]].concat(i)) : this.each(function () {
            "string" == typeof t ? n.selectbox["_" + t + "Selectbox"].apply(n.selectbox, [this].concat(i)) : n.selectbox._attachSelectbox(this, t)
        })
    };
    n.selectbox = new i;
    n.selectbox.version = "0.1.3"
}(jQuery), function (n) {
    var t = "fontFamily fontSize fontWeight fontStyle letterSpacing textTransform wordSpacing".split(" "), i = n('<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">')[0];
    i.setAttribute("oninput", "return");
    n.fn.autosize = n.isFunction(i.oninput) || "onpropertychange"in i ? function (i) {
        return this.each(function () {
            function e() {
                var n, t;
                s || (s = !0, f.value = r.value, f.style.overflowY = r.style.overflowY, f.style.width = u.css("width"), f.style.textIndent = u.css("text-indent"), f.scrollTop = 0, f.scrollTop = 9e4, n = f.scrollTop, t = "hidden", n > o ? (n = o, t = "scroll") : n < c && (n = c), r.style.overflowY = t, r.style.height = r.style.minHeight = r.style.maxHeight = n + l + "px", setTimeout(function () {
                    s = !1
                }, 1));
                u.trigger("autosizeComplete")
            }

            for (var r = this, u = n(r).css({overflow: "hidden", overflowY: "hidden", wordWrap: "break-word"}), f = n('<textarea style="position:absolute; top:-9999px; left:-9999px; right:auto; bottom:auto; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden">').addClass(i || "autosizejs")[0], c = u.height(), o = parseInt(u.css("maxHeight"), 10), s, h = t.length, l = "border-box" === u.css("box-sizing") ? u.outerHeight() - u.height() : 0, o = o && 0 < o ? o : 9e4; h--;)f.style[t[h]] = u.css(t[h]);
            n("body").append(f);
            "onpropertychange"in r ? "oninput"in r ? r.oninput = r.onkeyup = e : r.onpropertychange = e : r.oninput = e;
            n(window).resize(e);
            u.bind("autosize", e);
            e()
        })
    } : function () {
        return this
    }
}(jQuery), function (n, t, i) {
    function f() {
        e = t.setTimeout(function () {
            r.each(function () {
                var i = n(this), r = i.width(), u = i.height(), t = n.data(this, "resize-special-event");
                r === t.w && u === t.h || i.trigger("resize", [t.w = r, t.h = u])
            });
            f()
        }, u.delay)
    }

    var r = n([]), u = n.resize = n.extend(n.resize, {}), e;
    u.delay = 250;
    u.throttleWindow = !0;
    n.event.special.resize = {setup: function () {
        if (!u.throttleWindow && this.setTimeout)return!1;
        var t = n(this);
        r = r.add(t);
        n.data(this, "resize-special-event", {w: t.width(), h: t.height()});
        1 === r.length && f()
    }, teardown: function () {
        if (!u.throttleWindow && this.setTimeout)return!1;
        var t = n(this);
        r = r.not(t);
        t.removeData("resize-special-event");
        r.length || clearTimeout(e)
    }, add: function (t) {
        function f(t, u, f) {
            var e = n(this), o = n.data(this, "resize-special-event");
            o.w = u !== i ? u : e.width();
            o.h = f !== i ? f : e.height();
            r.apply(this, arguments)
        }

        if (!u.throttleWindow && this.setTimeout)return!1;
        var r;
        if (n.isFunction(t))return r = t, f;
        r = t.handler;
        t.handler = f
    }}
}(jQuery, this);
Modernizr = window.Modernizr = function (n, t, i) {
    function f(n, t) {
        return typeof n === t
    }

    function p(n, t) {
        var u, r;
        for (u in n)if (r = n[u], !~("" + r).indexOf("-") && o[r] !== i)return"pfx" == t ? r : !0;
        return!1
    }

    function c(n, t, r) {
        var u = n.charAt(0).toUpperCase() + n.slice(1), e = (n + " " + b.join(u + " ") + u).split(" "), o;
        if (f(t, "string") || f(t, "undefined"))t = p(e, t); else n:{
            e = (n + " " + k.join(u + " ") + u).split(" ");
            n = e;
            for (o in n)if (u = t[n[o]], u !== i) {
                t = !1 === r ? n[o] : f(u, "function") ? u.bind(r || t) : u;
                break n
            }
            t = !1
        }
        return t
    }

    var r = {}, e = t.documentElement, u = t.createElement("modernizr"), o = u.style, w = " -webkit- -moz- -o- -ms- ".split(" "), b = ["Webkit", "Moz", "O", "ms"], k = ["webkit", "moz", "o", "ms"], u = {}, l = [], a = l.slice, s, d = function (n, i, r, u) {
        var c, l, h, a, f = t.createElement("div"), s = t.body, o = s || t.createElement("body");
        if (parseInt(r, 10))for (; r--;)h = t.createElement("div"), h.id = u ? u[r] : "modernizr" + (r + 1), f.appendChild(h);
        return c = ['&#173;<style id="smodernizr">', n, "<\/style>"].join(""), f.id = "modernizr", (s ? f : o).innerHTML += c, o.appendChild(f), s || (o.style.background = "", o.style.overflow = "hidden", a = e.style.overflow, e.style.overflow = "hidden", e.appendChild(o)), l = i(f, n), s ? f.parentNode.removeChild(f) : (o.parentNode.removeChild(o), e.style.overflow = a), !!l
    }, g = function () {
        var n = {select: "input", change: "input", submit: "form", reset: "form", error: "img", load: "img", abort: "img"};
        return function (r, u) {
            u = u || t.createElement(n[r] || "div");
            r = "on" + r;
            var e = r in u;
            return e || (u.setAttribute || (u = t.createElement("div")), u.setAttribute && u.removeAttribute && (u.setAttribute(r, ""), e = f(u[r], "function"), f(u[r], "undefined") || (u[r] = i), u.removeAttribute(r))), e
        }
    }(), v = {}.hasOwnProperty, y, h;
    y = f(v, "undefined") || f(v.call, "undefined") ? function (n, t) {
        return t in n && f(n.constructor.prototype[t], "undefined")
    } : function (n, t) {
        return v.call(n, t)
    };
    Function.prototype.bind || (Function.prototype.bind = function (n) {
        var t = this, i, r;
        if ("function" != typeof t)throw new TypeError;
        return i = a.call(arguments, 1), r = function () {
            var u, f;
            return this instanceof r ? (u = function () {
            }, u.prototype = t.prototype, u = new u, f = t.apply(u, i.concat(a.call(arguments))), Object(f) === f ? f : u) : t.apply(n, i.concat(a.call(arguments)))
        }, r
    });
    u.canvas = function () {
        var n = t.createElement("canvas");
        return!!n.getContext && !!n.getContext("2d")
    };
    u.canvastext = function () {
        return!!r.canvas && !!f(t.createElement("canvas").getContext("2d").fillText, "function")
    };
    u.touch = function () {
        var i;
        return"ontouchstart"in n || n.DocumentTouch && t instanceof DocumentTouch ? i = !0 : d(["@media (", w.join("touch-enabled),("), "modernizr){#modernizr{top:9px;position:absolute}}"].join(""), function (n) {
            i = 9 === n.offsetTop
        }), i
    };
    u.history = function () {
        return!!n.history && !!history.pushState
    };
    u.draganddrop = function () {
        var n = t.createElement("div");
        return"draggable"in n || "ondragstart"in n && "ondrop"in n
    };
    u.websockets = function () {
        return"WebSocket"in n || "MozWebSocket"in n
    };
    u.multiplebgs = function () {
        return o.cssText = "background:url(https://),url(https://),red url(https://)", /(url\s*\(.*?){3}/.test(o.background)
    };
    u.csscolumns = function () {
        return c("columnCount")
    };
    u.csstransitions = function () {
        return c("transition")
    };
    u.localstorage = function () {
        try {
            return localStorage.setItem("modernizr", "modernizr"), localStorage.removeItem("modernizr"), !0
        } catch (n) {
            return!1
        }
    };
    for (h in u)y(u, h) && (s = h.toLowerCase(), r[s] = u[h](), l.push((r[s] ? "" : "no-") + s));
    return r.addTest = function (n, t) {
        if ("object" == typeof n)for (var u in n)y(n, u) && r.addTest(u, n[u]); else {
            if (n = n.toLowerCase(), r[n] !== i)return r;
            t = "function" == typeof t ? t() : t;
            e.className += " feature-" + (t ? "" : "no-") + n;
            r[n] = t
        }
        return r
    }, o.cssText = "", u = null, r._version = "2.7.1", r._prefixes = w, r._domPrefixes = k, r._cssomPrefixes = b, r.hasEvent = g, r.testProp = function (n) {
        return p([n])
    }, r.testAllProps = c, r.testStyles = d, e.className = e.className.replace(/(^|\s)no-js(\s|$)/, "$1$2") + (" feature-js feature-" + l.join(" feature-")), r
}(this, this.document);
Modernizr.touch = Modernizr.touch && "onorientationchange"in window;
Modernizr.addTest("pointerevents", function () {
    var n = document.createElement("x"), i = document.documentElement, t = window.getComputedStyle, r = !1;
    return("pointerEvents"in n.style) ? (n.style.pointerEvents = "auto", n.style.pointerEvents = "x", i.appendChild(n), t && (r = (t = t(n, "")) ? "auto" === t.pointerEvents : !1), i.removeChild(n), !!r) : !1
}), function (n) {
    function f(n, t, i) {
        n /= 255;
        t /= 255;
        i /= 255;
        var r = Math.max(n, t, i), e = Math.min(n, t, i), u, f = r - e;
        if (r == e)u = 0; else {
            switch (r) {
                case n:
                    u = (t - i) / f + (t < i ? 6 : 0);
                    break;
                case t:
                    u = (i - n) / f + 2;
                    break;
                case i:
                    u = (n - t) / f + 4
            }
            u /= 6
        }
        return[u, 0 == r ? 0 : f / r, r]
    }

    function u(n, t, i) {
        var r, u, f, o = Math.floor(6 * n), s = 6 * n - o, e;
        n = i * (1 - t);
        e = i * (1 - s * t);
        t = i * (1 - (1 - s) * t);
        switch (o % 6) {
            case 0:
                r = i;
                u = t;
                f = n;
                break;
            case 1:
                r = e;
                u = i;
                f = n;
                break;
            case 2:
                r = n;
                u = i;
                f = t;
                break;
            case 3:
                r = n;
                u = e;
                f = i;
                break;
            case 4:
                r = t;
                u = n;
                f = i;
                break;
            case 5:
                r = i;
                u = n;
                f = e
        }
        return[255 * r, 255 * u, 255 * f]
    }

    function e(n) {
        return n = n.replace(/^(?:[\da-f]{3}){1,2}$/i, "#$&"), n = n.replace(/^#([\da-f])([\da-f])([\da-f])$/i, "#$1$1$2$2$3$3"), n.replace(/^\s*RGB\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/, function (n, t, r, u) {
            return i(t, r, u)
        })
    }

    function o(n) {
        return n.replace(/^#([\da-f])([\da-f])([\da-f])$/i, "#$1$1$2$2$3$3"), n = /^#([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(n) || [null, 0, 0, 0], [parseInt(n[1], 16), parseInt(n[2], 16), parseInt(n[3], 16)]
    }

    function i(n, t, i) {
        return 2 in arguments || (i = n[2], t = n[1], n = n[0]), ("#@0" + (~~n).toString(16) + "@0" + (~~t).toString(16) + "@0" + (~~i).toString(16)).replace(/@0?([\da-f]{2})/gi, "$1")
    }

    function s(n) {
        n && (n.join || (n = n ? ("" + n).split(",") : []), t = n)
    }

    function r(c) {
        function w(i) {
            var r = !1;
            return(i = i.toLowerCase(), n.each(t, function (n, t) {
                if (t.toLowerCase() == i)return r = !0, !1
            }), r) ? !1 : (t = [i].concat(t.slice(0, h - 1)), !0)
        }

        function b(t) {
            a.call(this, t);
            n(this).removeData("tvcolorpicker").removeData("tvcolorpicker-custom-color");
            y()
        }

        function a(t) {
            var i = n(this);
            i.val(t);
            i.change();
            t ? i.trigger("pick-color", t) : i.trigger("pick-transparent");
            v.call(this, t)
        }

        function v(t) {
            n(this).css({backgroundColor: t, color: t})
        }

        function l(t, i) {
            var e = this, l = n(e).val().toLowerCase(), r = document.createElement("table"), s = document.createElement("tbody"), c, u;
            return r.appendChild(s), u = 0, n.each(t, function (t, r) {
                var a, v;
                u++;
                0 == t % h && (c = n("<tr><\/tr>").appendTo(s));
                a = n('<td class="tvcolorpicker-cell"><\/td>').appendTo(c);
                a = n('<div class="tvcolorpicker-swatch"><\/div>').appendTo(a);
                i && i.addClass && a.addClass(i.addClass);
                r && (r = r.toLowerCase(), l == r && a.addClass("active"), a.css({backgroundColor: r}).data("color", r), a.bind("click", function () {
                    b.call(e, r)
                }), v = f.apply(this, o(r)), .9 < (1 - v[1]) * v[2] && a.addClass("low-contrast"))
            }), n(r).addClass("tvcolorpicker-table"), u ? r : n()
        }

        function k(t, i, r) {
            var u = n(t).offset();
            n(document).scrollLeft();
            var f = n(document).scrollTop(), h = n(t).outerWidth(), c = n(t).outerHeight();
            t = n(window).width();
            var e = n(window).height(), o = n(i).outerWidth(), s = n(i).outerHeight();
            switch (r.direction) {
                default:
                case"down":
                    r = {top: u.top + c + r.offset, left: u.left + r.drift};
                    break;
                case"right":
                    r = {top: u.top + r.drift, left: u.left + h + r.offset}
            }
            r.top + s > e + f && (r.top = e - s + f);
            u.left + o > t && (r.left = t - o);
            r.left += "px";
            r.top += "px";
            i.css(r)
        }

        function d(r) {
            function tt(n) {
                var t = n.originalEvent, r = n.offsetX || n.layerX || t && (t.offsetX || t.layerX) || 0;
                n = n.offsetY || n.layerY || t && (t.offsetY || t.layerY) || 0;
                et.css({left: r + "px", top: n + "px"});
                e[0] = r / d;
                e[1] = 1 - n / y;
                w.css({backgroundColor: i(u(e[0], e[1], 1))});
                ft()
            }

            function it(t) {
                1 == t.which && (g = !1, s.is(".opened") && n(h).get(0).focus(), n(document).unbind("mouseup", it))
            }

            function rt(n) {
                var t = n.originalEvent;
                n = n.offsetY || n.layerY || t && (t.offsetY || t.layerY) || 0;
                st.css({top: n + "px"});
                e[2] = 1 - n / y;
                ft()
            }

            function ut(t) {
                1 == t.which && (nt = !1, n(document).unbind("mouseup", ut), s.is(".opened") && n(h).get(0).focus())
            }

            function ft() {
                ht && (ht = !1, s.find(".tvcolorpicker-swatch.active").removeClass("active"));
                var n = i(u(e[0], e[1], e[2]));
                h.val().toUpperCase() != n.toUpperCase() && (h.data("tvcolorpicker-custom-color", n), a.call(h, n))
            }

            var h = n(this), s = n('<div class="tvcolorpicker-popup opened">'), c = n('<div class="tvcolorpicker-swatches-area"><\/div>').appendTo(s);
            c.append(l.call(this, "#000000 #424242 #656565 #989898 #b6b6b6 #cbcbcb #d8d8d8 #eeeeee #f2f2f2 #ffffff".split(" ")));
            c.append(l.call(this, "#970000 #ff0000 #ff9800 #ffff00 #00ff00 #00ffff #4985e7 #0000ff #9800ff #ff00ff".split(" ")));
            c.append(l.call(this, "#e6b8af #f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #c9daf8 #cfe2f3 #d9d2e9 #ead1dc #dd7e6b #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #a4c2f4 #9fc5e8 #b4a7d6 #d5a6bd #cc4125 #e06666 #f6b26b #ffd966 #93c47d #76a5af #6d9eeb #6fa8dc #8e7cc3 #c27ba0 #a61c00 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3c78d8 #3d85c6 #674ea7 #a64d79 #85200c #990000 #b45f06 #bf9000 #38761d #134f5c #1155cc #0b5394 #351c75 #741b47 #5b0f00 #660000 #783f04 #7f6000 #274e13 #0c343d #1c4587 #073763 #20124d #4c1130".split(" ")));
            var b = n('<div class="tvcolorpicker-custom-area"><\/div>').css({display: "none"}).appendTo(s), p = n('<div class="tvcolorpicker-hsv"><\/div>').appendTo(b), v = n('<div class="tvcolorpicker-hs"><\/div>').appendTo(p), et = n('<div class="tvcolorpicker-hs-handle"><\/div>').appendTo(v), ot = n('<div class="tvcolorpicker-hs-area"><\/div>').appendTo(v), w = n('<div class="tvcolorpicker-v"><\/div>').appendTo(p), st = n('<div class="tvcolorpicker-v-handle"><\/div>').appendTo(w), p = n('<div class="tvcolorpicker-v-area"><\/div>').appendTo(w), y = v.height(), d = v.width(), g = !1, nt = !1, ht = !0, e = [0, 0, .5];
            return ot.bind("mousedown", function (t) {
                1 == t.which && (g = !0, n(document).bind("mouseup", it), tt(t), t.preventDefault())
            }), ot.bind("mousemove", function (n) {
                g && (tt(n), n.preventDefault())
            }), p.bind("mousedown", function (t) {
                1 == t.which && (nt = !0, n(document).bind("mouseup", ut), rt(t), t.preventDefault())
            }), p.bind("mousemove", function (n) {
                nt && (rt(n), n.preventDefault())
            }), n('<a class="tvcolorpicker-custom-button tv-button">' + n.t("Custom color...") + "<\/a>").appendTo(s).bind("click", function () {
                var t = n(this).is(".active");
                t || b.css({minWidth: c.width() + "px", minHeight: c.height() + "px"});
                n(this)[t ? "removeClass" : "addClass"]("active");
                b.css({display: t ? "none" : "block"});
                c.css({display: t ? "block" : "none"});
                t ? h.removeData("tvcolorpicker-custom-color") : (y = v.height(), d = v.width(), t = o(h.val()), e = f.apply(this, t), et.css({left: ~~(e[0] * d) + "px", top: ~~((1 - e[1]) * y) + "px"}), st.css({top: ~~((1 - e[2]) * y) + "px"}), w.css({backgroundColor: i(u(e[0], e[1], 1))}))
            }), s.append(n(l.call(this, t, {addClass: "tvcolorpicker-user"})).addClass("tvcolorpicker-user-swatches")), n(document.body).append(s), k(h, s, r), s
        }

        function y() {
            n(".tvcolorpicker-popup").removeClass("opened").remove();
            n(p).data("tvcolorpicker", null);
            n(p).each(function () {
                var i = n(this).data("tvcolorpicker-custom-color");
                i && (w(i) && n(this).trigger("customcolorchange", [t]), n(this).data("tvcolorpicker-custom-color", null));
                (i = n(this).data("tvcolorpicker-previous-color")) && i != n(this).val() && n(this).trigger("change");
                n(this).removeData("tvcolorpicker-previous-color")
            })
        }

        c = n.extend({}, r.options, c || {});
        var p = this;
        return c && "customColors"in c && s(c.customColors), this.each(function () {
            function f() {
                var n = e(t.val());
                v.call(t, n)
            }

            var t = n(this), i, r, u;
            t.val(e(t.val()));
            i = null;
            r = !1;
            t.addClass("tvcolorpicker-widget").attr("autocomplete", "off").attr("readonly", !0);
            u = function () {
                t.data("tvcolorpicker") || (i = d.call(t, c), t.data("tvcolorpicker-custom-color", null), t.data("tvcolorpicker", i), t.data("tvcolorpicker-previous-color", t.val()), i.bind("mousedown click", function (u) {
                    n(u.target).parents().andSelf().is(i) && (t.focus(), r = !0, setTimeout(function () {
                        r = !1
                    }, 0))
                }))
            };
            t.on("touchstart", u);
            t.focus(u);
            t.blur(function (n) {
                r ? n.stopPropagation() : y.call(t)
            });
            t.change(function () {
                f()
            });
            f()
        })
    }

    if (!n)throw Error("This program cannot be run in DOS mode");
    r.setCustomColors = s;
    n.fn.tvcolorpicker = r;
    var h = 10, t = [];
    r.options = {direction: "down", offset: 0, drift: 0}
}(window.jQuery);
Mustache = "undefined" != typeof module && module.exports || {}, function (n) {
    function k(n) {
        return String(n).replace(/&(?!\w+;)|[<>"']/g, function (n) {
            return b[n] || n
        })
    }

    function i(n, t, i, r) {
        r = r || "<template>";
        for (var u = t.split("\n"), o = Math.max(i - 3, 0), e = Math.min(u.length, i + 3), u = u.slice(o, e), f = 0, s = u.length; f < s; ++f)e = f + o + 1, u[f] = (e === i ? " >> " : "    ") + u[f];
        return n.template = t, n.line = i, n.file = r, n.message = [r + ":" + i, u.join("\n"), "", n.message].join("\n"), n
    }

    function h(n, t, i) {
        if ("." === n)return t[t.length - 1];
        n = n.split(".");
        for (var o = n.length - 1, s = n[o], u, r, h = t.length, e, f; h;) {
            for (f = t.slice(0), r = t[--h], e = 0; e < o;) {
                if (r = r[n[e++]], null == r)break;
                f.push(r)
            }
            if (r && s in r) {
                u = r[s];
                break
            }
        }
        return"function" == typeof u && (u = u.call(f[f.length - 1])), null == u ? i : u
    }

    function d(n, t, i, r) {
        var e = "", o;
        return n = h(n, t), r ? (null == n || !1 === n || f(n) && 0 === n.length) && (e += i()) : f(n) ? w(n, function (n) {
            t.push(n);
            e += i();
            t.pop()
        }) : "object" == typeof n ? (t.push(n), e += i(), t.pop()) : "function" == typeof n ? (o = t[t.length - 1], e = e + (n.call(o, i(), function (n) {
            return u(n, o)
        }) || "")) : n && (e += i()), e
    }

    function c(r, u) {
        u = u || {};
        for (var v = u.tags || n.tags, l = v[0], h = v[v.length - 1], o = ['var buffer = "";', "\nvar line = 1;", "\ntry {", '\nbuffer += "'], w = [], k = !1, p = !1, nt = function () {
            if (!k || p || u.space)w = []; else for (; w.length;)o.splice(w.pop(), 1);
            p = k = !1
        }, a = [], b, d, g, it = function (n) {
            v = t(n).split(/\s+/);
            d = v[0];
            g = v[v.length - 1]
        }, rt = function (n) {
            o.push('";', b, '\nvar partial = partials["' + t(n) + '"];', "\nif (partial) {", "\n  buffer += render(partial,stack[stack.length - 1],partials);", "\n}", '\nbuffer += "')
        }, tt = function (n, f) {
            var e = t(n);
            if ("" === e)throw i(Error("Section name may not be empty"), r, y, u.file);
            a.push({name: e, inverted: f});
            o.push('";', b, '\nvar name = "' + e + '";', "\nvar callback = (function () {", "\n  return function () {", '\n    var buffer = "";', '\nbuffer += "')
        }, ut = function (n) {
            tt(n, !0)
        }, ft = function (n) {
            n = t(n);
            var f = 0 != a.length && a[a.length - 1].name;
            if (!f || n != f)throw i(Error('Section named "' + n + '" was never opened'), r, y, u.file);
            n = a.pop();
            o.push('";', "\n    return buffer;", "\n  };", "\n})();");
            n.inverted ? o.push("\nbuffer += renderSection(name,stack,callback,true);") : o.push("\nbuffer += renderSection(name,stack,callback);");
            o.push('\nbuffer += "')
        }, et = function (n) {
            o.push('";', b, '\nbuffer += lookup("' + t(n) + '",stack,"");', '\nbuffer += "')
        }, ot = function (n) {
            o.push('";', b, '\nbuffer += escapeHTML(lookup("' + t(n) + '",stack,""));', '\nbuffer += "')
        }, y = 1, c, s, f = 0, st = r.length; f < st; ++f)if (r.slice(f, f + l.length) === l) {
            f += l.length;
            c = r.substr(f, 1);
            b = "\nline = " + y + ";";
            d = l;
            g = h;
            k = !0;
            switch (c) {
                case"!":
                    f++;
                    s = null;
                    break;
                case"=":
                    f++;
                    h = "=" + h;
                    s = it;
                    break;
                case">":
                    f++;
                    s = rt;
                    break;
                case"#":
                    f++;
                    s = tt;
                    break;
                case"^":
                    f++;
                    s = ut;
                    break;
                case"/":
                    f++;
                    s = ft;
                    break;
                case"{":
                    h = "}" + h;
                case"&":
                    f++;
                    p = !0;
                    s = et;
                    break;
                default:
                    p = !0;
                    s = ot
            }
            if (c = r.indexOf(h, f), -1 === c)throw i(Error('Tag "' + l + '" was not closed properly'), r, y, u.file);
            for (l = r.substring(f, c), s && s(l), s = 0; ~(s = l.indexOf("\n", s));)y++, s++;
            f = c + h.length - 1;
            l = d;
            h = g
        } else switch (c = r.substr(f, 1), c) {
            case'"':
            case"\\":
                p = !0;
                o.push("\\" + c);
                break;
            case"\r":
                break;
            case"\n":
                w.push(o.length);
                o.push("\\n");
                nt();
                y++;
                break;
            default:
                e.test(c) ? w.push(o.length) : p = !0;
                o.push(c)
        }
        if (0 != a.length)throw i(Error('Section "' + a[a.length - 1].name + '" was not closed properly'), r, y, u.file);
        return nt(), o.push('";', "\nreturn buffer;", "\n} catch (e) { throw {error: e, line: line}; }"), h = o.join("").replace(/buffer \+= "";\n/g, ""), u.debug && ("undefined" != typeof console && console.log ? console.log(h) : "function" == typeof print && print(h)), h
    }

    function l(n, t) {
        var r = c(n, t), f = new Function("view,partials,stack,lookup,escapeHTML,renderSection,render", r);
        return function (r, e) {
            e = e || {};
            var s = [r];
            try {
                return f(r, e, s, h, k, d, u)
            } catch (o) {
                throw i(o.error, n, o.line, t.file);
            }
        }
    }

    function a(n, t) {
        return t = t || {}, !1 !== t.cache ? (r[n] || (r[n] = l(n, t)), r[n]) : l(n, t)
    }

    function u(n, t, i) {
        return a(n)(t, i)
    }

    var w, e, t, o, s, b, r;
    n.name = "mustache.js";
    n.version = "0.5.0-dev";
    n.tags = ["{{", "}}"];
    n.parse = c;
    n.compile = a;
    n.render = u;
    n.clearCache = function () {
        r = {}
    };
    n.to_html = function (n, t, i, r) {
        if (n = u(n, t, i), "function" == typeof r)r(n); else return n
    };
    var g = Object.prototype.toString, v = Array.isArray, y = Array.prototype.forEach, p = String.prototype.trim, f;
    f = v ? v : function (n) {
        return"[object Array]" === g.call(n)
    };
    w = y ? function (n, t, i) {
        return y.call(n, t, i)
    } : function (n, t, i) {
        for (var r = 0, u = n.length; r < u; ++r)t.call(i, n[r], r, n)
    };
    e = /^\s*$/;
    p ? t = function (n) {
        return null == n ? "" : p.call(n)
    } : (e.test(" ") ? (o = /^\s+/, s = /\s+$/) : (o = /^[\s\xA0]+/, s = /[\s\xA0]+$/), t = function (n) {
        return null == n ? "" : String(n).replace(o, "").replace(s, "")
    });
    b = {"&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;"};
    r = {}
}(Mustache);
Array.isArray || (Array.isArray = function (n) {
    return"[object Array]" == Object.prototype.toString.call(n)
});
Array.prototype.forEach || (Array.prototype.forEach = function (n) {
    var i, r, u, t;
    if (void 0 === this || null === this)throw new TypeError;
    if (i = Object(this), r = i.length >>> 0, "function" != typeof n)throw new TypeError;
    for (u = 2 <= arguments.length ? arguments[1] : void 0, t = 0; t < r; t++)t in i && n.call(u, i[t], t, i)
});
Array.prototype.map || (Array.prototype.map = function (n) {
    var i, r;
    if (void 0 === this || null === this)throw new TypeError;
    if (i = Object(this), r = i.length >>> 0, "function" != typeof n)throw new TypeError;
    for (var u = Array(r), f = 2 <= arguments.length ? arguments[1] : void 0, t = 0; t < r; t++)t in i && (u[t] = n.call(f, i[t], t, i));
    return u
});
Object.keys || (Object.keys = function () {
    var t = Object.prototype.hasOwnProperty, i = !{toString: null}.propertyIsEnumerable("toString"), n = "toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "), r = n.length;
    return function (u) {
        if ("object" != typeof u && "function" != typeof u || null === u)throw new TypeError("Object.keys called on non-object");
        var e = [];
        for (var f in u)t.call(u, f) && e.push(f);
        if (i)for (f = 0; f < r; f++)t.call(u, n[f]) && e.push(n[f]);
        return e
    }
}()), function (n) {
    var t = ["", "webkit", "moz", "o", "ms"], i = 0;
    (function (i, r) {
        var f, u, e;
        n:{
            for (f in t)if (u = t[f], e = i, e = e[0].toUpperCase() + e.slice(1), u += e, u = u[0].toLowerCase() + u.slice(1), n[u]) {
                f = u;
                break n
            }
            f = !1
        }
        n[i] = f ? n[f] : r
    })("requestAnimationFrame", function (n) {
        return setTimeout(n, 16), i++
    })
}(this), function () {
    var t, n, i, r, u, f;
    window.parent !== window && window.CanvasRenderingContext2D && window.TextMetrics && (n = window.CanvasRenderingContext2D.prototype) && n.hasOwnProperty("font") && n.hasOwnProperty("mozTextStyle") && "function" == typeof n.__lookupSetter__ && (i = n.__lookupSetter__("font")) && (n.__defineSetter__("font", function (n) {
        try {
            return i.call(this, n)
        } catch (t) {
            if ("NS_ERROR_FAILURE" !== t.name)throw t;
        }
    }), r = n.measureText, t = function () {
        this.width = 0;
        this.isFake = !0;
        this.__proto__ = window.TextMetrics.prototype
    }, n.measureText = function () {
        try {
            return r.apply(this, arguments)
        } catch (n) {
            if ("NS_ERROR_FAILURE" !== n.name)throw n;
            return new t
        }
    }, u = n.fillText, n.fillText = function () {
        try {
            u.apply(this, arguments)
        } catch (n) {
            if ("NS_ERROR_FAILURE" !== n.name)throw n;
        }
    }, f = n.strokeText, n.strokeText = function () {
        try {
            f.apply(this, arguments)
        } catch (n) {
            if ("NS_ERROR_FAILURE" !== n.name)throw n;
        }
    })
}();
eval(function (n, t, i, r, u, f) {
    if (u = function (n) {
        return(n < t ? "" : u(parseInt(n / t))) + (35 < (n %= t) ? String.fromCharCode(n + 29) : n.toString(36))
    }, !"".replace(/^/, String)) {
        for (; i--;)f[u(i)] = r[i] || u(i);
        r = [function (n) {
            return f[n]
        }];
        u = function () {
            return"\\w+"
        };
        i = 1
    }
    for (; i--;)r[i] && (n = n.replace(new RegExp("\\b" + u(i) + "\\b", "g"), r[i]));
    return n
}("h.i['1a']=h.i['z'];h.O(h.i,{y:'D',z:9(x,t,b,c,d){6 h.i[h.i.y](x,t,b,c,d)},17:9(x,t,b,c,d){6 c*(t/=d)*t+b},D:9(x,t,b,c,d){6-c*(t/=d)*(t-2)+b},13:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t+b;6-c/2*((--t)*(t-2)-1)+b},X:9(x,t,b,c,d){6 c*(t/=d)*t*t+b},U:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t+1)+b},R:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t+b;6 c/2*((t-=2)*t*t+2)+b},N:9(x,t,b,c,d){6 c*(t/=d)*t*t*t+b},M:9(x,t,b,c,d){6-c*((t=t/d-1)*t*t*t-1)+b},L:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t+b;6-c/2*((t-=2)*t*t*t-2)+b},K:9(x,t,b,c,d){6 c*(t/=d)*t*t*t*t+b},J:9(x,t,b,c,d){6 c*((t=t/d-1)*t*t*t*t+1)+b},I:9(x,t,b,c,d){e((t/=d/2)<1)6 c/2*t*t*t*t*t+b;6 c/2*((t-=2)*t*t*t*t+2)+b},G:9(x,t,b,c,d){6-c*8.C(t/d*(8.g/2))+c+b},15:9(x,t,b,c,d){6 c*8.n(t/d*(8.g/2))+b},12:9(x,t,b,c,d){6-c/2*(8.C(8.g*t/d)-1)+b},Z:9(x,t,b,c,d){6(t==0)?b:c*8.j(2,10*(t/d-1))+b},Y:9(x,t,b,c,d){6(t==d)?b+c:c*(-8.j(2,-10*t/d)+1)+b},W:9(x,t,b,c,d){e(t==0)6 b;e(t==d)6 b+c;e((t/=d/2)<1)6 c/2*8.j(2,10*(t-1))+b;6 c/2*(-8.j(2,-10*--t)+2)+b},V:9(x,t,b,c,d){6-c*(8.o(1-(t/=d)*t)-1)+b},S:9(x,t,b,c,d){6 c*8.o(1-(t=t/d-1)*t)+b},Q:9(x,t,b,c,d){e((t/=d/2)<1)6-c/2*(8.o(1-t*t)-1)+b;6 c/2*(8.o(1-(t-=2)*t)+1)+b},P:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6-(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b},H:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d)==1)6 b+c;e(!p)p=d*.3;e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);6 a*8.j(2,-10*t)*8.n((t*d-s)*(2*8.g)/p)+c+b},T:9(x,t,b,c,d){f s=1.l;f p=0;f a=c;e(t==0)6 b;e((t/=d/2)==2)6 b+c;e(!p)p=d*(.3*1.5);e(a<8.w(c)){a=c;f s=p/4}m f s=p/(2*8.g)*8.r(c/a);e(t<1)6-.5*(a*8.j(2,10*(t-=1))*8.n((t*d-s)*(2*8.g)/p))+b;6 a*8.j(2,-10*(t-=1))*8.n((t*d-s)*(2*8.g)/p)*.5+c+b},F:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*(t/=d)*t*((s+1)*t-s)+b},E:9(x,t,b,c,d,s){e(s==u)s=1.l;6 c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},16:9(x,t,b,c,d,s){e(s==u)s=1.l;e((t/=d/2)<1)6 c/2*(t*t*(((s*=(1.B))+1)*t-s))+b;6 c/2*((t-=2)*t*(((s*=(1.B))+1)*t+s)+2)+b},A:9(x,t,b,c,d){6 c-h.i.v(x,d-t,0,c,d)+b},v:9(x,t,b,c,d){e((t/=d)<(1/2.k)){6 c*(7.q*t*t)+b}m e(t<(2/2.k)){6 c*(7.q*(t-=(1.5/2.k))*t+.k)+b}m e(t<(2.5/2.k)){6 c*(7.q*(t-=(2.14/2.k))*t+.11)+b}m{6 c*(7.q*(t-=(2.18/2.k))*t+.19)+b}},1b:9(x,t,b,c,d){e(t<d/2)6 h.i.A(x,t*2,0,c,d)*.5+b;6 h.i.v(x,t*2-d,0,c,d)*.5+c*.5+b}});", 62, 74, "      return  Math function     if var PI jQuery easing pow 75 70158 else sin sqrt  5625 asin   undefined easeOutBounce abs  def swing easeInBounce 525 cos easeOutQuad easeOutBack easeInBack easeInSine easeOutElastic easeInOutQuint easeOutQuint easeInQuint easeInOutQuart easeOutQuart easeInQuart extend easeInElastic easeInOutCirc easeInOutCubic easeOutCirc easeInOutElastic easeOutCubic easeInCirc easeInOutExpo easeInCubic easeOutExpo easeInExpo  9375 easeInOutSine easeInOutQuad 25 easeOutSine easeInOutBack easeInQuad 625 984375 jswing easeInOutBounce".split(" "), 0, {})), function (n) {
    var t = n(window), i = n(document), r = function (r) {
        r = jQuery.data(r.target);
        t.scrollTop() > i.height() - t.innerHeight() - (r.tolerance || 190) && n(this).trigger("scrolltoend")
    };
    n.event.special.scrolltoend = {setup: function () {
        n(this).bind("scroll.scrolltoend", r)
    }, teardown: function () {
        n(this).unbind("scroll.scrolltoend", r)
    }};
    jQuery.event.special.scrollto = {bindType: "scroll", handle: function (n) {
        var f = n.handleObj, u, r;
        if (n.scrollData || (n.scrollData = {scrollTop: t.scrollTop()}), u = null, "number" == typeof n.data.to)u = n.scrollData.scrollTop > n.data.to - (n.data.tolerance || 0) ? !0 : !1; else if ("bottom" === n.data.to)n.scrollData.bottomOffset || (n.scrollData.bottomOffset = i.height() - t.innerHeight()), u = n.scrollData.scrollTop > n.scrollData.bottomOffset - (n.data.tolerance || 0) ? !0 : !1; else throw Error('Special event scrollto: property "to" has unexpected value');
        return(r = Array.prototype.slice.apply(arguments), u) ? (r.push(!0), f.handler.apply(this, r)) : n.data.twoway ? (r.push(!1), f.handler.apply(this, r)) : void 0
    }}
}(jQuery);
jQuery.fn.timeUpdate = function () {
    return this.each(function () {
        var n = jQuery(this).data("timestamp"), n = n ? 1e3 * n : 1e3 * jQuery(this).text();
        TradingView.agoDateFormatter(jQuery(this), new Date(n));
        jQuery(this).removeClass("time-upd")
    })
}, function (n) {
    function h(n, t, i) {
        for (var r = 0; r < u.length; r++)u[r] || (t = t.toLowerCase()), n.addEventListener(u[r] + t, i, !1)
    }

    function o(n) {
        n.stop(!0);
        n.css("background-color", "");
        n.removeData("flicker-enable");
        n.removeData("flicker-options")
    }

    function c(t) {
        var i = t.data("flicker-enable");
        i && (!0 !== i ? (i--, i ? (f(t), t.data("flicker-enable", i)) : (i = t.data("flicker-options").complete, o(t), i && n.isFunction(i) && i())) : f(t))
    }

    function f(n) {
        var u = n.css("background-color"), t = n.data("flicker-options"), i = t.duration || 400, r = t.easing || "swing";
        n.animate({"background-color": t.highlightColor || "#fbf8e9"}, i, r).animate({"background-color": u}, i, r, c.bind(n, n))
    }

    var i = !1, s = document.body || document.documentElement, r = "animation", e = ["Webkit", "Moz", "O", "ms", "Khtml"], t = "", u;
    if (void 0 !== s.style.animationName && (i = !0), !1 === i)for (t = 0; t < e.length; t++)if (void 0 !== s.style[e[t] + "AnimationName"]) {
        t = e[t];
        r = t + "Animation";
        t.toLowerCase();
        i = !0;
        break
    }
    u = ["webkit", "moz", "MS", "o", ""];
    n.fn.highlight = function (t, u) {
        switch (t) {
            default:
                t = void 0 === t ? !0 : t;
                this.each(function () {
                    if (i)t = !0 === t ? "infinite" : t, h(this, "AnimationEnd", function () {
                        this.style[r] = ""
                    }), this.style[r] = "highlight-animation 0.4s ease-in-out " + t + " alternate"; else {
                        var e = n(this);
                        e.data("flicker-enable", t);
                        e.data("flicker-options", n.extend({}, u || {}));
                        e.is(":animated") || f(e)
                    }
                });
                break;
            case!1:
                this.each(function () {
                    i ? this.style[r] = "" : o(n(this))
                })
        }
    }
}(jQuery), function (n) {
    var i, t;
    "undefined" != typeof document.hidden ? (i = "hidden", t = "visibilitychange") : "undefined" != typeof document.mozHidden ? (i = "mozHidden", t = "mozvisibilitychange") : "undefined" != typeof document.msHidden ? (i = "msHidden", t = "msvisibilitychange") : "undefined" != typeof document.webkitHidden && (i = "webkitHidden", t = "webkitvisibilitychange");
    n.tabvisible = !0;
    t && (n(document).on(t, function () {
        n.tabvisible = !document[i];
        n(window).trigger("visibilitychange", !document[i])
    }), n(document).trigger(t));
    n.whenTabVisible = function (i) {
        if (!t || n.tabvisible)i(); else n(window).one("visibilitychange", i)
    }
}(jQuery);
!function (n) {
    function e(i, r, u, f, s) {
        var v = i.contents(), h = !1, c, y, l, a;
        for (i.empty(), c = 0, y = v.length; y > c && !h; c++)l = v[c], a = n(l), "undefined" != typeof l && (i.append(a), s && i[i.is("table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style") ? "after" : "append"](s), 3 == l.nodeType ? t(u, f) && (h = o(a, r, u, f, s)) : h = e(a, r, u, f, s), h || s && s.detach());
        return h
    }

    function o(n, i, u, f, e) {
        var y = !1, l = n[0], k;
        if ("undefined" == typeof l)return!1;
        for (var c = h(l), a = -1 !== c.indexOf(" ") ? " " : "　", a = "letter" == f.wrap ? "" : a, c = c.split(a), b = -1, v = -1, w = 0, p = c.length - 1; p >= w;) {
            if (k = Math.floor((w + p) / 2), k == v)break;
            v = k;
            r(l, c.slice(0, v + 1).join(a) + f.ellipsis);
            t(u, f) ? p = v : (b = v, w = v);
            p == w && 0 == p && f.fallbackToLetter && (a = "", c = c[0].split(a), b = -1, v = -1, w = 0, p = c.length - 1)
        }
        return-1 == b || 1 == c.length && 0 == c[0].length ? (a = n.parent(), n.remove(), l = e ? e.length : 0, a.contents().size() > l ? (y = a.contents().eq(-1 - l), y = o(y, i, u, f, e)) : (i = a.prev(), l = i.contents().eq(-1)[0], "undefined" != typeof l && (c = s(h(l), f), r(l, c), e && i.append(e), a.remove(), y = !0))) : (c = s(c.slice(0, b + 1).join(a), f), y = !0, r(l, c)), y
    }

    function t(n, t) {
        return n.innerHeight() > t.maxHeight
    }

    function s(t, i) {
        for (; -1 < n.inArray(t.slice(-1), i.lastCharacter.remove);)t = t.slice(0, -1);
        return 0 > n.inArray(t.slice(-1), i.lastCharacter.noEllipsis) && (t += i.ellipsis), t
    }

    function i(n) {
        return{width: n.innerWidth(), height: n.innerHeight()}
    }

    function r(n, t) {
        n.innerText ? n.innerText = t : n.nodeValue ? n.nodeValue = t : n.textContent && (n.textContent = t)
    }

    function h(n) {
        return n.innerText ? n.innerText : n.nodeValue ? n.nodeValue : n.textContent ? n.textContent : ""
    }

    function l(t, i) {
        return"undefined" == typeof t ? !1 : t ? "string" == typeof t ? (t = n(t, i), t.length ? t : !1) : "object" == typeof t ? "undefined" == typeof t.jquery ? !1 : t : !1 : !1
    }

    function a(n, t) {
        return n ? (t = "string" == typeof t ? "dotdotdot: " + t : ["dotdotdot:", t], "undefined" != typeof console && "undefined" != typeof window.console.log && window.console.log(t), !1) : !1
    }

    var c, u, f;
    n.fn.dotdotdot || (n.fn.dotdotdot = function (r) {
        var u;
        if (0 == this.length)return r && !1 === r.debug || a(!0, 'No element found for "' + this.selector + '".'), this;
        if (1 < this.length)return this.each(function () {
            n(this).dotdotdot(r)
        });
        u = this;
        u.data("dotdotdot") && u.trigger("destroy.dot");
        u.data("dotdotdot-style", u.attr("style"));
        u.css("word-wrap", "break-word");
        u.bind_events = function () {
            return u.bind("update.dot", function (i, r) {
                var c, v, a, b, w;
                if (i.preventDefault(), i.stopPropagation(), c = f, "number" == typeof f.height)v = f.height; else {
                    v = u.innerHeight();
                    for (var l = ["paddingTop", "paddingBottom"], y = 0, p = l.length; p > y; y++)a = parseInt(u.css(l[y]), 10), isNaN(a) && (a = 0), v -= a
                }
                if (c.maxHeight = v, f.maxHeight += f.tolerance, "undefined" != typeof r && (("string" == typeof r || r instanceof HTMLElement) && (r = n("<div />").append(r).contents()), r instanceof n && (h = r)), s = u.wrapInner('<div class="dotdotdot" />').children(), s.empty().append(h.clone(!0)).css({height: "auto", width: "auto", border: "none", padding: 0, margin: 0}), c = l = !1, o.afterElement && (l = o.afterElement.clone(!0), o.afterElement.remove()), t(s, f))if ("children" == f.wrap) {
                    for (c = s, v = f, y = c.children(), p = !1, c.empty(), a = 0, b = y.length; b > a; a++) {
                        if (w = y.eq(a), c.append(w), l && c.append(l), t(c, v)) {
                            w.remove();
                            p = !0;
                            break
                        }
                        l && l.detach()
                    }
                    c = p
                } else c = e(s, u, s, f, l);
                return s.replaceWith(s.contents()), s = null, n.isFunction(f.callback) && f.callback.call(u[0], c, h), o.isTruncated = c, c
            }).bind("isTruncated.dot", function (n, t) {
                return n.preventDefault(), n.stopPropagation(), "function" == typeof t && t.call(u[0], o.isTruncated), o.isTruncated
            }).bind("originalContent.dot", function (n, t) {
                return n.preventDefault(), n.stopPropagation(), "function" == typeof t && t.call(u[0], h), h
            }).bind("destroy.dot", function (n) {
                n.preventDefault();
                n.stopPropagation();
                u.unwatch().unbind_events().empty().append(h).attr("style", u.data("dotdotdot-style")).data("dotdotdot", !1)
            }), u
        };
        u.unbind_events = function () {
            return u.unbind(".dot"), u
        };
        u.watch = function () {
            if (u.unwatch(), "window" == f.watch) {
                var t = n(window), r = t.width(), e = t.height();
                t.bind("resize.dot" + o.dotId, function () {
                    r == t.width() && e == t.height() && f.windowResizeFix || (r = t.width(), e = t.height(), v && clearInterval(v), v = setTimeout(function () {
                        u.trigger("update.dot")
                    }, 10))
                })
            } else y = i(u), v = setInterval(function () {
                var n = i(u);
                (y.width != n.width || y.height != n.height) && (u.trigger("update.dot"), y = i(u))
            }, 100);
            return u
        };
        u.unwatch = function () {
            return n(window).unbind("resize.dot" + o.dotId), v && clearInterval(v), u
        };
        var h = u.contents(), f = n.extend(!0, {}, n.fn.dotdotdot.defaults, r), o = {}, y = {}, v = null, s = null;
        return f.lastCharacter.remove instanceof Array || (f.lastCharacter.remove = n.fn.dotdotdot.defaultArrays.lastCharacter.remove), f.lastCharacter.noEllipsis instanceof Array || (f.lastCharacter.noEllipsis = n.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis), o.afterElement = l(f.after, u), o.isTruncated = !1, o.dotId = c++, u.data("dotdotdot", !0).bind_events().trigger("update.dot"), f.watch && u.watch(), u
    }, n.fn.dotdotdot.defaults = {ellipsis: "... ", wrap: "word", fallbackToLetter: !0, lastCharacter: {}, tolerance: 0, callback: null, after: null, height: null, watch: !1, windowResizeFix: !0, debug: !1}, n.fn.dotdotdot.defaultArrays = {lastCharacter: {remove: " 　,;.!?".split(""), noEllipsis: []}}, c = 1, u = n.fn.html, n.fn.html = function (n) {
        return"undefined" != typeof n ? this.data("dotdotdot") && "function" != typeof n ? this.trigger("update", [n]) : u.call(this, n) : u.call(this)
    }, f = n.fn.text, n.fn.text = function (t) {
        if ("undefined" != typeof t) {
            if (this.data("dotdotdot")) {
                var i = n("<div />");
                return i.text(t), t = i.html(), i.remove(), this.trigger("update", [t])
            }
            return f.call(this, t)
        }
        return f.call(this)
    })
}(jQuery), function (n) {
    if (!n.support.cors && n.ajaxTransport && window.XDomainRequest) {
        var t = /^https?:\/\//i, i = /^get|post$/i, r = new RegExp("^" + location.protocol, "i"), u = /text\/html/i, f = /\/json/i, e = /\/xml/i;
        n.ajaxTransport("* text html xml json", function (o, s) {
            if (o.crossDomain && o.async && i.test(o.type) && t.test(o.url) && r.test(o.url)) {
                var h = null, c = (s.dataType || "").toLowerCase();
                return{send: function (t, i) {
                    h = new XDomainRequest;
                    /^\d+$/.test(s.timeout) && (h.timeout = s.timeout);
                    h.ontimeout = function () {
                        i(500, "timeout")
                    };
                    h.onload = function () {
                        var l = "Content-Length: " + h.responseText.length + "\r\nContent-Type: " + h.contentType, o = 200, s = "success", r = {text: h.responseText}, t;
                        try {
                            if ("html" === c || u.test(h.contentType))r.html = h.responseText; else if ("json" === c || "text" !== c && f.test(h.contentType))try {
                                r.json = n.parseJSON(h.responseText)
                            } catch (v) {
                                o = 500;
                                s = "parseerror"
                            } else if ("xml" === c || "text" !== c && e.test(h.contentType)) {
                                t = new ActiveXObject("Microsoft.XMLDOM");
                                t.async = !1;
                                try {
                                    t.loadXML(h.responseText)
                                } catch (y) {
                                    t = void 0
                                }
                                if (!t || !t.documentElement || t.getElementsByTagName("parsererror").length)throw o = 500, s = "parseerror", "Invalid XML: " + h.responseText;
                                r.xml = t
                            }
                        } catch (a) {
                            throw a;
                        } finally {
                            i(o, s, r, l)
                        }
                    };
                    h.onprogress = function () {
                    };
                    h.onerror = function () {
                        i(500, "error", {text: h.responseText})
                    };
                    var r = "";
                    s.data && (r = "string" === n.type(s.data) ? s.data : n.param(s.data));
                    h.open(o.type, o.url);
                    h.send(r)
                }, abort: function () {
                    h && h.abort()
                }}
            }
        })
    }
}(jQuery), function (n) {
    n.fn.inputselectable = function (t) {
        var i = n(this);
        if (t = n.extend({}, t), !i.is('input[type="text"]'))throw Error(i + ' should be input[type="text"]');
        if (t.list && t.list.length && !i.hasClass("ISinput")) {
            i.addClass("ISinput");
            var u = n('<div class="ISwraper"><\/div>'), r = n('<div class="IStoggle"><\/div>'), f = function (u, f, e) {
                function s(u, f) {
                    f || (f = o);
                    f.remove();
                    i.off("click");
                    t.closeHandle instanceof n && t.closeHandle.off("click");
                    r.removeClass("active");
                    i.focus()
                }

                if ((u.stopPropagation(), !r.is(":active") && !r.is(".active") || (s(null, n(".ISdropdown")), !e)) && f && f.length) {
                    for (u = '<ul class="ISdropdown">', e = 0; e < f.length; e++)u += '<li><div><span class="IStext">' + f[e] + "<\/span><\/div><\/li>";
                    var o = n(u + "<\/ul>");
                    o.find("li").each(function () {
                        n(this).click(function () {
                            i.val(n(this).find(".IStext").text());
                            s()
                        })
                    });
                    i.on("click", "", s);
                    if (t.closeHandle instanceof n)t.closeHandle.on("click", "", s);
                    o.insertAfter(i);
                    o.css({top: i.outerHeight(), width: i.outerWidth(), "max-height": n(window).height() - o.offset().top - 35});
                    r.toggleClass("active")
                }
            };
            return i.wrap(u), "static" == i.css("position") ? u.css("position", "relative") : u.css({top: i.css("top"), left: i.css("left"), position: i.css("position")}), u.css({width: i.outerHeight(), height: i.outerWidth()}), r.insertAfter(i), r.click(function (n) {
                f(n, t.list, !0)
            }), i.keyup(function (r) {
                var u = new RegExp(i.val(), "i"), e = n.grep(t.list, function (n) {
                    return u.test(n)
                });
                f(r, e)
            }), i.focus()
        }
    }
}(jQuery), function (n) {
    function nt() {
        return{empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1}
    }

    function gt(n, t) {
        return function (i) {
            return u(n.call(this, i), t)
        }
    }

    function gi(n, t) {
        return function (i) {
            return this.lang().ordinal(n.call(this, i), t)
        }
    }

    function ni() {
    }

    function tt(n) {
        ri(n);
        s(this, n)
    }

    function it(n) {
        n = ii(n);
        var t = n.year || 0, i = n.month || 0, r = n.week || 0, u = n.day || 0;
        this._milliseconds = +(n.millisecond || 0) + 1e3 * (n.second || 0) + 6e4 * (n.minute || 0) + 36e5 * (n.hour || 0);
        this._days = +u + 7 * r;
        this._months = +i + 12 * t;
        this._data = {};
        this._bubble()
    }

    function s(n, t) {
        for (var i in t)t.hasOwnProperty(i) && (n[i] = t[i]);
        return t.hasOwnProperty("toString") && (n.toString = t.toString), t.hasOwnProperty("valueOf") && (n.valueOf = t.valueOf), n
    }

    function a(n) {
        return 0 > n ? Math.ceil(n) : Math.floor(n)
    }

    function u(n, t, i) {
        for (var r = "" + Math.abs(n); r.length < t;)r = "0" + r;
        return(0 <= n ? i ? "+" : "" : "-") + r
    }

    function rt(n, i, r, u) {
        var o, s, e = i._milliseconds, f = i._days;
        i = i._months;
        e && n._d.setTime(+n._d + e * r);
        (f || i) && (o = n.minute(), s = n.hour());
        f && n.date(n.date() + f * r);
        i && n.month(n.month() + i * r);
        e && !u && t.updateOffset(n);
        (f || i) && (n.minute(o), n.hour(s))
    }

    function ut(n) {
        return"[object Array]" === Object.prototype.toString.call(n)
    }

    function ti(n, t, r) {
        for (var e = Math.min(n.length, t.length), o = Math.abs(n.length - t.length), f = 0, u = 0; e > u; u++)(r && n[u] !== t[u] || !r && i(n[u]) !== i(t[u])) && f++;
        return f + o
    }

    function h(n) {
        if (n) {
            var t = n.toLowerCase().replace(/(.)s$/, "$1");
            n = fu[n] || eu[t] || t
        }
        return n
    }

    function ii(n) {
        var i, t, r = {};
        for (t in n)n.hasOwnProperty(t) && (i = h(t), i && (r[i] = n[t]));
        return r
    }

    function nr(i) {
        var r, u;
        if (0 === i.indexOf("week"))r = 7, u = "day"; else {
            if (0 !== i.indexOf("month"))return;
            r = 12;
            u = "month"
        }
        t[i] = function (f, e) {
            var o, s, c = t.fn._lang[i], h = [];
            if ("number" == typeof f && (e = f, f = n), s = function (n) {
                return n = t().utc().set(u, n), c.call(t.fn._lang, n, f || "")
            }, null != e)return s(e);
            for (o = 0; r > o; o++)h.push(s(o));
            return h
        }
    }

    function i(n) {
        n = +n;
        var t = 0;
        return 0 !== n && isFinite(n) && (t = 0 <= n ? Math.floor(n) : Math.ceil(n)), t
    }

    function ft(n) {
        return 0 == n % 4 && 0 != n % 100 || 0 == n % 400
    }

    function ri(n) {
        var t;
        n._a && -2 === n._pf.overflow && (t = 0 > n._a[v] || 11 < n._a[v] ? v : 1 > n._a[c] || n._a[c] > new Date(Date.UTC(n._a[e], n._a[v] + 1, 0)).getUTCDate() ? c : 0 > n._a[o] || 23 < n._a[o] ? o : 0 > n._a[w] || 59 < n._a[w] ? w : 0 > n._a[b] || 59 < n._a[b] ? b : 0 > n._a[k] || 999 < n._a[k] ? k : -1, n._pf._overflowDayOfYear && (e > t || t > c) && (t = c), n._pf.overflow = t)
    }

    function ui(n) {
        return null == n._isValid && (n._isValid = !isNaN(n._d.getTime()) && 0 > n._pf.overflow && !n._pf.empty && !n._pf.invalidMonth && !n._pf.nullInput && !n._pf.invalidFormat && !n._pf.userInvalidated, n._strict && (n._isValid = n._isValid && 0 === n._pf.charsLeftOver && 0 === n._pf.unusedTokens.length)), n._isValid
    }

    function et(n) {
        return n ? n.toLowerCase().replace("_", "-") : n
    }

    function ot(n, i) {
        return i._isUTC ? t(n).zone(i._offset || 0) : t(n).local()
    }

    function f(n) {
        var i, u, r, f, e = 0, o = function (n) {
            if (!p[n] && ai)try {
                require("./lang/" + n)
            } catch (t) {
            }
            return p[n]
        };
        if (!n)return t.fn._lang;
        if (!ut(n)) {
            if (u = o(n))return u;
            n = [n]
        }
        for (; e < n.length;) {
            for (f = et(n[e]).split("-"), i = f.length, r = (r = et(n[e + 1])) ? r.split("-") : null; 0 < i;) {
                if (u = o(f.slice(0, i).join("-")))return u;
                if (r && r.length >= i && ti(f, r, !0) >= i - 1)break;
                i--
            }
            e++
        }
        return t.fn._lang
    }

    function tr(n) {
        return n.match(/\[[\s\S]/) ? n.replace(/^\[|\]$/g, "") : n.replace(/\\/g, "")
    }

    function ir(n) {
        for (var i = n.match(vi), t = 0, r = i.length; r > t; t++)i[t] = l[i[t]] ? l[i[t]] : tr(i[t]);
        return function (u) {
            var f = "";
            for (t = 0; r > t; t++)f += i[t]instanceof Function ? i[t].call(u, n) : i[t];
            return f
        }
    }

    function st(n, t) {
        return n.isValid() ? (t = fi(t, n.lang()), dt[t] || (dt[t] = ir(t)), dt[t](n)) : n.lang().invalidDate()
    }

    function fi(n, t) {
        function r(n) {
            return t.longDateFormat(n) || n
        }

        var i = 5;
        for (g.lastIndex = 0; 0 <= i && g.test(n);)n = n.replace(g, r), g.lastIndex = 0, --i;
        return n
    }

    function rr(n, t) {
        var i = t._strict, r;
        switch (n) {
            case"DDDD":
                return wi;
            case"YYYY":
            case"GGGG":
            case"gggg":
                return i ? nu : yr;
            case"Y":
            case"G":
            case"g":
                return iu;
            case"YYYYYY":
            case"YYYYY":
            case"GGGGG":
            case"ggggg":
                return i ? tu : pr;
            case"S":
                if (i)return gr;
            case"SS":
                if (i)return pi;
            case"SSS":
                if (i)return wi;
            case"DDD":
                return vr;
            case"MMM":
            case"MMMM":
            case"dd":
            case"ddd":
            case"dddd":
                return br;
            case"a":
            case"A":
                return f(t._l)._meridiemParse;
            case"X":
                return dr;
            case"Z":
            case"ZZ":
                return yt;
            case"T":
                return kr;
            case"SSSS":
                return wr;
            case"MM":
            case"DD":
            case"YY":
            case"GG":
            case"gg":
            case"HH":
            case"hh":
            case"mm":
            case"ss":
            case"ww":
            case"WW":
                return i ? pi : yi;
            case"M":
            case"D":
            case"d":
            case"H":
            case"h":
            case"m":
            case"s":
            case"w":
            case"W":
            case"e":
            case"E":
                return yi;
            default:
                return i = RegExp, r = fr(n.replace("\\", "")).replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"), new i(r)
        }
    }

    function ei(n) {
        n = (n || "").match(yt) || [];
        n = ((n[n.length - 1] || []) + "").match(uu) || ["-", 0, 0];
        var t = +(60 * n[1]) + i(n[2]);
        return"+" === n[0] ? -t : t
    }

    function ht(n) {
        var r, a, y, p, u, l, s, b, k, h = [];
        if (!n._d) {
            for (a = ur(n), n._w && null == n._a[c] && null == n._a[v] && (p = function (i) {
                var r = parseInt(i, 10);
                return i ? 3 > i.length ? 68 < r ? 1900 + r : 2e3 + r : r : null == n._a[e] ? t().weekYear() : n._a[e]
            }, u = n._w, null != u.GG || null != u.W || null != u.E ? l = si(p(u.GG), u.W || 1, u.E, 4, 1) : (s = f(n._l), b = null != u.d ? oi(u.d, s) : null != u.e ? parseInt(u.e, 10) + s._week.dow : 0, k = parseInt(u.w, 10) || 1, null != u.d && b < s._week.dow && k++, l = si(p(u.gg), k, b, s._week.doy, s._week.dow)), n._a[e] = l.year, n._dayOfYear = l.dayOfYear), n._dayOfYear && (y = null == n._a[e] ? a[e] : n._a[e], n._dayOfYear > (ft(y) ? 366 : 365) && (n._pf._overflowDayOfYear = !0), r = lt(y, 0, n._dayOfYear), n._a[v] = r.getUTCMonth(), n._a[c] = r.getUTCDate()), r = 0; 3 > r && null == n._a[r]; ++r)n._a[r] = h[r] = a[r];
            for (; 7 > r; r++)n._a[r] = h[r] = null == n._a[r] ? 2 === r ? 1 : 0 : n._a[r];
            h[o] += i((n._tzm || 0) / 60);
            h[w] += i((n._tzm || 0) % 60);
            n._d = (n._useUTC ? lt : er).apply(null, h)
        }
    }

    function ur(n) {
        var t = new Date;
        return n._useUTC ? [t.getUTCFullYear(), t.getUTCMonth(), t.getUTCDate()] : [t.getFullYear(), t.getMonth(), t.getDate()]
    }

    function ct(n) {
        var a, t, y, u, p;
        n._a = [];
        n._pf.empty = !0;
        a = f(n._l);
        var s = "" + n._i, nt = s.length, g = 0;
        for (y = fi(n._f, a).match(vi) || [], a = 0; a < y.length; a++)if (u = y[a], (t = (s.match(rr(u, n)) || [])[0]) && (p = s.substr(0, s.indexOf(t)), 0 < p.length && n._pf.unusedInput.push(p), s = s.slice(s.indexOf(t) + t.length), g += t.length), l[u]) {
            t ? n._pf.empty = !1 : n._pf.unusedTokens.push(u);
            var r = n, d = void 0, h = r._a;
            switch (u) {
                case"M":
                case"MM":
                    null != t && (h[v] = i(t) - 1);
                    break;
                case"MMM":
                case"MMMM":
                    d = f(r._l).monthsParse(t);
                    null != d ? h[v] = d : r._pf.invalidMonth = t;
                    break;
                case"D":
                case"DD":
                    null != t && (h[c] = i(t));
                    break;
                case"DDD":
                case"DDDD":
                    null != t && (r._dayOfYear = i(t));
                    break;
                case"YY":
                    h[e] = i(t) + (68 < i(t) ? 1900 : 2e3);
                    break;
                case"YYYY":
                case"YYYYY":
                case"YYYYYY":
                    h[e] = i(t);
                    break;
                case"a":
                case"A":
                    r._isPm = f(r._l).isPM(t);
                    break;
                case"H":
                case"HH":
                case"h":
                case"hh":
                    h[o] = i(t);
                    break;
                case"m":
                case"mm":
                    h[w] = i(t);
                    break;
                case"s":
                case"ss":
                    h[b] = i(t);
                    break;
                case"S":
                case"SS":
                case"SSS":
                case"SSSS":
                    h[k] = i(1e3 * ("0." + t));
                    break;
                case"X":
                    r._d = new Date(1e3 * parseFloat(t));
                    break;
                case"Z":
                case"ZZ":
                    r._useUTC = !0;
                    r._tzm = ei(t);
                    break;
                case"w":
                case"ww":
                case"W":
                case"WW":
                case"d":
                case"dd":
                case"ddd":
                case"dddd":
                case"e":
                case"E":
                    u = u.substr(0, 1);
                case"gg":
                case"gggg":
                case"GG":
                case"GGGG":
                case"GGGGG":
                    u = u.substr(0, 2);
                    t && (r._w = r._w || {}, r._w[u] = t)
            }
        } else n._strict && !t && n._pf.unusedTokens.push(u);
        n._pf.charsLeftOver = nt - g;
        0 < s.length && n._pf.unusedInput.push(s);
        n._isPm && 12 > n._a[o] && (n._a[o] += 12);
        !1 === n._isPm && 12 === n._a[o] && (n._a[o] = 0);
        ht(n);
        ri(n)
    }

    function fr(n) {
        return n.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (n, t, i, r, u) {
            return t || i || r || u
        })
    }

    function er(n, t, i, r, u, f, e) {
        return t = new Date(n, t, i, r, u, f, e), 1970 > n && t.setFullYear(n), t
    }

    function lt(n) {
        var t = new Date(Date.UTC.apply(null, arguments));
        return 1970 > n && t.setUTCFullYear(n), t
    }

    function oi(n, t) {
        if ("string" == typeof n)if (isNaN(n)) {
            if (n = t.weekdaysParse(n), "number" != typeof n)return null
        } else n = parseInt(n, 10);
        return n
    }

    function or(n, t, i, r, u) {
        return u.relativeTime(t || 1, !!i, n, r)
    }

    function d(n, i, r) {
        var u;
        return i = r - i, r -= n.day(), r > i && (r -= 7), i - 7 > r && (r += 7), u = t(n).add("d", r), {week: Math.ceil(u.dayOfYear() / 7), year: u.year()}
    }

    function si(n, t, i, r, u) {
        var o, f, e = lt(n, 0, 1).getUTCDay();
        return i = null != i ? i : u, o = u - e + (e > r ? 7 : 0) - (u > e ? 7 : 0), f = 7 * (t - 1) + (i - u) + o + 1, {year: 0 < f ? n : n - 1, dayOfYear: 0 < f ? f : (ft(n - 1) ? 366 : 365) + f}
    }

    function hi(i) {
        var o = i._i, l = i._f, h, r, e, u, c;
        if (null === o)i = t.invalid({nullInput: !0}); else {
            if ("string" == typeof o && (i._i = o = f().preparse(o)), t.isMoment(o)) {
                i = o;
                r = {};
                for (h in i)i.hasOwnProperty(h) && hr.hasOwnProperty(h) && (r[h] = i[h]);
                i = r;
                i._d = new Date(+o._d)
            } else if (l)if (ut(l))if (e = i, 0 === e._f.length)e._pf.invalidFormat = !0, e._d = new Date(NaN); else {
                for (o = 0; o < e._f.length; o++)h = 0, r = s({}, e), r._pf = nt(), r._f = e._f[o], ct(r), ui(r) && (h += r._pf.charsLeftOver, h += 10 * r._pf.unusedTokens.length, r._pf.score = h, (null == c || c > h) && (c = h, u = r));
                s(e, u || r)
            } else ct(i); else if (r = i, u = r._i, c = cr.exec(u), u === n)r._d = new Date; else if (c)r._d = new Date(+c[1]); else if ("string" == typeof u)if (e = r._i, o = ru.exec(e)) {
                for (r._pf.iso = !0, u = 0, c = pt.length; c > u; u++)if (pt[u][1].exec(e)) {
                    r._f = pt[u][0] + (o[6] || " ");
                    break
                }
                for (u = 0, c = wt.length; c > u; u++)if (wt[u][1].exec(e)) {
                    r._f += wt[u][0];
                    break
                }
                e.match(yt) && (r._f += "Z");
                ct(r)
            } else r._d = new Date(e); else ut(u) ? (r._a = u.slice(0), ht(r)) : "[object Date]" === Object.prototype.toString.call(u) || u instanceof Date ? r._d = new Date(+u) : "object" == typeof u ? r._d || (e = ii(r._i), r._a = [e.year, e.month, e.day, e.hour, e.minute, e.second, e.millisecond], ht(r)) : r._d = new Date(u);
            i = new tt(i)
        }
        return i
    }

    function ci(n, i) {
        t.fn[n] = t.fn[n + "s"] = function (n) {
            var r = this._isUTC ? "UTC" : "";
            return null != n ? (this._d["set" + r + i](n), t.updateOffset(this), this) : this._d["get" + r + i]()
        }
    }

    function sr(n) {
        t.duration.fn[n] = function () {
            return this._data[n]
        }
    }

    function li(n, i) {
        t.duration.fn["as" + n] = function () {
            return+this / i
        }
    }

    function at(n) {
        var i = !1, r = t;
        "undefined" == typeof ender && (n ? (vt.moment = function () {
            return!i && console && console.warn && (i = !0, console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")), r.apply(null, arguments)
        }, s(vt.moment, r)) : vt.moment = t)
    }

    for (var t, r, vt = this, y = Math.round, e = 0, v = 1, c = 2, o = 3, w = 4, b = 5, k = 6, p = {}, hr = {_isAMomentObject: null, _i: null, _f: null, _l: null, _strict: null, _isUTC: null, _offset: null, _pf: null, _lang: null}, ai = "undefined" != typeof module && module.exports && "undefined" != typeof require, cr = /^\/?Date\((\-?\d+)/i, lr = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/, ar = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/, vi = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g, g = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, yi = /\d\d?/, vr = /\d{1,3}/, yr = /\d{1,4}/, pr = /[+\-]?\d{1,6}/, wr = /\d+/, br = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, yt = /Z|[\+\-]\d\d:?\d\d/gi, kr = /T/i, dr = /[\+\-]?\d+(\.\d{1,3})?/, gr = /\d/, pi = /\d\d/, wi = /\d{3}/, nu = /\d{4}/, tu = /[+-]?\d{6}/, iu = /[+-]?\d+/, ru = /^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/, pt = [
        ["YYYYYY-MM-DD", /[+-]\d{6}-\d{2}-\d{2}/],
        ["YYYY-MM-DD", /\d{4}-\d{2}-\d{2}/],
        ["GGGG-[W]WW-E", /\d{4}-W\d{2}-\d/],
        ["GGGG-[W]WW", /\d{4}-W\d{2}/],
        ["YYYY-DDD", /\d{4}-\d{3}/]
    ], wt = [
        ["HH:mm:ss.SSSS", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/],
        ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/],
        ["HH:mm", /(T| )\d\d:\d\d/],
        ["HH", /(T| )\d\d/]
    ], uu = /([\+\-]|\d\d)/gi, bt = ["Date", "Hours", "Minutes", "Seconds", "Milliseconds"], kt = {Milliseconds: 1, Seconds: 1e3, Minutes: 6e4, Hours: 36e5, Days: 864e5, Months: 2592e6, Years: 31536e6}, fu = {ms: "millisecond", s: "second", m: "minute", h: "hour", d: "day", D: "date", w: "week", W: "isoWeek", M: "month", y: "year", DDD: "dayOfYear", e: "weekday", E: "isoWeekday", gg: "weekYear", GG: "isoWeekYear"}, eu = {dayofyear: "dayOfYear", isoweekday: "isoWeekday", isoweek: "isoWeek", weekyear: "weekYear", isoweekyear: "isoWeekYear"}, dt = {}, bi = "DDD w W M D d".split(" "), ki = "MDHhmswW".split(""), l = {M: function () {
        return this.month() + 1
    }, MMM: function (n) {
        return this.lang().monthsShort(this, n)
    }, MMMM: function (n) {
        return this.lang().months(this, n)
    }, D: function () {
        return this.date()
    }, DDD: function () {
        return this.dayOfYear()
    }, d: function () {
        return this.day()
    }, dd: function (n) {
        return this.lang().weekdaysMin(this, n)
    }, ddd: function (n) {
        return this.lang().weekdaysShort(this, n)
    }, dddd: function (n) {
        return this.lang().weekdays(this, n)
    }, w: function () {
        return this.week()
    }, W: function () {
        return this.isoWeek()
    }, YY: function () {
        return u(this.year() % 100, 2)
    }, YYYY: function () {
        return u(this.year(), 4)
    }, YYYYY: function () {
        return u(this.year(), 5)
    }, YYYYYY: function () {
        var n = this.year();
        return(0 <= n ? "+" : "-") + u(Math.abs(n), 6)
    }, gg: function () {
        return u(this.weekYear() % 100, 2)
    }, gggg: function () {
        return u(this.weekYear(), 4)
    }, ggggg: function () {
        return u(this.weekYear(), 5)
    }, GG: function () {
        return u(this.isoWeekYear() % 100, 2)
    }, GGGG: function () {
        return u(this.isoWeekYear(), 4)
    }, GGGGG: function () {
        return u(this.isoWeekYear(), 5)
    }, e: function () {
        return this.weekday()
    }, E: function () {
        return this.isoWeekday()
    }, a: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !0)
    }, A: function () {
        return this.lang().meridiem(this.hours(), this.minutes(), !1)
    }, H: function () {
        return this.hours()
    }, h: function () {
        return this.hours() % 12 || 12
    }, m: function () {
        return this.minutes()
    }, s: function () {
        return this.seconds()
    }, S: function () {
        return i(this.milliseconds() / 100)
    }, SS: function () {
        return u(i(this.milliseconds() / 10), 2)
    }, SSS: function () {
        return u(this.milliseconds(), 3)
    }, SSSS: function () {
        return u(this.milliseconds(), 3)
    }, Z: function () {
        var n = -this.zone(), t = "+";
        return 0 > n && (n = -n, t = "-"), t + u(i(n / 60), 2) + ":" + u(i(n) % 60, 2)
    }, ZZ: function () {
        var n = -this.zone(), t = "+";
        return 0 > n && (n = -n, t = "-"), t + u(i(n / 60), 2) + u(i(n) % 60, 2)
    }, z: function () {
        return this.zoneAbbr()
    }, zz: function () {
        return this.zoneName()
    }, X: function () {
        return this.unix()
    }, Q: function () {
        return this.quarter()
    }}, di = ["months", "monthsShort", "weekdays", "weekdaysShort", "weekdaysMin"]; bi.length;)r = bi.pop(), l[r + "o"] = gi(l[r], r);
    for (; ki.length;)r = ki.pop(), l[r + r] = gt(l[r], 2);
    for (l.DDDD = gt(l.DDD, 3), s(ni.prototype, {set: function (n) {
        var t;
        for (var i in n)t = n[i], "function" == typeof t ? this[i] = t : this["_" + i] = t
    }, _months: "January February March April May June July August September October November December".split(" "), months: function (n) {
        return this._months[n.month()]
    }, _monthsShort: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), monthsShort: function (n) {
        return this._monthsShort[n.month()]
    }, monthsParse: function (n) {
        var i, r, u;
        for (this._monthsParse || (this._monthsParse = []), i = 0; 12 > i; i++)if (this._monthsParse[i] || (r = t.utc([2e3, i]), u = "^" + this.months(r, "") + "|^" + this.monthsShort(r, ""), this._monthsParse[i] = new RegExp(u.replace(".", ""), "i")), this._monthsParse[i].test(n))return i
    }, _weekdays: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "), weekdays: function (n) {
        return this._weekdays[n.day()]
    }, _weekdaysShort: "Sun Mon Tue Wed Thu Fri Sat".split(" "), weekdaysShort: function (n) {
        return this._weekdaysShort[n.day()]
    }, _weekdaysMin: "Su Mo Tu We Th Fr Sa".split(" "), weekdaysMin: function (n) {
        return this._weekdaysMin[n.day()]
    }, weekdaysParse: function (n) {
        var i, r, u;
        for (this._weekdaysParse || (this._weekdaysParse = []), i = 0; 7 > i; i++)if (this._weekdaysParse[i] || (r = t([2e3, 1]).day(i), u = "^" + this.weekdays(r, "") + "|^" + this.weekdaysShort(r, "") + "|^" + this.weekdaysMin(r, ""), this._weekdaysParse[i] = new RegExp(u.replace(".", ""), "i")), this._weekdaysParse[i].test(n))return i
    }, _longDateFormat: {LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D YYYY", LLL: "MMMM D YYYY LT", LLLL: "dddd, MMMM D YYYY LT"}, longDateFormat: function (n) {
        var t = this._longDateFormat[n];
        return!t && this._longDateFormat[n.toUpperCase()] && (t = this._longDateFormat[n.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (n) {
            return n.slice(1)
        }), this._longDateFormat[n] = t), t
    }, isPM: function (n) {
        return"p" === (n + "").toLowerCase().charAt(0)
    }, _meridiemParse: /[ap]\.?m?\.?/i, meridiem: function (n, t, i) {
        return 11 < n ? i ? "pm" : "PM" : i ? "am" : "AM"
    }, _calendar: {sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L"}, calendar: function (n, t) {
        var i = this._calendar[n];
        return"function" == typeof i ? i.apply(t) : i
    }, _relativeTime: {future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years"}, relativeTime: function (n, t, i, r) {
        var u = this._relativeTime[i];
        return"function" == typeof u ? u(n, t, i, r) : u.replace(/%d/i, n)
    }, pastFuture: function (n, t) {
        var i = this._relativeTime[0 < n ? "future" : "past"];
        return"function" == typeof i ? i(t) : i.replace(/%s/i, t)
    }, ordinal: function (n) {
        return this._ordinal.replace("%d", n)
    }, _ordinal: "%d", preparse: function (n) {
        return n
    }, postformat: function (n) {
        return n
    }, week: function (n) {
        return d(n, this._week.dow, this._week.doy).week
    }, _week: {dow: 0, doy: 6}, _invalidDate: "Invalid date", invalidDate: function () {
        return this._invalidDate
    }}), t = function (t, i, r, u) {
        var f;
        return"boolean" == typeof r && (u = r, r = n), f = {}, f._isAMomentObject = !0, f._i = t, f._f = i, f._l = r, f._strict = u, f._isUTC = !1, f._pf = nt(), hi(f)
    }, t.utc = function (t, i, r, u) {
        var f;
        return"boolean" == typeof r && (u = r, r = n), f = {}, f._isAMomentObject = !0, f._useUTC = !0, f._isUTC = !0, f._l = r, f._i = t, f._f = i, f._strict = u, f._pf = nt(), hi(f).utc()
    }, t.unix = function (n) {
        return t(1e3 * n)
    }, t.duration = function (n, r) {
        var f, h, e, s = n, u = null;
        return t.isDuration(n) ? s = {ms: n._milliseconds, d: n._days, M: n._months} : "number" == typeof n ? (s = {}, r ? s[r] = n : s.milliseconds = n) : (u = lr.exec(n)) ? (f = "-" === u[1] ? -1 : 1, s = {y: 0, d: i(u[c]) * f, h: i(u[o]) * f, m: i(u[w]) * f, s: i(u[b]) * f, ms: i(u[k]) * f}) : (u = ar.exec(n)) && (f = "-" === u[1] ? -1 : 1, e = function (n) {
            return n = n && parseFloat(n.replace(",", ".")), (isNaN(n) ? 0 : n) * f
        }, s = {y: e(u[2]), M: e(u[3]), d: e(u[4]), h: e(u[5]), m: e(u[6]), s: e(u[7]), w: e(u[8])}), h = new it(s), t.isDuration(n) && n.hasOwnProperty("_lang") && (h._lang = n._lang), h
    }, t.version = "2.5.1", t.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ", t.updateOffset = function () {
    }, t.lang = function (n, i) {
        var u, r;
        return n ? (i ? (r = et(n), i.abbr = r, p[r] || (p[r] = new ni), p[r].set(i)) : null === i ? (delete p[n], n = "en") : p[n] || f(n), r = (u = t.duration.fn._lang = t.fn._lang = f(n), u._abbr)) : r = t.fn._lang._abbr, r
    }, t.langData = function (n) {
        return n && n._lang && n._lang._abbr && (n = n._lang._abbr), f(n)
    }, t.isMoment = function (n) {
        return n instanceof tt || null != n && n.hasOwnProperty("_isAMomentObject")
    }, t.isDuration = function (n) {
        return n instanceof it
    }, r = di.length - 1; 0 <= r; --r)nr(di[r]);
    for (t.normalizeUnits = function (n) {
        return h(n)
    }, t.invalid = function (n) {
        var i = t.utc(NaN);
        return null != n ? s(i._pf, n) : i._pf.userInvalidated = !0, i
    }, t.parseZone = function (n) {
        return t(n).parseZone()
    }, s(t.fn = tt.prototype, {clone: function () {
        return t(this)
    }, valueOf: function () {
        return+this._d + 6e4 * (this._offset || 0)
    }, unix: function () {
        return Math.floor(+this / 1e3)
    }, toString: function () {
        return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
    }, toDate: function () {
        return this._offset ? new Date(+this) : this._d
    }, toISOString: function () {
        var n = t(this).utc();
        return 0 < n.year() && 9999 >= n.year() ? st(n, "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]") : st(n, "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
    }, toArray: function () {
        return[this.year(), this.month(), this.date(), this.hours(), this.minutes(), this.seconds(), this.milliseconds()]
    }, isValid: function () {
        return ui(this)
    }, isDSTShifted: function () {
        return this._a ? this.isValid() && 0 < ti(this._a, (this._isUTC ? t.utc(this._a) : t(this._a)).toArray()) : !1
    }, parsingFlags: function () {
        return s({}, this._pf)
    }, invalidAt: function () {
        return this._pf.overflow
    }, utc: function () {
        return this.zone(0)
    }, local: function () {
        return this.zone(0), this._isUTC = !1, this
    }, format: function (n) {
        return n = st(this, n || t.defaultFormat), this.lang().postformat(n)
    }, add: function (n, i) {
        var r;
        return r = "string" == typeof n ? t.duration(+i, n) : t.duration(n, i), rt(this, r, 1), this
    }, subtract: function (n, i) {
        var r;
        return r = "string" == typeof n ? t.duration(+i, n) : t.duration(n, i), rt(this, r, -1), this
    }, diff: function (n, i, r) {
        var u, f, e;
        return n = ot(n, this), e = 6e4 * (this.zone() - n.zone()), i = h(i), "year" === i || "month" === i ? (u = 432e5 * (this.daysInMonth() + n.daysInMonth()), f = 12 * (this.year() - n.year()) + (this.month() - n.month()), f += (this - t(this).startOf("month") - (n - t(n).startOf("month"))) / u, f -= 6e4 * (this.zone() - t(this).startOf("month").zone() - (n.zone() - t(n).startOf("month").zone())) / u, "year" === i && (f /= 12)) : (u = this - n, f = "second" === i ? u / 1e3 : "minute" === i ? u / 6e4 : "hour" === i ? u / 36e5 : "day" === i ? (u - e) / 864e5 : "week" === i ? (u - e) / 6048e5 : u), r ? f : a(f)
    }, from: function (n, i) {
        return t.duration(this.diff(n)).lang(this.lang()._abbr).humanize(!i)
    }, fromNow: function (n) {
        return this.from(t(), n)
    }, calendar: function () {
        var n = ot(t(), this).startOf("day"), n = this.diff(n, "days", !0), n = -6 > n ? "sameElse" : -1 > n ? "lastWeek" : 0 > n ? "lastDay" : 1 > n ? "sameDay" : 2 > n ? "nextDay" : 7 > n ? "nextWeek" : "sameElse";
        return this.format(this.lang().calendar(n, this))
    }, isLeapYear: function () {
        return ft(this.year())
    }, isDST: function () {
        return this.zone() < this.clone().month(0).zone() || this.zone() < this.clone().month(5).zone()
    }, day: function (n) {
        var t = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
        return null != n ? (n = oi(n, this.lang()), this.add({d: n - t})) : t
    }, month: function (n) {
        var i, r = this._isUTC ? "UTC" : "";
        return null != n ? "string" == typeof n && (n = this.lang().monthsParse(n), "number" != typeof n) ? this : (i = this.date(), this.date(1), this._d["set" + r + "Month"](n), this.date(Math.min(i, this.daysInMonth())), t.updateOffset(this), this) : this._d["get" + r + "Month"]()
    }, startOf: function (n) {
        switch (n = h(n)) {
            case"year":
                this.month(0);
            case"month":
                this.date(1);
            case"week":
            case"isoWeek":
            case"day":
                this.hours(0);
            case"hour":
                this.minutes(0);
            case"minute":
                this.seconds(0);
            case"second":
                this.milliseconds(0)
        }
        return"week" === n ? this.weekday(0) : "isoWeek" === n && this.isoWeekday(1), this
    }, endOf: function (n) {
        return n = h(n), this.startOf(n).add("isoWeek" === n ? "week" : n, 1).subtract("ms", 1)
    }, isAfter: function (n, i) {
        return i = "undefined" != typeof i ? i : "millisecond", +this.clone().startOf(i) > +t(n).startOf(i)
    }, isBefore: function (n, i) {
        return i = "undefined" != typeof i ? i : "millisecond", +this.clone().startOf(i) < +t(n).startOf(i)
    }, isSame: function (n, t) {
        return t = t || "ms", +this.clone().startOf(t) == +ot(n, this).startOf(t)
    }, min: function (n) {
        return n = t.apply(null, arguments), this > n ? this : n
    }, max: function (n) {
        return n = t.apply(null, arguments), n > this ? this : n
    }, zone: function (n) {
        var i = this._offset || 0;
        return null == n ? this._isUTC ? i : this._d.getTimezoneOffset() : ("string" == typeof n && (n = ei(n)), 16 > Math.abs(n) && (n *= 60), this._offset = n, this._isUTC = !0, i !== n && rt(this, t.duration(i - n, "m"), 1, !0), this)
    }, zoneAbbr: function () {
        return this._isUTC ? "UTC" : ""
    }, zoneName: function () {
        return this._isUTC ? "Coordinated Universal Time" : ""
    }, parseZone: function () {
        return this._tzm ? this.zone(this._tzm) : "string" == typeof this._i && this.zone(this._i), this
    }, hasAlignedHourOffset: function (n) {
        return n = n ? t(n).zone() : 0, 0 == (this.zone() - n) % 60
    }, daysInMonth: function () {
        var n = this.year(), t = this.month();
        return new Date(Date.UTC(n, t + 1, 0)).getUTCDate()
    }, dayOfYear: function (n) {
        var i = y((t(this).startOf("day") - t(this).startOf("year")) / 864e5) + 1;
        return null == n ? i : this.add("d", n - i)
    }, quarter: function () {
        return Math.ceil((this.month() + 1) / 3)
    }, weekYear: function (n) {
        var t = d(this, this.lang()._week.dow, this.lang()._week.doy).year;
        return null == n ? t : this.add("y", n - t)
    }, isoWeekYear: function (n) {
        var t = d(this, 1, 4).year;
        return null == n ? t : this.add("y", n - t)
    }, week: function (n) {
        var t = this.lang().week(this);
        return null == n ? t : this.add("d", 7 * (n - t))
    }, isoWeek: function (n) {
        var t = d(this, 1, 4).week;
        return null == n ? t : this.add("d", 7 * (n - t))
    }, weekday: function (n) {
        var t = (this.day() + 7 - this.lang()._week.dow) % 7;
        return null == n ? t : this.add("d", n - t)
    }, isoWeekday: function (n) {
        return null == n ? this.day() || 7 : this.day(this.day() % 7 ? n : n - 7)
    }, get: function (n) {
        return n = h(n), this[n]()
    }, set: function (n, t) {
        return n = h(n), "function" == typeof this[n] && this[n](t), this
    }, lang: function (t) {
        return t === n ? this._lang : (this._lang = f(t), this)
    }}), r = 0; r < bt.length; r++)ci(bt[r].toLowerCase().replace(/s$/, ""), bt[r]);
    ci("year", "FullYear");
    t.fn.days = t.fn.day;
    t.fn.months = t.fn.month;
    t.fn.weeks = t.fn.week;
    t.fn.isoWeeks = t.fn.isoWeek;
    t.fn.toJSON = t.fn.toISOString;
    s(t.duration.fn = it.prototype, {_bubble: function () {
        var n, i, r, t;
        n = this._milliseconds;
        i = this._days;
        r = this._months;
        t = this._data;
        t.milliseconds = n % 1e3;
        n = a(n / 1e3);
        t.seconds = n % 60;
        n = a(n / 60);
        t.minutes = n % 60;
        n = a(n / 60);
        t.hours = n % 24;
        i += a(n / 24);
        t.days = i % 30;
        r += a(i / 30);
        t.months = r % 12;
        i = a(r / 12);
        t.years = i
    }, weeks: function () {
        return a(this.days() / 7)
    }, valueOf: function () {
        return this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * i(this._months / 12)
    }, humanize: function (n) {
        var e = +this, r = !n;
        var s = this.lang(), t = y(Math.abs(e) / 1e3), u = y(t / 60), f = y(u / 60), i = y(f / 24), o = y(i / 365), t = 45 > t && ["s", t] || 1 === u && ["m"] || 45 > u && ["mm", u] || 1 === f && ["h"] || 22 > f && ["hh", f] || 1 === i && ["d"] || 25 >= i && ["dd", i] || 45 >= i && ["M"] || 345 > i && ["MM", y(i / 30)] || 1 === o && ["y"] || ["yy", o];
        return r = (t[2] = r, t[3] = 0 < e, t[4] = s, or.apply({}, t)), n && (r = this.lang().pastFuture(e, r)), this.lang().postformat(r)
    }, add: function (n, i) {
        var r = t.duration(n, i);
        return this._milliseconds += r._milliseconds, this._days += r._days, this._months += r._months, this._bubble(), this
    }, subtract: function (n, i) {
        var r = t.duration(n, i);
        return this._milliseconds -= r._milliseconds, this._days -= r._days, this._months -= r._months, this._bubble(), this
    }, get: function (n) {
        return n = h(n), this[n.toLowerCase() + "s"]()
    }, as: function (n) {
        return n = h(n), this["as" + n.charAt(0).toUpperCase() + n.slice(1) + "s"]()
    }, lang: t.fn.lang, toIsoString: function () {
        var r = Math.abs(this.years()), u = Math.abs(this.months()), f = Math.abs(this.days()), n = Math.abs(this.hours()), t = Math.abs(this.minutes()), i = Math.abs(this.seconds() + this.milliseconds() / 1e3);
        return this.asSeconds() ? (0 > this.asSeconds() ? "-" : "") + "P" + (r ? r + "Y" : "") + (u ? u + "M" : "") + (f ? f + "D" : "") + (n || t || i ? "T" : "") + (n ? n + "H" : "") + (t ? t + "M" : "") + (i ? i + "S" : "") : "P0D"
    }});
    for (r in kt)kt.hasOwnProperty(r) && (li(r, kt[r]), sr(r.toLowerCase()));
    li("Weeks", 6048e5);
    t.duration.fn.asMonths = function () {
        return(+this - 31536e6 * this.years()) / 2592e6 + 12 * this.years()
    };
    t.lang("en", {ordinal: function (n) {
        var t = n % 10, t = 1 === i(n % 100 / 10) ? "th" : 1 === t ? "st" : 2 === t ? "nd" : 3 === t ? "rd" : "th";
        return n + t
    }});
    ai ? (module.exports = t, at(!0)) : "function" == typeof define && define.amd ? define("moment", function (i, r, u) {
        return u.config && u.config() && !0 !== u.config().noGlobal && at(u.config().noGlobal === n), t
    }) : at()
}.call(this), function () {
    function r(n) {
        return(10 > n ? "0" : "") + n
    }

    function v(n) {
        var t = ++p + "";
        return n ? n + t : t
    }

    function t(t, e) {
        function tt(n, t) {
            var c = g.offset(), p = /^touch/.test(n.type), a = c.left + 100, v = c.top + 100, r = (p ? n.originalEvent.touches[0] : n).pageX - a, o = (p ? n.originalEvent.touches[0] : n).pageY - v, c = Math.sqrt(r * r + o * o), y = !1, w;
            if (!t || !(67 > c || 93 < c)) {
                n.preventDefault();
                w = setTimeout(function () {
                    f.addClass("clockpicker-moving")
                }, 200);
                u && g.append(k.canvas);
                k.setHand(r, o, !t, !0);
                i.off(s).on(s, function (n) {
                    n.preventDefault();
                    var t = /^touch/.test(n.type), i = (t ? n.originalEvent.touches[0] : n).pageX - a;
                    n = (t ? n.originalEvent.touches[0] : n).pageY - v;
                    (y || i !== r || n !== o) && (y = !0, k.setHand(i, n, !1, !0))
                });
                i.off(l).one(l, function (n) {
                    n.preventDefault();
                    var u = /^touch/.test(n.type), c = (u ? n.originalEvent.changedTouches[0] : n).pageX - a;
                    n = (u ? n.originalEvent.changedTouches[0] : n).pageY - v;
                    (t || y) && c === r && n === o && k.setHand(c, n);
                    "hours" === k.currentView ? k.toggleView("minutes", h / 2) : e.autoclose && (k.minutesView.addClass("clockpicker-dial-out"), setTimeout(function () {
                        k.done()
                    }, h / 2));
                    g.prepend(nt);
                    clearTimeout(w);
                    f.removeClass("clockpicker-moving");
                    i.off(s)
                })
            }
        }

        var y = n('<div class="popover clockpicker-popover"><div class="arrow"><\/div><div class="popover-title"><span class="clockpicker-span-hours text-primary"><\/span> : <span class="clockpicker-span-minutes"><\/span><\/div><div class="popover-content"><div class="clockpicker-plate"><div class="clockpicker-canvas"><\/div><div class="clockpicker-dial clockpicker-hours"><\/div><div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"><\/div><\/div><\/div><\/div>'), g = y.find(".clockpicker-plate"), p = y.find(".clockpicker-hours"), b = y.find(".clockpicker-minutes"), w = "INPUT" === t.prop("tagName"), c = w ? t : t.find("input"), a = t.find(".input-group-addon"), k = this, d, it, rt, nt;
        this.id = v("cp");
        this.element = t;
        this.options = e;
        this.isShown = this.isAppended = !1;
        this.currentView = "hours";
        this.isInput = w;
        this.input = c;
        this.addon = a;
        this.popover = y;
        this.plate = g;
        this.hoursView = p;
        this.minutesView = b;
        this.spanHours = y.find(".clockpicker-span-hours");
        this.spanMinutes = y.find(".clockpicker-span-minutes");
        e.autoclose || n('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">' + e.donetext + "<\/button>").click(n.proxy(this.done, this)).appendTo(y);
        "top" !== e.placement && "bottom" !== e.placement || "top" !== e.align && "bottom" !== e.align || (e.align = "left");
        "left" !== e.placement && "right" !== e.placement || "left" !== e.align && "right" !== e.align || (e.align = "top");
        y.addClass(e.placement);
        y.addClass("clockpicker-align-" + e.align);
        this.spanHours.click(n.proxy(this.toggleView, this, "hours"));
        this.spanMinutes.click(n.proxy(this.toggleView, this, "minutes"));
        c.on("focus.clockpicker click.clockpicker", n.proxy(this.show, this));
        a.on("click.clockpicker", n.proxy(this.toggle, this));
        for (w = n('<div class="clockpicker-tick"><\/div>'), c = 0; 24 > c; c += 1) {
            a = w.clone();
            d = c / 6 * Math.PI;
            it = 0 < c && 13 > c;
            rt = it ? 54 : 80;
            a.css({left: 100 + Math.sin(d) * rt - 13, top: 87 - Math.cos(d) * rt});
            it && a.css("font-size", "120%");
            a.html(0 === c ? "00" : c);
            p.append(a);
            a.on(o, tt)
        }
        for (c = 0; 60 > c; c += 5)a = w.clone(), d = c / 30 * Math.PI, a.css({left: 100 + 80 * Math.sin(d) - 13, top: 87 - 80 * Math.cos(d)}), a.css("font-size", "120%"), a.html(r(c)), b.append(a), a.on(o, tt);
        g.on(o, function (t) {
            0 === n(t.target).closest(".clockpicker-tick").length && tt(t, !0)
        });
        u && (nt = y.find(".clockpicker-canvas"), y = document.createElementNS("http://www.w3.org/2000/svg", "svg"), y.setAttribute("class", "clockpicker-svg"), y.setAttribute("width", 200), y.setAttribute("height", 200), p = document.createElementNS("http://www.w3.org/2000/svg", "g"), p.setAttribute("transform", "translate(100,100)"), b = document.createElementNS("http://www.w3.org/2000/svg", "circle"), b.setAttribute("class", "clockpicker-canvas-bearing"), b.setAttribute("cx", 0), b.setAttribute("cy", 0), b.setAttribute("r", 2), w = document.createElementNS("http://www.w3.org/2000/svg", "line"), w.setAttribute("x1", 0), w.setAttribute("y1", 0), c = document.createElementNS("http://www.w3.org/2000/svg", "circle"), c.setAttribute("class", "clockpicker-canvas-bg"), c.setAttribute("r", 13), a = document.createElementNS("http://www.w3.org/2000/svg", "circle"), a.setAttribute("class", "clockpicker-canvas-fg"), a.setAttribute("r", 3.5), p.appendChild(w), p.appendChild(c), p.appendChild(a), p.appendChild(b), y.appendChild(p), nt.append(y), this.hand = w, this.bg = c, this.fg = a, this.bearing = b, this.g = p, this.canvas = nt)
    }

    var n = window.jQuery, c = n(window), i = n(document), f, u = "SVGAngle"in window && function () {
        var t, n = document.createElement("div");
        return n.innerHTML = "<svg/>", t = "http://www.w3.org/2000/svg" == (n.firstChild && n.firstChild.namespaceURI), n.innerHTML = "", t
    }(), y = function () {
        var n = document.createElement("div").style;
        return"transition"in n || "WebkitTransition"in n || "MozTransition"in n || "msTransition"in n || "OTransition"in n
    }(), e = "ontouchstart"in window, o = "mousedown" + (e ? " touchstart" : ""), s = "mousemove.clockpicker" + (e ? " touchmove.clockpicker" : ""), l = "mouseup.clockpicker" + (e ? " touchend.clockpicker" : ""), a = navigator.vibrate ? "vibrate" : navigator.webkitVibrate ? "webkitVibrate" : null, p = 0, h = y ? 350 : 1;
    t.DEFAULTS = {"default": "", fromnow: 0, placement: "bottom", align: "left", donetext: "完成", autoclose: !1, vibrate: !0};
    t.prototype.toggle = function () {
        this[this.isShown ? "hide" : "show"]()
    };
    t.prototype.locate = function () {
        var r = this.element, i = this.popover, t = r.offset(), u = r.outerWidth(), r = r.outerHeight(), f = this.options.placement, e = this.options.align, n = {};
        i.show();
        switch (f) {
            case"bottom":
                n.top = t.top + r;
                break;
            case"right":
                n.left = t.left + u;
                break;
            case"top":
                n.top = t.top - i.outerHeight();
                break;
            case"left":
                n.left = t.left - i.outerWidth()
        }
        switch (e) {
            case"left":
                n.left = t.left;
                break;
            case"right":
                n.left = t.left + u - i.outerWidth();
                break;
            case"top":
                n.top = t.top;
                break;
            case"bottom":
                n.top = t.top + r - i.outerHeight()
        }
        i.css(n)
    };
    t.prototype.show = function (t) {
        if (!this.isShown) {
            var u = this;
            this.isAppended || (f = n(document.body).append(this.popover), c.on("resize.clockpicker" + this.id, function () {
                u.isShown && u.locate()
            }), this.isAppended = !0);
            t = ((this.input.prop("value") || this.options["default"] || "") + "").split(":");
            "now" === t[0] && (t = new Date(+new Date + this.options.fromnow), t = [t.getHours(), t.getMinutes()]);
            this.hours = +t[0] || 0;
            this.minutes = +t[1] || 0;
            this.spanHours.html(r(this.hours));
            this.spanMinutes.html(r(this.minutes));
            "function" == typeof this.options.beforeShow && this.options.beforeShow.apply(this);
            this.toggleView("hours");
            this.locate();
            this.isShown = !0;
            i.on("click.clockpicker." + this.id + " focusin.clockpicker." + this.id, function (t) {
                t = n(t.target);
                0 === t.closest(u.popover).length && 0 === t.closest(u.addon).length && 0 === t.closest(u.input).length && u.hide()
            });
            i.on("keyup.clockpicker." + this.id, function (n) {
                27 === n.keyCode && u.hide()
            });
            "function" == typeof this.options.afterShow && this.options.afterShow.apply(this)
        }
    };
    t.prototype.hide = function () {
        this.isShown = !1;
        i.off("click.clockpicker." + this.id + " focusin.clockpicker." + this.id);
        i.off("keyup.clockpicker." + this.id);
        this.popover.hide()
    };
    t.prototype.toggleView = function (n, t) {
        var i = "hours" === n, u = i ? this.hoursView : this.minutesView, r = i ? this.minutesView : this.hoursView;
        this.currentView = n;
        this.spanHours.toggleClass("text-primary", i);
        this.spanMinutes.toggleClass("text-primary", !i);
        r.addClass("clockpicker-dial-out");
        u.css("visibility", "visible").removeClass("clockpicker-dial-out");
        this.resetClock(t);
        clearTimeout(this.toggleViewTimer);
        this.toggleViewTimer = setTimeout(function () {
            r.css("visibility", "hidden")
        }, h)
    };
    t.prototype.resetClock = function (n) {
        var i = this.currentView, t = this[i], f = "hours" === i, i = Math.PI / (f ? 6 : 30) * t, t = f && 0 < t && 13 > t ? 54 : 80, e = Math.sin(i) * t, o = -Math.cos(i) * t, r = this;
        u && n ? (r.canvas.addClass("clockpicker-canvas-out"), setTimeout(function () {
            r.canvas.removeClass("clockpicker-canvas-out");
            r.setHand(e, o)
        }, n)) : this.setHand(e, o)
    };
    t.prototype.setHand = function (t, i, f, e) {
        var s = Math.atan2(t, -i), h = "hours" === this.currentView, c = Math.PI / (h || f ? 6 : 30), o;
        t = Math.sqrt(t * t + i * i);
        t = (i = h && 67 > t) ? 54 : 80;
        0 > s && (s = 2 * Math.PI + s);
        o = Math.round(s / c);
        s = o * c;
        h ? (12 === o && (o = 0), o = i ? 0 === o ? 12 : o : 0 === o ? 0 : o + 12) : (f && (o *= 5), 60 === o && (o = 0));
        this[this.currentView] !== o && a && this.options.vibrate && !this.vibrateTimer && (navigator[a](10), this.vibrateTimer = setTimeout(n.proxy(function () {
            this.vibrateTimer = null
        }, this), 100));
        this[this.currentView] = o;
        this[h ? "spanHours" : "spanMinutes"].html(r(o));
        u ? (e || !h && o % 5 ? (this.g.insertBefore(this.hand, this.bearing), this.g.insertBefore(this.bg, this.fg), this.bg.setAttribute("class", "clockpicker-canvas-bg clockpicker-canvas-bg-trans")) : (this.g.insertBefore(this.hand, this.bg), this.g.insertBefore(this.fg, this.bg), this.bg.setAttribute("class", "clockpicker-canvas-bg")), f = Math.sin(s) * t, s = -Math.cos(s) * t, this.hand.setAttribute("x2", f), this.hand.setAttribute("y2", s), this.bg.setAttribute("cx", f), this.bg.setAttribute("cy", s), this.fg.setAttribute("cx", f), this.fg.setAttribute("cy", s)) : this[h ? "hoursView" : "minutesView"].find(".clockpicker-tick").each(function () {
            var t = n(this);
            t.toggleClass("active", o === +t.html())
        })
    };
    t.prototype.done = function () {
        this.hide();
        var t = this.input.prop("value"), n = r(this.hours) + ":" + r(this.minutes);
        this.input.prop("value", n);
        n !== t && (this.input.triggerHandler("change"), this.isInput || this.element.trigger("change"))
    };
    t.prototype.remove = function () {
        this.element.removeData("clockpicker");
        this.input.off("focus.clockpicker click.clockpicker");
        this.addon.off("click.clockpicker");
        this.isShown && this.hide();
        this.isAppended && (c.off("resize.clockpicker" + this.id), this.popover.remove())
    };
    n.fn.clockpicker = function (i) {
        var r = Array.prototype.slice.call(arguments, 1);
        return this.each(function () {
            var f = n(this), u = f.data("clockpicker");
            u ? "function" == typeof u[i] && u[i].apply(u, r) : (u = n.extend({}, t.DEFAULTS, f.data(), "object" == typeof i && i), f.data("clockpicker", new t(f, u)))
        })
    }
}(), function () {
    function tt(n, t) {
        if (!t || "function" == typeof t)return n;
        for (var i in t)n[i] = t[i];
        return n
    }

    function it(n, t, i) {
        var r, u = 0, f = n.length, e = void 0 === f || "[object Array]" !== Object.prototype.toString.apply(n) || "function" == typeof n;
        if (i)if (e) {
            for (r in n)if (!1 === t.apply(n[r], i))break
        } else for (; u < f && !1 !== t.apply(n[u++], i);); else if (e) {
            for (r in n)if (!1 === t.call(n[r], r, n[r]))break
        } else for (; u < f && !1 !== t.call(n[u], u, n[u++]););
        return n
    }

    function rt(n) {
        var i = function (n) {
            if (window.XMLHttpRequest)return n(null, new XMLHttpRequest);
            if (window.ActiveXObject)try {
                return n(null, new ActiveXObject("Msxml2.XMLHTTP"))
            } catch (t) {
                return n(null, new ActiveXObject("Microsoft.XMLHTTP"))
            }
            return n(Error())
        }, r = function (n) {
            if ("string" == typeof n)return n;
            var i = [];
            for (var t in n)n.hasOwnProperty(t) && i.push(encodeURIComponent(t) + "=" + encodeURIComponent(n[t]));
            return i.join("&")
        }, u = function () {
            for (var t, i, r = arguments[0], n = 1; n < arguments.length; n++) {
                t = arguments[n];
                for (i in t)t.hasOwnProperty(i) && (r[i] = t[i])
            }
            return r
        }, t = function (n, f, e, o) {
            var h, c, s, l;
            if ("function" == typeof e && (o = e, e = {}), e.cache = e.cache || !1, e.data = e.data || {}, e.headers = e.headers || {}, e.jsonp = e.jsonp || !1, e.async = void 0 === e.async ? !0 : e.async, h = u({accept: "*/*", "content-type": "application/x-www-form-urlencoded;charset=UTF-8"}, t.headers, e.headers), c = "application/json" === h["content-type"] ? JSON.stringify(e.data) : r(e.data), "GET" === n && (s = [], c && (s.push(c), c = null), e.cache || s.push("_=" + (new Date).getTime()), e.jsonp && (s.push("callback=" + e.jsonp), s.push("jsonp=" + e.jsonp)), s = s.join("&"), 1 < s.length && (f = -1 < f.indexOf("?") ? f + ("&" + s) : f + ("?" + s)), e.jsonp)) {
                s = document.getElementsByTagName("head")[0];
                l = document.createElement("script");
                l.type = "text/javascript";
                l.src = f;
                s.appendChild(l);
                return
            }
            i(function (t, i) {
                if (t)return o(t);
                i.open(n, f, e.async);
                for (var r in h)h.hasOwnProperty(r) && i.setRequestHeader(r, h[r]);
                i.onreadystatechange = function () {
                    if (4 === i.readyState) {
                        var n = i.responseText || "";
                        o && o(i.status, {text: function () {
                            return n
                        }, json: function () {
                            return JSON.parse(n)
                        }})
                    }
                };
                i.send(c)
            })
        };
        ({authBasic: function (n, i) {
            var a = t.headers, u, e, r, f, o, l, c, h, s;
            for (u = n + ":" + i, u = u.replace(/\r\n/g, "\n"), f = "", e = 0; e < u.length; e++)r = u.charCodeAt(e), 128 > r ? f += String.fromCharCode(r) : (127 < r && 2048 > r ? f += String.fromCharCode(r >> 6 | 192) : (f += String.fromCharCode(r >> 12 | 224), f += String.fromCharCode(r >> 6 & 63 | 128)), f += String.fromCharCode(r & 63 | 128));
            u = f;
            f = "";
            s = 0;
            do o = u.charCodeAt(s++), e = u.charCodeAt(s++), r = u.charCodeAt(s++), l = o >> 2, o = (o & 3) << 4 | e >> 4, c = (e & 15) << 2 | r >> 6, h = r & 63, isNaN(e) ? c = h = 64 : isNaN(r) && (h = 64), f += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c) + "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h); while (s < u.length);
            a.Authorization = "Basic " + f
        }, connect: function (n, i, r) {
            return t("CONNECT", n, i, r)
        }, del: function (n, i, r) {
            return t("DELETE", n, i, r)
        }, get: function (n, i, r) {
            return t("GET", n, i, r)
        }, head: function (n, i, r) {
            return t("HEAD", n, i, r)
        }, headers: function (n) {
            t.headers = n || {}
        }, isAllowed: function (n, t, i) {
            this.options(n, function (n, r) {
                i(-1 !== r.text().indexOf(t))
            })
        }, options: function (n, i, r) {
            return t("OPTIONS", n, i, r)
        }, patch: function (n, i, r) {
            return t("PATCH", n, i, r)
        }, post: function (n, i, r) {
            return t("POST", n, i, r)
        }, put: function (n, i, r) {
            return t("PUT", n, i, r)
        }, trace: function (n, i, r) {
            return t("TRACE", n, i, r)
        }})[n.type ? n.type.toLowerCase() : "get"](n.url, n, function (t, i) {
            200 === t ? n.success(i.json(), t, null) : n.error(i.text(), t, null)
        })
    }

    function y(f, o) {
        var c, l, v, y, b;
        if ("function" == typeof f && (o = f, f = {}), f = f || {}, t.extend(n, f), delete n.fixLng, "string" == typeof n.ns && (n.ns = {namespaces: [n.ns], defaultNs: n.ns}), "string" == typeof n.fallbackNS && (n.fallbackNS = [n.fallbackNS]), ("string" == typeof n.fallbackLng || "boolean" == typeof n.fallbackLng) && (n.fallbackLng = [n.fallbackLng]), n.interpolationPrefixEscaped = t.regexEscape(n.interpolationPrefix), n.interpolationSuffixEscaped = t.regexEscape(n.interpolationSuffix), n.lng || (n.lng = t.detectLanguage()), n.lng ? n.useCookie && t.cookie.create(n.cookieName, n.lng, n.cookieExpirationTime, n.cookieDomain) : (n.lng = n.fallbackLng[0], n.useCookie && t.cookie.remove(n.cookieName)), a = t.toLanguages(n.lng), h = a[0], t.log("currentLng set to: " + h), c = s, f.fixLng && (c = function (n, t) {
            return t = t || {}, t.lng = t.lng || c.lng, s(n, t)
        }, c.lng = h), e.setCurrentLng(h), i && n.setJqueryExt && ut(), i && i.Deferred && (l = i.Deferred()), n.resStore)u = n.resStore, k = !0, o && o(c), l && l.resolve(c); else {
            for (v = t.toLanguages(n.lng), "string" == typeof n.preload && (n.preload = [n.preload]), y = 0, b = n.preload.length; y < b; y++)for (var w = t.toLanguages(n.preload[y]), p = 0, d = w.length; p < d; p++)0 > v.indexOf(w[p]) && v.push(w[p]);
            r.sync.load(v, n, function (n, t) {
                u = t;
                k = !0;
                o && o(c);
                l && l.resolve(c)
            })
        }
        if (l)return l.promise()
    }

    function g(i, f) {
        var y = {dynamicLoad: n.dynamicLoad, resGetPath: n.resGetPath, getAsync: n.getAsync, customLoad: n.customLoad, ns: {namespaces: i, defaultNs: ""}}, h = t.toLanguages(n.lng), e, a, c, v;
        for ("string" == typeof n.preload && (n.preload = [n.preload]), e = 0, a = n.preload.length; e < a; e++)for (var o = t.toLanguages(n.preload[e]), s = 0, c = o.length; s < c; s++)0 > h.indexOf(o[s]) && h.push(o[s]);
        for (var l = [], e = 0, a = h.length; e < a; e++) {
            if (o = !1, s = u[h[e]])for (c = 0, v = i.length; c < v; c++)s[i[c]] || (o = !0); else o = !0;
            o && l.push(h[e])
        }
        l.length ? r.sync._fetch(l, y, function (e, o) {
            var s = i.length * l.length;
            t.each(i, function (i, e) {
                0 > n.ns.namespaces.indexOf(e) && n.ns.namespaces.push(e);
                t.each(l, function (t, i) {
                    u[i] = u[i] || {};
                    u[i][e] = o[i][e];
                    s--;
                    0 === s && f && (n.useLocalStorage && r.sync._storeLocal(u), f())
                })
            })
        }) : f && f()
    }

    function ut() {
        function t(t, r, u) {
            var f, e;
            0 !== r.length && (f = "text", 0 === r.indexOf("[") && (f = r.split("]"), r = f[1], f = f[0].substr(1, f[0].length - 1)), r.indexOf(";") === r.length - 1 && (r = r.substr(0, r.length - 2)), "html" === f ? (u = n.defaultValueFromContent ? i.extend({defaultValue: t.html()}, u) : u, t.html(i.t(r, u))) : "text" === f ? (u = n.defaultValueFromContent ? i.extend({defaultValue: t.text()}, u) : u, t.text(i.t(r, u))) : "prepend" === f ? (u = n.defaultValueFromContent ? i.extend({defaultValue: t.html()}, u) : u, t.prepend(i.t(r, u))) : "append" === f ? (u = n.defaultValueFromContent ? i.extend({defaultValue: t.html()}, u) : u, t.append(i.t(r, u))) : 0 === f.indexOf("data-") ? (e = f.substr(5), u = n.defaultValueFromContent ? i.extend({defaultValue: t.data(e)}, u) : u, r = i.t(r, u), t.data(e, r), t.attr(f, r)) : (u = n.defaultValueFromContent ? i.extend({defaultValue: t.attr(f)}, u) : u, t.attr(f, i.t(r, u))))
        }

        function r(r, u) {
            var f = r.attr(n.selectorAttr), e, o;
            f || "undefined" == typeof f || !1 === f || (f = r.text() || r.val());
            f && (e = r, o = r.data("i18n-target"), o && (e = r.find(o) || r), u || !0 !== n.useDataAttrOptions || (u = r.data("i18n-options")), u = u || {}, 0 <= f.indexOf(";") ? (f = f.split(";"), i.each(f, function (n, i) {
                "" !== i && t(e, i, u)
            })) : t(e, f, u), !0 === n.useDataAttrOptions && r.data("i18n-options", u))
        }

        i.t = i.t || s;
        i.fn.i18n = function (t) {
            return this.each(function () {
                r(i(this), t);
                i(this).find("[" + n.selectorAttr + "]").each(function () {
                    r(i(this), t)
                })
            })
        }
    }

    function f(i, r, u, e) {
        if (!i || (e = e || r, 0 > i.indexOf(e.interpolationPrefix || n.interpolationPrefix)))return i;
        var o = e.interpolationPrefix ? t.regexEscape(e.interpolationPrefix) : n.interpolationPrefixEscaped, s = e.interpolationSuffix ? t.regexEscape(e.interpolationSuffix) : n.interpolationSuffixEscaped, h = "HTML" + s;
        return t.each(r, function (r, c) {
            var l = u ? u + n.keyseparator + r : r;
            "object" == typeof c && null !== c ? i = f(i, c, l, e) : e.escapeInterpolation || n.escapeInterpolation ? (i = i.replace(new RegExp([o, l, h].join(""), "g"), c), i = i.replace(new RegExp([o, l, s].join(""), "g"), t.escape(c))) : i = i.replace(new RegExp([o, l, s].join(""), "g"), c)
        }), i
    }

    function p(i, r) {
        var e = t.extend({}, r), f, s, h;
        for (delete e.postProcess; -1 != i.indexOf(n.reusePrefix);) {
            if (b++, b > n.maxRecursion)break;
            var o = i.lastIndexOf(n.reusePrefix), u = i.indexOf(n.reuseSuffix, o) + n.reuseSuffix.length, o = i.substring(o, u), u = o.replace(n.reusePrefix, "").replace(n.reuseSuffix, "");
            if (-1 != u.indexOf(",") && (f = u.indexOf(","), -1 != u.indexOf("{", f) && -1 != u.indexOf("}", f))) {
                s = u.indexOf("{", f);
                h = u.indexOf("}", s) + 1;
                try {
                    e = t.extend(e, JSON.parse(u.substring(s, h)));
                    u = u.substring(0, f)
                } catch (c) {
                }
            }
            u = w(u, e);
            i = i.replace(o, u)
        }
        return i
    }

    function nt(n, t) {
        t = t || {};
        var r = void 0 !== t.defaultValue ? t.defaultValue : n, i = l(n, t);
        return void 0 !== i || i === r
    }

    function s(n, t) {
        return(t = t || {}, !k) ? n || "" : (b = 0, w.apply(null, arguments))
    }

    function ft() {
        for (var t = [], n = 1; n < arguments.length; n++)t.push(arguments[n]);
        return{postProcess: "sprintf", sprintf: t}
    }

    function w(i, r) {
        var e, u;
        if (r && "object" != typeof r ? "sprintf" === n.shortcutFunction ? r = ft.apply(null, arguments) : "defaultValue" === n.shortcutFunction && (r = {defaultValue: r}) : r = r || {}, void 0 === i || null === i)return"";
        if ("string" == typeof i && (i = [i]), e = i[0], 1 < i.length)for (u = 0; u < i.length && (e = i[u], !nt(e, r)); u++);
        var u = void 0 !== r.defaultValue ? r.defaultValue : e, h = l(e, r), s = r.lng ? t.toLanguages(r.lng) : a, y = r.ns || n.ns.defaultNs, v;
        return-1 < e.indexOf(n.nsseparator) && (v = e.split(n.nsseparator), y = v[0], e = v[1]), void 0 === h && n.sendMissing && (r.lng ? o.postMissing(s[0], y, e, u, s) : o.postMissing(n.lng, y, e, u, s)), s = r.postProcess || n.postProcess, void 0 !== h && s && c[s] && (h = c[s](h, e, r)), v = u, -1 < u.indexOf(n.nsseparator) && (v = u.split(n.nsseparator), v = v[1]), v === e && n.parseMissingKey && (u = n.parseMissingKey(u)), void 0 === h && (u = f(u, r), u = p(u, r), s && c[s] && (h = c[s](void 0 !== r.defaultValue ? r.defaultValue : e, e, r))), void 0 !== h ? h : u
    }

    function l(i, o) {
        var c, g, y, rt, k, b, d, v, it;
        if (o = o || {}, g = void 0 !== o.defaultValue ? o.defaultValue : i, y = a, !u || "cimode" === y[0].toLowerCase())return g;
        if (o.lng && (y = t.toLanguages(o.lng), !u[y[0]]) && (rt = n.getAsync, n.getAsync = !1, r.sync.load(y, n, function (i, r) {
            t.extend(u, r);
            n.getAsync = rt
        })), k = o.ns || n.ns.defaultNs, -1 < i.indexOf(n.nsseparator) && (c = i.split(n.nsseparator), k = c[0], i = c[1]), o.context && ("string" == typeof o.context || "number" == typeof o.context) && (c = t.extend({}, o), delete c.context, c.defaultValue = n.contextNotFound, c = s(k + n.nsseparator + i + "_" + o.context, c), c != n.contextNotFound))return f(c, {context: o.context});
        if (void 0 !== o.count && "string" != typeof o.count && 1 !== o.count && (c = t.extend({}, o), delete c.count, c.defaultValue = n.pluralNotFound, b = k + n.nsseparator + i + n.pluralSuffix, d = e.get(y[0], o.count), 0 <= d ? b = b + "_" + d : 1 === d && (b = k + n.nsseparator + i), c = s(b, c), c != n.pluralNotFound))return f(c, {count: o.count, interpolationPrefix: o.interpolationPrefix, interpolationSuffix: o.interpolationSuffix});
        for (c = i.split(n.keyseparator), b = 0, d = y.length; b < d && void 0 === v; b++) {
            for (var nt = y[b], tt = 0, h = u[nt] && u[nt][k]; c[tt];)h = h && h[c[tt]], tt++;
            void 0 !== h && (v = Object.prototype.toString.apply(h), "string" == typeof h ? (h = f(h, o), h = p(h, o)) : "[object Array]" !== v || n.returnObjectTrees || o.returnObjectTrees ? null === h && !0 === n.fallbackOnNull ? h = void 0 : null !== h && (n.returnObjectTrees || o.returnObjectTrees ? "[object Number]" !== v && "[object Function]" !== v && "[object RegExp]" !== v && (it = "[object Array]" === v ? [] : {}, t.each(h, function (t) {
                it[t] = w(k + n.nsseparator + i + n.keyseparator + t, o)
            }), h = it) : n.objectTreeKeyHandler && "function" == typeof n.objectTreeKeyHandler ? h = n.objectTreeKeyHandler(i, h, nt, k, o) : (h = "key '" + k + ":" + i + " (" + nt + ")' returned an object instead of string.", t.log(h))) : (h = h.join("\n"), h = f(h, o), h = p(h, o)), "string" == typeof h && "" === h.trim() && !0 === n.fallbackOnEmpty && (h = void 0), v = h)
        }
        if (void 0 === v && !o.isFallbackLookup && (!0 === n.fallbackToDefaultNS || n.fallbackNS && 0 < n.fallbackNS.length))if (o.isFallbackLookup = !0, n.fallbackNS.length) {
            for (y = 0, c = n.fallbackNS.length; y < c; y++)if ((v = l(n.fallbackNS[y] + n.nsseparator + i, o)) && (b = -1 < v.indexOf(n.nsseparator) ? v.split(n.nsseparator)[1] : v, d = -1 < g.indexOf(n.nsseparator) ? g.split(n.nsseparator)[1] : g, b !== d))break
        } else v = l(i, o);
        return v
    }

    Array.prototype.indexOf || (Array.prototype.indexOf = function (n) {
        var r, i, t;
        if (null == this)throw new TypeError;
        if ((r = Object(this), i = r.length >>> 0, 0 === i) || (t = 0, 0 < arguments.length && (t = Number(arguments[1]), t != t ? t = 0 : 0 != t && Infinity != t && -Infinity != t && (t = (0 < t || -1) * Math.floor(Math.abs(t)))), t >= i))return-1;
        for (t = 0 <= t ? t : Math.max(i - Math.abs(t), 0); t < i; t++)if (t in r && r[t] === n)return t;
        return-1
    });
    Array.prototype.lastIndexOf || (Array.prototype.lastIndexOf = function (n) {
        var r, i, t;
        if (null == this)throw new TypeError;
        if (r = Object(this), i = r.length >>> 0, 0 === i)return-1;
        for (t = i, 1 < arguments.length && (t = Number(arguments[1]), t != t ? t = 0 : 0 != t && t != 1 / 0 && t != -(1 / 0) && (t = (0 < t || -1) * Math.floor(Math.abs(t)))), i = 0 <= t ? Math.min(t, i - 1) : i - Math.abs(t); 0 <= i; i--)if (i in r && r[i] === n)return i;
        return-1
    });
    "function" != typeof String.prototype.trim && (String.prototype.trim = function () {
        return this.replace(/^\s+|\s+$/g, "")
    });
    var i = this.jQuery || this.Zepto, r = {}, u = {}, h, b = 0, a = [], k = !1;
    "undefined" != typeof module && module.exports ? module.exports = r : (i && (i.i18n = i.i18n || r), this.i18n = this.i18n || r);
    var n = {lng: void 0, load: "all", preload: [], lowerCaseLng: !1, returnObjectTrees: !1, fallbackLng: ["dev"], fallbackNS: [], detectLngQS: "setLng", ns: "translation", fallbackOnNull: !0, fallbackOnEmpty: !1, fallbackToDefaultNS: !1, nsseparator: ":", keyseparator: ".", selectorAttr: "data-i18n", debug: !1, resGetPath: "locales/__lng__/__ns__.json", resPostPath: "locales/add/__lng__/__ns__", getAsync: !0, postAsync: !0, resStore: void 0, useLocalStorage: !1, localStorageExpirationTime: 6048e5, dynamicLoad: !1, sendMissing: !1, sendMissingTo: "fallback", sendType: "POST", interpolationPrefix: "__", interpolationSuffix: "__", reusePrefix: "$t(", reuseSuffix: ")", pluralSuffix: "_plural", pluralNotFound: ["plural_not_found", Math.random()].join(""), contextNotFound: ["context_not_found", Math.random()].join(""), escapeInterpolation: !1, setJqueryExt: !0, defaultValueFromContent: !0, useDataAttrOptions: !1, cookieExpirationTime: void 0, useCookie: !0, cookieName: "i18next", cookieDomain: void 0, objectTreeKeyHandler: void 0, postProcess: void 0, parseMissingKey: void 0, shortcutFunction: "sprintf"}, et = {"&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;", "/": "&#x2F;"}, d = {create: function (n, t, i, r) {
        if (i) {
            var u = new Date;
            u.setTime(u.getTime() + 6e4 * i);
            i = "; expires=" + u.toGMTString()
        } else i = "";
        document.cookie = n + "=" + t + i + ";" + (r ? "domain=" + r + ";" : "") + "path=/"
    }, read: function (n) {
        var r, i, t;
        for (n += "=", r = document.cookie.split(";"), i = 0; i < r.length; i++) {
            for (t = r[i]; " " == t.charAt(0);)t = t.substring(1, t.length);
            if (0 === t.indexOf(n))return t.substring(n.length, t.length)
        }
        return null
    }, remove: function (n) {
        this.create(n, "", -1)
    }}, ot = {create: function () {
    }, read: function () {
        return null
    }, remove: function () {
    }}, t = {extend: i ? i.extend : tt, each: i ? i.each : it, ajax: i ? i.ajax : "undefined" != typeof document ? rt : function () {
    }, cookie: "undefined" != typeof document ? d : ot, detectLanguage: function () {
        var i, f = [], e, r, o, u;
        if ("undefined" != typeof window) {
            for (e = window.location.search.substring(1).split("&"), r = 0; r < e.length; r++)u = e[r].indexOf("="), 0 < u && (o = e[r].substring(0, u), u = e[r].substring(u + 1), f[o] = u);
            f[n.detectLngQS] && (i = f[n.detectLngQS])
        }
        return!i && "undefined" != typeof document && n.useCookie && (f = t.cookie.read(n.cookieName)) && (i = f), i || "undefined" == typeof navigator || (i = navigator.language ? navigator.language : navigator.userLanguage), i
    }, escape: function (n) {
        return"string" == typeof n ? n.replace(/[&<>"'\/]/g, function (n) {
            return et[n]
        }) : n
    }, log: function (t) {
        n.debug && "undefined" != typeof console && console.log(t)
    }, toLanguages: function (t) {
        var i = [], r;
        for ("string" == typeof t && -1 < t.indexOf("-") ? (r = t.split("-"), t = n.lowerCaseLng ? r[0].toLowerCase() + "-" + r[1].toLowerCase() : r[0].toLowerCase() + "-" + r[1].toUpperCase(), "unspecific" !== n.load && i.push(t), "current" !== n.load && i.push(r[0])) : i.push(t), t = 0; t < n.fallbackLng.length; t++)-1 === i.indexOf(n.fallbackLng[t]) && n.fallbackLng[t] && i.push(n.fallbackLng[t]);
        return i
    }, regexEscape: function (n) {
        return n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")
    }};
    t.applyReplacement = f;
    var o = {load: function (n, i, r) {
        i.useLocalStorage ? o._loadLocal(n, i, function (u, f) {
            for (var s = [], e = 0, h = n.length; e < h; e++)f[n[e]] || s.push(n[e]);
            0 < s.length ? o._fetch(s, i, function (n, i) {
                t.extend(f, i);
                o._storeLocal(i);
                r(null, f)
            }) : r(null, f)
        }) : o._fetch(n, i, function (n, t) {
            r(null, t)
        })
    }, _loadLocal: function (n, i, r) {
        var f = {}, e = (new Date).getTime(), u;
        window.localStorage && (u = n.length, t.each(n, function (n, t) {
            var o = window.localStorage.getItem("res_" + t);
            o && (o = JSON.parse(o), o.i18nStamp && o.i18nStamp + i.localStorageExpirationTime > e && (f[t] = o));
            u--;
            0 === u && r(null, f)
        }))
    }, _storeLocal: function (n) {
        if (window.localStorage)for (var t in n)n[t].i18nStamp = (new Date).getTime(), window.localStorage.setItem("res_" + t, JSON.stringify(n[t]))
    }, _fetch: function (n, i, r) {
        var u = i.ns, e = {}, l, s, c, h;
        i.dynamicLoad ? (l = function (n, t) {
            r(null, t)
        }, "function" == typeof i.customLoad ? i.customLoad(n, u.namespaces, i, l) : (s = f(i.resGetPath, {lng: n.join("+"), ns: u.namespaces.join("+")}), t.ajax({url: s, success: function (n) {
            t.log("loaded: " + s);
            r(null, n)
        }, error: function () {
            t.log("failed loading: " + s);
            r(null, void 0)
        }, dataType: "json", async: i.getAsync}))) : (c = u.namespaces.length * n.length, t.each(u.namespaces, function (u, f) {
            t.each(n, function (n, t) {
                var u = function (n, i) {
                    n && (h = h || [], h.push(n));
                    e[t] = e[t] || {};
                    e[t][f] = i;
                    c--;
                    0 === c && r(h, e)
                };
                "function" == typeof i.customLoad ? i.customLoad(t, f, i, u) : o._fetchOne(t, f, i, u)
            })
        }))
    }, _fetchOne: function (n, i, r, u) {
        var e = f(r.resGetPath, {lng: n, ns: i});
        t.ajax({url: e, success: function (n) {
            t.log("loaded: " + e);
            u(null, n)
        }, error: function (n, i, r) {
            i && 200 == i || n && n.status && 200 == n.status ? t.log("There is a typo in: " + e) : i && 404 == i || n && n.status && 404 == n.status ? t.log("Does not exist: " + e) : t.log((i ? i : n && n.status ? n.status : null) + " when loading " + e);
            u(r, {})
        }, dataType: "json", async: r.getAsync})
    }, postMissing: function (i, r, e, o, s) {
        var l = {}, h, a, c;
        if (l[e] = o, h = [], "fallback" === n.sendMissingTo && !1 !== n.fallbackLng[0])for (i = 0; i < n.fallbackLng.length; i++)h.push({lng: n.fallbackLng[i], url: f(n.resPostPath, {lng: n.fallbackLng[i], ns: r})}); else if ("current" === n.sendMissingTo || "fallback" === n.sendMissingTo && !1 === n.fallbackLng[0])h.push({lng: i, url: f(n.resPostPath, {lng: i, ns: r})}); else if ("all" === n.sendMissingTo)for (i = 0, a = s.length; i < a; i++)h.push({lng: s[i], url: f(n.resPostPath, {lng: s[i], ns: r})});
        for (s = 0, i = h.length; s < i; s++)c = h[s], t.ajax({url: c.url, type: n.sendType, data: l, success: function (n, i, f) {
            for (t.log("posted missing key '" + e + "' to: " + c.url), n = e.split("."), i = 0, f = u[c.lng][r]; n[i];)f = f[n[i]] = i === n.length - 1 ? o : f[n[i]] || {}, i++
        }, error: function () {
            t.log("failed posting missing key '" + e + "' to: " + c.url)
        }, dataType: "json", async: n.postAsync})
    }}, e = {rules: {ach: {name: "Acholi", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, af: {name: "Afrikaans", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ak: {name: "Akan", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, am: {name: "Amharic", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, an: {name: "Aragonese", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ar: {name: "Arabic", numbers: [0, 1, 2, 3, 11, 100], plurals: function (n) {
        return Number(0 === n ? 0 : 1 == n ? 1 : 2 == n ? 2 : 3 <= n % 100 && 10 >= n % 100 ? 3 : 11 <= n % 100 ? 4 : 5)
    }}, arn: {name: "Mapudungun", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, ast: {name: "Asturian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ay: {name: "Aymará", numbers: [1], plurals: function () {
        return 0
    }}, az: {name: "Azerbaijani", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, be: {name: "Belarusian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, bg: {name: "Bulgarian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, bn: {name: "Bengali", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, bo: {name: "Tibetan", numbers: [1], plurals: function () {
        return 0
    }}, br: {name: "Breton", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, bs: {name: "Bosnian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, ca: {name: "Catalan", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, cgg: {name: "Chiga", numbers: [1], plurals: function () {
        return 0
    }}, cs: {name: "Czech", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n ? 0 : 2 <= n && 4 >= n ? 1 : 2)
    }}, csb: {name: "Kashubian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, cy: {name: "Welsh", numbers: [1, 2, 3, 8], plurals: function (n) {
        return Number(1 == n ? 0 : 2 == n ? 1 : 8 != n && 11 != n ? 2 : 3)
    }}, da: {name: "Danish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, de: {name: "German", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, dz: {name: "Dzongkha", numbers: [1], plurals: function () {
        return 0
    }}, el: {name: "Greek", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, en: {name: "English", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, eo: {name: "Esperanto", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, es: {name: "Spanish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, es_ar: {name: "Argentinean Spanish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, et: {name: "Estonian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, eu: {name: "Basque", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, fa: {name: "Persian", numbers: [1], plurals: function () {
        return 0
    }}, fi: {name: "Finnish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, fil: {name: "Filipino", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, fo: {name: "Faroese", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, fr: {name: "French", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, fur: {name: "Friulian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, fy: {name: "Frisian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ga: {name: "Irish", numbers: [1, 2, 3, 7, 11], plurals: function (n) {
        return Number(1 == n ? 0 : 2 == n ? 1 : 7 > n ? 2 : 11 > n ? 3 : 4)
    }}, gd: {name: "Scottish Gaelic", numbers: [1, 2, 3, 20], plurals: function (n) {
        return Number(1 == n || 11 == n ? 0 : 2 == n || 12 == n ? 1 : 2 < n && 20 > n ? 2 : 3)
    }}, gl: {name: "Galician", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, gu: {name: "Gujarati", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, gun: {name: "Gun", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, ha: {name: "Hausa", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, he: {name: "Hebrew", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, hi: {name: "Hindi", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, hr: {name: "Croatian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, hu: {name: "Hungarian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, hy: {name: "Armenian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ia: {name: "Interlingua", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, id: {name: "Indonesian", numbers: [1], plurals: function () {
        return 0
    }}, is: {name: "Icelandic", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n % 10 || 11 == n % 100)
    }}, it: {name: "Italian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ja: {name: "Japanese", numbers: [1], plurals: function () {
        return 0
    }}, jbo: {name: "Lojban", numbers: [1], plurals: function () {
        return 0
    }}, jv: {name: "Javanese", numbers: [0, 1], plurals: function (n) {
        return Number(0 !== n)
    }}, ka: {name: "Georgian", numbers: [1], plurals: function () {
        return 0
    }}, kk: {name: "Kazakh", numbers: [1], plurals: function () {
        return 0
    }}, km: {name: "Khmer", numbers: [1], plurals: function () {
        return 0
    }}, kn: {name: "Kannada", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ko: {name: "Korean", numbers: [1], plurals: function () {
        return 0
    }}, ku: {name: "Kurdish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, kw: {name: "Cornish", numbers: [1, 2, 3, 4], plurals: function (n) {
        return Number(1 == n ? 0 : 2 == n ? 1 : 3 == n ? 2 : 3)
    }}, ky: {name: "Kyrgyz", numbers: [1], plurals: function () {
        return 0
    }}, lb: {name: "Letzeburgesch", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ln: {name: "Lingala", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, lo: {name: "Lao", numbers: [1], plurals: function () {
        return 0
    }}, lt: {name: "Lithuanian", numbers: [1, 2, 10], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, lv: {name: "Latvian", numbers: [1, 2, 0], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 0 !== n ? 1 : 2)
    }}, mai: {name: "Maithili", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, mfe: {name: "Mauritian Creole", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, mg: {name: "Malagasy", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, mi: {name: "Maori", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, mk: {name: "Macedonian", numbers: [1, 2], plurals: function (n) {
        return Number(1 == n || 1 == n % 10 ? 0 : 1)
    }}, ml: {name: "Malayalam", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, mn: {name: "Mongolian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, mnk: {name: "Mandinka", numbers: [0, 1, 2], plurals: function (n) {
        return Number(1 == n ? 1 : 2)
    }}, mr: {name: "Marathi", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ms: {name: "Malay", numbers: [1], plurals: function () {
        return 0
    }}, mt: {name: "Maltese", numbers: [1, 2, 11, 20], plurals: function (n) {
        return Number(1 == n ? 0 : 0 === n || 1 < n % 100 && 11 > n % 100 ? 1 : 10 < n % 100 && 20 > n % 100 ? 2 : 3)
    }}, nah: {name: "Nahuatl", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, nap: {name: "Neapolitan", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, nb: {name: "Norwegian Bokmal", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ne: {name: "Nepali", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, nl: {name: "Dutch", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, nn: {name: "Norwegian Nynorsk", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, no: {name: "Norwegian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, nso: {name: "Northern Sotho", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, oc: {name: "Occitan", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, or: {name: "Oriya", numbers: [2, 1], plurals: function (n) {
        return Number(1 != n)
    }}, pa: {name: "Punjabi", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, pap: {name: "Papiamento", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, pl: {name: "Polish", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, pms: {name: "Piemontese", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ps: {name: "Pashto", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, pt: {name: "Portuguese", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, pt_br: {name: "Brazilian Portuguese", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, rm: {name: "Romansh", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ro: {name: "Romanian", numbers: [1, 2, 20], plurals: function (n) {
        return Number(1 == n ? 0 : 0 === n || 0 < n % 100 && 20 > n % 100 ? 1 : 2)
    }}, ru: {name: "Russian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, sah: {name: "Yakut", numbers: [1], plurals: function () {
        return 0
    }}, sco: {name: "Scots", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, se: {name: "Northern Sami", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, si: {name: "Sinhala", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, sk: {name: "Slovak", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n ? 0 : 2 <= n && 4 >= n ? 1 : 2)
    }}, sl: {name: "Slovenian", numbers: [5, 1, 2, 3], plurals: function (n) {
        return Number(1 == n % 100 ? 1 : 2 == n % 100 ? 2 : 3 == n % 100 || 4 == n % 100 ? 3 : 0)
    }}, so: {name: "Somali", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, son: {name: "Songhay", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, sq: {name: "Albanian", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, sr: {name: "Serbian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, su: {name: "Sundanese", numbers: [1], plurals: function () {
        return 0
    }}, sv: {name: "Swedish", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, sw: {name: "Swahili", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, ta: {name: "Tamil", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, te: {name: "Telugu", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, tg: {name: "Tajik", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, th: {name: "Thai", numbers: [1], plurals: function () {
        return 0
    }}, ti: {name: "Tigrinya", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, tk: {name: "Turkmen", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, tr: {name: "Turkish", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, tt: {name: "Tatar", numbers: [1], plurals: function () {
        return 0
    }}, ug: {name: "Uyghur", numbers: [1], plurals: function () {
        return 0
    }}, uk: {name: "Ukrainian", numbers: [1, 2, 5], plurals: function (n) {
        return Number(1 == n % 10 && 11 != n % 100 ? 0 : 2 <= n % 10 && 4 >= n % 10 && (10 > n % 100 || 20 <= n % 100) ? 1 : 2)
    }}, ur: {name: "Urdu", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, uz: {name: "Uzbek", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, vi: {name: "Vietnamese", numbers: [1], plurals: function () {
        return 0
    }}, wa: {name: "Walloon", numbers: [1, 2], plurals: function (n) {
        return Number(1 < n)
    }}, wo: {name: "Wolof", numbers: [1], plurals: function () {
        return 0
    }}, yo: {name: "Yoruba", numbers: [1, 2], plurals: function (n) {
        return Number(1 != n)
    }}, zh: {name: "Chinese", numbers: [1], plurals: function () {
        return 0
    }}}, addRule: function (n, t) {
        e.rules[n] = t
    }, setCurrentLng: function (n) {
        if (!e.currentRule || e.currentRule.lng !== n) {
            var t = n.split("-");
            e.currentRule = {lng: n, rule: e.rules[t[0]]}
        }
    }, get: function (n, t) {
        var i = n.split("-"), r;
        return(i = e.currentRule && e.currentRule.lng === n ? e.currentRule.rule : e.rules[i[0]]) ? (r = i.plurals(t), r = i.numbers[r], 2 === i.numbers.length && 1 === i.numbers[0] && (2 === r ? r = -1 : 1 === r && (r = 1)), i = r) : i = 1 === t ? "1" : "-1", i
    }}, c = {}, d = function (n, t) {
        c[n] = t
    }, v = function () {
        function t(n) {
            return Object.prototype.toString.call(n).slice(8, -1).toLowerCase()
        }

        var n = function () {
            return n.cache.hasOwnProperty(arguments[0]) || (n.cache[arguments[0]] = n.parse(arguments[0])), n.format.call(null, n.cache[arguments[0]], arguments)
        };
        return n.format = function (n, i) {
            for (var c = 1, l = n.length, r = "", o = [], f, u, s, h, e = 0; e < l; e++)if (r = t(n[e]), "string" === r)o.push(n[e]); else if ("array" === r) {
                if (u = n[e], u[2])for (r = i[c], f = 0; f < u[2].length; f++) {
                    if (!r.hasOwnProperty(u[2][f]))throw v('[sprintf] property "%s" does not exist', u[2][f]);
                    r = r[u[2][f]]
                } else r = u[1] ? i[u[1]] : i[c++];
                if (/[^s]/.test(u[8]) && "number" != t(r))throw v("[sprintf] expecting number but found %s", t(r));
                switch (u[8]) {
                    case"b":
                        r = r.toString(2);
                        break;
                    case"c":
                        r = String.fromCharCode(r);
                        break;
                    case"d":
                        r = parseInt(r, 10);
                        break;
                    case"e":
                        r = u[7] ? r.toExponential(u[7]) : r.toExponential();
                        break;
                    case"f":
                        r = u[7] ? parseFloat(r).toFixed(u[7]) : parseFloat(r);
                        break;
                    case"o":
                        r = r.toString(8);
                        break;
                    case"s":
                        r = (r = String(r)) && u[7] ? r.substring(0, u[7]) : r;
                        break;
                    case"u":
                        r = Math.abs(r);
                        break;
                    case"x":
                        r = r.toString(16);
                        break;
                    case"X":
                        r = r.toString(16).toUpperCase()
                }
                if (r = /[def]/.test(u[8]) && u[3] && 0 <= r ? "+" + r : r, f = u[4] ? "0" == u[4] ? "0" : u[4].charAt(1) : " ", s = u[6] - String(r).length, u[6]) {
                    for (h = []; 0 < s; h[--s] = f);
                    f = h.join("")
                } else f = "";
                o.push(u[5] ? r + f : f + r)
            }
            return o.join("")
        }, n.cache = {}, n.parse = function (n) {
            for (var t = [], u = [], e = 0; n;) {
                if (null !== (t = /^[^\x25]+/.exec(n)))u.push(t[0]); else if (null !== (t = /^\x25{2}/.exec(n)))u.push("%"); else if (null !== (t = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(n))) {
                    if (t[2]) {
                        var e = e | 1, f = [], r = t[2], i = [];
                        if (null !== (i = /^([a-z_][a-z_\d]*)/i.exec(r)))for (f.push(i[1]); "" !== (r = r.substring(i[0].length));)if (null !== (i = /^\.([a-z_][a-z_\d]*)/i.exec(r)))f.push(i[1]); else if (null !== (i = /^\[(\d+)\]/.exec(r)))f.push(i[1]); else throw"[sprintf] huh?"; else throw"[sprintf] huh?";
                        t[2] = f
                    } else e |= 2;
                    if (3 === e)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";
                    u.push(t)
                } else throw"[sprintf] huh?";
                n = n.substring(t[0].length)
            }
            return u
        }, n
    }();
    d("sprintf", function (n, t, i) {
        return i.sprintf ? "[object Array]" === Object.prototype.toString.apply(i.sprintf) ? (t = i.sprintf, t.unshift(n), v.apply(null, t)) : "object" == typeof i.sprintf ? v(n, i.sprintf) : n : n
    });
    r.init = y;
    r.setLng = function (n, t, i) {
        return"function" == typeof t ? (i = t, t = {}) : t || (t = {}), t.lng = n, y(t, i)
    };
    r.preload = function (t, i) {
        "string" == typeof t && (t = [t]);
        for (var r = 0, u = t.length; r < u; r++)0 > n.preload.indexOf(t[r]) && n.preload.push(t[r]);
        return y(i)
    };
    r.addResourceBundle = function (i, r, f) {
        "string" != typeof r ? (f = r, r = n.ns.defaultNs) : 0 > n.ns.namespaces.indexOf(r) && n.ns.namespaces.push(r);
        u[i] = u[i] || {};
        u[i][r] = u[i][r] || {};
        t.extend(u[i][r], f)
    };
    r.removeResourceBundle = function (t, i) {
        "string" != typeof i && (i = n.ns.defaultNs);
        u[t] = u[t] || {};
        u[t][i] = {}
    };
    r.loadNamespace = function (n, t) {
        g([n], t)
    };
    r.loadNamespaces = g;
    r.setDefaultNamespace = function (t) {
        n.ns.defaultNs = t
    };
    r.t = s;
    r.translate = s;
    r.exists = nt;
    r.detectLanguage = t.detectLanguage;
    r.pluralExtensions = e;
    r.sync = o;
    r.functions = t;
    r.lng = function () {
        return h
    };
    r.addPostProcessor = d;
    r.options = n
}(), function (n, t) {
    function o(n) {
        return!!("" === n || n && n.charCodeAt && n.substr)
    }

    function u(n) {
        return v ? v(n) : "[object Array]" === y.call(n)
    }

    function s(n) {
        return n && "[object Object]" === y.call(n)
    }

    function h(n, t) {
        var i;
        n = n || {};
        t = t || {};
        for (i in t)t.hasOwnProperty(i) && null == n[i] && (n[i] = t[i]);
        return n
    }

    function r(n, t, i) {
        var u = [], r, f;
        if (!n)return u;
        if (a && n.map === a)return n.map(t, i);
        for (r = 0, f = n.length; r < f; r++)u[r] = t.call(i, n[r], r, n);
        return u
    }

    function f(n, t) {
        return n = Math.round(Math.abs(n)), isNaN(n) ? t : n
    }

    function l(n) {
        var t = i.settings.currency.format;
        return"function" == typeof n && (n = n()), o(n) && n.match("%v") ? {pos: n, neg: n.replace("-", "").replace("%v", "-%v"), zero: n} : n && n.pos && n.pos.match("%v") ? n : o(t) ? i.settings.currency.format = {pos: t, neg: t.replace("%v", "-%v"), zero: t} : t
    }

    var i = {version: "0.4.1", settings: {currency: {symbol: "$", format: "%s%v", decimal: ".", thousand: ",", precision: 2, grouping: 3}, number: {precision: 0, grouping: 3, thousand: ",", decimal: "."}}}, a = Array.prototype.map, v = Array.isArray, y = Object.prototype.toString, e = i.unformat = i.parse = function (n, t) {
        if (u(n))return r(n, function (n) {
            return e(n, t)
        });
        if (n = n || 0, "number" == typeof n)return n;
        t = t || i.settings.number.decimal;
        var f = new RegExp("[^0-9-" + t + "]", ["g"]), f = parseFloat(("" + n).replace(/\((.*)\)/, "-$1").replace(f, "").replace(t, "."));
        return isNaN(f) ? 0 : f
    }, p = i.toFixed = function (n, t) {
        t = f(t, i.settings.number.precision);
        var r = Math.pow(10, t);
        return(Math.round(i.unformat(n) * r) / r).toFixed(t)
    }, c = i.formatNumber = i.format = function (n, t, o, l) {
        if (u(n))return r(n, function (n) {
            return c(n, t, o, l)
        });
        n = e(n);
        var a = h(s(t) ? t : {precision: t, thousand: o, decimal: l}, i.settings.number), y = f(a.precision), b = 0 > n ? "-" : "", v = parseInt(p(Math.abs(n || 0), y), 10) + "", w = 3 < v.length ? v.length % 3 : 0;
        return b + (w ? v.substr(0, w) + a.thousand : "") + v.substr(w).replace(/(\d{3})(?=\d)/g, "$1" + a.thousand) + (y ? a.decimal + p(Math.abs(n), y).split(".")[1] : "")
    }, w = i.formatMoney = function (n, t, o, a, v, y) {
        if (u(n))return r(n, function (n) {
            return w(n, t, o, a, v, y)
        });
        n = e(n);
        var p = h(s(t) ? t : {symbol: t, precision: o, thousand: a, decimal: v, format: y}, i.settings.currency), b = l(p.format);
        return(0 < n ? b.pos : 0 > n ? b.neg : b.zero).replace("%s", p.symbol).replace("%v", c(Math.abs(n), f(p.precision), p.thousand, p.decimal))
    };
    i.formatColumn = function (n, t, a, v, y, p) {
        if (!n)return[];
        var w = h(s(t) ? t : {symbol: t, precision: a, thousand: v, decimal: y, format: p}, i.settings.currency), b = l(w.format), d = b.pos.indexOf("%s") < b.pos.indexOf("%v") ? !0 : !1, k = 0;
        return n = r(n, function (n) {
            if (u(n))return i.formatColumn(n, w);
            n = e(n);
            var t = (0 < n ? b.pos : 0 > n ? b.neg : b.zero).replace("%s", w.symbol).replace("%v", c(Math.abs(n), f(w.precision), w.thousand, w.decimal));
            return t.length > k && (k = t.length), t
        }), r(n, function (n) {
            return o(n) && n.length < k ? d ? n.replace(w.symbol, w.symbol + Array(k - n.length + 1).join(" ")) : Array(k - n.length + 1).join(" ") + n : n
        })
    };
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = i), exports.accounting = i) : "function" == typeof define && define.amd ? define([], function () {
        return i
    }) : (i.noConflict = function (r) {
        return function () {
            return n.accounting = r, i.noConflict = t, i
        }
    }(n.accounting), n.accounting = i)
}(this), function (n, t) {
    function i(t) {
        return!n(t).parents().andSelf().filter(function () {
            return"hidden" === n.curCSS(this, "visibility") || n.expr.filters.hidden(this)
        }).length
    }

    n.ui = n.ui || {};
    n.ui.version || (n.extend(n.ui, {version: "1.8.11", keyCode: {ALT: 18, BACKSPACE: 8, CAPS_LOCK: 20, COMMA: 188, COMMAND: 91, COMMAND_LEFT: 91, COMMAND_RIGHT: 93, CONTROL: 17, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, INSERT: 45, LEFT: 37, MENU: 93, NUMPAD_ADD: 107, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, NUMPAD_ENTER: 108, NUMPAD_MULTIPLY: 106, NUMPAD_SUBTRACT: 109, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SHIFT: 16, SPACE: 32, TAB: 9, UP: 38, WINDOWS: 91}}), n.fn.extend({_focus: n.fn.focus, focus: function (t, i) {
        return"number" == typeof t ? this.each(function () {
            var r = this;
            setTimeout(function () {
                n(r).focus();
                i && i.call(r)
            }, t)
        }) : this._focus.apply(this, arguments)
    }, scrollParent: function () {
        var t;
        return t = n.browser.msie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function () {
            return/(relative|absolute|fixed)/.test(n.curCSS(this, "position", 1)) && /(auto|scroll)/.test(n.curCSS(this, "overflow", 1) + n.curCSS(this, "overflow-y", 1) + n.curCSS(this, "overflow-x", 1))
        }).eq(0) : this.parents().filter(function () {
            return/(auto|scroll)/.test(n.curCSS(this, "overflow", 1) + n.curCSS(this, "overflow-y", 1) + n.curCSS(this, "overflow-x", 1))
        }).eq(0), /fixed/.test(this.css("position")) || !t.length ? n(document) : t
    }, zIndex: function (i) {
        if (i !== t)return this.css("zIndex", i);
        if (this.length) {
            i = n(this[0]);
            for (var r; i.length && i[0] !== document;) {
                if (r = i.css("position"), ("absolute" === r || "relative" === r || "fixed" === r) && (r = parseInt(i.css("zIndex"), 10), !isNaN(r) && 0 !== r))return r;
                i = i.parent()
            }
        }
        return 0
    }, disableSelection: function () {
        return this.bind((n.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function (n) {
            n.preventDefault()
        })
    }, enableSelection: function () {
        return this.unbind(".ui-disableSelection")
    }}), n.each(["Width", "Height"], function (i, r) {
        function u(t, i, r, u) {
            return n.each(o, function () {
                i -= parseFloat(n.curCSS(t, "padding" + this, !0)) || 0;
                r && (i -= parseFloat(n.curCSS(t, "border" + this + "Width", !0)) || 0);
                u && (i -= parseFloat(n.curCSS(t, "margin" + this, !0)) || 0)
            }), i
        }

        var o = "Width" === r ? ["Left", "Right"] : ["Top", "Bottom"], f = r.toLowerCase(), e = {innerWidth: n.fn.innerWidth, innerHeight: n.fn.innerHeight, outerWidth: n.fn.outerWidth, outerHeight: n.fn.outerHeight};
        n.fn["inner" + r] = function (i) {
            return i === t ? e["inner" + r].call(this) : this.each(function () {
                n(this).css(f, u(this, i) + "px")
            })
        };
        n.fn["outer" + r] = function (t, i) {
            return"number" != typeof t ? e["outer" + r].call(this, t) : this.each(function () {
                n(this).css(f, u(this, t, !0, i) + "px")
            })
        }
    }), n.extend(n.expr[":"], {data: function (t, i, r) {
        return!!n.data(t, r[3])
    }, focusable: function (t) {
        var r = t.nodeName.toLowerCase(), u = n.attr(t, "tabindex");
        return"area" === r ? (r = t.parentNode, u = r.name, !t.href || !u || "map" !== r.nodeName.toLowerCase()) ? !1 : (t = n("img[usemap=#" + u + "]")[0], !!t && i(t)) : (/input|select|textarea|button|object/.test(r) ? !t.disabled : "a" == r ? t.href || !isNaN(u) : !isNaN(u)) && i(t)
    }, tabbable: function (t) {
        var i = n.attr(t, "tabindex");
        return(isNaN(i) || 0 <= i) && n(t).is(":focusable")
    }}), n(function () {
        var i = document.body, t = i.appendChild(t = document.createElement("div"));
        n.extend(t.style, {minHeight: "100px", height: "auto", padding: 0, borderWidth: 0});
        n.support.minHeight = 100 === t.offsetHeight;
        n.support.selectstart = "onselectstart"in t;
        i.removeChild(t).style.display = "none"
    }), n.extend(n.ui, {plugin: {add: function (t, i, r) {
        t = n.ui[t].prototype;
        for (var u in r)t.plugins[u] = t.plugins[u] || [], t.plugins[u].push([i, r[u]])
    }, call: function (n, t, i) {
        if ((t = n.plugins[t]) && n.element[0].parentNode)for (var r = 0; r < t.length; r++)n.options[t[r][0]] && t[r][1].apply(n.element, i)
    }}, contains: function (n, t) {
        return document.compareDocumentPosition ? n.compareDocumentPosition(t) & 16 : n !== t && n.contains(t)
    }, hasScroll: function (t, i) {
        if ("hidden" === n(t).css("overflow"))return!1;
        i = i && "left" === i ? "scrollLeft" : "scrollTop";
        var r = !1;
        return 0 < t[i] ? !0 : (t[i] = 1, r = 0 < t[i], t[i] = 0, r)
    }, isOverAxis: function (n, t, i) {
        return n > t && n < t + i
    }, isOver: function (t, i, r, u, f, e) {
        return n.ui.isOverAxis(t, r, f) && n.ui.isOverAxis(i, u, e)
    }}))
}(jQuery), function (n, t) {
    var i, r;
    n.cleanData ? (i = n.cleanData, n.cleanData = function (t) {
        for (var r = 0, u; null != (u = t[r]); r++)n(u).triggerHandler("remove");
        i(t)
    }) : (r = n.fn.remove, n.fn.remove = function (t, i) {
        return this.each(function () {
            return i || t && !n.filter(t, [this]).length || n("*", this).add([this]).each(function () {
                n(this).triggerHandler("remove")
            }), r.call(n(this), t, i)
        })
    });
    n.widget = function (t, i, r) {
        var u = t.split(".")[0], f;
        t = t.split(".")[1];
        f = u + "-" + t;
        r || (r = i, i = n.Widget);
        n.expr[":"][f] = function (i) {
            return!!n.data(i, t)
        };
        n[u] = n[u] || {};
        n[u][t] = function (n, t) {
            arguments.length && this._createWidget(n, t)
        };
        i = new i;
        i.options = n.extend(!0, {}, i.options);
        n[u][t].prototype = n.extend(!0, i, {namespace: u, widgetName: t, widgetEventPrefix: n[u][t].prototype.widgetEventPrefix || t, widgetBaseClass: f}, r);
        n.widget.bridge(t, n[u][t])
    };
    n.widget.bridge = function (i, r) {
        n.fn[i] = function (u) {
            var f = "string" == typeof u, e = Array.prototype.slice.call(arguments, 1), o = this;
            return(u = !f && e.length ? n.extend.apply(null, [!0, u].concat(e)) : u, f && "_" === u.charAt(0)) ? o : (f ? this.each(function () {
                var r = n.data(this, i), f = r && n.isFunction(r[u]) ? r[u].apply(r, e) : r;
                if (f !== r && f !== t)return o = f, !1
            }) : this.each(function () {
                var t = n.data(this, i);
                t ? t.option(u || {})._init() : n.data(this, i, new r(u, this))
            }), o)
        }
    };
    n.Widget = function (n, t) {
        arguments.length && this._createWidget(n, t)
    };
    n.Widget.prototype = {widgetName: "widget", widgetEventPrefix: "", options: {disabled: !1}, _createWidget: function (t, i) {
        n.data(i, this.widgetName, this);
        this.element = n(i);
        this.options = n.extend(!0, {}, this.options, this._getCreateOptions(), t);
        var r = this;
        this.element.bind("remove." + this.widgetName, function () {
            r.destroy()
        });
        this._create();
        this._trigger("create");
        this._init()
    }, _getCreateOptions: function () {
        return n.metadata && n.metadata.get(this.element[0])[this.widgetName]
    }, _create: function () {
    }, _init: function () {
    }, destroy: function () {
        this.element.unbind("." + this.widgetName).removeData(this.widgetName);
        this.widget().unbind("." + this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass + "-disabled ui-state-disabled")
    }, widget: function () {
        return this.element
    }, option: function (i, r) {
        var u = i;
        if (0 === arguments.length)return n.extend({}, this.options);
        if ("string" == typeof i) {
            if (r === t)return this.options[i];
            u = {};
            u[i] = r
        }
        return this._setOptions(u), this
    }, _setOptions: function (t) {
        var i = this;
        return n.each(t, function (n, t) {
            i._setOption(n, t)
        }), this
    }, _setOption: function (n, t) {
        return this.options[n] = t, "disabled" === n && this.widget()[t ? "addClass" : "removeClass"](this.widgetBaseClass + "-disabled ui-state-disabled").attr("aria-disabled", t), this
    }, enable: function () {
        return this._setOption("disabled", !1)
    }, disable: function () {
        return this._setOption("disabled", !0)
    }, _trigger: function (t, i, r) {
        var f = this.options[t], u;
        if (i = n.Event(i), i.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), r = r || {}, i.originalEvent)for (t = n.event.props.length; t;)u = n.event.props[--t], i[u] = i.originalEvent[u];
        return this.element.trigger(i, r), !(n.isFunction(f) && !1 === f.call(this.element[0], i, r) || i.isDefaultPrevented())
    }}
}(jQuery), function (n) {
    n.widget("ui.mouse", {options: {cancel: ":input,option", distance: 1, delay: 0}, _mouseInit: function () {
        var t = this;
        this.element.bind("mousedown." + this.widgetName, function (n) {
            return t._mouseDown(n)
        }).bind("click." + this.widgetName, function (i) {
            if (!0 === n.data(i.target, t.widgetName + ".preventClickEvent"))return n.removeData(i.target, t.widgetName + ".preventClickEvent"), i.stopImmediatePropagation(), !1
        });
        this.started = !1
    }, _mouseDestroy: function () {
        this.element.unbind("." + this.widgetName)
    }, _mouseDown: function (t) {
        if (t.originalEvent = t.originalEvent || {}, !t.originalEvent.mouseHandled) {
            this._mouseStarted && this._mouseUp(t);
            this._mouseDownEvent = t;
            var i = this, r = 1 == t.which, u = "string" == typeof this.options.cancel ? n(t.target).parents().add(t.target).filter(this.options.cancel).length : !1;
            return!r || u || !this._mouseCapture(t) ? !0 : (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () {
                i.mouseDelayMet = !0
            }, this.options.delay)), this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = !1 !== this._mouseStart(t), !this._mouseStarted)) ? (t.preventDefault(), !0) : (!0 === n.data(t.target, this.widgetName + ".preventClickEvent") && n.removeData(t.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (n) {
                return i._mouseMove(n)
            }, this._mouseUpDelegate = function (n) {
                return i._mouseUp(n)
            }, n(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), t.preventDefault(), t.originalEvent.mouseHandled = !0)
        }
    }, _mouseMove: function (t) {
        return n.browser.msie && !(9 <= document.documentMode) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && ((this._mouseStarted = !1 !== this._mouseStart(this._mouseDownEvent, t)) ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted)
    }, _mouseUp: function (t) {
        return n(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target == this._mouseDownEvent.target && n.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
    }, _mouseDistanceMet: function (n) {
        return Math.max(Math.abs(this._mouseDownEvent.pageX - n.pageX), Math.abs(this._mouseDownEvent.pageY - n.pageY)) >= this.options.distance
    }, _mouseDelayMet: function () {
        return this.mouseDelayMet
    }, _mouseStart: function () {
    }, _mouseDrag: function () {
    }, _mouseStop: function () {
    }, _mouseCapture: function () {
        return!0
    }})
}(jQuery), function (n) {
    n.ui = n.ui || {};
    var t = /left|center|right/, i = /top|center|bottom/, r = n.fn.position, u = n.fn.offset;
    n.fn.position = function (u) {
        if (!u || !u.of)return r.apply(this, arguments);
        u = n.extend({}, u);
        var e = n(u.of), l = e[0], c = (u.collision || "flip").split(" "), o = u.offset ? u.offset.split(" ") : [0, 0], s, h, f;
        return 9 === l.nodeType ? (s = e.width(), h = e.height(), f = {top: 0, left: 0}) : l.setTimeout ? (s = e.width(), h = e.height(), f = {top: e.scrollTop(), left: e.scrollLeft()}) : l.preventDefault ? (u.at = "left top", s = h = 0, f = {top: u.of.pageY, left: u.of.pageX}) : (s = e.outerWidth(), h = e.outerHeight(), f = e.offset()), n.each(["my", "at"], function () {
            var n = (u[this] || "").split(" ");
            1 === n.length && (n = t.test(n[0]) ? n.concat(["center"]) : i.test(n[0]) ? ["center"].concat(n) : ["center", "center"]);
            n[0] = t.test(n[0]) ? n[0] : "center";
            n[1] = i.test(n[1]) ? n[1] : "center";
            u[this] = n
        }), 1 === c.length && (c[1] = c[0]), o[0] = parseInt(o[0], 10) || 0, 1 === o.length && (o[1] = o[0]), o[1] = parseInt(o[1], 10) || 0, "right" === u.at[0] ? f.left += s : "center" === u.at[0] && (f.left += s / 2), "bottom" === u.at[1] ? f.top += h : "center" === u.at[1] && (f.top += h / 2), f.left += o[0], f.top += o[1], this.each(function () {
            var i = n(this), r = i.outerWidth(), e = i.outerHeight(), l = parseInt(n.curCSS(this, "marginLeft", !0)) || 0, a = parseInt(n.curCSS(this, "marginTop", !0)) || 0, y = r + l + (parseInt(n.curCSS(this, "marginRight", !0)) || 0), p = e + a + (parseInt(n.curCSS(this, "marginBottom", !0)) || 0), t = n.extend({}, f), v;
            "right" === u.my[0] ? t.left -= r : "center" === u.my[0] && (t.left -= r / 2);
            "bottom" === u.my[1] ? t.top -= e : "center" === u.my[1] && (t.top -= e / 2);
            t.left = Math.round(t.left);
            t.top = Math.round(t.top);
            v = {left: t.left - l, top: t.top - a};
            n.each(["left", "top"], function (i, f) {
                n.ui.position[c[i]] && n.ui.position[c[i]][f](t, {targetWidth: s, targetHeight: h, elemWidth: r, elemHeight: e, collisionPosition: v, collisionWidth: y, collisionHeight: p, offset: o, my: u.my, at: u.at})
            });
            n.fn.bgiframe && i.bgiframe();
            i.offset(n.extend(t, {using: u.using}))
        })
    };
    n.ui.position = {fit: {left: function (t, i) {
        var r = n(window), r = i.collisionPosition.left + i.collisionWidth - r.width() - r.scrollLeft();
        t.left = 0 < r ? t.left - r : Math.max(t.left - i.collisionPosition.left, t.left)
    }, top: function (t, i) {
        var r = n(window), r = i.collisionPosition.top + i.collisionHeight - r.height() - r.scrollTop();
        t.top = 0 < r ? t.top - r : Math.max(t.top - i.collisionPosition.top, t.top)
    }}, flip: {left: function (t, i) {
        if ("center" !== i.at[0]) {
            var r = n(window), r = i.collisionPosition.left + i.collisionWidth - r.width() - r.scrollLeft(), u = "left" === i.my[0] ? -i.elemWidth : "right" === i.my[0] ? i.elemWidth : 0, f = "left" === i.at[0] ? i.targetWidth : -i.targetWidth, e = -2 * i.offset[0];
            t.left += 0 > i.collisionPosition.left ? u + f + e : 0 < r ? u + f + e : 0
        }
    }, top: function (t, i) {
        if ("center" !== i.at[1]) {
            var r = n(window), r = i.collisionPosition.top + i.collisionHeight - r.height() - r.scrollTop(), u = "top" === i.my[1] ? -i.elemHeight : "bottom" === i.my[1] ? i.elemHeight : 0, f = "top" === i.at[1] ? i.targetHeight : -i.targetHeight, e = -2 * i.offset[1];
            t.top += 0 > i.collisionPosition.top ? u + f + e : 0 < r ? u + f + e : 0
        }
    }}};
    n.offset.setOffset || (n.offset.setOffset = function (t, i) {
        /static/.test(n.curCSS(t, "position")) && (t.style.position = "relative");
        var u = n(t), r = u.offset(), f = parseInt(n.curCSS(t, "top", !0), 10) || 0, e = parseInt(n.curCSS(t, "left", !0), 10) || 0, r = {top: i.top - r.top + f, left: i.left - r.left + e};
        "using"in i ? i.using.call(t, r) : u.css(r)
    }, n.fn.offset = function (t) {
        var i = this[0];
        return i && i.ownerDocument ? t ? this.each(function () {
            n.offset.setOffset(this, t)
        }) : u.call(this) : null
    })
}(jQuery), function (n) {
    n.widget("ui.draggable", n.ui.mouse, {widgetEventPrefix: "drag", options: {addClasses: !0, appendTo: "parent", axis: !1, connectToSortable: !1, containment: !1, cursor: "auto", cursorAt: !1, grid: !1, handle: !1, helper: "original", iframeFix: !1, opacity: !1, refreshPositions: !1, revert: !1, revertDuration: 500, scope: "default", scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, snap: !1, snapMode: "both", snapTolerance: 20, stack: !1, zIndex: !1}, _create: function () {
        "original" != this.options.helper || /^(?:r|a|f)/.test(this.element.css("position")) || (this.element[0].style.position = "relative");
        this.options.addClasses && this.element.addClass("ui-draggable");
        this.options.disabled && this.element.addClass("ui-draggable-disabled");
        this._mouseInit()
    }, destroy: function () {
        if (this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy(), this
    }, _mouseCapture: function (t) {
        var i = this.options;
        return this.helper || i.disabled || n(t.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(t)) ? !0 : !1
    }, _mouseStart: function (t) {
        var i = this.options;
        return(this.helper = this._createHelper(t), this._cacheHelperProportions(), n.ui.ddmanager && (n.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left}, n.extend(this.offset, {click: {left: t.pageX - this.offset.left, top: t.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), i.containment && this._setContainment(), !1 === this._trigger("start", t)) ? (this._clear(), !1) : (this._cacheHelperProportions(), n.ui.ddmanager && !i.dropBehaviour && n.ui.ddmanager.prepareOffsets(this, t), this.helper.addClass("ui-draggable-dragging"), this._mouseDrag(t, !0), !0)
    }, _mouseDrag: function (t, i) {
        if (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), !i) {
            if (i = this._uiHash(), !1 === this._trigger("drag", t, i))return this._mouseUp({}), !1;
            this.position = i.position
        }
        return this.options.axis && "y" == this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" == this.options.axis || (this.helper[0].style.top = this.position.top + "px"), n.ui.ddmanager && n.ui.ddmanager.drag(this, t), !1
    }, _mouseStop: function (t) {
        var i = !1, r;
        return(n.ui.ddmanager && !this.options.dropBehaviour && (i = n.ui.ddmanager.drop(this, t)), this.dropped && (i = this.dropped, this.dropped = !1), !(this.element[0] && this.element[0].parentNode || "original" != this.options.helper)) ? !1 : ("invalid" == this.options.revert && !i || "valid" == this.options.revert && i || !0 === this.options.revert || n.isFunction(this.options.revert) && this.options.revert.call(this.element, i) ? (r = this, n(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function () {
            !1 !== r._trigger("stop", t) && r._clear()
        })) : !1 !== this._trigger("stop", t) && this._clear(), !1)
    }, cancel: function () {
        return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
    }, _getHandle: function (t) {
        var i = this.options.handle && n(this.options.handle, this.element).length ? !1 : !0;
        return n(this.options.handle, this.element).find("*").andSelf().each(function () {
            this == t.target && (i = !0)
        }), i
    }, _createHelper: function (t) {
        var i = this.options;
        return t = n.isFunction(i.helper) ? n(i.helper.apply(this.element[0], [t])) : "clone" == i.helper ? this.element.clone() : this.element, t.parents("body").length || t.appendTo("parent" == i.appendTo ? this.element[0].parentNode : i.appendTo), t[0] == this.element[0] || /(fixed|absolute)/.test(t.css("position")) || t.css("position", "absolute"), t
    }, _adjustOffsetFromHelper: function (t) {
        "string" == typeof t && (t = t.split(" "));
        n.isArray(t) && (t = {left: +t[0], top: +t[1] || 0});
        "left"in t && (this.offset.click.left = t.left + this.margins.left);
        "right"in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left);
        "top"in t && (this.offset.click.top = t.top + this.margins.top);
        "bottom"in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
    }, _getParentOffset: function () {
        this.offsetParent = this.helper.offsetParent();
        var t = this.offsetParent.offset();
        return"absolute" == this.cssPosition && this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && "html" == this.offsetParent[0].tagName.toLowerCase() && n.browser.msie) && (t = {top: 0, left: 0}), {top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
        if ("relative" == this.cssPosition) {
            var n = this.element.position();
            return{top: n.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: n.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
        }
        return{top: 0, left: 0}
    }, _cacheMargins: function () {
        this.margins = {left: parseInt(this.element.css("marginLeft"), 10) || 0, top: parseInt(this.element.css("marginTop"), 10) || 0, right: parseInt(this.element.css("marginRight"), 10) || 0, bottom: parseInt(this.element.css("marginBottom"), 10) || 0}
    }, _cacheHelperProportions: function () {
        this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
    }, _setContainment: function () {
        var t = this.options, i, r;
        "parent" == t.containment && (t.containment = this.helper[0].parentNode);
        ("document" == t.containment || "window" == t.containment) && (this.containment = [("document" == t.containment ? 0 : n(window).scrollLeft()) - this.offset.relative.left - this.offset.parent.left, ("document" == t.containment ? 0 : n(window).scrollTop()) - this.offset.relative.top - this.offset.parent.top, ("document" == t.containment ? 0 : n(window).scrollLeft()) + n("document" == t.containment ? document : window).width() - this.helperProportions.width - this.margins.left, ("document" == t.containment ? 0 : n(window).scrollTop()) + (n("document" == t.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]);
        /^(document|window|parent)$/.test(t.containment) || t.containment.constructor == Array ? t.containment.constructor == Array && (this.containment = t.containment) : (i = n(t.containment)[0], i && (t = n(t.containment).offset(), r = "hidden" != n(i).css("overflow"), this.containment = [t.left + (parseInt(n(i).css("borderLeftWidth"), 10) || 0) + (parseInt(n(i).css("paddingLeft"), 10) || 0), t.top + (parseInt(n(i).css("borderTopWidth"), 10) || 0) + (parseInt(n(i).css("paddingTop"), 10) || 0), t.left + (r ? Math.max(i.scrollWidth, i.offsetWidth) : i.offsetWidth) - (parseInt(n(i).css("borderLeftWidth"), 10) || 0) - (parseInt(n(i).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, t.top + (r ? Math.max(i.scrollHeight, i.offsetHeight) : i.offsetHeight) - (parseInt(n(i).css("borderTopWidth"), 10) || 0) - (parseInt(n(i).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom]))
    }, _convertPositionTo: function (t, i) {
        i || (i = this.position);
        t = "absolute" == t ? 1 : -1;
        var r = "absolute" != this.cssPosition || this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, u = /(html|body)/i.test(r[0].tagName);
        return{top: i.top + this.offset.relative.top * t + this.offset.parent.top * t - (n.browser.safari && 526 > n.browser.version && "fixed" == this.cssPosition ? 0 : ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : u ? 0 : r.scrollTop()) * t), left: i.left + this.offset.relative.left * t + this.offset.parent.left * t - (n.browser.safari && 526 > n.browser.version && "fixed" == this.cssPosition ? 0 : ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : u ? 0 : r.scrollLeft()) * t)}
    }, _generatePosition: function (t) {
        var u = this.options, f = "absolute" != this.cssPosition || this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, e = /(html|body)/i.test(f[0].tagName), i = t.pageX, r = t.pageY;
        return this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (i = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (r = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (i = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (r = this.containment[3] + this.offset.click.top)), u.grid && (r = this.originalPageY + Math.round((r - this.originalPageY) / u.grid[1]) * u.grid[1], r = this.containment ? r - this.offset.click.top < this.containment[1] || r - this.offset.click.top > this.containment[3] ? r - this.offset.click.top < this.containment[1] ? r + u.grid[1] : r - u.grid[1] : r : r, i = this.originalPageX + Math.round((i - this.originalPageX) / u.grid[0]) * u.grid[0], i = this.containment ? i - this.offset.click.left < this.containment[0] || i - this.offset.click.left > this.containment[2] ? i - this.offset.click.left < this.containment[0] ? i + u.grid[0] : i - u.grid[0] : i : i)), {top: r - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (n.browser.safari && 526 > n.browser.version && "fixed" == this.cssPosition ? 0 : "fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : e ? 0 : f.scrollTop()), left: i - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (n.browser.safari && 526 > n.browser.version && "fixed" == this.cssPosition ? 0 : "fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : e ? 0 : f.scrollLeft())}
    }, _clear: function () {
        this.helper.removeClass("ui-draggable-dragging");
        this.helper[0] == this.element[0] || this.cancelHelperRemoval || this.helper.remove();
        this.helper = null;
        this.cancelHelperRemoval = !1
    }, _trigger: function (t, i, r) {
        return r = r || this._uiHash(), n.ui.plugin.call(this, t, [i, r]), "drag" == t && (this.positionAbs = this._convertPositionTo("absolute")), n.Widget.prototype._trigger.call(this, t, i, r)
    }, plugins: {}, _uiHash: function () {
        return{helper: this.helper, position: this.position, originalPosition: this.originalPosition, offset: this.positionAbs}
    }});
    n.extend(n.ui.draggable, {version: "1.8.11"});
    n.ui.plugin.add("draggable", "connectToSortable", {start: function (t, i) {
        var r = n(this).data("draggable"), u = r.options, f = n.extend({}, i, {item: r.element});
        r.sortables = [];
        n(u.connectToSortable).each(function () {
            var i = n.data(this, "sortable");
            i && !i.options.disabled && (r.sortables.push({instance: i, shouldRevert: i.options.revert}), i.refreshPositions(), i._trigger("activate", t, f))
        })
    }, stop: function (t, i) {
        var r = n(this).data("draggable"), u = n.extend({}, i, {item: r.element});
        n.each(r.sortables, function () {
            this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, "original" == r.options.helper && this.instance.currentItem.css({top: "auto", left: "auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, u))
        })
    }, drag: function (t, i) {
        var r = n(this).data("draggable"), u = this;
        n.each(r.sortables, function () {
            this.instance.positionAbs = r.positionAbs;
            this.instance.helperProportions = r.helperProportions;
            this.instance.offset.click = r.offset.click;
            this.instance._intersectsWith(this.instance.containerCache) ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = n(u).clone().appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function () {
                return i.helper[0]
            }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", t), r.dropped = !1)
        })
    }});
    n.ui.plugin.add("draggable", "cursor", {start: function () {
        var t = n("body"), i = n(this).data("draggable").options;
        t.css("cursor") && (i._cursor = t.css("cursor"));
        t.css("cursor", i.cursor)
    }, stop: function () {
        var t = n(this).data("draggable").options;
        t._cursor && n("body").css("cursor", t._cursor)
    }});
    n.ui.plugin.add("draggable", "iframeFix", {start: function () {
        var t = n(this).data("draggable").options;
        n(!0 === t.iframeFix ? "iframe" : t.iframeFix).each(function () {
            n('<div class="ui-draggable-iframeFix" style="background: #fff;"><\/div>').css({width: this.offsetWidth + "px", height: this.offsetHeight + "px", position: "absolute", opacity: "0.001", zIndex: 1e3}).css(n(this).offset()).appendTo("body")
        })
    }, stop: function () {
        n("div.ui-draggable-iframeFix").each(function () {
            this.parentNode.removeChild(this)
        })
    }});
    n.ui.plugin.add("draggable", "opacity", {start: function (t, i) {
        t = n(i.helper);
        i = n(this).data("draggable").options;
        t.css("opacity") && (i._opacity = t.css("opacity"));
        t.css("opacity", i.opacity)
    }, stop: function (t, i) {
        t = n(this).data("draggable").options;
        t._opacity && n(i.helper).css("opacity", t._opacity)
    }});
    n.ui.plugin.add("draggable", "scroll", {start: function () {
        var t = n(this).data("draggable");
        t.scrollParent[0] != document && "HTML" != t.scrollParent[0].tagName && (t.overflowOffset = t.scrollParent.offset())
    }, drag: function (t) {
        var r = n(this).data("draggable"), i = r.options, u = !1;
        r.scrollParent[0] != document && "HTML" != r.scrollParent[0].tagName ? (i.axis && "x" == i.axis || (r.overflowOffset.top + r.scrollParent[0].offsetHeight - t.pageY < i.scrollSensitivity ? r.scrollParent[0].scrollTop = u = r.scrollParent[0].scrollTop + i.scrollSpeed : t.pageY - r.overflowOffset.top < i.scrollSensitivity && (r.scrollParent[0].scrollTop = u = r.scrollParent[0].scrollTop - i.scrollSpeed)), i.axis && "y" == i.axis || (r.overflowOffset.left + r.scrollParent[0].offsetWidth - t.pageX < i.scrollSensitivity ? r.scrollParent[0].scrollLeft = u = r.scrollParent[0].scrollLeft + i.scrollSpeed : t.pageX - r.overflowOffset.left < i.scrollSensitivity && (r.scrollParent[0].scrollLeft = u = r.scrollParent[0].scrollLeft - i.scrollSpeed))) : (i.axis && "x" == i.axis || (t.pageY - n(document).scrollTop() < i.scrollSensitivity ? u = n(document).scrollTop(n(document).scrollTop() - i.scrollSpeed) : n(window).height() - (t.pageY - n(document).scrollTop()) < i.scrollSensitivity && (u = n(document).scrollTop(n(document).scrollTop() + i.scrollSpeed))), i.axis && "y" == i.axis || (t.pageX - n(document).scrollLeft() < i.scrollSensitivity ? u = n(document).scrollLeft(n(document).scrollLeft() - i.scrollSpeed) : n(window).width() - (t.pageX - n(document).scrollLeft()) < i.scrollSensitivity && (u = n(document).scrollLeft(n(document).scrollLeft() + i.scrollSpeed))));
        !1 !== u && n.ui.ddmanager && !i.dropBehaviour && n.ui.ddmanager.prepareOffsets(r, t)
    }});
    n.ui.plugin.add("draggable", "snap", {start: function () {
        var t = n(this).data("draggable"), i = t.options;
        t.snapElements = [];
        n(i.snap.constructor != String ? i.snap.items || ":data(draggable)" : i.snap).each(function () {
            var i = n(this), r = i.offset();
            this != t.element[0] && t.snapElements.push({item: this, width: i.outerWidth(), height: i.outerHeight(), top: r.top, left: r.left})
        })
    }, drag: function (t, i) {
        for (var d, r = n(this).data("draggable"), k = r.options, u = k.snapTolerance, c = i.offset.left, a = c + r.helperProportions.width, l = i.offset.top, v = l + r.helperProportions.height, f = r.snapElements.length - 1; 0 <= f; f--) {
            var e = r.snapElements[f].left, s = e + r.snapElements[f].width, o = r.snapElements[f].top, h = o + r.snapElements[f].height;
            if (e - u < c && c < s + u && o - u < l && l < h + u || e - u < c && c < s + u && o - u < v && v < h + u || e - u < a && a < s + u && o - u < l && l < h + u || e - u < a && a < s + u && o - u < v && v < h + u) {
                if ("inner" != k.snapMode) {
                    var y = Math.abs(o - v) <= u, p = Math.abs(h - l) <= u, w = Math.abs(e - a) <= u, b = Math.abs(s - c) <= u;
                    y && (i.position.top = r._convertPositionTo("relative", {top: o - r.helperProportions.height, left: 0}).top - r.margins.top);
                    p && (i.position.top = r._convertPositionTo("relative", {top: h, left: 0}).top - r.margins.top);
                    w && (i.position.left = r._convertPositionTo("relative", {top: 0, left: e - r.helperProportions.width}).left - r.margins.left);
                    b && (i.position.left = r._convertPositionTo("relative", {top: 0, left: s}).left - r.margins.left)
                }
                d = y || p || w || b;
                "outer" != k.snapMode && (y = Math.abs(o - l) <= u, p = Math.abs(h - v) <= u, w = Math.abs(e - c) <= u, b = Math.abs(s - a) <= u, y && (i.position.top = r._convertPositionTo("relative", {top: o, left: 0}).top - r.margins.top), p && (i.position.top = r._convertPositionTo("relative", {top: h - r.helperProportions.height, left: 0}).top - r.margins.top), w && (i.position.left = r._convertPositionTo("relative", {top: 0, left: e}).left - r.margins.left), b && (i.position.left = r._convertPositionTo("relative", {top: 0, left: s - r.helperProportions.width}).left - r.margins.left));
                !r.snapElements[f].snapping && (y || p || w || b || d) && r.options.snap.snap && r.options.snap.snap.call(r.element, t, n.extend(r._uiHash(), {snapItem: r.snapElements[f].item}));
                r.snapElements[f].snapping = y || p || w || b || d
            } else r.snapElements[f].snapping && r.options.snap.release && r.options.snap.release.call(r.element, t, n.extend(r._uiHash(), {snapItem: r.snapElements[f].item})), r.snapElements[f].snapping = !1
        }
    }});
    n.ui.plugin.add("draggable", "stack", {start: function () {
        var t = n(this).data("draggable").options, t = n.makeArray(n(t.stack)).sort(function (t, i) {
            return(parseInt(n(t).css("zIndex"), 10) || 0) - (parseInt(n(i).css("zIndex"), 10) || 0)
        }), i;
        t.length && (i = parseInt(t[0].style.zIndex) || 0, n(t).each(function (n) {
            this.style.zIndex = i + n
        }), this[0].style.zIndex = i + t.length)
    }});
    n.ui.plugin.add("draggable", "zIndex", {start: function (t, i) {
        t = n(i.helper);
        i = n(this).data("draggable").options;
        t.css("zIndex") && (i._zIndex = t.css("zIndex"));
        t.css("zIndex", i.zIndex)
    }, stop: function (t, i) {
        t = n(this).data("draggable").options;
        t._zIndex && n(i.helper).css("zIndex", t._zIndex)
    }})
}(jQuery), function (n) {
    n.widget("ui.resizable", n.ui.mouse, {widgetEventPrefix: "resize", options: {alsoResize: !1, animate: !1, animateDuration: "slow", animateEasing: "swing", aspectRatio: !1, autoHide: !1, containment: !1, ghost: !1, grid: !1, handles: "e,s,se", helper: !1, maxHeight: null, maxWidth: null, minHeight: 10, minWidth: 10, zIndex: 1e3}, _create: function () {
        var r = this, t = this.options, e, u, i, f;
        if (this.element.addClass("ui-resizable"), n.extend(this, {_aspectRatio: !!t.aspectRatio, aspectRatio: t.aspectRatio, originalElement: this.element, _proportionallyResizeElements: [], _helper: t.helper || t.ghost || t.animate ? t.helper || "ui-resizable-helper" : null}), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (/relative/.test(this.element.css("position")) && n.browser.opera && this.element.css({position: "relative", top: "auto", left: "auto"}), this.element.wrap(n('<div class="ui-wrapper" style="overflow: hidden;"><\/div>').css({position: this.element.css("position"), width: this.element.outerWidth(), height: this.element.outerHeight(), top: this.element.css("top"), left: this.element.css("left")})), this.element = this.element.parent().data("resizable", this.element.data("resizable")), this.elementIsWrapper = !0, this.element.css({marginLeft: this.originalElement.css("marginLeft"), marginTop: this.originalElement.css("marginTop"), marginRight: this.originalElement.css("marginRight"), marginBottom: this.originalElement.css("marginBottom")}), this.originalElement.css({marginLeft: 0, marginTop: 0, marginRight: 0, marginBottom: 0}), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({position: "static", zoom: 1, display: "block"})), this.originalElement.css({margin: this.originalElement.css("margin")}), this._proportionallyResize()), this.handles = t.handles || (n(".ui-resizable-handle", this.element).length ? {n: ".ui-resizable-n", e: ".ui-resizable-e", s: ".ui-resizable-s", w: ".ui-resizable-w", se: ".ui-resizable-se", sw: ".ui-resizable-sw", ne: ".ui-resizable-ne", nw: ".ui-resizable-nw"} : "e,s,se"), this.handles.constructor == String)for ("all" == this.handles && (this.handles = "n,e,s,w,se,sw,ne,nw"), e = this.handles.split(","), this.handles = {}, u = 0; u < e.length; u++)i = n.trim(e[u]), f = n('<div class="ui-resizable-handle ui-resizable-' + i + '"><\/div>'), /sw|se|ne|nw/.test(i) && f.css({zIndex: ++t.zIndex}), "se" == i && f.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[i] = ".ui-resizable-" + i, this.element.append(f);
        this._renderAxis = function (t) {
            var i;
            t = t || this.element;
            for (i in this.handles) {
                if (this.handles[i].constructor == String && (this.handles[i] = n(this.handles[i], this.element).show()), this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i)) {
                    var r = n(this.handles[i], this.element), u = 0, u = /sw|ne|nw|se|n|s/.test(i) ? r.outerHeight() : r.outerWidth(), r = ["padding", /ne|nw|n/.test(i) ? "Top" : /se|sw|s/.test(i) ? "Bottom" : /^e$/.test(i) ? "Right" : "Left"].join("");
                    t.css(r, u);
                    this._proportionallyResize()
                }
                n(this.handles[i])
            }
        };
        this._renderAxis(this.element);
        this._handles = n(".ui-resizable-handle", this.element).disableSelection();
        this._handles.mouseover(function () {
            if (!r.resizing) {
                if (this.className)var n = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);
                r.axis = n && n[1] ? n[1] : "se"
            }
        });
        t.autoHide && (this._handles.hide(), n(this.element).addClass("ui-resizable-autohide").hover(function () {
            n(this).removeClass("ui-resizable-autohide");
            r._handles.show()
        }, function () {
            r.resizing || (n(this).addClass("ui-resizable-autohide"), r._handles.hide())
        }));
        this._mouseInit()
    }, destroy: function () {
        var i, t;
        return this._mouseDestroy(), i = function (t) {
            n(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
        }, this.elementIsWrapper && (i(this.element), t = this.element, t.after(this.originalElement.css({position: t.css("position"), width: t.outerWidth(), height: t.outerHeight(), top: t.css("top"), left: t.css("left")})).remove()), this.originalElement.css("resize", this.originalResizeStyle), i(this.originalElement), this
    }, _mouseCapture: function (t) {
        var i = !1;
        for (var r in this.handles)n(this.handles[r])[0] == t.target && (i = !0);
        return!this.options.disabled && i
    }, _mouseStart: function (t) {
        var u = this.options, f = this.element.position(), r = this.element, e;
        return this.resizing = !0, this.documentScroll = {top: n(document).scrollTop(), left: n(document).scrollLeft()}, (r.is(".ui-draggable") || /absolute/.test(r.css("position"))) && r.css({position: "absolute", top: f.top, left: f.left}), n.browser.opera && /relative/.test(r.css("position")) && r.css({position: "relative", top: "auto", left: "auto"}), this._renderProxy(), f = i(this.helper.css("left")), e = i(this.helper.css("top")), u.containment && (f += n(u.containment).scrollLeft() || 0, e += n(u.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {left: f, top: e}, this.size = this._helper ? {width: r.outerWidth(), height: r.outerHeight()} : {width: r.width(), height: r.height()}, this.originalSize = this._helper ? {width: r.outerWidth(), height: r.outerHeight()} : {width: r.width(), height: r.height()}, this.originalPosition = {left: f, top: e}, this.sizeDiff = {width: r.outerWidth() - r.width(), height: r.outerHeight() - r.height()}, this.originalMousePosition = {left: t.pageX, top: t.pageY}, this.aspectRatio = "number" == typeof u.aspectRatio ? u.aspectRatio : this.originalSize.width / this.originalSize.height || 1, u = n(".ui-resizable-" + this.axis).css("cursor"), n("body").css("cursor", "auto" == u ? this.axis + "-resize" : u), r.addClass("ui-resizable-resizing"), this._propagate("start", t), !0
    }, _mouseDrag: function (n) {
        var r = this.helper, t = this.originalMousePosition, i = this._change[this.axis];
        return i ? (t = i.apply(this, [n, n.pageX - t.left || 0, n.pageY - t.top || 0]), (this._aspectRatio || n.shiftKey) && (t = this._updateRatio(t, n)), t = this._respectSize(t, n), this._propagate("resize", n), r.css({top: this.position.top + "px", left: this.position.left + "px", width: this.size.width + "px", height: this.size.height + "px"}), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), this._updateCache(t), this._trigger("resize", n, this.ui()), !1) : !1
    }, _mouseStop: function (t) {
        var u;
        if (this.resizing = !1, u = this.options, this._helper) {
            var i = this._proportionallyResizeElements, r = i.length && /textarea/i.test(i[0].nodeName), i = r && n.ui.hasScroll(i[0], "left") ? 0 : this.sizeDiff.height, r = r ? 0 : this.sizeDiff.width, r = {width: this.helper.width() - r, height: this.helper.height() - i}, i = parseInt(this.element.css("left"), 10) + (this.position.left - this.originalPosition.left) || null, f = parseInt(this.element.css("top"), 10) + (this.position.top - this.originalPosition.top) || null;
            u.animate || this.element.css(n.extend(r, {top: f, left: i}));
            this.helper.height(this.size.height);
            this.helper.width(this.size.width);
            this._helper && !u.animate && this._proportionallyResize()
        }
        return n("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1
    }, _updateCache: function (n) {
        this.offset = this.helper.offset();
        t(n.left) && (this.position.left = n.left);
        t(n.top) && (this.position.top = n.top);
        t(n.height) && (this.size.height = n.height);
        t(n.width) && (this.size.width = n.width)
    }, _updateRatio: function (n) {
        var i = this.position, t = this.size, r = this.axis;
        return n.height ? n.width = t.height * this.aspectRatio : n.width && (n.height = t.width / this.aspectRatio), "sw" == r && (n.left = i.left + (t.width - n.width), n.top = null), "nw" == r && (n.top = i.top + (t.height - n.height), n.left = i.left + (t.width - n.width)), n
    }, _respectSize: function (n) {
        var i = this.options, r = this.axis, u = t(n.width) && i.maxWidth && i.maxWidth < n.width, f = t(n.height) && i.maxHeight && i.maxHeight < n.height, e = t(n.width) && i.minWidth && i.minWidth > n.width, o = t(n.height) && i.minHeight && i.minHeight > n.height;
        e && (n.width = i.minWidth);
        o && (n.height = i.minHeight);
        u && (n.width = i.maxWidth);
        f && (n.height = i.maxHeight);
        var s = this.originalPosition.left + this.originalSize.width, h = this.position.top + this.size.height, c = /sw|nw|w/.test(r), r = /nw|ne|n/.test(r);
        return e && c && (n.left = s - i.minWidth), u && c && (n.left = s - i.maxWidth), o && r && (n.top = h - i.minHeight), f && r && (n.top = h - i.maxHeight), (i = !n.width && !n.height) && !n.left && n.top ? n.top = null : i && !n.top && n.left && (n.left = null), n
    }, _proportionallyResize: function () {
        var i, r, t, u, f;
        if (this._proportionallyResizeElements.length)for (i = this.helper || this.element, r = 0; r < this._proportionallyResizeElements.length; r++)t = this._proportionallyResizeElements[r], this.borderDif || (u = [t.css("borderTopWidth"), t.css("borderRightWidth"), t.css("borderBottomWidth"), t.css("borderLeftWidth")], f = [t.css("paddingTop"), t.css("paddingRight"), t.css("paddingBottom"), t.css("paddingLeft")], this.borderDif = n.map(u, function (n, t) {
            return n = parseInt(n, 10) || 0, t = parseInt(f[t], 10) || 0, n + t
        })), n.browser.msie && (n(i).is(":hidden") || n(i).parents(":hidden").length) || t.css({height: i.height() - this.borderDif[0] - this.borderDif[2] || 0, width: i.width() - this.borderDif[1] - this.borderDif[3] || 0})
    }, _renderProxy: function () {
        var r = this.options;
        if (this.elementOffset = this.element.offset(), this._helper) {
            this.helper = this.helper || n('<div style="overflow:hidden;"><\/div>');
            var t = n.browser.msie && 7 > n.browser.version, i = t ? 1 : 0, t = t ? 2 : -1;
            this.helper.addClass(this._helper).css({width: this.element.outerWidth() + t, height: this.element.outerHeight() + t, position: "absolute", left: this.elementOffset.left - i + "px", top: this.elementOffset.top - i + "px", zIndex: ++r.zIndex});
            this.helper.appendTo("body").disableSelection()
        } else this.helper = this.element
    }, _change: {e: function (n, t) {
        return{width: this.originalSize.width + t}
    }, w: function (n, t) {
        return{left: this.originalPosition.left + t, width: this.originalSize.width - t}
    }, n: function (n, t, i) {
        return{top: this.originalPosition.top + i, height: this.originalSize.height - i}
    }, s: function (n, t, i) {
        return{height: this.originalSize.height + i}
    }, se: function (t, i, r) {
        return n.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, i, r]))
    }, sw: function (t, i, r) {
        return n.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, i, r]))
    }, ne: function (t, i, r) {
        return n.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, i, r]))
    }, nw: function (t, i, r) {
        return n.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, i, r]))
    }}, _propagate: function (t, i) {
        n.ui.plugin.call(this, t, [i, this.ui()]);
        "resize" != t && this._trigger(t, i, this.ui())
    }, plugins: {}, ui: function () {
        return{originalElement: this.originalElement, element: this.element, helper: this.helper, position: this.position, size: this.size, originalSize: this.originalSize, originalPosition: this.originalPosition}
    }});
    n.extend(n.ui.resizable, {version: "1.8.11"});
    n.ui.plugin.add("resizable", "alsoResize", {start: function () {
        var t = n(this).data("resizable").options, i = function (t) {
            n(t).each(function () {
                var t = n(this);
                t.data("resizable-alsoresize", {width: parseInt(t.width(), 10), height: parseInt(t.height(), 10), left: parseInt(t.css("left"), 10), top: parseInt(t.css("top"), 10), position: t.css("position")})
            })
        };
        "object" != typeof t.alsoResize || t.alsoResize.parentNode ? i(t.alsoResize) : t.alsoResize.length ? (t.alsoResize = t.alsoResize[0], i(t.alsoResize)) : n.each(t.alsoResize, function (n) {
            i(n)
        })
    }, resize: function (t, i) {
        var r = n(this).data("resizable");
        t = r.options;
        var u = r.originalSize, f = r.originalPosition, o = {height: r.size.height - u.height || 0, width: r.size.width - u.width || 0, top: r.position.top - f.top || 0, left: r.position.left - f.left || 0}, e = function (t, u) {
            n(t).each(function () {
                var t = n(this), e = n(this).data("resizable-alsoresize"), f = {}, s = u && u.length ? u : t.parents(i.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                n.each(s, function (n, t) {
                    (n = (e[t] || 0) + (o[t] || 0)) && 0 <= n && (f[t] = n || null)
                });
                n.browser.opera && /relative/.test(t.css("position")) && (r._revertToRelativePosition = !0, t.css({position: "absolute", top: "auto", left: "auto"}));
                t.css(f)
            })
        };
        "object" != typeof t.alsoResize || t.alsoResize.nodeType ? e(t.alsoResize) : n.each(t.alsoResize, function (n, t) {
            e(n, t)
        })
    }, stop: function () {
        var i = n(this).data("resizable"), t = i.options, r = function (t) {
            n(t).each(function () {
                var t = n(this);
                t.css({position: t.data("resizable-alsoresize").position})
            })
        };
        i._revertToRelativePosition && (i._revertToRelativePosition = !1, "object" != typeof t.alsoResize || t.alsoResize.nodeType ? r(t.alsoResize) : n.each(t.alsoResize, function (n) {
            r(n)
        }));
        n(this).removeData("resizable-alsoresize")
    }});
    n.ui.plugin.add("resizable", "animate", {stop: function (t) {
        var i = n(this).data("resizable"), e = i.options, r = i._proportionallyResizeElements, u = r.length && /textarea/i.test(r[0].nodeName), f = u && n.ui.hasScroll(r[0], "left") ? 0 : i.sizeDiff.height, u = {width: i.size.width - (u ? 0 : i.sizeDiff.width), height: i.size.height - f}, f = parseInt(i.element.css("left"), 10) + (i.position.left - i.originalPosition.left) || null, o = parseInt(i.element.css("top"), 10) + (i.position.top - i.originalPosition.top) || null;
        i.element.animate(n.extend(u, o && f ? {top: o, left: f} : {}), {duration: e.animateDuration, easing: e.animateEasing, step: function () {
            var u = {width: parseInt(i.element.css("width"), 10), height: parseInt(i.element.css("height"), 10), top: parseInt(i.element.css("top"), 10), left: parseInt(i.element.css("left"), 10)};
            r && r.length && n(r[0]).css({width: u.width, height: u.height});
            i._updateCache(u);
            i._propagate("resize", t)
        }})
    }});
    n.ui.plugin.add("resizable", "containment", {start: function () {
        var t = n(this).data("resizable"), r = t.element, u = t.options.containment, f, e;
        if (r = u instanceof n ? u.get(0) : /parent/.test(u) ? r.parent().get(0) : u)if (t.containerElement = n(r), /document/.test(u) || u == document)t.containerOffset = {left: 0, top: 0}, t.containerPosition = {left: 0, top: 0}, t.parentData = {element: n(document), left: 0, top: 0, width: n(document).width(), height: n(document).height() || document.body.parentNode.scrollHeight}; else {
            f = n(r);
            e = [];
            n(["Top", "Right", "Left", "Bottom"]).each(function (n, t) {
                e[n] = i(f.css("padding" + t))
            });
            t.containerOffset = f.offset();
            t.containerPosition = f.position();
            t.containerSize = {height: f.innerHeight() - e[3], width: f.innerWidth() - e[1]};
            var u = t.containerOffset, o = t.containerSize.height, s = t.containerSize.width, s = n.ui.hasScroll(r, "left") ? r.scrollWidth : s, o = n.ui.hasScroll(r) ? r.scrollHeight : o;
            t.parentData = {element: r, left: u.left, top: u.top, width: s, height: o}
        }
    }, resize: function (t) {
        var i = n(this).data("resizable"), u = i.options, r = i.containerOffset, e = i.position, f, o;
        t = i._aspectRatio || t.shiftKey;
        f = {top: 0, left: 0};
        o = i.containerElement;
        o[0] != document && /static/.test(o.css("position")) && (f = r);
        e.left < (i._helper ? r.left : 0) && (i.size.width += i._helper ? i.position.left - r.left : i.position.left - f.left, t && (i.size.height = i.size.width / u.aspectRatio), i.position.left = u.helper ? r.left : 0);
        e.top < (i._helper ? r.top : 0) && (i.size.height += i._helper ? i.position.top - r.top : i.position.top, t && (i.size.width = i.size.height * u.aspectRatio), i.position.top = i._helper ? r.top : 0);
        i.offset.left = i.parentData.left + i.position.left;
        i.offset.top = i.parentData.top + i.position.top;
        u = Math.abs(i.offset.left - f.left + i.sizeDiff.width);
        r = Math.abs((i._helper ? i.offset.top - f.top : i.offset.top - r.top) + i.sizeDiff.height);
        e = i.containerElement.get(0) == i.element.parent().get(0);
        f = /relative|absolute/.test(i.containerElement.css("position"));
        e && f && (u -= i.parentData.left);
        u + i.size.width >= i.parentData.width && (i.size.width = i.parentData.width - u, t && (i.size.height = i.size.width / i.aspectRatio));
        r + i.size.height >= i.parentData.height && (i.size.height = i.parentData.height - r, t && (i.size.width = i.size.height * i.aspectRatio))
    }, stop: function () {
        var t = n(this).data("resizable"), r = t.options, u = t.containerOffset, f = t.containerPosition, e = t.containerElement, i = n(t.helper), o = i.offset(), s = i.outerWidth() - t.sizeDiff.width, i = i.outerHeight() - t.sizeDiff.height;
        t._helper && !r.animate && /relative/.test(e.css("position")) && n(this).css({left: o.left - f.left - u.left, width: s, height: i});
        t._helper && !r.animate && /static/.test(e.css("position")) && n(this).css({left: o.left - f.left - u.left, width: s, height: i})
    }});
    n.ui.plugin.add("resizable", "ghost", {start: function () {
        var t = n(this).data("resizable"), i = t.options, r = t.size;
        t.ghost = t.originalElement.clone();
        t.ghost.css({opacity: .25, display: "block", position: "relative", height: r.height, width: r.width, margin: 0, left: 0, top: 0}).addClass("ui-resizable-ghost").addClass("string" == typeof i.ghost ? i.ghost : "");
        t.ghost.appendTo(t.helper)
    }, resize: function () {
        var t = n(this).data("resizable");
        t.ghost && t.ghost.css({position: "relative", height: t.size.height, width: t.size.width})
    }, stop: function () {
        var t = n(this).data("resizable");
        t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
    }});
    n.ui.plugin.add("resizable", "grid", {resize: function () {
        var t = n(this).data("resizable"), i = t.options, o = t.size, r = t.originalSize, f = t.originalPosition, e = t.axis, u;
        i.grid = "number" == typeof i.grid ? [i.grid, i.grid] : i.grid;
        u = Math.round((o.width - r.width) / (i.grid[0] || 1)) * (i.grid[0] || 1);
        i = Math.round((o.height - r.height) / (i.grid[1] || 1)) * (i.grid[1] || 1);
        /^(se|s|e)$/.test(e) ? (t.size.width = r.width + u, t.size.height = r.height + i) : /^(ne)$/.test(e) ? (t.size.width = r.width + u, t.size.height = r.height + i, t.position.top = f.top - i) : (/^(sw)$/.test(e) ? (t.size.width = r.width + u, t.size.height = r.height + i) : (t.size.width = r.width + u, t.size.height = r.height + i, t.position.top = f.top - i), t.position.left = f.left - u)
    }});
    var i = function (n) {
        return parseInt(n, 10) || 0
    }, t = function (n) {
        return!isNaN(parseInt(n, 10))
    }
}(jQuery), function (n) {
    n.widget("ui.sortable", n.ui.mouse, {widgetEventPrefix: "sort", options: {appendTo: "parent", axis: !1, connectWith: !1, containment: !1, cursor: "auto", cursorAt: !1, dropOnEmpty: !0, forcePlaceholderSize: !1, forceHelperSize: !1, grid: !1, handle: !1, helper: "original", items: "> *", opacity: !1, placeholder: !1, revert: !1, scroll: !0, scrollSensitivity: 20, scrollSpeed: 20, scope: "default", tolerance: "intersect", zIndex: 1e3}, _create: function () {
        this.containerCache = {};
        this.element.addClass("ui-sortable");
        this.refresh();
        this.floating = this.items.length ? /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1;
        this.offset = this.element.offset();
        this._mouseInit()
    }, destroy: function () {
        this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");
        this._mouseDestroy();
        for (var n = this.items.length - 1; 0 <= n; n--)this.items[n].item.removeData("sortable-item");
        return this
    }, _setOption: function (t, i) {
        "disabled" === t ? (this.options[t] = i, this.widget()[i ? "addClass" : "removeClass"]("ui-sortable-disabled")) : n.Widget.prototype._setOption.apply(this, arguments)
    }, _mouseCapture: function (t, i) {
        var r, u, f;
        return this.reverting || this.options.disabled || "static" == this.options.type ? !1 : (this._refreshItems(t), r = null, u = this, n(t.target).parents().each(function () {
            if (n.data(this, "sortable-item") == u)return r = n(this), !1
        }), n.data(t.target, "sortable-item") == u && (r = n(t.target)), !r) ? !1 : this.options.handle && !i && (f = !1, n(this.options.handle, r).find("*").andSelf().each(function () {
            this == t.target && (f = !0)
        }), !f) ? !1 : (this.currentItem = r, this._removeCurrentsFromItems(), !0)
    }, _mouseStart: function (t, i, r) {
        if (i = this.options, this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top: this.offset.top - this.margins.top, left: this.offset.left - this.margins.left}, this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), n.extend(this.offset, {click: {left: t.pageX - this.offset.left, top: t.pageY - this.offset.top}, parent: this._getParentOffset(), relative: this._getRelativeOffset()}), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, i.cursorAt && this._adjustOffsetFromHelper(i.cursorAt), this.domPosition = {prev: this.currentItem.prev()[0], parent: this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), i.containment && this._setContainment(), i.cursor && (n("body").css("cursor") && (this._storedCursor = n("body").css("cursor")), n("body").css("cursor", i.cursor)), i.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", i.opacity)), i.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", i.zIndex)), this.scrollParent[0] != document && "HTML" != this.scrollParent[0].tagName && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions(), !r)for (r = this.containers.length - 1; 0 <= r; r--)this.containers[r]._trigger("activate", t, this._uiHash(this));
        return n.ui.ddmanager && (n.ui.ddmanager.current = this), n.ui.ddmanager && !i.dropBehaviour && n.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
    }, _mouseDrag: function (t) {
        var i, r;
        for (this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs), this.options.scroll && (i = this.options, r = !1, this.scrollParent[0] != document && "HTML" != this.scrollParent[0].tagName ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < i.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + i.scrollSpeed : t.pageY - this.overflowOffset.top < i.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - i.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < i.scrollSensitivity ? this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + i.scrollSpeed : t.pageX - this.overflowOffset.left < i.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - i.scrollSpeed)) : (t.pageY - n(document).scrollTop() < i.scrollSensitivity ? r = n(document).scrollTop(n(document).scrollTop() - i.scrollSpeed) : n(window).height() - (t.pageY - n(document).scrollTop()) < i.scrollSensitivity && (r = n(document).scrollTop(n(document).scrollTop() + i.scrollSpeed)), t.pageX - n(document).scrollLeft() < i.scrollSensitivity ? r = n(document).scrollLeft(n(document).scrollLeft() - i.scrollSpeed) : n(window).width() - (t.pageX - n(document).scrollLeft()) < i.scrollSensitivity && (r = n(document).scrollLeft(n(document).scrollLeft() + i.scrollSpeed))), !1 !== r && n.ui.ddmanager && !i.dropBehaviour && n.ui.ddmanager.prepareOffsets(this, t)), this.positionAbs = this._convertPositionTo("absolute"), this.options.axis && "y" == this.options.axis || (this.helper[0].style.left = this.position.left + "px"), this.options.axis && "x" == this.options.axis || (this.helper[0].style.top = this.position.top + "px"), i = this.items.length - 1; 0 <= i; i--) {
            var r = this.items[i], u = r.item[0], f = this._intersectsWithPointer(r);
            if (f && u != this.currentItem[0] && this.placeholder[1 == f ? "next" : "prev"]()[0] != u && !n.ui.contains(this.placeholder[0], u) && ("semi-dynamic" == this.options.type ? !n.ui.contains(this.element[0], u) : 1)) {
                if (this.direction = 1 == f ? "down" : "up", "pointer" == this.options.tolerance || this._intersectsWithSides(r))this._rearrange(t, r); else break;
                this._trigger("change", t, this._uiHash());
                break
            }
        }
        return this._contactContainers(t), n.ui.ddmanager && n.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
    }, _mouseStop: function (t, i) {
        if (t) {
            if (n.ui.ddmanager && !this.options.dropBehaviour && n.ui.ddmanager.drop(this, t), this.options.revert) {
                var r = this;
                i = r.placeholder.offset();
                r.reverting = !0;
                n(this.helper).animate({left: i.left - this.offset.parent.left - r.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft), top: i.top - this.offset.parent.top - r.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function () {
                    r._clear(t)
                })
            } else this._clear(t, i);
            return!1
        }
    }, cancel: function () {
        if (this.dragging) {
            this._mouseUp({target: null});
            "original" == this.options.helper ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
            for (var t = this.containers.length - 1; 0 <= t; t--)this.containers[t]._trigger("deactivate", null, this._uiHash(this)), this.containers[t].containerCache.over && (this.containers[t]._trigger("out", null, this._uiHash(this)), this.containers[t].containerCache.over = 0)
        }
        return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), "original" != this.options.helper && this.helper && this.helper[0].parentNode && this.helper.remove(), n.extend(this, {helper: null, dragging: !1, reverting: !1, _noFinalSort: null}), this.domPosition.prev ? n(this.domPosition.prev).after(this.currentItem) : n(this.domPosition.parent).prepend(this.currentItem)), this
    }, serialize: function (t) {
        var r = this._getItemsAsjQuery(t && t.connected), i = [];
        return t = t || {}, n(r).each(function () {
            var r = (n(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[-=_](.+)/);
            r && i.push((t.key || r[1] + "[]") + "=" + (t.key && t.expression ? r[1] : r[2]))
        }), !i.length && t.key && i.push(t.key + "="), i.join("&")
    }, toArray: function (t) {
        var r = this._getItemsAsjQuery(t && t.connected), i = [];
        return t = t || {}, r.each(function () {
            i.push(n(t.item || this).attr(t.attribute || "id") || "")
        }), i
    }, _intersectsWith: function (n) {
        var t = this.positionAbs.left, h = t + this.helperProportions.width, i = this.positionAbs.top, c = i + this.helperProportions.height, r = n.left, f = r + n.width, u = n.top, e = u + n.height, o = this.offset.click.top, s = this.offset.click.left;
        return"pointer" == this.options.tolerance || this.options.forcePointerForContainers || "pointer" != this.options.tolerance && this.helperProportions[this.floating ? "width" : "height"] > n[this.floating ? "width" : "height"] ? i + o > u && i + o < e && t + s > r && t + s < f : r < t + this.helperProportions.width / 2 && h - this.helperProportions.width / 2 < f && u < i + this.helperProportions.height / 2 && c - this.helperProportions.height / 2 < e
    }, _intersectsWithPointer: function (t) {
        var i = n.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top, t.height), r;
        return t = n.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left, t.width), i = i && t, t = this._getDragVerticalDirection(), r = this._getDragHorizontalDirection(), i ? this.floating ? r && "right" == r || "down" == t ? 2 : 1 : t && ("down" == t ? 2 : 1) : !1
    }, _intersectsWithSides: function (t) {
        var u = n.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height), i, r;
        return t = n.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width), i = this._getDragVerticalDirection(), r = this._getDragHorizontalDirection(), this.floating && r ? "right" == r && t || "left" == r && !t : i && ("down" == i && u || "up" == i && !u)
    }, _getDragVerticalDirection: function () {
        var n = this.positionAbs.top - this.lastPositionAbs.top;
        return 0 != n && (0 < n ? "down" : "up")
    }, _getDragHorizontalDirection: function () {
        var n = this.positionAbs.left - this.lastPositionAbs.left;
        return 0 != n && (0 < n ? "right" : "left")
    }, refresh: function (n) {
        return this._refreshItems(n), this.refreshPositions(), this
    }, _connectWith: function () {
        var n = this.options;
        return n.connectWith.constructor == String ? [n.connectWith] : n.connectWith
    }, _getItemsAsjQuery: function (t) {
        var o = [], r = [], f = this._connectWith(), e, u, i;
        if (f && t)for (t = f.length - 1; 0 <= t; t--)for (e = n(f[t]), u = e.length - 1; 0 <= u; u--)i = n.data(e[u], "sortable"), i && i != this && !i.options.disabled && r.push([n.isFunction(i.options.items) ? i.options.items.call(i.element) : n(i.options.items, i.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), i]);
        for (r.push([n.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options: this.options, item: this.currentItem}) : n(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]), t = r.length - 1; 0 <= t; t--)r[t][0].each(function () {
            o.push(this)
        });
        return n(o)
    }, _removeCurrentsFromItems: function () {
        for (var t, i = this.currentItem.find(":data(sortable-item)"), n = 0; n < this.items.length; n++)for (t = 0; t < i.length; t++)i[t] == this.items[n].item[0] && this.items.splice(n, 1)
    }, _refreshItems: function (t) {
        var r, e, u, i;
        this.items = [];
        this.containers = [this];
        var s = this.items, o = [
            [n.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {item: this.currentItem}) : n(this.options.items, this.element), this]
        ], f = this._connectWith();
        if (f)for (r = f.length - 1; 0 <= r; r--)for (e = n(f[r]), u = e.length - 1; 0 <= u; u--)i = n.data(e[u], "sortable"), i && i != this && !i.options.disabled && (o.push([n.isFunction(i.options.items) ? i.options.items.call(i.element[0], t, {item: this.currentItem}) : n(i.options.items, i.element), i]), this.containers.push(i));
        for (r = o.length - 1; 0 <= r; r--)for (t = o[r][1], f = o[r][0], u = 0, e = f.length; u < e; u++)i = n(f[u]), i.data("sortable-item", t), s.push({item: i, instance: t, width: 0, height: 0, left: 0, top: 0})
    }, refreshPositions: function (t) {
        var i, u, r;
        for (this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset()), i = this.items.length - 1; 0 <= i; i--)u = this.items[i], r = this.options.toleranceElement ? n(this.options.toleranceElement, u.item) : u.item, t || (u.width = r.outerWidth(), u.height = r.outerHeight()), r = r.offset(), u.left = r.left, u.top = r.top;
        if (this.options.custom && this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this); else for (i = this.containers.length - 1; 0 <= i; i--)r = this.containers[i].element.offset(), this.containers[i].containerCache.left = r.left, this.containers[i].containerCache.top = r.top, this.containers[i].containerCache.width = this.containers[i].element.outerWidth(), this.containers[i].containerCache.height = this.containers[i].element.outerHeight();
        return this
    }, _createPlaceholder: function (t) {
        var i = t || this, r = i.options, u;
        r.placeholder && r.placeholder.constructor != String || (u = r.placeholder, r.placeholder = {element: function () {
            var t = n(document.createElement(i.currentItem[0].nodeName)).addClass(u || i.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
            return u || (t.style.visibility = "hidden"), t
        }, update: function (n, t) {
            (!u || r.forcePlaceholderSize) && (t.height() || t.height(i.currentItem.innerHeight() - parseInt(i.currentItem.css("paddingTop") || 0, 10) - parseInt(i.currentItem.css("paddingBottom") || 0, 10)), t.width() || t.width(i.currentItem.innerWidth() - parseInt(i.currentItem.css("paddingLeft") || 0, 10) - parseInt(i.currentItem.css("paddingRight") || 0, 10)))
        }});
        i.placeholder = n(r.placeholder.element.call(i.element, i.currentItem));
        i.currentItem.after(i.placeholder);
        r.placeholder.update(i, i.placeholder)
    }, _contactContainers: function (t) {
        for (var e, u = null, r = null, i = this.containers.length - 1; 0 <= i; i--)n.ui.contains(this.currentItem[0], this.containers[i].element[0]) || (this._intersectsWith(this.containers[i].containerCache) ? u && n.ui.contains(this.containers[i].element[0], u.element[0]) || (u = this.containers[i], r = i) : this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0));
        if (u)if (1 === this.containers.length)this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1; else if (this.currentContainer != this.containers[r]) {
            for (var u = 1e4, i = null, o = this.positionAbs[this.containers[r].floating ? "left" : "top"], f = this.items.length - 1; 0 <= f; f--)n.ui.contains(this.containers[r].element[0], this.items[f].item[0]) && (e = this.items[f][this.containers[r].floating ? "left" : "top"], Math.abs(e - o) < u && (u = Math.abs(e - o), i = this.items[f]));
            (i || this.options.dropOnEmpty) && (this.currentContainer = this.containers[r], i ? this._rearrange(t, i, null, !0) : this._rearrange(t, null, this.containers[r].element, !0), this._trigger("change", t, this._uiHash()), this.containers[r]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1)
        }
    }, _createHelper: function (t) {
        var i = this.options;
        return t = n.isFunction(i.helper) ? n(i.helper.apply(this.element[0], [t, this.currentItem])) : "clone" == i.helper ? this.currentItem.clone() : this.currentItem, t.parents("body").length || n("parent" != i.appendTo ? i.appendTo : this.currentItem[0].parentNode)[0].appendChild(t[0]), t[0] == this.currentItem[0] && (this._storedCSS = {width: this.currentItem[0].style.width, height: this.currentItem[0].style.height, position: this.currentItem.css("position"), top: this.currentItem.css("top"), left: this.currentItem.css("left")}), ("" == t[0].style.width || i.forceHelperSize) && t.width(this.currentItem.width()), ("" == t[0].style.height || i.forceHelperSize) && t.height(this.currentItem.height()), t
    }, _adjustOffsetFromHelper: function (t) {
        "string" == typeof t && (t = t.split(" "));
        n.isArray(t) && (t = {left: +t[0], top: +t[1] || 0});
        "left"in t && (this.offset.click.left = t.left + this.margins.left);
        "right"in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left);
        "top"in t && (this.offset.click.top = t.top + this.margins.top);
        "bottom"in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
    }, _getParentOffset: function () {
        this.offsetParent = this.helper.offsetParent();
        var t = this.offsetParent.offset();
        return"absolute" == this.cssPosition && this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop()), (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && "html" == this.offsetParent[0].tagName.toLowerCase() && n.browser.msie) && (t = {top: 0, left: 0}), {top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0), left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
    }, _getRelativeOffset: function () {
        if ("relative" == this.cssPosition) {
            var n = this.currentItem.position();
            return{top: n.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(), left: n.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
        }
        return{top: 0, left: 0}
    }, _cacheMargins: function () {
        this.margins = {left: parseInt(this.currentItem.css("marginLeft"), 10) || 0, top: parseInt(this.currentItem.css("marginTop"), 10) || 0}
    }, _cacheHelperProportions: function () {
        this.helperProportions = {width: this.helper.outerWidth(), height: this.helper.outerHeight()}
    }, _setContainment: function () {
        var i = this.options;
        if ("parent" == i.containment && (i.containment = this.helper[0].parentNode), ("document" == i.containment || "window" == i.containment) && (this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, n("document" == i.containment ? document : window).width() - this.helperProportions.width - this.margins.left, (n("document" == i.containment ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top]), !/^(document|window|parent)$/.test(i.containment)) {
            var t = n(i.containment)[0], i = n(i.containment).offset(), r = "hidden" != n(t).css("overflow");
            this.containment = [i.left + (parseInt(n(t).css("borderLeftWidth"), 10) || 0) + (parseInt(n(t).css("paddingLeft"), 10) || 0) - this.margins.left, i.top + (parseInt(n(t).css("borderTopWidth"), 10) || 0) + (parseInt(n(t).css("paddingTop"), 10) || 0) - this.margins.top, i.left + (r ? Math.max(t.scrollWidth, t.offsetWidth) : t.offsetWidth) - (parseInt(n(t).css("borderLeftWidth"), 10) || 0) - (parseInt(n(t).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, i.top + (r ? Math.max(t.scrollHeight, t.offsetHeight) : t.offsetHeight) - (parseInt(n(t).css("borderTopWidth"), 10) || 0) - (parseInt(n(t).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
        }
    }, _convertPositionTo: function (t, i) {
        i || (i = this.position);
        t = "absolute" == t ? 1 : -1;
        var r = "absolute" != this.cssPosition || this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, u = /(html|body)/i.test(r[0].tagName);
        return{top: i.top + this.offset.relative.top * t + this.offset.parent.top * t - (n.browser.safari && "fixed" == this.cssPosition ? 0 : ("fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : u ? 0 : r.scrollTop()) * t), left: i.left + this.offset.relative.left * t + this.offset.parent.left * t - (n.browser.safari && "fixed" == this.cssPosition ? 0 : ("fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : u ? 0 : r.scrollLeft()) * t)}
    }, _generatePosition: function (t) {
        var u = this.options, f = "absolute" != this.cssPosition || this.scrollParent[0] != document && n.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, e = /(html|body)/i.test(f[0].tagName), i, r;
        return"relative" != this.cssPosition || this.scrollParent[0] != document && this.scrollParent[0] != this.offsetParent[0] || (this.offset.relative = this._getRelativeOffset()), i = t.pageX, r = t.pageY, this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (i = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (r = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (i = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (r = this.containment[3] + this.offset.click.top)), u.grid && (r = this.originalPageY + Math.round((r - this.originalPageY) / u.grid[1]) * u.grid[1], r = this.containment ? r - this.offset.click.top < this.containment[1] || r - this.offset.click.top > this.containment[3] ? r - this.offset.click.top < this.containment[1] ? r + u.grid[1] : r - u.grid[1] : r : r, i = this.originalPageX + Math.round((i - this.originalPageX) / u.grid[0]) * u.grid[0], i = this.containment ? i - this.offset.click.left < this.containment[0] || i - this.offset.click.left > this.containment[2] ? i - this.offset.click.left < this.containment[0] ? i + u.grid[0] : i - u.grid[0] : i : i)), {top: r - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (n.browser.safari && "fixed" == this.cssPosition ? 0 : "fixed" == this.cssPosition ? -this.scrollParent.scrollTop() : e ? 0 : f.scrollTop()), left: i - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (n.browser.safari && "fixed" == this.cssPosition ? 0 : "fixed" == this.cssPosition ? -this.scrollParent.scrollLeft() : e ? 0 : f.scrollLeft())}
    }, _rearrange: function (n, t, i, r) {
        i ? i[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], "down" == this.direction ? t.item[0] : t.item[0].nextSibling);
        this.counter = this.counter ? ++this.counter : 1;
        var u = this, f = this.counter;
        window.setTimeout(function () {
            f == u.counter && u.refreshPositions(!r)
        }, 0)
    }, _clear: function (t, i) {
        var u, r;
        if (this.reverting = !1, u = [], !this._noFinalSort && this.currentItem[0].parentNode && this.placeholder.before(this.currentItem), this._noFinalSort = null, this.helper[0] == this.currentItem[0]) {
            for (r in this._storedCSS)("auto" == this._storedCSS[r] || "static" == this._storedCSS[r]) && (this._storedCSS[r] = "");
            this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
        } else this.currentItem.show();
        if (this.fromOutside && !i && u.push(function (n) {
            this._trigger("receive", n, this._uiHash(this.fromOutside))
        }), !this.fromOutside && this.domPosition.prev == this.currentItem.prev().not(".ui-sortable-helper")[0] && this.domPosition.parent == this.currentItem.parent()[0] || i || u.push(function (n) {
            this._trigger("update", n, this._uiHash())
        }), !n.ui.contains(this.element[0], this.currentItem[0]))for (i || u.push(function (n) {
            this._trigger("remove", n, this._uiHash())
        }), r = this.containers.length - 1; 0 <= r; r--)n.ui.contains(this.containers[r].element[0], this.currentItem[0]) && !i && (u.push(function (n) {
            return function (t) {
                n._trigger("receive", t, this._uiHash(this))
            }
        }.call(this, this.containers[r])), u.push(function (n) {
            return function (t) {
                n._trigger("update", t, this._uiHash(this))
            }
        }.call(this, this.containers[r])));
        for (r = this.containers.length - 1; 0 <= r; r--)i || u.push(function (n) {
            return function (t) {
                n._trigger("deactivate", t, this._uiHash(this))
            }
        }.call(this, this.containers[r])), this.containers[r].containerCache.over && (u.push(function (n) {
            return function (t) {
                n._trigger("out", t, this._uiHash(this))
            }
        }.call(this, this.containers[r])), this.containers[r].containerCache.over = 0);
        if (this._storedCursor && n("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", "auto" == this._storedZIndex ? "" : this._storedZIndex), this.dragging = !1, this.cancelHelperRemoval) {
            if (!i) {
                for (this._trigger("beforeStop", t, this._uiHash()), r = 0; r < u.length; r++)u[r].call(this, t);
                this._trigger("stop", t, this._uiHash())
            }
            return!1
        }
        if (i || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null, !i) {
            for (r = 0; r < u.length; r++)u[r].call(this, t);
            this._trigger("stop", t, this._uiHash())
        }
        return this.fromOutside = !1, !0
    }, _trigger: function () {
        !1 === n.Widget.prototype._trigger.apply(this, arguments) && this.cancel()
    }, _uiHash: function (t) {
        var i = t || this;
        return{helper: i.helper, placeholder: i.placeholder || n([]), position: i.position, originalPosition: i.originalPosition, offset: i.positionAbs, item: i.currentItem, sender: t ? t.element : null}
    }});
    n.extend(n.ui.sortable, {version: "1.8.11"})
}(jQuery), function (n) {
    n.widget("ui.slider", n.ui.mouse, {widgetEventPrefix: "slide", options: {animate: !1, distance: 0, max: 100, min: 0, orientation: "horizontal", range: !1, step: 1, value: 0, values: null}, _create: function () {
        var t = this, i = this.options;
        if (this._mouseSliding = this._keySliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget ui-widget-content ui-corner-all"), i.disabled && this.element.addClass("ui-slider-disabled ui-disabled"), this.range = n([]), i.range && (!0 === i.range ? (this.range = n("<div><\/div>"), i.values || (i.values = [this._valueMin(), this._valueMin()]), i.values.length && 2 !== i.values.length && (i.values = [i.values[0], i.values[0]])) : this.range = n("<div><\/div>"), this.range.appendTo(this.element).addClass("ui-slider-range"), "min" !== i.range && "max" !== i.range || this.range.addClass("ui-slider-range-" + i.range), this.range.addClass("ui-widget-header")), 0 === n(".ui-slider-handle", this.element).length && n("<a href='#'><\/a>").appendTo(this.element).addClass("ui-slider-handle"), i.values && i.values.length)for (; n(".ui-slider-handle", this.element).length < i.values.length;)n("<a href='#'><\/a>").appendTo(this.element).addClass("ui-slider-handle");
        this.handles = n(".ui-slider-handle", this.element).addClass("ui-state-default ui-corner-all");
        this.handle = this.handles.eq(0);
        this.handles.add(this.range).filter("a").click(function (n) {
            n.preventDefault()
        }).hover(function () {
            i.disabled || n(this).addClass("ui-state-hover")
        }, function () {
            n(this).removeClass("ui-state-hover")
        }).focus(function () {
            i.disabled ? n(this).blur() : (n(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), n(this).addClass("ui-state-focus"))
        }).blur(function () {
            n(this).removeClass("ui-state-focus")
        });
        this.handles.each(function (t) {
            n(this).data("index.ui-slider-handle", t)
        });
        this.handles.keydown(function (i) {
            var o = !0, f = n(this).data("index.ui-slider-handle"), r, u, e;
            if (!t.options.disabled) {
                switch (i.keyCode) {
                    case n.ui.keyCode.HOME:
                    case n.ui.keyCode.END:
                    case n.ui.keyCode.PAGE_UP:
                    case n.ui.keyCode.PAGE_DOWN:
                    case n.ui.keyCode.UP:
                    case n.ui.keyCode.RIGHT:
                    case n.ui.keyCode.DOWN:
                    case n.ui.keyCode.LEFT:
                        if (o = !1, !t._keySliding && (t._keySliding = !0, n(this).addClass("ui-state-active"), r = t._start(i, f), !1 === r))return
                }
                e = t.options.step;
                r = u = t.options.values && t.options.values.length ? t.values(f) : t.value();
                switch (i.keyCode) {
                    case n.ui.keyCode.HOME:
                        u = t._valueMin();
                        break;
                    case n.ui.keyCode.END:
                        u = t._valueMax();
                        break;
                    case n.ui.keyCode.PAGE_UP:
                        u = t._trimAlignValue(r + (t._valueMax() - t._valueMin()) / 5);
                        break;
                    case n.ui.keyCode.PAGE_DOWN:
                        u = t._trimAlignValue(r - (t._valueMax() - t._valueMin()) / 5);
                        break;
                    case n.ui.keyCode.UP:
                    case n.ui.keyCode.RIGHT:
                        if (r === t._valueMax())return;
                        u = t._trimAlignValue(r + e);
                        break;
                    case n.ui.keyCode.DOWN:
                    case n.ui.keyCode.LEFT:
                        if (r === t._valueMin())return;
                        u = t._trimAlignValue(r - e)
                }
                return t._slide(i, f, u), o
            }
        }).keyup(function (i) {
            var r = n(this).data("index.ui-slider-handle");
            t._keySliding && (t._keySliding = !1, t._stop(i, r), t._change(i, r), n(this).removeClass("ui-state-active"))
        });
        this._refreshValue();
        this._animateOff = !1
    }, destroy: function () {
        return this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"), this._mouseDestroy(), this
    }, _mouseCapture: function (t) {
        var r = this.options, f, e, i, o, u;
        return r.disabled ? !1 : (this.elementSize = {width: this.element.outerWidth(), height: this.element.outerHeight()}, this.elementOffset = this.element.offset(), f = this._normValueFromMouse({x: t.pageX, y: t.pageY}), e = this._valueMax() - this._valueMin() + 1, o = this, this.handles.each(function (t) {
            var r = Math.abs(f - o.values(t));
            e > r && (e = r, i = n(this), u = t)
        }), !0 === r.range && this.values(1) === r.min && (u += 1, i = n(this.handles[u])), !1 === this._start(t, u)) ? !1 : (this._mouseSliding = !0, o._handleIndex = u, i.addClass("ui-state-active").focus(), r = i.offset(), this._clickOffset = n(t.target).parents().andSelf().is(".ui-slider-handle") ? {left: t.pageX - r.left - i.width() / 2, top: t.pageY - r.top - i.height() / 2 - (parseInt(i.css("borderTopWidth"), 10) || 0) - (parseInt(i.css("borderBottomWidth"), 10) || 0) + (parseInt(i.css("marginTop"), 10) || 0)} : {left: 0, top: 0}, this.handles.hasClass("ui-state-hover") || this._slide(t, u, f), this._animateOff = !0)
    }, _mouseStart: function () {
        return!0
    }, _mouseDrag: function (n) {
        var t = this._normValueFromMouse({x: n.pageX, y: n.pageY});
        return this._slide(n, this._handleIndex, t), !1
    }, _mouseStop: function (n) {
        return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(n, this._handleIndex), this._change(n, this._handleIndex), this._clickOffset = this._handleIndex = null, this._animateOff = !1
    }, _detectOrientation: function () {
        this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal"
    }, _normValueFromMouse: function (n) {
        var t;
        return"horizontal" === this.orientation ? (t = this.elementSize.width, n = n.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, n = n.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), t = n / t, 1 < t && (t = 1), 0 > t && (t = 0), "vertical" === this.orientation && (t = 1 - t), n = this._valueMax() - this._valueMin(), this._trimAlignValue(this._valueMin() + t * n)
    }, _start: function (n, t) {
        var i = {handle: this.handles[t], value: this.value()};
        return this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values()), this._trigger("start", n, i)
    }, _slide: function (n, t, i) {
        var r;
        this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), 2 === this.options.values.length && !0 === this.options.range && (0 === t && i > r || 1 === t && i < r) && (i = r), i !== this.values(t) && (r = this.values(), r[t] = i, n = this._trigger("slide", n, {handle: this.handles[t], value: i, values: r}), this.values(t ? 0 : 1), !1 !== n && this.values(t, i, !0))) : i !== this.value() && (n = this._trigger("slide", n, {handle: this.handles[t], value: i}), !1 !== n && this.value(i))
    }, _stop: function (n, t) {
        var i = {handle: this.handles[t], value: this.value()};
        this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values());
        this._trigger("stop", n, i)
    }, _change: function (n, t) {
        if (!this._keySliding && !this._mouseSliding) {
            var i = {handle: this.handles[t], value: this.value()};
            this.options.values && this.options.values.length && (i.value = this.values(t), i.values = this.values());
            this._trigger("change", n, i)
        }
    }, value: function (n) {
        return arguments.length && (this.options.value = this._trimAlignValue(n), this._refreshValue(), this._change(null, 0)), this._value()
    }, values: function (t, i) {
        var u, f, r;
        if (1 < arguments.length && (this.options.values[t] = this._trimAlignValue(i), this._refreshValue(), this._change(null, t)), arguments.length)if (n.isArray(arguments[0])) {
            for (u = this.options.values, f = arguments[0], r = 0; r < u.length; r += 1)u[r] = this._trimAlignValue(f[r]), this._change(null, r);
            this._refreshValue()
        } else return this.options.values && this.options.values.length ? this._values(t) : this.value(); else return this._values()
    }, _setOption: function (t, i) {
        var r, u = 0;
        n.isArray(this.options.values) && (u = this.options.values.length);
        n.Widget.prototype._setOption.apply(this, arguments);
        switch (t) {
            case"disabled":
                i ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.attr("disabled", "disabled"), this.element.addClass("ui-disabled")) : (this.handles.removeAttr("disabled"), this.element.removeClass("ui-disabled"));
                break;
            case"orientation":
                this._detectOrientation();
                this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation);
                this._refreshValue();
                break;
            case"value":
                this._animateOff = !0;
                this._refreshValue();
                this._change(null, 0);
                this._animateOff = !1;
                break;
            case"values":
                for (this._animateOff = !0, this._refreshValue(), r = 0; r < u; r += 1)this._change(null, r);
                this._animateOff = !1
        }
    }, _value: function () {
        return this._trimAlignValue(this.options.value)
    }, _values: function (n) {
        var t, i;
        if (arguments.length)return t = this.options.values[n], this._trimAlignValue(t);
        for (t = this.options.values.slice(), i = 0; i < t.length; i += 1)t[i] = this._trimAlignValue(t[i]);
        return t
    }, _trimAlignValue: function (n) {
        if (n <= this._valueMin())return this._valueMin();
        if (n >= this._valueMax())return this._valueMax();
        var t = 0 < this.options.step ? this.options.step : 1, i = (n - this._valueMin()) % t;
        return alignValue = n - i, 2 * Math.abs(i) >= t && (alignValue += 0 < i ? t : -t), parseFloat(alignValue.toFixed(5))
    }, _valueMin: function () {
        return this.options.min
    }, _valueMax: function () {
        return this.options.max
    }, _refreshValue: function () {
        var f = this.options.range, r = this.options, i = this, u = this._animateOff ? !1 : r.animate, t, e = {}, s, c, o, h;
        this.options.values && this.options.values.length ? this.handles.each(function (f) {
            t = (i.values(f) - i._valueMin()) / (i._valueMax() - i._valueMin()) * 100;
            e["horizontal" === i.orientation ? "left" : "bottom"] = t + "%";
            n(this).stop(1, 1)[u ? "animate" : "css"](e, r.animate);
            !0 === i.options.range && ("horizontal" === i.orientation ? (0 === f && i.range.stop(1, 1)[u ? "animate" : "css"]({left: t + "%"}, r.animate), 1 === f && i.range[u ? "animate" : "css"]({width: t - s + "%"}, {queue: !1, duration: r.animate})) : (0 === f && i.range.stop(1, 1)[u ? "animate" : "css"]({bottom: t + "%"}, r.animate), 1 === f && i.range[u ? "animate" : "css"]({height: t - s + "%"}, {queue: !1, duration: r.animate})));
            s = t
        }) : (c = this.value(), o = this._valueMin(), h = this._valueMax(), t = h !== o ? (c - o) / (h - o) * 100 : 0, e["horizontal" === i.orientation ? "left" : "bottom"] = t + "%", this.handle.stop(1, 1)[u ? "animate" : "css"](e, r.animate), "min" === f && "horizontal" === this.orientation && this.range.stop(1, 1)[u ? "animate" : "css"]({width: t + "%"}, r.animate), "max" === f && "horizontal" === this.orientation && this.range[u ? "animate" : "css"]({width: 100 - t + "%"}, {queue: !1, duration: r.animate}), "min" === f && "vertical" === this.orientation && this.range.stop(1, 1)[u ? "animate" : "css"]({height: t + "%"}, r.animate), "max" === f && "vertical" === this.orientation && this.range[u ? "animate" : "css"]({height: 100 - t + "%"}, {queue: !1, duration: r.animate}))
    }});
    n.extend(n.ui.slider, {version: "1.8.11"})
}(jQuery), function (n, t) {
    function u() {
        this.debug = !1;
        this._curInst = null;
        this._keyEvent = !1;
        this._disabledInputs = [];
        this._inDialog = this._datepickerShowing = !1;
        this._mainDivId = "ui-datepicker-div";
        this._inlineClass = "ui-datepicker-inline";
        this._appendClass = "ui-datepicker-append";
        this._triggerClass = "ui-datepicker-trigger";
        this._dialogClass = "ui-datepicker-dialog";
        this._disableClass = "ui-datepicker-disabled";
        this._unselectableClass = "ui-datepicker-unselectable";
        this._currentClass = "ui-datepicker-current-day";
        this._dayOverClass = "ui-datepicker-days-cell-over";
        this.regional = [];
        this.regional[""] = {closeText: "Done", prevText: "Prev", nextText: "Next", currentText: "Today", monthNames: "January February March April May June July August September October November December".split(" "), monthNamesShort: "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), dayNames: "Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "), dayNamesShort: "Sun Mon Tue Wed Thu Fri Sat".split(" "), dayNamesMin: "Su Mo Tu We Th Fr Sa".split(" "), weekHeader: "Wk", dateFormat: "mm/dd/yy", firstDay: 0, isRTL: !1, showMonthAfterYear: !1, yearSuffix: ""};
        this._defaults = {showOn: "focus", showAnim: "fadeIn", showOptions: {}, defaultDate: null, appendText: "", buttonText: "...", buttonImage: "", buttonImageOnly: !1, hideIfNoPrevNext: !1, navigationAsDateFormat: !1, gotoCurrent: !1, changeMonth: !1, changeYear: !1, yearRange: "c-10:c+10", showOtherMonths: !1, selectOtherMonths: !1, showWeek: !1, calculateWeek: this.iso8601Week, shortYearCutoff: "+10", minDate: null, maxDate: null, duration: "fast", beforeShowDay: null, beforeShow: null, onSelect: null, onChangeMonthYear: null, onClose: null, numberOfMonths: 1, showCurrentAtPos: 0, stepMonths: 1, stepBigMonths: 12, altField: "", altFormat: "", constrainInput: !0, showButtonPanel: !1, autoSize: !1};
        n.extend(this._defaults, this.regional[""]);
        this.dpDiv = n('<div id="' + this._mainDivId + '" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"><\/div>')
    }

    function r(i, r) {
        n.extend(i, r);
        for (var u in r)(null == r[u] || r[u] == t) && (i[u] = r[u]);
        return i
    }

    n.extend(n.ui, {datepicker: {version: "1.8.11"}});
    var i = (new Date).getTime();
    n.extend(u.prototype, {markerClassName: "hasDatepicker", log: function () {
        this.debug && console.log.apply("", arguments)
    }, _widgetDatepicker: function () {
        return this.dpDiv
    }, setDefaults: function (n) {
        return r(this._defaults, n || {}), this
    }, _attachDatepicker: function (b, c) {
        var d = null, e, l, q;
        for (e in this._defaults)if (l = b.getAttribute("date:" + e), l) {
            d = d || {};
            try {
                d[e] = eval(l)
            } catch (m) {
                d[e] = l
            }
        }
        e = b.nodeName.toLowerCase();
        l = "div" == e || "span" == e;
        b.id || (this.uuid += 1, b.id = "dp" + this.uuid);
        q = this._newInst(n(b), l);
        q.settings = n.extend({}, c || {}, d || {});
        "input" == e ? this._connectDatepicker(b, q) : l && this._inlineDatepicker(b, q)
    }, _newInst: function (t, i) {
        return{id: t[0].id.replace(/([^A-Za-z0-9_-])/g, "\\\\$1"), input: t, selectedDay: 0, selectedMonth: 0, selectedYear: 0, drawMonth: 0, drawYear: 0, inline: i, dpDiv: i ? n('<div class="' + this._inlineClass + ' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"><\/div>') : this.dpDiv}
    }, _connectDatepicker: function (t, i) {
        var r = n(t);
        i.append = n([]);
        i.trigger = n([]);
        r.hasClass(this.markerClassName) || (this._attachments(r, i), r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker", function (n, t, r) {
            i.settings[t] = r
        }).bind("getData.datepicker", function (n, t) {
            return this._get(i, t)
        }), this._autoSize(i), n.data(t, "datepicker", i))
    }, _attachments: function (t, i) {
        var r = this._get(i, "appendText"), f = this._get(i, "isRTL"), u;
        i.append && i.append.remove();
        r && (i.append = n('<span class="' + this._appendClass + '">' + r + "<\/span>"), t[f ? "before" : "after"](i.append));
        t.unbind("focus", this._showDatepicker);
        i.trigger && i.trigger.remove();
        r = this._get(i, "showOn");
        "focus" != r && "both" != r || t.focus(this._showDatepicker);
        ("button" == r || "both" == r) && (r = this._get(i, "buttonText"), u = this._get(i, "buttonImage"), i.trigger = n(this._get(i, "buttonImageOnly") ? n("<img/>").addClass(this._triggerClass).attr({src: u, alt: r, title: r}) : n('<button type="button"><\/button>').addClass(this._triggerClass).html("" == u ? r : n("<img/>").attr({src: u, alt: r, title: r}))), t[f ? "before" : "after"](i.trigger), i.trigger.click(function () {
            return n.datepicker._datepickerShowing && n.datepicker._lastInput == t[0] ? n.datepicker._hideDatepicker() : n.datepicker._showDatepicker(t[0]), !1
        }))
    }, _autoSize: function (n) {
        var t, i, r;
        this._get(n, "autoSize") && !n.inline && (t = new Date(2009, 11, 20), i = this._get(n, "dateFormat"), i.match(/[DM]/) && (r = function (n) {
            for (var i = 0, r = 0, t = 0; t < n.length; t++)n[t].length > i && (i = n[t].length, r = t);
            return r
        }, t.setMonth(r(this._get(n, i.match(/MM/) ? "monthNames" : "monthNamesShort"))), t.setDate(r(this._get(n, i.match(/DD/) ? "dayNames" : "dayNamesShort")) + 20 - t.getDay())), n.input.attr("size", this._formatDate(n, t).length))
    }, _inlineDatepicker: function (t, i) {
        var r = n(t);
        r.hasClass(this.markerClassName) || (r.addClass(this.markerClassName).append(i.dpDiv).bind("setData.datepicker", function (n, t, r) {
            i.settings[t] = r
        }).bind("getData.datepicker", function (n, t) {
            return this._get(i, t)
        }), n.data(t, "datepicker", i), this._setDate(i, this._getDefaultDate(i), !0), this._updateDatepicker(i), this._updateAlternate(i), i.dpDiv.show())
    }, _dialogDatepicker: function (t, i, u, f, e) {
        return t = this._dialogInst, t || (this.uuid += 1, this._dialogInput = n('<input type="text" id="dp' + this.uuid + '" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>'), this._dialogInput.keydown(this._doKeyDown), n("body").append(this._dialogInput), t = this._dialogInst = this._newInst(this._dialogInput, !1), t.settings = {}, n.data(this._dialogInput[0], "datepicker", t)), r(t.settings, f || {}), i = i && i.constructor == Date ? this._formatDate(t, i) : i, this._dialogInput.val(i), this._pos = e ? e.length ? e : [e.pageX, e.pageY] : null, this._pos || (this._pos = [document.documentElement.clientWidth / 2 - 100 + (document.documentElement.scrollLeft || document.body.scrollLeft), document.documentElement.clientHeight / 2 - 150 + (document.documentElement.scrollTop || document.body.scrollTop)]), this._dialogInput.css("left", this._pos[0] + 20 + "px").css("top", this._pos[1] + "px"), t.settings.onSelect = u, this._inDialog = !0, this.dpDiv.addClass(this._dialogClass), this._showDatepicker(this._dialogInput[0]), n.blockUI && n.blockUI(this.dpDiv), n.data(this._dialogInput[0], "datepicker", t), this
    }, _destroyDatepicker: function (t) {
        var r = n(t), u = n.data(t, "datepicker"), i;
        r.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), n.removeData(t, "datepicker"), "input" == i ? (u.append.remove(), u.trigger.remove(), r.removeClass(this.markerClassName).unbind("focus", this._showDatepicker).unbind("keydown", this._doKeyDown).unbind("keypress", this._doKeyPress).unbind("keyup", this._doKeyUp)) : "div" != i && "span" != i || r.removeClass(this.markerClassName).empty())
    }, _enableDatepicker: function (t) {
        var r = n(t), u = n.data(t, "datepicker"), i;
        r.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), "input" == i ? (t.disabled = !1, u.trigger.filter("button").each(function () {
            this.disabled = !1
        }).end().filter("img").css({opacity: "1.0", cursor: ""})) : "div" != i && "span" != i || r.children("." + this._inlineClass).children().removeClass("ui-state-disabled"), this._disabledInputs = n.map(this._disabledInputs, function (n) {
            return n == t ? null : n
        }))
    }, _disableDatepicker: function (t) {
        var r = n(t), u = n.data(t, "datepicker"), i;
        r.hasClass(this.markerClassName) && (i = t.nodeName.toLowerCase(), "input" == i ? (t.disabled = !0, u.trigger.filter("button").each(function () {
            this.disabled = !0
        }).end().filter("img").css({opacity: "0.5", cursor: "default"})) : "div" != i && "span" != i || r.children("." + this._inlineClass).children().addClass("ui-state-disabled"), this._disabledInputs = n.map(this._disabledInputs, function (n) {
            return n == t ? null : n
        }), this._disabledInputs[this._disabledInputs.length] = t)
    }, _isDisabledDatepicker: function (n) {
        if (!n)return!1;
        for (var t = 0; t < this._disabledInputs.length; t++)if (this._disabledInputs[t] == n)return!0;
        return!1
    }, _getInst: function (t) {
        try {
            return n.data(t, "datepicker")
        } catch (i) {
            throw"Missing instance data for this datepicker";
        }
    }, _optionDatepicker: function (i, u, f) {
        var e = this._getInst(i), o;
        if (2 == arguments.length && "string" == typeof u)return"defaults" == u ? n.extend({}, n.datepicker._defaults) : e ? "all" == u ? n.extend({}, e.settings) : this._get(e, u) : null;
        if (o = u || {}, "string" == typeof u && (o = {}, o[u] = f), e) {
            this._curInst == e && this._hideDatepicker();
            var c = this._getDateDatepicker(i, !0), s = this._getMinMaxDate(e, "min"), h = this._getMinMaxDate(e, "max");
            r(e.settings, o);
            null !== s && o.dateFormat !== t && o.minDate === t && (e.settings.minDate = this._formatDate(e, s));
            null !== h && o.dateFormat !== t && o.maxDate === t && (e.settings.maxDate = this._formatDate(e, h));
            this._attachments(n(i), e);
            this._autoSize(e);
            this._setDateDatepicker(i, c);
            this._updateDatepicker(e)
        }
    }, _changeDatepicker: function (n, t, i) {
        this._optionDatepicker(n, t, i)
    }, _refreshDatepicker: function (n) {
        (n = this._getInst(n)) && this._updateDatepicker(n)
    }, _setDateDatepicker: function (n, t) {
        (n = this._getInst(n)) && (this._setDate(n, t), this._updateDatepicker(n), this._updateAlternate(n))
    }, _getDateDatepicker: function (n, t) {
        return(n = this._getInst(n)) && !n.inline && this._setDateFromField(n, t), n ? this._getDate(n) : null
    }, _doKeyDown: function (t) {
        var i = n.datepicker._getInst(t.target), r = !0, u = i.dpDiv.is(".ui-datepicker-rtl");
        if (i._keyEvent = !0, n.datepicker._datepickerShowing)switch (t.keyCode) {
            case 9:
                n.datepicker._hideDatepicker();
                r = !1;
                break;
            case 13:
                return r = n("td." + n.datepicker._dayOverClass + ":not(." + n.datepicker._currentClass + ")", i.dpDiv), r[0] ? n.datepicker._selectDay(t.target, i.selectedMonth, i.selectedYear, r[0]) : n.datepicker._hideDatepicker(), !1;
            case 27:
                n.datepicker._hideDatepicker();
                break;
            case 33:
                n.datepicker._adjustDate(t.target, t.ctrlKey ? -n.datepicker._get(i, "stepBigMonths") : -n.datepicker._get(i, "stepMonths"), "M");
                break;
            case 34:
                n.datepicker._adjustDate(t.target, t.ctrlKey ? +n.datepicker._get(i, "stepBigMonths") : +n.datepicker._get(i, "stepMonths"), "M");
                break;
            case 35:
                (t.ctrlKey || t.metaKey) && n.datepicker._clearDate(t.target);
                r = t.ctrlKey || t.metaKey;
                break;
            case 36:
                (t.ctrlKey || t.metaKey) && n.datepicker._gotoToday(t.target);
                r = t.ctrlKey || t.metaKey;
                break;
            case 37:
                (t.ctrlKey || t.metaKey) && n.datepicker._adjustDate(t.target, u ? 1 : -1, "D");
                r = t.ctrlKey || t.metaKey;
                t.originalEvent.altKey && n.datepicker._adjustDate(t.target, t.ctrlKey ? -n.datepicker._get(i, "stepBigMonths") : -n.datepicker._get(i, "stepMonths"), "M");
                break;
            case 38:
                (t.ctrlKey || t.metaKey) && n.datepicker._adjustDate(t.target, -7, "D");
                r = t.ctrlKey || t.metaKey;
                break;
            case 39:
                (t.ctrlKey || t.metaKey) && n.datepicker._adjustDate(t.target, u ? -1 : 1, "D");
                r = t.ctrlKey || t.metaKey;
                t.originalEvent.altKey && n.datepicker._adjustDate(t.target, t.ctrlKey ? +n.datepicker._get(i, "stepBigMonths") : +n.datepicker._get(i, "stepMonths"), "M");
                break;
            case 40:
                (t.ctrlKey || t.metaKey) && n.datepicker._adjustDate(t.target, 7, "D");
                r = t.ctrlKey || t.metaKey;
                break;
            default:
                r = !1
        } else 36 == t.keyCode && t.ctrlKey ? n.datepicker._showDatepicker(this) : r = !1;
        r && (t.preventDefault(), t.stopPropagation())
    }, _doKeyPress: function (i) {
        var r = n.datepicker._getInst(i.target), u;
        if (n.datepicker._get(r, "constrainInput"))return r = n.datepicker._possibleChars(n.datepicker._get(r, "dateFormat")), u = String.fromCharCode(i.charCode == t ? i.keyCode : i.charCode), i.ctrlKey || i.metaKey || " " > u || !r || -1 < r.indexOf(u)
    }, _doKeyUp: function (t) {
        if (t = n.datepicker._getInst(t.target), t.input.val() != t.lastVal)try {
            n.datepicker.parseDate(n.datepicker._get(t, "dateFormat"), t.input ? t.input.val() : null, n.datepicker._getFormatConfig(t)) && (n.datepicker._setDateFromField(t), n.datepicker._updateAlternate(t), n.datepicker._updateDatepicker(t))
        } catch (i) {
            n.datepicker.log(i)
        }
        return!0
    }, _showDatepicker: function (t) {
        var i, u, f;
        if (t = t.target || t, "input" != t.nodeName.toLowerCase() && (t = n("input", t.parentNode)[0]), !n.datepicker._isDisabledDatepicker(t) && n.datepicker._lastInput != t && (i = n.datepicker._getInst(t), n.datepicker._curInst && n.datepicker._curInst != i && n.datepicker._curInst.dpDiv.stop(!0, !0), u = n.datepicker._get(i, "beforeShow"), r(i.settings, u ? u.apply(t, [t, i]) : {}), i.lastVal = null, n.datepicker._lastInput = t, n.datepicker._setDateFromField(i), n.datepicker._inDialog && (t.value = ""), n.datepicker._pos || (n.datepicker._pos = n.datepicker._findPos(t), n.datepicker._pos[1] += t.offsetHeight), f = !1, n(t).parents().each(function () {
            return f |= "fixed" == n(this).css("position"), !f
        }), f && n.browser.opera && (n.datepicker._pos[0] -= document.documentElement.scrollLeft, n.datepicker._pos[1] -= document.documentElement.scrollTop), u = {left: n.datepicker._pos[0], top: n.datepicker._pos[1]}, n.datepicker._pos = null, i.dpDiv.empty(), i.dpDiv.css({position: "absolute", display: "block", top: "-1000px"}), n.datepicker._updateDatepicker(i), u = n.datepicker._checkOffset(i, u, f), i.dpDiv.css({position: n.datepicker._inDialog && n.blockUI ? "static" : f ? "fixed" : "absolute", display: "none", left: u.left + "px", top: u.top + "px"}), !i.inline)) {
            var u = n.datepicker._get(i, "showAnim"), e = n.datepicker._get(i, "duration"), o = function () {
                var t, r;
                n.datepicker._datepickerShowing = !0;
                t = i.dpDiv.find("iframe.ui-datepicker-cover");
                t.length && (r = n.datepicker._getBorders(i.dpDiv), t.css({left: -r[0], top: -r[1], width: i.dpDiv.outerWidth(), height: i.dpDiv.outerHeight()}))
            };
            i.dpDiv.zIndex(n(t).zIndex() + 1);
            n.effects && n.effects[u] ? i.dpDiv.show(u, n.datepicker._get(i, "showOptions"), e, o) : i.dpDiv[u || "show"](u ? e : null, o);
            u && e || o();
            i.input.is(":visible") && !i.input.is(":disabled") && i.input.focus();
            n.datepicker._curInst = i
        }
    }, _updateDatepicker: function (t) {
        var f = this, r = n.datepicker._getBorders(t.dpDiv), i, u;
        t.dpDiv.empty().append(this._generateHTML(t));
        i = t.dpDiv.find("iframe.ui-datepicker-cover");
        i.length && i.css({left: -r[0], top: -r[1], width: t.dpDiv.outerWidth(), height: t.dpDiv.outerHeight()});
        t.dpDiv.find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout", function () {
            n(this).removeClass("ui-state-hover");
            -1 != this.className.indexOf("ui-datepicker-prev") && n(this).removeClass("ui-datepicker-prev-hover");
            -1 != this.className.indexOf("ui-datepicker-next") && n(this).removeClass("ui-datepicker-next-hover")
        }).bind("mouseover", function () {
            f._isDisabledDatepicker(t.inline ? t.dpDiv.parent()[0] : t.input[0]) || (n(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"), n(this).addClass("ui-state-hover"), -1 != this.className.indexOf("ui-datepicker-prev") && n(this).addClass("ui-datepicker-prev-hover"), -1 != this.className.indexOf("ui-datepicker-next") && n(this).addClass("ui-datepicker-next-hover"))
        }).end().find("." + this._dayOverClass + " a").trigger("mouseover").end();
        r = this._getNumberOfMonths(t);
        i = r[1];
        1 < i ? t.dpDiv.addClass("ui-datepicker-multi-" + i).css("width", 17 * i + "em") : t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");
        t.dpDiv[(1 != r[0] || 1 != r[1] ? "add" : "remove") + "Class"]("ui-datepicker-multi");
        t.dpDiv[(this._get(t, "isRTL") ? "add" : "remove") + "Class"]("ui-datepicker-rtl");
        t == n.datepicker._curInst && n.datepicker._datepickerShowing && t.input && t.input.is(":visible") && !t.input.is(":disabled") && t.input[0] != document.activeElement && t.input.focus();
        t.yearshtml && (u = t.yearshtml, setTimeout(function () {
            u === t.yearshtml && t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml);
            u = t.yearshtml = null
        }, 0))
    }, _getBorders: function (n) {
        var t = function (n) {
            return{thin: 1, medium: 2, thick: 3}[n] || n
        };
        return[parseFloat(t(n.css("border-left-width"))), parseFloat(t(n.css("border-top-width")))]
    }, _checkOffset: function (t, i, r) {
        var u = t.dpDiv.outerWidth(), f = t.dpDiv.outerHeight(), h = t.input ? t.input.outerWidth() : 0, o = t.input ? t.input.outerHeight() : 0, e = document.documentElement.clientWidth + n(document).scrollLeft(), s = document.documentElement.clientHeight + n(document).scrollTop();
        return i.left -= this._get(t, "isRTL") ? u - h : 0, i.left -= r && i.left == t.input.offset().left ? n(document).scrollLeft() : 0, i.top -= r && i.top == t.input.offset().top + o ? n(document).scrollTop() : 0, i.left -= Math.min(i.left, i.left + u > e && e > u ? Math.abs(i.left + u - e) : 0), i.top -= Math.min(i.top, i.top + f > s && s > f ? Math.abs(f + o) : 0), i
    }, _findPos: function (t) {
        for (var i = this._get(this._getInst(t), "isRTL"); t && ("hidden" == t.type || 1 != t.nodeType || n.expr.filters.hidden(t));)t = t[i ? "previousSibling" : "nextSibling"];
        return t = n(t).offset(), [t.left, t.top]
    }, _hideDatepicker: function (t) {
        var i = this._curInst, u, r;
        i && (!t || i == n.data(t, "datepicker")) && this._datepickerShowing && (t = this._get(i, "showAnim"), u = this._get(i, "duration"), r = function () {
            n.datepicker._tidyDialog(i);
            this._curInst = null
        }, n.effects && n.effects[t] ? i.dpDiv.hide(t, n.datepicker._get(i, "showOptions"), u, r) : i.dpDiv["slideDown" == t ? "slideUp" : "fadeIn" == t ? "fadeOut" : "hide"](t ? u : null, r), t || r(), (t = this._get(i, "onClose")) && t.apply(i.input ? i.input[0] : null, [i.input ? i.input.val() : "", i]), this._datepickerShowing = !1, this._lastInput = null, this._inDialog && (this._dialogInput.css({position: "absolute", left: "0", top: "-100px"}), n.blockUI && (n.unblockUI(), n("body").append(this.dpDiv))), this._inDialog = !1)
    }, _tidyDialog: function (n) {
        n.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")
    }, _checkExternalClick: function (t) {
        n.datepicker._curInst && (t = n(t.target), t[0].id == n.datepicker._mainDivId || 0 != t.parents("#" + n.datepicker._mainDivId).length || t.hasClass(n.datepicker.markerClassName) || t.hasClass(n.datepicker._triggerClass) || !n.datepicker._datepickerShowing || n.datepicker._inDialog && n.blockUI || n.datepicker._hideDatepicker())
    }, _adjustDate: function (t, i, r) {
        t = n(t);
        var u = this._getInst(t[0]);
        this._isDisabledDatepicker(t[0]) || (this._adjustInstDate(u, i + ("M" == r ? this._get(u, "showCurrentAtPos") : 0), r), this._updateDatepicker(u))
    }, _gotoToday: function (t) {
        var i, r;
        t = n(t);
        i = this._getInst(t[0]);
        this._get(i, "gotoCurrent") && i.currentDay ? (i.selectedDay = i.currentDay, i.drawMonth = i.selectedMonth = i.currentMonth, i.drawYear = i.selectedYear = i.currentYear) : (r = new Date, i.selectedDay = r.getDate(), i.drawMonth = i.selectedMonth = r.getMonth(), i.drawYear = i.selectedYear = r.getFullYear());
        this._notifyChange(i);
        this._adjustDate(t)
    }, _selectMonthYear: function (t, i, r) {
        t = n(t);
        var u = this._getInst(t[0]);
        u._selectingMonthYear = !1;
        u["selected" + ("M" == r ? "Month" : "Year")] = u["draw" + ("M" == r ? "Month" : "Year")] = parseInt(i.options[i.selectedIndex].value, 10);
        this._notifyChange(u);
        this._adjustDate(t)
    }, _clickMonthYear: function (t) {
        var i = this._getInst(n(t)[0]);
        i.input && i._selectingMonthYear && setTimeout(function () {
            i.input.focus()
        }, 0);
        i._selectingMonthYear = !i._selectingMonthYear
    }, _selectDay: function (t, i, r, u) {
        var f = n(t);
        n(u).hasClass(this._unselectableClass) || this._isDisabledDatepicker(f[0]) || (f = this._getInst(f[0]), f.selectedDay = f.currentDay = n("a", u).html(), f.selectedMonth = f.currentMonth = i, f.selectedYear = f.currentYear = r, this._selectDate(t, this._formatDate(f, f.currentDay, f.currentMonth, f.currentYear)))
    }, _clearDate: function (t) {
        t = n(t);
        this._getInst(t[0]);
        this._selectDate(t, "")
    }, _selectDate: function (t, i) {
        t = this._getInst(n(t)[0]);
        i = null != i ? i : this._formatDate(t);
        t.input && t.input.val(i);
        this._updateAlternate(t);
        var r = this._get(t, "onSelect");
        r ? r.apply(t.input ? t.input[0] : null, [i, t]) : t.input && t.input.trigger("change");
        t.inline ? this._updateDatepicker(t) : (this._hideDatepicker(), this._lastInput = t.input[0], "object" != typeof t.input[0] && t.input.focus(), this._lastInput = null)
    }, _updateAlternate: function (t) {
        var i = this._get(t, "altField");
        if (i) {
            var r = this._get(t, "altFormat") || this._get(t, "dateFormat"), u = this._getDate(t), f = this.formatDate(r, u, this._getFormatConfig(t));
            n(i).each(function () {
                n(this).val(f)
            })
        }
    }, noWeekends: function (n) {
        return n = n.getDay(), [0 < n && 6 > n, ""]
    }, iso8601Week: function (n) {
        n = new Date(n.getTime());
        n.setDate(n.getDate() + 4 - (n.getDay() || 7));
        var t = n.getTime();
        return n.setMonth(0), n.setDate(1), Math.floor(Math.round((t - n) / 864e5) / 7) + 1
    }, parseDate: function (n, t, i) {
        var r;
        if (null == n || null == t)throw"Invalid arguments";
        if (t = "object" == typeof t ? t.toString() : t + "", "" == t)return null;
        for (var s = (i ? i.shortYearCutoff : null) || this._defaults.shortYearCutoff, s = "string" != typeof s ? s : (new Date).getFullYear() % 100 + parseInt(s, 10), p = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort, w = (i ? i.dayNames : null) || this._defaults.dayNames, b = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort, k = (i ? i.monthNames : null) || this._defaults.monthNames, u = i = -1, e = -1, l = -1, a = !1, c = function (t) {
            return(t = o + 1 < n.length && n.charAt(o + 1) == t) && o++, t
        }, h = function (n) {
            var i = c(n);
            if (n = new RegExp("^\\d{1," + ("@" == n ? 14 : "!" == n ? 20 : "y" == n && i ? 4 : "o" == n ? 3 : 2) + "}"), n = t.substring(f).match(n), !n)throw"Missing number at position " + f;
            return f += n[0].length, parseInt(n[0], 10)
        }, y = function (n, i, r) {
            for (n = c(n) ? r : i, i = 0; i < n.length; i++)if (t.substr(f, n[i].length).toLowerCase() == n[i].toLowerCase())return f += n[i].length, i + 1;
            throw"Unknown name at position " + f;
        }, v = function () {
            if (t.charAt(f) != n.charAt(o))throw"Unexpected literal at position " + f;
            f++
        }, f = 0, o = 0; o < n.length; o++)if (a)"'" != n.charAt(o) || c("'") ? v() : a = !1; else switch (n.charAt(o)) {
            case"d":
                e = h("d");
                break;
            case"D":
                y("D", p, w);
                break;
            case"o":
                l = h("o");
                break;
            case"m":
                u = h("m");
                break;
            case"M":
                u = y("M", b, k);
                break;
            case"y":
                i = h("y");
                break;
            case"@":
                r = new Date(h("@"));
                i = r.getFullYear();
                u = r.getMonth() + 1;
                e = r.getDate();
                break;
            case"!":
                r = new Date((h("!") - this._ticksTo1970) / 1e4);
                i = r.getFullYear();
                u = r.getMonth() + 1;
                e = r.getDate();
                break;
            case"'":
                c("'") ? v() : a = !0;
                break;
            default:
                v()
        }
        if (-1 == i ? i = (new Date).getFullYear() : 100 > i && (i += (new Date).getFullYear() - (new Date).getFullYear() % 100 + (i <= s ? 0 : -100)), -1 < l) {
            u = 1;
            e = l;
            do {
                if (s = this._getDaysInMonth(i, u - 1), e <= s)break;
                u++;
                e -= s
            } while (1)
        }
        if (r = this._daylightSavingAdjust(new Date(i, u - 1, e)), r.getFullYear() != i || r.getMonth() + 1 != u || r.getDate() != e)throw"Invalid date";
        return r
    }, ATOM: "yy-mm-dd", COOKIE: "D, dd M yy", ISO_8601: "yy-mm-dd", RFC_822: "D, d M y", RFC_850: "DD, dd-M-y", RFC_1036: "D, d M y", RFC_1123: "D, d M yy", RFC_2822: "D, d M yy", RSS: "D, d M y", TICKS: "!", TIMESTAMP: "@", W3C: "yy-mm-dd", _ticksTo1970: 864e9 * (718685 + Math.floor(492.5) - Math.floor(19.7) + Math.floor(4.925)), formatDate: function (n, t, i) {
        var u;
        if (!t)return"";
        var h = (i ? i.dayNamesShort : null) || this._defaults.dayNamesShort, c = (i ? i.dayNames : null) || this._defaults.dayNames, l = (i ? i.monthNamesShort : null) || this._defaults.monthNamesShort;
        i = (i ? i.monthNames : null) || this._defaults.monthNames;
        var f = function (t) {
            return(t = u + 1 < n.length && n.charAt(u + 1) == t) && u++, t
        }, e = function (n, t, i) {
            if (t = "" + t, f(n))for (; t.length < i;)t = "0" + t;
            return t
        }, s = function (n, t, i, r) {
            return f(n) ? r[t] : i[t]
        }, r = "", o = !1;
        if (t)for (u = 0; u < n.length; u++)if (o)"'" != n.charAt(u) || f("'") ? r += n.charAt(u) : o = !1; else switch (n.charAt(u)) {
            case"d":
                r += e("d", t.getDate(), 2);
                break;
            case"D":
                r += s("D", t.getDay(), h, c);
                break;
            case"o":
                r += e("o", (t.getTime() - new Date(t.getFullYear(), 0, 0).getTime()) / 864e5, 3);
                break;
            case"m":
                r += e("m", t.getMonth() + 1, 2);
                break;
            case"M":
                r += s("M", t.getMonth(), l, i);
                break;
            case"y":
                r += f("y") ? t.getFullYear() : (10 > t.getYear() % 100 ? "0" : "") + t.getYear() % 100;
                break;
            case"@":
                r += t.getTime();
                break;
            case"!":
                r += 1e4 * t.getTime() + this._ticksTo1970;
                break;
            case"'":
                f("'") ? r += "'" : o = !0;
                break;
            default:
                r += n.charAt(u)
        }
        return r
    }, _possibleChars: function (n) {
        for (var i = "", r = !1, u = function (i) {
            return(i = t + 1 < n.length && n.charAt(t + 1) == i) && t++, i
        }, t = 0; t < n.length; t++)if (r)"'" != n.charAt(t) || u("'") ? i += n.charAt(t) : r = !1; else switch (n.charAt(t)) {
            case"d":
            case"m":
            case"y":
            case"@":
                i += "0123456789";
                break;
            case"D":
            case"M":
                return null;
            case"'":
                u("'") ? i += "'" : r = !0;
                break;
            default:
                i += n.charAt(t)
        }
        return i
    }, _get: function (n, i) {
        return n.settings[i] !== t ? n.settings[i] : this._defaults[i]
    }, _setDateFromField: function (n, t) {
        var u, r, i, f, e;
        if (n.input.val() != n.lastVal) {
            u = this._get(n, "dateFormat");
            r = n.lastVal = n.input ? n.input.val() : null;
            i = f = this._getDefaultDate(n);
            e = this._getFormatConfig(n);
            try {
                i = this.parseDate(u, r, e) || f
            } catch (o) {
                this.log(o);
                r = t ? "" : r
            }
            n.selectedDay = i.getDate();
            n.drawMonth = n.selectedMonth = i.getMonth();
            n.drawYear = n.selectedYear = i.getFullYear();
            n.currentDay = r ? i.getDate() : 0;
            n.currentMonth = r ? i.getMonth() : 0;
            n.currentYear = r ? i.getFullYear() : 0;
            this._adjustInstDate(n)
        }
    }, _getDefaultDate: function (n) {
        return this._restrictMinMax(n, this._determineDate(n, this._get(n, "defaultDate"), new Date))
    }, _determineDate: function (t, i, r) {
        var u = function (n) {
            var t = new Date;
            return t.setDate(t.getDate() + n), t
        }, f = function (i) {
            try {
                return n.datepicker.parseDate(n.datepicker._get(t, "dateFormat"), i, n.datepicker._getFormatConfig(t))
            } catch (s) {
            }
            for (var r = (i.toLowerCase().match(/^c/) ? n.datepicker._getDate(t) : null) || new Date, f = r.getFullYear(), e = r.getMonth(), r = r.getDate(), o = /([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g, u = o.exec(i); u;) {
                switch (u[2] || "d") {
                    case"d":
                    case"D":
                        r += parseInt(u[1], 10);
                        break;
                    case"w":
                    case"W":
                        r += 7 * parseInt(u[1], 10);
                        break;
                    case"m":
                    case"M":
                        e += parseInt(u[1], 10);
                        r = Math.min(r, n.datepicker._getDaysInMonth(f, e));
                        break;
                    case"y":
                    case"Y":
                        f += parseInt(u[1], 10);
                        r = Math.min(r, n.datepicker._getDaysInMonth(f, e))
                }
                u = o.exec(i)
            }
            return new Date(f, e, r)
        };
        return(i = (i = null == i || "" === i ? r : "string" == typeof i ? f(i) : "number" == typeof i ? isNaN(i) ? r : u(i) : new Date(i.getTime())) && "Invalid Date" == i.toString() ? r : i) && (i.setHours(0), i.setMinutes(0), i.setSeconds(0), i.setMilliseconds(0)), this._daylightSavingAdjust(i)
    }, _daylightSavingAdjust: function (n) {
        return n ? (n.setHours(12 < n.getHours() ? n.getHours() + 2 : 0), n) : null
    }, _setDate: function (n, t, i) {
        var r = !t, u = n.selectedMonth, f = n.selectedYear;
        t = this._restrictMinMax(n, this._determineDate(n, t, new Date));
        n.selectedDay = n.currentDay = t.getDate();
        n.drawMonth = n.selectedMonth = n.currentMonth = t.getMonth();
        n.drawYear = n.selectedYear = n.currentYear = t.getFullYear();
        u == n.selectedMonth && f == n.selectedYear || i || this._notifyChange(n);
        this._adjustInstDate(n);
        n.input && n.input.val(r ? "" : this._formatDate(n))
    }, _getDate: function (n) {
        return!n.currentYear || n.input && "" == n.input.val() ? null : this._daylightSavingAdjust(new Date(n.currentYear, n.currentMonth, n.currentDay))
    }, _generateHTML: function (t) {
        var w = new Date, w = this._daylightSavingAdjust(new Date(w.getFullYear(), w.getMonth(), w.getDate())), c = this._get(t, "isRTL"), st = this._get(t, "showButtonPanel"), nt = this._get(t, "hideIfNoPrevNext"), s = this._get(t, "navigationAsDateFormat"), l = this._getNumberOfMonths(t), r = this._get(t, "showCurrentAtPos"), a = this._get(t, "stepMonths"), it = 1 != l[0] || 1 != l[1], rt = this._daylightSavingAdjust(t.currentDay ? new Date(t.currentYear, t.currentMonth, t.currentDay) : new Date(9999, 9, 9)), b = this._getMinMaxDate(t, "min"), y = this._getMinMaxDate(t, "max"), r = t.drawMonth - r, f = t.drawYear, o, et, k, u, p;
        if (0 > r && (r += 12, f--), y)for (o = this._daylightSavingAdjust(new Date(y.getFullYear(), y.getMonth() - l[0] * l[1] + 1, y.getDate())), o = b && o < b ? b : o; this._daylightSavingAdjust(new Date(f, r, 1)) > o;)r--, 0 > r && (r = 11, f--);
        t.drawMonth = r;
        t.drawYear = f;
        var o = this._get(t, "prevText"), o = s ? this.formatDate(o, this._daylightSavingAdjust(new Date(f, r - a, 1)), this._getFormatConfig(t)) : o, o = this._canAdjustMonth(t, -1, f, r) ? '<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_' + i + ".datepicker._adjustDate('#" + t.id + "', -" + a + ", 'M');\" title=\"" + o + '"><span class="ui-icon ui-icon-circle-triangle-' + (c ? "e" : "w") + '">' + o + "<\/span><\/a>" : nt ? "" : '<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="' + o + '"><span class="ui-icon ui-icon-circle-triangle-' + (c ? "e" : "w") + '">' + o + "<\/span><\/a>", v = this._get(t, "nextText"), v = s ? this.formatDate(v, this._daylightSavingAdjust(new Date(f, r + a, 1)), this._getFormatConfig(t)) : v, nt = this._canAdjustMonth(t, 1, f, r) ? '<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_' + i + ".datepicker._adjustDate('#" + t.id + "', +" + a + ", 'M');\" title=\"" + v + '"><span class="ui-icon ui-icon-circle-triangle-' + (c ? "w" : "e") + '">' + v + "<\/span><\/a>" : nt ? "" : '<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="' + v + '"><span class="ui-icon ui-icon-circle-triangle-' + (c ? "w" : "e") + '">' + v + "<\/span><\/a>", a = this._get(t, "currentText"), v = this._get(t, "gotoCurrent") && t.currentDay ? rt : w, a = s ? this.formatDate(a, v, this._getFormatConfig(t)) : a, s = t.inline ? "" : '<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_' + i + '.datepicker._hideDatepicker();">' + this._get(t, "closeText") + "<\/button>", st = st ? '<div class="ui-datepicker-buttonpane ui-widget-content">' + (c ? s : "") + (this._isInRange(t, v) ? '<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_' + i + ".datepicker._gotoToday('#" + t.id + "');\">" + a + "<\/button>" : "") + (c ? "" : s) + "<\/div>" : "", s = parseInt(this._get(t, "firstDay"), 10), s = isNaN(s) ? 0 : s, a = this._get(t, "showWeek"), v = this._get(t, "dayNames");
        this._get(t, "dayNamesShort");
        var yt = this._get(t, "dayNamesMin"), pt = this._get(t, "monthNames"), wt = this._get(t, "monthNamesShort"), ht = this._get(t, "beforeShowDay"), ut = this._get(t, "showOtherMonths"), bt = this._get(t, "selectOtherMonths");
        this._get(t, "calculateWeek");
        for (var ct = this._getDefaultDate(t), ft = "", g = 0; g < l[0]; g++) {
            for (et = "", k = 0; k < l[1]; k++) {
                var lt = this._daylightSavingAdjust(new Date(f, r, t.selectedDay)), e = " ui-corner-all", h = "";
                if (it) {
                    if (h += '<div class="ui-datepicker-group', 1 < l[1])switch (k) {
                        case 0:
                            h += " ui-datepicker-group-first";
                            e = " ui-corner-" + (c ? "right" : "left");
                            break;
                        case l[1] - 1:
                            h += " ui-datepicker-group-last";
                            e = " ui-corner-" + (c ? "left" : "right");
                            break;
                        default:
                            h += " ui-datepicker-group-middle";
                            e = ""
                    }
                    h += '">'
                }
                for (var h = h + ('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix' + e + '">' + (/all|left/.test(e) && 0 == g ? c ? nt : o : "") + (/all|right/.test(e) && 0 == g ? c ? o : nt : "") + this._generateMonthYearHeader(t, r, f, b, y, 0 < g || 0 < k, pt, wt) + '<\/div><table class="ui-datepicker-calendar"><thead><tr>'), p = a ? '<th class="ui-datepicker-week-col">' + this._get(t, "weekHeader") + "<\/th>" : "", e = 0; 7 > e; e++)u = (e + s) % 7, p = p + ("<th" + (5 <= (e + s + 6) % 7 ? ' class="ui-datepicker-week-end"' : "") + '><span title="' + v[u] + '">' + yt[u] + "<\/span><\/th>");
                h += p + "<\/tr><\/thead><tbody>";
                p = this._getDaysInMonth(f, r);
                f == t.selectedYear && r == t.selectedMonth && (t.selectedDay = Math.min(t.selectedDay, p));
                for (var e = (this._getFirstDayOfMonth(f, r, t.selectedDay) - s + 7) % 7, p = it ? 6 : Math.ceil((e + p) / 7), u = this._daylightSavingAdjust(new Date(f, r, 1 - e)), at = 0; at < p; at++) {
                    for (var h = h + "<tr>", vt = a ? '<td class="ui-datepicker-week-col">' + this._get(t, "calculateWeek")(u) + "<\/td>" : "", e = 0; 7 > e; e++) {
                        var tt = ht ? ht.apply(t.input ? t.input[0] : null, [u]) : [!0, ""], d = u.getMonth() != r, ot = d && !bt || !tt[0] || b && u < b || y && u > y, vt = vt + ('<td class="' + (5 <= (e + s + 6) % 7 ? " ui-datepicker-week-end" : "") + (d ? " ui-datepicker-other-month" : "") + (u.getTime() == lt.getTime() && r == t.selectedMonth && t._keyEvent || ct.getTime() == u.getTime() && ct.getTime() == lt.getTime() ? " " + this._dayOverClass : "") + (ot ? " " + this._unselectableClass + " ui-state-disabled" : "") + (d && !ut ? "" : " " + tt[1] + (u.getTime() == rt.getTime() ? " " + this._currentClass : "") + (u.getTime() == w.getTime() ? " ui-datepicker-today" : "")) + '"' + (d && !ut || !tt[2] ? "" : ' title="' + tt[2] + '"') + (ot ? "" : ' onclick="DP_jQuery_' + i + ".datepicker._selectDay('#" + t.id + "'," + u.getMonth() + "," + u.getFullYear() + ', this);return false;"') + ">" + (d && !ut ? "&#xa0;" : ot ? '<span class="ui-state-default">' + u.getDate() + "<\/span>" : '<a class="ui-state-default' + (u.getTime() == w.getTime() ? " ui-state-highlight" : "") + (u.getTime() == rt.getTime() ? " ui-state-active" : "") + (d ? " ui-priority-secondary" : "") + '" href="#">' + u.getDate() + "<\/a>") + "<\/td>");
                        u.setDate(u.getDate() + 1);
                        u = this._daylightSavingAdjust(u)
                    }
                    h += vt + "<\/tr>"
                }
                r++;
                11 < r && (r = 0, f++);
                h += "<\/tbody><\/table>" + (it ? "<\/div>" + (0 < l[0] && k == l[1] - 1 ? '<div class="ui-datepicker-row-break"><\/div>' : "") : "");
                et += h
            }
            ft += et
        }
        return ft += st + (n.browser.msie && 7 > parseInt(n.browser.version, 10) && !t.inline ? '<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"><\/iframe>' : ""), t._keyEvent = !1, ft
    }, _generateMonthYearHeader: function (t, r, u, f, e, o, s, h) {
        var v = this._get(t, "changeMonth"), y = this._get(t, "changeYear"), w = this._get(t, "showMonthAfterYear"), c = '<div class="ui-datepicker-title">', a = "", p;
        if (o || !v)a += '<span class="ui-datepicker-month">' + s[r] + "<\/span>"; else {
            s = f && f.getFullYear() == u;
            for (var b = e && e.getFullYear() == u, a = a + ('<select class="ui-datepicker-month" onchange="DP_jQuery_' + i + ".datepicker._selectMonthYear('#" + t.id + "', this, 'M');\" onclick=\"DP_jQuery_" + i + ".datepicker._clickMonthYear('#" + t.id + "');\">"), l = 0; 12 > l; l++)(!s || l >= f.getMonth()) && (!b || l <= e.getMonth()) && (a += '<option value="' + l + '"' + (l == r ? ' selected="selected"' : "") + ">" + h[l] + "<\/option>");
            a += "<\/select>"
        }
        if (w || (c += a + (!o && v && y ? "" : "&#xa0;")), t.yearshtml = "", o || !y)c += '<span class="ui-datepicker-year">' + u + "<\/span>"; else {
            for (h = this._get(t, "yearRange").split(":"), p = (new Date).getFullYear(), s = function (n) {
                return n = n.match(/c[+-].*/) ? u + parseInt(n.substring(1), 10) : n.match(/[+-].*/) ? p + parseInt(n, 10) : parseInt(n, 10), isNaN(n) ? p : n
            }, r = s(h[0]), h = Math.max(r, s(h[1] || "")), r = f ? Math.max(r, f.getFullYear()) : r, h = e ? Math.min(h, e.getFullYear()) : h, t.yearshtml += '<select class="ui-datepicker-year" onchange="DP_jQuery_' + i + ".datepicker._selectMonthYear('#" + t.id + "', this, 'Y');\" onclick=\"DP_jQuery_" + i + ".datepicker._clickMonthYear('#" + t.id + "');\">"; r <= h; r++)t.yearshtml += '<option value="' + r + '"' + (r == u ? ' selected="selected"' : "") + ">" + r + "<\/option>";
            t.yearshtml += "<\/select>";
            n.browser.mozilla ? c += '<select class="ui-datepicker-year"><option value="' + u + '" selected="selected">' + u + "<\/option><\/select>" : (c += t.yearshtml, t.yearshtml = null)
        }
        return c += this._get(t, "yearSuffix"), w && (c += (!o && v && y ? "" : "&#xa0;") + a), c + "<\/div>"
    }, _adjustInstDate: function (n, t, i) {
        var r = n.drawYear + ("Y" == i ? t : 0), u = n.drawMonth + ("M" == i ? t : 0);
        t = Math.min(n.selectedDay, this._getDaysInMonth(r, u)) + ("D" == i ? t : 0);
        r = this._restrictMinMax(n, this._daylightSavingAdjust(new Date(r, u, t)));
        n.selectedDay = r.getDate();
        n.drawMonth = n.selectedMonth = r.getMonth();
        n.drawYear = n.selectedYear = r.getFullYear();
        "M" != i && "Y" != i || this._notifyChange(n)
    }, _restrictMinMax: function (n, t) {
        var i = this._getMinMaxDate(n, "min");
        return n = this._getMinMaxDate(n, "max"), t = i && t < i ? i : t, n && t > n ? n : t
    }, _notifyChange: function (n) {
        var t = this._get(n, "onChangeMonthYear");
        t && t.apply(n.input ? n.input[0] : null, [n.selectedYear, n.selectedMonth + 1, n])
    }, _getNumberOfMonths: function (n) {
        return n = this._get(n, "numberOfMonths"), null == n ? [1, 1] : "number" == typeof n ? [1, n] : n
    }, _getMinMaxDate: function (n, t) {
        return this._determineDate(n, this._get(n, t + "Date"), null)
    }, _getDaysInMonth: function (n, t) {
        return 32 - this._daylightSavingAdjust(new Date(n, t, 32)).getDate()
    }, _getFirstDayOfMonth: function (n, t, i) {
        var r = getPersianDate(n, t, i);
        return jalaliToGregorian(r[0], r[1], 1).getDay()
    }, _canAdjustMonth: function (n, t, i, r) {
        var u = this._getNumberOfMonths(n);
        return i = this._daylightSavingAdjust(new Date(i, r + (0 > t ? t : u[0] * u[1]), 1)), 0 > t && i.setDate(this._getDaysInMonth(i.getFullYear(), i.getMonth())), this._isInRange(n, i)
    }, _isInRange: function (n, t) {
        var i = this._getMinMaxDate(n, "min");
        return n = this._getMinMaxDate(n, "max"), (!i || t.getTime() >= i.getTime()) && (!n || t.getTime() <= n.getTime())
    }, _getFormatConfig: function (n) {
        var t = this._get(n, "shortYearCutoff"), t = "string" != typeof t ? t : (new Date).getFullYear() % 100 + parseInt(t, 10);
        return{shortYearCutoff: t, dayNamesShort: this._get(n, "dayNamesShort"), dayNames: this._get(n, "dayNames"), monthNamesShort: this._get(n, "monthNamesShort"), monthNames: this._get(n, "monthNames")}
    }, _formatDate: function (n, t, i, r) {
        return t || (n.currentDay = n.selectedDay, n.currentMonth = n.selectedMonth, n.currentYear = n.selectedYear), t = t ? "object" == typeof t ? t : this._daylightSavingAdjust(new Date(r, i, t)) : this._daylightSavingAdjust(new Date(n.currentYear, n.currentMonth, n.currentDay)), this.formatDate(this._get(n, "dateFormat"), t, this._getFormatConfig(n))
    }});
    n.fn.datepicker = function (t) {
        if (!this.length)return this;
        n.datepicker.initialized || (n(document).mousedown(n.datepicker._checkExternalClick).find("body").append(n.datepicker.dpDiv), n.datepicker.initialized = !0);
        var i = Array.prototype.slice.call(arguments, 1);
        return"string" == typeof t && ("isDisabled" == t || "getDate" == t || "widget" == t) || "option" == t && 2 == arguments.length && "string" == typeof arguments[1] ? n.datepicker["_" + t + "Datepicker"].apply(n.datepicker, [this[0]].concat(i)) : this.each(function () {
            "string" == typeof t ? n.datepicker["_" + t + "Datepicker"].apply(n.datepicker, [this].concat(i)) : n.datepicker._attachDatepicker(this, t)
        })
    };
    n.datepicker = new u;
    n.datepicker.initialized = !1;
    n.datepicker.uuid = (new Date).getTime();
    n.datepicker.version = "1.8.11";
    window["DP_jQuery_" + i] = n
}(jQuery);
jQuery.effects || function (n, t) {
    function u(t) {
        var i;
        return t && t.constructor == Array && 3 == t.length ? t : (i = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t)) ? [parseInt(i[1], 10), parseInt(i[2], 10), parseInt(i[3], 10)] : (i = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t)) ? [2.55 * parseFloat(i[1]), 2.55 * parseFloat(i[2]), 2.55 * parseFloat(i[3])] : (i = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t)) ? [parseInt(i[1], 16), parseInt(i[2], 16), parseInt(i[3], 16)] : (i = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t)) ? [parseInt(i[1] + i[1], 16), parseInt(i[2] + i[2], 16), parseInt(i[3] + i[3], 16)] : /rgba\(0, 0, 0, 0\)/.exec(t) ? o.transparent : o[n.trim(t).toLowerCase()]
    }

    function f() {
        var n = document.defaultView ? document.defaultView.getComputedStyle(this, null) : this.currentStyle, i = {}, t, u, r;
        if (n && n.length && n[0] && n[n[0]])for (r = n.length; r--;)t = n[r], "string" == typeof n[t] && (u = t.replace(/\-(\w)/g, function (n, t) {
            return t.toUpperCase()
        }), i[u] = n[t]); else for (t in n)"string" == typeof n[t] && (i[t] = n[t]);
        return i
    }

    function e(t) {
        var i, r;
        for (i in t)r = t[i], (null == r || n.isFunction(r) || i in c || /scrollbar/.test(i) || !/color/i.test(i) && isNaN(parseFloat(r))) && delete t[i];
        return t
    }

    function h(n, t) {
        var r = {_: 0};
        for (var i in t)n[i] != t[i] && (r[i] = t[i]);
        return r
    }

    function i(t, i, r, u) {
        return"object" == typeof t && (u = i, r = null, i = t, t = i.effect), n.isFunction(i) && (u = i, r = null, i = {}), ("number" == typeof i || n.fx.speeds[i]) && (u = r, r = i, i = {}), n.isFunction(r) && (u = r, r = null), i = i || {}, r = r || i.duration, r = n.fx.off ? 0 : "number" == typeof r ? r : r in n.fx.speeds ? n.fx.speeds[r] : n.fx.speeds._default, u = u || i.complete, [t, i, r, u]
    }

    function r(t) {
        return!t || "number" == typeof t || n.fx.speeds[t] || "string" == typeof t && !n.effects[t] ? !0 : !1
    }

    n.effects = {};
    n.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor borderColor color outlineColor".split(" "), function (t, i) {
        n.fx.step[i] = function (t) {
            var r, e, f;
            if (!t.colorInit) {
                r = t.elem;
                e = i;
                do {
                    if (f = n.curCSS(r, e), "" != f && "transparent" != f || n.nodeName(r, "body"))break;
                    e = "backgroundColor"
                } while (r = r.parentNode);
                r = u(f);
                t.start = r;
                t.end = u(t.end);
                t.colorInit = !0
            }
            t.elem.style[i] = "rgb(" + Math.max(Math.min(parseInt(t.pos * (t.end[0] - t.start[0]) + t.start[0], 10), 255), 0) + "," + Math.max(Math.min(parseInt(t.pos * (t.end[1] - t.start[1]) + t.start[1], 10), 255), 0) + "," + Math.max(Math.min(parseInt(t.pos * (t.end[2] - t.start[2]) + t.start[2], 10), 255), 0) + ")"
        }
    });
    var o = {aqua: [0, 255, 255], azure: [240, 255, 255], beige: [245, 245, 220], black: [0, 0, 0], blue: [0, 0, 255], brown: [165, 42, 42], cyan: [0, 255, 255], darkblue: [0, 0, 139], darkcyan: [0, 139, 139], darkgrey: [169, 169, 169], darkgreen: [0, 100, 0], darkkhaki: [189, 183, 107], darkmagenta: [139, 0, 139], darkolivegreen: [85, 107, 47], darkorange: [255, 140, 0], darkorchid: [153, 50, 204], darkred: [139, 0, 0], darksalmon: [233, 150, 122], darkviolet: [148, 0, 211], fuchsia: [255, 0, 255], gold: [255, 215, 0], green: [0, 128, 0], indigo: [75, 0, 130], khaki: [240, 230, 140], lightblue: [173, 216, 230], lightcyan: [224, 255, 255], lightgreen: [144, 238, 144], lightgrey: [211, 211, 211], lightpink: [255, 182, 193], lightyellow: [255, 255, 224], lime: [0, 255, 0], magenta: [255, 0, 255], maroon: [128, 0, 0], navy: [0, 0, 128], olive: [128, 128, 0], orange: [255, 165, 0], pink: [255, 192, 203], purple: [128, 0, 128], violet: [128, 0, 128], red: [255, 0, 0], silver: [192, 192, 192], white: [255, 255, 255], yellow: [255, 255, 0], transparent: [255, 255, 255]}, s = ["add", "remove", "toggle"], c = {border: 1, borderBottom: 1, borderColor: 1, borderLeft: 1, borderRight: 1, borderTop: 1, borderWidth: 1, margin: 1, padding: 1};
    n.effects.animateClass = function (t, i, r, u) {
        return n.isFunction(r) && (u = r, r = null), this.queue("fx", function () {
            var o = n(this), a = o.attr("style") || " ", c = e(f.call(this)), l, v = o.attr("className");
            n.each(s, function (n, i) {
                t[i] && o[i + "Class"](t[i])
            });
            l = e(f.call(this));
            o.attr("className", v);
            o.animate(h(c, l), i, r, function () {
                n.each(s, function (n, i) {
                    t[i] && o[i + "Class"](t[i])
                });
                "object" == typeof o.attr("style") ? (o.attr("style").cssText = "", o.attr("style").cssText = a) : o.attr("style", a);
                u && u.apply(this, arguments)
            });
            c = n.queue(this);
            l = c.splice(c.length - 1, 1)[0];
            c.splice(1, 0, l);
            n.dequeue(this)
        })
    };
    n.fn.extend({_addClass: n.fn.addClass, addClass: function (t, i, r, u) {
        return i ? n.effects.animateClass.apply(this, [
            {add: t},
            i,
            r,
            u
        ]) : this._addClass(t)
    }, _removeClass: n.fn.removeClass, removeClass: function (t, i, r, u) {
        return i ? n.effects.animateClass.apply(this, [
            {remove: t},
            i,
            r,
            u
        ]) : this._removeClass(t)
    }, _toggleClass: n.fn.toggleClass, toggleClass: function (i, r, u, f, e) {
        return"boolean" == typeof r || r === t ? u ? n.effects.animateClass.apply(this, [r ? {add: i} : {remove: i}, u, f, e]) : this._toggleClass(i, r) : n.effects.animateClass.apply(this, [
            {toggle: i},
            r,
            u,
            f
        ])
    }, switchClass: function (t, i, r, u, f) {
        return n.effects.animateClass.apply(this, [
            {add: i, remove: t},
            r,
            u,
            f
        ])
    }});
    n.extend(n.effects, {version: "1.8.11", save: function (n, t) {
        for (var i = 0; i < t.length; i++)null !== t[i] && n.data("ec.storage." + t[i], n[0].style[t[i]])
    }, restore: function (n, t) {
        for (var i = 0; i < t.length; i++)null !== t[i] && n.css(t[i], n.data("ec.storage." + t[i]))
    }, setMode: function (n, t) {
        return"toggle" == t && (t = n.is(":hidden") ? "show" : "hide"), t
    }, getBaseline: function (n, t) {
        var i;
        switch (n[0]) {
            case"top":
                i = 0;
                break;
            case"middle":
                i = .5;
                break;
            case"bottom":
                i = 1;
                break;
            default:
                i = n[0] / t.height
        }
        switch (n[1]) {
            case"left":
                n = 0;
                break;
            case"center":
                n = .5;
                break;
            case"right":
                n = 1;
                break;
            default:
                n = n[1] / t.width
        }
        return{x: n, y: i}
    }, createWrapper: function (t) {
        if (t.parent().is(".ui-effects-wrapper"))return t.parent();
        var i = {width: t.outerWidth(!0), height: t.outerHeight(!0), float: t.css("float")}, r = n("<div><\/div>").addClass("ui-effects-wrapper").css({fontSize: "100%", background: "transparent", border: "none", margin: 0, padding: 0});
        return t.wrap(r), r = t.parent(), "static" == t.css("position") ? (r.css({position: "relative"}), t.css({position: "relative"})) : (n.extend(i, {position: t.css("position"), zIndex: t.css("z-index")}), n.each(["top", "left", "bottom", "right"], function (n, r) {
            i[r] = t.css(r);
            isNaN(parseInt(i[r], 10)) && (i[r] = "auto")
        }), t.css({position: "relative", top: 0, left: 0, right: "auto", bottom: "auto"})), r.css(i).show()
    }, removeWrapper: function (n) {
        return n.parent().is(".ui-effects-wrapper") ? n.parent().replaceWith(n) : n
    }, setTransition: function (t, i, r, u) {
        return u = u || {}, n.each(i, function (n, i) {
            unit = t.cssUnit(i);
            0 < unit[0] && (u[i] = unit[0] * r + unit[1])
        }), u
    }});
    n.fn.extend({effect: function (t) {
        var u = i.apply(this, arguments), r = {options: u[1], duration: u[2], callback: u[3]}, u = r.options.mode, f = n.effects[t];
        return n.fx.off || !f ? u ? this[u](r.duration, r.callback) : this.each(function () {
            r.callback && r.callback.call(this)
        }) : f.call(this, r)
    }, _show: n.fn.show, show: function (n) {
        if (r(n))return this._show.apply(this, arguments);
        var t = i.apply(this, arguments);
        return t[1].mode = "show", this.effect.apply(this, t)
    }, _hide: n.fn.hide, hide: function (n) {
        if (r(n))return this._hide.apply(this, arguments);
        var t = i.apply(this, arguments);
        return t[1].mode = "hide", this.effect.apply(this, t)
    }, __toggle: n.fn.toggle, toggle: function (t) {
        if (r(t) || "boolean" == typeof t || n.isFunction(t))return this.__toggle.apply(this, arguments);
        var u = i.apply(this, arguments);
        return u[1].mode = "toggle", this.effect.apply(this, u)
    }, cssUnit: function (t) {
        var i = this.css(t), r = [];
        return n.each(["em", "px", "%", "pt"], function (n, t) {
            0 < i.indexOf(t) && (r = [parseFloat(i), t])
        }), r
    }});
    n.easing.jswing = n.easing.swing;
    n.extend(n.easing, {def: "easeOutQuad", swing: function (t, i, r, u, f) {
        return n.easing[n.easing.def](t, i, r, u, f)
    }, easeInQuad: function (n, t, i, r, u) {
        return r * (t /= u) * t + i
    }, easeOutQuad: function (n, t, i, r, u) {
        return-r * (t /= u) * (t - 2) + i
    }, easeInOutQuad: function (n, t, i, r, u) {
        return 1 > (t /= u / 2) ? r / 2 * t * t + i : -r / 2 * (--t * (t - 2) - 1) + i
    }, easeInCubic: function (n, t, i, r, u) {
        return r * (t /= u) * t * t + i
    }, easeOutCubic: function (n, t, i, r, u) {
        return r * ((t = t / u - 1) * t * t + 1) + i
    }, easeInOutCubic: function (n, t, i, r, u) {
        return 1 > (t /= u / 2) ? r / 2 * t * t * t + i : r / 2 * ((t -= 2) * t * t + 2) + i
    }, easeInQuart: function (n, t, i, r, u) {
        return r * (t /= u) * t * t * t + i
    }, easeOutQuart: function (n, t, i, r, u) {
        return-r * ((t = t / u - 1) * t * t * t - 1) + i
    }, easeInOutQuart: function (n, t, i, r, u) {
        return 1 > (t /= u / 2) ? r / 2 * t * t * t * t + i : -r / 2 * ((t -= 2) * t * t * t - 2) + i
    }, easeInQuint: function (n, t, i, r, u) {
        return r * (t /= u) * t * t * t * t + i
    }, easeOutQuint: function (n, t, i, r, u) {
        return r * ((t = t / u - 1) * t * t * t * t + 1) + i
    }, easeInOutQuint: function (n, t, i, r, u) {
        return 1 > (t /= u / 2) ? r / 2 * t * t * t * t * t + i : r / 2 * ((t -= 2) * t * t * t * t + 2) + i
    }, easeInSine: function (n, t, i, r, u) {
        return-r * Math.cos(t / u * (Math.PI / 2)) + r + i
    }, easeOutSine: function (n, t, i, r, u) {
        return r * Math.sin(t / u * (Math.PI / 2)) + i
    }, easeInOutSine: function (n, t, i, r, u) {
        return-r / 2 * (Math.cos(Math.PI * t / u) - 1) + i
    }, easeInExpo: function (n, t, i, r, u) {
        return 0 == t ? i : r * Math.pow(2, 10 * (t / u - 1)) + i
    }, easeOutExpo: function (n, t, i, r, u) {
        return t == u ? i + r : r * (-Math.pow(2, -10 * t / u) + 1) + i
    }, easeInOutExpo: function (n, t, i, r, u) {
        return 0 == t ? i : t == u ? i + r : 1 > (t /= u / 2) ? r / 2 * Math.pow(2, 10 * (t - 1)) + i : r / 2 * (-Math.pow(2, -10 * --t) + 2) + i
    }, easeInCirc: function (n, t, i, r, u) {
        return-r * (Math.sqrt(1 - (t /= u) * t) - 1) + i
    }, easeOutCirc: function (n, t, i, r, u) {
        return r * Math.sqrt(1 - (t = t / u - 1) * t) + i
    }, easeInOutCirc: function (n, t, i, r, u) {
        return 1 > (t /= u / 2) ? -r / 2 * (Math.sqrt(1 - t * t) - 1) + i : r / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + i
    }, easeInElastic: function (n, t, i, r, u) {
        var f = 0, e = r;
        return 0 == t ? i : 1 == (t /= u) ? i + r : (f || (f = .3 * u), e < Math.abs(r) ? (e = r, n = f / 4) : n = f / (2 * Math.PI) * Math.asin(r / e), -(e * Math.pow(2, 10 * --t) * Math.sin(2 * (t * u - n) * Math.PI / f)) + i)
    }, easeOutElastic: function (n, t, i, r, u) {
        var f = 0, e = r;
        return 0 == t ? i : 1 == (t /= u) ? i + r : (f || (f = .3 * u), e < Math.abs(r) ? (e = r, n = f / 4) : n = f / (2 * Math.PI) * Math.asin(r / e), e * Math.pow(2, -10 * t) * Math.sin(2 * (t * u - n) * Math.PI / f) + r + i)
    }, easeInOutElastic: function (n, t, i, r, u) {
        var f = 0, e = r;
        return 0 == t ? i : 2 == (t /= u / 2) ? i + r : (f || (f = .3 * u * 1.5), e < Math.abs(r) ? (e = r, n = f / 4) : n = f / (2 * Math.PI) * Math.asin(r / e), 1 > t ? -.5 * e * Math.pow(2, 10 * --t) * Math.sin(2 * (t * u - n) * Math.PI / f) + i : e * Math.pow(2, -10 * --t) * Math.sin(2 * (t * u - n) * Math.PI / f) * .5 + r + i)
    }, easeInBack: function (n, i, r, u, f, e) {
        return e == t && (e = 1.70158), u * (i /= f) * i * ((e + 1) * i - e) + r
    }, easeOutBack: function (n, i, r, u, f, e) {
        return e == t && (e = 1.70158), u * ((i = i / f - 1) * i * ((e + 1) * i + e) + 1) + r
    }, easeInOutBack: function (n, i, r, u, f, e) {
        return e == t && (e = 1.70158), 1 > (i /= f / 2) ? u / 2 * i * i * (((e *= 1.525) + 1) * i - e) + r : u / 2 * ((i -= 2) * i * (((e *= 1.525) + 1) * i + e) + 2) + r
    }, easeInBounce: function (t, i, r, u, f) {
        return u - n.easing.easeOutBounce(t, f - i, 0, u, f) + r
    }, easeOutBounce: function (n, t, i, r, u) {
        return(t /= u) < 1 / 2.75 ? 7.5625 * r * t * t + i : t < 2 / 2.75 ? r * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + i : t < 2.5 / 2.75 ? r * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + i : r * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + i
    }, easeInOutBounce: function (t, i, r, u, f) {
        return i < f / 2 ? .5 * n.easing.easeInBounce(t, 2 * i, 0, u, f) + r : .5 * n.easing.easeOutBounce(t, 2 * i - f, 0, u, f) + .5 * u + r
    }})
}(jQuery), function (n) {
    n.fn.contextMenu = function (t) {
        n(this).bind("contextmenu", function (n) {
            return t(n), !1
        })
    }
}(jQuery), function (n) {
    function t(t) {
        if ("string" == typeof t.data) {
            var r = t.handler, i = t.data.toLowerCase().split(" ");
            t.handler = function (t) {
                if (this === t.target || !/textarea|select/i.test(t.target.nodeName) && "text" !== t.target.type) {
                    var u = "keypress" !== t.type && n.hotkeys.specialKeys[t.which], e = String.fromCharCode(t.which).toLowerCase(), f = "", o = {};
                    for (t.ctrlKey && "ctrl" !== u && (f += "ctrl+"), t.altKey && "alt" !== u && (f += "alt+"), t.metaKey && !t.ctrlKey && "meta" !== u && (f += "meta+"), t.shiftKey && "shift" !== u && (f += "shift+"), u ? o[f + u] = !0 : (o[f + e] = !0, o[f + n.hotkeys.shiftNums[e]] = !0, "shift+" === f && (o[n.hotkeys.shiftNums[e]] = !0)), u = 0, e = i.length; u < e; u++)if (o[i[u]])return r.apply(this, arguments)
                }
            }
        }
    }

    n.hotkeys = {version: "0.8", specialKeys: {8: /mac/i.test(navigator.platform) ? "del" : "backspace", 9: "tab", 13: "return", 16: "shift", 17: "ctrl", 18: "alt", 19: "pause", 20: "capslock", 27: "esc", 32: "space", 33: "pageup", 34: "pagedown", 35: "end", 36: "home", 37: "left", 38: "up", 39: "right", 40: "down", 45: "insert", 46: "del", 96: "0", 97: "1", 98: "2", 99: "3", 100: "4", 101: "5", 102: "6", 103: "7", 104: "8", 105: "9", 106: "*", 107: "+", 109: "-", 110: ".", 111: "/", 112: "f1", 113: "f2", 114: "f3", 115: "f4", 116: "f5", 117: "f6", 118: "f7", 119: "f8", 120: "f9", 121: "f10", 122: "f11", 123: "f12", 144: "numlock", 145: "scroll", 191: "/", 224: "meta"}, shiftNums: {"`": "~", 1: "!", 2: "@", 3: "#", 4: "$", 5: "%", 6: "^", 7: "&", 8: "*", 9: "(", 0: ")", "-": "_", "=": "+", ";": ": ", "'": '"', ",": "<", ".": ">", "/": "?", "\\": "|"}};
    n.each(["keydown", "keyup", "keypress"], function () {
        n.event.special[this] = {add: t}
    })
}(jQuery), function (n) {
    n.fn.selectable = function (t) {
        return this.each(function () {
            var i = n(this);
            i.css("user-select", t ? "text" : "none");
            i.css("-moz-user-select", t ? "text" : "-moz-none");
            i.css("-webkit-user-select", t ? "auto" : "none");
            (n.browser.msie || n.browser.opera) && i.attr("unselectable", t ? "off" : "on")
        })
    }
}(jQuery);
this.JSON || (this.JSON = {}), function () {
    function i(n) {
        return 10 > n ? "0" + n : n
    }

    function f(n) {
        return o.lastIndex = 0, o.test(n) ? '"' + n.replace(o, function (n) {
            var t = s[n];
            return"string" == typeof t ? t : "\\u" + ("0000" + n.charCodeAt(0).toString(16)).slice(-4)
        }) + '"' : '"' + n + '"'
    }

    function r(i, e) {
        var h, c, l, a, v = n, s, o = e[i];
        o && "object" == typeof o && "function" == typeof o.toJSON && (o = o.toJSON(i));
        "function" == typeof t && (o = t.call(e, i, o));
        switch (typeof o) {
            case"string":
                return f(o);
            case"number":
                return isFinite(o) ? String(o) : "null";
            case"boolean":
            case"null":
                return String(o);
            case"object":
                if (!o)return"null";
                if (n += u, s = [], "[object Array]" === Object.prototype.toString.apply(o)) {
                    for (a = o.length, h = 0; h < a; h += 1)s[h] = r(h, o) || "null";
                    return l = 0 === s.length ? "[]" : n ? "[\n" + n + s.join(",\n" + n) + "\n" + v + "]" : "[" + s.join(",") + "]", n = v, l
                }
                if (t && "object" == typeof t)for (a = t.length, h = 0; h < a; h += 1)c = t[h], "string" == typeof c && (l = r(c, o)) && s.push(f(c) + (n ? ": " : ":") + l); else for (c in o)Object.hasOwnProperty.call(o, c) && (l = r(c, o)) && s.push(f(c) + (n ? ": " : ":") + l);
                return l = 0 === s.length ? "{}" : n ? "{\n" + n + s.join(",\n" + n) + "\n" + v + "}" : "{" + s.join(",") + "}", n = v, l
        }
    }

    "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function () {
        return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + i(this.getUTCMonth() + 1) + "-" + i(this.getUTCDate()) + "T" + i(this.getUTCHours()) + ":" + i(this.getUTCMinutes()) + ":" + i(this.getUTCSeconds()) + "Z" : null
    }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () {
        return this.valueOf()
    });
    var e = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, o = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, n, u, s = {"\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\"}, t;
    "function" != typeof JSON.stringify && (JSON.stringify = function (i, f, e) {
        var o;
        if (u = n = "", "number" == typeof e)for (o = 0; o < e; o += 1)u += " "; else"string" == typeof e && (u = e);
        if ((t = f) && "function" != typeof f && ("object" != typeof f || "number" != typeof f.length))throw Error("JSON.stringify");
        return r("", {"": i})
    });
    "function" != typeof JSON.parse && (JSON.parse = function (a, b) {
        function c(n, t) {
            var r, u, i = n[t];
            if (i && "object" == typeof i)for (r in i)Object.hasOwnProperty.call(i, r) && (u = c(i, r), void 0 !== u ? i[r] = u : delete i[r]);
            return b.call(n, t, i)
        }

        var e;
        if (a = String(a), e.lastIndex = 0, e.test(a) && (a = a.replace(e, function (n) {
            return"\\u" + ("0000" + n.charCodeAt(0).toString(16)).slice(-4)
        })), /^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, "")))return e = eval("(" + a + ")"), "function" == typeof b ? c({"": e}, "") : e;
        throw new SyntaxError("JSON.parse");
    })
}(), function (n) {
    n.extend(n.fn, {swapClass: function (n, t) {
        var i = this.filter("." + n);
        return this.filter("." + t).removeClass(t).addClass(n), i.removeClass(n).addClass(t), this
    }, replaceClass: function (n, t) {
        return this.filter("." + n).removeClass(n).addClass(t).end()
    }, hoverClass: function (t) {
        return t = t || "hover", this.hover(function () {
            n(this).addClass(t)
        }, function () {
            n(this).removeClass(t)
        })
    }, heightToggle: function (n, t) {
        n ? this.animate({height: "toggle"}, n, t) : this.each(function () {
            jQuery(this)[jQuery(this).is(":hidden") ? "show" : "hide"]();
            t && t.apply(this, arguments)
        })
    }, heightHide: function (n, t) {
        n ? this.animate({height: "hide"}, n, t) : (this.hide(), t && this.each(t))
    }, prepareBranches: function (n) {
        return n.prerendered || (this.filter(":last-child:not(ul)").addClass(t.last), this.filter((n.collapsed ? "" : "." + t.closed) + ":not(." + t.open + ")").find(">ul").hide()), this.filter(":has(>ul)")
    }, applyClasses: function (i, r) {
        if (this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview", function (t) {
            this == t.target && r.apply(n(this).next())
        }).add(n("a", this)).hoverClass(), !i.prerendered) {
            this.filter(":has(>ul:hidden)").addClass(t.expandable).replaceClass(t.last, t.lastExpandable);
            this.not(":has(>ul:hidden)").addClass(t.collapsable).replaceClass(t.last, t.lastCollapsable);
            var u = this.find("div." + t.hitarea);
            u.length || (u = this.prepend('<div class="' + t.hitarea + '"/>').find("div." + t.hitarea));
            u.removeClass().addClass(t.hitarea).each(function () {
                var t = "";
                n.each(n(this).parent().attr("class").split(" "), function () {
                    t += this + "-hitarea "
                });
                n(this).addClass(t)
            })
        }
        this.find("div." + t.hitarea).click(r)
    }, treeview: function (i) {
        function s(i, r) {
            function u(r) {
                return function () {
                    return f.apply(n("div." + t.hitarea, i).filter(function () {
                        return r ? n(this).parent("." + r).length : !0
                    })), !1
                }
            }

            n("a:eq(0)", r).click(u(t.collapsable));
            n("a:eq(1)", r).click(u(t.expandable));
            n("a:eq(2)", r).click(u())
        }

        function f() {
            n(this).parent().find(">.hitarea").swapClass(t.collapsableHitarea, t.expandableHitarea).swapClass(t.lastCollapsableHitarea, t.lastExpandableHitarea).end().swapClass(t.collapsable, t.expandable).swapClass(t.lastCollapsable, t.lastExpandable).find(">ul").heightToggle(i.animated, i.toggle);
            i.unique && n(this).parent().siblings().find(">.hitarea").replaceClass(t.collapsableHitarea, t.expandableHitarea).replaceClass(t.lastCollapsableHitarea, t.lastExpandableHitarea).end().replaceClass(t.collapsable, t.expandable).replaceClass(t.lastCollapsable, t.lastExpandable).find(">ul").heightHide(i.animated, i.toggle)
        }

        function h() {
            var t = [];
            u.each(function (i, r) {
                t[i] = n(r).is(":has(>ul:visible)") ? 1 : 0
            });
            n.cookie(i.cookieId, t.join(""), i.cookieOptions)
        }

        function c() {
            var t = n.cookie(i.cookieId), r;
            t && (r = t.split(""), u.each(function (t, i) {
                n(i).find(">ul")[parseInt(r[t]) ? "show" : "hide"]()
            }))
        }

        var o, u, e, r;
        i = n.extend({cookieId: "treeview"}, i);
        i.toggle && (o = i.toggle, i.toggle = function () {
            return o.apply(n(this).parent()[0], arguments)
        });
        this.data("toggler", f);
        this.addClass("treeview");
        u = this.find("li").prepareBranches(i);
        switch (i.persist) {
            case"cookie":
                e = i.toggle;
                i.toggle = function () {
                    h();
                    e && e.apply(this, arguments)
                };
                c();
                break;
            case"location":
                r = this.find("a").filter(function () {
                    return this.href.toLowerCase() == location.href.toLowerCase()
                });
                r.length && (r = r.addClass("selected").parents("ul, li").add(r.next()).show(), i.prerendered && r.filter("li").swapClass(t.collapsable, t.expandable).swapClass(t.lastCollapsable, t.lastExpandable).find(">.hitarea").swapClass(t.collapsableHitarea, t.expandableHitarea).swapClass(t.lastCollapsableHitarea, t.lastExpandableHitarea))
        }
        return u.applyClasses(i, f), i.control && (s(this, i.control), n(i.control).show()), this
    }});
    n.treeview = {};
    var t = n.treeview.classes = {open: "open", closed: "closed", expandable: "expandable", expandableHitarea: "expandable-hitarea", lastExpandableHitarea: "lastExpandable-hitarea", collapsable: "collapsable", collapsableHitarea: "collapsable-hitarea", lastCollapsableHitarea: "lastCollapsable-hitarea", lastCollapsable: "lastCollapsable", lastExpandable: "lastExpandable", last: "last", hitarea: "hitarea"}
}(jQuery), function (n) {
    function t() {
        for (var n = 0; n < arguments.length; n++)if (!isNaN(parseFloat(arguments[n])))return Number(parseFloat(arguments[n]))
    }

    function i(t, i) {
        var r = n(i || this).attr("class"), r = new RegExp("(\\b" + t + ")(\\S*)").exec(r), u = {"true": !0, True: !0, "false": !1, False: !1};
        return r && 3 <= r.length && void 0 !== u[r[3]] && (r[3] = u[r[3]]), r ? 3 <= r.length ? r[2] : null : void 0
    }

    n.fn.spinbox = function (r) {
        return r && "String" == typeof r && "destroy" === r ? this.unbind(".spinbox").removeClass(r.spinboxClass).removeClass(r.upClass).removeClass(r.downClass).removeClass(r.upHoverClass).removeClass(r.downHoverClass).removeData("spinboxMin").removeData("spinboxMax").removeData("spinboxReset").removeData("spinboxStep").removeData("spinboxBigStep") : (r = n.extend({}, n.fn.spinbox.defaults, r), this.each(function () {
            var u = n(this), e = i("spinboxMin", this), o = i("spinboxMax", this), s = i("spinboxStep", this), h = i("spinboxBigStep", this), c = i("spinboxReset", this), f = i("spinboxScale", this);
            void 0 === e && (e = t(u.attr("min"), r.min));
            void 0 === o && (o = t(u.attr("max"), r.max));
            s || (s = t(u.attr("step"), r.step));
            h || (h = t(u.attr("bigStep"), r.bigStep));
            void 0 === c && (c = t(r.reset, u.val(), e, o));
            void 0 === f && (f = u.data("spinboxScale"));
            f = f || !isNaN(parseFloat(f)) ? f : r.scale;
            !0 === f && (f = (s.toString().split(".")[1] || "").length);
            u.data("spinboxMin", e);
            u.data("spinboxMax", o);
            u.data("spinboxStep", s);
            u.data("spinboxBigStep", h);
            u.data("spinboxReset", c);
            u.data("spinboxScale", f)
        }), this.each(function () {
            function i(i, u, e) {
                if (i = n(this), !r.ignore || !i.is(r.ignore)) {
                    u = t(u, i.data("spinboxStep"), 1);
                    e = e || (f ? -1 : 1);
                    var h = i.val(), o = t(h, i.data("spinboxReset"), 0), c = t(i.data("spinboxMin")), l = t(i.data("spinboxMax")), s = [o, u, c, l, e, h, r];
                    0 < e ? o = r.increment.apply(this, s) : 0 > e && (o = r.decrement.apply(this, s));
                    s = i.data("spinboxScale");
                    !isNaN(parseFloat(s)) && r.round && (o = r.round(o, i.data("spinboxScale")));
                    isNaN(parseFloat(c)) || (o = Math.max(o, c));
                    isNaN(parseFloat(l)) || (o = Math.min(o, l));
                    s = [o, u, c, l, e, h, r];
                    o != h && !1 !== i.triggerHandler("beforeSpin", s) && (i.val(o), r.change && i.trigger("change", s), i.triggerHandler("spin", s))
                }
            }

            function c(n, t) {
                o();
                s = window.setTimeout(function () {
                    i.apply(n, [t]);
                    h = window.setInterval(function () {
                        i.apply(n, [t])
                    }, r.repeat)
                }, r.delay)
            }

            function o() {
                window.clearTimeout(s);
                window.clearInterval(h)
            }

            var e, f, s, h, u = n(this);
            u.bind("mousemove.spinbox", function (t) {
                var i = n(this), u = i.offset(), o = i.height() / 2, s = t.pageX > u.left + i.width() - r.buttonWidth;
                e = s && t.pageY <= u.top + o;
                f = s && t.pageY > u.top + o;
                i.toggleClass(r.upHoverClass, e).toggleClass(r.downHoverClass, f)
            });
            u.bind("mouseout.spinbox", function () {
                o();
                n(this).removeClass([r.upClass, r.downClass, r.upHoverClass, r.downHoverClass].join(" "));
                e = f = null
            });
            u.bind("mousedown.spinbox", function (t) {
                (e || f) && (n(this).toggleClass(r.upClass, e).toggleClass(r.downClass, f), i.apply(this, [t]), c(this, t))
            });
            u.bind("mouseup.spinbox", function () {
                o();
                n(this).removeClass(r.upClass).removeClass(r.downClass)
            });
            u.bind("keydown.spinbox", function (t) {
                if (!r.keys || n.grep(r.keys, function (n) {
                    return n === t.keyCode || n instanceof RegExp && n.test(String.fromCharCode(t.keyCode))
                }).length) {
                    var u = n(this), f = u.data("spinboxBigStep"), u = t.shiftKey ? f : u.data("spinboxStep");
                    switch (t.keyCode) {
                        case 38:
                            i.apply(this, [t, u, 1]);
                            break;
                        case 40:
                            i.apply(this, [t, u, -1]);
                            break;
                        case 33:
                            i.apply(this, [t, f, 1]);
                            break;
                        case 34:
                            i.apply(this, [t, f, -1])
                    }
                } else return!r.keys
            });
            u.bind("change.spinbox", function (n) {
                i.apply(this, [n, 0])
            });
            u.addClass(r.spinboxClass);
            r.mousewheel && n(this).bind("mousewheel.spinbox DOMMouseScroll.spinbox", function (t) {
                var r = t.shiftKey ? n(this).data("spinboxBigStep") : n(this).data("spinboxStep");
                return 0 > t.detail || 120 <= t.wheelDelta ? i.apply(this, [t, r, 1]) : (0 < t.detail || -120 >= t.wheelDelta) && i.apply(this, [t, r, -1]), !1
            });
            i.apply(this, [n.Event(), 0])
        }))
    };
    n.fn.spinbox.defaults = {min: 0, max: null, step: 1, bigStep: 10, keys: [/[0-9]/, 9, 13, 8, 46, 33, 34, 37, 38, 39, 40, 109, 188, 190], ignore: "[readonly],[disabled]", spinboxClass: "spinbox-active", upClass: "spinbox-up", downClass: "spinbox-down", upHoverClass: "spinbox-up-hover", downHoverClass: "spinbox-down-hover", mousewheel: !0, change: !0, increment: function (n, t) {
        return n + t
    }, decrement: function (n, t) {
        return n - t
    }, reset: null, delay: 500, repeat: 100, buttonWidth: 20, scale: !0, round: function (n, t) {
        return Math.round(n * Math.pow(10, t)) / Math.pow(10, t)
    }}
}(jQuery), function (n) {
    n.fn.popup = function () {
        return n(this).each(function (n, t) {
            HTMLHelper.createPopup(t)
        })
    }
}(jQuery), function (n, t, i) {
    function r(r, u) {
        function o(t) {
            n(f).each(function () {
                var i = n(this);
                this === t.target || i.has(t.target).length || i.triggerHandler(u, [t.target])
            })
        }

        u = u || r + i;
        var f = n(), e = r + "." + u + "-special-event";
        n.event.special[u] = {setup: function () {
            f = f.add(this);
            delete f.prevObject;
            1 === f.length && n(t).bind(e, o)
        }, teardown: function () {
            f = f.not(this);
            delete f.prevObject;
            0 === f.length && n(t).unbind(e)
        }, add: function (n) {
            var t = n.handler;
            n.handler = function (n, i) {
                n.target = i;
                t.apply(this, arguments)
            }
        }}
    }

    n.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "), function (n) {
        r(n)
    });
    r("focusin", "focus" + i);
    r("focusout", "blur" + i);
    Modernizr.touch && (r("touchstart", "mousedown" + i), r("touchmove", "mousemove" + i), r("touchend", "mouseup" + i));
    n.addOutsideEvent = r
}(jQuery, document, "outside"), function (n) {
    n.fn.mousecapture = function (t) {
        var i = n(document);
        return this.each(function () {
            var r = n(this), u = {};
            r.mousedown(function (n) {
                var f, e, o;
                return t.move && (f = function (n) {
                    t.move.call(r, n, u)
                }, i.mousemove(f)), o = function () {
                    t.move && i.unbind("mousemove", f);
                    i.unbind("mouseup", e)
                }, e = t.up ? function (n) {
                    return o(), t.up.call(r, n, u)
                } : o, i.mouseup(e), t.down.call(r, n, u)
            })
        }), this
    }
}(jQuery), function (n) {
    function t(n, t) {
        if (!(1 < n.originalEvent.touches.length)) {
            n.preventDefault();
            var i = n.originalEvent.changedTouches[0], r = document.createEvent("MouseEvents");
            r.initMouseEvent(t, !0, !0, window, 1, i.screenX, i.screenY, i.clientX, i.clientY, !1, !1, !1, !1, 0, null);
            n.target.dispatchEvent(r)
        }
    }

    if (n.support.touch = "ontouchend"in document, n.support.touch) {
        var i = n.ui.mouse.prototype, u = i._mouseInit, f = i._mouseDestroy, r;
        i._touchStart = function (n) {
            !r && this._mouseCapture(n.originalEvent.changedTouches[0]) && (r = !0, this._touchMoved = !1, t(n, "mouseover"), t(n, "mousemove"), t(n, "mousedown"))
        };
        i._touchMove = function (n) {
            r && (this._touchMoved = !0, t(n, "mousemove"))
        };
        i._touchEnd = function (n) {
            r && (t(n, "mouseup"), t(n, "mouseout"), this._touchMoved || t(n, "click"), r = !1)
        };
        i._mouseInit = function () {
            this.element.bind({touchstart: n.proxy(this, "_touchStart"), touchmove: n.proxy(this, "_touchMove"), touchend: n.proxy(this, "_touchEnd")});
            u.call(this)
        };
        i._mouseDestroy = function () {
            this.element.unbind({touchstart: n.proxy(this, "_touchStart"), touchmove: n.proxy(this, "_touchMove"), touchend: n.proxy(this, "_touchEnd")});
            f.call(this)
        }
    }
}(jQuery);
EventEmitter = function () {
    function t() {
    }

    function r(n, t) {
        for (var i = n.length; i--;)if (n[i].listener === t)return i;
        return-1
    }

    function i(n) {
        return function () {
            return this[n].apply(this, arguments)
        }
    }

    var n = t.prototype, u = this, f = u.EventEmitter;
    return n.getListeners = function (n) {
        var t = this._getEvents(), r, i;
        if (n instanceof RegExp)for (i in r = {}, t)t.hasOwnProperty(i) && n.test(i) && (r[i] = t[i]); else r = t[n] || (t[n] = []);
        return r
    }, n.flattenListeners = function (n) {
        for (var i = [], t = 0; t < n.length; t += 1)i.push(n[t].listener);
        return i
    }, n.getListenersAsObject = function (n) {
        var t = this.getListeners(n), i;
        return t instanceof Array && (i = {}, i[n] = t), i || t
    }, n.addListener = function (n, t) {
        var i = this.getListenersAsObject(n), f = "object" == typeof t;
        for (var u in i)i.hasOwnProperty(u) && -1 === r(i[u], t) && i[u].push(f ? t : {listener: t, once: !1});
        return this
    }, n.on = i("addListener"), n.addOnceListener = function (n, t) {
        return this.addListener(n, {listener: t, once: !0})
    }, n.once = i("addOnceListener"), n.defineEvent = function (n) {
        return this.getListeners(n), this
    }, n.defineEvents = function (n) {
        for (var t = 0; t < n.length; t += 1)this.defineEvent(n[t]);
        return this
    }, n.removeListener = function (n, t) {
        var i = this.getListenersAsObject(n), u;
        for (var f in i)i.hasOwnProperty(f) && (u = r(i[f], t), -1 !== u && i[f].splice(u, 1));
        return this
    }, n.off = i("removeListener"), n.addListeners = function (n, t) {
        return this.manipulateListeners(!1, n, t)
    }, n.removeListeners = function (n, t) {
        return this.manipulateListeners(!0, n, t)
    }, n.manipulateListeners = function (n, t, i) {
        var r, u, f = n ? this.removeListener : this.addListener;
        if (n = n ? this.removeListeners : this.addListeners, "object" != typeof t || t instanceof RegExp)for (r = i.length; r--;)f.call(this, t, i[r]); else for (r in t)t.hasOwnProperty(r) && (u = t[r]) && ("function" == typeof u ? f.call(this, r, u) : n.call(this, r, u));
        return this
    }, n.removeEvent = function (n) {
        var r = typeof n, t = this._getEvents(), i;
        if ("string" === r)delete t[n]; else if (n instanceof RegExp)for (i in t)t.hasOwnProperty(i) && n.test(i) && delete t[i]; else delete this._events;
        return this
    }, n.removeAllListeners = i("removeEvent"), n.emitEvent = function (n, t) {
        var r = this.getListenersAsObject(n), i, f, u, e;
        for (u in r)if (r.hasOwnProperty(u))for (f = r[u].length; f--;)i = r[u][f], !0 === i.once && this.removeListener(n, i.listener), e = i.listener.apply(this, t || []), e === this._getOnceReturnValue() && this.removeListener(n, i.listener);
        return this
    }, n.trigger = i("emitEvent"), n.emit = function (n) {
        var t = Array.prototype.slice.call(arguments, 1);
        return this.emitEvent(n, t)
    }, n.setOnceReturnValue = function (n) {
        return this._onceReturnValue = n, this
    }, n._getOnceReturnValue = function () {
        return this.hasOwnProperty("_onceReturnValue") ? this._onceReturnValue : !0
    }, n._getEvents = function () {
        return this._events || (this._events = {})
    }, t.noConflict = function () {
        return u.EventEmitter = f, t
    }, "function" == typeof define && define.amd ? define(function () {
        return t
    }) : "object" == typeof module && module.exports ? module.exports = t : this.EventEmitter = t, t
}.call(this);
J77 = function () {
    var t = {}, e, r, n, i, o, u, s, f;
    if ("undefined" != typeof J77)return J77;
    e = {custom_items_in_context_menu: {}, websocket_connection: {}, countdown: {}, extended_hours: {}, symbol_search_parser_mixin: {}, show_pro_features: {}, daily_timeframe_suffix: {}, symbollist_context_menu: {}, pay_attention_to_ticker_not_symbol: {}, graying_disabled_tools_enabled: {}, update_study_formatter_on_symbol_resolve: {}, constraint_dialogs_movement: {}, same_data_requery: {}, show_interval_dialog_on_key_press: {}, header_interval_dialog_button: {subsets: ["show_interval_dialog_on_key_press"]}, header_fullscreen_button: {}, header_symbol_search: {}, header_resolutions: {subsets: ["header_interval_dialog_button"]}, header_chart_type: {}, header_settings: {}, header_indicators: {}, header_compare: {}, header_undo_redo: {}, header_screenshot: {}, header_saveload: {}, header_widget: {subsets: "header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_settings header_indicators header_compare header_undo_redo header_screenshot header_fullscreen_button".split(" ")}, left_toolbar: {}, control_bar: {}, widget_logo: {}, timeframes_toolbar: {}, edit_buttons_in_legend: {}, pane_context_menu: {}, scales_context_menu: {}, legend_context_menu: {}, context_menus: {subsets: ["pane_context_menu", "scales_context_menu", "legend_context_menu"]}, items_favoriting: {}, use_localstorage_for_settings: {subsets: ["items_favoriting"]}, plain_studymarket: {}, trading_options: {}, disable_resolution_rebuild: {}, border_around_the_chart: {}, narrow_chart_enabled: {}, charting_library_debug_mode: {}, log_data_request_time: {}, saveload_requires_authentication: {}, saveload_storage_customization: {}, new_chart_creation_available: {}, volume_force_overlay: {}, create_volume_indicator_by_default: {}, saved_charts_count_restriction: {}, lean_chart_load: {}, stop_study_on_restart: {}, star_some_intervals_by_default: {}, predefined_items_only_may_be_starred: {}, move_logo_to_main_pane: {}, link_to_tradingview: {}, right_bar_stays_on_scroll: {}, short_name_may_differ_from_fullname: {}, chart_content_overrides_by_deafults: {}, google_analytics: {}, alerts: {}, tv_production: {subsets: "show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection header_fullscreen_button header_widget left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay new_chart_creation_available saved_charts_count_restriction create_volume_indicator_by_default charts_auto_save save_old_chart_before_save_as trading_options chart_content_overrides_by_deafults alerts".split(" ")}, widget: {subsets: "show_pro_features countdown extended_hours symbol_search_parser_mixin symbollist_context_menu websocket_connection left_toolbar control_bar timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings saveload_requires_authentication volume_force_overlay create_volume_indicator_by_default header_widget_dom_node header_symbol_search header_resolutions header_chart_type header_indicators header_compare star_some_intervals_by_default".split(" ")}, charting_library: {subsets: "daily_timeframe_suffix custom_items_in_context_menu pay_attention_to_ticker_not_symbol graying_disabled_tools_enabled update_study_formatter_on_symbol_resolve constraint_dialogs_movement header_widget left_toolbar control_bar widget_logo timeframes_toolbar context_menus edit_buttons_in_legend use_localstorage_for_settings plain_studymarket border_around_the_chart saveload_storage_customization volume_force_overlay lean_chart_load stop_study_on_restart header_saveload create_volume_indicator_by_default adapt_onchart_logo_background update_timeframes_set_on_symbol_resolve refresh_saved_charts_list_on_dialog_show predefined_items_only_may_be_starred link_to_tradingview right_bar_stays_on_scroll short_name_may_differ_from_fullname google_analytics".split(" ")}, static_charts_service: {subsets: ["charting_library", "disable_resolution_rebuild", "log_data_request_time", "same_data_requery"]}, charting_platform: {subsets: ["charting_library", "trading_options"]}};
    r = {};
    for (n in e) {
        for (i = e[n].subsets || [], o = 0; o < i.length; ++o)r[i[o]] = 1;
        r[n] = 1
    }
    u = {};
    for (n in r)for (s in r)i = e[s], "undefined" != typeof i && i.subsets && 0 <= i.subsets.indexOf(n) && (u.hasOwnProperty(n) || (u[n] = []), u[n].push(s));
    return f = {}, t.enabled = function (n) {
        var i = u.hasOwnProperty(n) ? u[n] : [], t;
        if (0 == f[n])return!1;
        for (n = f[n], t = 0; t < i.length; ++t)n |= J77.enabled(i[t]);
        return n
    }, t._uniqueSets = function () {
        return Object.keys(r)
    }, t.enable = function (n) {
        f[n] = !0
    }, t.setEnabled = function (n, t) {
        f[n] = t
    }, "undefined" != typeof __initialDisabledFeaturesets && __initialDisabledFeaturesets && __initialDisabledFeaturesets.map(function (n) {
        t.setEnabled(n, !1)
    }), "undefined" != typeof __initialEnabledFeaturesets && __initialEnabledFeaturesets && __initialEnabledFeaturesets.map(function (n) {
        t.enable(n)
    }), t
}();
"undefined" != typeof module && (module.exports = J77);
TradingView = {};
PineAddons = {};
TradingView.className = function (n) {
    for (var t in this)if (TradingView[t] === n)return t;
    return null
};
TradingView.isMobileView = /mobile=1/i.test(window.location.search);
TradingView.isOnFeaturePage = /on-features-page=1/i.test(window.location.search);
TradingView.wrapUrl = function (n) {
    return J77.enabled("charting_library") && (n = n.replace("/static/", "")), n
};
TradingView.RESOURCES_ROOT = TradingView.wrapUrl("/static/chart-client/css/");
TradingView.THEME_RESOURCES_ROOT = TradingView.wrapUrl("/static/chart-client/css/images/");
TradingView.resourceFullPath = function (n) {
    return TradingView.RESOURCES_ROOT + n
};
TradingView.themeResourceFullPath = function (n) {
    return TradingView.THEME_RESOURCES_ROOT + n
};
TradingView.isMobile = function () {
    var n = /Android/i.test(navigator.userAgent), t = /BlackBerry/i.test(navigator.userAgent), i = /iPhone|iPad|iPod/i.test(navigator.userAgent), r = /Opera Mini/i.test(navigator.userAgent), u = TradingView.winMobileMode, f = TradingView.isMobileView || n || t || i || r || u;
    return{Android: function () {
        return n
    }, BlackBerry: function () {
        return t
    }, iOS: function () {
        return i
    }, Opera: function () {
        return r
    }, Windows: function () {
        return u
    }, any: function () {
        return f
    }}
}();
TradingView.supportTouch = function () {
    return Modernizr.touch || TradingView.isMobile.any()
};
TradingView.onWidget = function () {
    return/widgetembed|widgetpopup|idea-popup/.test(window.location.pathname)
};
TradingView.availableTimezones = TradingView.availableTimezones || [
    {id: "UTC", title: "UTC"},
    {id: "EST", title: "EST"},
    {id: "CST", title: "CST"},
    {id: "PST", title: "PST"},
    {id: "exchange", title: "Exchange"}
];
TradingView.monthsShort = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");
TradingView.futuresRoots = [
    {d: "E-Mini S&P 500", t: "ES"},
    {d: "E-Mini Nasdaq 100", t: "NQ"},
    {d: "Gold", t: "GC"},
    {d: "Silver", t: "SI"},
    {d: "Crude Oil WTI", t: "CL"},
    {d: "Natural Gas", t: "NG"},
    {d: "Australian Dollar", t: "6A"},
    {d: "Australian Dollar (Floor)", t: "AD"},
    {d: "Euro FX", t: "6E"},
    {d: "Euro FX (Floor)", t: "EC"},
    {d: "Corn", t: "ZC"},
    {d: "Corn (Floor)", t: "C"},
    {d: "Eurodollar", t: "GE"},
    {d: "Eurodollar (Floor)", t: "ED"}
];
TradingView.guid = function () {
    return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (n) {
        var t = 16 * Math.random() | 0;
        return("x" == n ? t : t & 3 | 8).toString(16)
    })
};
TradingView.randomHash = function () {
    for (var i, n = "", t = 0; 12 > t; t++)i = Math.round(60 * Math.random()), n = n + "0123456789abcdefghijklmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[i];
    return n
};
isArray = Array.isArray || function (n) {
    return"[object Array]" === Object.prototype.toString.call(n)
};
TypeValidator.prototype.check = function (n) {
    return n.constructor === this.m_type || isInherited(n.constructor, this.m_type)
};
PredicateValidator.prototype.check = function (n) {
    return this.m_predicate(n)
};
TradingView.clone = function (n) {
    var r, i, t;
    if (!n || "object" != typeof n)return n;
    r = "function" == typeof n.pop ? [] : {};
    for (i in n)n.hasOwnProperty(i) && (t = n[i], r[i] = t && "object" == typeof t ? TradingView.clone(t) : t);
    return r
};
TradingView.deepEquals = function (n, t, i) {
    var r, u;
    if (i || (i = ""), n === t)return[!0, i];
    if (isFunction(n) && (n = void 0), isFunction(t) && (t = void 0), void 0 === n && void 0 !== t || void 0 === t && void 0 !== n || null === n && null !== t || null === t && null !== n)return[!1, i];
    if (isString(n) && isString(t))return[n === t, i];
    if (isArray(n) && isArray(t)) {
        if (r = n.length, r !== t.length)return[!1, i];
        for (u = 0; u < r; u++)if (res = TradingView.deepEquals(n[u], t[u], i + "[" + u + "]"), !res[0])return res
    } else {
        if (isArray(n) || isArray(t))return[!1, i];
        for (r in n)if (res = TradingView.deepEquals(n[r], t[r], i + "[" + r + "]"), !res[0])return res
    }
    return[!0, i]
};
TradingView.merge = function (n, t) {
    for (var i in t)"object" == typeof t[i] && n.hasOwnProperty(i) ? TradingView.merge(n[i], t[i]) : n[i] = t[i];
    return n
};
TradingView.mergeWithRules = function (n, t, i, r) {
    var u, f;
    for (u in t)f = r ? r + "." + u : u, i && f in i ? n[u] = i[f](n[u], t[u]) : "object" == typeof t[u] && n.hasOwnProperty(u) ? TradingView.merge(n[u], t[u], i, f) : n[u] = t[u]
};
TradingView.sortMultipleFunction = function () {
    var n = [].slice.call(arguments), t = n.length;
    return function (i, r) {
        for (var e, f, u, o, s = 0; s < t && (o = 0, u = n[s], f = "string" == typeof u ? u : u.name, e = i[f], f = r[f], "function" == typeof u.fn && (e = u.fn(e), f = u.fn(f)), u = u.reverse ? -1 : 1, e < f && (o = -1 * u), e > f && (o = 1 * u), 0 === o); s++);
        return o
    }
};
"undefined" != typeof module && module && module.exports && (module.exports = {inherit: inherit, merge: TradingView.merge, isNumber: isNumber, isBoolean: isBoolean, isString: isString});
OrderedHash.prototype.rearrange = function (n) {
    if ("function" != typeof n)throw Error("sort param is not a function");
    return this.array.sort(n)
};
OrderedHash.byValue = function () {
    return function (n, t) {
        return n - t
    }
};
OrderedHash.byField = function (n) {
    return function (t, i) {
        return t[n] > i[n] ? 1 : t[n] < i[n] ? -1 : t[n] == i[n] ? 0 : void 0
    }
};
OrderedHash.byOrder = function (n) {
    return function (t, i) {
        var r = n.indexOf(t.key), u = n.indexOf(i.key);
        return r - u
    }
};
HTMLHelper = {}, function (n) {
    HTMLHelper.createLabel = function (t, i, r) {
        return HTMLHelper.Element.create("label", n.extend(r, {html: i, "for": t}))
    };
    HTMLHelper.unbindContextMenu = function (n) {
        n.contextMenu(function () {
            return!1
        })
    };
    HTMLHelper.offsetX = function (n, t) {
        return n.width() + t.pageX
    };
    HTMLHelper.offsetY = function (n, t) {
        return n.height() + t.pageY
    };
    HTMLHelper.checkObjIsOutOfWindowX = function (t, i) {
        var r = n(window).width() - HTMLHelper.offsetX(t, i);
        return 0 > r ? (r = i.pageX + r, 0 < r ? r : 0) : i.pageX
    };
    HTMLHelper.checkObjIsOutOfWindowY = function (t, i) {
        var r = n(window).height() - HTMLHelper.offsetY(t, i);
        return 0 > r ? (r = i.pageY + r, 0 < r ? r : 0) : i.pageY
    };
    HTMLHelper.checkObjIsOutOfWindow = function (n, t) {
        return{left: HTMLHelper.checkObjIsOutOfWindowX(n, t), top: HTMLHelper.checkObjIsOutOfWindowY(n, t)}
    };
    HTMLHelper.setAttr = function (n, t, i) {
        return n.attr ? n.attr(t, i) : n[t] = i, n
    };
    HTMLHelper.removeAttr = function (n, t) {
        return n.removeAttr ? n.removeAttr(t) : n.removeAttribute(t), n
    };
    HTMLHelper.notNull = function (t) {
        return-1 == n.inArray(t, [null, void 0, "false", "null", "undefined", 0])
    };
    HTMLHelper.hideControl = function (n) {
        return n.css({position: "absolute", top: -1e3, left: -1e3})
    };
    HTMLHelper.createPopup = function (n, t, i) {
        return new HTMLHelper.Popup(n, t, i).render()
    };
    HTMLHelper.Popup = function (t, i, r) {
        if (this.jqDiv = void 0 !== t.selector ? t : t.nodeType ? n(t) : HTMLHelper.Element.create("div", t), r) {
            var u = this;
            n.each(r, function (n, t) {
                u[n] = t
            })
        }
        TradingView.setMouseEventHandler(this.jqDiv, this);
        this._callback = i
    };
    HTMLHelper.Popup.prototype.render = function () {
        return this.jqDiv
    };
    HTMLHelper.Popup.prototype.show = function () {
        this.jqDiv.show()
    };
    HTMLHelper.Popup.prototype.hide = function () {
        this.jqDiv.hide()
    };
    HTMLHelper.Popup.prototype.setVisible = function (n) {
        n ? this.show() : this.hide()
    };
    HTMLHelper.Popup.prototype.isVisible = function () {
        return this.jqDiv.is(":visible")
    };
    HTMLHelper.Popup.prototype.contextMenuEvent = function () {
        return!1
    };
    HTMLHelper.Popup.prototype.mouseDownOutsideEvent = function () {
        this.isVisible() && (!this._callback || this._callback()) && this.hide()
    }
}(jQuery);
HTMLHelper.Element = {};
HTMLHelper.Element.renderAttributes = function (n) {
    var t = "";
    for (attr in n)n[attr] && (t += " " + attr + '="' + n[attr] + '"');
    return t
};
HTMLHelper.Element.create = function (n, t) {
    var i = $(document.createElement(n));
    return t && (t.html && (i.html(t.html), delete t.html), i.attr(t)), i
};
HTMLHelper.Element.validAttributes = "abbr accept-charset accept accesskey action align alink alt archive axis background bgcolor border cellpadding cellspacing char charoff charset checked cite class classid clear code codebase codetype color cols colspan compact content coords data datetime declare defer dir disabled enctype face for frame frameborder headers height href hreflang hspace http-equiv id ismap label lang language link longdesc marginheight marginwidth maxlength media method multiple name nohref noresize noshade nowrap object onblur onchange onclick ondblclick onfocus onkeydown onkeypress onkeyup onload onmousedown onmousemove onmouseout onmouseover onmouseup onreset onselect onsubmit onunload profile prompt readonly rel rev rows rowspan rules scheme scope scrolling selected shape size span src standby start style summary tabindex target text title type usemap valign value valuetype version vlink vspace width".split(" ");
HTMLHelper.Element.validAttribute = function (n) {
    return-1 != jQuery.inArray(n, HTMLHelper.Element.validAttributes)
};
HTMLHelper.Element.cleanAttributes = function (n) {
    return jQuery.each(n, function (t) {
        HTMLHelper.Element.validAttribute(t) || delete n[t]
    }), n
};
HTMLHelper.CUSTOM_SELECT_MINIMAL_WIDTH = 100;
HTMLHelper.Input = function (n) {
    return this.jqObj = null, this.data = n, this.init(), this._prepareValue(), this._prepareCallback(), this._prepareChildren(), this._applyAttributes(), this.jqObj
};
HTMLHelper.Input.selectOptions = {type: "option", value: null, html: null};
HTMLHelper.Input.optionsData = {radiogroup: {type: "radio", name: null, value: null, label: null}, select: HTMLHelper.Input.selectOptions, "select-one": HTMLHelper.Input.selectOptions, "select-multiple": HTMLHelper.Input.selectOptions};
HTMLHelper.Input.customTypes = ["radiogroup", "fontpicker", "colorpicker", "combobox"];
HTMLHelper.Input.prototype._tagIsInput = function () {
    return-1 != jQuery.inArray(this.data.type, "text radio checkbox hidden reset image file".split(" "))
};
HTMLHelper.Input.prototype.init = function () {
    this.jqObj = this._tagIsInput() ? HTMLHelper.Element.create("input", {name: this.data.name, type: this.data.type}) : HTMLHelper.Element.create(this.data.type, {name: this.data.name})
};
HTMLHelper.Input.prototype._eventIsKeyUp = function () {
    return-1 != jQuery.inArray(this.data.type, ["text", "textarea"])
};
HTMLHelper.Input.prototype._eventIsClick = function () {
    return-1 != jQuery.inArray(this.data.type, ["checkbox", "radio", "option"])
};
HTMLHelper.Input.prototype._eventIsChange = function () {
    return-1 != jQuery.inArray(this.data.type, ["select", "select-one", "select-multiple", "radiogroup"])
};
HTMLHelper.Input.prototype._prepareCallback = function () {
    this.data.callback && (this._eventIsKeyUp() ? this.jqObj.keyup(this.data.callback) : this._eventIsClick() ? this.jqObj.click(this.data.callback) : this._eventIsChange() && this.jqObj.bind("change", this.data.callback), delete this.data.callback)
};
HTMLHelper.Input.prototype._childTag = function () {
    return{select: "option", "select-one": "option", "select-multiple": "option", radiogroup: "radio"}[this.data.type]
};
HTMLHelper.Input.prototype._inheritedProperties = function () {
    var n = {type: this._childTag()};
    return"radiogroup" == this.data.type && (n.name = this.data.name), n
};
HTMLHelper.Input.prototype._extendChildProps = function (n) {
    var t = jQuery.extend(this._inheritedProperties(), n);
    return this.data.value == n.value && (t.selected = !0), t
};
HTMLHelper.Input.prototype._prepareChildren = function () {
    if (this.data.options) {
        var n = this;
        jQuery.each(this.data.options, function (t, i) {
            n.jqObj.append(new HTMLHelper.Input(n._extendChildProps(i)))
        })
    }
};
HTMLHelper.Input.prototype.isCustom = function () {
    return-1 != jQuery.inArray(this.data.type, this.customTypes)
};
HTMLHelper.Input.prototype._isStoringValue = function () {
    return-1 != jQuery.inArray(this.data.type, ["text", "textarea", "option", "radio", "checkbox"])
};
HTMLHelper.Input.prototype._htmlAsValue = function () {
    return"textarea" == this.data.type
};
HTMLHelper.Input.prototype._valAsValue = function () {
    return jQuery.inArray(this.data.type, "text checkbox radio option select select-one select-multiple".split(" "))
};
HTMLHelper.Input.prototype._getControlValue = function () {
    return{checkbox: 1}[this.data.type] || this.data.value
};
HTMLHelper.Input.prototype._setControlValue = function () {
    this._valAsValue() ? this.jqObj.val(this._getControlValue()) : this._htmlAsValue() && this.jqObj.html(this.data.value)
};
HTMLHelper.Input.prototype._getCheckedAttr = function () {
    return{option: "selected", radio: "checked", checkbox: "checked"}[this.data.type]
};
HTMLHelper.Input.prototype._setChecked = function () {
    this.data.selected && this.jqObj.attr(this._getCheckedAttr(), !0)
};
HTMLHelper.Input.prototype._setValue = function () {
    this._setControlValue();
    HTMLHelper.Input.isCheckable(this.data.type) && this._setChecked()
};
HTMLHelper.Input.prototype._prepareValue = function () {
    this._isStoringValue() && this._setValue()
};
HTMLHelper.Input.prototype._applyAttributes = function () {
    this.jqObj.attr(HTMLHelper.Element.cleanAttributes(this.data))
};
HTMLHelper.Input.value = function (n) {
    return HTMLHelper.Input.controlCheckable(n) ? n.checked : n.value
};
HTMLHelper.Input.isCheckable = function (n) {
    return-1 != jQuery.inArray(n, ["checkbox", "radio", "option"])
};
HTMLHelper.Input.controlType = function (n) {
    if ("string" == typeof n)return n;
    n = jQuery(n);
    var t = null;
    return n.attr("type") && (t = n.attr("type"), jQuery.inArray(t, "textarea text select select-one select-multiple submit".split(" "))) ? t : n.attr("tagName")
};
HTMLHelper.Input.controlCheckable = function (n) {
    return HTMLHelper.Input.isCheckable(HTMLHelper.Input.controlType(n))
};
HTMLHelper.Input.controlToggleChecked = function (n, t) {
    return HTMLHelper.setAttr(n, "checked", t)
};
HTMLHelper.Input.controlSetValue = function (n, t) {
    return HTMLHelper.Input.controlCheckable(n) ? HTMLHelper.Input.controlToggleChecked(n, t) : HTMLHelper.setAttr(n, "value", t)
};
HTMLHelper.Input.currentOption = function (n) {
    return n.options[n.selectedIndex]
};
HTMLHelper.Input.currentOptionInnerHTML = function (n) {
    return HTMLHelper.Input.currentOption(n).innerHTML
};
HTMLHelper.ComboboxItem = function (n, t) {
    this.value = n;
    this.html = t || "";
    this.jqItem = this._render()
};
HTMLHelper.ComboboxItem.prototype.eq = function (n) {
    return this.value === n
};
HTMLHelper.ComboboxItem.prototype.width = function () {
    return this.jqItem.width()
};
HTMLHelper.ComboboxItem.prototype._render = function (n) {
    return n = $("<span/>").append(this.html), $('<div class="item"><\/div>').append(n)
};
HTMLHelper.ComboboxItem.prototype.render = function () {
    return this.jqItem
};
HTMLHelper.ComboboxItem.prototype.select = function (n) {
    n ? this.jqItem.addClass("selected") : this.jqItem.removeClass("selected")
};
HTMLHelper.ComboboxItem.prototype.selectAndReturnIfValueMatch = function (n) {
    return this.eq(n) ? (this.select(!0), this) : (this.select(!1), null)
};
HTMLHelper.Combobox = function (n) {
    this._value = null;
    this.items = [];
    this.width = 0;
    this.callback = this.jqItems = this.jqIcon = this.jqTitle = this.jqSwitcher = this.jqWrapper = null;
    this._init();
    this.addItems(n);
    this.joinParts()
};
HTMLHelper.Combobox.prototype._init = function () {
    this._initWrapper();
    this._initSwitcher();
    this._initOptions()
};
HTMLHelper.Combobox.prototype._initTitle = function () {
    this.jqTitle = $('<span class="title" />')
};
HTMLHelper.Combobox.prototype._initIcon = function () {
    this.jqIcon = $('<span class="icon" />')
};
HTMLHelper.Combobox.prototype._initOptions = function () {
    this.jqItems = HTMLHelper.createPopup({"class": "items"})
};
HTMLHelper.Combobox.prototype._initWrapper = function () {
    this.jqWrapper = $('<div class="custom-select" />');
    this.jqWrapper.data({disable: this.disable.bind(this), enable: this.enable.bind(this)})
};
HTMLHelper.Combobox.prototype._initSwitcher = function () {
    var n = this;
    this._initTitle();
    this._initIcon();
    this.jqSwitcher = $('<div class="switcher" />');
    this.jqSwitcher.append(this.jqTitle);
    this.jqSwitcher.append(this.jqIcon);
    this.jqSwitcher.click(function () {
        n.toggleItems()
    })
};
HTMLHelper.Combobox.prototype.toggleItems = function () {
    this.disabled() || this.jqItems.toggle()
};
HTMLHelper.Combobox.prototype.setWidth = function () {
    this.jqWrapper.width(this.width)
};
HTMLHelper.Combobox.prototype.joinParts = function () {
    this.jqWrapper.append(this.jqSwitcher);
    this.jqWrapper.append(this.jqItems);
    this.jqWrapper.selectable(!1)
};
HTMLHelper.Combobox.prototype.render = function () {
    return this.jqWrapper
};
HTMLHelper.Combobox.prototype.selectItemByValue = function (n) {
    var t = null;
    return $(this.items).each(function (i, r) {
        var u = r.selectAndReturnIfValueMatch(n);
        u && (t = u)
    }), t
};
HTMLHelper.Combobox.prototype.setValue = function (n) {
    if (this._value != n) {
        var t = this.selectItemByValue(n);
        this._value = n;
        this.jqTitle.html(t.html);
        this.change()
    }
};
HTMLHelper.Combobox.prototype.change = function (n) {
    n ? this.callback = n : this.callback && this.callback.call(this)
};
HTMLHelper.Combobox.prototype.value = function () {
    return this._value
};
HTMLHelper.Combobox.prototype.val = function (n) {
    if (void 0 !== n)this.setValue(n); else return this.value()
};
HTMLHelper.Combobox.prototype.addItems = function (n) {
    var t = this;
    $(n).each(function (n, i) {
        t.addItem(i.value, i.html)
    })
};
HTMLHelper.Combobox.prototype.addItem = function (n, t) {
    var r = this, i = new HTMLHelper.ComboboxItem(n, t);
    this.items.push(i);
    i = i.render();
    i.click(function () {
        r.setValue(n);
        r.toggleItems()
    });
    this.jqItems.append(i);
    null === this.value() && this.setValue(n)
};
HTMLHelper.Combobox.prototype.disable = function () {
    this._disabled = !0
};
HTMLHelper.Combobox.prototype.enable = function () {
    this._disabled = !1
};
HTMLHelper.Combobox.prototype.disabled = function () {
    return this._disabled
};
List.prototype.validator = function () {
    return this.m_validator
};
List.prototype.setValidator = function (n) {
    this.m_validator = n
};
List.prototype.item = function (n) {
    return this.m_values[n]
};
List.prototype.setItem = function (n, t) {
    if (!isInteger(n))throw new RangeError("incorrect index");
    if (0 > n || n >= this.m_values.length)throw new RangeError("incorrect index");
    if (null !== this.m_validator && !this.m_validator.check(t))throw new TypeError("value is of unexpected type");
    this.m_values[n] = t
};
List.prototype.first = function () {
    return this.item(0)
};
List.prototype.last = function () {
    return this.item(this.size() - 1)
};
List.prototype.append = function (n) {
    if (null !== this.m_validator && !this.m_validator.check(n))throw new TypeError("value is of unexpected type");
    return this.m_values.push(n), this
};
List.prototype.insert = function (n, t) {
    if (!isInteger(t))throw new RangeError("invalid index:" + t);
    if (0 > t || t > this.size())throw new RangeError("invalid index:" + t);
    this.m_values.splice(t, 0, n)
};
List.prototype.appendAll = function (n) {
    if (!new TypeValidator(List).check(n))throw new TypeError("parameter must be of type List");
    for (var t = 0; t < n.size(); ++t)this.m_values.push(n.item(t));
    return this
};
List.prototype.removeAt = function (n) {
    if (!isInteger(n))throw new RangeError("incorrect index");
    if (0 > n || n >= this.m_values.length)throw new RangeError("incorrect index");
    this.m_values.splice(n, 1)
};
List.prototype.size = function () {
    return this.m_values.length
};
List.prototype.isEmpty = function () {
    return 0 === this.size()
};
List.prototype.indexOf = function (n) {
    if (null !== this.m_validator && !this.m_validator.check(n))throw new TypeError("value is of unexpected type");
    return this.m_values.indexOf(n)
};
List.prototype.contains = function (n) {
    return-1 != this.indexOf(n)
};
List.prototype.remove = function (n) {
    if (null !== this.m_validator && !this.m_validator.check(n))throw new TypeError("value is of unexpected type");
    n = this.indexOf(n);
    -1 !== n && this.removeAt(n)
};
List.prototype.removeAll = function (n) {
    this.m_values = this.m_values.filter(function (t) {
        return!n(t)
    })
};
List.prototype.clear = function () {
    this.m_values = []
};
List.prototype.clone = function () {
    var n = new List;
    return n.setValidator(this.validator()), n.m_values = this.m_values.slice(), n
};
List.prototype.toArray = function () {
    return this.m_values
};
List.prototype.sort = function (n) {
    this.m_values.sort(n)
};
List.prototype.find = function (n) {
    for (var t = 0; t < this.m_values.length; t++)if (n(this.m_values[t], t, this.m_values))return this.m_values[t]
};
List.prototype.count = function (n) {
    for (var i = 0, t = 0; t < this.m_values.length; t++)n(this.m_values[t], t, this.m_values) && i++;
    return i
};
loadTVScript = function () {
    var n = null;
    return function () {
        return n || (n = "undefined" != typeof TVScript ? $.Deferred().resolve() : loadScript(window.TVSCRIPT_FILES)), n.promise()
    }
}();
MathEx = {lessThan: function (n, t) {
    return n <= t
}, greaterThan: function (n, t) {
    return n >= t
}, clamp: function (n, t, i) {
    return Math.min(Math.max(n, t), i)
}, sign: function (n) {
    return 0 > n ? -1 : 0 < n ? 1 : 0
}, isBaseDecimal: function (n) {
    if (0 > n)return TradingView.logDebug("MathEx.isBaseDecimal: argument less zero"), !1;
    for (; 1 < n; n /= 10)if (0 != n % 10)return!1;
    return!0
}, greaterOrEqual: function (n, t, i) {
    return t - n <= i
}, equal: function (n, t, i) {
    return Math.abs(n - t) < i
}, log10: function (n) {
    if (0 >= n)TradingView.logDebug("MathEx.log10: argument less or equal zero"); else return Math.log(n) / Math.log(10)
}, defComparator: function (n, t) {
    return n < t ? -1 : n > t ? 1 : 0
}, min: function (n, t) {
    if (!isArray(n))throw"argument is not array";
    if (1 > n.length)throw"array is empty";
    t || (t = MathEx.defComparator);
    for (var r = n[0], i = 0; i < n.length; ++i)0 > t(n[i], r) && (r = n[i]);
    return r
}, max: function (n, t) {
    if (!isArray(n))throw"argument is not array";
    if (1 > n.length)throw"array is empty";
    t || (t = MathEx.defComparator);
    for (var r = n[0], i = 0; i < n.length; ++i)0 < t(n[i], r) && (r = n[i]);
    return r
}, Point: function (n, t) {
    this.x = n;
    this.y = t
}};
MathEx.Point.prototype.add = function (n) {
    return new MathEx.Point(this.x + n.x, this.y + n.y)
};
MathEx.Point.prototype.addScaled = function (n, t) {
    return new MathEx.Point(this.x + t * n.x, this.y + t * n.y)
};
MathEx.Point.prototype.substract = function (n) {
    return new MathEx.Point(this.x - n.x, this.y - n.y)
};
MathEx.Point.prototype.dotProduct = function (n) {
    return this.x * n.x + this.y * n.y
};
MathEx.Point.prototype.length = function () {
    return Math.sqrt(this.x * this.x + this.y * this.y)
};
MathEx.Point.prototype.scaled = function (n) {
    return new MathEx.Point(this.x * n, this.y * n)
};
MathEx.Point.prototype.normalized = function () {
    return this.scaled(1 / this.length())
};
MathEx.Point.prototype.transponed = function () {
    return new MathEx.Point(-this.y, this.x)
};
MathEx.Point.prototype.clone = function () {
    return new MathEx.Point(this.x, this.y)
};
MathEx.Matrix = function () {
    this._rows = [
        [1, 0, 0],
        [0, 1, 0],
        [0, 0, 1]
    ]
};
MathEx.Matrix.prototype.mult = function (n) {
    var r, t, i, u;
    if (n instanceof MathEx.Matrix) {
        for (r = new MathEx.Matrix, t = 0; 3 > t; t++)for (i = 0; 3 > i; i++)for (u = r._rows[t][i] = 0; 3 > u; u++)r._rows[t][i] += this._rows[t][u] * n._rows[u][i];
        return r
    }
    if (n instanceof MathEx.Point) {
        for (n = [n.x, n.y, 1], r = [0, 0, 0], t = 0; 3 > t; t++)for (i = 0; 3 > i; i++)r[t] += n[i] * this._rows[t][i];
        return new MathEx.Point(r[0], r[1])
    }
    throw"unsupported type";
};
MathEx.Matrix.rotate = function (n) {
    var t = new MathEx.Matrix;
    return t._rows[0][0] = Math.cos(n), t._rows[1][1] = Math.cos(n), t._rows[0][1] = -Math.sin(n), t._rows[1][0] = Math.sin(n), t
};
MathEx.Matrix.scale = function (n, t) {
    var i = new MathEx.Matrix;
    return i._rows[0][0] = n, i._rows[1][1] = t, i
};
MathEx.Matrix.translate = function (n, t) {
    var i = new MathEx.Matrix;
    return i._rows[0][2] = n, i._rows[1][2] = t, i
};
MathEx.distanceToLine = function (n, t, i) {
    t = t.substract(n);
    var r = i.substract(n).dotProduct(t) / t.dotProduct(t);
    return{distance: n.addScaled(t, r).substract(i).length(), coeff: r}
};
MathEx.distanceToSegment = function (n, t, i) {
    var r = MathEx.distanceToLine(n, t, i);
    return 0 <= r.coeff && 1 >= r.coeff ? r : (n = n.substract(i).length(), t = t.substract(i).length(), n < t ? {distance: n, coeff: 0} : {distance: t, coeff: 1})
};
MathEx.intersectLines = function (n, t, i, r) {
    return(t = t.substract(n), r = r.substract(i), t = t.x * r.y - t.y * r.x, 1e-6 > Math.abs(t)) ? null : (n = n.substract(i), (n.y * r.x - n.x * r.y) / t)
};
MathEx.intersectSegment = function (n, t, i, r) {
    var u = MathEx.intersectLines(n, t, i, r);
    return null === u ? null : (n = t.substract(n).scaled(u).add(n), i = MathEx.distanceToSegment(i, r, n), 1e-6 > Math.abs(i.distance) ? u : null)
};
MathEx.pointInRect = function (n, t, i) {
    return n.x >= t.x && n.x <= i.x && n.y >= t.y && n.y <= i.y
};
MathEx.pointInTriangle = function (n, t, i, r) {
    var f = n.add(t).scaled(.5).add(i).scaled(.5), u = MathEx.intersectSegment(n, t, f, r);
    return null !== u ? !1 : (u = MathEx.intersectSegment(t, i, f, r), null !== u) ? !1 : (u = MathEx.intersectSegment(i, n, f, r), null !== u ? !1 : !0)
};
MathEx.intersectRayWithRect = function (n, t, i, r) {
    var f = MathEx.intersectLines(n, t, i, new MathEx.Point(r.x, i.y)), e = MathEx.intersectLines(n, t, new MathEx.Point(r.x, i.y), r), o = MathEx.intersectLines(n, t, r, new MathEx.Point(i.x, r.y)), s = MathEx.intersectLines(n, t, new MathEx.Point(i.x, r.y), i), u = [];
    return(f && 0 <= f && u.push(f), e && 0 <= e && u.push(e), o && 0 <= o && u.push(o), s && 0 <= s && u.push(s), 0 === u.length) ? null : (u.sort(function (n, t) {
        return n - t
    }), i = MathEx.pointInRect(n, i, r) ? u[0] : u[u.length - 1], n.addScaled(t.substract(n), i))
};
MathEx.isInPolygon = function (n, t) {
    for (var r, f = 0, i = n.size() - 1, e = !1, o = t.x, u = t.y, f = 0; f < n.size(); f++)r = n.item(f), i = n.item(i), (r.y < u && i.y >= u || i.y < u && r.y >= u) && r.x + (u - r.y) / (i.y - r.y) * (i.x - r.x) < o && (e = !e), i = f;
    return e
};
MathEx.isInCircle = function (n, t, i) {
    return n = (i.x - n.x) * (i.x - n.x) + (i.y - n.y) * (i.y - n.y), radiusQ = t * t, n <= radiusQ
};
MathEx.optionalCorner = function (n, t, i, r) {
    return 1e-6 < Math.abs(n.x - t.x) && 1e-6 < Math.abs(n.y - t.y) ? 0 == Math.round(n.x) || 0 == Math.round(t.x) ? 0 == Math.round(n.y) || 0 == Math.round(t.y) ? new MathEx.Point(0, 0) : new MathEx.Point(0, r) : 0 == Math.round(n.y) || 0 == Math.round(t.y) ? new MathEx.Point(i, 0) : new MathEx.Point(i, r) : null
};
CanvasEx = {LINESTYLE_SOLID: 0, LINESTYLE_DOTTED: 1, LINESTYLE_DASHED: 2, LINESTYLE_LARGE_DASHED: 3, TEXTPOS_TOPLEFT: 0, TEXTPOS_TOPCENTER: 1, TEXTPOS_TOPRIGHT: 2, TEXTPOS_MIDDLELEFT: 3, TEXTPOS_MIDDLECENTER: 4, TEXTPOS_MIDDLERIGHT: 5, TEXTPOS_BOTTOMLEFT: 6, TEXTPOS_BOTTOMCENTER: 7, TEXTPOS_BOTTOMRIGHT: 8, MARKLOC_ABOVEBAR: "AboveBar", MARKLOC_BELOWBAR: "BelowBar", MARKLOC_TOP: "Top", MARKLOC_BOTTOM: "Bottom", MARKLOC_RIGHT: "Right", MARKLOC_LEFT: "Left", MARKLOC_ABSOLUTE: "Absolute", MARKLOC_ABSOLUTEUP: "AbsoluteUp", MARKLOC_ABSOLUTEDOWN: "AbsoluteDown", HHISTLOC_RELATIVE: "relative", HHISTLOC_ABSOLUTE: "absolute", HHISTDIR_LEFTTORIGHT: "left_to_right", HHISTDIR_RIGHTTOLEFT: "right_to_left", computeDashPattern: function (n) {
    return[
        [n.lineWidth, 2 * n.lineWidth],
        [3 * n.lineWidth, 2 * n.lineWidth],
        [6 * n.lineWidth, 6 * n.lineWidth]
    ][n.lineStyle - 1]
}, drawLine: function (n, t, i, r, u) {
    isFinite(t) && isFinite(r) && isFinite(i) && isFinite(u) && (n.lineStyle === CanvasEx.LINESTYLE_DASHED || n.lineStyle === CanvasEx.LINESTYLE_DOTTED ? n.drawDashedLine(n, t, i, r, u) : CanvasEx.drawSolidLine(n, t, i, r, u))
}, drawSolidLine: function (n, t, i, r, u) {
    n.beginPath();
    n.moveTo(t, i);
    n.lineTo(r, u);
    n.stroke()
}, setLineStyle: function (n, t) {
    if (n.lineStyle = t, t != CanvasEx.LINESTYLE_SOLID) {
        var i = CanvasEx.computeDashPattern(n);
        "function" == typeof n.setLineDash ? n.setLineDash(i) : void 0 !== n.mozDash ? n.mozDash = i : void 0 !== n.webkitLineDash && (n.webkitLineDash = i)
    }
}, drawPoly: function (n, t, i) {
    var r, u;
    for (n.beginPath(), n.moveTo(t[0].x, t[0].y), r = 0; r < t.length; r++)u = t[r], n.lineTo(u.x, u.y);
    n.closePath();
    n.stroke();
    i && n.fill()
}, lineStyles: []};
"undefined" != typeof CanvasRenderingContext2D && (CanvasRenderingContext2D.prototype.lineStyle = CanvasEx.LINESTYLE_SOLID, CanvasEx.originalSave = CanvasRenderingContext2D.prototype.save, CanvasEx.originalRestore = CanvasRenderingContext2D.prototype.restore, CanvasRenderingContext2D.prototype.save = function () {
    CanvasEx.lineStyles.push(this.lineStyle);
    CanvasEx.originalSave.call(this)
}, CanvasRenderingContext2D.prototype.restore = function () {
    0 < CanvasEx.lineStyles.length && (this.lineStyle = CanvasEx.lineStyles.pop(), CanvasEx.originalRestore.call(this))
}, CanvasRenderingContext2D.prototype.drawDashedLine = function (n, t, i, r, u) {
    n.save();
    var f = CanvasEx.computeDashPattern(n);
    if (n.beginPath(), "function" == typeof n.setLineDash)n.setLineDash(f); else if (void 0 !== n.mozDash)n.mozDash = f; else if (void 0 !== n.webkitLineDash)n.webkitLineDash = f; else {
        n.dashedLineTo(t, i, r, u, f);
        n.stroke();
        n.restore();
        return
    }
    n.moveTo(t, i);
    n.lineTo(r, u);
    n.stroke();
    n.restore()
}, CanvasRenderingContext2D.prototype.dashedLineTo = function (n, t, i, r, u) {
    var f = {thereYet: MathEx.greaterThan, cap: Math.min}, e = {thereYet: MathEx.greaterThan, cap: Math.min};
    0 < t - r && (e.thereYet = MathEx.lessThan, e.cap = Math.max);
    0 < n - i && (f.thereYet = MathEx.lessThan, f.cap = Math.max);
    this.moveTo(n, t);
    for (var o = n, s = t, h = 0, c = !0; !f.thereYet(o, i) || !e.thereYet(s, r);) {
        var l = Math.atan2(r - t, i - n), a = u[h], o = f.cap(i, o + Math.cos(l) * a), s = e.cap(r, s + Math.sin(l) * a);
        c ? this.lineTo(o, s) : this.moveTo(o, s);
        h = (h + 1) % u.length;
        c = !c
    }
}, CanvasRenderingContext2D.prototype.roundRect = function (n, t, i, r, u) {
    this.beginPath();
    this.moveTo(n + u, t);
    this.lineTo(n + i - u, t);
    this.arcTo(n + i, t, n + i, t + u, u);
    this.lineTo(n + i, t + r - u);
    this.arcTo(n + i, t + r, n + i - u, t + r, u);
    this.lineTo(n + u, t + r);
    this.arcTo(n, t + r, n, t + r - u, u);
    this.lineTo(n, t + u);
    this.arcTo(n, t, n + u, t, u)
});
String.prototype.left = function (n) {
    if (!isInteger(n))throw"invalid length";
    if (n > this.length)throw"invalid length";
    return this.substring(0, n)
};
String.prototype.right = function (n) {
    if (!isInteger(n))throw"invalid length";
    if (n > this.length)throw"invalid length";
    return this.substring(this.length - n, this.length)
};
String.prototype.trimmed = function () {
    return this.replace(/^\s*/, "").replace(/\s*$/, "")
};
String.prototype.startsWith = function (n) {
    return n.length > this.length ? !1 : this.left(n.length) === n
};
Delegate.prototype.subscribe = function (n, t, i) {
    this._listeners.append({object: n, member: t, singleshot: !!i})
};
Delegate.prototype.unsubscribe = function (n, t) {
    for (var r, i = 0; i < this._listeners.size(); ++i)if (r = this._listeners.item(i), r.object === n && r.member.prototype === t.prototype) {
        this._listeners.removeAt(i);
        break
    }
};
Delegate.prototype.fire = function (n) {
    for (var t, r = $.extend(!0, {}, this._listeners), i = 0; i < r.size(); ++i)t = r.item(i), t.object ? t.member.call(t.object, n) : t.member(n);
    this._listeners.removeAll(function (n) {
        return n.singleshot
    })
};
TradingView.rgbToHsl = function (n, t, i) {
    var e, r;
    n /= 255;
    t /= 255;
    i /= 255;
    var u = Math.max(n, t, i), r = Math.min(n, t, i), f, o = (u + r) / 2;
    if (u == r)f = r = 0; else {
        e = u - r;
        r = .5 < o ? e / (2 - u - r) : e / (u + r);
        switch (u) {
            case n:
                f = (t - i) / e + (t < i ? 6 : 0);
                break;
            case t:
                f = (i - n) / e + 2;
                break;
            case i:
                f = (n - t) / e + 4
        }
        f /= 6
    }
    return[f, r, o]
};
TradingView.hslToRgb = function (n, t, i) {
    if (0 === t)i = t = n = i; else {
        var u = function (n, t, i) {
            return 0 > i && (i += 1), 1 < i && --i, i < 1 / 6 ? n + 6 * (t - n) * i : .5 > i ? t : i < 2 / 3 ? n + (t - n) * (2 / 3 - i) * 6 : n
        }, r = .5 > i ? i * (1 + t) : i + t - i * t, f = 2 * i - r;
        i = u(f, r, n + 1 / 3);
        t = u(f, r, n);
        n = u(f, r, n - 1 / 3)
    }
    return[Math.round(255 * i), Math.round(255 * t), Math.round(255 * n)]
};
PixelSet.prototype.rawData = function () {
    return this._rawData
};
PixelSet.prototype.width = function () {
    return this._width
};
PixelSet.prototype.height = function () {
    return this._height
};
PixelSet.prototype.pixel = function (n, t) {
    var i = [], r = t * this._width * 4 + 4 * n;
    return i.push(this._rawData[r]), i.push(this._rawData[r + 1]), i.push(this._rawData[r + 2]), i.push(this._rawData[r + 3]), i
};
PixelSet.prototype.setPixel = function (n, t, i) {
    n = t * this._width * 4 + 4 * n;
    this._rawData[n] = i[0];
    this._rawData[n + 1] = i[1];
    this._rawData[n + 2] = i[2];
    this._rawData[n + 3] = i[3]
};
PixelSet.prototype.blend = function (n, t, i, r, u, f, e) {
    var o, c, l;
    for (r || (r = this.width()), u || (u = this.height()), f || (f = 0), e || (e = 0), o = n.getImageData(t, i, r, u), c = 0; c < r; c++)for (l = 0; l < u; l++) {
        var s = l * r * 4 + 4 * c, a = this.pixel(f + c, e + l), v = a[1], y = a[2], h = 1 - a[3] / 255;
        o.data[s] = o.data[s] * h + a[0] * (1 - h);
        o.data[s + 1] = o.data[s + 1] * h + v * (1 - h);
        o.data[s + 2] = o.data[s + 2] * h + y * (1 - h);
        o.data[s + 3] = Math.max(a[3], o.data[s + 3])
    }
    n.putImageData(o, t, i)
};
TradingView.getImage = function (n, t) {
    var r = document.body, i = r[n];
    return i || (i = document.createElement("img"), i.src = t, r[n] = i), i
};
D68 = function () {
    function t(n, t) {
        var i = function () {
        };
        return i.prototype = t.prototype, n.prototype = new i, n
    }

    function e() {
    }

    function s(n) {
        this.value = n
    }

    function u() {
    }

    function f() {
    }

    function i() {
    }

    function h() {
    }

    function c() {
    }

    function l() {
    }

    function o() {
    }

    function n(n) {
        this.value = n
    }

    function r(n) {
        this.value = n
    }

    function w(n) {
        this.value = n
    }

    function a() {
        n.apply(this, arguments)
    }

    function b() {
        r.apply(this, arguments)
    }

    function v(t, i) {
        var e = [], f, o, u;
        n:for (; f = nt.exec(t);) {
            for (u = p.length; u--;)if (void 0 !== f[u + 1]) {
                p[u].ctor && (u = new p[u].ctor(f[u + 1]), u._offset = f.index, e.push(u));
                continue n
            }
            u = new w(f[0]);
            u._offset = f.index;
            e.push(u)
        }
        if (i && i.recover)for (u = e.length; u--;)f = e[u], f instanceof r || f instanceof n ? (void 0 !== o && (f = new n(""), o = e.splice(u, o - u + 1, f), f.value = o.map(function (n) {
            return n.value
        }).join("")), o = u) : f instanceof s || (o = void 0);
        return e
    }

    function k(n) {
        for (var i = [], t = 0; t < n.length; t++)n[t]instanceof s || i.push(n[t]);
        return i
    }

    function y(n) {
        var t;
        n = k(n);
        for (var o = [], r = [], e = 0; e < n.length; e++)if (t = n[e], t instanceof i)r.length && r[r.length - 1].minPrecedence > t.precedence && (r[r.length - 1].minPrecedence = t.precedence); else if (t instanceof u)r.push({minPrecedence: Infinity, openBraceIndex: e}); else if (t instanceof f) {
            var t = r.pop(), s = n[t.openBraceIndex - 1], h = n[e + 1];
            h instanceof i && !(h.precedence <= t.minPrecedence) || s instanceof i && !(s.precedence < t.minPrecedence || s.precedence === t.minPrecedence && s.commutative) || (o.unshift(t.openBraceIndex), o.push(e), r.length && r[r.length - 1].minPrecedence > t.minPrecedence && (r[r.length - 1].minPrecedence = t.minPrecedence))
        }
        for (e = o.length; e--;)n.splice(o[e], 1);
        return n
    }

    function tt(n) {
        for (var t, e = 0, h = 0, l, c = 0; c < n.length; c++)if (t = n[c], !(t instanceof s))switch (e) {
            case 0:
                if (t instanceof r && 1 == +t.value)e = 1; else return!1;
                break;
            case 1:
                if (1 === e && t instanceof o)e = 2, l = c + 1; else return!1;
                break;
            case 2:
                if (t instanceof u)e = 3, h = 1; else if (t instanceof i)return!1;
                break;
            case 3:
                t instanceof u ? h++ : t instanceof f && (h--, 0 >= h && (e = 2))
        }
        return n.slice(l)
    }

    var p = [
        {pattern: "(", ctor: u},
        {pattern: ")", ctor: f},
        {pattern: "+", ctor: h},
        {pattern: "-", ctor: c},
        {pattern: "*", ctor: l},
        {pattern: "/", ctor: o},
        {pattern: /\d+(?:\.\d*|(?![a-zA-Z0-9_!:\.&]))|\.\d+/, ctor: r},
        {pattern: /\./, ctor: b},
        {pattern: J77.enabled("charting_library") ? /[a-zA-Z0-9_\u4e00-\u9fa5^][a-zA-Z0-9_\u4e00-\u9fa5_!:\.&]*|'.+?'/ : /[a-zA-Z0-9][a-zA-Z0-9_!|:\.&]*|'.+?'/, ctor: n},
        {pattern: /'[^']*/, ctor: a},
        {pattern: /[\0-\x20\s]+/, ctor: s}
    ], d, g, nt;
    return e.prototype.toString = function () {
        return this.value
    }, t(s, e), t(u, e), u.prototype.value = "(", t(f, e), f.prototype.value = ")", t(i, e), t(h, i), h.prototype.value = "+", h.prototype.precedence = 0, h.prototype.commutative = !0, t(c, i), c.prototype.value = "-", c.prototype.precedence = 0, c.prototype.commutative = !1, t(l, i), l.prototype.value = "*", l.prototype.precedence = 1, l.prototype.commutative = !0, t(o, i), o.prototype.value = "/", o.prototype.precedence = 1, o.prototype.commutative = !1, d = /^'?(?:([A-Z0-9_]+):)?(.*?)'?$/i, g = /[\+\-\/\*]/, t(n, e), n.prototype.toString = function () {
        if (this.hasOwnProperty("_ticker")) {
            var n = g.test(this._ticker) ? "'" : "";
            return n + (this._exchange ? this._exchange + ":" : "") + this._ticker + n
        }
        return this.value
    }, n.prototype.parse = function () {
        var n = d.exec(this.value);
        n[1] && (this._exchange = n[1]);
        this._ticker = n[2]
    }, n.prototype.parseAsFutures = function () {
        var i, n, t;
        if (TradingView.futuresRoots)for (this.hasOwnProperty("_ticker") || this.parse(), i = function (n) {
            return TradingView.futuresRoots.some(function (t) {
                return t.t === n
            })
        }, n = 2; 1 <= n; --n)if (t = this._ticker.slice(0, n), i(t)) {
            this._root = t;
            this._contract = this._ticker.slice(n);
            break
        }
    }, n.prototype.exchange = function (n) {
        if (this.hasOwnProperty("_ticker") || this.parse(), 0 < arguments.length)null === n || void 0 === n ? delete this._exchange : this._exchange = n + ""; else return this._exchange
    }, n.prototype.ticker = function (n) {
        if (this.hasOwnProperty("_ticker") || this.parse(), 0 < arguments.length)null === n || void 0 === n ? delete this._ticker : this._ticker = n + "", delete this._root, delete this._contract; else return this._ticker
    }, n.prototype.root = function (n) {
        if (this.hasOwnProperty("_root") || this.parseAsFutures(), 0 < arguments.length)null === n || void 0 === n ? delete this._root : (this._root = n + "") && (this._ticker = this._root + (this._contract || "")); else return this._root
    }, n.prototype.contract = function (n) {
        if (this.hasOwnProperty("_contract") || this.parseAsFutures(), 0 < arguments.length)null === n || void 0 === n ? delete this._contract : (this._contract = n + "", this._root && (this._ticker = this._root + this._contract)); else return this._root
    }, t(r, e), r.prototype.toString = function () {
        return this.hasOwnProperty("_normalizedValue") ? this._normalizedValue : this.value
    }, r.prototype.parse = function () {
        this._normalizedValue = this.value.replace(/^0+|\.0*$/g, "").replace(/(\.\d*?)0+$/, "$1").replace(/^(\.|$)/, "0$1")
    }, w.prototype.toString = function () {
        return this.value
    }, t(a, n), a.prototype.isIncomplete = !0, a.prototype.incompleteSuggest = function () {
        if ("'" !== this.value)return new String("'")
    }, t(b, r), b.prototype.isIncomplete = !0, nt = new RegExp(p.map(function (n) {
        return"(" + ("string" == typeof n.pattern ? n.pattern.replace(/[\^\$\(\)\[\]\{\}\*\+\?\|\\]/g, "\\$&") : n.pattern.source) + ")"
    }).concat(".").join("|"), "g"), {tokenize: v, validate: function (t) {
        var e, c;
        if (J77.enabled("charting_library"))return{currentState: "var"};
        for (var h = "init", o = {warnings: [], errors: [], isEmpty: !0}, l = [], a = 0; a < t.length; a++)if (e = t[a], !(e instanceof s)) {
            if (delete o.isEmpty, e.isIncomplete && (c = {status: "incomplete", reason: "incomplete_token", offset: e._offset, token: e}, e.incompleteSuggest && (c.recover = {append: e.incompleteSuggest()}), o.warnings.push(c), a !== t.length - 1)) {
                c.status = "error";
                continue
            }
            e instanceof n || e instanceof r ? "var" == h ? o.errors.push({status: "error", reason: "unexpected_token", offset: e._offset, token: e}) : h = "var" : e instanceof i ? "var" != h ? o.errors.push({status: "error", reason: "unexpected_token", offset: e._offset, token: e}) : h = "operator" : e instanceof u ? "var" == h ? o.errors.push({status: "error", reason: "unexpected_token", offset: e._offset, token: e}) : (l.push(e), h = "init") : e instanceof f ? "var" != h ? o.errors.push({status: "error", reason: "unexpected_token", offset: e._offset, token: e}) : (l.pop() || o.errors.push({status: "error", reason: "unbalanced_brace", offset: e._offset, token: e, recover: {prepend: new u}}), h = "var") : e instanceof w && o.errors.push({status: "error", reason: "unparsed_entity", offset: e._offset, token: e})
        }
        for (o.braceBalance = l.length, "var" !== h && o.warnings.push({status: "incomplete"}); l.length;)e = l.pop(), c = {status: "incomplete", reason: "unbalanced_brace", offset: e._offset, token: e}, "var" == h && (c.recover = {append: new f}), o.warnings.push(c);
        return o.currentState = h, 0 === o.warnings.length && delete o.warnings, 0 === o.errors.length && delete o.errors, o
    }, factorOutBraces: y, normalizeTokens: function (n) {
        for (var t = 0; t < n.length; t++)n[t].parse && n[t].parse();
        return n
    }, flip: function (n) {
        var t = tt(n);
        return t ? y(t) : y([new r("1"), new o, new u].concat(n).concat(new f))
    }, hasBatsSymbols: function (t) {
        if ("string" == typeof t)t = v(t); else if (!Array.isArray(t))throw new TypeError("expression must be a string or token array");
        return t.some(function (t) {
            return t instanceof n && "BATS" === (t.exchange() || "").toUpperCase() ? !0 : !1
        })
    }, hasEodSymbols: function (t) {
        if ("string" == typeof t)t = v(t); else if (!Array.isArray(t))throw new TypeError("expression must be a string or token array");
        return t.some(function (t) {
            return t instanceof n && -1 !== (t.exchange() || "").toUpperCase().indexOf("_EOD") ? !0 : !1
        })
    }, SymbolToken: n, IncompleteSymbolToken: a, NumberToken: r, BinaryOperatorToken: i, OpenBraceToken: u, CloseBraceToken: f, ticker: function (t) {
        return new n(t).ticker()
    }, shortName: function (t) {
        if ("string" != typeof t)throw new TypeError("expression must be a string");
        return t = y(k(v(t))), t.forEach(function (t) {
            t instanceof n && t.exchange(null)
        }), t.join("")
    }, normalize: function (n) {
        if ("string" != typeof n)throw new TypeError("expression must be a string");
        return y(k(v(n))).join("")
    }}
}();
WatchedValue.prototype.value = function () {
    return this._owner ? this._owner._value : this._value
};
WatchedValue.prototype.setValue = function (n, t) {
    var i = this._owner ? this._owner : this;
    if ("function" == typeof i.hook && (n = i.hook(n)), i.writeLock)return i._value;
    if (!t && i._value === n && i.hasOwnProperty("_value"))return n;
    i._value = n;
    for (var u = i._listeners.slice(), f = 0, r = 0; r < u.length; r++)u[r].once && (i._listeners.splice(r - f, 1), f++), u[r].cb(n);
    return n
};
WatchedValue.prototype.deleteValue = function () {
    var t = this._owner ? this._owner : this, i, n;
    if (t.hasOwnProperty("_value")) {
        if (t.writeLock)return t._value;
        for (delete t._value, i = t._listeners.slice(), n = 0; n < i.length; n++)i[n].once && t._listeners.splice(n - deletedEntries, 1);
        for (n = 0; n < i.length; n++)i[n].cb()
    }
};
WatchedValue.prototype.subscribe = function (n, t) {
    if ("function" != typeof n)throw new TypeError("callback must be a function");
    var r = !!t && !!t.once, i = this._owner ? this._owner : this;
    t && t.callWithLast && i.hasOwnProperty("_value") && (n(i._value), r) || i._listeners.push({cb: n, owner: this, once: !!t && !!t.once})
};
WatchedValue.prototype.unsubscribe = function (n) {
    var r = this._owner ? this._owner : this, t, i;
    for (void 0 === n && (n = null), t = r._listeners, i = t.length; i--;)t[i].owner !== this && r !== this || t[i].cb !== n && null !== n || t.splice(i, 1)
};
WatchedValue.prototype.readonly = function () {
    if (this._readonlyInstance)return this._readonlyInstance;
    var n = this._readonlyInstance = new ReadonlyWatchedValue;
    return n.subscribe = this.subscribe.bind(this), n.unsubscribe = this.unsubscribe.bind(this), n.value = this.value.bind(this), n.when = this.when.bind(this), n
};
WatchedValue.prototype.spawn = function () {
    var n = new WatchedValue;
    return delete n._listeners, n._owner = this._owner || this, n.destroy = function () {
        this.unsubscribe();
        delete this._owner
    }, n
};
WatchedValue.prototype.when = function (n) {
    var i = this, t;
    this.value() ? n() : (t = function (r) {
        r && (i.unsubscribe(t), n())
    }, i.subscribe(t))
};
WEB_SOCKET_SWF_LOCATION = TradingView.resourceFullPath("web_socket_main.swf");
WEB_SOCKET_WAS_CONNECTED = WEB_SOCKET_DEBUG = !1;
STUDY_COUNT_LIMIT = 100;
J98.prototype.defaultWatchlistSymbols = function () {
};
J98.prototype.availableTimeFrames = function () {
};
J98.prototype.defaultResolutions = function () {
};
J98.prototype.supportedSymbolsTypes = function () {
};
J98.prototype.supportedExchangesList = function () {
};
J98.prototype.setAuthToken = function () {
};
J98.prototype.authTokenRequired = function () {
};
J98.prototype.quoteCreateSession = function () {
};
J98.prototype.quoteDeleteSession = function () {
};
J98.prototype.quoteSetFields = function () {
};
J98.prototype.quoteAddSymbols = function () {
};
J98.prototype.quoteRemoveSymbols = function () {
};
J98.prototype.quoteFastSymbols = function () {
};
J98.prototype.depthCreateSession = function () {
};
J98.prototype.depthDeleteSession = function () {
};
J98.prototype.depthSetSymbol = function () {
};
J98.prototype.depthClearSymbol = function () {
};
J98.prototype.depthSetScale = function () {
};
J98.prototype.chartCreateSession = function () {
};
J98.prototype.chartDeleteSession = function () {
};
J98.prototype.createSession = function () {
};
J98.prototype.removeSession = function () {
};
J98.prototype.connected = function () {
};
J98.prototype._getHost = function () {
};
J98.prototype.connect = function () {
};
J98.prototype.disconnect = function () {
};
J98.prototype.switchTimezone = function () {
};
J98.prototype.resolveSymbol = function () {
};
J98.prototype.createSeries = function () {
};
J98.prototype.removeSeries = function () {
};
J98.prototype.modifySeries = function () {
};
J98.prototype.requestMoreData = function () {
};
J98.prototype.requestMetadata = function () {
};
J98.prototype.isCanCreateStudy = function () {
};
J98.prototype.createStudy = function () {
};
J98.prototype.removeStudy = function () {
};
J98.prototype.modifyStudy = function () {
};
J98.prototype.createPointset = function () {
};
J98.prototype.modifyPointset = function () {
};
J98.prototype.removePointset = function () {
};
J98.prototype.requestMoreTickmarks = function () {
};
J98.prototype.requestFirstBarTime = function () {
};
J98.prototype._invokeHandler = function () {
};
J98.prototype._sendRequest = function () {
};
J98.prototype._onMessage = function () {
};
J98.prototype._convertTimescaleResponse = function () {
};
J98.prototype._dispathNotification = function () {
};
J98.prototype._invokeNotificationHandler = function () {
};
J98.prototype._notifySessions = function () {
};
J98.prototype.unpack = function () {
};
J98.prototype.reconnectTimeout = function () {
};
J98.prototype.searchSymbolsByName = function () {
};
J98.prototype._isSafari5 = function () {
};
J98.prototype._isIE9 = function () {
};
J98.prototype._isIOS5 = function () {
};
J98.prototype._getPort = function () {
};
J98.prototype.getMarks = function () {
};
declareClassAsPureInterface(J98, "J98");
ChartSession.prototype.serverTimeOffset = function () {
    return this._chartApi._serverTimeOffset
};
ChartSession.prototype.connected = function () {
    return this._chartApi.connected() && !this._sessionDisabled
};
ChartSession.prototype.disconnected = function () {
    var n = this;
    Object.keys(this).forEach(function (t) {
        /^(s|st|symbol_)\d+$/.test(t) && delete n[t]
    })
};
ChartSession.prototype.initSession = function () {
    this._chartApi.createSession(this._sessionid, this)
};
ChartSession.prototype.stopSession = function () {
    this._chartApi.removeSession(this._sessionid)
};
ChartSession.prototype.setHandler = function (n) {
    this._globalHandler = n
};
ChartSession.prototype.connect = function (n) {
    this._globalHandler = n;
    this.initSession();
    this._chartApi.connect()
};
ChartSession.prototype.disconnect = function () {
    this._chartApi.disconnect()
};
ChartSession.prototype.switchTimezone = function (n) {
    this._chartApi.switchTimezone(this._sessionid, n)
};
ChartSession.prototype.resolveSymbol = function (n, t, i) {
    this._chartApi.resolveSymbol(this._sessionid, n, t, i)
};
ChartSession.prototype.createSeries = function (n, t, i, r, u, f) {
    this._chartApi.createSeries(this._sessionid, n, t, i, r, u, f)
};
ChartSession.prototype.removeSeries = function (n, t) {
    this._chartApi.removeSeries(this._sessionid, n, t)
};
ChartSession.prototype.modifySeries = function (n, t, i, r, u) {
    this._chartApi.modifySeries(this._sessionid, n, t, i, r, u)
};
ChartSession.prototype.requestMoreData = function (n, t, i) {
    this._chartApi.requestMoreData(this._sessionid, n, t, i)
};
ChartSession.prototype.requestMetadata = function (n, t) {
    this._chartApi.requestMetadata(this._sessionid, n, t)
};
ChartSession.prototype.createStudy = function (n, t, i, r, u, f) {
    this._chartApi.createStudy(this._sessionid, n, t, i, r, u, f)
};
ChartSession.prototype.removeStudy = function (n, t) {
    this._chartApi.removeStudy(this._sessionid, n, t)
};
ChartSession.prototype.modifyStudy = function (n, t, i, r) {
    this._chartApi.modifyStudy(this._sessionid, n, t, i, r)
};
ChartSession.prototype.createPointset = function (n, t, i, r, u, f) {
    this._chartApi.createPointset(this._sessionid, n, t, i, r, u, f)
};
ChartSession.prototype.modifyPointset = function (n, t, i, r) {
    this._chartApi.modifyPointset(this._sessionid, n, t, i, r)
};
ChartSession.prototype.removePointset = function (n, t) {
    this._chartApi.removePointset(this._sessionid, n, t)
};
ChartSession.prototype.requestMoreTickmarks = function (n, t, i) {
    this._chartApi.requestMoreTickmarks(this._sessionid, n, t, i)
};
ChartSession.prototype.requestFirstBarTime = function (n, t, i) {
    this._chartApi.requestFirstBarTime(this._sessionid, n, t, i)
};
ChartSession.prototype.setVisibleTimeRange = function (n, t, i) {
    this._chartApi.setVisibleTimeRange(this._sessionid, n, t, i)
};
ChartSession.prototype.onMessage = function (n) {
    switch (n.method) {
        case"connected":
            this._chartApi.chartCreateSession(this._sessionid, this._disableStatistics);
            break;
        case"disconnected":
            this.disconnected()
    }
    this._globalHandler && this._globalHandler(n)
};
ChartSession.prototype.disable = function () {
    this._sessionDisabled = !0
};
TimeIndexes.prototype.clear = function () {
    this._zoffset = 0;
    this._items = [];
    this._lastTimePointIndex = null
};
TimeIndexes.prototype.items = function () {
    return this._items
};
TimeIndexes.prototype.size = function () {
    return this._items.length
};
TimeIndexes.prototype.firstTimePointIndex = function () {
    return this.offsetToIndex(0)
};
TimeIndexes.prototype.lastTimePointIndex = function () {
    return null !== this._lastTimePointIndex && void 0 !== this._lastTimePointIndex ? this._lastTimePointIndex : this._lastTimePointIndex = this.offsetToIndex(this.size() - 1)
};
TimeIndexes.prototype.merge = function (n, t, i) {
    var u, r, f;
    if (0 === this._items.length)return this._items = i, this._zoffset = t, [
        {change: "rebuild", index: 0}
    ];
    if (u = n + this._zoffset, 0 > u) {
        for (u = Math.abs(u), this._items = Array(u).concat(this._items), this._zoffset = t, r = 0; r < i.length; ++r)this._items[n + r + t] = i[r];
        return[
            {change: "rebuild", index: 0}
        ]
    }
    for (n = [], r = u; r < this._items.length && r - u < i.length; ++r)this._items[r] = i[r - u], n.push({change: "update", index: r - this._zoffset, value: i[r - u]});
    if (u += i.length, u > this._items.length)for (u -= this._items.length, r = 0; r < u; ++r)f = this._items.length, this._items.push(i[r]), n.push({change: "append", index: f - this._zoffset, value: i[r]});
    return this._zoffset = t, this._lastTimePointIndex = null, n
};
TimeIndexes.prototype.addTail = function (n, t) {
    for (var i = t ? 1 : 0; i < n.length; i++)this._items.push(n[i]), this._lastTimePointIndex++
};
TimeIndexes.prototype.valueAt = function (n) {
    return n = this.indexToOffset(n), void 0 !== n ? this._items[n] : void 0
};
TimeIndexes.prototype.indexOf = function (n, t) {
    if (t && n > this._items[this._items.length - 1])return this.offsetToIndex(this._items.length - 1);
    for (var i = 0; i < this._items.length && !(n < this._items[i]); ++i)if (!(n > this._items[i]))return this.offsetToIndex(i);
    if (t)return this.offsetToIndex(i)
};
TimeIndexes.prototype.offsetToIndex = function (n) {
    if (0 <= n && n < this.size())return n - this._zoffset
};
TimeIndexes.prototype.indexToOffset = function (n) {
    return n += this._zoffset, 0 <= n && n < this.size() ? n : void 0
};
TimeIndexes.prototype.state = function () {
    var n = {};
    return n.zoffset = this._zoffset, n.items = this._items, n
};
TimeIndexes.prototype.restoreState = function (n) {
    n && (this._zoffset = n.zoffset, this._items = n.items, this._lastTimePointIndex = null)
};
TimeIndexes.prototype.closestIndexLeft = function (n) {
    var u = this._items, r, i, t, f;
    if (u.length && n === n) {
        if (r = u.length - 1, n >= u[r])return r - this._zoffset;
        if (i = 0, t = u[i], !(n < t)) {
            if (n == t)return i - this._zoffset;
            for (; r > i + 1;)if (t = i + r >> 1, f = u[t], f > n)r = t; else if (f < n)i = t; else return f === n ? t - this._zoffset : void 0;
            return i - this._zoffset
        }
    }
};
PlotList.prototype.clear = function () {
    this._items = [];
    this._columns = [];
    this._end = this._start = 0;
    this._shareread = !1
};
PlotList.prototype.columns = function () {
    return this._columns
};
PlotList.prototype.last = function () {
    return this._items[this._end - this._start - 1]
};
PlotList.prototype.first = function () {
    return this._items[0]
};
PlotList.prototype.firstIndex = function () {
    return this._start
};
PlotList.prototype.lastIndex = function () {
    return this._end - this._start - 1
};
PlotList.prototype.size = function () {
    return this._end - this._start
};
PlotList.prototype.isEmpty = function () {
    return 0 === this.size()
};
PlotList.prototype.contains = function (n) {
    return-1 != this._search(n)
};
PlotList.prototype.valueAt = function (n) {
    if (n = this.search(n))return n.value
};
PlotList.prototype.add = function (n, t) {
    if (this._shareread)return TradingView.logDebug("PlotList.add: readonly collection modification attempt"), !1;
    var r = this._createPair(n, t), i = this._search(n);
    return 0 > i ? (i = this._lowerbound(n, -1), this._items.splice(i, 0, r), this._start = 0, this._end = this._items.length, !0) : (this._items[i] = r, !1)
};
var SEARCH_NEAREST_LEFT = -1, SEARCH_EXACT = 0, SEARCH_NEAREST_RIGHT = 1;
PlotList.prototype.search = function (n, t) {
    var i = this._search(n, t);
    if (!(0 > i))return{index: this._indexAt(i), value: this._valueAt(i)}
};
PlotList.prototype.fold = function (n, t) {
    for (var r = t, i = this._start; i < this._end; ++i)r = n(this._indexAt(i), this._valueAt(i), r);
    return r
};
PlotList.prototype.each = function (n) {
    for (var t = this._start; t < this._end && !n(this._indexAt(t), this._valueAt(t)); ++t);
};
PlotList.prototype.reduce = function (n, t) {
    for (var r = t, i = this._start; i < this._end; ++i)r = n(r, this._indexAt(i), this._valueAt(i));
    return r
};
PlotList.prototype.range = function (n, t) {
    var i = new PlotList;
    return i._items = this._items, i._start = this._lowerbound(n), i._end = Math.min(this._lowerbound(t) + 1, i._items.length), i._items[i._end - 1] > t && (i._end = i._start), i._shareread = !0, i
};
PlotList.prototype.minMaxOnRange = function (n, t, i) {
    for (var u, o = this._lowerbound(n), s = Math.min(this._lowerbound(t) + 1, this._items.length), f = null, e = null, h = 0; h < i.length; h++) {
        var r = i[h], o = this._lowerbound(n - r.offset), s = Math.min(this._lowerbound(t - r.offset) + 1, this._items.length);
        for (this._items[s - 1] > t - r.offset && (s = o); o < s; o++)u = this._items[o].value[r.index], void 0 !== u && null !== u && ((null === f || u < f) && (f = u), (null == e || u > e) && (e = u));
        void 0 !== r.baseValue && (f = Math.min(r.baseValue, f), e = Math.max(r.baseValue, e))
    }
    return{min: f, max: e}
};
PlotList.prototype.merge = function (n) {
    var i, r, t;
    if (this._shareread)return TradingView.logDebug("PlotList.merge: shared collection modification attempt"), [];
    for (i = [], r = 0; r < n.length; ++r)t = n[r], this.add(t.index, t.value) ? i.push({insert: t}) : i.push({update: t});
    return i
};
PlotList.prototype.addTail = function (n, t) {
    var i = 0, r;
    for (t && 0 < this._end - this._start && (i = 1, this._items[this._end - this._start - 1].value = n[0].value); i < n.length; ++i)r = n[i], this.add(parseInt(this.last(), 10) + 1, r.value)
};
PlotList.prototype._createPair = function (n, t) {
    var i = new Number(n);
    return i.value = t, i
};
PlotList.prototype._valueAt = function (n) {
    return this._items[n].value
};
PlotList.prototype._length = function () {
    return this._items.length
};
PlotList.prototype._indexAt = function (n) {
    return this._items[n].valueOf()
};
PlotList.prototype._search = function (n, t) {
    var i = this._bsearch(n);
    return-1 != i || !t ? i : 0 > t ? (i = this._lowerbound(n), i > this._start && --i, i != this._end && this._indexAt(i) < n ? i : -1) : (i = this._upperbound(n), i != this._end && n < this._indexAt(i) ? i : -1)
};
PlotList.prototype._bsearch = function (n) {
    var t = this._lowerbound(n);
    return t == this._end || n < this._items[t] ? -1 : t
};
PlotList.prototype._lowerbound = function (n) {
    for (var r, u, t = this._start, i = this._end - t; 0 < i;)r = i >> 1, u = t + r, this._items[u] < n ? (t = u + 1, i -= r + 1) : i = r;
    return t
};
PlotList.prototype._upperbound = function (n) {
    for (var r, u, t = this._start, i = this._end - t; 0 < i;)r = i >> 1, u = t + r, n < this._items[u] ? i = r : (t = u + 1, i -= r + 1);
    return t
};
PlotList.prototype.state = function () {
    var n = {}, t;
    n.columns = this._columns;
    n.start = this._start;
    n.end = this._end;
    n.shareread = this._shareread;
    n.data = [];
    for (t in this._items)n.data.push({index: new Number(this._items[t]), value: this._items[t].value});
    return n
};
PlotList.prototype.restoreState = function (n) {
    var t, i;
    if (n)for (this._columns = n.columns, this._start = n.start, this._end = n.end, this._shareread = n.shareread, this._items = [], t = 0; t < n.data.length; t++)i = new Number(n.data[t].index), i.value = n.data[t].value, this._items.push(i); else this.clear()
};
PlotList.prototype.firstTimeIndex = function () {
    return this._indexAt(this._start)
};
PlotList.prototype.lastTimeIndex = function () {
    return this._indexAt(this._end - 1)
};
StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION = 29;
StudyMetaInfo.FilledArea = {};
StudyMetaInfo.FilledArea.TYPE_PLOTS = "plot_plot";
StudyMetaInfo.FilledArea.TYPE_HLINES = "hline_hline";
StudyMetaInfo.versionOf = function (n) {
    return n = "_metainfoVersion"in n && isNumber(n._metainfoVersion) ? n._metainfoVersion : 0, (0 > n || n > StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION) && console.warn("Client doesn't support this version of metainfo format: " + n), n
};
StudyMetaInfo.parseIdString = function (n) {
    var t = {}, i;
    if (-1 == n.indexOf("@"))t.shortId = n, t.packageId = "tv-basicstudies", t.id = n + "@" + t.packageId, t.version = 1; else if (i = n.split("@"), t.shortId = i[0], i = i[1].split("-"), 3 === i.length)t.packageId = i.slice(0, 2).join("-"), t.id = t.shortId + "@" + t.packageId, t.version = i[2]; else if (1 === i.length && "decisionbar" === i[0])t.packageId = "les-" + i[0], t.id = t.shortId + "@" + t.packageId, t.version = 1; else if (1 === i.length)t.packageId = "tv-" + i[0], t.id = t.shortId + "@" + t.packageId, t.version = 1; else throw Error("unexpected study id:" + n);
    return t.fullId = t.id + "-" + t.version, "tv-scripting" === t.packageId ? (n = t.shortId, 0 === n.indexOf("Script$") ? (i = n.indexOf("_"), t.productId = 0 <= i ? n.substring(0, i) : t.packageId) : t.productId = t.packageId) : t.productId = t.packageId, t
};
StudyMetaInfo.getPackageName = function (n) {
    return(/^[^@]+@([^-]+-[^-]+)/.exec(n || "") || [0, "tv-basicstudies"])[1]
};
StudyMetaInfo.cutFullId = function (n) {
    return n.replace(/(@[^-]+-[^-]+).*$/, "$1")
};
StudyMetaInfo.cutDollarHash = function (n) {
    var t = n.indexOf("$"), i = n.indexOf("@");
    return-1 == t ? n : (t = n.substr(0, t), n = 0 <= i ? n.substr(i) : "", t + n)
};
StudyMetaInfo.prototype.parseValue = function (n, t) {
    return"bool" === n ? parseBool(t) : t
};
StudyMetaInfo.prototype.defaultInputs = function () {
    for (var t = new List, n = 0; n < this.inputs.length; n++)t.append(this.inputs[n].defval);
    return t
};
StudyMetaInfo.prototype.state = function () {
    var t = {};
    for (var n in this)this.hasOwnProperty(n) && (t[n] = this[n], "id" === n && (t[n] += "-" + this.version));
    return t
};
StudyMetaInfo.findStudyMetaInfoByDescription = function (n, t) {
    if (n) {
        for (var i = 0; i < n.size(); ++i)if (n.item(i).description.toLowerCase() === t.toLowerCase())return n.item(i);
        throw Error("unexpected study id:" + t);
    }
    throw Error("There is no studies metainfo");
};
StudyMetaInfo.findStudyMetaInfo = function (n, t) {
    if (n) {
        for (var i = 0; i < n.size(); ++i)if (n.item(i).id === t)return n.item(i);
        throw Error("unexpected study id:" + t);
    }
    throw Error("There is no studies metainfo");
};
StudyMetaInfo.removeStudyMetaInfo = function (n, t) {
    if (n) {
        for (var i = 0; i < n.size(); ++i)if (n.item(i).id === t)return n.removeAt(i), defaults.remove("study_" + t), !0;
        return!1
    }
    throw Error("There is no studies metainfo");
};
StudyMetaInfo.addStudyMetaInfo = function (n, t) {
    var i = new StudyMetaInfo(t), r;
    return assert(!1 === StudyMetaInfo.removeStudyMetaInfo(n, i.id), "Study with id=" + t.id + " already exists in the model"), n.append(i), t.defaults && (r = TradingView.clone(t.defaults), r.precision = "default", defaults.create("study_" + t.id, r)), i
};
StudyMetaInfo.addOrReplaceStudyMetaInfo = function (n, t) {
    var i = new StudyMetaInfo(t), r;
    return StudyMetaInfo.removeStudyMetaInfo(n, i.id), n.append(i), t.defaults && (r = TradingView.clone(t.defaults), r.precision = "default", defaults.createOrReplace("study_" + t.id, r)), i
};
StudyMetaInfo.sortStudiesMetainfo = function (n) {
    n.sort(function (n, t) {
        var i = defaults("study_" + n.id).description, r = defaults("study_" + t.id).description;
        return i < r ? -1 : i > r ? 1 : 0
    })
};
StudyMetaInfo.setStudyHidden = function (n, t) {
    if (!n)throw Error("There is no studies metainfo");
    for (var i = 0; i < n.size(); ++i)if (n.item(i).id === t)return n.is_hidden_study = !0;
    return!1
};
StudyMetaInfo.createMetaInfoStub = function (n, t) {
    var i = n.scriptIdPart || TVScript.MetainfoGenerator.createScriptIdPart();
    return{id: TVScript.MetainfoGenerator.createScriptStudyId(n.scriptIdPart, t), scriptIdPart: n.scriptIdPart, description: n.scriptName, TVScriptSourceCode: n.scriptSource, version: t, _buildFullMetaInfo: function () {
        return(new TVScript.TvsTranslator).translate(n.scriptSource, !0, null, i, t).metaInfo
    }}
};
StudyMetaInfo.replaceWithFullStudyMetaInfo = function (n, t) {
    if (t._buildFullMetaInfo) {
        try {
            var i = t._buildFullMetaInfo()
        } catch (r) {
            i = D57.createScriptStub(t.TVScriptSourceCode, t.scriptIdPart, t.version)
        }
        return StudyMetaInfo.addOrReplaceStudyMetaInfo(n, i)
    }
    return t
};
"undefined" != typeof module && module && module.exports && (module.exports = StudyMetaInfo);
StudyMetaInfo.getOrderedInputIds = function (n) {
    var i = [], t;
    for (n = n.inputs, t = 0; t < n.length; ++t)i.push(n[t].id);
    return i
};
TradingView.drawingState = function () {
    function f(n) {
        return"cursor" === n || "arrow" === n || "dot" === n
    }

    var n = null, t = null, i = null, r = new WatchedValue, u = new WatchedValue, e = !1;
    return{tool: r, cursorTool: u, toolIsCursor: f, resetToCursor: function (t) {
        !t && n && n.stayInDrawingMode.value() || this.tool.setValue(this.cursorTool.value())
    }, init: function () {
        e || (r.setValue(TVSettings.getValue("chart.cursorPreference", "cursor")), r.subscribe(function (n) {
            f(n) && u.setValue(n)
        }, {callWithLast: !0}), u.subscribe(function (n) {
            n && TVSettings.setValue("chart.cursorPreference", n)
        }), n = new _52("drawings"), t = new Property, i = new Property, hideMarksOnBars = new Property, t.setValue(!1), i.setValue(!1), hideMarksOnBars.setValue(!1), e = !0)
    }, properties: function () {
        return n
    }, hideAllDrawings: function () {
        return t
    }, hideMarksOnBars: function () {
        return hideMarksOnBars
    }, lockDrawings: function () {
        return i
    }}
}();
HitTestResult.REGULAR = 1;
HitTestResult.MOVEPOINT = 2;
HitTestResult.CHANGEPOINT = 3;
HitTestResult.CUSTOM = 4;
HitTestResult.prototype.result = function () {
    return this._result
};
HitTestResult.prototype.data = function () {
    return this._data
};
HitTestResult.prototype.eraseMarker = function () {
    return this._eraseMarker
};
DataSource.prototype.id = function () {
    return this._id
};
DataSource.prototype.setId = function (n) {
    this._id = n
};
DataSource.prototype.zorder = function () {
    return this._zorder
};
DataSource.prototype.setZorder = function (n) {
    "number" == typeof n && this._zorder != n && (this._zorder = n)
};
DataSource.prototype.priceScale = function () {
    return this.m_priceScale
};
DataSource.prototype.setPriceScale = function (n) {
    this.m_priceScale = n
};
DataSource.prototype.ownerSource = function () {
    return this._ownerSource
};
DataSource.prototype.setOwnerSource = function (n) {
    (this._ownerSource = n) && this.setPriceScale(n.priceScale())
};
DataSource.prototype.isSavedInStudyTemplates = function () {
    return!0
};
DataSource.prototype.isRemovedByStudyTemplates = function () {
    return!0
};
DataSource.prototype.hasContextMenu = function () {
    return!0
};
DataSource.prototype.showInObjectTree = function () {
    return!0
};
DataSource.prototype.setUserEditEnabled = function (n) {
    this._userEditEnabled = n
};
DataSource.prototype.userEditEnabled = function () {
    return this._userEditEnabled
};
DataSource.prototype.isUserDeletable = function () {
    return this.userEditEnabled()
};
inherit(PriceDataSource, DataSource);
PriceDataSource.prototype.isNoScale = function () {
    return!!this._isOverlay
};
Property.prototype.merge = function (n) {
    if (null != n)if (this.isPrimitiveType(n))this._value = n; else if (isArray(n))for (var t = 0; t < n.length; t++)this[t] ? this[t].merge(n[t]) : this.addProperty(t, n[t]); else for (t in n)this[t] ? this[t].merge(n[t]) : this.addProperty(t, n[t])
};
Property.prototype.state = function (n) {
    var i = this._value, r, t, f, u, e;
    for (void 0 === i && (i = {}), r = 0; r < this._childs.length; r++)if (t = this._childs[r], !n || -1 === n.indexOf(t))if (n) {
        for (f = [], u = 0; u < n.length; u++)e = n[u], e.startsWith(t + ".") && f.push(e.substr(t.length + 1));
        i[t] = this[t].state(f)
    } else i[t] = this[t].state();
    return i
};
Property.prototype.isPrimitiveType = function (n) {
    return isNumber(n) || new TypeValidator(String).check(n) || isBoolean(n) ? !0 : !1
};
Property.prototype.value = function () {
    return this._value
};
Property.prototype.listeners = function () {
    return this._listeners
};
Property.prototype.childCount = function () {
    return this._childs.length
};
Property.prototype.setValue = function (n, t) {
    (this._value !== n || t) && (this._value = n, this._listeners.fire(this))
};
Property.prototype.addProperty = function (n, t) {
    var i = new Property(t);
    this[n] = i;
    this._childs.push(n);
    i.listeners().subscribe(this, Property.prototype.childChanged)
};
Property.prototype.addChild = function (n, t) {
    this[n] = t;
    -1 == $.inArray(n, this._childs) && this._childs.push(n);
    t.listeners().subscribe(this, Property.prototype.childChanged)
};
Property.prototype.childChanged = function () {
    this.listeners().fire(this)
};
Property.prototype.subscribe = function (n, t) {
    this.listeners().subscribe(n, t)
};
Property.prototype.unsubscribe = function (n, t) {
    this.listeners().unsubscribe(n, t)
};
inherit(_52, Property);
_52._saveDefaults = !1;
TradingView.saveDefaultProperties = function (n) {
    _52._saveDefaults = n
};
_52.prototype.addExclusion = function (n) {
    this._exclusions.push(n)
};
_52.prototype.restoreFactoryDefaults = function () {
    var t = {}, n;
    this._defaultName.startsWith("study_") && (t = TradingView.clone(factoryDefaults("study")));
    n = TradingView.clone(factoryDefaults(this._defaultName));
    this._defaultName.startsWith("study_") && n.inputs && delete n.inputs.symbol;
    "linetoolicon" === this._defaultName && (n.icon = defaults(this._defaultName).icon);
    ~"linetooltext linetooltextabsolute linetoolnote linetoolnoteabsolute linetoolcallout linetoolballoon linetoolarrowmark linetoolarrowmarkleft linetoolarrowmarkup linetoolarrowmarkright linetoolarrowmarkdown linetoolhorzline linetoolhorzray".split(" ").indexOf(this._defaultName) && delete n.text;
    TradingView.merge(t, n);
    this.merge(t);
    saveDefaults(this._defaultName, this.state(this._exclusions));
    this.listeners().fire(this)
};
_52.prototype.cleanupFactoryDefaults = function () {
    saveDefaults(this._defaultName, {});
    this.listeners().fire(this)
};
_52.prototype.onPropertyChanged = function () {
    _52._saveDefaults && this.saveDefaults()
};
_52.prototype.saveDefaults = function () {
    saveDefaults(this._defaultName, this.state(this._exclusions))
};
defaults.create = function (n, t) {
    if (t) {
        var i = StudyMetaInfo.parseIdString(n), r = factoryDefaults(i.id);
        defaultProperties[i.id] = $.extend(t, r)
    }
};
defaults.createOrReplace = function (n, t) {
    if (t) {
        var i = StudyMetaInfo.parseIdString(n);
        defaultProperties[i.id] = t
    }
};
defaults.remove = function (n) {
    defaultProperties[n] = void 0
};
PriceFormatter.prototype.isFractional = function () {
    return this._fractional
};
PriceFormatter.prototype.decimalSign = ".";
PriceFormatter.prototype.decimalSignFractional = "'";
PriceFormatter.prototype.southandDelimeter = "`";
PriceFormatter.prototype.fullPrecision = !1;
PriceFormatter.prototype.calculateDecimal = function () {
    if (this._fractionalLength = 0, 0 < this._priceScale && 0 < this._minMove) {
        var n = this._priceScale;
        for (this._minMove2 && (n /= this._minMove2); 1 < n;)n /= 10, this._fractionalLength++
    }
};
PriceFormatter.prototype.format = function (n, t) {
    var i = "";
    return 0 > n ? (i = !0 === t ? "−" : "-", n = -n) : n && !0 === t && (i = "+"), this._fractional ? i + this.formatAsFractional(n) : i + this.formatAsDecimal(n)
};
PriceFormatter.prototype.formatAsDecimal = function (n) {
    var t, i;
    return t = this._fractional ? Math.pow(10, this._fractionalLength || 0) : this._priceScale / this._minMove, i = Math.floor(n), n = Math.round(n * t) - i * t, n === t && (n = 0, i += 1), t = 1 >= t ? "" : this.decimalSign + numberToStringWithLeadingZero(n * this._minMove, this._fractionalLength), i.toString() + t
};
PriceFormatter.prototype.formatAsFractional = function (n) {
    var t = this._priceScale / this._minMove, i = Math.floor(n);
    if (n = Math.round(n * t) - i * t, n === t && (n = 0, i += 1), this._minMove2) {
        var t = ["0", "5"], r = n % this._minMove2;
        n = (n - r) / this._minMove2;
        n = numberToStringWithLeadingZero(n, this._fractionalLength) + this.decimalSignFractional + (2 === this._minMove2 ? t[r] : ["0", "2", "5", "7"][r])
    } else n = numberToStringWithLeadingZero(n * this._minMove, this._fractionalLength);
    return i.toString() + this.decimalSignFractional + n
};
inherit(PercentageFormatter, PriceFormatter);
PercentageFormatter.prototype.format = function (n, t) {
    return PriceFormatter.prototype.format.call(this, n, t) + "%"
};
DateFormatter.prototype.format = function (n) {
    return numberToStringWithLeadingZero(n.getUTCFullYear(), 4) + "-" + numberToStringWithLeadingZero(n.getUTCMonth() + 1, 2) + "-" + numberToStringWithLeadingZero(n.getUTCDate(), 2)
};
TimeFormatter.prototype.format = function (n) {
    return this._format_str.replace("%h", numberToStringWithLeadingZero(n.getUTCHours(), 2)).replace("%m", numberToStringWithLeadingZero(n.getUTCMinutes(), 2)).replace("%s", numberToStringWithLeadingZero(n.getUTCSeconds(), 2))
};
DateTimeFormatter.prototype.format = function (n) {
    var t = (new DateFormatter).format(n);
    return this._dwm || (t += " " + (new TimeFormatter).format(n)), t
};
VolumeFormatter.prototype.format = function (n) {
    function i(n) {
        return r._fractionalValues ? (n.toFixed(r._precision) + "").replace(/\.?0+$/, "") : n
    }

    if (!isNumber(n))return"---";
    var r = this, t = "";
    return(0 > n && (t = "-", n = -n), 1e100 <= n) ? "N/A" : ((!this._fractionalValues || 995 <= n) && (n = Math.round(n)), 995 > n) ? t + i(n) : 999995 > n ? t + i(n / 1e3) + "K" : 999999995 > n ? (n = 1e3 * Math.round(n / 1e3), t + i(n / 1e6) + "M") : (n = 1e6 * Math.round(n / 1e6), t + i(n / 1e9) + "B")
};
TimeSpanFormatter.prototype.format = function (n) {
    var f = 0 > n, i, r, u, t;
    return n = Math.abs(n), i = Math.floor(n / 86400), n -= 86400 * i, r = Math.floor(n / 3600), n -= 3600 * r, u = Math.floor(n / 60), n -= 60 * u, t = "", i && (t += i + " " + $.t("d", {context: "dates"}) + " "), r && (t += r + " " + $.t("h", {context: "dates"}) + " "), u && (t += u + " " + $.t("m", {context: "dates"}) + " "), n && (t += n + " " + $.t("s", {context: "dates"}) + " "), f && (t = "-" + t), t.trimmed()
};
PriceColorer.formatSign = function (n) {
    return 0 == n ? "#5A5D66" : 0 < n ? "#27AC66" : "#DA563E"
};
PriceColorer.formatDiff = function (n, t) {
    PriceColorer.signFormat(t - n)
};
PriceColorer.prototype.format = function (n) {
    try {
        return null === this._prev ? PriceColorer.formatSign(n) : PriceColorer.formatDiff(this._prev, n)
    } finally {
        this._prev = n
    }
};
AbstractBarColorer.prototype.barStyle = function (n, t, i) {
    for (var r = {}, u = this.backColorers.length - 1; 0 <= u; u--)this.backColorers[u].applyBarStyle(n, t, r, i);
    return this.applyBarStyle(n, t, r, i), r
};
AbstractBarColorer.prototype.pushBackBarColorer = function (n) {
    this.backColorers.push(n)
};
AbstractBarColorer.prototype.applyBarStyle = function () {
    throw Error("This function is supposed to be reimplemented in a subclass");
};
inherit(SeriesBarColorer, AbstractBarColorer);
SeriesBarColorer.prototype.applyBarStyle = function (n, t, i, r) {
    var f;
    i || (i = {});
    i.barColor = null;
    i.barBorderColor = null;
    i.isBarHollow = null;
    i.isBarUp = null;
    i.upColor = null;
    i.downColor = null;
    i.isTwoColorBar = null;
    f = this._series.properties();
    switch (f.style.value()) {
        case TradingView.Series.STYLE_LINE:
            i.barColor = f.lineStyle.color.value();
            break;
        case TradingView.Series.STYLE_AREA:
            i.barColor = f.areaStyle.linecolor.value();
            break;
        case TradingView.Series.STYLE_BARS:
            var e = f.barStyle.upColor.value(), o = f.barStyle.downColor.value(), s = e, h = o, u = this.findBar(n, !1, r);
            f.barStyle.barColorsOnPrevClose.value() ? (t = this.findPrevBar(n, !1, r), i.barColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? s : h) : (i.barColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? s : h);
            break;
        case TradingView.Series.STYLE_CANDLES:
            e = f.candleStyle.upColor.value();
            o = f.candleStyle.downColor.value();
            s = f.candleStyle.borderUpColor ? f.candleStyle.borderUpColor.value() : f.candleStyle.borderColor.value();
            h = f.candleStyle.borderDownColor ? f.candleStyle.borderDownColor.value() : f.candleStyle.borderColor.value();
            u = this.findBar(n, !1, r);
            f.candleStyle.barColorsOnPrevClose.value() ? (t = this.findPrevBar(n, !1, r), i.barColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? s : h) : (i.barColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? s : h);
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            e = f.hollowCandleStyle.upColor.value();
            o = f.hollowCandleStyle.downColor.value();
            s = f.hollowCandleStyle.borderUpColor ? f.hollowCandleStyle.borderUpColor.value() : f.hollowCandleStyle.borderColor.value();
            h = f.hollowCandleStyle.borderDownColor ? f.hollowCandleStyle.borderDownColor.value() : f.hollowCandleStyle.borderColor.value();
            u = this.findBar(n, !1, r);
            t = this.findPrevBar(n, !1, r);
            t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? (i.barColor = e, i.barBorderColor = s) : (i.barColor = o, i.barBorderColor = h);
            i.isBarHollow = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? !0 : !1;
            break;
        case TradingView.Series.STYLE_HEIKEN_ASHI:
            e = f.haStyle.upColor.value();
            o = f.haStyle.downColor.value();
            s = f.haStyle.borderUpColor.value();
            h = f.haStyle.borderDownColor.value();
            u = this.findBar(n, t, r);
            f.haStyle.barColorsOnPrevClose.value() ? (t = this.findPrevBar(n, t, r), i.barColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = t[CLOSE_PLOT] <= u[CLOSE_PLOT] ? s : h) : (i.barColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? e : o, i.barBorderColor = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? s : h);
            break;
        case TradingView.Series.STYLE_RENKO:
            u = this.findBar(n, t, r);
            u = u[OPEN_PLOT] <= u[CLOSE_PLOT];
            e = t ? f.renkoStyle.upColorProjection.value() : f.renkoStyle.upColor.value();
            o = t ? f.renkoStyle.downColorProjection.value() : f.renkoStyle.downColor.value();
            s = t ? f.renkoStyle.borderUpColorProjection.value() : f.renkoStyle.borderUpColor.value();
            h = t ? f.renkoStyle.borderDownColorProjection.value() : f.renkoStyle.borderDownColor.value();
            i.barColor = u ? e : o;
            i.barBorderColor = u ? s : h;
            i.isBarUp = u;
            break;
        case TradingView.Series.STYLE_PB:
            u = this.findBar(n, t, r);
            u = u[OPEN_PLOT] <= u[CLOSE_PLOT];
            e = t ? f.pbStyle.upColorProjection.value() : f.pbStyle.upColor.value();
            o = t ? f.pbStyle.downColorProjection.value() : f.pbStyle.downColor.value();
            s = t ? f.pbStyle.borderUpColorProjection.value() : f.pbStyle.borderUpColor.value();
            h = t ? f.pbStyle.borderDownColorProjection.value() : f.pbStyle.borderDownColor.value();
            i.barColor = u ? e : o;
            i.barBorderColor = u ? s : h;
            i.isBarUp = u;
            break;
        case TradingView.Series.STYLE_KAGI:
            i.upColor = t ? f.kagiStyle.upColorProjection.value() : f.kagiStyle.upColor.value();
            i.downColor = t ? f.kagiStyle.downColorProjection.value() : f.kagiStyle.downColor.value();
            e = null;
            u = this.findBar(n, t, r);
            u[LOW_PLOT] < u[ADT_PLOT] && u[ADT_PLOT] < u[HIGH_PLOT] ? (e = u[OPEN_PLOT] <= u[CLOSE_PLOT], i.isTwoColorBar = !0) : (e = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? u[OPEN_PLOT] == u[ADT_PLOT] ? !0 : !1 : u[OPEN_PLOT] == u[ADT_PLOT] ? !1 : !0, i.isTwoColorBar = !1);
            i.barColor = e ? i.upColor : i.downColor;
            i.isBarUp = u[OPEN_PLOT] <= u[CLOSE_PLOT];
            break;
        case TradingView.Series.STYLE_PNF:
            u = this.findBar(n, t, r);
            u = 0 < u[ADT_PLOT];
            e = t ? f.pnfStyle.upColorProjection.value() : f.pnfStyle.upColor.value();
            o = t ? f.pnfStyle.downColorProjection.value() : f.pnfStyle.downColor.value();
            i.isBarUp = u;
            i.barColor = u ? e : o
    }
    return i
};
SeriesBarColorer.prototype.getSeriesBars = function (n) {
    return n ? this._series.nsBars() : this._series.bars()
};
SeriesBarColorer.prototype._findBarFieldValue = function (n, t, i) {
    return n = this.getSeriesBars(i).valueAt(n), void 0 !== n ? n[t] : void 0
};
SeriesBarColorer.prototype.findBar = function (n, t, i) {
    return i ? i.value : this.getSeriesBars(t).valueAt(n) || []
};
SeriesBarColorer.prototype.findPrevBar = function (n, t, i) {
    return i ? i.previousValue || [] : (n = this._series.bars()._search(n, SEARCH_EXACT), 0 < n ? this._series.bars()._valueAt(n - 1) : [])
};
inherit(StudyBarColorer, AbstractBarColorer);
StudyBarColorer.prototype.applyBarStyle = function (n, t, i) {
    var u, r, f;
    return(i || (i = {}), t) ? i : (t = this.Q1.properties(), !t.visible.value()) ? i : (u = this.Q1.metaInfo(), r = this.Q1.data(), !r || 0 == r.size()) ? i : (f = this.Q1.offset(u.plots[this._plotIndex].id), n = r.valueAt(n - f), !n) ? i : (n = n[this._plotIndex + 1], null == n) ? i : (n = Math.round(n), r = u.plots[this._plotIndex].palette, t = t.palettes[r].colors[u.palettes[r].valToIndex ? u.palettes[r].valToIndex[n] : n].color.value(), i.barColor = t, i.upColor = t.color, i.downColor = t.color, i)
};
BarItem.prototype.setTime = function (n) {
    isNumber(n) ? this.time = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect time")
};
BarItem.prototype.setOpen = function (n) {
    isNumber(n) ? this.open = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect open")
};
BarItem.prototype.setHigh = function (n) {
    isNumber(n) ? this.high = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect high")
};
BarItem.prototype.setLow = function (n) {
    isNumber(n) ? this.low = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect low")
};
BarItem.prototype.setClose = function (n) {
    isNumber(n) ? this.close = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect close")
};
BarItem.prototype.setAdditionalPrice = function (n) {
    isNumber(n) ? this.additionalPrice = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect additionalPrice")
};
BarItem.prototype.setAdditionalNum = function (n) {
    isNumber(n) ? this.additionalNum = n : TradingView.logDebug("BarItem.setAdditionalNum: incorrect additionalNum")
};
BarsRange.prototype.isEmpty = function () {
    return null === this.m_firstBar || null === this.m_lastBar
};
BarsRange.prototype.clone = function () {
    return new BarsRange(this.m_firstBar, this.m_lastBar)
};
BarsRange.prototype.firstBar = function () {
    return this.m_firstBar
};
BarsRange.prototype.lastBar = function () {
    return this.m_lastBar
};
BarsRange.prototype.count = function () {
    return this.m_lastBar - this.m_firstBar + 1
};
BarsRange.prototype.resizeRight = function (n) {
    !isInteger(n) || 0 > n ? TradingView.logDebug("BarsRange: incorrect newWidth") : this.m_firstBar = this.m_lastBar - n + 1
};
BarsRange.prototype.shift = function (n) {
    isNumber(n) ? (this.m_firstBar = Math.round(this.m_firstBar + n), this.m_lastBar = Math.round(this.m_lastBar + n)) : TradingView.logDebug("BarsRange.shift: incorrect coeff")
};
BarsRange.prototype.contains = function (n) {
    return this.m_firstBar <= n && this.m_lastBar >= n
};
D47 = function (n, t) {
    this._magnetProperty = n;
    this._timeScale = t
};
D47.prototype.align = function (n, t, i) {
    var u = i.defaultPriceScale(), e = u.priceToCoordinate(n), r, f;
    if (!this._magnetProperty.value())return n;
    for (u = u.Q19(), i = null, r = 0; r < u.size(); r++)if (u.item(r)instanceof TradingView.Series) {
        i = u.item(r);
        break
    }
    if (i && (u = i.bars(), u.contains(t) && (t = u.valueAt(t), t = [t[OPEN_PLOT], t[HIGH_PLOT], t[LOW_PLOT], t[CLOSE_PLOT]], u = i.priceScale(), !u.isEmpty()))) {
        if (f = [], u.isPercent())for (i = i.firstValue(), r = 0; r < t.length; r++)t[r] = u.priceRange().convertToPercent(t[r], i);
        for (r = 0; r < t.length; r++)f.push({y: u.priceToCoordinate(t[r]), price: t[r]});
        f.sort(function (n, t) {
            var i = Math.abs(n.y - e), r = Math.abs(t.y - e);
            return i - r
        });
        i = f[0];
        50 > Math.abs(i.y - e) && (n = i.price)
    }
    return n
};
D77 = function () {
    function r() {
        if (t) {
            var n = t;
            t = null;
            n.isEmpty() || u(n)
        }
    }

    function u(r) {
        t ? t.addCommand(r) : (i.clear(), n.push(r))
    }

    var t = null, n = new UndoStack, i = new UndoStack;
    return{beginUndoMacro: function (n) {
        t && r();
        t = new UndoMacroCommand(n)
    }, endUndoMacro: r, undo: function () {
        if (n.isEmpty())return!1;
        var t = n.pop();
        return t.undo(), i.push(t), !0
    }, redo: function () {
        if (i.isEmpty())return!1;
        var t = i.pop();
        return t.redo(), n.push(t), !0
    }, pushUndoCommand: u, createUndoCheckpoint: function () {
        return{lastActualCommand: n.isEmpty() ? null : n.head()}
    }, undoToCheckpoint: function (t) {
        for (; !n.isEmpty() && t.lastActualCommand !== n.head();)n.pop().undo();
        i.clear()
    }, undoStack: function () {
        return n
    }, redoStack: function () {
        return i
    }, clearStack: function () {
        n.clear();
        i.clear()
    }}
}();
D77.setChartLayout = function (n, t) {
    if (n.layout.value() === t)return!1;
    var i = new SetChartLayoutCommand(n, t);
    i.redo();
    this.pushUndoCommand(i)
};
inherit(SetChartLayoutCommand, UndoCommand);
SetChartLayoutCommand.prototype.redo = function () {
    this.Q5.layout.setValue(this._newLayoutId)
};
SetChartLayoutCommand.prototype.undo = function () {
    this.Q5.layout.setValue(this._oldLayoutId)
};
inherit(J78, EventEmitter);
J78.prototype.version = function () {
    return this.m_model._version
};
J78.prototype.onData = function (n) {
    switch (n.method) {
        case"timescale_update":
            n = n.params;
            this.m_model.updateTimeScale(n.index, n.zoffset, n.changes, n.marks, n.clear)
    }
};
J78.prototype.paneForSource = function (n) {
    return this.m_model.paneForSource(n)
};
J78.prototype.createPane = function (n) {
    return this.m_model.createPane(n)
};
J78.prototype.dumpViews = function () {
    return this.m_model.dumpViews()
};
J78.prototype.readOnly = function () {
    return this.m_model.readOnly()
};
J78.prototype.restart = function () {
    this.m_model.restart()
};
J78.prototype.disconnect = function () {
    this.m_model.disconnect()
};
J78.prototype.studiesMetaData = function () {
    return this.m_model.studiesMetaData()
};
J78.prototype.studyVersioning = function () {
    return this.m_model.studyVersioning()
};
J78.prototype.chartModel = function () {
    return this.m_model
};
J78.prototype.undoStack = D77.undoStack;
J78.prototype.redoStack = D77.redoStack;
J78.prototype.undo = D77.undo;
J78.prototype.redo = D77.redo;
J78.prototype.pushUndoCommand = D77.pushUndoCommand;
J78.prototype.startScalePrice = function (n, t, i) {
    this.pushUndoCommand(new J89(this.m_model, n, t, t.state()));
    this.chartModel().startScalePrice(n, t, i)
};
J78.prototype.scalePriceTo = function (n, t, i) {
    this.chartModel().scalePriceTo(n, t, i)
};
J78.prototype.endScalePrice = function (n, t) {
    this.chartModel().endScalePrice(n, t)
};
J78.prototype.startScrollPrice = function (n, t, i) {
    t.isAutoScale() || (this._initialPriceScrollState = t.state(), this._initialPriceScrollPos = i, this.chartModel().startScrollPrice(n, t, i))
};
J78.prototype.scrollPriceTo = function (n, t, i) {
    t.isAutoScale() || (this._initialPriceScrollPos && 20 < Math.abs(this._initialPriceScrollPos - i) && (this.pushUndoCommand(new J89(this.m_model, n, t, this._initialPriceScrollState)), delete this._initialPriceScrollState, delete this._initialPriceScrollPos), this.chartModel().scrollPriceTo(n, t, i))
};
J78.prototype.endScrollPrice = function (n, t) {
    t.isAutoScale() || (delete this._initialPriceScrollState, delete this._initialPriceScrollPos, this.chartModel().endScrollPrice(n, t))
};
J78.prototype.setPriceAutoScale = function (n, t, i) {
    this.pushUndoCommand(new J89(this.m_model, n, t, t.state()));
    this.chartModel().setPriceAutoScale(n, t, i)
};
J78.prototype.resetPriceScale = function (n, t) {
    this.pushUndoCommand(new J89(this.m_model, n, t, t.state()));
    this.chartModel().resetPriceScale(n, t)
};
J78.prototype.startScaleTime = function (n) {
    this.pushUndoCommand(new J94(this.m_model, this.m_model.timeScale().state(), "scale time"));
    this.chartModel().startScaleTime(n)
};
J78.prototype.scaleTimeTo = function (n) {
    this.chartModel().scaleTimeTo(n)
};
J78.prototype.endScaleTime = function () {
    this.chartModel().endScaleTime()
};
J78.prototype.startScrollTime = function (n) {
    this._initialTimeScrollState = this.m_model.timeScale().state();
    this._initialTimeScrollPos = n;
    this.chartModel().startScrollTime(n)
};
J78.prototype.scrollTimeTo = function (n) {
    this._initialTimeScrollPos && 20 < Math.abs(n - this._initialTimeScrollPos) && (this.pushUndoCommand(new J94(this.m_model, this._initialTimeScrollState, "scroll time")), delete this._initialTimeScrollPos, delete this._initialTimeScrollState);
    this.chartModel().scrollTimeTo(n)
};
J78.prototype.endScrollTime = function () {
    this.chartModel().endScrollTime();
    delete this._initialTimeScrollPos;
    delete this._initialTimeScrollState
};
J78.prototype.resetTimeScale = function () {
    this.pushUndoCommand(new J94(this.m_model, this.m_model.timeScale().state()));
    this.chartModel().resetTimeScale()
};
J78.prototype.canZoomIn = function () {
    return this.chartModel().canZoomIn()
};
J78.prototype.canZoomOut = function () {
    return this.chartModel().canZoomOut()
};
J78.prototype.setWidth = function (n) {
    this.m_model.setWidth(n)
};
J78.prototype.setPaneHeight = function (n, t) {
    this.m_model.setPaneHeight(n, t)
};
J78.prototype.gridSource = function () {
    return this.m_model.gridSource()
};
J78.prototype.watermarkSource = function () {
    return this.m_model.watermarkSource()
};
J78.prototype.addAlertsSource = function (n) {
    return this.m_model.addAlertsSource(n)
};
J78.prototype.alertsSources = function () {
    return this.m_model.alertsSources()
};
J78.prototype.publishedChartsTimelineSource = function () {
    return this.m_model.publishedChartsTimelineSource()
};
J78.prototype.barsMarksSources = function () {
    return this.m_model.barsMarksSources()
};
J78.prototype.crossHairSource = function () {
    return this.m_model.crossHairSource()
};
J78.prototype.model = function () {
    return this.m_model
};
J78.prototype.mainSeries = function () {
    return this.m_model.m_mainSeries
};
J78.prototype.panes = function () {
    return this.m_model.m_panes
};
J78.prototype.timeScale = function () {
    return this.m_model.timeScale()
};
J78.prototype.setSelectedSource = function (n, t) {
    this.m_model.setSelectedSource(n, t)
};
J78.prototype.setHoveredSource = function (n, t) {
    this.m_model.setHoveredSource(n, t)
};
J78.prototype.selectedSource = function () {
    return this.m_model.selectedSource()
};
J78.prototype.onSelectedSourceChanged = function () {
    return this.m_model.onSelectedSourceChanged()
};
J78.prototype.hoveredSource = function () {
    return this.m_model.hoveredSource()
};
J78.prototype.Q20 = function (n) {
    this.m_model.Q20(n)
};
J78.prototype.setCurrentPosition = function (n, t, i, r) {
    this.m_model.setCurrentPosition(n, t, i, r)
};
J78.prototype.modifySeries = function (n, t, i) {
    n = new J86(this.m_model, n, t, i);
    this.pushUndoCommand(n);
    n.redo()
};
J78.prototype.insertStudy = function (n, t, i) {
    if (this.model()._chartApi._chartApi.isCanCreateStudy())return n = new InsertStudyCommand(this.m_model, n, t, i), this.pushUndoCommand(n), n.redo();
    D83.showNotice("Error", "Exceeded the limit of studies")
};
J78.prototype.setProperty = function (n, t, i) {
    n && n.value() !== t && (n = new SetPropertyCommand(n, t, i, this.m_model), this.pushUndoCommand(n), n.redo(), this.emitEvent("setProperty"))
};
J78.prototype.setPercentProperty = function (n, t, i, r) {
    n.value() !== t && (n = new SetPercentagePropertyCommand(n, t, i, r, this.m_model), this.pushUndoCommand(n), n.redo())
};
J78.prototype.setLogProperty = function (n, t, i, r) {
    n.value() !== t && (n = new SetLogPropertyCommand(n, t, i, r, this.m_model), this.pushUndoCommand(n), n.redo())
};
J78.prototype.setAutoScaleProperty = function (n, t, i, r) {
    n.value() !== t && (n = new SetAutoScalePropertyCommand(n, t, i, r, this.m_model), this.pushUndoCommand(n), n.redo())
};
J78.prototype.setChartStyleProperty = function (n, t, i) {
    n.value() !== t && (n = new SetChartStyleCommand(n, t, this.mainSeries(), i, this.m_model, this.Q4), this.pushUndoCommand(n), n.redo(), this.emitEvent("setChartStyleProperty"))
};
J78.prototype.setLockScaleProperty = function (n, t, i, r) {
    n.value() !== t && (n = new SetLockScaleCommand(n, t, i, r, this.m_model), this.pushUndoCommand(n), n.redo())
};
J78.prototype.setScreenChartProperty = function (n, t, i, r, u) {
    (u || n.value() !== t) && (n = new J92(r, n, t, i, u), this.pushUndoCommand(n), n.redo())
};
J78.prototype.beginUndoMacro = D77.beginUndoMacro;
J78.prototype.endUndoMacro = D77.endUndoMacro;
J78.prototype.createUndoCheckpoint = D77.createUndoCheckpoint;
J78.prototype.undoToCheckpoint = D77.undoToCheckpoint;
J78.prototype.removeSource = function (n) {
    if (n.isUserDeletable()) {
        var t = new RemoveSourceCommand(this.m_model, n);
        this.pushUndoCommand(t);
        t.redo();
        this.emitEvent("removeSource", [n])
    }
};
J78.prototype.removeSelectedSource = function () {
    var n = this.m_model.selectedSource(), t;
    n && n.isUserDeletable() && (this.setSelectedSource(null), t = new RemoveSourceCommand(this.m_model, n), this.pushUndoCommand(t), t.redo(), this.emitEvent("removeSource", [n]))
};
J78.prototype.move = function (n, t, i) {
    var r = this.m_model.paneForSource(n);
    t = new J88(this.m_model, n, r, t, i);
    this.pushUndoCommand(t);
    t.redo();
    this.emitEvent("moveSource", [n])
};
J78.prototype.createLineTool = function (n, t, i, r) {
    if ("LineToolRegressionTrend" != i || this.model()._chartApi._chartApi.isCanCreateStudy())return i = this.m_model.createLineTool(n, t, i, r), this._createLineCommand = new J83(this.m_model, i, n, t), this.m_model.lineBeingCreated() || (this.pushUndoCommand(this._createLineCommand), delete this._createLineCommand), i;
    D83.showNotice("Error", "Exceeded the limit of studies")
};
J78.prototype.lineBeingCreated = function () {
    return this.m_model.lineBeingCreated()
};
J78.prototype.paneBeingCreatedLineOn = function () {
    return this.m_model.paneBeingCreatedLineOn()
};
J78.prototype.coninueCreatingLine = function (n, t) {
    this.m_model.lineBeingCreated();
    this.m_model.paneBeingCreatedLineOn();
    var i = this.m_model.coninueCreatingLine(n, t);
    return this._createLineCommand.coninueCreatingLine(n, t), i && (this.pushUndoCommand(this._createLineCommand), delete this._createLineCommand), i
};
J78.prototype.cancelCreatingLine = function () {
    this.m_model.cancelCreatingLine()
};
J78.prototype.lineCancelled = function () {
    return this.m_model.lineCancelled()
};
J78.prototype.startChangingLinetool = function (n, t, i, r) {
    this._currentLineChangeCommand = new J80(this.m_model, n, i, r);
    this.m_model.startChangingLinetool(n, t, i, r)
};
J78.prototype.lineBeingEdited = function () {
    return this.m_model.lineBeingEdited()
};
J78.prototype.changeLinePoint = function (n, t) {
    this._currentLineChangeCommand.setPoint(n, t);
    this.m_model.changeLinePoint(n, t)
};
J78.prototype.endChangingLinetool = function () {
    this.m_model.endChangingLinetool();
    this._currentLineChangeCommand.endChanging();
    this.pushUndoCommand(this._currentLineChangeCommand);
    this._currentLineChangeCommand = null
};
J78.prototype.startMovingSource = function (n, t, i) {
    this._currentLineMoveCommand = new J87(this.m_model, n, t, i);
    this.m_model.startMovingSource(n, t, i)
};
J78.prototype.sourceBeingMoved = function () {
    return this.m_model.sourceBeingMoved()
};
J78.prototype.moveSource = function (n) {
    this._currentLineMoveCommand.setPoint(n);
    this.m_model.moveSource(n)
};
J78.prototype.endMovingSource = function () {
    this.m_model.endMovingSource();
    this.pushUndoCommand(this._currentLineMoveCommand);
    this._currentLineChangeCommand = null
};
J78.prototype.Q19 = function () {
    return this.m_model.Q19()
};
J78.prototype.state = function (n) {
    return this.m_model.state(n)
};
J78.prototype.asyncState = function (n) {
    return this.m_model.asyncState(n)
};
J78.prototype.restoreState = function (n, t) {
    this.m_model.restoreState(n, t)
};
J78.prototype.calculateDefaultTags = function () {
    return this.m_model.calculateDefaultTags()
};
J78.prototype.onTagsChanged = function () {
    return this.m_model.onTagsChanged()
};
J78.prototype.changeZOrder = function (n, t) {
    var i = new ChangeZOrderCommand(this.m_model, n, t);
    this.pushUndoCommand(i);
    i.redo();
    this.emitEvent("changeZOrder", [n])
};
J78.prototype.sendToBack = function (n) {
    var t = new SendToBackCommand(this.m_model, n);
    this.pushUndoCommand(t);
    t.redo();
    this.emitEvent("changeZOrder", [n])
};
J78.prototype.bringToFront = function (n) {
    var t = new BringToFrontCommand(this.m_model, n);
    this.pushUndoCommand(t);
    t.redo();
    this.emitEvent("changeZOrder", [n])
};
J78.prototype.removeAllStudies = function () {
    var i, n, t;
    for (this.beginUndoMacro("remove all studies"), i = this.m_model.Q19(), n = 0; n < i.size(); n++)t = i.item(n), isInherited(t.constructor, TradingView.Study) && t.removeByRemoveAllStudies() && this.removeSource(t);
    this.endUndoMacro()
};
J78.prototype.removeAllDrawingTools = function (n) {
    var r, i, t;
    for (this.beginUndoMacro("remove all drawing tools"), r = this.m_model.Q19(), i = 0; i < r.size(); i++)t = r.item(i), isInherited(t.constructor, J47) && t.isActualSymbol() && t.isUserDeletable() && (n && n != t._constructor || this.removeSource(t));
    this.endUndoMacro()
};
J78.prototype.moveDown = function () {
    try {
        this.beginUndoMacro("Move Down")
    } catch (u) {
        return
    }
    var t = this, i = this.m_model.mainSeries(), r = this.m_model.paneForSource(i), n = r.priceScaleForSource(i);
    n.setAutoScale(!1);
    i = n.height();
    TradingView.animate(i / 5, function (i) {
        t.startScrollPrice(r, n, 0);
        t.scrollPriceTo(r, n, i);
        t.endScrollPrice(r, n)
    }, function () {
        t.endUndoMacro()
    })
};
J78.prototype.moveUp = function () {
    try {
        this.beginUndoMacro("Move Up")
    } catch (i) {
        return
    }
    var n = this, t = this.m_model.mainSeries();
    pane = this.m_model.paneForSource(t);
    scale = pane.priceScaleForSource(t);
    scale.setAutoScale(!1);
    t = scale.height();
    TradingView.animate(t / 5, function (t) {
        n.startScrollPrice(pane, scale, t);
        n.scrollPriceTo(pane, scale, 0);
        n.endScrollPrice(pane, scale)
    }, function () {
        n.endUndoMacro()
    })
};
J78.prototype.moveLeft = function () {
    try {
        this.beginUndoMacro("Move Left")
    } catch (i) {
        return
    }
    var t = this.m_model.timeScale().width(), n = this;
    TradingView.animate(t / 5, function (t) {
        n.startScrollTime(t);
        n.scrollTimeTo(0);
        n.endScrollTime()
    }, function () {
        n.endUndoMacro()
    })
};
J78.prototype.moveRight = function () {
    try {
        this.beginUndoMacro("Move Right")
    } catch (i) {
        return
    }
    var t = this.m_model.timeScale().width(), n = this;
    TradingView.animate(t / 5, function (t) {
        n.startScrollTime(0);
        n.scrollTimeTo(t);
        n.endScrollTime()
    }, function () {
        n.endUndoMacro()
    })
};
J78.prototype.scrollChart = function (n) {
    this.startScrollTime(0);
    this.scrollTimeTo(n);
    this.endScrollTime()
};
J78.prototype.zoomIn = function (n, t) {
    var i = this.m_model.timeScale().width(), r = this, u;
    if (t = t || 1, this.canZoomIn())if (n)i = t * i / 10, u = (n + 1) / 2 * i, this.startScaleTime(i), this.scaleTimeTo(0), this.endScaleTime(), this.startScrollTime(0), this.scrollTimeTo(i - u), this.endScrollTime(), this._onSimpleZoomIn.fire(); else {
        try {
            this.beginUndoMacro("Zoom In")
        } catch (f) {
            return
        }
        TradingView.animate(i / 5, function (n) {
            r.startScaleTime(n);
            r.scaleTimeTo(0);
            r.endScaleTime()
        }, function () {
            r.endUndoMacro();
            r._onSimpleZoomIn.fire()
        })
    }
};
J78.prototype.zoomOut = function (n, t) {
    var r = this.m_model.timeScale().width(), i = this;
    if (t = t || 1, this.canZoomOut())if (n)this.startScaleTime(0), this.scaleTimeTo(t * r / 10), this.endScaleTime(), this.startScrollTime(t * (r / 20 - r / 20 * n)), this.scrollTimeTo(0), this.endScrollTime(), this._onSimpleZoomOut.fire(); else {
        try {
            this.beginUndoMacro("Zoom Out")
        } catch (u) {
            return
        }
        TradingView.animate(r / 5, function (n) {
            i.startScaleTime(0);
            i.scaleTimeTo(n);
            i.endScaleTime()
        }, function () {
            i.endUndoMacro();
            i._onSimpleZoomOut.fire()
        })
    }
};
J78.prototype.resetScales = function () {
    var t, n;
    for (this.beginUndoMacro("Reset scales"), this.resetTimeScale(), t = 0; t < this.panes().size(); t++)n = this.panes().item(t), this.resetPriceScale(n, n.leftPriceScale()), this.resetPriceScale(n, n.rightPriceScale());
    this.endUndoMacro();
    this.m_model.recalculateAllPanes()
};
J78.prototype.zoomToViewport = function (n, t, i, r, u) {
    n = new ZoomCommand(this.m_model, n, t, i, r, u);
    n = new J95(n, this.m_zoomStack, !0);
    n.redo();
    this.pushUndoCommand(n)
};
J78.prototype.zoomFromViewport = function () {
    var n = new J95(this.m_zoomStack.head(), this.m_zoomStack, !1);
    n.redo();
    this.pushUndoCommand(n)
};
J78.prototype.zoomStack = function () {
    return this.m_zoomStack
};
J78.prototype.addPaneStretchFactorUndoCommand = function (n, t, i, r) {
    n = new J91(this.m_model, n, t, i, r);
    this.pushUndoCommand(n)
};
J78.prototype.restoreFactoryDefaults = function (n) {
    n = new J90(this.m_model, n);
    n.redo();
    this.pushUndoCommand(n)
};
J78.prototype.chartLoadTheme = function (n, t) {
    var i = new J81(n, t);
    i.redo();
    this.pushUndoCommand(i)
};
J78.prototype.drawingLoadTemplate = function (n, t) {
    var i = new J84(n, t);
    i.redo();
    this.pushUndoCommand(i)
};
J78.prototype.studyLoadTemplate = function (n, t, i, r) {
    n = new J93(n, t, i, r);
    n.redo();
    this.pushUndoCommand(n)
};
J78.prototype.onSimpleZoomIn = function () {
    return this._onSimpleZoomIn
};
J78.prototype.onSimpleZoomOut = function () {
    return this._onSimpleZoomOut
};
J78.prototype.loadRange = function (n) {
    n.res !== this.m_model.mainSeries().properties().interval.value() ? (this.m_model.mainSeries()._pendingInterval = n.val, this.setProperty(this.m_model.mainSeries().properties().interval, n.res, "Change date range")) : this.m_model.mainSeries().loadDataTo(n.val)
};
J78.prototype.cloneLineTool = function (n) {
    n = new J82(this.m_model, n);
    n.redo();
    this.pushUndoCommand(n);
    this.emitEvent("cloneLineTool")
};
J78.prototype._preparePriceAxisProperties = function (n, t) {
    var i = n.lockScale.value(), r = n.style.value() == TradingView.Series.STYLE_PNF;
    (r || i) && (t.log.setValue(!1), t.percentage.setValue(!1));
    t.logDisabled.setValue(!(!r && !i));
    t.percentageDisabled.setValue(!(!r && !i))
};
J78.prototype.alertsList = function () {
    return this.m_model.alertsList()
};
J78.prototype.alertsListChanged = function () {
    return this.m_model.alertsListChanged()
};
UndoCommand.prototype.text = function () {
    return this._text
};
UndoCommand.prototype.undo = function () {
    throw"pure virtual call ;)";
};
UndoCommand.prototype.redo = function () {
    throw"pure virtual call ;)";
};
UndoStack.prototype.onChange = function () {
    return this._onChange
};
UndoStack.prototype.isEmpty = function () {
    return this.m_commands.isEmpty()
};
UndoStack.prototype.clear = function () {
    this.m_commands.clear();
    this._onChange.fire()
};
UndoStack.prototype.push = function (n) {
    this.m_commands.append(n);
    this._onChange.fire()
};
UndoStack.prototype.pop = function () {
    if (this.m_commands.isEmpty())TradingView.logDebug("UndoStack.pop: undo stack is empty"); else {
        var n = this.m_commands.item(this.m_commands.size() - 1);
        return this.m_commands.removeAt(this.m_commands.size() - 1), this._onChange.fire(), n
    }
};
UndoStack.prototype.head = function () {
    if (this.m_commands.isEmpty())TradingView.logDebug("UndoStack.head: undo stack is empty"); else return this.m_commands.item(this.m_commands.size() - 1)
};
inherit(UndoMacroCommand, UndoCommand);
UndoMacroCommand.prototype.addCommand = function (n) {
    this._subcommands.append(n)
};
UndoMacroCommand.prototype.isEmpty = function () {
    return this._subcommands.isEmpty()
};
UndoMacroCommand.prototype.redo = function () {
    for (var n = 0; n < this._subcommands.size(); n++)this._subcommands.item(n).redo()
};
UndoMacroCommand.prototype.undo = function () {
    for (var n = this._subcommands.size() - 1; 0 <= n; n--)this._subcommands.item(n).undo()
};
inherit(SetPropertyCommand, UndoCommand);
SetPropertyCommand.prototype.redo = function () {
    this._oldValue = this._targetObj.value();
    TradingView.saveDefaultProperties(!0);
    this._targetObj.setValue(this._newValue);
    TradingView.saveDefaultProperties(!1);
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
SetPropertyCommand.prototype.undo = function () {
    TradingView.saveDefaultProperties(!0);
    this._targetObj.setValue(this._oldValue);
    TradingView.saveDefaultProperties(!1);
    this._oldValue = null;
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
inherit(SetAutoScalePropertyCommand, UndoCommand);
SetAutoScalePropertyCommand.prototype.redo = function () {
    this._oldValue = this._property.value();
    this._oldLockScaleValue = this._priceScale.mainSource()instanceof TradingView.Series ? this._priceScale.mainSource().properties().lockScale.value() : void 0;
    TradingView.saveDefaultProperties(!0);
    this._property.setValue(this._newValue);
    this._oldLockScaleValue && this._newValue && this._priceScale.mainSource().properties().lockScale.setValue(!1);
    TradingView.saveDefaultProperties(!1);
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
SetAutoScalePropertyCommand.prototype.undo = function () {
    TradingView.saveDefaultProperties(!0);
    this._property.setValue(this._oldValue);
    this._oldLockScaleValue && this._newValue && this._priceScale.mainSource().properties().lockScale.setValue(this._oldLockScaleValue);
    TradingView.saveDefaultProperties(!1);
    this._oldValue = null;
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
inherit(SetPercentagePropertyCommand, UndoCommand);
SetPercentagePropertyCommand.prototype.redo = function () {
    this._oldValue = this._percentage.value();
    this._oldAutoScaleValue = this._priceScale.properties().autoScale.value();
    this._oldLogValue = this._priceScale.properties().log.value();
    this._oldLogDisabled = this._priceScale.properties().logDisabled.value();
    TradingView.saveDefaultProperties(!0);
    this._percentage.setValue(this._newValue);
    this._priceScale.properties().autoScaleDisabled.setValue(this._newValue);
    this._priceScale.properties().log.setValue(!1);
    TradingView.saveDefaultProperties(!1);
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
SetPercentagePropertyCommand.prototype.undo = function () {
    if (TradingView.saveDefaultProperties(!0), this._percentage.setValue(this._oldValue), this._priceScale.properties().autoScale.setValue(this._oldAutoScaleValue), this._priceScale.properties().autoScaleDisabled.setValue(this._oldValue), this._priceScale.properties().log.setValue(this._oldLogValue), !(this._oldAutoScaleValue || this._priceScale.mainSource()instanceof TradingView.Series && this._priceScale.mainSource().isLockScale())) {
        var n = this.Q0.timeScale().visibleBars();
        this._priceScale.setPriceRange(this._priceScale.priceRange().convertFromPercents(this._priceScale.mainSource().close(n.firstBar())))
    }
    TradingView.saveDefaultProperties(!1);
    this._oldValue = null;
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
inherit(SetLogPropertyCommand, UndoCommand);
SetLogPropertyCommand.prototype.redo = function () {
    this._oldValue = this._log.value();
    this._oldPercValue = this._priceScale.properties().percentage.value();
    this._oldPercDisabled = this._priceScale.properties().percentageDisabled.value();
    TradingView.saveDefaultProperties(!0);
    this._log.setValue(this._newValue);
    this._priceScale.properties().percentage.setValue(!1);
    this._priceScale.properties().autoScaleDisabled.setValue(this._priceScale.properties().percentage.value());
    TradingView.saveDefaultProperties(!1);
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
SetLogPropertyCommand.prototype.undo = function () {
    TradingView.saveDefaultProperties(!0);
    this._log.setValue(this._oldValue);
    this._priceScale.properties().percentage.setValue(this._oldPercValue);
    TradingView.saveDefaultProperties(!1);
    this._oldValue = null;
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
inherit(SetChartStyleCommand, UndoCommand);
SetChartStyleCommand.prototype.redo = function () {
    var n = $.Deferred().resolve();
    this._mainSeries.Q2.style === this._style && this.Q0.mainSeries().isNeedRestart(this._newValue) && (n = this.Q4.screen.show());
    n.done(function () {
        this._oldValue = this._style.value();
        this._oldAutoScale = this._priceAxisProperties.autoScale.value();
        this._oldLogValue = this._priceAxisProperties.log.value();
        this._oldLogDisabled = this._priceAxisProperties.logDisabled.value();
        this._oldPercentageValue = this._priceAxisProperties.percentage.value();
        this._oldPercentageDisabled = this._priceAxisProperties.percentageDisabled.value();
        TradingView.saveDefaultProperties(!0);
        this._style.setValue(this._newValue);
        this.Q4.model()._preparePriceAxisProperties(this._mainSeries.properties(), this._priceAxisProperties);
        TradingView.saveDefaultProperties(!1);
        this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
    }.bind(this))
};
SetChartStyleCommand.prototype.undo = function () {
    var n = $.Deferred().resolve();
    this._mainSeries.Q2.style === this._style && this.Q0.mainSeries().isNeedRestart(this._newValue) && (n = this.Q4.screen.show());
    n.done(function () {
        TradingView.saveDefaultProperties(!0);
        this._style.setValue(this._oldValue);
        this._priceAxisProperties.log.setValue(this._oldLogValue);
        this._priceAxisProperties.logDisabled.setValue(this._oldLogDisabled);
        this._priceAxisProperties.percentage.setValue(this._oldPercentageValue);
        this._priceAxisProperties.percentageDisabled.setValue(this._oldPercentageDisabled);
        this._priceAxisProperties.autoScale.setValue(this._oldAutoScale);
        TradingView.saveDefaultProperties(!1);
        this._oldValue = null;
        this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
    }.bind(this))
};
inherit(SetLockScaleCommand, UndoCommand);
SetLockScaleCommand.prototype.redo = function () {
    this._oldValue = this._property.value();
    this._oldAutoScale = this._priceAxisProperties.autoScale.value();
    this._oldPercentage = this._priceAxisProperties.percentage.value();
    this._oldLog = this._priceAxisProperties.log.value();
    TradingView.saveDefaultProperties(!0);
    this._newValue && (this._priceAxisProperties.percentage.setValue(!1), this._priceAxisProperties.log.setValue(!1), this._priceAxisProperties.autoScale.setValue(!1));
    var n = this._mainSeries.properties().style.value();
    n !== TradingView.Series.STYLE_RENKO && n !== TradingView.Series.STYLE_KAGI && n !== TradingView.Series.STYLE_PNF && n !== TradingView.Series.STYLE_PB && this._mainSeries.fixBoxSize();
    this._property.setValue(this._newValue);
    TradingView.saveDefaultProperties(!1);
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
SetLockScaleCommand.prototype.undo = function () {
    TradingView.saveDefaultProperties(!0);
    this._priceAxisProperties.percentage.setValue(this._oldPercentage);
    this._priceAxisProperties.log.setValue(this._oldLog);
    this._priceAxisProperties.autoScale.setValue(this._oldAutoScale);
    this._property.setValue(this._oldValue);
    TradingView.saveDefaultProperties(!1);
    this._oldValue = null;
    this.Q0 && (this.Q0.recalculateAllPanes(), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)))
};
J89 = function (n, t, i, r) {
    this.m_model = n;
    this.m_pane = t;
    this.m_priceScale = i;
    this.m_state = r;
    this.m_newPriceScaleState = null
};
inherit(J89, UndoCommand);
J89.prototype.undo = function () {
    null !== this.m_newPriceScaleState ? TradingView.logDebug("J89.undo: Command is already undone") : (this.m_newPriceScaleState = this.m_priceScale.state(), this.m_model.restorePriceScaleState(this.m_pane, this.m_priceScale, this.m_state), this.m_priceScale.recalcLockedScale(null))
};
J89.prototype.redo = function () {
    null === this.m_newPriceScaleState ? TradingView.logDebug("J89.redo: Command is not undone") : (this.m_model.restorePriceScaleState(this.m_pane, this.m_priceScale, this.m_newPriceScaleState), this.m_newPriceScaleState = null)
};
J94 = function (n, t, i) {
    UndoCommand.call(this, i);
    this.m_model = n;
    this.m_state = t;
    this.m_newTimeScaleState = null
};
inherit(J94, UndoCommand);
J94.prototype.undo = function () {
    null !== this.m_newTimeScaleState ? TradingView.logDebug("J94.undo: Command is already undone") : (this.m_newTimeScaleState = this.m_model.timeScale().state(), this.m_model.restoreTimeScaleState(this.m_state), this.m_model.timeScale().recalcLockedScale())
};
J94.prototype.redo = function () {
    null === this.m_newTimeScaleState ? TradingView.logDebug("J94.redo: Command is not undone") : (this.m_model.restoreTimeScaleState(this.m_newTimeScaleState), this.m_newTimeScaleState = null)
};
J86 = function (n, t, i, r) {
    this.Q0 = n;
    this._series = t;
    this._oldSymbol = t.symbol();
    this._oldInterval = t.interval();
    this._symbol = i;
    this._interval = r
};
inherit(J86, UndoCommand);
J86.prototype.redo = function () {
    this.Q0.modifySeries(this._series, this._symbol, this._interval)
};
J86.prototype.undo = function () {
    this.Q0.modifySeries(this._series, this._oldSymbol, this._oldInterval)
};
InsertStudyCommand = function (n, t, i, r) {
    UndoCommand.call(this, "Insert " + t.id);
    this.Q0 = n;
    this._studyMetaInfo = t;
    this._props = i;
    this._isOverlay = r
};
inherit(InsertStudyCommand, UndoCommand);
InsertStudyCommand.prototype.redo = function () {
    return this.Q1 = this.Q0.insertStudy(this._studyMetaInfo, this._props, this._isOverlay)
};
InsertStudyCommand.prototype.undo = function () {
    this.Q0.removeSource(this.Q1)
};
inherit(RemoveSourceCommand, UndoCommand);
RemoveSourceCommand.prototype.redo = function () {
    var i = this.Q0.paneForSource(this.J99), r, t, n;
    for (this._paneIndex = this.Q0.panes().indexOf(i), this._priceScaleName = i.priceScaleName(this.J99.priceScale()), r = this.Q0.children(this.J99), this._removeChildUndoCommands = new List, t = 0; t < r.size(); t++)n = r.item(t), n = new RemoveSourceCommand(this.Q0, n), this._removeChildUndoCommands.append(n), n.redo();
    this._paneState = i.state();
    this._restorePane = this.Q0.removeSource(this.J99);
    this.Q0.recalculateAllPanes();
    this.Q0.Q20(new D22(D22.FULL_UPDATE, !0))
};
RemoveSourceCommand.prototype.undo = function () {
    var n, t;
    for (n = this._restorePane ? this.Q0.createPane(this._paneIndex) : this.Q0.panes().item(this._paneIndex), t = this.J99.ownerSource() ? this.J99.ownerSource().priceScale() : n.priceScaleByName(this._priceScaleName), n.addDataSource(this.J99, t), this.J99.start(), this.J99.restore && this.J99.restore(), this._restorePane && n.restoreState(this._paneState), n = this._removeChildUndoCommands.size() - 1; 0 <= n; n--)this._removeChildUndoCommands.item(n).undo();
    this._removeChildUndoCommands.clear();
    this.Q0.recalculateAllPanes();
    this.Q0.Q20(new D22(D22.FULL_UPDATE, !0))
};
inherit(J88, UndoCommand);
J88.prototype.redo = function () {
    this.Q0.move(this.J99, this._pane, this._scale)
};
J88.prototype.undo = function () {
    var i = !1, t, n;
    if (this._samePane)this._oldPane.restoreState(this._oldPaneState); else {
        for (n = 0; n < this._sources.size(); n++)this.Q0.detachSource(this._sources.item(n));
        if (this.Q0.panes().contains(this._oldPane)) {
            for (t = this._oldPane.priceScaleByName(this._oldScaleName), n = 0; n < this._sources.size(); n++)this._oldPane.addDataSource(this._sources.item(n), t);
            this._oldPane.restoreState(this._oldPaneState)
        } else {
            for (this._oldPane = this.Q0.createPane(this._oldPaneIndex), t = this._oldPane.priceScaleByName(this._oldScaleName), n = 0; n < this._sources.size(); n++)this._oldPane.addDataSource(this._sources.item(n), t);
            i = !0
        }
    }
    this.Q0.recalculateAllPanes();
    i && this.Q0.Q20(new D22(D7.FULL_UPDATE))
};
inherit(J83, UndoCommand);
J83.prototype.coninueCreatingLine = function (n, t) {
    this._points.append({point: n, envState: t})
};
J83.prototype.undo = function () {
    this.Q0.removeSource(this._line)
};
J83.prototype.redo = function () {
    var n = this.Q0.panes().item(this._paneIndex);
    for (this._line = this.Q0.createLineTool(n, this._points.item(0).point, this._line.toolname), n = 1; n < this._points.size(); n++)this.Q0.coninueCreatingLine(this._points.item(n).point, this._points.item(n).envState)
};
inherit(J80, UndoCommand);
J80.prototype.setPoint = function () {
    this._nextState = this.J99.state(!0)
};
J80.prototype.endChanging = function () {
    this._nextState = this.J99.state(!0)
};
J80.prototype.undo = function () {
    var n = this.J99, t = this._prevState;
    n.restorePoints(t.points, t.indexes || []);
    n.properties().merge(t.state);
    n.restoreData && n.restoreData(t);
    n.createServerPoints();
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
J80.prototype.redo = function () {
    var n = this.J99, t = this._nextState;
    n.restorePoints(t.points, t.indexes || []);
    n.properties().merge(t.state);
    n.restoreData && n.restoreData(t);
    n.createServerPoints();
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
inherit(J87, UndoCommand);
J87.prototype.setPoint = function (n) {
    this._point = n instanceof MathEx.Point ? n.clone() : TradingView.clone(n)
};
J87.prototype.undo = function () {
    this.Q0.startMovingSource(this.J99, this._point, this._pointIndex);
    this.Q0.moveSource(this._origPoint);
    this.Q0.endMovingSource()
};
J87.prototype.redo = function () {
    this.Q0.startMovingSource(this.J99, this._origPoint, this._pointIndex);
    this.Q0.moveSource(this._point);
    this.Q0.endMovingSource()
};
inherit(ChangeZOrderCommand, UndoCommand);
ChangeZOrderCommand.prototype.undo = function () {
    this.Q0.changeZOrder(this.J99, -this._shift)
};
ChangeZOrderCommand.prototype.redo = function () {
    this.Q0.changeZOrder(this.J99, this._shift)
};
inherit(SendToBackCommand, UndoCommand);
SendToBackCommand.prototype.undo = function () {
    this.Q0.bringToFront(this.J99)
};
SendToBackCommand.prototype.redo = function () {
    this.Q0.sendToBack(this.J99)
};
inherit(BringToFrontCommand, UndoCommand);
BringToFrontCommand.prototype.undo = function () {
    this.Q0.sendToBack(this.J99)
};
BringToFrontCommand.prototype.redo = function () {
    this.Q0.bringToFront(this.J99)
};
J78.prototype.removePane = function (n, t) {
    var i = new RemovePaneCommand(this, t, n);
    this.pushUndoCommand(i);
    i.redo()
};
inherit(RemovePaneCommand, UndoCommand);
RemovePaneCommand.prototype.redo = function () {
    this.Q0.panes().removeAt(this._index);
    this._chart._updateGui()
};
RemovePaneCommand.prototype.undo = function () {
    this.Q0.panes().insert(this._pane, this._index);
    this._chart._updateGui()
};
J78.prototype.rearrangePanes = function (n, t, i) {
    n = new RearrangePanesCommand(this, t, i, n);
    this.pushUndoCommand(n);
    n.redo()
};
inherit(RearrangePanesCommand, UndoCommand);
RearrangePanesCommand.prototype.redo = function () {
    var n = this.Q0.panes().item(this._index);
    "up" === this._direction && 0 < this._index && (this.Q0.panes().removeAt(this._index), this.Q0.panes().insert(n, this._index - 1));
    "down" === this._direction && this._index < this.Q0.panes().size() - 1 && (this.Q0.panes().removeAt(this._index), this.Q0.panes().insert(n, this._index + 1));
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
RearrangePanesCommand.prototype.undo = function () {
    if ("up" === this._direction) {
        var n = this.Q0.panes().item(this._index - 1);
        this.Q0.panes().removeAt(this._index - 1);
        this.Q0.panes().insert(n, this._index)
    }
    "down" === this._direction && (n = this.Q0.panes().item(this._index + 1), this.Q0.panes().removeAt(this._index + 1), this.Q0.panes().insert(n, this._index));
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
inherit(ZoomCommand, UndoCommand);
ZoomCommand.prototype.redo = function () {
    this._timeScaleState = this.Q0.timeScale().state();
    this._priceScaleState = this._pane.defaultPriceScale().state();
    this.Q0.zoomToViewport(this._startBar, this._endBar, this._startPrice, this._endPrice, this._pane)
};
ZoomCommand.prototype.undo = function () {
    this.Q0.timeScale().restoreState(this._timeScaleState);
    this._pane.defaultPriceScale().restoreState(this._priceScaleState);
    this.Q0.recalculateAllPanes();
    this.Q0.Q20(new D22(D22.LIGHT_UPDATE))
};
inherit(J95, UndoCommand);
J95.prototype.undo = function () {
    this._inOut ? this._baseCmd !== this._zoomStack.head() ? TradingView.logDebug("zoom stack inconsistency") : (this._baseCmd.undo(), this._zoomStack.pop()) : (this._baseCmd.redo(), this._zoomStack.push(this._baseCmd))
};
J95.prototype.redo = function () {
    this._inOut ? (this._baseCmd.redo(), this._zoomStack.push(this._baseCmd)) : this._baseCmd !== this._zoomStack.head() ? TradingView.logDebug("zoom stack inconsistency") : (this._baseCmd.undo(), this._zoomStack.pop())
};
inherit(J91, UndoCommand);
J91.prototype.redo = function () {
    var n = this._paneA._stretchFactor + this._paneB._stretchFactor;
    this._paneA._stretchFactor = this._currStretchA;
    this._paneB._stretchFactor = n - this._currStretchA;
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
J91.prototype.undo = function () {
    var n = this._paneA._stretchFactor + this._paneB._stretchFactor;
    this._paneA._stretchFactor = this._prevStretchA;
    this._paneB._stretchFactor = n - this._prevStretchA;
    this.Q0.Q20(new D22(D22.FULL_UPDATE))
};
inherit(J90, UndoCommand);
J90.prototype.redo = function () {
    this.Q0.restoreFactoryDefaults(this._defaultProperty)
};
J90.prototype.undo = function () {
    this._defaultProperty.merge(this._state);
    this._defaultProperty.listeners().fire(this._defaultProperty);
    this.Q0.mainSeries().onChartStyleChanged()
};
inherit(J81, UndoCommand);
J81.prototype._merge = function (n, t) {
    var i = this.Q0;
    TradingView.saveDefaultProperties(!0);
    n && (i.properties().paneProperties.merge(n.paneProperties), i.properties().scalesProperties.merge(n.scalesProperties), i.properties().symbolWatermarkProperties.merge(n.symbolWatermarkProperties));
    i.mainSeries().properties().merge(t);
    i.mainSeries().properties().saveDefaults();
    i.mainSeries()._63();
    i._version = t.version;
    i.recalculateAllPanes();
    i.Q20(new D22(D22.FULL_UPDATE));
    i.properties().saveDefaults();
    i.properties().listeners().fire(this.Q2);
    TradingView.saveDefaultProperties(!1)
};
J81.prototype.undo = function () {
    this._merge(this._oldChartProps, this._oldSeriesProps);
    this.Q0.mainSeries().onChartStyleChanged()
};
J81.prototype.redo = function () {
    this._merge(this._newChartProps, this._newSeriesProps);
    this.Q0.mainSeries().onChartStyleChanged()
};
inherit(J84, UndoCommand);
J84.prototype._merge = function (n) {
    var t = this.J99;
    t.properties().merge(n);
    t.properties().saveDefaults();
    t.updateAllViews();
    t.Q0.Q20(new D22(D22.LIGHT_UPDATE))
};
J84.prototype.undo = function () {
    this._merge(this._oldProps)
};
J84.prototype.redo = function () {
    this._merge(this._newProps)
};
inherit(J93, UndoCommand);
J93.prototype._merge = function (n) {
    var u = this.Q0.model(), h = u.mainSeries(), t, s;
    h.properties().lockScale.setValue(!1);
    n.interval && h.properties().interval.setValue(n.interval);
    for (var f = [], c = u.panes(), r = c.size(); r--;)for (var i = c.item(r), e = i.containsMainSeries(), o = i.Q19(), i = o.size(); i--;)t = o.item(i), (!e || t instanceof TradingView.Study || t instanceof TradingView.AlertLabel) && (t.isRemovedByStudyTemplates() || f.push(t), u.removeSource(t));
    for (e = n.panes, r = 0; r < e.length; r++) {
        for (var o = !1, l = e[r], i = 0; i < l.sources.length; i++)t = l.sources[i], "MainSeries" === t.type && (delete t.state, o = !0);
        if (i = null, i = o ? c.item(r) : u.createPane(r), i.restoreState(e[r], !1, n.version), o)for (t = 0; t < f.length; t++)f[t].restore && f[t].restore(), s = f[t], s instanceof TradingView.AlertLabel && !i.Q19().find(function (n) {
            return n.alert && n.alert().id() === s.alert.id()
        }) || i.Q19().append(s);
        i.updateAlertLabelsSources()
    }
    h.priceScale().setAutoScale(!0);
    u._version = n.version;
    u.startNotStartedStudies();
    u.recalculateAllPanes();
    u.Q20(new D22(D22.FULL_UPDATE))
};
J93.prototype.undo = function () {
    this._merge(this._oldProps);
    this.Q0.model().mainSeries().onChartStyleChanged()
};
J93.prototype.redo = function () {
    this._merge(this._newProps);
    this.Q0.model().mainSeries().onChartStyleChanged();
    var n = this.Q0.model().mainSeries().properties(), t = this.Q0.model().mainSeries().properties().priceAxisProperties;
    this.Q0._preparePriceAxisProperties(n, t)
};
inherit(SetPriceScaleMarginsCommand, UndoCommand);
SetPriceScaleMarginsCommand.prototype.redo = function () {
    this._priceScale.setTopMargin(this._topMargin);
    this._priceScale.setBottomMargin(this._bottomMargin);
    this.Q0.recalculatePane(this._pane, !1)
};
SetPriceScaleMarginsCommand.prototype.undo = function () {
    this._priceScale.setTopMargin(this._oldTopMargin);
    this._priceScale.setBottomMargin(this._oldBottomMargin);
    this.Q0.recalculatePane(this._pane, !1)
};
inherit(J85, UndoCommand);
J85.prototype.redo = function () {
    this.Q0.mainSeries().loadDataTo(this._range)
};
inherit(J92, UndoCommand);
J92.prototype.redo = function () {
    this._cw.screen.show().done(function () {
        this._property.setValue(this._value, this._forceSetProperty)
    }.bind(this))
};
J92.prototype.undo = function () {
    this._cw.screen.show().done(function () {
        this._property.setValue(this._prevValue, this._forceSetProperty)
    }.bind(this))
};
inherit(J82, UndoCommand);
J82.prototype.redo = function () {
    var n, f, u, e, s, i;
    if (this.J99) {
        var t = this.J99, r = t.priceScale(), o = this.Q0.paneForSource(t), u = TradingView.className(t.constructor);
        for (this._line = new TradingView[u](this.Q0, new _52(u.toLowerCase(), t.properties().state())), this._line.setOwnerSource(t.ownerSource()), this._line.properties().visible._value = !0, this._line._fixedPoints.appendAll(t._fixedPoints), n = 0; n < this._line._fixedPoints.size(); n++)this._line._fixedPoints.setItem(n, this._line._fixedPoints.item(n).add(new MathEx.Point(20, 20)));
        for (f = t._timePoint.toArray(), u = [], r.isPercent() && (e = t.ownerSource().firstValue()), n = 0; n < f.length; n++)s = {offset: f[n].offset, time_t: f[n].time_t}, i = f[n].price, r.isPercent() && (i = r.priceRange().convertToPercent(i, e)), i = r.priceToCoordinate(i), i -= 40, i = r.coordinateToPrice(i), r.isPercent() && (i = r.priceRange().convertFromPercent(i, e)), s.price = i, u.push(s);
        e = t._points.toArray();
        this._line.restorePoints(u, e);
        this._line.cloneData && this._line.cloneData(t);
        o.addDataSource(this._line, r);
        this.Q0.updateSource(this._line);
        this._line.checkAlert && this._line.checkAlert();
        this._points = this._line.points();
        this._paneIndex = this.Q0.panes().indexOf(o);
        this._toolname = t._constructor;
        delete this.J99
    } else for (o = this.Q0.panes().item(this._paneIndex), this._line = this.Q0.createLineTool(o, this._points.item(0), this._toolname), n = 1; n < this._points.size(); n++)this.Q0.coninueCreatingLine(this._points.item(n))
};
J82.prototype.undo = function () {
    this.Q0.removeSource(this._line);
    this.Q0.Q20(new D22(D22.LIGHT_UPDATE, !0))
};
D77.setWatchedValue = function (n, t, i) {
    n.value() !== t && (n = new SetWatchedValueCommand(n, t, i), this.pushUndoCommand(n), n.redo())
};
inherit(SetWatchedValueCommand, UndoCommand);
SetWatchedValueCommand.prototype.redo = function () {
    this._wv.setValue(this._newValue)
};
SetWatchedValueCommand.prototype.undo = function () {
    this._wv.setValue(this._oldValue)
};
J79.prototype.currentTool = function () {
    return this._currentTool
};
J79.prototype.setCurrentTool = function (n) {
    this._currentTool = n
};
J79.prototype.timezone = function () {
    return this.Q2.timezone.value()
};
J79.prototype.version = function () {
    return this._version
};
J79.prototype.initConnection = function () {
    this._chartApi.switchTimezone(this.timezone())
};
J79.prototype.dumpViews = function () {
    for (var i, r, t = {panes: []}, n = 0; n < this.m_panes.size(); n++)t.panes.push(this.m_panes.item(n).dumpViews());
    for (t.dataWindow = [], i = this.Q19(), n = 0; n < i.size(); n++)r = i.item(n).dataWindowView(), r && t.dataWindow.push(r.dump());
    return t
};
J79.prototype._paneInvalidationMask = function (n, t) {
    var i = new D22, r = this.m_panes.indexOf(n);
    return void 0 === t && (t = D22.LIGHT_UPDATE), i.invalidatePane(r, t), i
};
J79.prototype.updatePane = function (n) {
    n = this._paneInvalidationMask(n);
    this.Q20(n)
};
J79.prototype.fullUpdate = function () {
    this.Q20(new D22(D22.FULL_UPDATE))
};
J79.prototype.updateSource = function (n) {
    n = this.paneForSource(n);
    n = this._paneInvalidationMask(n);
    this.Q20(n)
};
J79.prototype.studiesMetaData = function () {
    return this._studiesMetaData
};
J79.prototype.studyVersioning = function () {
    return this._studyVersioning
};
J79.prototype.disconnect = function () {
    for (var t = this.Q19(), n = 0; n < t.size(); n++)t.item(n).disconnect && t.item(n).disconnect()
};
J79.prototype.restart = function () {
    this.initConnection();
    this.m_timeScale.reset();
    this.m_mainSeries.restart();
    for (var t = this.Q19(), n = 0; n < t.size(); n++)t.item(n).restart && t.item(n) !== this.m_mainSeries && t.item(n).restart()
};
J79.prototype.startNotStartedStudies = function () {
    if (!this.m_mainSeries.isStarted())throw Error("Cannot start studies: main series is not started");
    for (var t = this.Q19(), n = 0; n < t.size(); n++)t.item(n)instanceof TradingView.Study && !t.item(n).isStarted() && t.item(n).restart && t.item(n) !== this.m_mainSeries && t.item(n).restart()
};
J79.prototype.updateLineTools = function () {
    for (var i, t = this.Q19(), n = 0; n < t.size(); n++)isInherited(t.item(n).constructor, J47) && (i = t.item(n), i.tryCreateServerPoints(), i.checkAlert && i.checkAlert())
};
J79.prototype.realignLineTools = function () {
    for (var t = this.Q19(), n = 0; n < t.size(); n++)isInherited(t.item(n).constructor, J47) && t.item(n).calcIsActualSymbol();
    for (n = 0; n < this.panes().size(); n++)this.panes().item(n).invalidateSourcesCache()
};
J79.prototype.readOnly = function () {
    return this._readOnly
};
J79.prototype.properties = function () {
    return this.Q2
};
J79.prototype.lineCancelled = function () {
    return this._lineCancelled
};
J79.prototype.chartApi = function () {
    return this._chartApi
};
J79.prototype.propertyChangeHandler = function () {
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.visibilityChangeHandler = function () {
    this.setSelectedSource();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.updateAllPaneViews = function () {
    for (var n = 0; n < this.panes().size(); n++)this.panes().item(n).updateAllViews()
};
J79.prototype.mainSeries = function () {
    return this.m_mainSeries
};
J79.prototype.timeScale = function () {
    return this.m_timeScale
};
J79.prototype.panes = function () {
    return this.m_panes
};
J79.prototype.gridSource = function () {
    return this.m_gridSource
};
J79.prototype.watermarkSource = function () {
    return this.m_watermarkSource
};
J79.prototype.crossHairSource = function () {
    return this.m_crossHairSource
};
J79.prototype.publishedChartsTimelineSource = function () {
    for (var n = 0; n < this._barsMarksSources.length; ++n)if (this._barsMarksSources[n]instanceof PublishedChartsTimeline)return this._barsMarksSources[n]
};
J79.prototype.barsMarksSources = function () {
    return this._barsMarksSources
};
J79.prototype.width = function () {
    return this.m_width
};
J79.prototype.setPaneHeight = function (n, t) {
    n.setHeight(t);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.setWidth = function (n) {
    this.m_width = n;
    this.m_timeScale.setWidth(this.m_width);
    for (var t = 0; t < this.m_panes.size(); ++t)this.m_panes.item(t).setWidth(n);
    this.recalculateAllPanes()
};
J79.prototype.createPane = function (n, t, i) {
    var r = this.Q2.paneProperties;
    if (i && r.merge(i), t = new J75(this.m_timeScale, r, this, t), void 0 !== n) {
        if (0 > n || n > this.m_panes.size()) {
            TradingView.logDebug("J79.createPane: invalid index: " + n);
            return
        }
        this.m_panes.insert(t, n)
    } else this.m_panes.append(t);
    return t.onTagsChanged().subscribe(this, J79.prototype.onPaneTagsChanged), t
};
J79.prototype.removePane = function (n) {
    n.destroy();
    this.m_panes.remove(n);
    this.Q20(new D22(D22.FULL_UPDATE))
};
J79.prototype.startScalePrice = function (n, t, i) {
    n.startScalePrice(t, i)
};
J79.prototype.scalePriceTo = function (n, t, i) {
    n.scalePriceTo(t, i);
    this.mainSeries().properties().lockScale.value() ? this.Q20(new D22(D22.LIGHT_UPDATE)) : this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.endScalePrice = function (n, t) {
    n.endScalePrice(t);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.startScrollPrice = function (n, t, i) {
    n.startScrollPrice(t, i)
};
J79.prototype.scrollPriceTo = function (n, t, i) {
    n.scrollPriceTo(t, i);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.endScrollPrice = function (n, t) {
    n.endScrollPrice(t);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.setPriceAutoScale = function (n, t, i) {
    n.setPriceAutoScale(t, i);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.restorePriceScaleState = function (n, t, i) {
    n.restorePriceScaleState(t, i);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.resetPriceScale = function (n, t) {
    n.resetPriceScale(t);
    this.Q20(this._paneInvalidationMask(n, D22.LIGHT_UPDATE))
};
J79.prototype.startScaleTime = function (n) {
    this.m_timeScale.startScale(n)
};
J79.prototype.scaleTimeTo = function (n) {
    this.m_timeScale.scaleTo(n);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.endScaleTime = function () {
    this.m_timeScale.endScale();
    this.Q20(new D22(D22.LIGHT_UPDATE));
    this.mainSeries().requestMoreData();
    this.recalcVisibleRangeStudy(this.Q19())
};
J79.prototype.startScrollTime = function (n) {
    this.m_timeScale.startScroll(n)
};
J79.prototype.scrollTimeTo = function (n) {
    this.m_timeScale.scrollTo(n);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.endScrollTime = function () {
    this.m_timeScale.endScroll();
    this.Q20(new D22(D22.LIGHT_UPDATE));
    this.mainSeries().requestMoreData();
    this.recalcVisibleRangeStudy(this.Q19())
};
J79.prototype.recalcVisibleRangeStudy = function (n, t) {
    var o;
    if (!this.timeScale().isEmpty()) {
        var i = this.timeScale().visibleBars(), u = this.mainSeries().nearestData(i.firstBar(), SEARCH_NEAREST_RIGHT), i = this.mainSeries().nearestData(i.lastBar(), SEARCH_NEAREST_LEFT), r = u ? u.index : void 0, f = i ? i.index : void 0;
        if (r != this._oldStartVisibleIndex || f != this._oldEndVisibleIndex || t)for (this._oldStartVisibleIndex = r, this._oldEndVisibleIndex = f, r = 0; r < n.size(); r++)if (n.item(r)instanceof TradingView.Study)for (var f = n.item(r), s = f.metaInfo().inputs, e = 0; e < s.length; e++)"first_visible_bar_time" == s[e].id && (o = u && u.value ? u.value[TIME_PLOT] : 0, f.properties().inputs.first_visible_bar_time.setValue(1e3 * Math.floor(o))), "last_visible_bar_time" == s[e].id && (o = i && i.value ? i.value[TIME_PLOT] : 0, f.properties().inputs.last_visible_bar_time.setValue(1e3 * Math.floor(o)))
    }
};
J79.prototype.resetTimeScale = function () {
    this.m_timeScale.restoreDefault();
    this.recalculateAllPanes();
    this.mainSeries().requestMoreData();
    this.recalcVisibleRangeStudy(this.Q19());
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.restoreTimeScaleState = function (n) {
    this.m_timeScale.restoreState(n);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.restoreFactoryDefaults = function (n) {
    n.restoreFactoryDefaults();
    this.recalcVisibleRangeStudy(this.Q19(), !0);
    this.mainSeries().onChartStyleChanged()
};
J79.prototype.setSelectedSource = function (n, t) {
    if (!(this.m_selectedSource === n && this._lastHittestData === t || n && n.customization && n.customization.disableSelection)) {
        this._lastHittestData = t;
        var i = new D22;
        this.m_selectedSource && (this.m_selectedSource.updateAllViews(), this.paneForSource(this.m_selectedSource));
        this.m_selectedSource = n;
        this._selectedSourceChanged.fire(n);
        n && (n.updateAllViews(), this.paneForSource(n));
        i.force = !0;
        this.Q20(new D22(D22.LIGHT_UPDATE));
        this.setHoveredSource(n, t)
    }
};
J79.prototype.checkLineToolSelection = function () {
    this.m_selectedSource && this.m_selectedSource instanceof J47 && (this.m_selectedSource.calcIsActualSymbol(), this.m_selectedSource.isActualSymbol() || this.setSelectedSource(null))
};
J79.prototype.onSelectedSourceChanged = function () {
    return this._selectedSourceChanged
};
J79.prototype.setHoveredSource = function (n, t) {
    if (this.m_hoveredSource !== n || this._lastHittestData !== t) {
        this._lastHittestData = t;
        var i = null;
        this.m_hoveredSource && (this.m_hoveredSource.updateAllViews(), i || (i = new D22), i.merge(this._paneInvalidationMask(this.paneForSource(this.m_hoveredSource), D22.LIGHT_UPDATE)));
        (this.m_hoveredSource = n) && (n.updateAllViews(), i || (i = new D22), i.merge(this._paneInvalidationMask(this.paneForSource(n), D22.LIGHT_UPDATE)));
        i && this.Q20(i)
    }
};
J79.prototype.selectedSource = function () {
    return this.m_selectedSource
};
J79.prototype.hoveredSource = function () {
    return this.m_hoveredSource
};
J79.prototype.lastHittestData = function () {
    return this._lastHittestData
};
J79.prototype.Q20 = function (n) {
    this._invalidateHandler && this._invalidateHandler(n)
};
J79.prototype.Q19 = function () {
    var n = [], t;
    for (n.push(this.m_crossHairSource), t = 0; t < this.m_panes.size(); ++t)n = n.concat(this.m_panes.item(t).Q19().toArray());
    return new List(n)
};
J79.prototype.dataSourceForId = function (n) {
    for (var i, t = 0; t < this.m_panes.size(); ++t)if (i = this.m_panes.item(t).dataSourceForId(n))return i;
    return null
};
J79.prototype.children = function (n) {
    for (var i, r = this.Q19(), u = new List, t = 0; t < r.size(); t++)i = r.item(t), i.ownerSource() === n && u.append(i);
    return u
};
J79.prototype.setCurrentPosition = function (n, t, i, r) {
    var u = NaN, f, e, o;
    for (n = Math.round(this.m_timeScale.coordinateToIndex(n)), i && (f = i.defaultPriceScale(), f.isEmpty() || (u = f.coordinateToPrice(t))), (this._lineBeingCreated || J47.isLineTool(this.currentTool())) && (u = this._magnet.align(u, n, i)), this.m_crossHairSource.setPosition(n, u, i), this.m_crossHairSource.dataWindowView().update(), t = this.m_panes.toArray(), i = t.length; i--;)for (f = t[i].Q19().toArray(), e = f.length; e--;)o = f[e].dataWindowView(), o && o.update();
    this._lineBeingCreated ? (this._lineBeingCreated.setLastPoint({index: n, price: u}, r), this._lineBeingCreated.updateAllViews(), this.Q20(new D22(D22.LIGHT_UPDATE))) : this.crossHairSource().startMeasurePoint() ? this.Q20(new D22(D22.LIGHT_UPDATE)) : this.Q20(new D22(D22.UPDATE_CURSOR_ONLY));
    r = this._undoModel.Q4;
    r.Q5 && (u = this.m_timeScale.points().valueAt(n), isNaN(u) && 0 < n && (u = Infinity), r.Q5.syncCrosshair(u, r))
};
J79.prototype.clearCurrentPosition = function () {
    this.crossHairSource().clearPosition();
    this.fullUpdate();
    var n = this._undoModel.Q4;
    n.Q5 && n.Q5.syncCrosshair(NaN, n)
};
J79.prototype.setExternalPosition = function (n) {
    var t, i;
    if (n = this.m_timeScale.points().closestIndexLeft(n), isFinite(n))for (this.crossHairSource().setPosition(n, NaN, null), n = this.Q19(), t = n.size(); t--;)i = n.item(t).dataWindowView(), i && i.update(); else this.crossHairSource().visible = !1;
    this.Q20(new D22(D22.UPDATE_CURSOR_ONLY))
};
J79.prototype.updateTimeScale = function (n, t, i, r, u) {
    if (u) {
        this.m_timeScale.reset();
        u = this.Q19();
        for (var f = 0; f < u.size(); f++)u.item(f).clearData && u.item(f).clearData()
    }
    this.m_timeScale.update(n, t, i, r);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.recalculatePane = function (n, t) {
    n && n.recalculate(t)
};
J79.prototype.paneForSource = function (n) {
    for (var t = this.m_panes.size() - 1; 0 <= t; t--)if (this.m_panes.item(t).Q19().contains(n))return this.m_panes.item(t);
    return n instanceof J96 ? this.paneForSource(this.m_mainSeries) : null
};
J79.prototype.recalculateAllPanes = function () {
    for (var n = 0; n < this.m_panes.size(); ++n)this.m_panes.item(n).recalculate();
    this.timeScale().recalcLockedScale();
    this.updateAllPaneViews()
};
J79.prototype._invalidateBarColorerCaches = function () {
    for (var i, t = this.Q19(), n = 0; n < t.size(); ++n)i = t.item(n), i instanceof TradingView.Series && i.invalidateBarColorerCache()
};
J79.prototype.insertStudy = function (n, t, i) {
    var r = null, u;
    return TradingView.trackEvent("studies", "Study_" + n.id), r = i || n.is_price_study ? this.paneForSource(this.m_mainSeries) : this.createPane(void 0, !0), t.paneSize && r.setPaneSize(t.paneSize), "Compare@tv-basicstudies" == n.id && (TradingView.trackEvent("compare", "symbol:" + t.inputs.symbol), this.m_mainSeries.priceScale().properties().log.setValue(!1), this.m_mainSeries.priceScale().properties().percentage.setValue(!0)), t = TradingView.prepareStudyProperties(n, t, r, this.studyVersioning()), t = TradingView.createStudy(this, t, this.mainSeries(), n), t.start(), u = t.metaInfo().priceScale || TradingView.Study.SCALE_RIGHT, u === TradingView.Study.SCALE_RIGHT ? u = r.rightPriceScale() : u === TradingView.Study.SCALE_LEFT ? u = r.leftPriceScale() : n.is_price_study ? u = null : (console.warn("Cannot add study " + t.metaInfo().id + " with 'No Scale' setting, because study is not a price study. Using right price scale."), u = r.rightPriceScale()), i ? (r.addDataSource(t, null), "Volume@tv-basicstudies" == n.id && (n = t.priceScale(), n.setTopMargin(.75), n.setBottomMargin(0))) : r.addDataSource(t, u), t.properties().linkedToSeries && t.properties().linkedToSeries.value() && t.setOwnerSource(this.mainSeries()), this.recalculatePane(r), this.Q20(new D22(D22.FULL_UPDATE)), this._invalidateBarColorerCaches(), this.recalcVisibleRangeStudy(this.Q19(), !0), t
};
J79.prototype.detachSource = function (n, t) {
    var i = this.paneForSource(n);
    if (i)return(i.removeDataSource(n), i.isEmpty()) ? (this._lineBeingCreated && i == this._paneBeingCreatedLineOn && this.cancelCreatingLine(), this.removePane(i, t), !0) : (this.Q20(new D22(D22.FULL_UPDATE)), !1)
};
J79.prototype.removeSource = function (n, t) {
    var u, r, i;
    if (n === this.m_selectedSource && this.setSelectedSource(null), n.stop && n.stop(), u = this.detachSource(n, t), n.metaInfo && n.metaInfo() && "Compare@tv-basicstudies" === n.metaInfo().id) {
        for (r = this.paneForSource(this.m_mainSeries), i = 0; i < r.Q19().size(); i++)if (r.Q19().item(i).metaInfo && "Compare@tv-basicstudies" === r.Q19().item(i).metaInfo().id)return;
        this.m_mainSeries.priceScale().properties().percentage.setValue(!1)
    }
    return this.Q20(new D22(D22.FULL_UPDATE)), this._invalidateBarColorerCaches(), u
};
J79.prototype.move = function (n, t, i) {
    var r = new List, f = this.children(n), u;
    if (r.append(n), r.appendAll(f), u = this.paneForSource(n), this.panes().indexOf(u), u.state(), u.priceScaleName(n.priceScale()), this.panes().indexOf(t), t && t.state(), i = t ? t.priceScaleName(i) : "right", u === t)for (t.move(n, t.priceScaleByName(i)), r = n.priceScale(), n = 0; n < f.size(); n++)t.move(f.item(n), r); else {
        for (n = 0; n < r.size(); n++)this.detachSource(r.item(n));
        for (t = t ? t : this.createPane(), n = 0; n < r.size(); n++)t.addDataSource(r.item(n), t.priceScaleByName(i));
        this.Q20(new D22(D22.FULL_UPDATE))
    }
    this.recalculateAllPanes()
};
J79.prototype.isSingleInstanceLineTool = function (n) {
    return"LineStudyMtpRiskReward" == n || "LineStudyMtpAnalysis" == n ? !0 : !1
};
J79.prototype.createLineTool = function (n, t, i, r) {
    var f, u;
    return(TradingView.trackEvent("GUI", "Add Line Tool"), f = TradingView[i], !f) ? null : (this.isSingleInstanceLineTool(i) && this._undoModel.removeAllDrawingTools(i), TradingView.trackEvent("drawings", "Study_Drawing_" + i), r = new f(this, r), r.toolname = i, r.setOwnerSource(n.mainDataSource()), u = n.defaultPriceScale(), n.addDataSource(r, u), i = this.m_timeScale.indexToCoordinate(t.index), u = u.priceToCoordinate(t.price), r.isFixed() ? t = r.addFixedPoint(new MathEx.Point(i, u)) : (f.skipMagnetting || (t.price = this._magnet.align(t.price, t.index, n)), t = r.addPoint(t)), t || (this._lineBeingCreated = r, this._paneBeingCreatedLineOn = n), this.Q20(new D22(D22.FULL_UPDATE)), r)
};
J79.prototype.lineBeingCreated = function () {
    return this._lineBeingCreated
};
J79.prototype.paneBeingCreatedLineOn = function () {
    return this._paneBeingCreatedLineOn
};
J79.prototype.coninueCreatingLine = function (n, t) {
    var i = this.paneForSource(this._lineBeingCreated), r;
    return i.defaultPriceScale(), n.price = this._magnet.align(n.price, n.index, i), i = this._lineBeingCreated.addPoint(n, t), this._lineBeingCreated.updateAllViews(), r = new D22(D22.LIGHT_UPDATE), i && (this._lineBeingCreated = this._paneBeingCreatedLineOn = null, r.force = !0), this.Q20(r), i
};
J79.prototype.cancelCreatingLine = function () {
    this._lineBeingCreated && (this.removeSource(this._lineBeingCreated), this._lineBeingCreated = null, this._lineCancelled.fire())
};
J79.prototype.startChangingLinetool = function (n, t, i, r) {
    this._lineBeingEdited = n;
    this._linePointBeingEdited = i;
    this._lineBeingEdited.startChanging(i, t);
    n = this.paneForSource(n);
    t.price = this._magnet.align(t.price, t.index, n);
    this._lineBeingEdited.startDragPoint && this._lineBeingEdited.startDragPoint(i, t);
    this._lineBeingEdited.setPoint(i, t, r);
    this._lineBeingEdited.updateAllViews();
    t = this._paneInvalidationMask(n, D22.LIGHT_UPDATE);
    t.force = !0;
    this.Q20(t)
};
J79.prototype.lineBeingEdited = function () {
    return this._lineBeingEdited
};
J79.prototype.linePointBeingEdited = function () {
    return this._linePointBeingEdited
};
J79.prototype.changeLinePoint = function (n, t) {
    var u = this.paneForSource(this._lineBeingEdited);
    if (void 0 !== n.x && void 0 !== n.y) {
        var i = this._lineBeingEdited.priceScale().coordinateToPrice(n.y), r = Math.round(this.timeScale().coordinateToIndex(n.x)), i = this._magnet.align(i, r, u);
        this._lineBeingEdited.setPoint(this._linePointBeingEdited, {price: i, index: r}, t)
    } else this._lineBeingEdited.setPoint(this._linePointBeingEdited, n, t);
    this._lineBeingEdited.updateAllViews();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.endChangingLinetool = function () {
    this.paneForSource(this._lineBeingEdited);
    this._lineBeingEdited.endChanging();
    this._linePointBeingEdited = this._lineBeingEdited = null;
    var n = new D22(D22.LIGHT_UPDATE);
    n.force = !0;
    this.Q20(n)
};
J79.prototype.startMovingSource = function (n, t, i) {
    this._sourceBeingMoved = n;
    this._linePointBeingMoved = i;
    this._sourceBeingMoved.startMoving(t, i);
    n = this.paneForSource(this._sourceBeingMoved);
    n = this._paneInvalidationMask(n, D22.LIGHT_UPDATE);
    n.force = !0;
    this.Q20(n)
};
J79.prototype.sourceBeingMoved = function () {
    return this._sourceBeingMoved
};
J79.prototype.moveSource = function (n) {
    this._sourceBeingMoved.move(n, this._linePointBeingMoved);
    this.paneForSource(this._sourceBeingMoved);
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.endMovingSource = function () {
    var n = this.paneForSource(this._sourceBeingMoved);
    this._sourceBeingMoved.endMoving();
    this._linePointBeingMoved = this._sourceBeingMoved = null;
    n = this._paneInvalidationMask(n, D22.LIGHT_UPDATE);
    n.invalidateAll(D22.LIGHT_UPDATE);
    n.force = !0;
    this.Q20(n)
};
J79.prototype.calculateDefaultTags = function () {
    for (var i, n = [], r = this.Q19(), t = 0; t < r.size(); t++)i = r.item(t), i.tags && (n = n.concat(i.tags()));
    return n
};
J79.prototype.changeZOrder = function (n, t) {
    this.paneForSource(n).changeZOrder(n, t);
    this.Q20(new D22(D22.FULL_UPDATE))
};
J79.prototype.sendToBack = function (n) {
    this.paneForSource(n).sendToBack(n);
    this.Q20(new D22(D22.FULL_UPDATE))
};
J79.prototype.bringToFront = function (n) {
    this.paneForSource(n).bringToFront(n);
    this.Q20(new D22(D22.FULL_UPDATE))
};
J79.prototype.onTagsChanged = function () {
    return this._tagsChanged
};
J79.prototype.onPaneTagsChanged = function () {
    this._tagsChanged.fire()
};
J79.prototype.setTimeViewport = function (n, t) {
    this.timeScale().zoomToBarsRange(n, t);
    this.recalculateAllPanes();
    this.Q20(new D22(D22.LIGHT_UPDATE))
};
J79.prototype.zoomToViewport = function (n, t, i, r, u) {
    this.setTimeViewport(n, t);
    n = Math.min(i, r);
    i = Math.max(i, r);
    r = u.defaultPriceScale();
    r.setAutoScale(!1);
    r.isLog() && (n = r.priceToLogical(n), i = r.priceToLogical(i));
    r.setPriceRange(new PriceRange(n, i));
    this.recalculateAllPanes();
    this.Q20(this._paneInvalidationMask(u, D22.LIGHT_UPDATE))
};
J79.prototype.clearAllStudies = function () {
    for (var t = this.Q19(), n = 0; n < t.size(); n++)t.item(n).clearData && t.item(n).clearData()
};
J79.prototype.allLineTools = function () {
    for (var i, r = new List, u = this.m_panes, e = u.size(), n = 0; n < e; ++n)for (var f = u.item(n).Q19(), o = f.size(), t = 0; t < o; ++t)i = f.item(t), isInherited(i.constructor, J47) && r.append(i);
    return r
};
J79.prototype.backgroundColor = function () {
    return this.Q2.paneProperties.background._value
};
J79.prototype.backgroundCounterColor = function () {
    return new RGBColor(this.backgroundColor()).blackWhiteContrast()
};
J79.prototype.isDark = function () {
    return"white" === this.backgroundCounterColor()
};
J79.prototype.canZoomIn = function () {
    return this.m_timeScale.canZoomIn()
};
J79.prototype.canZoomOut = function () {
    return this.m_timeScale.canZoomOut()
};
J79.prototype.updateAllVolumeStudies = function () {
    for (var n, t = this.m_panes.toArray(), i = t.length; i--;)for (var r = !1, u = t[i], f = u.Q19().toArray(), e = f.length; e--;)n = f[e], n instanceof TradingView.Study && "Volume" === n.metaInfo().shortId && (n.updateAllViews(), r || (this.updatePane(u), r = !0))
};
J79.prototype._prepareAlertsList = function () {
    function i() {
        var i = n.mainSeries().symbolInfo() ? n.mainSeries().symbolInfo().full_name : null, u = n.mainSeries().properties().interval.value();
        i && u && TradingView.alertsDispatcher.requestList(function (i) {
            for (; n._alertsList.size();)t(n._alertsList.item(0));
            for (var u = 0; u < i.length; u++)r(i[u])
        }, function () {
        }, {symbol: i, resolution: u, activeOnly: !0})
    }

    function u() {
        for (var r = n._alertsList.toArray(), i = 0; i < r.length; i++)t(r[i].id())
    }

    function r(i) {
        if (i instanceof TradingView.Alert) {
            var r = n._alertsList.find(function (n) {
                return n.id() === i.id()
            });
            r && t(r);
            (i.active() || i.fake()) && (n.mainSeries().symbolInfo() ? n.mainSeries().symbolInfo().full_name : null) === i.symbol() && (n._alertsList.append(i), n._alertsList.onAdd.fire(i))
        }
    }

    function t(t) {
        var i = t instanceof TradingView.Alert ? t.id() : t.id || t;
        (t = n._alertsList.find(function (n) {
            return n.id() === i
        })) && (n._alertsList.removeAll(function (n) {
            return n.id() === i
        }), n._alertsList.onRemove.fire(t))
    }

    function e(n) {
        n && is_authenticated && i()
    }

    function o(n) {
        n && is_authenticated && i()
    }

    function f(i) {
        TradingView.alertsDispatcher.alertCreatingStarted[i](n, r);
        TradingView.alertsDispatcher.alertRunning[i](n, r);
        TradingView.alertsDispatcher.alertDeletingStarted[i](n, t);
        TradingView.alertsDispatcher.alertDeletingAllStarted[i](n, u);
        TradingView.alertsDispatcher.alertDeleted[i](n, t);
        TradingView.alertsDispatcher.alertStoppingStarted[i](n, t);
        TradingView.alertsDispatcher.alertStoppingAllStarted[i](n, u);
        TradingView.alertsDispatcher.alertStopped[i](n, t);
        n.mainSeries().onSymbolResolved().subscribe(n, e);
        n.mainSeries().properties().interval.subscribe(n, o)
    }

    var n = this;
    n._alertsList.add = r;
    n._alertsList.remove = t;
    loginStateChange.subscribe(n, function () {
        is_authenticated ? (i(), f("subscribe")) : (u(), f("unsubscribe"))
    });
    is_authenticated && (i(), f("subscribe"))
};
J79.prototype.alertsList = function () {
    return this._alertsList
};
J79.prototype._modelIntervals = [];
J79.prototype.setInterval = function (n, t) {
    var i = setInterval(n, t);
    return this._modelIntervals.push(i), i
};
J79.prototype.clearInterval = function (n) {
    clearInterval(n);
    n = this._modelIntervals.indexOf(n);
    -1 < n && this._modelIntervals.splice(n, 1)
};
J79.prototype.clearIntervals = function () {
    for (var n = 0; n < this._modelIntervals.length; n++)clearInterval(this._modelIntervals[n]);
    this._modelIntervals = []
};
J79.prototype.destroy = function () {
    this.clearIntervals()
};
DataWindowItem.prototype.title = function () {
    return this.m_title
};
DataWindowItem.prototype.text = function () {
    return this.m_value
};
DataWindowItem.prototype.visible = function () {
    return this._visible
};
DataWindowItem.prototype.color = function () {
    return this._color
};
DataWindowItem.prototype.setVisible = function (n) {
    this._visible = n
};
DataWindowItem.prototype.setValue = function (n) {
    this.m_value = n
};
DataWindowItem.prototype.setColor = function (n) {
    this._color = n
};
DataWindowItem.prototype.value = function () {
    return this.m_value
};
DataWindowView.prototype.header = function () {
    return this._header
};
DataWindowView.prototype.title = function () {
    return this._title
};
DataWindowView.prototype.items = function () {
    return this._items
};
StatusView.prototype.text = function () {
    return this._text
};
StatusView.prototype.color = function () {
    return this._props ? this._props.scalesProperties.textColor.value() : "#444"
};
StatusView.prototype.bold = function () {
    return this._bold
};
StatusView.prototype.size = function () {
    return this._size
};
PriceAxisView.prototype.text = function () {
    return this._text
};
PriceAxisView.prototype.background = function () {
    return this._background
};
PriceAxisView.prototype.color = function () {
    return new RGBColor(this._background).blackWhiteContrast()
};
PriceAxisView.prototype.coordinate = function () {
    return this._coordinate
};
PriceAxisViewRenderer.prototype.height = function (n) {
    return this._data.secondLine && n ? 2.2 * this._data.textHeight + 2 : 1.1 * this._data.textHeight
};
PriceAxisViewRenderer.prototype.draw = function (n, t, i, r) {
    function w(n, t, i, r) {
        $.browser.webkit ? --r : $.browser.mozilla ? r += 1 : $.browser.jsdom && (r += .5);
        n.fillText(t, i, r)
    }

    var a, o;
    if (this._data.visible) {
        this._data.font && (a = n.font, n.font = this._data.font);
        o = n.measureText(this._data.text || this._data.secondLine).width;
        n.strokeStyle = this._data.borderColor;
        n.fillStyle = this._data.background;
        n.lineWidth = 1;
        r = Math.round(1.1 * this._data.textHeight);
        var s = this._data.coordinate, h = Math.round(s - .5 * r) - .5, c = h, l = c + r + 1, v = l;
        if (this._data.text) {
            if (t) {
                var u = i - 1.5, e = u - o - 11, y = e, f = i = u, p = f - 3;
                n.beginPath();
                n.moveTo(u, h);
                n.lineTo(e, c);
                n.lineTo(y, l);
                n.lineTo(i, v);
                n.fill();
                n.beginPath();
                n.strokeStyle = this._data.color;
                n.moveTo(f, s);
                n.lineTo(p, s);
                n.stroke();
                n.textBaseline = "middle";
                n.textAlign = "left";
                n.fillStyle = this._data.color;
                f = u - o - .4 * r
            } else u = .5, y = e = u + o + 9 + 2, f = i = u, p = f + 3, n.beginPath(), n.moveTo(u, h), n.lineTo(e, c), n.lineTo(y, l), n.lineTo(i, v), n.fill(), n.beginPath(), n.strokeStyle = this._data.color, n.moveTo(f, s), n.lineTo(p, s), n.stroke(), n.textBaseline = "middle", n.textAlign = "left", n.fillStyle = this._data.color, f = u + .4 * r;
            w(n, this._data.text, f, s + 1);
            this._data.font && (n.font = a)
        }
        this._data.secondLine && (a = n.measureText(this._data.secondLine).width, n.fillStyle = this._data.background, this._data.text && (h = l + 1, c = v + 1, l = h + r, v = c + r), t ? (i = u = u - o - 11, e = u + a + 4 + 3) : (i = u = .5 + o - a + 4, e = o + 9 + 2 + .5), y = e, f = u + 2, n.beginPath(), n.moveTo(u, h), n.lineTo(e, c), n.lineTo(y, l), n.lineTo(i, v), n.fill(), n.textBaseline = "middle", n.textAlign = "left", n.fillStyle = this._data.color, t = this._data.coordinate, this._data.text && (t += r + 2), w(n, this._data.secondLine, f, t))
    }
};
TimeAxisView.prototype.text = function () {
    return this._text
};
TimeAxisView.prototype.background = function () {
    return this._background
};
TimeAxisView.prototype.color = function () {
    return new RGBColor(this._background).blackWhiteContrast()
};
TimeAxisView.prototype.coordinate = function () {

    return this._coordinate
};
TimeAxisViewRenderer.prototype.draw = function (n, t, i) {
    if (!1 !== this._data.visible && (t = n.measureText(gregorianToJalali(this._data.text)).width, !(0 >= t))) {
        i = t + 6;
        t = Math.round(this._data.coordinate - .5 * i - 1.5) + 1.5;
        i = t + i + 3;
        var u = Math.round(this._data.coordinate + 1), r = this._data.textHeight + 6 + .5;
        n.fillStyle = this._data.background;
        n.lineWidth = 1;
        n.beginPath();
        n.moveTo(t, .5);
        n.lineTo(t, r);
        n.lineTo(i, r);
        n.lineTo(i, .5);
        n.fill();
        n.strokeStyle = this._data.color;
        n.beginPath();
        n.moveTo(u, .5);
        n.lineTo(u, 3.5);
        n.stroke();
        n.textBaseline = "middle";
        n.textAlign = "left";
        n.fillStyle = this._data.color;
        $.browser.webkit ? n.fillText(gregorianToJalali(this._data.text), t + 3 + 1, .5 * (.5 + r) + 1) : n.fillText(gregorianToJalali(this._data.text), t + 3 + 1, .5 * (.5 + r) + 2)
    }
};
inherit(CrossHair, DataSource);
CrossHair.prototype.index = 0;
CrossHair.prototype.price = NaN;
CrossHair.prototype.pane = null;
CrossHair.prototype.color = "white";
CrossHair.prototype.style = "";
CrossHair.prototype.properties = function () {
    return this.Q2
};
CrossHair.prototype.setPosition = function (n, t, i) {
    this._subscribed || (this.Q0.mainSeries().onRestarted().subscribe(this, CrossHair.prototype.clearMeasure), this._subscribed = !0);
    this.index = n;
    this.x = this.Q0.timeScale().indexToCoordinate(n);
    i && !i.defaultPriceScale().isEmpty() ? (this.price = t, this.y = i.defaultPriceScale().priceToCoordinate(t), this.pane = i) : (this.y = this.price = NaN, this.pane = null);
    this.visible = !0;
    this.updateAllViews()
};
CrossHair.prototype.clearPosition = function () {
    this.visible = !1;
    this.index = parseInt(this.Q0.mainSeries().data().bars().last())
};
CrossHair.prototype.measureStartY = function () {
    var t = this._startMeasurePoint.price, n = this._measurePane, i;
    return n.defaultPriceScale().isPercent() && (i = n.mainDataSource().firstValue(), t = n.defaultPriceScale().priceRange().convertToPercent(t, i)), n.defaultPriceScale().priceToCoordinate(t)
};
CrossHair.prototype.measureStartX = function () {
    return this.Q0.timeScale().indexToCoordinate(this._startMeasurePoint.index)
};
CrossHair.prototype.measureEndY = function () {
    var t = this._endMeasurePoint.price, n = this._measurePane, i;
    return n.defaultPriceScale().isPercent() && (i = n.mainDataSource().firstValue(), t = n.defaultPriceScale().priceRange().convertToPercent(t, i)), n.defaultPriceScale().priceToCoordinate(t)
};
CrossHair.prototype.measureEndX = function () {
    return this.Q0.timeScale().indexToCoordinate(this._endMeasurePoint.index)
};
CrossHair.prototype.paneViews = function (n) {
    var t = (new List).append(new _65(this, n, n === this.pane));
    return n === this._measurePane && (this._measurePaneView || (this._measurePaneView = new _64(this, n)), this._measurePaneView.update(), t.append(this._measurePaneView)), t
};
CrossHair.prototype.dataWindowView = function () {
    return this._dataWindowView
};
CrossHair.prototype.priceAxisViews = function (n, t) {
    if (this.visible && this.pane === n && t === n.defaultPriceScale()) {
        var i = new List;
        return i.append(this._priceAxisView), this._startMeasurePoint && i.append(this._startMeasurePriceAxisView), this._endMeasurePoint && i.append(this._endMeasurePriceAxisView), i
    }
    return null
};
CrossHair.prototype.timeAxisView = function () {
    if (!this.visible)return null;
    var n = new List;
    return n.append(this._timeAxisView), this._startMeasurePoint && n.append(this._startMeasureTimeAxisView), this._endMeasurePoint && n.append(this._endMeasureTimeAxisView), n
};
CrossHair.prototype.updateAllViews = function () {
    this._priceAxisView.update();
    this._startMeasurePoint && (this._startMeasurePriceAxisView.update(), this._startMeasureTimeAxisView.update());
    this._endMeasurePoint && (this._endMeasurePriceAxisView.update(), this._endMeasureTimeAxisView.update());
    this._timeAxisView.update()
};
CrossHair.prototype.startMeasurePoint = function () {
    return this._startMeasurePoint
};
CrossHair.prototype.startMeasuring = function (n, t) {
    if (t.defaultPriceScale().isPercent()) {
        var i = t.mainDataSource().firstValue();
        n.price = t.defaultPriceScale().priceRange().convertFromPercent(n.price, i)
    }
    this._startMeasurePoint = n;
    this._measurePane = t
};
CrossHair.prototype.finishMeasure = function (n) {
    var t = this._measurePane, i;
    t.defaultPriceScale().isPercent() && (i = t.mainDataSource().firstValue(), n.price = t.defaultPriceScale().priceRange().convertFromPercent(n.price, i));
    this._endMeasurePoint = n
};
CrossHair.prototype.endMeasurePoint = function () {
    return this._endMeasurePoint
};
CrossHair.prototype.clearMeasure = function () {
    delete this._measurePane;
    delete this._startMeasurePoint;
    delete this._endMeasurePoint;
    delete this._lastValidMeasurePoint;
    this.Q0.Q20(new D22(D22.LIGHT_UPDATE))
};
CrossHair.prototype.measurePoints = function () {
    var n;
    if (this.updateAllViews(), n = new List, n.append(this._startMeasurePoint), this._endMeasurePoint)n.append(this._endMeasurePoint); else {
        this._measurePane === this.pane && (this._lastValidMeasurePoint = {x: this.x, y: this.y, rawPrice: this.price, price: this.price, index: this.index});
        var r = this._lastValidMeasurePoint.rawPrice, t = this._measurePane, i = t.defaultPriceScale();
        i.isPercent() && !i.isEmpty() && (t = t.mainDataSource().firstValue(), this._lastValidMeasurePoint.price = i.priceRange().convertFromPercent(r, t));
        n.append(this._lastValidMeasurePoint)
    }
    return n
};
CrossHair.prototype.currentPoint = function () {
    return new MathEx.Point(this.x, this.y)
};
_64.prototype.update = function () {
    var n, t, e;
    if (this.J99._endMeasurePoint)n = this.J99._endMeasurePoint.price, t = this.J99._endMeasurePoint.index; else if (this.J99._measurePane === this.J99.pane)n = this.J99.price, t = this.J99.index; else if (this.J99._lastValidMeasurePoint)n = this.J99._lastValidMeasurePoint.rawPrice, t = this.J99._lastValidMeasurePoint.index; else return;
    var f = n - this.J99._startMeasurePoint.price, u = t - this.J99._startMeasurePoint.index, r = this.J99._startMeasurePoint.price, i = this.J99._measurePane;
    i.defaultPriceScale().isPercent() && (e = i.mainDataSource().firstValue(), this.J99._endMeasurePoint && (n = i.defaultPriceScale().priceRange().convertToPercent(n, e)), r = i.defaultPriceScale().priceRange().convertToPercent(r, e));
    this._horzLabel = $.t("{0} bars").format(u);
    u = this.J99._measurePane.defaultPriceScale().formatter().format(f);
    this.J99._startMeasurePoint.price && (i = f / this.J99._startMeasurePoint.price, u += " (" + (new PercentageFormatter).format(100 * i) + ")");
    this._vertLabel = "" + u;
    r = this.J99.Q0._magnet.align(r, this.J99._startMeasurePoint.index, this.J99._measurePane);
    n = this.J99.Q0._magnet.align(n, t, this.J99._measurePane);
    u = this.J99.Q0.timeScale().indexToCoordinate(this.J99._startMeasurePoint.index);
    i = this.J99.Q0.timeScale().indexToCoordinate(t);
    r = this.J99._measurePane.defaultPriceScale().priceToCoordinate(r);
    n = this.J99._measurePane.defaultPriceScale().priceToCoordinate(n);
    this._p1 = new MathEx.Point(u, r);
    this._p2 = new MathEx.Point(i, n);
    n = this.J99.Q0.timeScale().indexToUserTime(this.J99._startMeasurePoint.index);
    t = this.J99.Q0.timeScale().indexToUserTime(t);
    n && t && (t = (t.valueOf() - n.valueOf()) / 1e3, this._horzLabel += ", " + (new TimeSpanFormatter).format(t));
    (t = this.J99._measurePane.mainDataSource().base()) && (f = Math.round(f * t), this._vertLabel += " , " + f)
};
_64.prototype.renderer = function () {
    var i = new CompositeRenderer, n = {};
    n.points = (new List).append(this._p1).append(this._p2);
    n.width = this.J99.Q0.timeScale().width();
    n.height = this.J99._measurePane.defaultPriceScale().height();
    n.color = "#D3E7FF";
    n.linewidth = 0;
    n.fillBackground = !0;
    n.transparency = 60;
    n.backcolor = "#BADAFF";
    i.append(new RectangleRenderer(n));
    var t = this._p1.add(this._p2).scaled(.5), r = new MathEx.Point(this._p1.x, t.y), u = new MathEx.Point(this._p2.x, t.y), r = {points: (new List).append(r).append(u), width: n.width, height: n.height, color: "#646668", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_ARROW};
    return i.append(new TrendLineRenderer(r)), r = new MathEx.Point(t.x, this._p1.y), u = new MathEx.Point(t.x, this._p2.y), r = {points: (new List).append(r).append(u), width: n.width, height: n.height, color: "#646668", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_ARROW}, i.append(new TrendLineRenderer(r)), n = function (n, t) {
        return{points: (new List).append(t), text: n, color: "#FFFFFF", horzAlign: "center", vertAlign: "middle", font: "Arial", offsetX: 5, offsetY: 0, bold: !1, italic: !1, fontsize: 12, highlightBorder: !1, backgroundColor: "#646668", backgroundTransparency: 20, backgroundVertInflate: 5, backgroundHorzInflate: 5}
    }, t = t.add(new MathEx.Point(0, -10)), t = n(this._horzLabel, t), i.append(new TextRenderer(t, this._rendererCache)), t = this._p2.y, this._p1.y > this._p2.y && (t -= 27), t = new MathEx.Point(.5 * (this._p1.x + this._p2.x), t), t = n(this._vertLabel, t), i.append(new TextRenderer(t, this._rendererCache)), i
};
_65.prototype.update = function () {
};
_65.prototype.renderer = function () {
    var n = {}, t = this.source.visible && this.source.areLinesVisible;
    n.horzLinesVisible = t && this._horzVisible;
    n.vertLinesVisible = t;
    var i = (t = this.pane.Q0.readOnly()) ? defaults("chartproperties.paneProperties.crossHairProperties") : null, r = TradingView.isMobile.any() && J47.isLineTool(this.source.Q0.currentTool()), u = r ? "#a000a0" : t ? i.color : this.pane.Q0.properties().paneProperties.crossHairProperties.color.value(), f = t ? i.transparency : this.pane.Q0.properties().paneProperties.crossHairProperties.transparency.value();
    return!r && 0 < f && (u = generateColor(u, f)), n.color = u, n.lineWidth = t ? i.width : this.pane.Q0.properties().paneProperties.crossHairProperties.width.value(), n.lineStyle = t ? i.style : this.pane.Q0.properties().paneProperties.crossHairProperties.style.value(), n.drawCenter = r && this.pane == this.source.pane, n.w = this.pane.width(), n.h = this.pane.height(), n.x = this.source.x, n.y = this.source.y, new J62(n)
};
J62.prototype.draw = function (n) {
    var r = this.data.vertLinesVisible, u = this.data.horzLinesVisible;
    if ((r || u) && this.data) {
        n.lineStyle = this.data.lineStyle;
        n.lineWidth = this.data.lineWidth;
        n.strokeStyle = this.data.color;
        var t = 0 == this.data.lineWidth % 2 ? .5 : 0, i = this.data.x + 1 + t, t = this.data.y + t, f = this.data.w, e = this.data.h;
        r && 0 <= i && CanvasEx.drawLine(n, i, 0, i, e);
        u && 0 <= t && CanvasEx.drawLine(n, 0, t, f, t);
        this.data.drawCenter && (n.beginPath(), n.arc(i, t, 3, 0, 2 * Math.PI, !0), n.fillStyle = this.data.color, n.fill())
    }
};
inherit(CrossHairPriceAxisView, PriceAxisView);
CrossHairPriceAxisView.prototype.update = function () {
    var i = this._rendererData, n = this._crossHair.pane, t;
    i.coordinate = this._crossHair.y;
    this.text = "";
    n && this._crossHair.visible && (n = n.defaultPriceScale(), !n.isEmpty()) && (t = (t = n.mainSource()) ? t.formatter() : this._defaultFormatter, i.text = t.format(this._crossHair.price), i.textHeight = n.m_markBuilder.fontHeight())
};
CrossHairPriceAxisView.prototype.renderer = function () {
    return this._renderer || (this._renderer = new PriceAxisViewRenderer(this._rendererData)), this._renderer
};
inherit(CrossHairTimeAxisView, TimeAxisView);
CrossHairTimeAxisView.prototype.update = function () {
    var n = this._rendererData, t;
    this.Q0.timeScale();
    n.coordinate = this._crosshair.x;
    t = this.Q0.timeScale().indexToUserTime(this._crosshair.index);
    t ? (n.visible = !0, n.text = new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t)) : (n.visible = !1, n.text = "")
};
CrossHairTimeAxisView.prototype.renderer = function () {
    var n = this._rendererData;
    return this._renderer || (this._renderer = new TimeAxisViewRenderer(n)), this._renderer
};
inherit(CrossHairDataWindowView, DataWindowView);
CrossHairDataWindowView.prototype.update = function () {
    var n = this.Q0.mainSeries().isDWM(), t;
    this._items.item(1).setVisible(!n);
    this._items.item(0).setValue("n/a");
    this._items.item(1).setValue("n/a");
    this._items.item(2).setValue("n/a");
    this.Q0.timeScale().isEmpty() || (t = this._crossHair.index, t = this.Q0.timeScale().indexToUserTime(t), null === t ? (this._items.item(0).setValue("n/a"), n || this._items.item(1).setValue("n/a")) : (this._items.item(0).setValue((new DateFormatter).format(t)), n || this._items.item(1).setValue((new TimeFormatter).format(t))), (n = this._crossHair.pane) && (n = n.defaultPriceScale(), n.isEmpty() || (n = (n = n.mainSource()) ? n.formatter() : this._defaultFormatter, this._items.item(2).setValue(n.format(this._crossHair.price)))))
};
Grid.prototype.paneViews = function (n) {
    return(new List).append(new _83(this, n))
};
_83.prototype.update = function () {
};
_83.prototype.renderer = function () {
    var n = {};
    return this.pane.defaultPriceScale().isEmpty() || this.pane.timeScale().isEmpty() ? null : (n.horzLinesVisible = !0, n.vertLinesVisible = !0, n.horzLinesColor = this.pane.Q0.properties().paneProperties.gridProperties.color.value(), n.vertLinesColor = n.horzLinesColor, n.lineStyle = this.pane.Q0.properties().paneProperties.gridProperties.style.value(), n.priceMarks = this.pane.defaultPriceScale().marks(), n.timeMarks = this.pane.timeScale().marks(), n.w = this.pane.width(), n.h = this.pane.height(), new J65(n))
};
J65.prototype.draw = function (n) {
    CanvasEx.setLineStyle(n, this.data.lineStyle);
    var i = n.lineStyle != CanvasEx.LINESTYLE_SOLID && !("setLineDash"in n || "mozDash"in n || "webkitLineDash"in n), r = i ? CanvasEx.computeDashPattern(n) : null, t;
    if (n.translate(1, 0), n.lineWidth = 1, this.data.vertLinesVisible) {
        for (n.strokeStyle = this.data.vertLinesColor, n.beginPath(), t = 0; t < this.data.timeMarks.length; t++)i ? n.dashedLineTo(this.data.timeMarks[t].coord, 0, this.data.timeMarks[t].coord, this.data.h, r) : (n.moveTo(this.data.timeMarks[t].coord, 0), n.lineTo(this.data.timeMarks[t].coord, this.data.h));
        n.closePath();
        n.stroke()
    }
    if (this.data.horzLinesVisible) {
        for (n.strokeStyle = this.data.horzLinesColor, n.beginPath(), t = 0; t < this.data.priceMarks.length; t++)i ? n.dashedLineTo(0, this.data.priceMarks[t].coord, this.data.w, this.data.priceMarks[t].coord, r) : (n.moveTo(0, this.data.priceMarks[t].coord), n.lineTo(this.data.w, this.data.priceMarks[t].coord));
        n.closePath();
        n.stroke()
    }
};
Legend.prototype.items = function () {
    return this.m_items
};
LegendItem.prototype.title = function () {
    return this.m_title
};
LegendItem.prototype.color = function () {
    return this.m_color
};
LegendItem.prototype.dataSource = function () {
    return this.m_dataSource
};
J75.DEFAULT_STRETCH_FACTOR = 1e3;
J75.PANE_ANIMATION_DURATION = 500;
J75.alwaysTopSources = ["LineToolOrder", "LineToolPosition", "LineToolExecution"];
J75.sortSourcesPreOrdered = {"Volume@tv-basicstudies": 0, "Script$TV_DIVIDENDS@tv-scripting": 1, "Script$TV_SPLITS@tv-scripting": 2, "Script$TV_EARNINGS@tv-scripting": 3};
J75.prototype.destroy = function () {
    this.Q2.topMargin.listeners().unsubscribe(this, J75.prototype._updateMargins);
    this.Q2.bottomMargin.listeners().unsubscribe(this, J75.prototype._updateMargins)
};
J75.prototype.setPaneSize = function (n) {
    var t = {large: 1, medium: .6, small: .3, tiny: .15};
    if (!t[n])throw"Unknown size enum value: " + n;
    this._stretchFactor = t[n] * J75.DEFAULT_STRETCH_FACTOR
};
J75.sortSources = function (n) {
    var r, u, t, e, i, f;
    n.sort(function (n, t) {
        if (0 <= J75.alwaysTopSources.indexOf(n._constructor))return 1;
        if (0 <= J75.alwaysTopSources.indexOf(t._constructor))return-1;
        var i = n.zorder(), r = t.zorder();
        return r == i && (i = r - 1, n.setZorder(i)), i - r
    });
    r = [];
    u = [];
    for (t in J75.sortSourcesPreOrdered)u.push(null);
    for (t = 0, e = n.length; t < e; t++)i = n[t], isFunction(i.metaInfo) ? (f = i.metaInfo().id, f = J75.sortSourcesPreOrdered[f], 0 < f ? u[f] = i : r.push(i)) : r.push(i);
    for (t = 0, e = u.length; t < e; t++)(i = u[t]) && r.push(i);
    return r
};
J75.prototype._updateMargins = function () {
    var i = .01 * this.Q2.topMargin.value(), r = .01 * this.Q2.bottomMargin.value(), t, n;
    for (this.m_leftPriceScale.setTopMargin(i), this.m_leftPriceScale.setBottomMargin(r), this.m_rightPriceScale.setTopMargin(i), this.m_rightPriceScale.setBottomMargin(r), t = 0; t < this.m_dataSources.size(); t++)n = this.m_dataSources.item(t), n instanceof TradingView.Study && this.isOverlay(n) && "Volume" !== n.metaInfo().shortId && n.priceScale() && n.priceScale() !== this.m_leftPriceScale && n.priceScale() == this.m_rightPriceScale && (n.priceScale().setTopMargin(i), n.priceScale().setBottomMargin(r), this.recalculatePriceScale(n.priceScale()));
    this.recalculatePriceScale(this.m_leftPriceScale);
    this.recalculatePriceScale(this.m_rightPriceScale);
    this.updateAllViews()
};
J75.prototype.model = function () {
    return this.Q0
};
J75.prototype.width = function () {
    return this.m_width
};
J75.prototype.height = function () {
    return this.m_height
};
J75.prototype.setWidth = function (n) {
    this.m_width = n;
    this.updateAllViews()
};
J75.prototype.setHeight = function (n) {
    var t, i;
    for (this.m_height = n, this.m_leftPriceScale.setHeight(n), this.m_rightPriceScale.setHeight(n), t = 0; t < this.m_dataSources.size(); t++)i = this.m_dataSources.item(t), this.isOverlay(i) && i.priceScale() && i.priceScale().setHeight(n);
    this.updateAllViews()
};
J75.prototype.leftPriceScale = function () {
    return this.m_leftPriceScale
};
J75.prototype.rightPriceScale = function () {
    return this.m_rightPriceScale
};
J75.prototype.timeScale = function () {
    return this.m_timeScale
};
J75.prototype.Q19 = function () {
    return this.m_dataSources
};
J75.prototype.isOverlay = function (n) {
    return n._isOverlay
};
J75.prototype.legend = function () {
    return this.m_legend
};
J75.prototype._processMainSourceChange = function () {
    var i, t, n, r;
    if (null === this.m_mainDataSource)for (n = 0; n < this.m_dataSources.size(); n++)if (t = this.m_dataSources.item(n), !(!isInherited(t.constructor, PriceDataSource) || this.isOverlay(t) || t.properties().linkedToSeries && t.properties().linkedToSeries.value() || t instanceof TradingView.AlertLabel)) {
        this.m_mainDataSource = t;
        i = !0;
        break
    }
    if (this.m_mainDataSource && i) {
        for (i = [], n = 0; n < this.m_dataSources.size(); n++)t = this.m_dataSources.item(n), isInherited(t.constructor, J47) && i.push(t);
        for (i = J75.sortSources(i), n = 0; n < i.length; n++)this.move(i[n], this.m_mainDataSource.priceScale())
    } else if (!this.m_mainDataSource)for (n = 0; n < this.m_dataSources.size(); n++)if (t = this.m_dataSources.item(n), isInherited(t.constructor, PriceDataSource) && this.isOverlay(t) && t.showInObjectTree()) {
        for (this.m_mainDataSource = t, this.m_rightPriceScale.addDataSource(t), t.setPriceScale(this.m_rightPriceScale), n = this.Q0.children(t), r = 0; r < n.size(); r++)i = n.item(r), this.m_rightPriceScale.addDataSource(i), i.setPriceScale(this.m_rightPriceScale);
        this.recalculatePriceScale(this.m_rightPriceScale);
        t._isOverlay = !1;
        break
    }
};
J75.prototype.addDataSource = function (n, t) {
    this.m_dataSources.append(n);
    var i = !1;
    null !== this.m_mainDataSource || n instanceof TradingView.AlertLabel || (this.m_mainDataSource = n, i = !0);
    n._isOverlay = !1;
    null === t && (t = new J76(new Property(this.Q2.overlayPropreties.state())), t.setHeight(this.m_height), t.setTopMargin(this.m_rightPriceScale.topMargin()), t.setBottomMargin(this.m_rightPriceScale.bottomMargin()), n._isOverlay = !0);
    t.addDataSource(n);
    n.setPriceScale(t);
    n.onTagsChanged && n.onTagsChanged().subscribe(this, J75.prototype.onSourceTagsChanged);
    n.setZorder(this.getZOrderMinMax().minZOrder - 1);
    i && this._processMainSourceChange();
    n instanceof TradingView.AlertLabel || this.updateAlertLabelsSources();
    this._tagsChanged.fire();
    isInherited(n.constructor, PriceDataSource) && this.recalculatePriceScale(t);
    this.invalidateSourcesCache()
};
J75.prototype.removeDataSource = function (n, t) {
    if (this.m_dataSources.contains(n)) {
        n._isOverlay = !1;
        this.m_dataSources.remove(n);
        n !== this.m_mainDataSource || t || (this.m_mainDataSource = null);
        var i = null;
        this.m_leftPriceScale.Q19().contains(n) ? (this.m_leftPriceScale.removeDataSource(n), i = this.m_leftPriceScale) : this.m_rightPriceScale.Q19().contains(n) && (this.m_rightPriceScale.removeDataSource(n), i = this.m_rightPriceScale);
        n.onTagsChanged && n.onTagsChanged().unsubscribe(this, J75.prototype.onSourceTagsChanged);
        isInherited(n.constructor, PriceDataSource) && this._processMainSourceChange();
        n instanceof TradingView.AlertLabel || this.Q0.mainSeries() !== n || this.updateAlertLabelsSources();
        this._tagsChanged.fire();
        i && isInherited(n.constructor, PriceDataSource) && this.recalculatePriceScale(i);
        this.invalidateSourcesCache()
    } else TradingView.logDebug("removeDataSource: invalid data source")
};
J75.prototype.updateAlertLabelsSources = function () {
    for (var n, t, f, e, r = this.containsMainSeries(), u = this.Q0.alertsList(), o = new List($.grep(this.Q19().toArray(), function (n) {
        return n instanceof TradingView.AlertLabel
    })), i = u.size() - 1; 0 <= i; i--)n = u.item(i), t = o.find(function (t) {
        return t.id() === n.id()
    }), t || !r && n.isOHLC() || (f = new TradingView.AlertLabel(this.Q0, n), e = this.rightPriceScale() || this.leftPriceScale(), this.addDataSource(f, e)), t && !r && n.isOHLC() && this.removeDataSource(new TradingView.AlertLabel(t))
};
J75.prototype.startScalePrice = function (n, t) {
    n.startScale(t)
};
J75.prototype.scalePriceTo = function (n, t) {
    n.scaleTo(t);
    this.updateAllViews()
};
J75.prototype.endScalePrice = function (n) {
    n.endScale()
};
J75.prototype.startScrollPrice = function (n, t) {
    n.startScroll(t)
};
J75.prototype.scrollPriceTo = function (n, t) {
    n.scrollTo(t);
    this.updateAllViews()
};
J75.prototype.endScrollPrice = function (n) {
    n.endScroll()
};
J75.prototype.setPriceAutoScale = function (n, t) {
    n.setAutoScale(t);
    this.timeScale().isEmpty() ? n.setPriceRange(null) : this.recalculatePriceScale(n)
};
J75.prototype.restorePriceScaleState = function (n, t) {
    n.restoreState(t);
    this.updateAllViews()
};
J75.prototype.updateAllViews = function () {
    for (var n = 0; n < this.Q19().size(); n++)this.Q19().item(n).updateAllViews()
};
J75.prototype.defaultPriceScale = function () {
    if (!this.m_mainDataSource)var n = this.rightPriceScale();
    return this.m_mainDataSource && (n = this.m_mainDataSource.priceScale()), void 0 == n && (props = new Property(this.Q2.overlayPropreties.state()), n = new J76(props)), n
};
J75.prototype._priceScaleIsPrice = function (n) {
    return(n = n.mainSource()) ? isInherited(n.constructor, TradingView.Series) ? !0 : isInherited(n.constructor, TradingView.Study) ? n.metaInfo().is_price_study : !1 : !1
};
J75.prototype.findSuitableScale = function (n) {
    var t = !1;
    if (isInherited(n.constructor, TradingView.Study) ? t = n.metaInfo().is_price_study : isInherited(n.constructor, TradingView.Series) && (t = !0), t) {
        if (this._priceScaleIsPrice(this.m_rightPriceScale))return this.m_rightPriceScale;
        if (this._priceScaleIsPrice(this.m_leftPriceScale))return this.m_leftPriceScale
    }
    return this.m_rightPriceScale.mainSource() ? this.m_leftPriceScale.mainSource() ? null : this.m_leftPriceScale : this.m_rightPriceScale
};
J75.prototype.mainDataSource = function () {
    return this.m_mainDataSource
};
J75.prototype.recalculatePriceScale = function (n) {
    if (n) {
        if (n.isAutoScale() && !this.timeScale().isEmpty()) {
            var t = this.timeScale().visibleBars();
            n.recalculatePriceRange(t)
        }
        n.updatePaneViews()
    }
};
J75.prototype.resetPriceScale = function (n) {
    var t = this.timeScale().visibleBars();
    n.mainSource()instanceof TradingView.Series && n.mainSource().isLockScale() || n.setAutoScale(!0);
    n.recalculatePriceRange(t);
    this.updateAllViews()
};
J75.prototype._recalculateImpl = function () {
    var n, t;
    if (this._needRecalc) {
        for (this.recalculatePriceScale(this.m_rightPriceScale), this.recalculatePriceScale(this.m_leftPriceScale), n = 0; n < this.m_dataSources.size(); n++)t = this.m_dataSources.item(n), this.isOverlay(t) && this.recalculatePriceScale(t.priceScale());
        this.updateAllViews();
        this.Q0.updatePane(this);
        this._needRecalc = !1
    }
};
J75.prototype.recalculate = function (n) {
    this._needRecalc = !0;
    n && this._recalculateImpl()
};
J75.prototype.isEmpty = function () {
    return null === this.m_mainDataSource
};
J75.prototype.move = function (n, t) {
    var i = this.m_dataSources.clone();
    this.removeDataSource(n, null !== t);
    this.addDataSource(n, t);
    this.m_dataSources = i;
    this.invalidateSourcesCache()
};
J75.prototype.dataSourceForId = function (n) {
    for (var t = 0; t < this.m_dataSources.size(); t++)if (this.m_dataSources.item(t).id() === n)return this.m_dataSources.item(t);
    return null
};
J75.prototype.priceScaleForSource = function (n) {
    return this.rightPriceScale().Q19().contains(n) ? this.rightPriceScale() : this.leftPriceScale().Q19().contains(n) ? this.leftPriceScale() : null
};
J75.prototype.sourceById = function (n) {
    for (var t = 0; t < this.m_dataSources.size(); t++)if (this.m_dataSources.item(t).id() === n)return this.m_dataSources.item(t);
    return null
};
J75.prototype.containsMainSeries = function () {
    return this.m_dataSources.contains(this.Q0.mainSeries())
};
J75.prototype.priceScaleByName = function (n) {
    return"left" === n ? this.m_leftPriceScale : "right" === n ? this.m_rightPriceScale : null
};
J75.prototype.priceScaleName = function (n) {
    return n === this.m_leftPriceScale ? "left" : n === this.m_rightPriceScale ? "right" : ""
};
J75.prototype.hitTestSources = function () {
    var n;
    if (this._cachedHitTestSources)return this._cachedHitTestSources;
    for (var i = this.orderedSources(), r = [], u = [], t = 0; t < i.length; t++)n = i[t], isInherited(n.constructor, J47) ? r.push(n) : u.push(n);
    return this._cachedHitTestSources = u.concat(r)
};
J75.prototype.orderedSources = function () {
    var n;
    if (this._cachedOrderedSoruces)return this._cachedOrderedSoruces;
    for (var t = [], i = 0, r = this.Q19().size(); i < r; i++)n = this.Q19().item(i), isInherited(n.constructor, J47) && !n.isActualSymbol() || t.push(n);
    return this._cachedOrderedSoruces = t = J75.sortSources(t)
};
J75.prototype.invalidateSourcesCache = function () {
    this._cachedHitTestSources = this._cachedOrderedSoruces = null;
    this.m_leftPriceScale.invalidateSourcesCache();
    this.m_rightPriceScale.invalidateSourcesCache()
};
J75.prototype.getZOrderMinMax = function () {
    for (var n, u = this.orderedSources(), t = Number.MAX_VALUE, i = -Number.MAX_VALUE, r = 0; r < u.length; r++)n = u[r], n.showInObjectTree() && (n.zorder() < t && (t = n.zorder()), n.zorder() > i && (i = n.zorder()));
    return{minZOrder: t, maxZOrder: i}
};
J75.prototype.sendToBack = function (n) {
    for (var t = this.getZOrderMinMax().minZOrder, t = Math.abs(n.zorder() - t), i = 0; i < t; i++)this.changeZOrder(n, -1)
};
J75.prototype.bringToFront = function (n) {
    for (var t = this.getZOrderMinMax().maxZOrder, t = Math.abs(n.zorder() - t), i = 0; i < t; i++)this.changeZOrder(n, 1)
};
J75.prototype.changeZOrder = function (n, t) {
    for (var r = this.orderedSources().filter(function (n) {
        return n.showInObjectTree()
    }), u = 0, i = 0, f = r.length; i < f; i++)if (r[i] === n) {
        u = i;
        break
    }
    0 < u && 0 > t ? (f = r[u - 1].zorder(), i = n.zorder(), r[u - 1].setZorder(i), n.setZorder(f)) : u < r.length - 1 && 0 < t && (f = r[u + 1].zorder(), i = n.zorder(), r[u + 1].setZorder(i), n.setZorder(f));
    this.invalidateSourcesCache()
};
J75.prototype.onSourceTagsChanged = function () {
    this._tagsChanged.fire()
};
J75.prototype.onTagsChanged = function () {
    return this._tagsChanged
};
J75.prototype.dumpPriceScale = function (n) {
    for (var r, i = new List, u = n.Q19().clone(), t = 0; t < u.size(); ++t)r = u.item(t).priceAxisViews(this, n), r && i.appendAll(r);
    for (n = [], t = 0; t < i.size(); t++)n.push(i.item(t).dump());
    return n
};
J75.prototype.dumpViews = function () {
    for (var i, r, t = {paneViews: {}}, u = this.orderedSources(), n = 0; n < u.length; n++)if (i = u[n], t.paneViews[n] = [], i = i.paneViews())for (r = 0; r < i.size(); r++)t.paneViews[n].push(i.item(n).dump());
    return t.leftAxis = this.dumpPriceScale(this.m_leftPriceScale), t.rightAxis = this.dumpPriceScale(this.m_rightPriceScale), t
};
J75.prototype.clearSeries = function () {
    for (var n = this.m_dataSources.size() - 1; 0 <= n; n--)isInherited(this.m_dataSources.item(n).constructor, TradingView.Series) && this.m_dataSources.removeAt(n)
};
J75.prototype.actionNoScaleIsEnabled = function (n) {
    return this.isOverlay(n) || !isInherited(n.constructor, PriceDataSource) ? !0 : 1 < this.Q19().count(function (n) {
        return n.properties().linkedToSeries && n.properties().linkedToSeries.value() ? !1 : isInherited(n.constructor, PriceDataSource) && n.showInObjectTree() && !n.isNoScale()
    })
};
J75.prototype.executionsPositionController = function () {
    return this._executionsPositionController || (this._executionsPositionController = new ExecutionsPositionController(this, this.Q0.timeScale())), this._executionsPositionController
};
J56.prototype.draw = function (n) {
    var r, i, t;
    for (n.save(), n.translate(.5, .5), i = 0; i < this.bars.size(); ++i)t = this.bars.item(i), r !== t.color && (r = n.fillStyle = t.color), n.fillRect(Math.round(t.time - this.barLineWidth / 2), Math.round(t.high - this.barWidth / 2), Math.round(this.barLineWidth), Math.round(t.low - t.high + this.barWidth)), this.barLineWidth < this.barSpacing - 1 && (this.dontDrawOpen || n.fillRect(Math.round(t.time - 1.5 * this.barWidth), Math.round(t.open - this.barWidth / 2), Math.round(1.5 * this.barWidth), Math.round(this.barWidth)), n.fillRect(Math.round(t.time), Math.round(t.close - this.barWidth / 2), Math.round(1.5 * this.barWidth), Math.round(this.barWidth)));
    n.restore()
};
J56.prototype.hitTest = function (n) {
    var t = this.bars, u = .5 * this.barSpacing, i, r, f;
    if (t.isEmpty() || n.x < t.first().time - u || n.x > t.last().time + u)return null;
    for (i = null, r = 0; r < t.size(); ++r)if (f = t.item(r), n.x <= f.time + u) {
        i = f;
        break
    }
    return t = selectionTolerance(this.barLineWidth), i && i.high - t <= n.y && n.y <= i.low + t ? new HitTestResult(HitTestResult.REGULAR) : null
};
J70.prototype.draw = function (n) {
    var r, i, t;
    for (n.save(), n.lineCap = "butt", n.translate(.5, .5), n.lineWidth = this.barLineWidth, r = this.barWidth / 2, i = 0; i < this.bars.size(); ++i) {
        t = this.bars.item(i);
        var u = t.exactTime - r, f = t.exactTime + r - u, e = Math.round(t.high), o = 0 == t.low - t.high ? 1 : Math.round(t.low - t.high);
        n.fillStyle = t.borderColor;
        n.fillRect(u, e, f, o);
        n.fillStyle = t.color;
        n.fillRect(u + this.barLineWidth, e + this.barLineWidth, f - 2 * this.barLineWidth, o - 2 * this.barLineWidth)
    }
    n.restore()
};
J70.prototype.hitTest = function (n) {
    var t = this.bars, u = .5 * this.barWidth, i, r, f;
    if (t.isEmpty() || n.x < t.first().time - u || n.x > t.last().time + u)return null;
    for (i = null, r = 0; r < t.size(); ++r)if (f = t.item(r), n.x <= f.time + u) {
        i = f;
        break
    }
    return t = selectionTolerance(this.barLineWidth), i && i.high - t <= n.y && n.y <= i.low + t ? new HitTestResult(HitTestResult.REGULAR) : null
};
J67.prototype.draw = function (n) {
    var r, t, i;
    for (n.save(), n.lineCap = "square", n.translate(.5, .5), r = 0; r < this.bars.size(); ++r)t = this.bars.item(r), i = Math.round(.5 * this.barLineWidth), t.isTwoColorBar ? (n.fillStyle = t.upColor, n.fillRect(Math.round(t.exactTime - i), Math.round(t.high - i), Math.round(2 * i), Math.round(t.additionalPrice - t.high + i)), n.fillStyle = t.downColor, n.fillRect(Math.round(t.exactTime - i), Math.round(t.additionalPrice), Math.round(2 * i), Math.round(t.low - t.additionalPrice + i))) : (n.fillStyle = t.color, n.fillRect(Math.round(t.exactTime - i), Math.round(t.high - i), Math.round(2 * i), Math.round(t.low - t.high) + 2 * i)), t.combinedWithProjection || (n.fillStyle = t.isTwoColorBar ? t.isUp ? t.downColor : t.upColor : t.color, n.fillRect(Math.round(t.exactTime - this.barSpacing + i), Math.round(t.open - i), Math.round(this.barSpacing - 2 * i + 1), Math.round(2 * i)));
    n.restore()
};
J67.prototype.hitTest = function (n) {
    var t = this.bars, u = .5 * this.barLineWidth, i, r, f;
    if (t.isEmpty() || n.x < t.first().time - u || n.x > t.last().time + u)return null;
    for (i = null, r = 0; r < t.size(); ++r)if (f = t.item(r), n.x <= f.time + u) {
        i = f;
        break
    }
    return t = selectionTolerance(.5 * this.barLineWidth), i && i.high - t <= n.y && n.y <= i.low + t ? new HitTestResult(HitTestResult.REGULAR) : null
};
J69.prototype.draw = function (n) {
    var r, i, t;
    for (n.save(), n.lineCap = "butt", n.translate(.5, .5), r = 0; r < this.bars.size(); ++r) {
        for (bar = this.bars.item(r), i = (bar.low - bar.high) / bar.additionalNum, n.beginPath(), t = 0; t < bar.additionalNum; t++)bar.isUp ? (n.moveTo(Math.round(bar.time - .5 * this.barWidth) + .5, bar.high + t * i), n.lineTo(Math.round(bar.time + .5 * this.barWidth) - .5, bar.high + (t + 1) * i), n.moveTo(Math.round(bar.time + .5 * this.barWidth) - .5, bar.high + t * i), n.lineTo(Math.round(bar.time - .5 * this.barWidth) + .5, bar.high + (t + 1) * i)) : this.drawEllipse(n, bar.time - .45 * this.barWidth + .5, bar.high + t * i, Math.round(.9 * this.barWidth), Math.round(i));
        n.strokeStyle = bar.color;
        n.lineWidth = 1;
        n.stroke()
    }
    n.restore()
};
J69.prototype.drawEllipse = function (n, t, i, r, u) {
    n.save();
    n.translate(t + r / 2, i + u / 2);
    n.scale(r / 2, u / 2);
    n.moveTo(1, 0);
    n.arc(0, 0, .95, 0, 2 * Math.PI, !1);
    n.restore()
};
J69.prototype.hitTest = function (n) {
    var t = this.bars, u = .5 * this.barSpacing, i, r, f;
    if (t.isEmpty() || n.x < t.first().time - u || n.x > t.last().time + u)return null;
    for (i = null, r = 0; r < t.size(); ++r)if (f = t.item(r), n.x <= f.time + u) {
        i = f;
        break
    }
    return t = selectionTolerance(this.barWidth), i && i.high - t <= n.y && n.y <= i.low + t ? new HitTestResult(HitTestResult.REGULAR) : null
};
J66.prototype.draw = function (n) {
    var i, r;
    for (n.translate(.5, .5), n.fillStyle = this.lineColor, i = this.lineWidth, r = 0; r < this.items.size(); ++r) {
        var t = this.items.item(r), f = t.x, u = t.y;
        t.style && (n.fillStyle = t.style.color, i = t.style.width);
        n.fillRect(Math.round(f - .5 * i), u, i, this.histogramBase - u)
    }
};
J66.prototype.hitTest = function (n) {
    for (var u = selectionTolerance(this.lineWidth), t, i, r = 0; r < this.items.size(); ++r)if (t = this.items.item(r), i = t.x, t = t.y, i = MathEx.distanceToSegment(new MathEx.Point(i, t), new MathEx.Point(i, this.histogramBase), new MathEx.Point(n.x, n.y)), i.distance <= u)return new HitTestResult(HitTestResult.REGULAR);
    return null
};
J60.prototype.draw = function (n) {
    if (0 !== this.items.size()) {
        n.translate(.5, .5);
        for (var h = this.lineColor, u = this.histogramBase, e = u, s, o = 0; o < this.items.size(); ++o) {
            var r = this.items.item(o), i = Math.ceil(r.x - .5 * this.barSpacing), f = Math.ceil(i + this.barSpacing), t = r.y, r = r.style ? r.style.color : h;
            s !== r && (s = r, n.fillStyle = r);
            n.fillRect(i, t, f - i, u - t);
            2 >= this.barSpacing ? n.fillRect(i, t, f - i, u - t) : (n.beginPath(), t < e && n.rect(i, t, 1, e - t), n.rect(f - 1, t, 1, u - t), n.rect(i, t, f - i, 1), n.fill(), e = t)
        }
    }
};
J60.prototype.hitTest = function (n) {
    for (var t, i = .5 * this.barSpacing + this.lineWidth, f = n.x - i, i = n.x + i, r = this.items.toArray(), u = r.length; u--;)if (t = r[u].x, t >= f && t <= i && (t = r[u].y, n.y >= Math.min(t, this.histogramBase) && n.y <= Math.max(t, this.histogramBase)))return new HitTestResult(HitTestResult.REGULAR);
    return null
};
J68.prototype.draw = function (n) {
    n.lineCap = "square";
    n.lineJoin = this.withMarkers ? "round" : "miter";
    n.strokeStyle = this.lineColor;
    n.fillStyle = this.lineColor;
    n.lineWidth = this.lineWidth;
    n.lineStyle = this.lineStyle;
    this._simpleMode ? this._drawSimpleMode(n) : this._drawLines(n)
};
J68.prototype._drawSimpleMode = function (n) {
    if (n.beginPath(), this.walkLine(n, this.items.toArray()), n.stroke(), this.withMarkers) {
        i = this.items.size();
        var r = this.lineWidth + 2, u = 2 * Math.PI, t;
        for (n.beginPath(); i--;)(t = this.items.item(i)) && (n.moveTo(t.x, t.y), n.arc(t.x, t.y, r, 0, u));
        n.fill()
    }
};
J68.prototype.walkLine = function (n, t, i, r) {
    if (t) {
        for (var s = .25 * this.barSpacing, h, u, l, o, c = paneRendererCoordinateIsValid, e = 0, a = t.length; e < a; e++)if (o = t[e], c(o.y)) {
            u = o;
            h = e;
            break
        }
        if ("undefined" != typeof h && u)for (var f = this.withSteps && this.lineWidth && 0 == this.lineWidth % 2 ? .5 : 0, e = h, a = t.length; e < a; e++) {
            if (u = t[e], o = t[e + 1] || {}, c(u.y))if (l && c(l.y))this.withSteps && n.lineTo(l.x + f, u.y + f), n.lineTo(u.x + f, u.y + f), i && !c(o.y) && n.lineTo(u.x + f, r); else if (o && c(o.y))i ? (e != h && n.lineTo(u.x + f, r), n.lineTo(u.x + f, u.y + f)) : n.moveTo(u.x + f, u.y + f); else if (i) {
                if (0 === e)continue;
                e != h && n.lineTo(u.x - s + f, r);
                n.lineTo(u.x - s + f, u.y + f);
                n.lineTo(u.x + s + f, u.y + f);
                n.lineTo(u.x + s + f, r)
            } else n.moveTo(u.x - s + f, u.y + f), n.lineTo(u.x + s + f, u.y + f);
            l = u
        }
    }
};
J68.prototype._drawLines = function (n) {
    function c(t, i, r) {
        e(i.y) && (e(t.y) ? n.lineTo(i.x, i.y) : r && e(r.y) ? n.moveTo(i.x, i.y) : (n.moveTo(i.x - h, i.y), n.lineTo(i.x + h, i.y)))
    }

    var t, i, s, h, e, r, o, u, f;
    if (this.items.size()) {
        for (h = .25 * this.barSpacing, e = paneRendererCoordinateIsValid, n.beginPath(), (t = this.items.item(0)) && n.moveTo(t.x, t.y), r = 1; r < this.items.size(); ++r)t = this.items.item(r - 1), i = this.items.item(r), s = this.items.item(r + 1), i.style && !this.forceLineColor ? (o = i.style.color, u = i.style.width, f = i.style.style) : (o = this.lineColor, u = this.lineWidth, f = this.lineStyle), this.ignorePaletteLineWidth && (u = this.lineWidth), o.toLowerCase() != n.strokeStyle.toLowerCase() || u != n.lineWidth || f != n.lineStyle ? (n.stroke(), n.beginPath(), n.strokeStyle = o, n.lineWidth = u, n.lineStyle = f, f === CanvasEx.LINESTYLE_SOLID ? (n.moveTo(t.x, t.y), c(t, i, s)) : CanvasEx.drawLine(n, t.x, t.y, i.x, i.y)) : c(t, i, s);
        n.stroke()
    }
};
J68.prototype.hitTest = function (n) {
    for (var o = selectionTolerance(this.lineWidth), t, u, f, e, i = 0, r = this.items.size() - 1; 2 < r - i;)t = Math.round((r + i) / 2), this.items.item(t).x <= n.x ? i = t : r = t;
    for (i = Math.max(1, i - 1), r = Math.min(this.items.size() - 1, r + 1); i <= r; ++i)if (t = this.items.item(i - 1), u = this.items.item(i), f = t.x, e = u.x, t = MathEx.distanceToSegment(new MathEx.Point(f, t.y), new MathEx.Point(e, u.y), new MathEx.Point(n.x, n.y)), t.distance <= o)return this.hittest ? this.hittest : new HitTestResult(HitTestResult.REGULAR);
    return null
};
inherit(J53, J68);
J53.prototype.draw = function (n) {
    var i, u, r, f, t;
    if (0 !== this.items.size()) {
        for (n.lineCap = "square", n.strokeStyle = this.lineColor, n.lineWidth = this.lineWidth, n.lineStyle = this.lineStyle, n.lineWidth = 1, n.beginPath(), t = 0, u = this.items.size(); t < u; t++)if (r = this.items.item(t), paneRendererCoordinateIsValid(r.y)) {
            i = r;
            break
        }
        if (i) {
            for (n.moveTo(i.x, this.bottom), J68.prototype.walkLine.call(this, n, this.items.toArray(), !0, this.bottom), t = this.items.size() - 1; 0 <= t; t--)if (r = this.items.item(t), paneRendererCoordinateIsValid(r.y)) {
                f = r;
                break
            }
            n.moveTo(f.x, this.bottom);
            n.closePath();
            i = n.createLinearGradient(0, 0, 0, this.bottom);
            i.addColorStop(0, this.color1);
            i.addColorStop(1, this.color2);
            n.fillStyle = i;
            n.fill();
            n.lineWidth = this.lineWidth;
            J68.prototype.draw.call(this, n)
        }
    }
};
J57.prototype.draw = function (n) {
    var f = this._data.bars.clone(), t = this._data.barSpacing, i = this._data.drawWick, c = this._data.drawBorder, o = this._data.wickColor, r = this._barBorderWidth, s = this._barWidth, u = f.size(), e, l, h;
    if (n.lineCap = "square", n.lineStyle = this._data.lineStyle, 1 > t) {
        if (i) {
            for (n.strokeStyle = o, n.lineWidth = 1, n.beginPath(), u = f.size(); 0 < u--;)t = f.item(u), n.moveTo(t.time, t.low), n.lineTo(t.time, t.high);
            n.stroke()
        }
        for (n.lineWidth = 1, c = "", s = !1, n.beginPath(), u = f.size(); 0 < u--;)t = f.item(u), i = t.time, c !== t.color && (s && (n.stroke(), n.beginPath(), s = !1), c = n.strokeStyle = t.color), n.moveTo(t.time, t.open), n.lineTo(t.time, t.close), s = !0;
        s && n.stroke()
    } else {
        if (n.translate(.5, .5), n.lineWidth = r, f.sort(function (n, t) {
            return n.color > t.color ? 1 : -1
        }), i)for (n.fillStyle = o; 0 < u--;)t = f.item(u), i = t.time, r = t.open, e = t.high, l = t.low, h = t.close, o = Math.min(r, h), r = Math.max(r, h), t.hollow ? (n.fillRect(i, e, 1, o - e), n.fillRect(i, r, 1, l - r)) : n.fillRect(i, e, 1, l - e);
        if (c)for (u = f.size(); 0 < u--;)t = f.item(u), f.item(u + 1) && t.borderColor == f.item(u + 1).borderColor || (n.fillStyle = t.borderColor), t.hollow || (i = t.time, r = t.open, h = t.close, e = Math.round(i - s), i = Math.round(i + s), o = Math.min(r, h), r = Math.max(r, h), n.fillRect(e, o, i - e + 1, r - o + 1));
        for (u = f.size(); 0 < u--;)t = f.item(u), i = t.time, r = t.open, e = t.high, l = t.low, h = t.close, e = Math.round(i - s), i = Math.round(i + s), o = Math.min(r, h), r = Math.max(r, h), f.item(u + 1) && t.color == f.item(u + 1).color || (n.fillStyle = t.color, n.strokeStyle = t.color), t.hollow ? (n.translate(-.5, -.5), n.strokeRect(e + 1, o + 1, i - e, r - o), n.translate(.5, .5)) : (c && (e += 1, o += 1, --i, --r), n.fillRect(e, o, i - e + 1, r - o + 1))
    }
};
J57.prototype.hitTest = function (n) {
    var t = this._data.bars, u = .5 * this._data.barSpacing, i, r, f;
    if (t.isEmpty() || n.x < t.first().time - u || n.x > t.last().time + u)return null;
    for (i = null, r = 0; r < t.size(); ++r)if (f = t.item(r), n.x <= f.time + u) {
        i = f;
        break
    }
    return t = selectionTolerance(this._barBorderWidth), i && i.high - t <= n.y && n.y <= i.low + t ? new HitTestResult(HitTestResult.REGULAR) : null
};
J61.prototype.draw = function (n) {
    for (var i = this.lineWidth, r = 3 * this.lineWidth, s, u = !1, f = 0; f < this.items.size(); ++f) {
        var t = this.items.item(f), e = t.x, o = t.y;
        isNaN(e) || isNaN(o) || (t = null != t.style ? t.style.color : this.lineColor, t !== s && (s = t, u && n.fill(), n.beginPath(), n.fillStyle = t), n.rect(e - r / 2, o - i / 2, r, i), n.rect(e - i / 2, o - r / 2, i, r), u = !0)
    }
    u && n.fill()
};
J61.prototype.hitTest = function (n) {
    for (var e = selectionTolerance(this.lineWidth), t, r, u, f, i = 1; i < this.items.size(); ++i)if (t = this.items.item(i - 1), r = this.items.item(i), u = t.x, f = r.x, t = MathEx.distanceToSegment(new MathEx.Point(u, t.y), new MathEx.Point(f, r.y), new MathEx.Point(n.x, n.y)), t.distance <= e)return new HitTestResult(HitTestResult.REGULAR);
    return null
};
J58.prototype.draw = function (n) {
    for (var s = 2 * Math.PI, e = this.radius, o, i = !1, r = 0; r < this.items.size(); ++r) {
        var t = this.items.item(r), u = t.x, f = t.y + this.vertOffset;
        isNaN(u) || isNaN(f) || (t = null != t.style ? t.style.color : this.lineColor, t !== o && (o = t, i && n.fill(), n.beginPath(), n.fillStyle = t), n.moveTo(u + e, f), n.arc(u, f, e, 0, s, !1), i = !0)
    }
    i && n.fill()
};
J58.prototype.hitTest = function (n) {
    for (var t, r = this.vertOffset, u = selectionTolerance(2 * this.radius), i = 0; i < this.items.size(); ++i)if (t = this.items.item(i), t && (offsettedPoint = new MathEx.Point(t.x, t.y + r), offsettedPoint.substract(n).length() + this.radius <= u))return new HitTestResult(HitTestResult.REGULAR);
    return null
};
inherit(PaneRendererArrowsUpDownItem, MathEx.Point);
J54.prototype._calculateVerticalOffset = function (n) {
    return Math.round((n || 0) / 4)
};
J54.prototype._calculateMinHeight = function (n) {
    return this.width || this._calculateWidth(n)
};
J54.prototype._calculateWidth = function (n) {
    return n = n || this.barSpacing, Math.round(n / 2)
};
J54.prototype.draw = function (n) {
    var f = this.width, c = 4 > f, l = Math.max(parseInt(f / 2), 1), i = Math.round(this.width / 2), e = Math.round(this.width), o, s;
    for (n.translate(1, 1), o = 0, s = this.items.size(); o < s; o++) {
        var u = this.items.item(o), t = u.isUp ? -1 : 1, r = Math.abs(u.height), h = u.y - t * this.vertOffset;
        n.beginPath();
        n.translate(u.x, h);
        c ? (n.moveTo(0, 0), n.lineTo(-i, -i * t), n.moveTo(0, 0), n.lineTo(i, -i * t), n.moveTo(0, 0), n.lineTo(0, -r * t), n.moveTo(-i, -r * t), n.lineTo(i, -r * t), n.lineWidth = l, n.strokeStyle = u.isUp ? this.colorUp : this.colorDn, n.stroke()) : (n.moveTo(0, 0), r < e ? (n.lineTo(f, -r * t), n.lineTo(-f, -r * t)) : (n.lineTo(f, -e * t), n.lineTo(i, -e * t), n.lineTo(i, -r * t), n.lineTo(-i, -r * t), n.lineTo(-i, -e * t), n.lineTo(-f, -e * t)), n.lineTo(0, 0), n.strokeStyle = this.colorBorder, n.stroke(), n.fillStyle = u.isUp ? this.colorUp : this.colorDn, n.fill());
        n.translate(-u.x, -h)
    }
    n.translate(-1, -1)
};
J54.prototype.hitTest = function (n) {
    for (var t, e = Math.round(this.width / 2), o = Math.round(this.width), i = 0; i < this.items.size(); ++i)if (t = this.items.item(i), t && void 0 !== t.x && null !== t.x && !isNaN(t.x) && void 0 !== t.y && null !== t.y && !isNaN(t.y)) {
        var r = Math.abs(t.height), u = t.isUp ? -1 : 1, f = t.y - u * this.vertOffset, r = f - u * (r + o), u = t.x + e;
        if (t.x - e < n.x && n.x < u && (t.isUp ? f < n.y && n.y < r : r < n.y && n.y < f))return new HitTestResult(HitTestResult.REGULAR)
    }
};
J73.prototype.draw = function (n) {
    var i, u, t;
    n.font = this.height + "px Arial";
    var r = n.measureText(this.ch), f = this.height / 2, r = r.width / 2;
    for (n.translate(1, 1), i = 0, u = this.items.size(); i < u; i++)t = this.items.item(i), newFillStyle = void 0 != t.style ? t.style.color : this.color, n.fillStyle = newFillStyle, n.fillText(this.ch, t.x - r, t.y + this.vertOffset + f);
    n.translate(-1, -1)
};
J73.prototype.hitTest = function (n) {
    for (var t, r = this.vertOffset, u = selectionTolerance(this.height), i = 0; i < this.items.size(); ++i)if (t = this.items.item(i), t && (offsettedPoint = new MathEx.Point(t.x, t.y + r), offsettedPoint.substract(n).length() <= u))return new HitTestResult(HitTestResult.REGULAR);
    return null
};
J52.prototype.draw = function () {
    throw Error("Not implemented");
};
J52.prototype.hitTest = function (n, t) {
    var u = Math.max(this.height, this.width), f = this.vertOffset, i, r;
    for (t = t || HitTestResult.REGULAR, r = 0; r < this.items.size(); ++r)if ((i = this.items.item(r)) && (i = new MathEx.Point(i.x, i.y + f), i = i.substract(n).length(), i <= u))return new HitTestResult(t);
    return null
};
inherit(J74, J52);
J74.prototype.draw = function (n) {
    var t, r;
    n.lineWidth = 2;
    for (var u = this.width, f = this.height, s = this.vertOffset, o, i = !1, e = 0, h = this.items.size(); e < h; e++)t = this.items.item(e), r = null != t.style ? t.style.color : this.color, r !== o && (o = r, i && n.stroke(), n.beginPath(), n.strokeStyle = r), i = t.x - u / 2, t = t.y - f / 2 + s, n.moveTo(i, t), n.lineTo(i + u, t + f), n.moveTo(i, t + f), n.lineTo(i + u, t), i = !0;
    i && n.stroke()
};
inherit(J72, J52);
J72.prototype.draw = function (n) {
    for (var t, r, e = this.width, u = this.height, o = Math.round(u / 3), o = this.vertOffset - 2 * o, s, i = !1, f = 0, h = this.items.size(); f < h; f++)t = this.items.item(f), r = null != t.style ? t.style.color : this.color, r !== s && (s = r, i && n.fill(), n.beginPath(), n.fillStyle = r), i = t.x, t = t.y + o, n.moveTo(i, t), n.lineTo(i + e / 2, t + u), n.lineTo(i - e / 2, t + u), n.lineTo(i, t), i = !0;
    i && n.fill()
};
inherit(J71, J52);
J71.prototype.draw = function (n) {
    for (var t, r, u = this.width, e = this.height, o = Math.round(e / 3), o = this.vertOffset - o, s, i = !1, f = 0, h = this.items.size(); f < h; f++)t = this.items.item(f), r = null != t.style ? t.style.color : this.color, r !== s && (s = r, i && n.fill(), n.beginPath(), n.fillStyle = r), i = t.x - u / 2, t = t.y + o, n.moveTo(i, t), n.lineTo(i + u, t), n.lineTo(i + u / 2, t + e), n.lineTo(i, t), i = !0;
    i && n.fill()
};
inherit(PaneRendererTriangleApexLeft, J52);
PaneRendererTriangleApexLeft.prototype.draw = function (n) {
    for (var t, r, e = this.width, u = this.height, s = this.vertOffset, o, i = !1, f = 0, h = this.items.size(); f < h; f++)t = this.items.item(f), r = null != t.style ? t.style.color : this.color, r !== o && (o = r, i && n.fill(), n.beginPath(), n.fillStyle = r), i = t.x + e / 2, t = t.y - u / 2 + s, n.moveTo(i, t), n.lineTo(i, t + u), n.lineTo(i - e, t + u / 2), n.lineTo(i, t), i = !0;
    i && n.fill()
};
inherit(J64, J52);
J64.prototype.draw = function (n) {
    for (var t, e, u = this.width, o = this.height, f = o / 2, c = this.vertOffset, r = (u - 3) / 3, h, i = !1, s = 0, l = this.items.size(); s < l; s++)t = this.items.item(s), e = null != t.style ? t.style.color : this.color, e !== h && (h = e, i && n.fill(), n.beginPath(), n.fillStyle = e), i = t.x - u / 2, t = t.y - f + c, n.moveTo(i, t), n.lineTo(i + 3, t), n.bezierCurveTo(i + r, t - r, i + 2 * r, t + r, i + u, t), n.lineTo(i + u, t + f), n.bezierCurveTo(i + u - r, t + f + r, i + u - 2 * r, t + f - r, i + 3, t + f), n.lineTo(i + 3, t + o), n.lineTo(i, t + o), i = !0;
    i && n.fill()
};
inherit(J63, J52);
J63.prototype.draw = function (n) {
    var t, f;
    n.lineWidth = 2;
    for (var r = this.width, u = this.height, s = this.vertOffset, o, i = !1, e = 0, h = this.items.size(); e < h; e++)t = this.items.item(e), f = null != t.style ? t.style.color : this.color, f !== o && (o = f, i && n.stroke(), n.beginPath(), n.strokeStyle = f), i = t.x - r / 2, t = t.y - u / 2 + s, n.moveTo(i + r / 2, t), n.lineTo(i + r / 2, t + u), n.moveTo(i, t + u / 2), n.lineTo(i + r, t + u / 2), i = !0;
    i && n.stroke()
};
inherit(J59, J52);
J59.prototype.draw = function (n) {
    for (var t, r, f = Math.max(this.width, this.height) / 2, o = this.vertOffset, s = 2 * Math.PI, e, i = !1, u = 0, h = this.items.size(); u < h; u++)t = this.items.item(u), r = null != t.style ? t.style.color : this.color, r !== e && (e = r, i && n.fill(), n.beginPath(), n.fillStyle = r), i = t.x, t = t.y + o, n.moveTo(i + f, t), n.arc(i, t, f, 0, s, !1), i = !0;
    i && n.fill()
};
J55.prototype.draw = function () {
};
J55.prototype.drawBackground = function (n) {
    var t, i, r;
    for (n.save(), "undefined" == typeof FlashCanvas && n.translate(-.5, -.5), t = 0; t < this._items.size(); ++t)i = this._items.item(t), void 0 != i.color && (n.fillStyle = i.color, r = t == this._items.size() - 1 ? this._w : this._items.item(t + 1).x - i.x, n.fillRect(i.x, this._y, r, this._h));
    n.restore()
};
J55.prototype.hitTest = function () {
    return null
};
PriceRange.prototype.clone = function () {
    return new PriceRange(this.m_minValue, this.m_maxValue)
};
PriceRange.prototype.minValue = function () {
    return this.m_minValue
};
PriceRange.prototype.maxValue = function () {
    return this.m_maxValue
};
PriceRange.prototype.length = function () {
    return this.m_maxValue - this.m_minValue
};
PriceRange.prototype.isEmpty = function () {
    return this.m_maxValue === this.m_minValue || this.m_maxValue != this.m_maxValue || this.m_minValue != this.m_minValue
};
PriceRange.prototype.merge = function (n) {
    return new PriceRange(Math.min(this.minValue(), n.minValue()), Math.max(this.maxValue(), n.maxValue()))
};
PriceRange.prototype.apply = function (n, t) {
    this.m_minValue = Math.min(this.m_minValue, n);
    this.m_maxValue = Math.max(this.m_maxValue, t)
};
PriceRange.prototype.scaleAroundCenter = function (n) {
    if (isNumber(n)) {
        if (0 != this.m_maxValue - this.m_minValue) {
            var t = .5 * (this.m_maxValue + this.m_minValue), i = this.m_maxValue - t, r = this.m_minValue - t;
            this.m_maxValue = t + i * n;
            this.m_minValue = t + r * n
        }
    } else TradingView.logDebug("PriceRange.scaleAroundCenter: invalid coeff")
};
PriceRange.prototype.shift = function (n) {
    isNumber(n) ? (this.m_maxValue += n, this.m_minValue += n) : TradingView.logDebug("PriceRange.shift: invalid coeff")
};
PriceRange.prototype.convertToPercent = function (n, t) {
    return 100 * (n - t) / t
};
PriceRange.prototype.convertFromPercent = function (n, t) {
    return n / 100 * t + t
};
PriceRange.prototype.convertToPercents = function (n) {
    return new PriceRange(100 * (this.m_minValue - n) / n, 100 * (this.m_maxValue - n) / n)
};
PriceRange.prototype.convertFromPercents = function (n) {
    return new PriceRange(this.m_minValue / 100 * n + n, this.m_maxValue / 100 * n + n)
};
PriceTickSpanCalculator.prototype.TICK_SPAN_EPSILON = 1e-9;
PriceTickSpanCalculator.prototype.tickSpan = function (n, t, i) {
    var f = 0 === this.m_base ? 0 : 1 / this.m_base, r = this.TICK_SPAN_EPSILON, u;
    for (n = Math.pow(10, Math.max(0, Math.ceil(MathEx.log10(n - t)))), t = 0, t = 0, u = this.m_integralDividers[0]; n > f + r && MathEx.greaterOrEqual(n, f, r) && MathEx.greaterOrEqual(n, i * u, r) && MathEx.greaterOrEqual(n, 1, r); ++t, u = this.m_integralDividers[t % this.m_integralDividers.length])n /= u;
    if (n <= f + r && (n = f), n = Math.max(1, n), 0 < this.m_fractionalDividers.length && MathEx.equal(n, 1, r))for (t = 0, u = this.m_fractionalDividers[0]; n > f + r && MathEx.greaterOrEqual(n, i * u, r); ++t, u = this.m_fractionalDividers[t % this.m_fractionalDividers.length])n /= u;
    return n
};
PriceTickMarkBuilder.prototype.TICK_DENSITY = 2;
PriceTickMarkBuilder.prototype.base = function () {
    return this.m_base
};
PriceTickMarkBuilder.prototype.setBase = function (n) {
    if (0 > n)throw new RangeError("base < 0");
    this.m_base = n
};
PriceTickMarkBuilder.prototype.fontHeight = function () {
    return this.m_fontHeight
};
PriceTickMarkBuilder.prototype.setFontHeight = function (n) {
    this.m_fontHeight !== n && (this.m_fontHeight = n)
};
PriceTickMarkBuilder.prototype.tickSpan = function (n, t) {
    if (n < t)throw new RangeError("high < low");
    var i = this.m_priceScale.height(), u = this.tickMarkHeight(), i = (n - t) * u / i, u = new PriceTickSpanCalculator(this.m_base, [2, 2.5, 2]), f = new PriceTickSpanCalculator(this.m_base, [2, 2, 2.5]), e = new PriceTickSpanCalculator(this.m_base, [2.5, 2, 2]), r = [];
    return r.push(u.tickSpan(n, t, i)), r.push(f.tickSpan(n, t, i)), r.push(e.tickSpan(n, t, i)), MathEx.min(r)
};
PriceTickMarkBuilder.prototype.tickMarkHeight = function () {
    return this.m_fontHeight * this.TICK_DENSITY
};
PriceTickMarkBuilder.prototype.rebuildTickMarks = function () {
    var u, n;
    if (null === this.m_priceScale)throw new TypeError("scale is null");
    if (this.m_priceScale.isEmpty())this.m_marks = []; else {
        var f = this._formatter, e = this.m_priceScale.height(), t = this.m_priceScale.coordinateToPrice(e - 1), n = this.m_priceScale.coordinateToPrice(0), e = n >= t ? 1 : -1, r = Math.max(n, t), t = Math.min(n, t), n = r;
        if (n != t) {
            var r = this.tickSpan(n, t), i = n % r, i = i + (0 > i ? r : 0);
            for (this.m_marks = [], f || (f = new PriceFormatter(calculateBaseForTickSpan(r))), u = null, n = n - i; n > t; n -= r)i = this.m_priceScale.priceToCoordinate(n), null !== u && Math.abs(i - u) < this.tickMarkHeight() || (u = new TickMark(i, f.format(n), 0), this.m_marks.push(u), u = i, this.m_priceScale.isLog() && (r = this.tickSpan(n * e, t)))
        }
    }
};
PriceTickMarkBuilder.prototype.marks = function () {
    return this.m_marks
};
J76.prototype.isLog = function () {
    return this.Q2.log.value()
};
J76.prototype.isPercent = function () {
    return this.Q2.percentage.value()
};
J76.prototype.properties = function () {
    return this.Q2
};
J76.prototype.height = function () {
    return this.m_height
};
J76.prototype.setHeight = function (n) {
    var t = this.m_height;
    this.m_height = n;
    this._internalHeightCache = void 0;
    this._marksCache = null;
    t != n && this.mainSource()instanceof TradingView.Series && this.mainSource().isLockScale() && this.mainSource().model().timeScale().recalcLockedScale()
};
J76.prototype.topMargin = function () {
    return Math.max(this.m_topMargin, this._studyTopMargin)
};
J76.prototype.setTopMargin = function (n) {
    if (!isNumber(n))throw new TypeError("invalid margin");
    if (0 > n || 30 < n)throw new RangeError("invalid margin");
    this.m_topMargin = n;
    this._internalHeightCache = void 0;
    this._marksCache = null
};
J76.prototype.bottomMargin = function () {
    return Math.max(this.m_bottomMargin, this._studyBottomMargin)
};
J76.prototype.setBottomMargin = function (n) {
    if (!isNumber(n))throw new TypeError("invalid margin");
    if (0 > n || 30 < n)throw new RangeError("invalid margin");
    this.m_bottomMargin = n;
    this._internalHeightCache = void 0;
    this._marksCache = null
};
J76.prototype.internalHeight = function () {
    if (this._internalHeightCache)return this._internalHeightCache;
    var n = this.height() * (1 - this.topMargin() - this.bottomMargin());
    return this._internalHeightCache = n
};
J76.prototype.priceRange = function () {
    return this.m_priceRange
};
J76.prototype.setPriceRange = function (n) {
    if (!n instanceof PriceRange)throw new TypeError("incorrect price range");
    this.m_priceRange = n;
    this._marksCache = null
};
J76.prototype.isEmpty = function () {
    return 0 === this.m_height || !this.m_priceRange || this.m_priceRange.isEmpty()
};
J76.prototype.invertedCoordinate = function (n) {
    return this.height() - 1 - n
};
J76._logicalOffset = 4;
J76._coordOffset = .0001;
J76.prototype.log10 = function (n) {
    return Math.log(n) / Math.log(10)
};
J76.prototype._toLog = function (n) {
    var t = Math.abs(n);
    return 1e-6 > t ? 0 : (t = this.log10(t + J76._coordOffset) + J76._logicalOffset, 0 > n ? -t : t)
};
J76.prototype.priceToLogical = function (n) {
    return this.isLog() && n ? this._toLog(n) : n
};
J76.prototype._fromLog = function (n) {
    var t = Math.abs(n);
    return 1e-6 > t ? 0 : (t = Math.pow(10, t - J76._logicalOffset) - J76._coordOffset, 0 > n ? -t : t)
};
J76.prototype.logicalToPrice = function (n) {
    return this.isLog() ? this._fromLog(n) : n
};
J76.prototype.priceToCoordinate = function (n, t) {
    if (this.isEmpty())return 0;
    n = this.priceToLogical(n);
    var i = this.bottomMargin() * this.height() + (this.internalHeight() - 1) * (n - this.priceRange().minValue()) / (this.priceRange().maxValue() - this.priceRange().minValue()), i = this.invertedCoordinate(i);
    return t ? i : Math.round(i)
};
J76.prototype.pricesToCoordinates = function (n) {
    this.pricesToCoordinatesEx(n.toArray(), function (n) {
        return n.y
    }, function (n, t) {
        n.y = t
    })
};
J76.prototype.pricesToCoordinatesEx = function (n, t, i) {
    var o = this.bottomMargin() * this.height(), f = this.priceRange().minValue(), e = this.priceRange().maxValue(), e = (this.internalHeight() - 1) / (e - f), r, u;
    if (this.isLog())for (r = 0; r < n.length; r++)u = t(n[r]), i(n[r], this.priceToLogical(u));
    for (r = 0; r < n.length; r++)u = t(n[r]), isNaN(u) || void 0 === u || null === u || i(n[r], Math.round(this.m_height - 1 - (o + e * (u - f))))
};
J76.prototype.pointsArrayToCoordinates = function (n) {
    var f = this.bottomMargin() * this.height(), r = this.priceRange().minValue(), u = this.priceRange().maxValue(), u = (this.internalHeight() - 1) / (u - r), t, i;
    if (this.isLog())for (t = 0; t < n.length; t++)n[t].y = this.priceToLogical(n[t].y);
    for (t = 0; t < n.length; t++)i = n[t].y, isNaN(i) || void 0 === i || null === i || (n[t].y = Math.round(this.m_height - 1 - (f + u * (i - r))))
};
J76.prototype.pricesArrayToCoordinates = function (n) {
    var f = this.bottomMargin() * this.height(), r = this.priceRange().minValue(), u = this.priceRange().maxValue(), u = (this.internalHeight() - 1) / (u - r), t, i;
    if (this.isLog())for (t = 0; t < n.length; t++)n[t] = this.priceToLogical(n[t]);
    for (t = 0; t < n.length; t++)i = n[t], i && (n[t] = Math.round(this.m_height - 1 - (f + u * (i - r))))
};
J76.prototype.barPricesToCoordinates = function (n) {
    var i, r;
    n = n.toArray();
    var e = this.bottomMargin() * this.height(), u = this.priceRange().minValue(), f = this.priceRange().maxValue(), f = (this.internalHeight() - 1) / (f - u);
    if (this.isLog())for (i = 0; i < n.length; i++)n[i] && (n[i].open = this.priceToLogical(n[i].open), n[i].high = this.priceToLogical(n[i].high), n[i].low = this.priceToLogical(n[i].low), n[i].close = this.priceToLogical(n[i].close), n[i].additionalPrice && (n[i].additionalPrice = this.priceToLogical(n[i].additionalPrice)));
    for (i = 0; i < n.length; i++)if (r = n[i], r) {
        var t = r.open, t = e + f * (t - u), t = this.m_height - 1 - t;
        r.open = Math.round(t);
        t = r.high;
        t = e + f * (t - u);
        t = this.m_height - 1 - t;
        r.high = Math.round(t);
        t = r.low;
        t = e + f * (t - u);
        t = this.m_height - 1 - t;
        r.low = Math.round(t);
        t = r.close;
        t = e + f * (t - u);
        t = this.m_height - 1 - t;
        r.close = Math.round(t);
        r.additionalPrice && (t = r.additionalPrice, t = e + f * (t - u), t = this.m_height - 1 - t, r.additionalPrice = Math.round(t))
    }
};
J76.prototype.coordinateToPrice = function (n) {
    return this.isEmpty() ? 0 : (n = this.invertedCoordinate(n), n = this.priceRange().minValue() + (this.priceRange().maxValue() - this.priceRange().minValue()) * ((n - this.bottomMargin() * this.height()) / (this.internalHeight() - 1)), this.logicalToPrice(n))
};
J76.prototype.isAutoScale = function () {
    return this.Q2.autoScale.value() && !(this.mainSource()instanceof TradingView.Series && this.mainSource().isLockScale())
};
J76.prototype.isPercentage = function () {
    return this.Q2.percentage.value()
};
J76.prototype.Q19 = function () {
    return this.m_dataSources
};
J76.prototype.orderedSources = function () {
    var n, t, i;
    if (this._cachedOrderedSoruces)return this._cachedOrderedSoruces;
    for (n = [], t = 0; t < this.Q19().size(); t++)i = this.Q19().item(t), null == i.zorder() && i.setZorder(t + 1), n.push(i);
    return n = J75.sortSources(n), this._cachedOrderedSoruces = new List(n)
};
J76.prototype.invalidateSourcesCache = function () {
    this._cachedOrderedSoruces = null
};
J76.prototype.addDataSource = function (n) {
    if (!this.m_dataSources.contains(n)) {
        isInherited(n.constructor, TradingView.Series) && (this._hasSeries = !0);
        var t = this;
        n.properties().visible.listeners().subscribe(null, function () {
            t._sourcesForAutoscale = null
        });
        this.m_dataSources.append(n);
        this._mainSource = void 0;
        this._sourcesToUpdateViews = this._sourcesForAutoscale = null;
        this.updateFormatter();
        this.initScaleProperties();
        this.invalidateSourcesCache()
    }
};
J76.prototype.initScaleProperties = function () {
    var n = this.mainSource()instanceof TradingView.Series && this.mainSource().properties().lockScale.value();
    n && (this.properties().percentage.setValue(!1), this.properties().log.setValue(!1), this.properties().autoScale.setValue(!1));
    this.properties().percentageDisabled.setValue(n);
    this.properties().logDisabled.setValue(n);
    this.properties().autoScaleDisabled.setValue(this.properties().percentage.value());
    this.properties().percentage.value() && this.properties().log.setValue(!1)
};
J76.prototype.removeDataSource = function (n) {
    if (!this.m_dataSources.contains(n))throw Error("source is not attached to scale");
    this.m_dataSources.remove(n);
    isInherited(n.constructor, TradingView.Series) && (this._hasSeries = !1);
    this.mainSource() || this.setAutoScale(!0);
    this._mainSource = void 0;
    this._sourcesToUpdateViews = this._sourcesForAutoscale = null;
    this.updateFormatter();
    this.invalidateSourcesCache()
};
J76.prototype.setAutoScale = function (n) {
    this.Q2.autoScale.setValue(n)
};
J76.prototype.startScale = function (n) {
    this.isPercentage() || null !== this.m_scaleStartPoint || null !== this.m_priceRangeSnapshot || this.isEmpty() || (this.m_scaleStartPoint = this.m_height - n, this.m_priceRangeSnapshot = this.priceRange().clone())
};
J76.prototype.marks = function () {
    return this._marksCache ? this._marksCache : (this.m_markBuilder.rebuildTickMarks(), this._marksCache = this.m_markBuilder.marks())
};
J76.prototype.scaleTo = function (n) {
    if (!this.isPercentage() && (this._marksCache = null, null !== this.m_scaleStartPoint)) {
        this.setAutoScale(!1);
        var t = this.m_priceRange.clone();
        n = this.m_height - n;
        0 > n && (n = 0);
        n = (this.m_scaleStartPoint + .2 * (this.m_height - 1)) / (n + .2 * (this.m_height - 1));
        n = Math.max(n, .1);
        this.m_priceRange = this.m_priceRangeSnapshot.clone();
        this.m_priceRange.scaleAroundCenter(n);
        this.recalcLockedScale(t)
    }
};
J76.prototype.recalcLockedScale = function (n) {
    var r, i, t;
    this.mainSource()instanceof TradingView.Series && this.mainSource().properties().lockScale.value() && (r = this.mainSource().model().timeScale(), t = this.mainSource().data().boxSize, void 0 === t && this.mainSource().fixBoxSize(), void 0 !== t && (this.properties().percentage.value() && (i = this.mainSource().data().search(this.mainSource().getRealVisibleRange().m_firstBar).value[CLOSE_PLOT], t = PriceRange.prototype.convertToPercent.call(null, i + t, i) - PriceRange.prototype.convertToPercent.call(null, i, i)), t *= this.internalHeight() / this.priceRange().length(), .5 > t || 50 < t ? this.m_priceRange = n : (r.setBarSpacing(t), r._correctOffset()), this.mainSource().model().mainSeries().requestMoreData()))
};
J76.prototype.endScale = function () {
    this.isPercentage() || null === this.m_scaleStartPoint || (this.m_priceRangeSnapshot = this.m_scaleStartPoint = null)
};
J76.prototype.startScroll = function (n) {
    this.isAutoScale() || null !== this.m_scrollStartPoint || null !== this.m_priceRangeSnapshot || this.isEmpty() || (this.m_scrollStartPoint = n, this.m_priceRangeSnapshot = this.priceRange().clone())
};
J76.prototype.scrollTo = function (n) {
    if (this._marksCache = null, !this.isAutoScale() && null !== this.m_scrollStartPoint) {
        var t = this.priceRange().length() / (this.height() - 1);
        n = (n - this.m_scrollStartPoint) * t;
        this.m_priceRange = this.m_priceRangeSnapshot.clone();
        this.m_priceRange.shift(n)
    }
};
J76.prototype.endScroll = function () {
    this.isAutoScale() || null === this.m_scrollStartPoint || (this.m_priceRangeSnapshot = this.m_scrollStartPoint = null)
};
J76.prototype.state = function () {
    var n = {};
    return n.m_priceRange = this.priceRange() ? this.priceRange().clone() : null, n.m_isAutoScale = this.isAutoScale(), n.m_isPercentage = this.Q2.percentage.value(), n.m_isLog = this.Q2.log.value(), n.m_height = this.m_height, n.m_topMargin = this.m_topMargin, n.m_bottomMargin = this.m_bottomMargin, n.m_showSymbolLabels = this.Q2.showSymbolLabels.value(), n
};
J76.prototype.restoreState = function (n) {
    var t = n.m_priceRange;
    if (void 0 === t)throw new TypeError("invalid state");
    if (void 0 === n.m_isAutoScale)throw new TypeError("invalid state");
    void 0 !== n.m_isPercentage && this.Q2.percentage.setValue(n.m_isPercentage);
    void 0 !== n.m_isLog && this.Q2.log.setValue(n.m_isLog);
    this.m_priceRange = t ? new PriceRange(t.m_minValue, t.m_maxValue) : null;
    void 0 !== n.m_height && (this.m_height = n.m_height);
    this.setAutoScale(n.m_isAutoScale);
    void 0 !== n.m_topMargin && (this.m_topMargin = n.m_topMargin);
    void 0 !== n.m_bottomMargin && (this.m_bottomMargin = n.m_bottomMargin);
    void 0 !== n.m_showSymbolLabels && this.Q2.showSymbolLabels.setValue(n.m_showSymbolLabels);
    this._mainSource = void 0;
    this._scaleSeriesOnly = !1
};
J76.prototype.mainSource = function () {
    if (void 0 !== this._mainSource)return this._mainSource;
    for (var n = 0; n < this.m_dataSources.size(); n++)if (isInherited(this.m_dataSources.item(n).constructor, PriceDataSource))return this._mainSource = n = this.m_dataSources.item(n);
    return this._mainSource = void 0, null
};
J76.prototype.formatter = function () {
    return this._formatter || this.updateFormatter(), this._formatter
};
J76.prototype.updateFormatter = function () {
    this._marksCache = null;
    var n = this.mainSource(), t = 100;
    n && (t = n.base());
    this._formatter = null;
    this.properties().percentage.value() ? this._formatter = new PercentageFormatter : n && (this._formatter = n.formatter());
    this.m_markBuilder = new PriceTickMarkBuilder(this, t, this._formatter);
    this.m_markBuilder.rebuildTickMarks()
};
J76.prototype._recalculateSourcesForAutoscale = function () {
    var r, t, i, n;
    for (this._sourcesForAutoscale = new List, this._mainSource && (this._scaleSeriesOnly = this._mainSource.model().properties().scalesProperties.scaleSeriesOnly.value()), r = this._scaleSeriesOnly && this._hasSeries, t = 0; t < this.Q19().size(); t++)i = this.Q19().item(t), n = i, n = n.properties().visible.value() || n instanceof TradingView.Series ? r ? isInherited(n.constructor, TradingView.Series) : isInherited(n.constructor, PriceDataSource) : !1, n && this._sourcesForAutoscale.append(i)
};
J76.prototype.sourcesForAutoscale = function () {
    if (this._mainSource) {
        var n = this._mainSource.model().properties();
        this._scaleSeriesOnly != n.scalesProperties.scaleSeriesOnly.value() && (this._sourcesForAutoscale = null)
    }
    return this._sourcesForAutoscale || this._recalculateSourcesForAutoscale(), this._sourcesForAutoscale
};
J76.prototype.recalculatePriceRange = function (n) {
    var t, f, u, i;
    for (this._studyBottomMargin = this._studyTopMargin = 0, t = null, f = this.sourcesForAutoscale(), this.mainSource(), u = 0; u < f.size(); u++)if (i = f.item(u), i.properties().visible.value()) {
        var r = n.firstBar(), e = n.lastBar(), r = i.priceRange(r, e);
        null === t && r ? t = r : r && (t = t.merge(r));
        i.margins && (i = i.margins(), this._studyTopMargin = Math.max(i[0], this._studyTopMargin), this._studyBottomMargin = Math.max(i[1], this._studyBottomMargin))
    }
    t ? (t.minValue() == t.maxValue() && (t = new PriceRange(t.minValue() - .5, t.maxValue() + .5)), this.setPriceRange(t)) : this.m_priceRange || this.setPriceRange(new PriceRange(-.5, .5))
};
J76.prototype.sourcesToUpdateViews = function () {
    var n, t;
    if (!this._sourcesToUpdateViews)for (this._sourcesToUpdateViews = new List, n = 0; n < this.Q19().size(); n++)t = this.Q19().item(n), isInherited(t.constructor, J47) && !t.isActualSymbol() || this._sourcesToUpdateViews.append(t);
    return this._sourcesToUpdateViews
};
J76.prototype.updatePaneViews = function () {
    for (var t = this.sourcesToUpdateViews(), n = 0; n < t.size(); n++)t.item(n).updateAllViews()
};
J76.prototype.updateShowSymbolLabels = function () {
    for (var t = this.sourcesToUpdateViews(), n = 0; n < t.size(); n++)t.item(n).updateAllViews();
    this.mainSource() && this.mainSource().model().Q20(new D22(D22.LIGHT_UPDATE))
};
D58 = function (n, t) {
    this.m_bars = new PlotList(["time", "open", "high", "low", "close"]);
    this.m_nsBars = new PlotList(["time", "open", "high", "low", "close"]);
    this.m_series = n;
    this.m_model = t;
    this.boxSize = this.lastProjectionPrice = void 0
};
D58.prototype.bars = function () {
    return this.m_bars
};
D58.prototype.nsBars = function () {
    return this.m_nsBars
};
D58.prototype.size = function () {
    return this.m_nsBars._end - this.m_nsBars._start + (this.m_bars._end - this.m_bars._start)
};
D58.prototype.each = function (n) {
    for (var t = this.m_bars._start; t < this.m_bars._end && !n(this.m_bars._indexAt(t), this.m_bars._valueAt(t)); ++t);
    for (t = this.m_nsBars._start; t < this.m_nsBars._end && !n(this.m_nsBars._indexAt(t), this.m_nsBars._valueAt(t)); ++t);
};
D58.prototype.clear = function () {
    this.m_bars = new PlotList(["time", "open", "high", "low", "close"]);
    this.m_nsBars = new PlotList(["time", "open", "high", "low", "close"]);
    this.boxSize = this.lastProjectionPrice = void 0
};
D58.prototype.first = function () {
    return this.m_bars.isEmpty() ? this.m_nsBars._items[0] : this.m_bars._items[0]
};
D58.prototype.isEmpty = function () {
    return this.m_bars.isEmpty() && this.m_nsBars.isEmpty()
};
D58.prototype.last = function () {
    return this.m_nsBars.isEmpty() ? this.m_bars._items[this.m_bars._end - 1] : this.m_nsBars._items[this.m_nsBars._end - 1]
};
D58.prototype.search = function (n, t) {
    return this.nsBars().isEmpty() ? this.bars().search(n, t) : this.bars().isEmpty() ? this.nsBars().search(n, t) : this.nsBars().firstTimeIndex() <= n ? this.nsBars().search(n, t) : this.bars().search(n, t)
};
D58.prototype.valueAt = function (n) {
    if (n = this.search(n))return n.value
};
D58.prototype.firstBar = function () {
    if (this.m_model.timeScale().isEmpty())return null;
    var n = this.m_model.timeScale().visibleBars(), t = n.firstBar(), n = n.lastBar(), i = null, r = function (n, t) {
        if (!i)return i = t, !0
    };
    return this.bars().range(t, n).isEmpty() ? this.nsBars().range(t, n).each(r) : this.bars().range(t, n).each(r), i
};
D58.prototype.firstValue = function () {
    var n = this.firstBar();
    return n ? n[CLOSE_PLOT] : null
};
D58.prototype.timeToBarIndex = function (n, t) {
    var i, r;
    if (null === n)return TradingView.logDebug("SeriesData.timeToBarIndex: time should be a number of seconds since 1970. But it is null"), 0;
    if (t === SEARCH_FROM_RIGHT) {
        for (i = this.m_bars.lastIndex(); i >= this.m_bars.firstIndex(); i--)if (r = this.m_bars._valueAt(i), n >= r[TIME_PLOT])return i;
        for (i = this.m_nsBars.lastIndex(); i >= this.m_nsBars.firstIndex(); i--)if (r = this.m_nsBars._valueAt(i), n >= r[TIME_PLOT])return i;
        return this.m_bars.firstIndex()
    }
    if (t === SEARCH_FROM_LEFT) {
        for (i = this.m_bars.firstIndex(); i <= this.m_bars.lastIndex(); i++)if (r = this.m_bars._valueAt(i), n <= r[TIME_PLOT])return i;
        for (i = this.m_nsBars.firstIndex(); i <= this.m_nsBars.lastIndex(); i++)if (r = this.m_nsBars._valueAt(i), n <= r[TIME_PLOT])return i;
        return this.m_bars.lastIndex()
    }
    return TradingView.logDebug("SeriesData.timeToBarIndex: Incorrect options value"), 0
};
var DEFAULT_BAR_COUNT = 300, TIME_PLOT = 0, OPEN_PLOT = 1, HIGH_PLOT = 2, LOW_PLOT = 3, CLOSE_PLOT = 4, ADT_PLOT = 6, SEARCH_FROM_LEFT = -1, SEARCH_FROM_RIGHT = 1;
J23.prototype.update = function () {
    this._invalidated = !0
};
J23.prototype.updateImpl = function () {
    if (this._visible = !1, this._series.properties().showPriceLine.value()) {
        var n = this._series.lastValueData(CLOSE_PLOT, !0);
        n && (this._visible = !0, this._points = (new List).append(new MathEx.Point(0, n.coordinate)), this._color = n.color)
    }
};
J23.prototype.renderer = function () {
    this._invalidated && (this.updateImpl(), this._invalidated = !1);
    var n = {};
    return n.points = this._points, n.color = this._color, n.linewidth = this._series.properties().priceLineWidth.value(), n.linestyle = CanvasEx.LINESTYLE_DOTTED, n.hitTestResult = HitTestResult.REGULAR, n.visible = this._visible, new HorzLineRenderer(n)
};
TradingView.defaultRequestOption = function () {
    return{count: DEFAULT_BAR_COUNT}
};
TradingView.Series = function (n, t, i) {
    PriceDataSource.call(this);
    this._boxSizeChanged = new Delegate;
    this._tagsChanged = new Delegate;
    this._symbolIntervalChanged = new Delegate;
    this._symbolResolved = new Delegate;
    this._symbolError = new Delegate;
    this._symbolNotPermitted = new Delegate;
    this._extendedHoursChanged = new Delegate;
    this._extendedHoursNotPermitted = new Delegate;
    this.chartTypeNotPermitted = new Delegate;
    this.intradaySpreadNotPermitted = new Delegate;
    this.intradayExchangeNotPermitted = new Delegate;
    this.customIntervalNotPermitted = new Delegate;
    this.chartWidgetInitialized = new Delegate;
    this._startLoading = new Delegate;
    this._dataLoaded = new Delegate;
    this._tickmarksRangeChanged = new Delegate;
    this._barReceived = new Delegate;
    this._onChangedStyle = new Delegate;
    this._onCompleted = new Delegate;
    this._onStatusChanged = new Delegate;
    this._onRestarted = new Delegate;
    this._onSessionsStudyCreated = new Delegate;
    this.requestingIntradayWhenNotSupported = new Delegate;
    this.requestingResolutionWhenNotSupported = new Delegate;
    this.priceScaleChanged = new Delegate;
    this._requestOptions = i ? i : TradingView.defaultRequestOption();
    this.m_model = n;
    this._chartApi = n._chartApi;
    this.m_data = new D58(this, n);
    this.setProperties(t);
    this._prevChartStyle = t.style.value();
    this._63();
    this._dataWindowView = new SeriesDataWindowView(this, n);
    this._statusView = new SeriesStatusView(this, n.properties());
    this._priceAxisViews = new List;
    this._priceAxisViews.append(new SeriesPriceAxisView(this, n));
    this._priceAxisViews.append(new ProjectionSeriesPriceAxisView(this, n));
    this._symbolInfo = null;
    this._status = TradingView.Series.STATUS_OFFLINE;
    var r = this;
    this._turnaroundCounter = 1;
    this._turnaround = "s" + this._turnaroundCounter;
    this._handler = function (n) {
        r.onData(n)
    };
    this.Q2.addExclusion && this.Q2.addExclusion("visible");
    this._base = 100;
    this._formatter = new PriceFormatter(this._base);
    this._predictBars = 0;
    this._futureBarsPaneView = null;
    this.Q2.showInDataWindow.listeners().subscribe(n, J79.prototype.fullUpdate);
    this.marketStatus = new WatchedValue;
    this._seriesLoaded = !1;
    this.properties().minTick.listeners().subscribe(this, TradingView.Series.prototype._recreateFormatter);
    r = this;
    this.properties().minTick.listeners().subscribe(null, function () {
        r.m_model.Q20(new D22(D22.FULL_UPDATE))
    });
    this._priceLineView = new J23(this);
    this.bindJapChartsInputs();
    this.createExtendedHoursProperty();
    this.extendedHours.listeners().subscribe(this, function () {
        this._extendedHoursChanged.fire()
    });
    this._extendedHoursNotPermitted.subscribe(this, function () {
        this.Q2.extendedHours.setValue(!1);
        this.disableSessionBackground()
    });
    this._extendedHoursChanged.subscribe(this, function () {
        this._status !== TradingView.Series.STATUS_SNAPSHOT && this.restart()
    });
    this._symbolIntervalChanged.subscribe(this, this.checkInterval);
    this.properties().showCountdown.listeners().subscribe(this, TradingView.Series.prototype._onChangeShowCountdown);
    this._onChangeShowCountdown(this.properties().showCountdown);
    this._recreateFormatter()
};
inherit(TradingView.Series, PriceDataSource);
TradingView.Series.prototype.serverTimeOffset = function () {
    return this._chartApi.serverTimeOffset()
};
TradingView.Series.prototype._onChangeShowCountdown = function (n) {
    var t = this;
    n.value() ? this._countdownUpdateTimer = this.m_model.setInterval(function () {
        t._priceAxisViews.item(0).update();
        t.m_model.Q20(new D22(D22.LIGHT_UPDATE))
    }, 500) : (this.m_model.clearInterval(this._countdownUpdateTimer), delete this._countdownUpdateTimer)
};
TradingView.Series.prototype.lastValueData = function (n, t, i) {
    var u, r;
    if ((n = {}, this.m_model.timeScale().isEmpty() || this.priceScale().isEmpty() || this.data().isEmpty()) || (u = this.m_model.timeScale().visibleBars(), u.isEmpty()))return null;
    if (t) {
        if (t = this.data().bars().last(), null == t)return null;
        r = t.value;
        t = parseInt(t)
    } else {
        if (t = this.data().bars().search(u.lastBar(), SEARCH_NEAREST_LEFT), void 0 === t)return null;
        r = this.data().bars().valueAt(t.index);
        t = t.index
    }
    return r = r[CLOSE_PLOT], i && (n.price = r), this.priceScale().properties().percentage.value() && (i = this.nearestIndex(u.firstBar(), SEARCH_NEAREST_RIGHT), this.data().valueAt(i), i = this.firstValue(), r = this.priceScale().priceRange().convertToPercent(r, i)), n.text = this.priceScale().formatter().format(r), i = this.barColorer().barStyle(t, !1), n.color = i.barColor, n.floatCoordinate = this.priceScale().priceToCoordinate(r, !0), n.coordinate = Math.round(n.floatCoordinate), n
};
TradingView.Series.prototype._prepareChartApiParams = function () {
    return this._requestOptions.startDate ? !this._requestOptions.startDate || this._requestOptions.endDate || this._requestOptions.count ? this._requestOptions.startDate && this._requestOptions.endDate ? ["from_to", this._requestOptions.startDate, this._requestOptions.endDate] : ["from_to", this._requestOptions.startDate, this._requestOptions.count] : ["from_to", this._requestOptions.startDate] : this._requestOptions.count || DEFAULT_BAR_COUNT
};
TradingView.Series.prototype._nextSymbolId = 1;
TradingView.Series.prototype._nextSeriesId = 1;
TradingView.Series.STYLE_BARS = 0;
TradingView.Series.STYLE_CANDLES = 1;
TradingView.Series.STYLE_LINE = 2;
TradingView.Series.STYLE_LINE_TYPE_MARKERS = 0;
TradingView.Series.STYLE_LINE_TYPE_STEP = 1;
TradingView.Series.STYLE_LINE_TYPE_SIMPLE = 2;
TradingView.Series.STYLE_AREA = 3;
TradingView.Series.STYLE_RENKO = 4;
TradingView.Series.STYLE_KAGI = 5;
TradingView.Series.STYLE_PNF = 6;
TradingView.Series.STYLE_PB = 7;
TradingView.Series.STYLE_HEIKEN_ASHI = 8;
TradingView.Series.STYLE_HOLLOW_CANDLES = 9;
TradingView.Series.STATUS_OFFLINE = 0;
TradingView.Series.STATUS_RESOLVING = 1;
TradingView.Series.STATUS_LOADING = 2;
TradingView.Series.STATUS_READY = 3;
TradingView.Series.STATUS_INVALID_SYMBOL = 4;
TradingView.Series.STATUS_SNAPSHOT = 5;
TradingView.Series.STATUS_EOD = 6;
TradingView.Series.STATUS_PULSE = 7;
TradingView.Series.STATUS_DELAYED = 8;
TradingView.Series.STATUS_DELAYED_STREAMING = 9;
TradingView.Series.PERMISSION_DENIED = "permission denied";
TradingView.Series.PD_REASON_SYMBOL = "symbol";
TradingView.Series.PD_REASON_EXTENDED_HOURS = "extended_hours";
TradingView.Series.STUDY_NOT_AUTH = "study_not_auth";
TradingView.Series.prototype.model = function () {
    return this.m_model
};
TradingView.Series.prototype.fixLastBar = function () {
    if (!this._futureBarsPaneView) {
        var n = parseInt(this.data().last(), 10) + 1;
        this._futureBarsPaneView = new TradingView._79(this, n)
    }
};
TradingView.Series.prototype.clearData = function () {
    this.data().clear()
};
TradingView.Series.prototype.data = function () {
    return this.m_data
};
TradingView.Series.prototype.symbolId = function () {
    return this._symbolId
};
TradingView.Series.prototype.isPulse = function () {
    return this._symbolInfo && 0 < this._symbolInfo.resolutions.length
};
TradingView.Series.prototype.onTagsChanged = function () {
    return this._tagsChanged
};
TradingView.Series.prototype.onSymbolIntervalChanged = function () {
    return this._symbolIntervalChanged
};
TradingView.Series.prototype.onSymbolResolved = function () {
    return this._symbolResolved
};
TradingView.Series.prototype.onSymbolError = function () {
    return this._symbolError
};
TradingView.Series.prototype.onSymbolNotPermitted = function () {
    return this._symbolNotPermitted
};
TradingView.Series.prototype.onExtendedHoursNotPermitted = function () {
    return this._extendedHoursNotPermitted
};
TradingView.Series.prototype.onStartLoading = function () {
    return this._startLoading
};
TradingView.Series.prototype.onDataLoaded = function () {
    return this._dataLoaded
};
TradingView.Series.prototype.onStatusChanged = function () {
    return this._onStatusChanged
};
TradingView.Series.prototype.onTickmarksRangeChanged = function () {
    return this._tickmarksRangeChanged
};
TradingView.Series.prototype.onBarReceived = function () {
    return this._barReceived
};
TradingView.Series.prototype.onChangedStyle = function () {
    return this._onChangedStyle
};
TradingView.Series.prototype.onCompleted = function () {
    return this._onCompleted
};
TradingView.Series.prototype.onRestarted = function () {
    return this._onRestarted
};
TradingView.Series.prototype.onBoxSizeChanged = function () {
    return this._boxSizeChanged
};
TradingView.Series.prototype.status = function () {
    return this._status
};
TradingView.Series.prototype.isDWM = function () {
    return!(3600 > +this.Q2.interval.value())
};
TradingView.Series.prototype.lastPriceLabelFixedCoordinate = function () {
    return this._priceAxisViews.item(0)._fixedCoordinate
};
TradingView.Series.prototype._63 = function () {
    this._projectionBarsPaneView = this._paneView = null;
    this._symbolLabelView = new TradingView.J38(this.m_model, this, CLOSE_PLOT, "firstShortName");
    var n = this.Q2.style.value();
    switch (n) {
        case TradingView.Series.STYLE_BARS:
            this._paneView = new J15(this, this.m_model);
            break;
        case TradingView.Series.STYLE_CANDLES:
            this._paneView = new J16(this, this.m_model);
            break;
        case TradingView.Series.STYLE_LINE:
            this._paneView = new J20(this, this.Q2.lineStyle.priceSource.value(), this.m_model);
            break;
        case TradingView.Series.STYLE_AREA:
            this._paneView = new J13(this, this.Q2.areaStyle.priceSource.value(), this.m_model);
            break;
        case TradingView.Series.STYLE_RENKO:
            this._paneView = new J28(this, this.m_model);
            this._projectionBarsPaneView = new J27(this, this.m_model);
            break;
        case TradingView.Series.STYLE_PB:
            this._paneView = new J22(this, this.m_model);
            this._projectionBarsPaneView = new J26(this, this.m_model);
            break;
        case TradingView.Series.STYLE_KAGI:
            this._paneView = new J19(this, this.m_model);
            this._projectionBarsPaneView = new J24(this, this.m_model);
            break;
        case TradingView.Series.STYLE_PNF:
            this._paneView = new J21(this, this.m_model);
            this._projectionBarsPaneView = new J25(this, this.m_model);
            break;
        case TradingView.Series.STYLE_HEIKEN_ASHI:
            this._paneView = new J17(this, this.m_model);
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            this._paneView = new J18(this, this.m_model);
            break;
        default:
            throw"Unknown chart style assigned: " + n;
    }
};
TradingView.Series.prototype.invalidateBarColorerCache = function () {
    delete this._barColorerCache
};
TradingView.Series.prototype.barColorer = function () {
    var t, i, n;
    if (this._barColorerCache)return this._barColorerCache;
    for (t = null, i = this.m_model.Q19().size() - 1; 0 <= i; i--)n = this.m_model.Q19().item(i), n.metaInfo && isInherited(n.constructor, TradingView.Study) && n.hasBarColorer() && n.properties().visible.value() && (n = n.barColorer(), null === t ? t = n : t.pushBackBarColorer(n));
    return null === t ? t = new SeriesBarColorer(this) : t.pushBackBarColorer(new SeriesBarColorer(this)), this._barColorerCache = t
};
TradingView.Series.prototype.properties = function () {
    return this.Q2
};
TradingView.Series.prototype.state = function (n) {
    var t = {type: this === this.m_model.mainSeries() ? "MainSeries" : TradingView.className(this.constructor), id: this.id(), state: this.properties().state(), zorder: this.zorder()};
    return t.state.symbol = this._symbolInfo.ticker || t.state.symbol, n && (t.bars = this.m_data.m_bars.state(), t.nsBars = this.m_data.m_nsBars.state(), t.symbolInfo = this._symbolInfo, t.rtPrice = this.data().lastProjectionPrice), t.boxSize = this.data().boxSize, t
};
TradingView.Series.prototype.uniqueId = function () {
    return this.symbol() + "|" + this.interval()
};
TradingView.Series.prototype.stateForAlert = function () {
    var n = this.state();
    return n.uniqueId = this.uniqueId(), n
};
TradingView.Series.prototype.restoreData = function (n, t, i, r, u) {
    this._status = TradingView.Series.STATUS_SNAPSHOT;
    this.m_data.m_bars.restoreState(n);
    this.m_data.m_nsBars.restoreState(t);
    this.updateSymbolInfo(i);
    this.m_data.lastProjectionPrice = r;
    this.m_data.boxSize = u;
    u || (this.properties().style.value() == TradingView.Series.STYLE_PNF ? this.m_data.boxSize = this.properties().pnfStyle.inputs.boxSize.value() : this.properties().style.value() == TradingView.Series.STYLE_RENKO && (this.m_data.boxSize = this.properties().renkoStyle.inputs.boxSize.value()))
};
TradingView.Series.prototype.setProperties = function (n) {
    n.timeframe || n.merge({timeframe: ""});
    n.shortName || n.merge({shortName: ""});
    this.Q2 = n;
    this.Q2.symbol.listeners().subscribe(this, TradingView.Series.prototype.changeSymbol);
    this.Q2.interval.listeners().subscribe(this, TradingView.Series.prototype.changeInterval);
    this.Q2.timeframe.listeners().subscribe(this, TradingView.Series.prototype.changeTimeFrame);
    this.Q2.listeners().subscribe(this, TradingView.Series.prototype.changeProperties)
};
TradingView.Series.prototype.changeSymbol = function () {
    TradingView.trackEvent("GUI", "Change symbol");
    this.setSymbolIntervalDelayed();
    this.m_model.checkLineToolSelection()
};
TradingView.Series.prototype.changeInterval = function () {
    TradingView.trackEvent("GUI", "Change interval");
    this.setSymbolIntervalDelayed()
};
TradingView.Series.prototype.changeTimeFrame = function () {
    TradingView.trackEvent("GUI", "Change timeframe");
    timeframe = this.Q2.interval.value()
};
TradingView.Series.prototype.title = function () {
    return this.properties().symbol.value() + ", " + translatedIntervalString(this.properties().interval.value())
};
TradingView.Series.prototype.changeProperties = function (n) {
    n !== this.Q2.symbol && n !== this.Q2.interval && n !== this.Q2.timeframe && (this._tagsChanged.fire(), this._63(), this.updateAllViews(), this.m_model.updateSource(this))
};
TradingView.Series.prototype._makeNextSymbolId = function () {
    return"symbol_" + this._nextSymbolId++
};
TradingView.Series.prototype._makeNextSeriesId = function () {
    return"s" + this._nextSeriesId++
};
TradingView.Series.prototype._clearLoadingTimer = function () {
    this.loadingTimer && (TradingView.logDebug("Series loading took " + ((new Date).getTime() - this._loadingStartTime) + " ms"), clearTimeout(this.loadingTimer), this.loadingTimer = null)
};
TradingView.Series.prototype.onData = function (n) {
    var r = this, t, i;
    switch (n.method) {
        case"symbol_resolved":
            if (n.params[0] !== this._symbolId) {
                TradingView.logNormal("command for old symbol. Expected:" + this._symbolId + ", actual" + n.params[0]);
                break
            }
            this.updateSymbolInfo(n.params[1]);
            this.m_model.updateSource(this);
            this._symbolResolved.fire(this._symbolInfo);
            this.m_model.realignLineTools();
            t = this.symbolInfo().minmov / this.symbolInfo().pricescale;
            i = this.properties();
            i.style.value() == TradingView.Series.STYLE_RENKO && i.renkoStyle.inputs.boxSize.value() < t ? i.renkoStyle.inputs.merge({boxSize: t}) : i.style.value() == TradingView.Series.STYLE_PNF && i.pnfStyle.inputs.boxSize.value() < t ? i.pnfStyle.inputs.merge({boxSize: t}) : i.style.value() == TradingView.Series.STYLE_KAGI && i.kagiStyle.inputs.reversalAmount.value() < t && i.kagiStyle.inputs.merge({reversalAmount: t});
            break;
        case"symbol_error":
            if (n.params[0] !== this._symbolId) {
                TradingView.logNormal("command for old symbol. Expected:" + this._symbolId + ", actual" + n.params[0]);
                break
            }
            if (this._clearLoadingTimer(), this._setStatus(TradingView.Series.STATUS_INVALID_SYMBOL), this.Q2.shortName.setValue(this.Q2.symbol.value()), this.m_model.clearAllStudies(), this.updateAllViews(), this.m_model.updateSource(this), n.params[1] == TradingView.Series.PERMISSION_DENIED)switch (n.params[2]) {
                case TradingView.Series.PD_REASON_EXTENDED_HOURS:
                    this._extendedHoursNotPermitted.fire();
                    break;
                case TradingView.Series.PD_REASON_SYMBOL:
                    this._symbolNotPermitted.fire(n.params[3]);
                    break;
                default:
                    this._symbolNotPermitted.fire(n.params[2])
            } else this.m_model.resetTimeScale(), this._symbolError.fire();
            this.m_model.realignLineTools();
            break;
        case"series_timeframe":
            if (n.params[1] !== this._turnaround)break;
            t = n.params[3];
            i = n.params[4];
            this.m_model.setTimeViewport(n.params[2], "undefined" != typeof i && i ? t : t + 10);
            break;
        case"series_error":
            t = n.params[2];
            this._clearLoadingTimer();
            J77.enabled("charting_library_debug_mode") && console.log("Error reason: " + t);
            t && t.startsWith("study_not_auth:") ? (t = t.split(":", 2)[1].split("@", 2)[0], t in{BarSetRenko: !0, BarSetPriceBreak: !0, BarSetKagi: !0, BarSetPnF: !0} ? this.chartTypeNotPermitted.fire(t) : "BarSetSpread" === t && this.intradaySpreadNotPermitted.fire()) : "resolution_not_entitled" == t ? this.intradayExchangeNotPermitted.fire() : "custom_resolution" == t && this.customIntervalNotPermitted.fire();
            this._setStatus(TradingView.Series.STATUS_INVALID_SYMBOL);
            break;
        case"series_loading":
            if (n.params[1] !== this._turnaround)break;
            if (n.params[0] !== this._seriesId) {
                TradingView.logNormal("command for old series. Expected:" + this._seriesId + ", actual" + n.params.customId);
                break
            }
            this._setStatus(TradingView.Series.STATUS_LOADING);
            0 == this.m_data.m_bars.size() && (r._loadingStartTime = (new Date).getTime(), r.loadingTimer = setTimeout(function () {
                var n = {chartSession: r._chartApi._sessionid, symbol: r.getSymbolString(), interval: r.interval()};
                D72.sendReport("series_loading", n)
            }, 15e3));
            break;
        case"series_completed":
            if (n.params[2] !== this._turnaround)break;
            if (n.params[0] !== this._seriesId) {
                TradingView.logNormal("command for old series. Expected:" + this._seriesId + ", actual" + n.params.customId);
                break
            }
            t = n.params[1];
            "pulsed" == t && (t = "delayed");
            switch (t) {
                case"streaming":
                    this._setStatus(TradingView.Series.STATUS_READY);
                    break;
                case"endofday":
                    this._setStatus(TradingView.Series.STATUS_EOD);
                    break;
                case"delayed":
                    this._setStatus(TradingView.Series.STATUS_DELAYED);
                    break;
                case"pulsed":
                    this._setStatus(TradingView.Series.STATUS_PULSE)
            }
            t.match(/delayed_streaming/) && this._setStatus(TradingView.Series.STATUS_DELAYED_STREAMING);
            this.requestMoreData();
            t = this.m_model.paneForSource(this);
            t.recalculatePriceScale(this.priceScale());
            this.m_model.Q20(new D22(D22.FULL_UPDATE));
            this.m_data.size() && this._tickmarksRangeChanged.fire({start: this.data().first().value[TIME_PLOT], end: this.data().last().value[TIME_PLOT]});
            this.model().recalcVisibleRangeStudy(this.model().Q19(), !0);
            !this.isLockScale() || this.model().timeScale().isEmpty() || this._seriesLoaded || (this.model().timeScale()._correctOffset(), this.model().timeScale().correctBarSpacing(), t = this.model().timeScale().visibleBars(), this.priceScale().setPriceRange(this.priceRange(t.firstBar(), t.lastBar())));
            this._seriesLoaded = !0;
            this._onCompleted.fire();
            break;
        case"data_update":
            if (n.params.customId !== this._seriesId) {
                TradingView.logNormal("command for old series. Expected:" + this._seriesId + ", actual" + n.params.customId);
                break
            }
            if (this.status() === TradingView.Series.STATUS_INVALID_SYMBOL)break;
            this._clearLoadingTimer();
            0 < n.params.plots.length && (this._endOfData = !1);
            n.params.plots.length ? (t = this.m_data.m_bars.size(), this.m_data.m_bars.merge(n.params.plots), t != this.bars().size() && this._barReceived.fire(this.m_data.m_bars.size()), this.model().recalcVisibleRangeStudy(this.model().Q19(), !0)) : (this.m_data.clear(), this._startLoading.fire());
            t = this.properties().style.value();
            !n.params.nonseries || t !== TradingView.Series.STYLE_RENKO && t !== TradingView.Series.STYLE_KAGI && t !== TradingView.Series.STYLE_PNF && t !== TradingView.Series.STYLE_PB ? n.params.nonseries || (this.m_data.m_nsBars.clear(), this.m_data.lastProjectionPrice = void 0) : (t = this.parseJapProjBars(n.params.nonseries), this.m_data.m_nsBars = t.nsBars, this.m_data.lastProjectionPrice = t.lastPrice, i = this.m_data.boxSize !== t.boxSize, this.m_data.boxSize = t.boxSize, i && this._boxSizeChanged.fire(this.m_data.boxSize));
            t = this.m_model.paneForSource(this);
            this.m_model.updateAllVolumeStudies();
            this.m_model.recalculatePane(t);
            this.m_model.updateSource(this);
            this.m_model.updateLineTools()
    }
    this._dataLoaded.fire(n)
};
TradingView.Series.prototype.fixBoxSize = function () {
    var t = this.model().timeScale(), n = this.priceScale();
    n.isEmpty() || t.isEmpty() || (this.m_data.boxSize = Math.abs(n.coordinateToPrice(t.barSpacing()) - n.coordinateToPrice(0)))
};
TradingView.Series.prototype.parseJapProjBars = function (n) {
    var f = new PlotList(["time", "open", "high", "low", "close"]), o = this.model().timeScale(), e = this.properties().style.value(), r, u;
    if (n.d && "" !== n.d)for (var t = JSON.parse(n.d).data, s = t.price, h = t.boxSize, t = t.bars, i = 0; t && i < t.length; i++)r = [], u = n.indexes[t[i].time], r.push(o.points().valueAt(u)), r.push(t[i].open), r.push(t[i].high), r.push(t[i].low), r.push(t[i].close), r.push(t[i].volume), e === TradingView.Series.STYLE_KAGI ? r.push(t[i].additionalPrice) : e === TradingView.Series.STYLE_PNF && r.push(t[i].factor), f.add(u, r);
    return{nsBars: f, lastPrice: s, boxSize: h}
};
TradingView.Series.prototype.disconnect = function () {
    this._seriesId = this._symbolId = null;
    this._status = TradingView.Series.STATUS_OFFLINE
};
TradingView.Series.prototype.isStarted = function () {
    return!!this._symbolId
};
TradingView.Series.prototype.restart = function () {
    this._onRestarted.fire();
    this._setStatus(TradingView.Series.STATUS_RESOLVING);
    this.m_data = new D58(this, this.model());
    this._prevSymbolId = this._symbolId;
    this._symbolId = this._makeNextSymbolId();
    this._chartApi.resolveSymbol(this._symbolId, this.getSymbolString(), this._handler);
    this._seriesId ? (this._turnaround = "s" + ++this._turnaroundCounter, this._chartApi.modifySeries(this._seriesId, this._turnaround, this._symbolId, this.Q2.interval.value(), this._handler, this._prevSymbolId)) : (this._seriesId = this._makeNextSeriesId(), this._chartApi.createSeries(this._seriesId, this._turnaround, this._symbolId, this.Q2.interval.value(), this._prepareChartApiParams(), this._handler));
    this.Q2.showInDataWindow.listeners().subscribe(this.m_model, J79.prototype.fullUpdate);
    this.m_symbol = this.Q2.symbol.value();
    this.m_interval = this.Q2.interval.value();
    this._seriesLoaded = !1
};
TradingView.Series.prototype._generateTimeframe = function (n, t) {
    var i = t.right(1), r = n;
    return"ytd" === t ? r += ",YTD" : "d" === i ? (i = t.left(t.length - 1), r += "," + i, J77.enabled("daily_timeframe_suffix") && (r += "D")) : "m" === i ? (i = t.left(t.length - 1), r += "," + i + "M") : "all" === t && (r += ",ALL"), r
};
TradingView.Series.prototype.setSymbolIntervalDelayed = function () {
    this._setSymbolIntervalDelay && clearTimeout(this._setSymbolIntervalDelay);
    this._setSymbolIntervalDelay = setTimeout(function () {
        delete this._setSymbolIntervalDelay;
        this.setSymbolInterval(this.Q2.symbol.value(), this.Q2.interval.value())
    }.bind(this), 10)
};
TradingView.Series.prototype.setSymbolInterval = function (n, t) {
    var r = (t + "").split(","), u = 0, f = t, e, i;
    2 == r.length && (f = r[0], u = r[1]);
    r = !this.symbolSameAsCurrent(n) || J77.enabled("same_data_requery");
    e = this.m_interval !== f || J77.enabled("same_data_requery");
    (r || e) && (this.m_model.realignLineTools(), this.m_symbol = n, this.m_interval = f, this.m_timeframe = u, this._status !== TradingView.Series.STATUS_SNAPSHOT) && (this._setStatus(TradingView.Series.STATUS_RESOLVING), this._symbolId && !r || this.updateSymbolInfo(null), this._symbolIntervalChanged.fire(), this._onRestarted.fire(), this._chartApi && this._chartApi.connected() && ((!this._symbolId || r) && (this._prevSymbolId = this._symbolId, this._symbolId = this._makeNextSymbolId(), u = this.getSymbolString(), this._chartApi.resolveSymbol(this._symbolId, u, this._handler)), this._seriesId ? (this._modifyTimer && clearTimeout(this._modifyTimer), i = this, i._turnaround = "s" + ++i._turnaroundCounter, this._pendingInterval && (t = this._generateTimeframe(t, this._pendingInterval), delete this._pendingInterval), this._modifyTimer = setTimeout(function () {
        i._predictBars = 0;
        i._chartApi.modifySeries(i._seriesId, i._turnaround, i._symbolId, t, i._handler, this._prevSymbolId);
        i._modifyTimer = null
    }, 30)) : (this._seriesId = this._makeNextSeriesId(), this._chartApi.createSeries(this._seriesId, this._turnaround, this._symbolId, t, this._prepareChartApiParams(), this._handler))), this._seriesLoaded = !1, this._haveToScroll = !0)
};
TradingView.Series.prototype.actualSymbol = function () {
    return this.symbolInfo() ? this.symbolInfo().full_name : this.symbol()
};
TradingView.Series.prototype.symbol = function () {
    return this.properties().symbol.value()
};
TradingView.Series.prototype.interval = function () {
    return this.properties().interval.value()
};
TradingView.Series.prototype.isIntradayInterval = function () {
    return!!/^\d*$/.test(this.interval()) && 1440 >= this.interval()
};
TradingView.Series.prototype.bars = function () {
    return this.m_data.m_bars
};
TradingView.Series.prototype.nsBars = function () {
    return this.m_data.m_nsBars
};
TradingView.Series.prototype.open = function (n) {
    return this.m_data.valueAt(n)[OPEN_PLOT]
};
TradingView.Series.prototype.high = function (n) {
    return this.m_data.valueAt(n)[HIGH_PLOT]
};
TradingView.Series.prototype.low = function (n) {
    return this.m_data.valueAt(n)[LOW_PLOT]
};
TradingView.Series.prototype.close = function (n) {
    return this.m_data.valueAt(n)[CLOSE_PLOT]
};
TradingView.Series.prototype.hl2 = function (n) {
    return(this.high(n) + this.low(n)) / 2
};
TradingView.Series.prototype.hlc3 = function (n) {
    return(this.high(n) + this.low(n) + this.close(n)) / 3
};
TradingView.Series.prototype.ohlc4 = function (n) {
    return(this.open(n) + this.high(n) + this.low(n) + this.close(n)) / 4
};
TradingView.Series.prototype.priceRange = function (n, t) {
    var r;
    if (!isInteger(n))return TradingView.logDebug("Series.priceRange: incorrect startBar"), null;
    if (!isInteger(t))return TradingView.logDebug("Series.priceRange: incorrect endBar"), null;
    if (this.data().isEmpty())return null;
    if (this.isLockScale()) {
        r = this.data().boxSize;
        void 0 === r && this.fixBoxSize();
        var i = this.priceScale().internalHeight() / (this.model().timeScale().barSpacing() / this.data().boxSize), r = this.data().search(t, SEARCH_NEAREST_LEFT), r = (r.value[HIGH_PLOT] + r.value[LOW_PLOT]) / 2, i = new PriceRange(r - .5 * i, r + .5 * i), r = this.data().search(n, SEARCH_NEAREST_RIGHT);
        return this.priceScale().properties().percentage.value() && i ? i.convertToPercents(r.value[CLOSE_PLOT]) : i
    }
    return this.properties().style.value === TradingView.Series.STYLE_PNF && (r = this.data().boxSize, i.apply(i.minValue() - .5 * r, i.maxValue() + .5 * r)), i = function (n, t, i) {
        return n.firstBar || (n.firstBar = i), null === n.range ? n.range = new PriceRange(i[LOW_PLOT], i[HIGH_PLOT]) : n.range.apply(i[LOW_PLOT], i[HIGH_PLOT]), n
    }, r = {range: null, firstBar: null}, r = this.data().bars().range(n, t).reduce(i, r), r = this.data().nsBars().range(n, t).reduce(i, r), i = r.range, r = r.firstBar, i && i.minValue() === i.maxValue() && (i = new PriceRange(i.minValue() - .5, i.maxValue() + .5)), this.priceScale().properties().percentage.value() && i ? i.convertToPercents(r[CLOSE_PLOT]) : this.priceScale().isLog() && i ? new PriceRange(this.priceScale().priceToLogical(i.minValue()), this.priceScale().priceToLogical(i.maxValue())) : i
};
TradingView.Series.prototype.nearestData = function (n, t) {
    if (isInteger(n)) {
        var i = this.data().search(n, t);
        return i ? i : void 0
    }
    TradingView.logDebug("Series.nearestData: incorrect logicalPoint")
};
TradingView.Series.prototype.nearestIndex = function (n, t) {
    var i = this.nearestData(n, t);
    if (i)return i.index
};
TradingView.Series.prototype.paneViews = function (n) {
    return this.properties().visible.value() ? (n = (new List).append(this._paneView), this._futureBarsPaneView && n.append(this._futureBarsPaneView), this._projectionBarsPaneView && n.append(this._projectionBarsPaneView), n.append(this._priceLineView), n.append(this._symbolLabelView), n) : null
};
TradingView.Series.prototype.dataWindowView = function () {
    return this._dataWindowView
};
TradingView.Series.prototype.statusView = function () {
    return this._statusView
};
TradingView.Series.prototype.priceAxisViews = function (n, t) {
    return this.m_model.paneForSource(this) === n && t === this.priceScale() && (this.properties().showLastValue.value() || this.properties().showCountdown.value()) ? this._priceAxisViews : null
};
TradingView.Series.prototype.base = function () {
    return this._base
};
TradingView.Series.prototype.formatter = function () {
    return this._formatter
};
TradingView.Series.prototype.purgeSymbolInfo = function () {
    this._symbolInfo = null
};
TradingView.Series.prototype.symbolInfo = function () {
    return this._symbolInfo
};
TradingView.Series.prototype._recreateFormatter = function () {
    if ("default" == this.properties().minTick.value())this._formatter = new PriceFormatter(this._symbolInfo ? this._symbolInfo.pricescale : 100, this._symbolInfo ? this._symbolInfo.minmov : 1, this._symbolInfo ? this._symbolInfo.fractional : !1, this._symbolInfo ? this._symbolInfo.minmove2 : void 0); else {
        var n = this.properties().minTick.value().split(","), t = parseInt(n[0]), i = parseInt(n[1]);
        this._formatter = new PriceFormatter(t, i, "true" === n[2])
    }
    this.priceScale() && this.priceScale().updateFormatter()
};
TradingView.Series.prototype.updateSymbolInfo = function (n) {
    var i = this, t = n && (n.pro_name || n.full_name);
    (this._symbolInfo = n) && (this.Q2.shortName.setValue(n.name), t && this.Q2.symbol.value().toUpperCase() !== t.toUpperCase() && this.Q2.symbol.setValue(t));
    this._base = n ? n.pricescale / n.minmov : 100;
    this._recreateFormatter();
    this._statusView.update();
    this.priceScale().updateFormatter();
    "undefined" != typeof quoteSessionMultiplexerInstance && (this._quoteSessionClientId || (this._quoteSessionClientId = "series-" + TradingView.guid()), this._quoteSessionSymbol && (quoteSessionMultiplexerInstance.simple.unsubscribe(this._quoteSessionClientId, this._quoteSessionSymbol), this._quoteSessionSymbol = void 0), t && (this._quoteSessionSymbol = t, quoteSessionMultiplexerInstance.simple.subscribe(this._quoteSessionClientId, this._quoteSessionSymbol, function (n, t) {
        i.quoteData = n && n.values || null;
        t && t.values && t.values.current_session && i.marketStatus.setValue(t.values.current_session)
    })));
    this.checkInterval();
    this.dataPoweredBy = TradingView.getDataVendorString(n)
};
TradingView.Series.prototype.symbolSameAsCurrent = function (n) {
    if (this.m_symbol === n)return!0;
    var t = this._symbolInfo;
    return!t || t.full_name !== n && t.pro_name !== n ? !1 : !0
};
TradingView.Series.prototype.updateAllViews = function () {
    this._paneView.update();
    this._dataWindowView.update();
    this._statusView.update();
    this._priceAxisViews.item(0).update();
    this._priceAxisViews.item(1).update();
    this._futureBarsPaneView && this._futureBarsPaneView.update();
    this._projectionBarsPaneView && this._projectionBarsPaneView.update();
    this._priceLineView.update();
    this._symbolInfo && this._symbolLabelView.update()
};
TradingView.Series.prototype.tags = function () {
    var n = [this.Q2.symbol.value(), this.Q2.interval.value() + "minutes"], t;
    return this._symbolInfo && this._symbolInfo.description && (t = this._symbolInfo.description.replace(",", "").split(" "), n.push(t)), n
};
TradingView.Series.prototype._setStatus = function (n) {
    this._status = n;
    this._statusView.update();
    this.m_model.updateSource(this);
    this._onStatusChanged.fire()
};
TradingView.Series.prototype.requestMoreData = function () {
    var n, t;
    this._status !== TradingView.Series.STATUS_READY && this._status !== TradingView.Series.STATUS_PULSE && this._status !== TradingView.Series.STATUS_DELAYED && this._status !== TradingView.Series.STATUS_DELAYED_STREAMING && this._status !== TradingView.Series.STATUS_EOD || this.m_model.timeScale().isEmpty() || (n = this.m_model.timeScale().visibleBars(), n.isEmpty() || 0 === this.bars().size() || (t = n.lastBar() - this.data().last(), this._predictBars < t && (this._predictBars = t, this._chartApi && this._chartApi.connected() && this._chartApi.requestMoreTickmarks(this._seriesId, t, this._handler)), this._endOfData || (n = this.bars()._indexAt(0) - n.firstBar(), 0 >= n || (this._endOfData = !0, this._chartApi && this._chartApi.connected() && this._chartApi.requestMoreData(this._seriesId, n, this._handler), this._setStatus(TradingView.Series.STATUS_LOADING)))))
};
TradingView.Series.prototype.bindJapChartsInputs = function () {
    this.Q2.style.listeners().subscribe(this, this.onChartStyleChanged);
    this.Q2.renkoStyle.inputs.boxSize.listeners().subscribe(this, this.onInputChanged);
    this.Q2.renkoStyle.inputs.source.listeners().subscribe(this, this.onInputChanged);
    this.Q2.renkoStyle.inputs.style.listeners().subscribe(this, this.onInputChanged);
    this.Q2.renkoStyle.inputs.atrLength.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pbStyle.inputs.lb.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pbStyle.inputs.source.listeners().subscribe(this, this.onInputChanged);
    this.Q2.kagiStyle.inputs.reversalAmount.listeners().subscribe(this, this.onInputChanged);
    this.Q2.kagiStyle.inputs.source.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pnfStyle.inputs.boxSize.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pnfStyle.inputs.reversalAmount.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pnfStyle.inputs.sources.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pnfStyle.inputs.style.listeners().subscribe(this, this.onInputChanged);
    this.Q2.pnfStyle.inputs.atrLength.listeners().subscribe(this, this.onInputChanged);
    var n = this;
    this.Q2.lockScale.listeners().subscribe(this, function (t) {
        t.value() && n.model().timeScale().recalcLockedScale()
    })
};
TradingView.Series.prototype.createExtendedHoursProperty = function () {
    function t() {
        var t = n.Q2.extendedHours.value();
        t && (1440 >= +n.Q2.interval.value() || (t = !1));
        n.extendedHours.setValue(t)
    }

    var n = this;
    n.extendedHours = new Property;
    n.Q2.extendedHours.listeners().subscribe(null, t);
    n.Q2.interval.listeners().subscribe(null, t);
    n.chartWidgetInitialized.subscribe(null, t);
    t()
};
TradingView.Series.prototype.isNeedRestart = function (n) {
    if (void 0 === n && (n = this.properties().style.value()), this._prevChartStyle != n) {
        var t = [TradingView.Series.STYLE_BARS, TradingView.Series.STYLE_CANDLES, TradingView.Series.STYLE_HOLLOW_CANDLES, TradingView.Series.STYLE_LINE, TradingView.Series.STYLE_AREA];
        if (!(-1 < t.indexOf(this._prevChartStyle) && -1 < t.indexOf(n)))return!0
    }
    return!1
};
TradingView.Series.prototype.onChartStyleChanged = function () {
    this.isNeedRestart() && (this.data().clear(), this.model().timeScale().scrollToRealtime(!1), this.restart());
    this._prevChartStyle = this.properties().style.value();
    this._onChangedStyle.fire(this.properties().style.value())
};
TradingView.Series.prototype.onInputChanged = function () {
    this.restart()
};
TradingView.Series.prototype.onExtendedHoursChanged = function () {
    return this._extendedHoursChanged
};
TradingView.Series.prototype.getSymbolString = function () {
    var n, t;
    n = J77.enabled("pay_attention_to_ticker_not_symbol") ? this._symbolInfo ? this._symbolInfo.ticker : this.Q2.symbol.value() : this.Q2.symbol.value();
    this.extendedHours.value() && (n = {symbol: n, session: "extended"});
    switch (this.Q2.style.value()) {
        case TradingView.Series.STYLE_RENKO:
            t = this.Q2.renkoStyle.inputs;
            n = {symbol: n, type: "BarSetRenko@tv-prostudies-1!", inputs: [t.source.value(), t.style.value(), t.boxSize.value(), t.atrLength.value()]};
            break;
        case TradingView.Series.STYLE_PB:
            t = this.Q2.pbStyle.inputs;
            n = {symbol: n, type: "BarSetPriceBreak@tv-prostudies-1!", inputs: [t.source.value(), t.lb.value()]};
            break;
        case TradingView.Series.STYLE_KAGI:
            t = this.Q2.kagiStyle.inputs;
            n = {symbol: n, type: "BarSetKagi@tv-prostudies-1!", inputs: [t.source.value(), t.reversalAmount.value()]};
            break;
        case TradingView.Series.STYLE_PNF:
            t = this.Q2.pnfStyle.inputs;
            n = {symbol: n, type: "BarSetPnF@tv-prostudies-1!", inputs: [t.sources.value(), t.style.value(), t.boxSize.value(), t.atrLength.value(), t.reversalAmount.value()]};
            break;
        case TradingView.Series.STYLE_HEIKEN_ASHI:
            n = {symbol: n, type: "BarSetHeikenAshi@tv-basicstudies-1!", inputs: []}
    }
    return"string" != typeof n && (n = "=" + JSON.stringify(n)), n
};
TradingView.Series.prototype.getStyleShortName = function () {
    switch (this.Q2.style.value()) {
        case TradingView.Series.STYLE_BARS:
            return"bar";
        case TradingView.Series.STYLE_CANDLES:
            return"candle";
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            return"hollowCandle";
        case TradingView.Series.STYLE_LINE:
            return"line";
        case TradingView.Series.STYLE_AREA:
            return"area";
        case TradingView.Series.STYLE_RENKO:
            return"renko";
        case TradingView.Series.STYLE_PB:
            return"pb";
        case TradingView.Series.STYLE_KAGI:
            return"kagi";
        case TradingView.Series.STYLE_PNF:
            return"pnf";
        case TradingView.Series.STYLE_HEIKEN_ASHI:
            return"ha";
        default:
            throw Error("Missed short name for style " + this.Q2.style.value());
    }
};
TradingView.Series.prototype.getInputsProperties = function () {
    var n = this.Q2[this.getStyleShortName() + "Style"];
    return n.inputs || n.addProperty("inputs"), n.inputs
};
TradingView.Series.prototype.getRealVisibleRange = function () {
    var n = this.model().timeScale().visibleBars(), t;
    return t = this.data().search(n.m_firstBar, SEARCH_NEAREST_RIGHT), n = this.data().search(n.m_lastBar, SEARCH_NEAREST_LEFT), void 0 === t || void 0 === n ? null : new BarsRange(t.index, n.index)
};
TradingView.Series.prototype.isLockScale = function () {
    return this.properties().lockScale.value()
};
TradingView.Series.prototype.firstValue = function () {
    return this.data().firstValue()
};
TradingView.Series.prototype.firstBar = function () {
    return this.data().firstBar()
};
TradingView.Series.prototype.sessionsStudy = function () {
    var t, n;
    if (this._sessionsStudy)return this._sessionsStudy;
    for (t = this.model().paneForSource(this).Q19(), i = 0; i < t.size(); i++)if (n = t.item(i), n instanceof TradingView.Study && "Sessions" == n.metaInfo().shortId)return this._sessionsStudy = n;
    return!1
};
TradingView.Series.prototype.createSessStudy = function () {
    if (!J77.enabled("charting_library") && !this.sessionsStudy()) {
        var n = StudyMetaInfo.findStudyMetaInfo(this.model().studiesMetaData(), "Sessions@tv-basicstudies");
        this.model().insertStudy(n, !1, !0);
        this.extendedHours.value() || this.disableSessionBackground();
        this._onSessionsStudyCreated.fire()
    }
};
TradingView.Series.prototype.checkSessStudy = function () {
    J77.enabled("charting_library") || (this.sessionsStudy() || this.createSessStudy(), this.sessionsStudy().start())
};
TradingView.Series.prototype.disableSessionBackground = function () {
    this.sessionsStudy() && (this.sessionsStudy().properties().graphics.backgrounds.inSession.visible.setValue(!1), this.sessionsStudy().properties().graphics.backgrounds.outOfSession.visible.setValue(!1))
};
TradingView.Series.prototype.isSpread = function () {
    return 1 < this._symbolInfo.legs.length
};
TradingView.Series.prototype.firstSymbol = function () {
    return this._symbolInfo ? this._symbolInfo.legs[0] : ""
};
TradingView.Series.prototype.firstShortName = function () {
    return D68.ticker(this.firstSymbol())
};
TradingView.Series.prototype.onSessionsStudyCreated = function () {
    return this._onSessionsStudyCreated
};
TradingView.Series.prototype.loadDataTo = function (n) {
    n.right(1);
    this._turnaround = "s" + ++this._turnaroundCounter;
    var t = this.Q2.interval.value(), t = this._generateTimeframe(t, n);
    this._chartApi.modifySeries(this._seriesId, this._turnaround, this._symbolId, t, this._handler)
};
TradingView.Series.prototype.checkInterval = function () {
    if (this._symbolInfo && (this.isDWM() || this._symbolInfo.has_intraday || this.requestingIntradayWhenNotSupported.fire(), this._symbolInfo.hasOwnProperty("supported_resolutions"))) {
        var n = this.Q2.interval.value();
        -1 == this._symbolInfo.supported_resolutions.indexOf(n) && this.requestingResolutionWhenNotSupported.fire(this._symbolInfo.supported_resolutions[0])
    }
};
TradingView.Series.prototype.setPriceScale = function (n) {
    this.m_priceScale != n && (this.m_priceScale = n, this.priceScaleChanged.fire(n))
};
inherit(SeriesDataWindowView, DataWindowView);
SeriesDataWindowView.prototype.update = function () {
    this._invalidated = !0
};
SeriesDataWindowView.prototype._updateImpl = function () {
    var t, i;
    if (this._series.symbolInfo() ? (this._header = [this._series.symbolInfo().name, translatedIntervalString(this._series.interval()), this._series.symbolInfo().exchange].join(", "), this._title = this._series.symbolInfo().description) : this._header = this._series.symbol(), this._items.item(0).setValue($.t("n/a")), this._items.item(1).setValue($.t("n/a")), this._items.item(2).setValue($.t("n/a")), this._items.item(3).setValue($.t("n/a")), !this.Q0.timeScale().isEmpty() && 0 !== this._series.bars().size()) {
        var r = this._series.barColorer(), n = this.Q0.crossHairSource().index, n = this._series.nearestIndex(n, SEARCH_NEAREST_LEFT);
        if (void 0 !== n)for (t = this._series.data().valueAt(n), i = this._series.formatter(), this._items.item(0).setValue(i.format(t[OPEN_PLOT])), this._items.item(1).setValue(i.format(t[HIGH_PLOT])), this._items.item(2).setValue(i.format(t[LOW_PLOT])), this._items.item(3).setValue(i.format(t[CLOSE_PLOT])), r = r.barStyle(n, !1), n = 0; 4 > n; n++)this._items.item(n).setColor(r.barColor)
    }
};
SeriesDataWindowView.prototype.items = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), this._items
};
SeriesDataWindowView.prototype.dump = function () {
    return{header: this._header, items: this._items}
};
SeriesDataWindowView.prototype.additional = function () {
    if (this._series.dataPoweredBy)return"(Data Provided by " + this._series.dataPoweredBy + ")"
};
J14.prototype.update = function () {
    this._invalidated = !0
};
J14.prototype._updateImpl = function () {
    var o = this, t, u, n, i, r;
    if (this.m_bars.clear(), !this.m_model.timeScale().isEmpty() && !this.m_series.priceScale().isEmpty() && (u = this.m_model.timeScale().visibleBars(), !u.isEmpty() && 0 !== this.m_series.bars().size())) {
        for (t = this.m_series.nearestIndex(u.firstBar(), SEARCH_NEAREST_RIGHT), i = this.m_series.nearestIndex(u.lastBar(), SEARCH_NEAREST_LEFT); t <= i && void 0 === this.m_series.bars().valueAt(t); t++);
        if (!(t > i)) {
            u = this.m_series.bars().range(t, i);
            n = void 0;
            this.m_series.bars().first();
            var f = this.m_series.priceScale(), s = f.properties().percentage.value(), h = this.m_series.barColorer(), e = {};
            if (u.each(function (t, i) {
                var r, u;
                void 0 != i[OPEN_PLOT] && void 0 != i[HIGH_PLOT] && void 0 != i[LOW_PLOT] && void 0 != i[CLOSE_PLOT] && (void 0 === n && (n = i[CLOSE_PLOT]), r = new BarItem, r.setTime(Math.round(t)), s ? (r.setOpen(100 * (i[OPEN_PLOT] - n) / n), r.setHigh(100 * (i[HIGH_PLOT] - n) / n), r.setLow(100 * (i[LOW_PLOT] - n) / n), r.setClose(100 * (i[CLOSE_PLOT] - n) / n)) : (r.setOpen(i[OPEN_PLOT]), r.setHigh(i[HIGH_PLOT]), r.setLow(i[LOW_PLOT]), r.setClose(i[CLOSE_PLOT])), e.value = i, u = h.barStyle(t, !1, e), e.previousValue = i, r.color = u.barColor, r.borderColor = u.barBorderColor, r.hollow = u.isBarHollow, o.m_bars.append(r))
            }, this), f.barPricesToCoordinates(this.m_bars), this.m_model.timeScale().barIndexesToCoordinates(this.m_bars), this.m_series === this.m_model.selectedSource())for (u = (new SelectionIndexes).calc(t, i), this._selectionData = {points: new List}, this._selectionData.hittestResult = HitTestResult.REGULAR, t = 0; t < u.size(); t++)i = u.item(t), r = this.m_series.bars().valueAt(i), r && (r = .5 * (r[OPEN_PLOT] + r[CLOSE_PLOT]), f.properties().percentage.value() && (r = 100 * (r - n) / n), i = this.m_model.timeScale().indexToCoordinate(i), r = this.m_series.priceScale().priceToCoordinate(r), this._selectionData.points.append(new MathEx.Point(i, r)))
        }
    }
};
J14.prototype.items = function () {
    return this.m_bars
};
J14.prototype.dump = function () {
    var n = {};
    return n.bars = this.m_bars, n
};
inherit(J15, J14);
J15.prototype.renderer = function () {
    var n, t;
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), n = {}, n.bars = this.m_bars, n.barSpacing = this.m_model.timeScale().barSpacing(), n.dontDrawOpen = this.m_series.properties().barStyle.dontDrawOpen.value(), t = new CompositeRenderer, t.append(new J56(n)), this.m_series === this.m_model.selectedSource() && t.append(new SelectionRenderer(this._selectionData)), t
};
inherit(J16, J14);
J16.prototype.renderer = function () {
    var n, t;
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), n = {}, n.bars = this.m_bars, n.barSpacing = this.m_model.timeScale().barSpacing(), n.drawWick = this.m_series.properties().candleStyle.drawWick.value(), n.drawBorder = this.m_series.properties().candleStyle.drawBorder.value(), n.borderColor = this.m_series.properties().candleStyle.borderColor.value(), n.wickColor = this.m_series.properties().candleStyle.wickColor.value(), t = new CompositeRenderer, t.append(new J57(n)), this.m_series === this.m_model.selectedSource() && t.append(new SelectionRenderer(this._selectionData)), t
};
inherit(J17, J14);
J17.prototype.renderer = function () {
    var n, t;
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), n = {}, n.bars = this.m_bars, n.barSpacing = this.m_model.timeScale().barSpacing(), n.drawWick = this.m_series.properties().haStyle.drawWick.value(), n.drawBorder = this.m_series.properties().haStyle.drawBorder.value(), n.borderColor = this.m_series.properties().haStyle.borderColor.value(), n.wickColor = this.m_series.properties().haStyle.wickColor.value(), t = new CompositeRenderer, t.append(new J57(n)), this.m_series === this.m_model.selectedSource() && t.append(new SelectionRenderer(this._selectionData)), t
};
inherit(J18, J14);
J18.prototype.renderer = function () {
    var n, t;
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), n = {}, n.bars = this.m_bars, n.barSpacing = this.m_model.timeScale().barSpacing(), n.drawWick = this.m_series.properties().hollowCandleStyle.drawWick.value(), n.drawBorder = this.m_series.properties().hollowCandleStyle.drawBorder.value(), n.borderColor = this.m_series.properties().hollowCandleStyle.borderColor.value(), n.wickColor = this.m_series.properties().hollowCandleStyle.wickColor.value(), t = new CompositeRenderer, t.append(new J57(n)), this.m_series === this.m_model.selectedSource() && t.append(new SelectionRenderer(this._selectionData)), t
};
J29.prototype.update = function () {
    var n, u, e;
    if (this.m_items.clear(), !this.m_model.timeScale().isEmpty() && this.m_series.priceScale() && !this.m_series.priceScale().isEmpty() && (n = this.m_model.timeScale().visibleBars(), !n.isEmpty() && 0 !== this.m_series.bars().size())) {
        var f = this.m_series.nearestIndex(n.firstBar(), SEARCH_NEAREST_RIGHT), o = this.m_series.nearestIndex(n.lastBar(), SEARCH_NEAREST_LEFT), n = this.m_series.bars().range(f, o);
        this.m_series.bars();
        u = void 0;
        e = this.m_series.priceScale();
        this.m_series.barColorer();
        for (var s = {color: this.m_series.properties().lineStyle.color.value()}, h = e.properties().percentage.value(), r = n._start; r < n._end; ++r) {
            var i = n._indexAt(r), t = n._valueAt(r), t = this._barGetter(t);
            void 0 !== t && null !== t && (void 0 === u && (u = t), h && (t = 100 * (t - u) / u), i = new MathEx.Point(i, t), i.style = s, this.m_items.append(i))
        }
        if (e.pointsArrayToCoordinates(this.m_items.toArray()), this.m_model.timeScale().indexesToCoordinates(this.m_items), this.m_series === this.m_model.selectedSource())for (n = (new SelectionIndexes).calc(f, o), this._selectionData = {points: new List}, this._selectionData.hittestResult = HitTestResult.REGULAR, r = 0; r < n.size(); r++)i = n.item(r), f = this.m_series.data().valueAt(i), t = this._barGetter(f), e.properties().percentage.value() && (t = 100 * (t - u) / u), i = this.m_model.timeScale().indexToCoordinate(i), f = this.m_series.priceScale().priceToCoordinate(t), this._selectionData.points.append(new MathEx.Point(i, f))
    }
};
inherit(J20, J29);
J20.prototype.update = function () {
    this._invalidated = !0
};
J20.prototype.renderer = function () {
    this._invalidated && (J29.prototype.update.call(this), this._invalidated = !1);
    var n = this.m_series.properties().lineStyle, n = {barSpacing: this.m_model.timeScale().barSpacing(), items: this.m_items, lineColor: n.color.value(), lineStyle: n.linestyle.value(), withMarkers: n.styleType.value() === TradingView.Series.STYLE_LINE_TYPE_MARKERS, withSteps: n.styleType.value() === TradingView.Series.STYLE_LINE_TYPE_STEP, lineWidth: n.linewidth.value(), simpleMode: !0}, n = new J68(n), t;
    return this.m_series === this.m_model.selectedSource() ? (t = new CompositeRenderer, t.append(n), t.append(new SelectionRenderer(this._selectionData))) : t = n, t
};
inherit(J13, J29);
J13.prototype.update = function () {
    this._invalidated = !0
};
J13.prototype.renderer = function () {
    var n, t;
    return this._invalidated && (J29.prototype.update.call(this), this._invalidated = !1), n = {simpleMode: !1}, n.barSpacing = this.m_model.timeScale().barSpacing(), n.items = this.m_items, n.lineColor = this.m_series.properties().areaStyle.linecolor.value(), n.lineStyle = this.m_series.properties().areaStyle.linestyle.value(), n.lineWidth = this.m_series.properties().areaStyle.linewidth.value(), t = this.m_series.properties().areaStyle.transparency.value(), n.color1 = generateColor(this.m_series.properties().areaStyle.color1.value(), t), n.color2 = generateColor(this.m_series.properties().areaStyle.color2.value(), t), n.bottom = this.m_series.priceScale().height(), t = new CompositeRenderer, t.append(new J53(n)), this.m_series === this.m_model.selectedSource() && t.append(new SelectionRenderer(this._selectionData)), t
};
inherit(SeriesStatusView, StatusView);
SeriesStatusView.prototype.Q20 = function () {
    delete this._text;
    this.update()
};
SeriesStatusView.prototype.round = function (n, t) {
    var i = Math.round(n * Math.pow(10, t)) / Math.pow(10, t);
    return i ? i : ""
};
SeriesStatusView.prototype.update = function () {
    var n, t;
    if (!this._text) {
        this._text = this._series.symbolInfo() ? this._series.symbolInfo().description : this._series.symbol();
        this._text += ", " + translatedIntervalString(this._series.interval());
        this._series.symbolInfo() && this._series.symbolInfo().exchange && (n = this._series.symbolInfo().exchange, "forex" == this._series.symbolInfo().type && (n = "FX"), this._text += ", " + n);
        n = this._series.Q2;
        switch (n.style.value()) {
            case TradingView.Series.STYLE_RENKO:
                t = n.renkoStyle.inputs.style.value() + ("ATR" === n.renkoStyle.inputs.style.value() ? "(" + n.renkoStyle.inputs.atrLength.value() + ")" : "");
                this._text += ", Renko [" + n.renkoStyle.inputs.source.value() + ", " + t + ", " + this.round(this._series.data().boxSize, 4) + "]";
                break;
            case TradingView.Series.STYLE_PB:
                this._text += ", Line Break [" + n.pbStyle.inputs.source.value() + ", " + n.pbStyle.inputs.lb.value() + "]";
                break;
            case TradingView.Series.STYLE_KAGI:
                this._text += ", Kagi [" + n.kagiStyle.inputs.source.value() + ", " + n.kagiStyle.inputs.reversalAmount.value() + "]";
                break;
            case TradingView.Series.STYLE_PNF:
                t = n.pnfStyle.inputs.style.value() + ("ATR" === n.pnfStyle.inputs.style.value() ? "(" + n.pnfStyle.inputs.atrLength.value() + ")" : "");
                this._text += ", PnF [" + n.pnfStyle.inputs.sources.value() + ", " + t + ", " + this.round(this._series.data().boxSize, 4) + ", " + n.pnfStyle.inputs.reversalAmount.value() + "]";
                break;
            case TradingView.Series.STYLE_HEIKEN_ASHI:
                this._text += ", " + $.t("Heiken Ashi")
        }
        this._bold = !1;
        this._size = "17px"
    }
};
inherit(SeriesPriceAxisView, PriceAxisView);
SeriesPriceAxisView.prototype.update = function () {
    this._invalidated = !0
};
SeriesPriceAxisView.prototype._updateImpl = function (n) {
    var t, i;
    this._text = "";
    this._visible = !1;
    (n = this._series.lastValueData()) && (this._visible = !0, this._text = this._series.properties().showLastValue.value() ? n.text : "", this._background = n.color, this._coordinate = n.coordinate, this._floatCoordinate = n.floatCoordinate, this._textHeight = this._series.priceScale().m_markBuilder.fontHeight(), this._countdown = null, J77.enabled("countdown") && this._series.properties().showCountdown.value() && (n = [TradingView.Series.STYLE_BARS, TradingView.Series.STYLE_CANDLES, TradingView.Series.STYLE_LINE, TradingView.Series.STYLE_AREA, TradingView.Series.STYLE_HOLLOW_CANDLES, TradingView.Series.STYLE_HEIKEN_ASHI], !this._series.isDWM() && -1 != n.indexOf(this._series.properties().style.value()))) && (t = 1e3 * this._series.data().bars().last().value[0], (new Date).getTimezoneOffset(), i = 1e3 * this._series.serverTimeOffset(), n = this._series.interval(), t = Math.round((t.valueOf() + 6e4 * n - ((new Date).valueOf() + i)) / 1e3), 0 < t && (t = Math.min(t, 60 * n), n = "", 3600 <= t && (n = "" + Math.floor(t / 3600) + ":"), t %= 3600, i = ("0" + Math.floor(t / 60)).right(2), t = ("0" + Math.floor(t % 60)).right(2), this._countdown = n + i + ":" + t))
};
SeriesPriceAxisView.prototype.font = function () {
    return"11px Arial"
};
SeriesPriceAxisView.prototype.coordinate = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.coordinate.call(this)
};
SeriesPriceAxisView.prototype.renderer = function () {
    this._invalidated && (this._updateImpl(), this._invalidated = !1);
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: this._visible, font: this.font(), secondLine: this._countdown};
    return new PriceAxisViewRenderer(n)
};
SeriesPriceAxisView.prototype.dump = function () {
    return{text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: this._visible}
};
SeriesPriceAxisView.prototype.text = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.text.call(this)
};
inherit(ProjectionSeriesPriceAxisView, SeriesPriceAxisView);
ProjectionSeriesPriceAxisView.prototype.lastPrice = function () {
    return this._series.data().lastProjectionPrice
};
ProjectionSeriesPriceAxisView.prototype._updateImpl = function (n) {
    var i, t;
    this._text = "";
    this._visible = !1;
    this.Q0.timeScale().isEmpty() || this._series.priceScale().isEmpty() || !this.lastPrice() || (n = this.Q0.timeScale().visibleBars(), n.isEmpty()) || (i = this._series.data().search(n.lastBar(), SEARCH_NEAREST_LEFT), void 0 !== i && (n = this._series.nearestIndex(n.firstBar(), SEARCH_NEAREST_RIGHT), n = this._series.data().valueAt(n)[CLOSE_PLOT], this._visible = !0, this._series.data().last(), t = this.lastPrice(), this._series.priceScale().properties().percentage.value() && (t = 100 * (t - n) / n), this._text = this._series.priceScale().formatter().format(t), this._background = this._series.barColorer().barStyle(i.index, !0).barColor, this._coordinate = this._series.priceScale().priceToCoordinate(t), this._textHeight = this._series.priceScale().m_markBuilder.fontHeight()))
};
TradingView.StudyConsts = {PLOT_TYPE_LINE: "line", PLOT_TYPE_COLORER: "colorer", PLOT_TYPE_BAR_COLORER: "bar_colorer", PLOT_TYPE_BG_COLORER: "bg_colorer", PLOT_TYPE_SHAPES: "shapes", PLOT_TYPE_CHARS: "chars", PLOT_TYPE_ARROWS: "arrows", PLOT_TYPE_DATAOFFSET: "dataoffset", PLOT_LINE: 0, PLOT_HISTOGRAM: 1, PLOT_CROSS: 3, PLOT_AREA: 4, PLOT_COLUMNS: 5, PLOT_CIRCLES: 6, PLOT_LINE_WITH_BREAKS: 7, PLOT_AREA_WITH_BREAKS: 8, SCALE_RIGHT: 0, SCALE_LEFT: 1, SCALE_NONE: 2};
TradingView.StudyPlotShapes = {};
TradingView.StudyPlotShapes.Data = {};
TradingView.StudyPlotShapes.registerPlotShape = function (n, t, i, r) {
    if (n in TradingView.StudyPlotShapes.Data)throw Error("Plot shape " + n + " already registered!");
    TradingView.StudyPlotShapes.Data[n] = {id: n, pineName: t, guiName: i, paneRendererClass: r}
};
TradingView.StudyPlotShapes.SHAPE_CROSS = "shape_cross";
TradingView.StudyPlotShapes.SHAPE_XCROSS = "shape_xcross";
TradingView.StudyPlotShapes.SHAPE_CIRCLE = "shape_circle";
TradingView.StudyPlotShapes.SHAPE_TRIANGLE_UP = "shape_triangle_up";
TradingView.StudyPlotShapes.SHAPE_TRIANGLE_DOWN = "shape_triangle_down";
TradingView.StudyPlotShapes.SHAPE_FLAG = "shape_flag";
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_CROSS, "shape.cross", "Cross", "J63");
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_XCROSS, "shape.xcross", "X Cross", "J74");
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_CIRCLE, "shape.circle", "Circle", "J59");
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_TRIANGLE_UP, "shape.triangleup", "Triangle Up", "J72");
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_TRIANGLE_DOWN, "shape.triangledown", "Triangle Down", "J71");
TradingView.StudyPlotShapes.registerPlotShape(TradingView.StudyPlotShapes.SHAPE_FLAG, "shape.flag", "Flag", "J64");
J37.prototype.update = function () {
    this._visible = !1;
    var n = this.Q1.lastValueData(this._plotName, !0);
    n && (this._visible = !0, this._points = (new List).append(new MathEx.Point(0, n.coordinate)), this._color = n.color)
};
J37.prototype.renderer = function () {
    var n = {};
    return n.points = this._points, n.color = this._color, n.linewidth = this.Q1.properties().styles[this._plotName].linewidth.value(), n.linestyle = CanvasEx.LINESTYLE_DOTTED, n.hitTestResult = HitTestResult.REGULAR, n.visible = this._visible, new HorzLineRenderer(n)
};
TradingView.createStudy = function (n, t, i, r) {
    var u = "study_" + (r.classId || r.shortId);
    return TradingView[u] ? new TradingView[u](n, t, i, r) : new TradingView.Study(n, t, i, r)
};
TradingView.prepareStudyProperties = function (n, t, i, r) {
    return TradingView.prepareStudyPropertiesWithRoot(n, t, i, r, "study_" + n.id)
};
TradingView.prepareStudyPropertiesWithRoot = function (n, t, i, r, u) {
    for (t = TradingView.prepareStudyPropsState(n, t, i, r), u = new _52(u, t, !0), u.addExclusion("visible"), u.addExclusion("precision"), u.addExclusion("minTick"), t = 0; t < n.inputs.length; ++t)i = n.inputs[t], i.isHidden && (u.addExclusion("inputs." + t.toString()), u.addExclusion("inputs." + i.id));
    return u
};
TradingView.prepareStudyPropertiesForLoadChart = function (n, t, i, r, u) {
    return TradingView.prepareStudyPropertiesForLoadChartWithRoot(n, t, i, r, u, "study_" + n.id)
};
TradingView.prepareStudyPropertiesForLoadChartWithRoot = function (n, t, i, r, u, f) {
    for (i = TradingView.prepareStudyPropsStateForLoadChart(n, t, i, r, u), f = new _52(f, i, !0), f.addExclusion("visible"), f.addExclusion("precision"), f.addExclusion("minTick"), n = t || n, t = 0; t < n.inputs.length; ++t)i = n.inputs[t], i.isHidden && (f.addExclusion("inputs." + t.toString()), f.addExclusion("inputs." + i.id));
    return f
};
TradingView.prepareStudyPropsState = function (n, t, i, r) {
    var u, f;
    if (1 > StudyMetaInfo.versionOf(n))throw Error("This function cannot work with metainfo of the old format version. Required format version >= 1");
    return u = TradingView.clone(defaults("study")), TradingView.preparePlotStyles(u, n), f = TradingView.clone(defaults("study_" + n.id, r)), n.isTVScript && n.TVScriptSourceCode !== f.TVScriptSourceCode && (f = TradingView.clone(factoryDefaults("study_" + n.id, r))), TradingView.merge(u, f), t && (assert(!(t instanceof Property), "propsState should not be an instance of Property"), TradingView.merge(u, t)), t = TradingView.convertMetainfoInputsArrayToObject(n), r = {}, D0.mergeInputs(r, t.defaults.inputs), D0.mergeInputsObjPart(r, u.inputs), D0.mergeInputsArrPart(r, t.inputs), u.inputs = r, delete t.inputs, delete t.defaults.inputs, r = {}, TradingView.merge(r, t.defaults), TradingView.merge(r, factoryDefaults("study_" + t.id)), TradingView.merge(r, u), TradingView.merge(r, t), delete r.defaults, u = r, n = TradingView.calcDefaultColorsOffset(i, n), TradingView.merge(u, TradingView.shiftDefaultColors(u, n)), u
};
TradingView.prepareStudyPropsStateForLoadChart = function (n, t, i, r, u) {
    var e = StudyMetaInfo.versionOf(n), f, o;
    return n.version && i.version && n.version !== i.version && "undefined" != typeof console && console.warn("Serialized metaInfo version " + n.version + " is not equal to the saved state version " + i.version), f = TradingView.clone(defaults("study")), 0 == e ? (TradingView.merge(f, TradingView.clone(n)), o = TradingView.convertMetainfoInputsArrayToObject(n), TradingView.merge(f.inputs, o.inputs)) : 1 <= e && TradingView.merge(f, TradingView.clone(n.defaults)), TradingView.merge(f, factoryDefaults("study_" + n.id)), TradingView.preparePlotStyles(f, n), TradingView.merge(f, i), 1 <= e && (TradingView.merge(f, TradingView.clone(n)), delete f.defaults), f = u.updateStudyState(f, n, t), (n = t || n) && 1 <= StudyMetaInfo.versionOf(n) && (n = TradingView.convertMetainfoInputsArrayToObject(n), t = {}, D0.mergeInputs(t, n.defaults.inputs), D0.mergeInputs(t, f.inputs), D0.mergeInputsArrPart(t, n.inputs), f.inputs = t, delete n.inputs, delete n.defaults.inputs, t = {}, TradingView.merge(t, n.defaults), TradingView.merge(t, factoryDefaults("study_" + n.id)), TradingView.merge(t, f), TradingView.merge(t, n), delete t.defaults, f = t), r = TradingView.calcDefaultColorsOffset(r, n), TradingView.merge(f, TradingView.shiftDefaultColors(f, r)), f
};
TradingView.preparePlotStyles = function (n, t) {
    var i, r, f, u;
    if (t.plots)for (i = 0; i < t.plots.length; i++)r = t.plots[i].id, f = t.plots[i].type, f !== TradingView.Study.PLOT_TYPE_COLORER && (u = defaultPlotOptions(), u.plottype = f, u.title = r, n.styles && r in n.styles && TradingView.merge(u, n.styles[r]), n.styles[r] = u)
};
TradingView.convertMetainfoInputsArrayToObject = function (n) {
    var i = TradingView.clone(n), t;
    if (i.inputs = {}, n.inputs)for (t = 0; t < n.inputs.length; t++)i.inputs[n.inputs[t].id] = n.inputs[t].defval, i.inputs[t] = n.inputs[t];
    return i
};
TradingView.calcDefaultColorsOffset = function (n, t) {
    var u = 0, i, r;
    if (n)for (i = 0; i < n.Q19().size(); i++)r = n.Q19().item(i), r.metaInfo && r.metaInfo() && r.metaInfo().id == t.id && u++;
    return u
};
TradingView.shiftDefaultColors = function (n, t) {
    if (!t)return n;
    for (var i in n.styles)(color = n.styles[i].color) && (n.styles[i].color = TradingView.shiftColor(color, t));
    return n
};
TradingView.shiftColor = function (n, t) {
    n = new RGBColor(n);
    var i = TradingView.rgbToHsl(n.r, n.g, n.b), r = i[0] + .05 * t;
    return i[0] = r - Math.floor(r), i = TradingView.hslToRgb(i[0], i[1], i[2]), n.r = i[0], n.g = i[1], n.b = i[2], n.toHex()
};
TradingView.Study = function (n, t, i, r) {
    if (this._titleCache = {}, this._resolvedSymbols = {}, this._priceAxisViewsBase = new List, this._paneViews = new List, this._hlinesPriceAsisViews = new List, this._horizlinesPriceAsisViews = new List, PriceDataSource.call(this), this.m_data = new PlotList, this._graphics = new D62(r), this._plotOffsets = {}, this._plotOffsetsMetaInfoOverride = {}, this.Q0 = n, this._chartApi = n._chartApi, this._series = i, this._metaInfo = r, this.Q2 = t, this.Q2.listeners().subscribe(this, TradingView.Study.prototype.changeStyles), void 0 != this.Q2.inputs && this.Q2.inputs.listeners().subscribe(this, TradingView.Study.prototype.inputsChanged), this._turnaroundCounter = 1, this._turnaround = "st" + this._turnaroundCounter, this._status = "", this._plotFields = [], t = this.metaInfo().plots)for (i = 0, r = t.length; i < r; i++)this._plotFields.push(t[i].id);
    this.clearData();
    this._studyModified = !1;
    this._tagsChanged = new Delegate;
    this.createViews();
    var u = this;
    this._handler = function (n) {
        u.onData(n)
    };
    this._createFormatter();
    u = this;
    this.Q2.precision.listeners().subscribe(null, function () {
        u._createFormatter();
        u.Q0.Q20(new D22(D22.FULL_UPDATE))
    });
    this.Q2.showStudyArguments.listeners().subscribe(null, function () {
        u._titleCache = {}
    });
    this.Q2.description.listeners().subscribe(null, function () {
        u._titleCache = {}
    });
    this.Q2.shortDescription && this.Q2.shortDescription.listeners().subscribe(null, function () {
        u._titleCache = {}
    });
    J77.enabled("update_study_formatter_on_symbol_resolve") && n.mainSeries().onSymbolResolved().subscribe(this, TradingView.Study.prototype._createFormatter);
    this.Q2.showInDataWindow.listeners().subscribe(n, J79.prototype.fullUpdate)
};
inherit(TradingView.Study, PriceDataSource);
TradingView.merge(TradingView.Study, TradingView.StudyConsts);
TradingView.Study.prototype.lastValueData = function (n, t, i) {
    var u = {}, r, e, f;
    if (this.Q0.timeScale().isEmpty() || null == this.priceScale() || this.priceScale().isEmpty() || this.data().isEmpty() || (f = this.Q0.timeScale().visibleBars(), f.isEmpty()))return null;
    for (r = 0; r < this.metaInfo().plots.length && this.metaInfo().plots[r].id !== n; r++);
    if (!this.properties().visible.value() || !this.properties().styles[n].visible.value() || (e = this.offset(n), f = this.nearestIndex(f.lastBar() - e, SEARCH_NEAREST_LEFT), void 0 === f) || (this.data(), t = t ? this.data().last().value : this.data().valueAt(f), !t || !isNumber(t[r + 1])))return null;
    for (var s = this.metaInfo().plots, f = e = null, o = 0; o < s.length; o++)this.isSelfColorerPlot(o) && s[o].target === n && (e = o, f = this.metaInfo().palettes[s[o].palette], paletterProps = this.properties().palettes[s[o].palette]);
    if (r = t[r + 1], i && (u.price = r), this.priceScale().properties().percentage.value()) {
        if (i = this.firstValue(!0), !i)return null;
        r = this.priceScale().priceRange().convertToPercent(r, i)
    }
    return u.text = this.priceScale().formatter().format(r), n = this.properties().styles[n].color.value(), e && t.length > e + 1 ? (i = t[e + 1], u.color = void 0 != i ? paletterProps.colors[f.valToIndex ? f.valToIndex[i] : i].color.value() : n) : u.color = n, u.floatCoordinate = this.priceScale().priceToCoordinate(r, !0), u.coordinate = Math.round(u.floatCoordinate), u.item = t, u
};
TradingView.Study.prototype.series = function () {
    return this._series
};
TradingView.Study.prototype.model = function () {
    return this.Q0
};
TradingView.Study.prototype.clearData = function () {
    this.m_data = new PlotList(this._plotFields);
    this._graphics = new D62(this._metaInfo);
    this._plotOffsets = {}
};
TradingView.Study.prototype.onTagsChanged = function () {
    return this._tagsChanged
};
TradingView.Study.prototype.properties = function () {
    return this.Q2
};
TradingView.Study.prototype.state = function (n) {
    var t = {type: TradingView.className(this.constructor), id: this.id(), state: this.properties().state(), zorder: this.zorder()}, r, i;
    for (this.metaInfo()instanceof StudyMetaInfo ? t.metaInfo = this.metaInfo().state() : (t.metaInfo = $.extend({}, this.metaInfo()), t.metaInfo.id = StudyMetaInfo.parseIdString(t.metaInfo.id + (t.metaInfo.version ? "-" + t.metaInfo.version : "")).fullId), n && (t.data = this.m_data.state(), t.data.symbols = this._resolvedSymbols, t.data.graphics = this._graphics.graphics(), t.data.plotOffsets = this._plotOffsets), this.ownerSource() && (t.ownerSource = this.ownerSource().id()), n = 0; n < this._metaInfo.inputs.length; n++)"bar_time" == this._metaInfo.inputs[n].type && (r = this._metaInfo.inputs[n].id, i = t.state.inputs[r], 0 > i && (i = this._rightOffsetToUnixTime(-i), t.state.inputs[r] = i && 0 <= i ? i : 0));
    return t
};
TradingView.Study.prototype.uniqueId = function () {
    return this.id() + "|" + JSON.stringify(this.inputsForAlert())
};
TradingView.Study.prototype.stateForAlert = function () {
    var n = this.state(), t, i;
    for (n.data || (n.data = {}), n.data.completePlotOffsets = {}, t = 0; t < this._metaInfo.plots.length; ++t)i = this._metaInfo.plots[t].id, n.data.completePlotOffsets[i] = this.offset(i);
    return n.uniqueId = this.uniqueId(), n
};
TradingView.Study.prototype.isSavedInStudyTemplates = function () {
    for (var n = 0; n < this._metaInfo.inputs.length; n++)if ("bar_time" == this._metaInfo.inputs[n].type)return!1;
    return!0
};
TradingView.Study.prototype.restoreData = function (n) {
    this.m_data.restoreState(n);
    this._resolvedSymbols = n.symbols;
    this._graphics.setGraphics(n.graphics);
    this._postProcessGraphics();
    this._plotOffsets = n.plotOffsets
};
TradingView.Study.prototype.restart = function () {
    this._restarting = !0;
    J77.enabled("stop_study_on_restart") && this.stop();
    this._clearLoadingTimer();
    this.start()
};
TradingView.Study.prototype._clearLoadingTimer = function () {
    this.loadingTimer && (TradingView.logDebug("Study " + this._metaInfo.description + " loading took " + ((new Date).getTime() - this._loadingStartTime) + " ms"), clearTimeout(this.loadingTimer), this.loadingTimer = null)
};
TradingView.Study.prototype.stop = function () {
    this._clearLoadingTimer();
    this._chartApi && this._chartApi.connected() && this._studyId && this._chartApi.removeStudy(this._studyId, this._handler);
    J77.enabled("update_study_formatter_on_symbol_resolve") && this.Q0.mainSeries().onSymbolResolved().unsubscribe(this, TradingView.Study.prototype._createFormatter);
    this._studyId = null;
    this.clearData();
    this._unsubscribeExtendedHours();
    this.recalculate()
};
TradingView.Study.prototype._resolveSymbol = function (n) {
    function i(r) {
        t._chartApi.resolveSymbol(t._makeNextSymbolId(), r, function (r) {
            switch (r.method) {
                case"symbol_resolved":
                    t._resolvedSymbols[n] = r.params[1];
                    0 != t._studyId && t.stop();
                    t.start();
                    break;
                case"symbol_error":
                    if ("permission denied" === r.params[1] && r.params[2])switch (r.params[2]) {
                        case TradingView.Series.PD_REASON_EXTENDED_HOURS:
                            break;
                        case TradingView.Series.PD_REASON_SYMBOL:
                            if (r.params[3])return i(r.params[3]);
                            break;
                        default:
                            return i(r.params[2])
                    }
                    t._status = $.t("Invalid Symbol");
                    t.stop();
                    t.Q0.updateSource(t)
            }
        })
    }

    var t = this;
    i(n)
};
TradingView.Study.prototype._allSymbolsAreResolved = function () {
    for (var i, r, t = !0, n = 0; n < this._metaInfo.inputs.length; n++)"symbol" == this._metaInfo.inputs[n].type && (i = this._metaInfo.inputs[n].id, r = this.Q2.inputs[i].value(), this._resolvedSymbols[r] || (t = !1, this._resolveSymbol(r, this.Q2.inputs[i])));
    return t
};
TradingView.Study.prototype._allInputsAreValid = function () {
    for (var t, n = 0; n < this._metaInfo.inputs.length; n++)if ("bar_time" == this._metaInfo.inputs[n].type && (t = this.Q2.inputs[this._metaInfo.inputs[n].id].value(), void 0 == t || null == t))return!1;
    return!0
};
TradingView.Study.prototype.sourceId = function () {
    return this._studyId
};
TradingView.Study.prototype.isStarted = function () {
    return!!this._studyId
};
TradingView.Study.prototype.start = function () {
    if (this._chartApi && this._chartApi.connected() && this._allSymbolsAreResolved() && (!this.isStarted() || this._restarting) && (this._studyId = TradingView.Study.makeNextStudyId(), this._restarting = !1, this._allInputsAreValid())) {
        this._inputs = this.inputs();
        var n = this._metaInfo.id;
        if ("MA" === this._metaInfo.id) {
            switch (this._inputs[2]) {
                case"exp":
                    n = "MAExp@tv-basicstudies";
                    break;
                case"simple":
                    n = "MASimple@tv-basicstudies";
                    break;
                case"weighted":
                    n = "MAWeighted@tv-basicstudies";
                    break;
                case"volume weighted":
                    n = "MAVolumeWeighted@tv-basicstudies"
            }
            inputs = [inputs[0], inputs[1]]
        }
        n += "-" + (this._metaInfo.version || "1!");
        n = StudyMetaInfo.cutDollarHash(n);
        "Script@tv-scripting-1" === n && (n += "!");
        this._chartApi.createStudy(this._studyId, this._turnaround, this._series._seriesId, n, this._inputs, this._handler);
        this._subscribeExtendedHours()
    }
};
TradingView.Study._nextSymbolId = 0;
TradingView.Study.prototype._makeNextSymbolId = function () {
    return TradingView.Study._nextSymbolId++, "ss_" + TradingView.Study._nextSymbolId
};
TradingView.Study._nextStudyId = 0;
TradingView.Study.makeNextStudyId = function () {
    return TradingView.Study._nextStudyId++, "st" + TradingView.Study._nextStudyId
};
TradingView.Study.prototype._rightOffsetToUnixTime = function (n) {
    var t = null;
    return this._series.bars().size() >= n && (t = this._series.bars()._valueAt(this._series.bars().lastIndex() - n)[TIME_PLOT]), t
};
TradingView.Study.prototype.getSymbolString = function (n) {
    return this._series && this._series.extendedHours.value() ? "=" + JSON.stringify({symbol: n, session: "extended"}) : n
};
TradingView.Study.prototype.inputsForGUI = function () {
    return this.inputs({symbolsForDisplay: !0, skipHiddenInputs: !0, skipFakeInputs: !1, allowScriptCompile: !1})
};
TradingView.Study.prototype.inputsForAlert = function () {
    var n = this.offset(), t = this.inputs({symbolsForDisplay: !0, symbolsForChartApi: !0, skipHiddenInputs: !1, skipFakeInputs: !1, allowScriptCompile: !0});
    return n && t.push(n), t
};
TradingView.Study.prototype.inputs = function (n) {
    var t = {symbolsForDisplay: !1, symbolsForChartApi: !0, skipHiddenInputs: !1, skipFakeInputs: !0, allowScriptCompile: !0};
    return TradingView.merge(t, n), this._buildInputs(t)
};
TradingView.Study.prototype._buildInputs = function (n) {
    var t, r, u, i;
    assert(!!n, "options not set");
    try {
        t = this._prepareInputs(n)
    } catch (f) {
        console.warn("Failed to prepare study inputs: " + f);
        t = {}
    }
    return!n.symbolsForDisplay && this._metaInfo.isTVScript ? 0 == Object.keys(t).length || this._metaInfo.isTVScriptStub ? [this._metaInfo.defaults.inputs.text] : (r = null, u = this._metaInfo.TVScriptSourceCode, n.allowScriptCompile && window.scriptLib && u && (r = scriptLib.processScriptInputsChanged(u, this._metaInfo.version, t, this)), [D57.patchILTemplate(r || this._metaInfo.defaults.inputs.text, this._metaInfo, t)]) : (n.asObject ? (i = {}, Object.keys(t).forEach(function (n) {
        null != t[n] && (i[n] = t[n])
    }), i = $.isEmptyObject(i) ? null : i) : (i = [], Object.keys(t).forEach(function (n) {
        null != t[n] && i.push(t[n])
    })), i)
};
TradingView.Study.prototype._prepareInputs = function (n) {
    var r, i, t, u;
    for (assert(!!n, "options not set"), r = {}, i = 0; i < this._metaInfo.inputs.length; i++)t = this._metaInfo.inputs[i], t.isFake && n.skipFakeInputs && !this._metaInfo.isTVScript || t.isHidden && n.skipHiddenInputs || (u = this._prepareInput(t, n), r[t.id] = u);
    return r
};
TradingView.Study.prototype._prepareInput = function (n, t) {
    var i = n.id, r;
    return"symbol" == n.type ? (i = this.Q2.inputs[i].value(), t && t.symbolsForDisplay ? this._resolvedSymbols && this._resolvedSymbols[i] && (i = this._resolvedSymbols[i].name + ", " + this._resolvedSymbols[i].exchange) : (this._resolvedSymbols && this._resolvedSymbols[i] && (i = this._resolvedSymbols[i], i = i.ticker || i.full_name), t && t.symbolsForChartApi && (i = this.getSymbolString(i))), i) : "bar_time" == n.type ? (i = this.Q2.inputs[i].value(), 0 > i && (r = this._rightOffsetToUnixTime(-i), i = r && 0 <= r ? r : i), i) : this.Q2.inputs[i].value()
};
TradingView.Study.prototype._changeInputs = function (n) {
    this._studyId && this._chartApi.connected() ? (this._turnaround = "st" + ++this._turnaroundCounter, this._allInputsAreValid()) ? this._allSymbolsAreResolved() && (this._studyModified = !0, this._chartApi.modifyStudy(this._studyId, this._turnaround, n, this._handler)) : this.stop() : (this.stop(), this.start());
    this._inputs = n;
    this._tagsChanged.fire();
    this._titleCache = {}
};
TradingView.Study.prototype.changeStyles = function () {
    if (this._inputs) {
        for (var t = this.inputs({allowScriptCompile: !1}), n = 0; n < t.length; n++)if (t[n] !== this._inputs[n]) {
            this._changeInputs(t);
            break
        }
    } else this.restart();
    this.createViews();
    this.recalculate(!0);
    this.updateAllViews()
};
TradingView.Study.prototype.inputsChanged = function () {
    if (this._metaInfo.isTVScript) {
        var n = this._prepareInputs({symbolsForDisplay: !1, symbolsForChartApi: !0, skipHiddenInputs: !1, skipFakeInputs: !0, allowScriptCompile: !0});
        TVScript.TvsTranslator.patchProperties(this.Q2, this._metaInfo, n);
        this.createViews();
        this.recalculate(!0);
        this.updateAllViews()
    }
};
TradingView.Study.prototype.createViews = function () {
    var n, t, i;
    if (this._priceAxisViewsBase = new List, this._paneViews = new List, this.metaInfo().plots)for (n = 0; n < this.metaInfo().plots.length; n++)this.isSelfColorerPlot(n) || this.isBarColorerPlot(n) || (t = this.metaInfo().plots[n].id, this.isBgColorerPlot(n) ? this._paneViews.append(new J30(this, this._series, this.Q0, t)) : this.isPlotShapesPlot(n) ? this._paneViews.append(new J36(this, this._series, this.Q0, t)) : this.isPlotCharsPlot(n) ? this._paneViews.append(new J35(this, this._series, this.Q0, t)) : this.isPlotArrowsPlot(n) ? this._paneViews.append(new J34(this, this._series, this.Q0, t)) : (this._priceAxisViewsBase.append(new J51(this, this.Q0, t)), this._paneViews.append(new J33(this, this._series, this.Q0, t)), this.properties().styles[t].trackPrice.value() && this._paneViews.append(new J37(this, this._series, this.Q0, t))));
    if (this.Q2.bands)for (n = 0; n < this.Q2.bands.childCount(); n++)this.Q2.bands[n].visible.value() && this._paneViews.append(new TradingView._58(this.Q2.bands[n], this));
    this.Q2.bandsBackground && this._paneViews.append(new TradingView._57(this));
    n = [];
    this.metaInfo().graphics && (n = Object.keys(this.metaInfo().graphics), n.sort(function (n, t) {
        return TradingView.Study.graphicsZOrderPriority(n) - TradingView.Study.graphicsZOrderPriority(t)
    }));
    for (i in n) {
        var t = n[i], r = "_paneView" + t, u = "StudyPaneView_" + t;
        TradingView.Study[u] && (this[r] = new TradingView.Study[u](this, this.Q0), this._paneViews.append(this[r]));
        this._dataWindowView || "hhists" !== t || (this._dataWindowView = new StudyHHistsDataWindowView(this, this.Q0))
    }
    if (this.Q2.areaBackground && this._paneViews.append(new TradingView._55(this)), this.Q2.filledAreas && this._metaInfo.filledAreas)for (n = 0; n < this._metaInfo.filledAreas.length; ++n)i = this._metaInfo.filledAreas[n], t = this.Q2.filledAreasStyle[i.id], i.type === StudyMetaInfo.FilledArea.TYPE_PLOTS ? this._paneViews.append(new TradingView.J2(this, i, t)) : i.type === StudyMetaInfo.FilledArea.TYPE_HLINES ? this._paneViews.append(new TradingView._84(this, i, t)) : console.warn("Unsupported filledArea type: " + i.type);
    this._dataWindowView || (this._dataWindowView = new StudyDataWindowView(this, this.Q0));
    this._statusView || (this._statusView = new StudyStatusView(this, this.Q0.properties()));
    this._priceAxisViews = (new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)
};
TradingView.Study.prototype.recalculate = function (n) {
    var t = this.Q0.paneForSource(this);
    this.Q0.recalculatePane(t, n);
    this.Q0.updateSource(this)
};
TradingView.Study.prototype.data = function () {
    return this.m_data
};
TradingView.Study.prototype.metaInfo = function () {
    return this._metaInfo
};
TradingView.Study.prototype.status = function () {
    return this._status
};
TradingView.Study.prototype.title = function (n) {
    var t, r, i;
    return this._titleCache[n] ? this._titleCache[n] : (t = n ? this._metaInfo.shortDescription || this.Q2.shortDescription && this.Q2.shortDescription.value() || "Study" : this._metaInfo.description || this.Q2.description && this.Q2.description.value() || "Study", t = $.t(t), r = this.properties().showStudyArguments.value(), i = this.inputsForGUI() || [], r && 0 < i.length && (t += " (" + i.join(", ") + ")"), this._titleCache[n] = t)
};
TradingView.Study.prototype.graphics = function () {
    return this._graphics.graphics()
};
TradingView.Study.prototype._checkTurnaround = function (n) {
    return n === this._turnaround || n === this.Q0.mainSeries()._turnaround || n === this.Q0.mainSeries()._turnaround + "_" + this._turnaround
};
TradingView.Study.prototype.onData = function (n) {
    var t = this, i;
    switch (n.method) {
        case"study_loading":
            this._status = $.t("loading...");
            this._failed = !1;
            this._statusView.update();
            this.Q0.updateSource(this);
            this._clearLoadingTimer();
            -1 == ["Plot splits", "Plot earnings", "Plot dividends"].indexOf(t._metaInfo.description) && (t._loadingStartTime = (new Date).getTime(), t.loadingTimer = setTimeout(function () {
                var n = {chartSession: t._chartApi._sessionid, studyName: t._metaInfo.description, arguments: t.inputs()};
                D72.sendReport("study_loading", n);
                t._clearLoadingTimer()
            }, 15e3));
            break;
        case"study_error":
            this._clearLoadingTimer();
            this._failed = !0;
            this.clearData();
            this._status = n.params[2] ? $.t(n.params[2].split(":", 2)[0]) : "";
            this._statusView.update();
            this.Q0.updateSource(this);
            break;
        case"study_completed":
            if (!this._checkTurnaround(n.params[1]))break;
            this._clearLoadingTimer();
            this._status = "";
            this._statusView.update();
            n = this.Q0.paneForSource(this);
            this.Q0.recalculatePane(n, !0);
            this._updateSources();
            this.Q0.Q20(new D22(D22.FULL_UPDATE));
            break;
        case"data_update":
            if (!this._checkTurnaround(n.params.turnaround))break;
            t._clearLoadingTimer();
            this._studyModified && (this.clearData(), this._studyModified = !1);
            i = 0 == this.m_data.size();
            assert(!!n.params.nonseries, "data.params.nonseries is missing");
            n.params.nonseries.d = "" !== n.params.nonseries.d ? JSON.parse(n.params.nonseries.d) : "";
            this._processPlotOffsets(n.params);
            this._mergeData(n.params.plots);
            this._graphics.process(n.params.nonseries);
            this._postProcessGraphics();
            n = this.Q0.paneForSource(this);
            this.Q0.recalculatePane(n, i);
            this._updateSources()
    }
};
TradingView.Study.prototype._updateSources = function () {
    this.Q0.updateSource(this);
    this.hasBarColorer() && this.Q0.updateSource(this.Q0.mainSeries())
};
TradingView.Study.prototype._processPlotOffsets = function (n) {
    n = n.nonseries.d;
    n && n.indexes_replace || (this._plotOffsets = n && n.offsets ? n.offsets : {})
};
TradingView.Study.prototype._mergeData = function (n) {
    this.m_data.merge(n)
};
TradingView.Study.prototype._postProcessGraphics = function () {
    var n = this, t = function (t) {
        var i = n._graphics.graphics(), f = new List, u, r;
        if (i && i[t])for (r = i[t], i = 0; i < r.length; i += 1)if (r[i].data)for (u = 0; u < r[i].data.length; u += 1)f.append(new TradingView.Study.StudyPriceAxisView_hlines(n, n.Q0, r[i].data[u], r[i].styleId, t));
        return f
    };
    this._hlinesPriceAsisViews = t("hlines");
    this._horizlinesPriceAsisViews = t("horizlines");
    this._priceAxisViews = (new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)
};
TradingView.Study.prototype.firstValue = function (n) {
    var r, t;
    if (this._metaInfo.is_price_study && "Compare@tv-basicstudies" !== this._metaInfo.id)return this._series.data().firstValue();
    var i = this.Q0.timeScale().visibleBars(), u = i.firstBar(), i = i.lastBar();
    return 0 === this.m_data.size() ? null : (t = this, this.m_data.range(u, i).each(function (i, u) {
        for (var e, f = 1; f < u.length; ++f)if (!t.isSelfColorerPlot(f - 1) && (e = t._metaInfo.plots[f - 1].id, e = t.properties().styles[e], e.visible && e.visible.value() && !(n && 1e-10 > Math.abs(u[f]) || void 0 === u[f] || null === u[f] || r)))return r = u[f], !0
    }), r)
};
TradingView.Study.prototype.offset = function (n) {
    var t = 0;
    return this._plotOffsets && void 0 != this._plotOffsets[n] && (t += this._plotOffsets[n]), void 0 != this._plotOffsetsMetaInfoOverride[n] ? t += this._plotOffsetsMetaInfoOverride[n] : this.properties().offsets && void 0 != this.properties().offsets[n] && (t += this.properties().offsets[n].val.value()), this.properties().offset && (t += this.properties().offset.val.value()), t
};
TradingView.Study.prototype.priceRange = function (n, t) {
    var i, f, u, r, e, o;
    if (isInteger(n)) {
        if (isInteger(t)) {
            if (0 === this.m_data.size() || (i = null, 0 == this._metaInfo.plots.length))return null;
            for (f = [], u = 0; u < this._metaInfo.plots.length; ++u)if ((this.isLinePlot(u) || this.isPlotShapesPlot(u) || this.isPlotCharsPlot(u)) && (r = this._metaInfo.plots[u].id, this.properties().styles[r].visible.value())) {
                if (e = {index: u + 1, offset: this.offset(r)}, o = this.properties().styles[r].plottype.value(), !this.properties().skipHistogramBaseOnAutoScale && 0 <= [TradingView.Study.PLOT_HISTOGRAM, TradingView.Study.PLOT_COLUMNS, TradingView.Study.PLOT_AREA].indexOf(o)) {
                    if (r = this.properties().styles[r].histogramBase.value(), !isNumber(r))continue;
                    e.baseValue = r
                }
                f.push(e)
            }
            if (f = this.m_data.minMaxOnRange(n, t, f), null !== f.min && (i = new PriceRange(f.min, f.max)), this._metaInfo.bands)for (u = 0; u < this._metaInfo.bands.length; u++)this.properties().bands[u].visible.value() && (r = this.properties().bands[u].value.value(), isNumber(r) && (i ? i.apply(r, r) : i = PriceRange(r, r)));
            return i && i.minValue() === i.maxValue() && (f = .005 * i.minValue(), i = new PriceRange(i.minValue() - f, i.maxValue() + f)), this.priceScale().properties().percentage.value() && i ? (f = this.firstValue()) ? i.convertToPercents(f) : null : this.priceScale().isLog() && i ? new PriceRange(this.priceScale().priceToLogical(i.minValue()), this.priceScale().priceToLogical(i.maxValue())) : i
        }
        TradingView.logDebug("Study.priceRange: incorrect endBar")
    } else TradingView.logDebug("Study.priceRange: incorrect startBar")
};
TradingView.Study.prototype.paneViews = function () {
    return this.properties().visible.value() ? this._paneViews : null
};
TradingView.Study.prototype.dataWindowView = function () {
    return this._dataWindowView
};
TradingView.Study.prototype.statusView = function () {
    return this._statusView
};
TradingView.Study.prototype.priceAxisViews = function (n, t) {
    return this.Q0.paneForSource(this) === n && t === this.priceScale() && this.properties().showLastValue.value() ? this._priceAxisViews : null
};
TradingView.Study.prototype.isLinePlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_LINE
};
TradingView.Study.prototype.isSelfColorerPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_COLORER
};
TradingView.Study.prototype.isBarColorerPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_BAR_COLORER
};
TradingView.Study.prototype.isBgColorerPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_BG_COLORER
};
TradingView.Study.prototype.isPlotShapesPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_SHAPES
};
TradingView.Study.prototype.isPlotCharsPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_CHARS
};
TradingView.Study.prototype.isPlotArrowsPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_ARROWS
};
TradingView.Study.prototype.isDataOffsetPlot = function (n) {
    return this._metaInfo.plots[n].type == TradingView.Study.PLOT_TYPE_DATAOFFSET
};
TradingView.Study.prototype.hasBarColorer = function () {
    for (var n = 0; n < this._metaInfo.plots.length; ++n)if (this.isBarColorerPlot(n))return!0;
    return!1
};
TradingView.Study.prototype.barColorer = function () {
    for (var i, n = null, t = 0; t < this._metaInfo.plots.length; ++t)this.isBarColorerPlot(t) && (i = new StudyBarColorer(this, t), null === n ? n = i : n.pushBackBarColorer(i));
    if (null === n)throw Error("Cannot create BarColorer: study doesn't have a bar_colorer plot!");
    return n
};
TradingView.Study.prototype.base = function () {
    return"Volume" === this._metaInfo.id ? 1 : 0
};
TradingView.Study.prototype._createFormatter = function () {
    var n, t;
    "default" == this.properties().precision.value() ? this.metaInfo().defaults && (n = parseInt(this.metaInfo().defaults.precision)) : n = parseInt(this.properties().precision.value());
    isFinite(n) || (n = -1 !== ["Volume@tv-basicstudies", "VbPVisible@tv-volumebyprice", "VbPSessions@tv-volumebyprice"].indexOf(this._metaInfo.id) ? 0 : 1e4);
    t = this.series().symbolInfo();
    0 == n ? (n = 0, t && (n = t.volume_precision ? t.volume_precision : t.has_fractional_volume ? 2 : 0), this._formatter = new VolumeFormatter(n)) : this._formatter = new PriceFormatter(Math.pow(10, n));
    this.priceScale() && this.priceScale().updateFormatter()
};
TradingView.Study.prototype.formatter = function () {
    return this._formatter
};
TradingView.Study.prototype.nearestIndex = function (n, t) {
    if (isInteger(n)) {
        var i = this._series.data().bars().search(n, t);
        return i ? i.index : void 0
    }
    TradingView.logDebug("Study.nearestIndex: incorrect logicalPoint")
};
TradingView.Study.prototype.updateAllViews = function () {
    for (var n = 0; n < this._paneViews.size(); n++)this._paneViews.item(n).update();
    for (this._dataWindowView.update(), this._statusView.update(), n = 0; n < this._priceAxisViews.size(); n++)this._priceAxisViews.item(n).update()
};
TradingView.Study.prototype.tags = function () {
    var i = [], n, r, t;
    if (i.push(this._metaInfo.id), n = this.inputsForGUI(), 0 < n.length) {
        for (r = this._metaInfo.id, t = 0; t < n.length; t++)r += "_" + n[t];
        i.push(r)
    }
    return i
};
TradingView.Study.isPointsBasedStudy = function (n) {
    switch (n) {
        case"VbPFixed@tv-volumebyprice":
        case"mtp_tsanalysis@mtp-mtpredictor":
        case"mtp_riskreward@mtp-mtpredictor":
        case"mtp_decisionpoint@mtp-mtpredictor":
        case"mtp_ew_main@mtp-mtpredictor":
        case"mtp_ew_major@mtp-mtpredictor":
        case"mtp_ew_minor@mtp-mtpredictor":
        case"mtp_wpt_down1ora@mtp-mtpredictor":
        case"mtp_wpt_down2orb@mtp-mtpredictor":
        case"mtp_wpt_down3@mtp-mtpredictor":
        case"mtp_wpt_down4@mtp-mtpredictor":
        case"mtp_wpt_down5@mtp-mtpredictor":
        case"mtp_wpt_downc@mtp-mtpredictor":
        case"mtp_wpt_up1ora@mtp-mtpredictor":
        case"mtp_wpt_up2orb@mtp-mtpredictor":
        case"mtp_wpt_up3@mtp-mtpredictor":
        case"mtp_wpt_up4@mtp-mtpredictor":
        case"mtp_wpt_up5@mtp-mtpredictor":
        case"mtp_wpt_upc@mtp-mtpredictor":
            return!0;
        default:
            return!1
    }
};
TradingView.Study.lineToolNameForPointsBasedStudy = function (n) {
    switch (n) {
        case"VbPFixed@tv-volumebyprice":
            return"LineToolVbPFixed";
        case"RegressionTrend@tv-basicstudies":
            return"LineToolRegressionTrend";
        case"mtp_tsanalysis@mtp-mtpredictor":
            return"LineStudyMtpAnalysis";
        case"mtp_riskreward@mtp-mtpredictor":
            return"LineStudyMtpRiskReward";
        case"mtp_decisionpoint@mtp-mtpredictor":
            return"LineStudyMtpDecisionPoint";
        case"mtp_ew_main@mtp-mtpredictor":
            return"LineStudyMtpElliotWaveMain";
        case"mtp_ew_major@mtp-mtpredictor":
            return"LineStudyMtpElliotWaveMajor";
        case"mtp_ew_minor@mtp-mtpredictor":
            return"LineStudyMtpElliotWaveMinor";
        case"mtp_wpt_down1ora@mtp-mtpredictor":
            return"LineStudyMtpDownWave1OrA";
        case"mtp_wpt_down2orb@mtp-mtpredictor":
            return"LineStudyMtpDownWave2OrB";
        case"mtp_wpt_down3@mtp-mtpredictor":
            return"LineStudyMtpDownWave3";
        case"mtp_wpt_down4@mtp-mtpredictor":
            return"LineStudyMtpDownWave4";
        case"mtp_wpt_down5@mtp-mtpredictor":
            return"LineStudyMtpDownWave5";
        case"mtp_wpt_downc@mtp-mtpredictor":
            return"LineStudyMtpDownWaveC";
        case"mtp_wpt_up1ora@mtp-mtpredictor":
            return"LineStudyMtpUpWave1OrA";
        case"mtp_wpt_up2orb@mtp-mtpredictor":
            return"LineStudyMtpUpWave2OrB";
        case"mtp_wpt_up3@mtp-mtpredictor":
            return"LineStudyMtpUpWave3";
        case"mtp_wpt_up4@mtp-mtpredictor":
            return"LineStudyMtpUpWave4";
        case"mtp_wpt_up5@mtp-mtpredictor":
            return"LineStudyMtpUpWave5";
        case"mtp_wpt_upc@mtp-mtpredictor":
            return"LineStudyMtpUpWaveC";
        default:
            throw Error("There is no line tool name, associated with study id " + n);
    }
};
TradingView.Study.isStudyLineTool = function (n) {
    return n = TradingView[n], "function" == typeof n && n.prototype instanceof D63
};
TradingView.Study.prototype.onExtendedHoursChanged = function () {
    this.restart()
};
TradingView.Study.prototype.hasSymbolInputs = function () {
    for (var n = this._metaInfo.inputs.length; n--;)if ("symbol" === this._metaInfo.inputs[n].type)return!0;
    return!1
};
TradingView.Study.prototype._subscribeExtendedHours = function () {
    !this._isSubscribedToExtendedHours && this.hasSymbolInputs() && (this._series.extendedHours.listeners().subscribe(this, this.onExtendedHoursChanged), this._isSubscribedToExtendedHours = !0)
};
TradingView.Study.prototype._unsubscribeExtendedHours = function () {
    this._isSubscribedToExtendedHours && (this._series.extendedHours.listeners().unsubscribe(this, this.onExtendedHoursChanged), delete this._isSubscribedToExtendedHours)
};
TradingView.Study.prototype.removeByRemoveAllStudies = function () {
    return!0
};
PineAddons.ESDMetaInfo = [
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !0, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {text: "close~$0;updatetime~$0;#0!#1;t:'ESD:'+syminfo.prefix+'_'+ticker+'_DIVIDENDS'~sym($3,'D','D',1)|$0()|sym($3,'D','D',1)|$1()|s2:$2($5,$8)~$10~$11~$12!$13"}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Plot dividends", shortDescription: "Plot dividends", is_price_study: !0, inputs: [
        {defval: "close~$0;updatetime~$0;#0!#1;t:'ESD:'+syminfo.prefix+'_'+ticker+'_DIVIDENDS'~sym($3,'D','D',1)|$0()|sym($3,'D','D',1)|$1()|s2:$2($5,$8)~$10~$11~$12!$13", id: "text", name: "ILScript", type: "text", isHidden: !0}
    ], id: "Script$TV_DIVIDENDS@tv-scripting-1", scriptIdPart: "TV_DIVIDENDS", TVScriptSourceCode: 'study("Plot dividends")\nt = "ESD:" + syminfo.prefix + "_" + ticker + "_DIVIDENDS"\nc = security(t, "D", close, true)\nu = security(t, "D", updatetime, true)\nplot(c)\nplot(u)', linkedToSeries: !0, field: "DIVIDENDS"},
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !0, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {text: "open~$0;close~$0;updatetime~$0;#0!#1!#2;t:'ESD:'+syminfo.prefix+'_'+ticker+'_SPLITS'~sym($4,'D','D',1)|$0()|sym($4,'D','D',1)|$1()|sym($4,'D','D',1)|$2()|s3:$3($6,$9,$12)~$14~$15~$16~$17!$18!$19"}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Plot splits", shortDescription: "Plot splits", is_price_study: !0, inputs: [
        {defval: "open~$0;close~$0;updatetime~$0;#0!#1!#2;t:'ESD:'+syminfo.prefix+'_'+ticker+'_SPLITS'~sym($4,'D','D',1)|$0()|sym($4,'D','D',1)|$1()|sym($4,'D','D',1)|$2()|s3:$3($6,$9,$12)~$14~$15~$16~$17!$18!$19", id: "text", name: "ILScript", type: "text", isHidden: !0}
    ], id: "Script$TV_SPLITS@tv-scripting-1", scriptIdPart: "TV_SPLITS", TVScriptSourceCode: 'study("Plot splits")\nt = "ESD:" + syminfo.prefix + "_" + ticker + "_SPLITS"\no = security(t, "D", open, true)\nc = security(t, "D", close, true)\nu = security(t, "D", updatetime, true)\nplot(o)\nplot(c)\nplot(u)', linkedToSeries: !0, field: "SPLITS"},
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !0, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_3: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {text: "close~$0;open~$0;high~$0;updatetime~$0;#0!#1!#2!#3;t:'ESD:'+syminfo.prefix+'_'+ticker+'_EARNINGS'~sym($5,'D','D',1)|$0()|sym($5,'D','D',1)|$1()|sym($5,'D','D',1)|$2()|sym($5,'D','D',1)|$3()|s4:$4($7,$10,$13,$16)~$18~$19~$20~$21~$22!$23!$24!$25"}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"},
        {id: "plot_3", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_3: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Plot earnings", shortDescription: "Plot earnings", is_price_study: !0, inputs: [
        {defval: "close~$0;open~$0;high~$0;updatetime~$0;#0!#1!#2!#3;t:'ESD:'+syminfo.prefix+'_'+ticker+'_EARNINGS'~sym($5,'D','D',1)|$0()|sym($5,'D','D',1)|$1()|sym($5,'D','D',1)|$2()|sym($5,'D','D',1)|$3()|s4:$4($7,$10,$13,$16)~$18~$19~$20~$21~$22!$23!$24!$25", id: "text", name: "ILScript", type: "text", isHidden: !0}
    ], id: "Script$TV_EARNINGS@tv-scripting-1", scriptIdPart: "TV_EARNINGS", TVScriptSourceCode: 'study("Plot earnings")\nt = "ESD:" + syminfo.prefix + "_" + ticker + "_EARNINGS"\nc = security(t, "D", close, true)\no = security(t, "D", open, true)\nh = security(t, "D", high, true)\nu = security(t, "D", updatetime, true)\nplot(c)\nplot(o)\nplot(h)\nplot(u)', linkedToSeries: !0, field: "EARNINGS"}
];
PineAddons.SpyderCrusherStudiesMetaInfo = [
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_1: {transparency: 90}, plot_2: {visible: !0, location: "Absolute", transparency: 70, char: "■", color: "#00FF00"}, plot_3: {visible: !0, location: "Absolute", transparency: 70, char: "■", color: "#FF0000"}, plot_4: {visible: !0, location: "Absolute", transparency: 35, char: "◆", color: "#FF0000"}, plot_5: {visible: !0, location: "Absolute", transparency: 35, char: "◆", color: "#00FF00"}, plot_6: {visible: !0, location: "BelowBar", transparency: 35, char: "P", color: "#0000FF"}, plot_7: {visible: !0, location: "AboveBar", transparency: 35, char: "P", color: "#0000FF"}, plot_8: {visible: !0, location: "BelowBar", transparency: 35, char: "ʘ", color: "#0000FF"}, plot_9: {visible: !0, location: "AboveBar", transparency: 35, char: "X", color: "#FF0000"}, plot_10: {visible: !0, location: "AboveBar", transparency: 35, char: "X", color: "#FF0000"}, plot_11: {visible: !0, location: "BelowBar", transparency: 35, char: "Z", color: "#008000"}}, precision: 0, palettes: {palette_0: {colors: {0: {color: "#FFFF00", width: 1, style: 0}, 1: {color: "#800080", width: 1, style: 0}, 2: {color: "#FF7F00", width: 1, style: 0}, 3: {color: "#808000", width: 1, style: 0}, 4: {color: "#0066FF", width: 1, style: 0}, 5: {color: "#FF00FF", width: 1, style: 0}, 6: {color: "#758A0A", width: 1, style: 0}, 7: {color: "#008000", width: 1, style: 0}, 8: {color: "#00FF00", width: 1, style: 0}, 9: {color: "#FF0000", width: 1, style: 0}, 10: {color: "#9FB4B4", width: 1, style: 0}}}, palette_1: {colors: {0: {color: "#1A1A1A", width: 1, style: 0}}}}, inputs: {text: "i:2/(#1+1)~nz($1@1)-nz(#0@#1)+#0~na~$1/#1~na(#0@#1)?$2:$3~(#0-$6@1)*$0+$6@1~na($6@1)?$4:$5~$6;f:3.5/(#1+1)~nz($1@1)-nz(#0@#1)+#0~na~$1/#1~na(#0@#1)?$2:$3~(#0-$6@1)*$0+$6@1~na($6@1)?$4:$5~$6;close~low~$0@2>#0&&close<$0@1&&close<#1&&close>#2&&close<open&&close<$1@1;close~high~$0@4<#0&&$0@3<#1&&$0@2<#2&&$0@1>#3&&close>#4&&close<$1@1||$0@5<#5&&$0@4<#0&&$0@3<#1&&$0@2>#6&&close<#7&&$0@1>#8&&close>#4&&close<$1@1&&open>close;close~low~high~$0@1<#0&&$0@2>#1&&$1@1<#2&&$0@1>#2&&high<$2@1&&high>#3&&(close<#3||close<$0@1)&&close>$1@1&&open<close||$0@4>#4&&$0@3<#5&&$0@1>#0&&close>#6&&$0@1<#7&&open>close&&close>$1@1;close~low~high~$0@2>#0&&$1@1<#1&&$0@1<#1&&high<$2@1&&close<#2&&low>$1@1&&close>$0@1||$1@2>#0&&$1@1<#1&&$0@1>#1&&close>$1@1&&close<#2||$0@2>#0&&$0@1<#0&&$1@1>$1@2&&(close>$1@1||close>$1@2)&&low>$1@2&&close<#2;close~$0@1<#0&&close>#1&&close<#2&&close>open;close~close>$0(low,i:16)&&close<$0(high,i:16)||close>$0(high,i:16)&&$0@1<$0(low,i:16);close<$0(low,i:16);close>$0(high,i:16);close~high~$0@1<#0&&close>$0(high,i:16)&&close<$1@1;close~open~high>#0+0.01&&close<open&&$0@1>#1&&$0@1>$1@1&&close>#2;close~$0@3>#0&&$0@2>#1&&$0@1>#2&&close<#3;close~$0@3<#0&&$0@2<#1&&$0@1<#2&&close>#3;b:<in_3>~close~open~abs($1@3>$2@3&&$1@2>$2@2&&$1@1>$2@1&&close<open||$1@3>$2@3&&$1@2>$2@2&&$1@1<$2@1&&close>open||$1@3>$2@3&&$1@2<$2@2&&$1@1>$2@1&&close>open||$1@3<$2@3&&$1@2>$2@2&&$1@1>$2@1&&close>open||$1@3>$2@3&&$1@2>$2@2&&$1@1>$2@1&&close>open)*low*0.9999525~na~$0?$3:$4~$5!abs($1@3<$2@3&&$1@2<$2@2&&$1@1<$2@1&&close>open||$1@3<$2@3&&$1@2<$2@2&&$1@1>$2@1&&close<open||$1@3<$2@3&&$1@2>$2@2&&$1@1<$2@1&&close<open||$1@3>$2@3&&$1@2<$2@2&&$1@1<$2@1&&close<open||$1@3<$2@3&&$1@2<$2@2&&$1@1<$2@1&&close<open)*high*1.00009525~$0?$7:$4~$8!$0(low,i:16)-$1(low,i:16)~percentrank($10,8)~$10<0&&$11>75?1:0~iff($12,$0(low,i:16),$1(low,i:16))~abs(close>$0(low,i:16)&&close<$13)*low*0.9999525~$0?$14:$4~$15!$1(high,i:16)-$0(high,i:16)~percentrank($17,8)~$17>0&&$18<25?1:0~iff($19,$0(high,i:16),$1(high,i:16))~abs(close<$0(high,i:16)&&close>$20)*high*1.00009525~$0?$21:$4~$22!b:<in_1>~offset($20,1)~offset($20,2)~offset($20,4)~offset($13,1)~offset($13,2)~offset($13,3)~offset($13,4)~offset($13,5)~lowest(low,2)~lowest(low,3)~offset($33,1)~offset($33,2)~offset($34,1)~highest(high,3)~offset($38,2)~$2($26,$20,$37)||$3($31,$30,$29,$25,$35,$32,$26,$20,$36)||$4($25,$29,$28,$13,$27,$30,$20,$39)||$5($29,$28,$13)~$24&&close>open?$40:$4~$41!$24&&close<open?$40:$4~$43!b:<in_2>~high~barssince($6($28,$13,$20))==1&&close>=$46@1~low~barssince($6($28,$13,$20))==2&&$1@1<$46@2&&$1@1>$48@1&&($48@1>$37||close>$37)&&close>$46@2~$47||$49~$45?$50:$4~$51!barssince($6($28,$13,$20))==2&&$1@1>$46@2&&close<open&&(high<$46@1||close<$46@2)~barssince($6($28,$13,$20))==3&&$1@2>$46@3&&$1@1>$46@3&&$1@1>lowest(low,3)&&$48@2>$48@4&&open>close&&low<$2@2&&low<$2@3||barssince($6($28,$13,$20))==3&&$1@2<=$46@3&&$1@1>$46@3&&$1@1>lowest(low,3)&&$48@2>$48@4&&high<=$46@1&&open>close&&low<min($2@3,$1@2)~$53||$54~$45?$55:$4~$56!highest(high,2)~offset($58,1)~lowest(close,3)~offset($60,1)~offset($0(low,i:16),1)~barssince($50)<=3&&close<$0(low,i:16)&&$1@1>$62||barssince($50)<=4&&close<$61&&high<$59&&low<min($2@3,$1@2)~offset($63,1)~offset($63,2)~offset($63,3)~offset($63,4)~iff($64||$65||$66||$67,na,$63)~$63&&$68~$45?$69:$4~$70!iff(barssince($55)<=3&&close>$46@1&&open<close&&close>max($1@4,$46@4)||barssince($63&&$68)<=3&&close>$46@1&&open<close&&close>max($1@4,$46@5),1.0,0.0)~!$6($28,$13,$20)~$72&&$73~$45?$74:$4~$75!offset($20,3)~offset($38,1)~10~na~9~$7()?$79:$80~8~$8()?$81:$82~7~$9()?$83:$84~6~$10($25)?$85:$86~5~$11($78,$25,$13)?$87:$88~$4($25,$29,$28,$13,$27,$30,$20,$39)?$89:$90~4~$5($29,$28,$13)?$89:$91~3~$6($28,$13,$20)?$92:$93~2~$3($31,$30,$29,$25,$35,$32,$26,$20,$36)?$94:$95~1~$2($26,$20,$37)?$96:$97~0~$12($77,$26,$25,$13)?$98:$99~$13($30,$29,$28,$20)?$100:$101~$102!b:<in_0>~11~$104?$105:$80~$106;s12:$14()~$15~$16~$17~$18~$19~$20~$21~$22~$23~$24~$25~$26~$37!$38!$27!$28!$29!$30!$31!$32!$33!$34!$35!$36", in_0: !1, in_1: !0, in_2: !0, in_3: !0}}, plots: [
        {id: "plot_0", palette: "palette_0", type: "bar_colorer"},
        {id: "plot_1", palette: "palette_1", type: "bg_colorer"},
        {id: "plot_2", type: "chars"},
        {id: "plot_3", type: "chars"},
        {id: "plot_4", type: "chars"},
        {id: "plot_5", type: "chars"},
        {id: "plot_6", type: "chars"},
        {id: "plot_7", type: "chars"},
        {id: "plot_8", type: "chars"},
        {id: "plot_9", type: "chars"},
        {id: "plot_10", type: "chars"},
        {id: "plot_11", type: "chars"}
    ], styles: {plot_2: {title: "75% Rule Up"}, plot_3: {title: "75% Rule Down"}, plot_4: {title: "Bearish Trend Near"}, plot_5: {title: "Bullish Trend Near"}, plot_6: {title: "Pivot, Bullish Bias"}, plot_7: {title: "Pivot, Bearish Bias"}, plot_8: {title: "Confirmed Reversal Up"}, plot_9: {title: "Confirmed Reversal Cancellation"}, plot_10: {title: "Confirmed Reversal Cancellation"}, plot_11: {title: "Confirmed Reversal Valid"}}, description: "SCMR Trends™", shortDescription: "SCMR Trends™", is_price_study: !0, palettes: {palette_0: {colors: {0: {name: "Color 0"}, 1: {name: "Color 1"}, 2: {name: "Color 2"}, 3: {name: "Color 3"}, 4: {name: "Color 4"}, 5: {name: "Color 5"}, 6: {name: "Color 6"}, 7: {name: "Color 7"}, 8: {name: "Color 8"}, 9: {name: "Color 9"}, 10: {name: "Color 10"}}, valToIndex: {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, 10: 10}, addDefaultColor: !0}, palette_1: {colors: {0: {name: "Color 0"}}, valToIndex: {11: 0}, addDefaultColor: !0}}, inputs: [
        {defval: "i:2/(#1+1)~nz($1@1)-nz(#0@#1)+#0~na~$1/#1~na(#0@#1)?$2:$3~(#0-$6@1)*$0+$6@1~na($6@1)?$4:$5~$6;f:3.5/(#1+1)~nz($1@1)-nz(#0@#1)+#0~na~$1/#1~na(#0@#1)?$2:$3~(#0-$6@1)*$0+$6@1~na($6@1)?$4:$5~$6;close~low~$0@2>#0&&close<$0@1&&close<#1&&close>#2&&close<open&&close<$1@1;close~high~$0@4<#0&&$0@3<#1&&$0@2<#2&&$0@1>#3&&close>#4&&close<$1@1||$0@5<#5&&$0@4<#0&&$0@3<#1&&$0@2>#6&&close<#7&&$0@1>#8&&close>#4&&close<$1@1&&open>close;close~low~high~$0@1<#0&&$0@2>#1&&$1@1<#2&&$0@1>#2&&high<$2@1&&high>#3&&(close<#3||close<$0@1)&&close>$1@1&&open<close||$0@4>#4&&$0@3<#5&&$0@1>#0&&close>#6&&$0@1<#7&&open>close&&close>$1@1;close~low~high~$0@2>#0&&$1@1<#1&&$0@1<#1&&high<$2@1&&close<#2&&low>$1@1&&close>$0@1||$1@2>#0&&$1@1<#1&&$0@1>#1&&close>$1@1&&close<#2||$0@2>#0&&$0@1<#0&&$1@1>$1@2&&(close>$1@1||close>$1@2)&&low>$1@2&&close<#2;close~$0@1<#0&&close>#1&&close<#2&&close>open;close~close>$0(low,i:16)&&close<$0(high,i:16)||close>$0(high,i:16)&&$0@1<$0(low,i:16);close<$0(low,i:16);close>$0(high,i:16);close~high~$0@1<#0&&close>$0(high,i:16)&&close<$1@1;close~open~high>#0+0.01&&close<open&&$0@1>#1&&$0@1>$1@1&&close>#2;close~$0@3>#0&&$0@2>#1&&$0@1>#2&&close<#3;close~$0@3<#0&&$0@2<#1&&$0@1<#2&&close>#3;b:<in_3>~close~open~abs($1@3>$2@3&&$1@2>$2@2&&$1@1>$2@1&&close<open||$1@3>$2@3&&$1@2>$2@2&&$1@1<$2@1&&close>open||$1@3>$2@3&&$1@2<$2@2&&$1@1>$2@1&&close>open||$1@3<$2@3&&$1@2>$2@2&&$1@1>$2@1&&close>open||$1@3>$2@3&&$1@2>$2@2&&$1@1>$2@1&&close>open)*low*0.9999525~na~$0?$3:$4~$5!abs($1@3<$2@3&&$1@2<$2@2&&$1@1<$2@1&&close>open||$1@3<$2@3&&$1@2<$2@2&&$1@1>$2@1&&close<open||$1@3<$2@3&&$1@2>$2@2&&$1@1<$2@1&&close<open||$1@3>$2@3&&$1@2<$2@2&&$1@1<$2@1&&close<open||$1@3<$2@3&&$1@2<$2@2&&$1@1<$2@1&&close<open)*high*1.00009525~$0?$7:$4~$8!$0(low,i:16)-$1(low,i:16)~percentrank($10,8)~$10<0&&$11>75?1:0~iff($12,$0(low,i:16),$1(low,i:16))~abs(close>$0(low,i:16)&&close<$13)*low*0.9999525~$0?$14:$4~$15!$1(high,i:16)-$0(high,i:16)~percentrank($17,8)~$17>0&&$18<25?1:0~iff($19,$0(high,i:16),$1(high,i:16))~abs(close<$0(high,i:16)&&close>$20)*high*1.00009525~$0?$21:$4~$22!b:<in_1>~offset($20,1)~offset($20,2)~offset($20,4)~offset($13,1)~offset($13,2)~offset($13,3)~offset($13,4)~offset($13,5)~lowest(low,2)~lowest(low,3)~offset($33,1)~offset($33,2)~offset($34,1)~highest(high,3)~offset($38,2)~$2($26,$20,$37)||$3($31,$30,$29,$25,$35,$32,$26,$20,$36)||$4($25,$29,$28,$13,$27,$30,$20,$39)||$5($29,$28,$13)~$24&&close>open?$40:$4~$41!$24&&close<open?$40:$4~$43!b:<in_2>~high~barssince($6($28,$13,$20))==1&&close>=$46@1~low~barssince($6($28,$13,$20))==2&&$1@1<$46@2&&$1@1>$48@1&&($48@1>$37||close>$37)&&close>$46@2~$47||$49~$45?$50:$4~$51!barssince($6($28,$13,$20))==2&&$1@1>$46@2&&close<open&&(high<$46@1||close<$46@2)~barssince($6($28,$13,$20))==3&&$1@2>$46@3&&$1@1>$46@3&&$1@1>lowest(low,3)&&$48@2>$48@4&&open>close&&low<$2@2&&low<$2@3||barssince($6($28,$13,$20))==3&&$1@2<=$46@3&&$1@1>$46@3&&$1@1>lowest(low,3)&&$48@2>$48@4&&high<=$46@1&&open>close&&low<min($2@3,$1@2)~$53||$54~$45?$55:$4~$56!highest(high,2)~offset($58,1)~lowest(close,3)~offset($60,1)~offset($0(low,i:16),1)~barssince($50)<=3&&close<$0(low,i:16)&&$1@1>$62||barssince($50)<=4&&close<$61&&high<$59&&low<min($2@3,$1@2)~offset($63,1)~offset($63,2)~offset($63,3)~offset($63,4)~iff($64||$65||$66||$67,na,$63)~$63&&$68~$45?$69:$4~$70!iff(barssince($55)<=3&&close>$46@1&&open<close&&close>max($1@4,$46@4)||barssince($63&&$68)<=3&&close>$46@1&&open<close&&close>max($1@4,$46@5),1.0,0.0)~!$6($28,$13,$20)~$72&&$73~$45?$74:$4~$75!offset($20,3)~offset($38,1)~10~na~9~$7()?$79:$80~8~$8()?$81:$82~7~$9()?$83:$84~6~$10($25)?$85:$86~5~$11($78,$25,$13)?$87:$88~$4($25,$29,$28,$13,$27,$30,$20,$39)?$89:$90~4~$5($29,$28,$13)?$89:$91~3~$6($28,$13,$20)?$92:$93~2~$3($31,$30,$29,$25,$35,$32,$26,$20,$36)?$94:$95~1~$2($26,$20,$37)?$96:$97~0~$12($77,$26,$25,$13)?$98:$99~$13($30,$29,$28,$20)?$100:$101~$102!b:<in_0>~11~$104?$105:$80~$106;s12:$14()~$15~$16~$17~$18~$19~$20~$21~$22~$23~$24~$25~$26~$37!$38!$27!$28!$29!$30!$31!$32!$33!$34!$35!$36", id: "text", name: "ILScript", type: "text", isHidden: !0},
        {id: "in_0", name: "-----> High Contrast. Automatic Dark Background", defval: !1, type: "bool", isFake: !0},
        {id: "in_1", name: "Show Pivots Text", defval: !0, type: "bool", isFake: !0},
        {id: "in_2", name: "Show Confirmed Upside Reversals Text", defval: !0, type: "bool", isFake: !0},
        {id: "in_3", name: "Show Early Detection", defval: !0, type: "bool", isFake: !0}
    ], id: "Script$SPYDERCR_SCMR_Trends@tv-scripting-1", scriptIdPart: "SPYDERCR_SCMR_Trends"},
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 3, plottype: 6, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_1: {linestyle: 0, linewidth: 3, plottype: 6, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 2, inputs: {text: "lowest(close,2)~offset($0,1)~high~low~close~high<$2@1&&low<$3@1&&close<open||low<$3@1&&close<$4@2&&close<$1||high<$2@1&&low<$3@2&&close<$1~$5;high~na~#0?$0:$1~$2;high~low~close~high>$0@1&&low>$1@1&&close>open||high>$0@1&&close>$2@2&&close>open~$3;low~na~#0?$0:$1~$2;#0!#1;t:<in_0>~sym(tickerid,$5,$5,0)|$0()|sym(tickerid,$5,$5,0)|$1($7)|sym(tickerid,$5,$5,0)|$2()|sym(tickerid,$5,$5,0)|$3($13)|s2:$4($10,$16)~$18~$19~$20!$21", in_0: "1M", in_1: 3}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "B2B Dynamic Resistance™", histogramBase: 0, joinPoints: !1}, plot_1: {title: "B2B Dynamic Support™", histogramBase: 0, joinPoints: !1}}, description: "SCMR Dynamic Levels™", shortDescription: "SCMR Dynamic Levels™", is_price_study: !0, inputs: [
        {defval: "lowest(close,2)~offset($0,1)~high~low~close~high<$2@1&&low<$3@1&&close<open||low<$3@1&&close<$4@2&&close<$1||high<$2@1&&low<$3@2&&close<$1~$5;high~na~#0?$0:$1~$2;high~low~close~high>$0@1&&low>$1@1&&close>open||high>$0@1&&close>$2@2&&close>open~$3;low~na~#0?$0:$1~$2;#0!#1;t:<in_0>~sym(tickerid,$5,$5,0)|$0()|sym(tickerid,$5,$5,0)|$1($7)|sym(tickerid,$5,$5,0)|$2()|sym(tickerid,$5,$5,0)|$3($13)|s2:$4($10,$16)~$18~$19~$20!$21", id: "text", name: "ILScript", type: "text", isHidden: !0},
        {id: "in_0", name: "Lookback. IMPORTANT: Use period *at least* ~5x your chart timeframe. Ex: on 1min chart - select '5' or '15'. On daily chart -> select 'W' or '1M', etc.", defval: "1M", type: "text", isFake: !0},
        {id: "in_1", name: "width", defval: 3, type: "integer", min: 1, max: 8, isFake: !0}
    ], id: "Script$SPYDERCR_SCMR_Dynamic_Levels@tv-scripting-1", scriptIdPart: "SPYDERCR_SCMR_Dynamic_Levels", TVScriptMetaInfoExprs: {tree: "width=##input(defval=3,##id='in_1')\n##root(root_metainfo,rm_0,width)\n##root(root_metainfo,rm_1,width)\n", patchMap: {"defaults.styles.plot_0.linewidth": "rm_1", "defaults.styles.plot_1.linewidth": "rm_1"}}},
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 40, visible: !0, color: "#FF9D9D"}, plot_1: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 40, visible: !0, color: "#009933"}, plot_2: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 58, visible: !0, color: "#FF5050"}, plot_3: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 58, visible: !0, color: "#00ff00"}, plot_4: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 40, visible: !0, color: "#800000"}, plot_5: {linestyle: 0, linewidth: 7, plottype: 1, trackPrice: !1, transparency: 40, visible: !0, color: "#005C00"}, plot_6: {visible: !0, location: "Bottom", transparency: 35, char: "▓", color: "#0000FF"}, plot_7: {visible: !0, location: "Top", transparency: 35, char: "▓", color: "#0000FF"}, plot_8: {linestyle: 0, linewidth: 1, plottype: 6, trackPrice: !1, transparency: 65, visible: !0, color: "#0000FF"}, plot_9: {linestyle: 0, linewidth: 1, plottype: 6, trackPrice: !1, transparency: 65, visible: !0, color: "#0000FF"}}, precision: 2, bands: [
        {color: "#FFFFFF", linestyle: 1, linewidth: 1, visible: !0, value: 0}
    ], inputs: {text: "(highest(high,125)-close)/highest(high,125)*-100~$0!(lowest(low,125)-close)/lowest(low,125)*-100~$2!(highest(high,13)-close)/highest(high,13)*-100~$4!(lowest(low,13)-close)/lowest(low,13)*-100~$6!i:<in_0>~percentrank($4,$8)~na~$9<10?$4:$10~$11!percentrank($6,$8)~$13>90?$6:$10~$14!$9@1<10&&$9>10&&$13<90?$6:$10~$16!$13@1>90&&$13<90?$4:$10~$18!lowest($4,$8)~$20!highest($6,$8)~$22;s10:$0()~$1~$2~$3~$4~$5~$6~$7~$8~$9~$10~$11!$12!$13!$14!$15!$16!$17!$18!$19!$20", in_0: 65}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"},
        {id: "plot_3", type: "line"},
        {id: "plot_4", type: "line"},
        {id: "plot_5", type: "line"},
        {id: "plot_6", type: "chars"},
        {id: "plot_7", type: "chars"},
        {id: "plot_8", type: "line"},
        {id: "plot_9", type: "line"}
    ], styles: {plot_0: {title: "Percent Advance Fast", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Percent Advance Slow", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Percent Drawdown Fast", histogramBase: 0, joinPoints: !1}, plot_3: {title: "Percent Drawdown Low", histogramBase: 0, joinPoints: !1}, plot_4: {title: "Lower End of Price Range", histogramBase: 0, joinPoints: !1}, plot_5: {title: "Upper End of Price Range", histogramBase: 0, joinPoints: !1}, plot_6: {title: "Lower End Range Marker"}, plot_7: {title: "Upper End Range Marker"}, plot_8: {title: "High Band", histogramBase: 0, joinPoints: !1}, plot_9: {title: "Low Band", histogramBase: 0, joinPoints: !1}}, description: "SCMR Momentum Peaks™", shortDescription: "SCMR Momentum Peaks™", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero Line"}
    ], inputs: [
        {defval: "(highest(high,125)-close)/highest(high,125)*-100~$0!(lowest(low,125)-close)/lowest(low,125)*-100~$2!(highest(high,13)-close)/highest(high,13)*-100~$4!(lowest(low,13)-close)/lowest(low,13)*-100~$6!i:<in_0>~percentrank($4,$8)~na~$9<10?$4:$10~$11!percentrank($6,$8)~$13>90?$6:$10~$14!$9@1<10&&$9>10&&$13<90?$6:$10~$16!$13@1>90&&$13<90?$4:$10~$18!lowest($4,$8)~$20!highest($6,$8)~$22;s10:$0()~$1~$2~$3~$4~$5~$6~$7~$8~$9~$10~$11!$12!$13!$14!$15!$16!$17!$18!$19!$20", id: "text", name: "ILScript", type: "text", isHidden: !0},
        {id: "in_0", name: "Length to Determine Range", defval: 65, type: "integer", min: 5, max: 2e3, isFake: !0}
    ], id: "Script$SPYDERCR_SCMR_Momentum_Peaks@tv-scripting-1", scriptIdPart: "SPYDERCR_SCMR_Momentum_Peaks"},
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {visible: !0, location: "BelowBar", transparency: 35, char: "▲", color: "#008080"}, plot_1: {visible: !0, location: "AboveBar", transparency: 35, char: "▼", color: "#CC0099"}}, precision: 0, inputs: {text: "high~low~close~high>$0@1&&low>$1@1&&close>open||high>$0@1&&close>$2@2&&close>open~$3!lowest(close,2)~offset($5,1)~high<$0@1&&low<$1@1&&close<open||low<$1@1&&close<$2@2&&close<$6||high<$0@1&&low<$1@2&&close<$6~$7;s2:$0()~$1~$2~$3!$4"}}, plots: [
        {id: "plot_0", type: "chars"},
        {id: "plot_1", type: "chars"}
    ], styles: {plot_0: {title: "B2B Up™"}, plot_1: {title: "B2B Down™"}}, description: "SCMR B2B™", shortDescription: "SCMR B2B™", is_price_study: !0, inputs: [
        {defval: "high~low~close~high>$0@1&&low>$1@1&&close>open||high>$0@1&&close>$2@2&&close>open~$3!lowest(close,2)~offset($5,1)~high<$0@1&&low<$1@1&&close<open||low<$1@1&&close<$2@2&&close<$6||high<$0@1&&low<$1@2&&close<$6~$7;s2:$0()~$1~$2~$3!$4", id: "text", name: "ILScript", type: "text", isHidden: !0}
    ], id: "Script$SPYDERCR_SCMR_B2B@tv-scripting-1", scriptIdPart: "SPYDERCR_SCMR_B2B"}
];
PineAddons.AlphaLabStudiesMetaInfo = [
    {_metainfoVersion: 29, isTVScript: !0, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {visible: !0, transparency: 10, colorup: "#00FF00", colordown: "#FF0000"}}, precision: 4, inputs: {text: "close~$0;s3:macd(#0,12,26,26)~$2~s3:macd(#1,12,26,26)~$6~$3*100000~$7*100000~iff($9>$8&&offset($9,1)<offset($8,1),#2,na)~iff($9<$8&&offset($9,1)>offset($8,1),#2,na)~na~1.0~$11?-1.0:$12~$10?$13:$14~$15;t:tickerid~sym($2,'15','15',0)|$0()|sym($2,'60','60',0)|$0()|sym($2,period,period,0)|$0()|$1($4,$7,$10)~$12"}}, plots: [
        {id: "plot_0", type: "arrows"}
    ], styles: {plot_0: {title: "Buy/Sell", minHeight: 5, maxHeight: 20}}, description: "Alphalab: FX Order Flow Monitor", shortDescription: "Alphalab: FX Order Flow Monitor", is_price_study: !0, inputs: [
        {defval: "close~$0;s3:macd(#0,12,26,26)~$2~s3:macd(#1,12,26,26)~$6~$3*100000~$7*100000~iff($9>$8&&offset($9,1)<offset($8,1),#2,na)~iff($9<$8&&offset($9,1)>offset($8,1),#2,na)~na~1.0~$11?-1.0:$12~$10?$13:$14~$15;t:tickerid~sym($2,'15','15',0)|$0()|sym($2,'60','60',0)|$0()|sym($2,period,period,0)|$0()|$1($4,$7,$10)~$12", id: "text", name: "ILScript", type: "text", isHidden: !0}
    ], id: "Script$ALPHALAB_FX_Order_Flow_Monitor@tv-scripting-1", scriptIdPart: "ALPHALAB_FX_Order_Flow_Monitor"}
];
D62 = function (n) {
    this._graphics = D62.emptyGraphics();
    assert(!!n, "Study metaInfo is absent!");
    this._metaInfo = n
};
D62.emptyGraphics = function () {
    return{indexes: []}
};
D62.prototype.isEmpty = function () {
    var n = 1 < Object.keys(this._graphics).length;
    return 0 == this._graphics.indexes.length && !n
};
D62.prototype.graphics = function () {
    return this._graphics
};
D62.prototype.setGraphics = function (n) {
    this._graphics = n;
    this._postProcessGraphicsData()
};
D62.prototype.process = function (n) {
    "" !== n.d && (TradingView.logDebug("nonseries.d is " + JSON.stringify(n.d)), n.d.indexes_replace ? this.replaceIndexes(n) : n.d.graphicsCmds && (this.processEraseCmds(n.d.graphicsCmds.erase), this.processCreateCmds(n.d.graphicsCmds.create, n.indexes)))
};
D62.prototype.replaceIndexes = function (n) {
    "" !== n.d && (assert(!!n.d.indexes_replace), this._graphics.indexes = n.indexes, TradingView.logDebug("timescale has been replaced with a new one (replaceIndexes)"))
};
D62.prototype.processEraseCmds = function (n) {
    var i, t, f, r, u;
    if (n)for (assert(!!this._graphics, "_graphics object doesn't exist in the study!"), assert(!!this._graphics.indexes, "_graphics.indexes array doesn't exist in the study!"), i = 0; i < n.length; ++i)if (t = n[i], "all" === t.action)this._graphics = D62.emptyGraphics(), TradingView.logDebug("erased ALL the graphics"); else if ("one" === t.action)for (f in this._graphics[t.type])r = this._graphics[t.type][f], u = D62._findGraphicsObjIndexById(r.data, t.id), 0 <= u ? (r.data.splice(u, 1), TradingView.logDebug("erased one the graphics obj with id=" + t.id)) : TradingView.logDebug("cannot erase obj with id=" + t.id + " because it doesn't exist"); else Error("Unknown graphics command " + t.action)
};
D62._findGraphicsObjIndexById = function (n, t) {
    for (var i = 0; i < n.length; ++i)if (n[i].id === t)return i;
    return-1
};
D62.prototype.processCreateCmds = function (n, t) {
    var i, f, e, o, r, u;
    if (n) {
        assert(!!t, "indexes are missing in the study nonseries response!");
        assert(!!this._graphics, "_graphics object doesn't exist in the study!");
        assert(!!this._graphics.indexes, "_graphics.indexes array doesn't exist in the study!");
        for (i in n)for (assert(i in this._metaInfo.graphics, "There is a '" + i + "' in study response, but it doesn't present in metaInfo!"), f = 0; f < n[i].length; ++f) {
            for (e = n[i][f], o = e.styleId, assert(o in this._metaInfo.graphics[i]), this._graphics[i] || (this._graphics[i] = []), r = null, u = 0; u < this._graphics[i].length; ++u)if (this._graphics[i][u].styleId === o) {
                r = this._graphics[i][u];
                break
            }
            null === r && (r = {styleId: o, data: []}, this._graphics[i].push(r));
            r.data = r.data.concat(e.data);
            TradingView.logDebug("created " + e.data.length + " graphics objects")
        }
        "nochange" === t ? TradingView.logDebug("timescale hasn't changed") : (assert(isArray(t)), this._graphics.indexes = t, TradingView.logDebug("timescale has been replaced with a new one"));
        this._postProcessGraphicsData()
    }
};
D62.prototype._postProcessGraphicsData = function () {
    var t, n;
    if (this._graphics)for (t in this._graphics.hhists)n = this._graphics.hhists[t], D62._sortHHistItemsByPrice(n.data), n.dataObj = D62._splitHHistItemsBySession(n.data, this._graphics.indexes)
};
D62._sortHHistItemsByPrice = function (n) {
    n.sort(function (n, t) {
        return n.priceLow - t.priceLow
    })
};
D62._splitHHistItemsBySession = function (n, t) {
    for (var f, r, i = {}, u = 0; u < n.length; ++u)f = n[u], r = t[f.firstBarTime], void 0 === r ? console.error("Cannot find index " + f.firstBarTime + " in study timescale indexes") : (r in i || (i[r] = []), i[r].push(f));
    return i
};
D64 = function (n) {
    this._studyId = n;
    this._maxFromVers = this._maxToVers = "0";
    this._migrs = []
};
D64.prototype.addMigration = function (n, t, i) {
    D0.isGreater(n, this._maxFromVers) && (this._maxFromVers = n);
    D0.isGreater(t, this._maxToVers) && (this._maxToVers = t);
    this._migrs.push({fromVers: n, toVers: t, rules: i})
};
D64.prototype.updateInputs = function (n, t) {
    var r, i, u;
    if (!t)return t;
    for (u = TradingView.clone(t), TradingView.logDebug("Applying migrations to study: " + this._studyId + " from vers: " + n + " to vers: " + this._maxToVers), r = n; D0.isLess(r, this._maxToVers);) {
        if (i = this._findMigration(r), u = this._applyMigration(u, i), !D0.isLess(r, i.toVers))throw Error("Problems in study migration process... Possible infinite cycle has been detected and stopped.");
        r = i.toVers;
        TradingView.logDebug("Applied migration rule to study: " + this._studyId + " from vers: " + i.fromVers + " to vers: " + i.toVers)
    }
    return u
};
D64.prototype._findMigration = function (n) {
    for (var i, r = -1, u = this._maxFromVers, t = 0; t < this._migrs.length; t++)i = this._migrs[t], !D0.isLess(i.fromVers, n) && D0.isLessOrEqual(i.fromVers, u) && (u = i.fromVers, r = t);
    if (0 > r)throw Error("Could not find matching migration for study: " + this._studyId + " vers: " + n);
    return this._migrs[r]
};
D64.prototype._applyMigration = function (n, t) {
    for (var u, i = n, r = 0; r < t.rules.length; r++)u = t.rules[r], i = this._getApplyRuleFun(u.type)(i, u);
    return i
};
D64.prototype._getApplyRuleFun = function (n) {
    if ("inputRemoved" == n)return D64._applyInputRemovedRule;
    if ("inputChangedType" == n)return D64._applyInputChangedTypeRule;
    throw Error("Unknown migration rule type: " + mr.type);
};
D64._applyInputRemovedRule = function (n, t) {
    var i, u, r;
    if (!(t.inputId in n) || (i = D0.findInputKeyById(n, t.inputId), !i))return n;
    delete n[i];
    delete n[t.inputId];
    i = {};
    u = 0;
    for (r in n)isNumber(parseInt(r, 10)) ? (i[u] = n[r], u++) : i[r] = n[r];
    return i
};
D64._applyInputChangedTypeRule = function (n, t) {
    var i = D0.getInputKeyById(n, t.inputId);
    if ("resetToDefVal" == t.action)n[t.inputId] = t.defVal, n[i].defval = t.defVal, n[i].type = t.inputType; else throw Error("Unknown action " + t.action + " for rule with type " + t.type);
    return n
};
D0 = function (n, t) {
    var r, o, u, e, i, h;
    if (!n)throw Error("No studies metainfo");
    if (this._studiesMetainfo = n, !t)throw Error("No studies migrations");
    for (this._studiesMigrations = t, this._migrations = {}, r = 0; r < this._studiesMigrations.size(); r++)for (o = this._studiesMigrations.item(r), u = 0; u < o.length; u++)for (var f = o[u], c = f.versFrom, l = f.versTo, s = 0; s < f.studyMigrations.length; s++) {
        if (e = f.studyMigrations[s], i = e.studyId, 0 == e.rules.length)throw Error("Study Migration should have at least one convertion rule");
        h = i in this._migrations ? this._migrations[i] : new D64(i);
        h.addMigration(c, l, e.rules);
        this._migrations[i] = h
    }
    this._clientMigrations = [function (n, t) {
        var i, f;
        if (this._studiesMetainfo.isEmpty() || !n.isTVScript || 22 <= n.version)return t;
        for (var r = {}, e = 0, u = 0; ;) {
            if (i = t[u], void 0 == i)break;
            f = t[i.id];
            i.isFake && (i.id = "in_" + e++);
            r[u] = i;
            r[i.id] = f;
            u++
        }
        return r
    }]
};
D0.prototype.updateMetaInfo = function (n) {
    var t, r, i;
    if (!n)return n;
    if (t = null, n.isTVScript && n.TVScriptSourceCode) {
        r = this._studiesMetainfo.isEmpty() ? "1" : D57.tvScriptingPkgVersion(this._studiesMetainfo);
        i = n.scriptIdPart || TVScript.MetainfoGenerator.createScriptIdPart();
        try {
            t = D57.translateScript(n.TVScriptSourceCode, null, i, r);
            TradingView.merge(t, StudyMetaInfo.parseIdString(t.id))
        } catch (u) {
            console.warn("Could not compile Pine script (skipping): " + n.description)
        }
    } else for (r = this._studiesMetainfo, i = 0; i < r.size(); i++)if (r.item(i).id === n.id) {
        t = r.item(i);
        break
    }
    return t && (t = StudyMetaInfo.replaceWithFullStudyMetaInfo(this._studiesMetainfo, t)), TradingView.clone(t)
};
D0.prototype.updateStudyState = function (n, t, i) {
    var r, u, f;
    if (n)for (n = TradingView.clone(n), r = t.id, (r in this._migrations) && (u = this._migrations[r].updateInputs(t.version, n.inputs), n.inputs = u), r = 0; r < this._clientMigrations.length; ++r)u = this._clientMigrations[r].call(this, t, n.inputs), Object.keys(u).length == Object.keys(n.inputs).length ? n.inputs = u : console.warn("StudyVersioning._clientMigrations application returned bad result. Skipping it...");
    if (i && n && (r = {}, D0.mergeInputs(r, i.inputs), D0.mergeInputs(r, i.defaults.inputs), D0.mergeInputs(r, n.inputs), n.inputs = r, r = StudyMetaInfo.versionOf(t), t.isTVScript && t.TVScriptSourceCode && 12 <= r && 26 >= r)) {
        for (u = {}, r = 0; r < t.plots.length; ++r)u[t.plots[r].id] = i.plots[r].id;
        for (i = Object.keys(n.styles), r = 0; r < i.length; ++r)t = i[r], f = n.styles[t], delete n.styles[t], n.styles[u[t]] = f;
        for (i = Object.keys(n.plots), r = 0; r < i.length; ++r)f = i[r], t = n.plots[f].id, n.plots[f].id = u[t]
    }
    return n
};
D0.prototype.patchPointsBasedStudyState = function (n) {
    return D0._fixInputsMaxValue(n.state, n.metaInfo), "LineToolRegressionTrend" === n.type && (n = TradingView.LineToolRegressionTrend.patchSourceState(n)), n
};
D0.prototype.patchPointsBasedStudyData = function (n, t) {
    if (!n || !t)return t;
    var i = TradingView.clone(t);
    return"VbPFixed@tv-volumebyprice" === n.id && n.version && 4 >= n.version && D0._patchOldVolumeProfiles(0, i), i
};
D0.prototype.patchStudyData = function (n, t, i, r) {
    t = TradingView.clone(t);
    i = TradingView.clone(i);
    r = TradingView.clone(r);
    "VbPVisible@tv-volumebyprice" === n.id && n.version && 4 >= n.version && D0._patchOldVolumeProfiles(0, t.graphics);
    "VbPSessions@tv-volumebyprice" === n.id && n.version && 4 >= n.version && D0._patchOldVolumeProfiles(0, t.graphics);
    var u = StudyMetaInfo.versionOf(n);
    if (n.isTVScript && n.TVScriptSourceCode && 12 <= u && 26 >= u)for (n = t.columns, t.columns = [], u = 0; u < n.length; ++u)t.columns.push("plot_" + u);
    return{data: t, nsData: i, indexes: r}
};
D0._patchOldVolumeProfiles = function (n, t) {
    var r = t.hhists[n].data, i = [];
    for (var u in r)i = i.concat(r[u]);
    t.hhists[0].data = i
};
D0._fixInputsOrder = function (n, t) {
    for (var u, f = StudyMetaInfo.getOrderedInputIds(t), i = D0.splitInputs(n.inputs), e = i.arr, i = TradingView.merge({}, i.obj), r = 0; r < f.length; ++r)u = D0.findInputKeyById(e, f[r]), void 0 != u && (i[r] = e[u]);
    n.inputs = i
};
D0._fixInputsMaxValue = function (n, t) {
    var i, u, r;
    if (t.inputs)for (i = 0; i < t.inputs.length; i++)t.inputs[i].max && 253370764800 < t.inputs[i].max && (t.inputs[i].max = 253370764800);
    if (n && n.inputs) {
        i = D0.splitInputs(n.inputs);
        u = i.arr;
        for (key in u)r = u[key], r.max && 253370764800 < r.max && (r.max = 253370764800);
        n.inputs = TradingView.merge(i.obj, i.arr)
    }
};
D0.prototype.patchPropsStateAndMetaInfo = function (n, t) {
    var i;
    if (D0._fixInputsOrder(n, t), D0._fixInputsMaxValue(n, t), t.isTVScript && "undefined" != typeof TVScript && (t.scriptIdPart = t.scriptIdPart || TVScript.MetainfoGenerator.createScriptIdPart()), "Volume" !== t.id && "Volume@tv-basicstudies" !== t.id || 0 != t.inputs.length || (t.inputs = [
        {id: "length", type: "integer", defval: 20, min: 1, max: 1e3}
    ], t.plots.push({id: "vol_ma", type: "line"})), "PivotPointsStandard@tv-basicstudies" === t.id && (0 === t.inputs.length ? (n.inputs = {kind: "Traditional", showHistoricalPivots: !0}, t.inputs = [
        {defval: "Traditional", id: "kind", type: "text", options: "Traditional Fibonacci Woodie Classic DeMark Camarilla".split(" ")},
        {id: "showHistoricalPivots", type: "bool", defval: !0}
    ]) : 1 === t.inputs.length && (n.inputs = {kind: "Traditional"}, t.inputs = [
        {defval: "Traditional", id: "kind", type: "text", options: "Traditional Fibonacci Woodie Classic DeMark Camarilla".split(" ")},
        {id: "showHistoricalPivots", type: "bool", defval: !0}
    ]), void 0 == n._hardCodedDefaultsVersion) && (n._hardCodedDefaultsVersion = 1, i = n.color, delete n.color, n.levelsStyle = {colors: {P: i, "S1/R1": i, "S2/R2": i, "S3/R3": i, "S4/R4": i, "S5/R5": i}}), "CMF" === t.shortId && 2 === t.inputs.length && (n.inputs = {length: n.inputs["length fast"]}, t.inputs = t.inputs.splice(0, 1), t.inputs[0].id = "length"), t.defaults && !t.defaults.precision && (t.defaults.precision = -1 != ["Volume@tv-basicstudies", "VbPVisible@tv-volumebyprice", "VbPSessions@tv-volumebyprice"].indexOf(t.id) ? 0 : 4), "MA" === t.id) {
        var i = new StudyMetaInfo({id: "MAExp", properties: [
            {id: "is_price_study", type: "bool", value: "true"}
        ], inputs: [
            {id: "length", type: "integer", defval: 20, min: 1, max: 500},
            {id: "source", type: "text", defval: "close", options: ["open", "high", "low", "close"]}
        ], plots: [
            {id: "MovAvgExp", type: "line"}
        ], palettes: {}}), r = new StudyMetaInfo({id: "MASimple", properties: [
            {id: "is_price_study", type: "bool", value: "true"}
        ], inputs: [
            {id: "length", type: "integer", defval: 20, min: 1, max: 500},
            {id: "source", type: "text", defval: "close", options: ["open", "high", "low", "close"]}
        ], plots: [
            {id: "MovAvgSimple", type: "line"}
        ], palettes: {}}), u = new StudyMetaInfo({id: "MAVolumeWeighted", properties: [
            {id: "is_price_study", type: "bool", value: "true"}
        ], inputs: [
            {id: "length", type: "integer", defval: 20, min: 1, max: 500},
            {id: "source", type: "text", defval: "close", options: ["open", "high", "low", "close"]}
        ], plots: [
            {id: "MovAvgVolumeWeighted", type: "line"}
        ], palettes: {}}), f = new StudyMetaInfo({id: "MAWeighted", properties: [
            {id: "is_price_study", type: "bool", value: "true"}
        ], inputs: [
            {id: "length", type: "integer", defval: 20, min: 1, max: 500},
            {id: "source", type: "text", defval: "close", options: ["open", "high", "low", "close"]}
        ], plots: [
            {id: "MovAvgWeighted", type: "line"}
        ], palettes: {}});
        switch (n.inputs.type) {
            case"exp":
                result.metaInfo = i;
                break;
            case"simple":
                result.metaInfo = r;
                break;
            case"weighted":
                result.metaInfo = f;
                break;
            case"volume weighted":
                result.metaInfo = u
        }
        n.styles[t.plots[0].id] = n.styles.MovAvg;
        delete n.styles.MovAvg;
        delete n.inputs.type
    }
    return{propsState: n, metaInfo: t}
};
D0.compareStudyVersions = function (n, t) {
    n = n.toString();
    t = t.toString();
    var i = n.split("."), u = i[0], u = parseInt(u, 10), i = 1 < i.length ? i[1] : "0", i = parseInt(i, 10), r = t.split("."), f = r[0], f = parseInt(f, 10), r = 1 < r.length ? r[1] : "0", r = parseInt(r, 10);
    return u < f ? -1 : u > f ? 1 : i < r ? -1 : i > r ? 1 : 0
};
D0.isLess = function (n, t) {
    return 0 > D0.compareStudyVersions(n, t)
};
D0.isLessOrEqual = function (n, t) {
    return 0 >= D0.compareStudyVersions(n, t)
};
D0.isEqual = function (n, t) {
    return 0 == D0.compareStudyVersions(n, t)
};
D0.isGreater = function (n, t) {
    return 0 < D0.compareStudyVersions(n, t)
};
D0.isGreaterOrEqual = function (n, t) {
    return 0 <= D0.compareStudyVersions(n, t)
};
D0.isVersionTesting = function (n) {
    return n ? (n = n.toString(), /\d+.\d+/.exec(n) == n) : !1
};
D0.isVersionHead = function (n) {
    return n ? (n = n.toString(), /\d+/.exec(n) == n) : !1
};
D0.mergeInputs = function (n, t) {
    D0.mergeInputsArrPart(n, t);
    D0.mergeInputsObjPart(n, t)
};
D0.mergeInputsArrPart = function (n, t) {
    var i = D0.splitInputs(t), r, u;
    for (r in i.arr)u = D0.findInputKeyById(n, i.arr[r].id), u ? TradingView.merge(n[u], i.arr[r]) : D0.appendInputInfoToArr(n, i.arr[r])
};
D0.mergeInputsObjPart = function (n, t) {
    var i = D0.splitInputs(t);
    TradingView.merge(n, i.obj)
};
D0.appendInputInfoToArr = function (n, t) {
    var r = -1, u, i;
    for (u in n)i = parseInt(u, 10), isNumber(i) && i > r && (r = i);
    n[r + 1] = t
};
D0.splitInputs = function (n) {
    var i = {}, r = {};
    for (var t in n)isNumber(parseInt(t, 10)) ? i[t] = n[t] : r[t] = n[t];
    return{arr: i, obj: r}
};
D0.findInputKeyById = function (n, t) {
    var r = null;
    for (var i in n)if (isNumber(parseInt(i, 10)) && n[i].id == t) {
        r = i;
        break
    }
    return r
};
D0.getInputKeyById = function (n, t) {
    var i = D0.findInputKeyById(n, t);
    if (!i)throw Error("Cannot find input with id: " + t);
    return i
};
D48 = function (n, t, i, r, u) {
    TradingView.Study.call(this, n, t, i, r);
    this._paneView = u
};
inherit(D48, TradingView.Study);
D48.prototype.onData = function (n) {
    switch (n.method) {
        case"data_update":
            var t = "" !== n.params.nonseries.d ? JSON.parse(n.params.nonseries.d) : {};
            t.indexes_replace || (this._nonseriesdata = t.data);
            this._indexes = n.params.nonseries.indexes;
            n = this.Q0.paneForSource(this);
            this.Q0.recalculatePane(n, !0);
            this.Q0.updateSource(this);
            break;
        default:
            return TradingView.Study.prototype.onData.call(this, n)
    }
};
D48.prototype.updateAllViews = function () {
    this._paneView.update();
    this._dataWindowView.update();
    this._statusView.update()
};
D48.prototype.paneViews = function (n) {
    return n = new List, n.append(this._paneView), n
};
D48.prototype.state = function (n) {
    var t = TradingView.Study.prototype.state.call(this, n);
    return n && (t.nonSeriesData = this._nonseriesdata, t.indexes = this._indexes), t
};
D48.prototype.restoreData = function (n, t, i) {
    TradingView.Study.prototype.restoreData.call(this, n);
    this._nonseriesdata = t;
    this._indexes = i
};
D48.prototype.clearData = function () {
    this._indexes = this._nonseriesdata = null
};
LocationToYMixin.prototype._locationToY = function (n, t, i) {
    var u, f, o, s, e, r;
    i || (i = 0);
    u = [];
    f = this.Q1.priceScale();
    switch (n) {
        case CanvasEx.MARKLOC_ABOVEBAR:
            o = HIGH_PLOT;
            break;
        case CanvasEx.MARKLOC_BELOWBAR:
            o = LOW_PLOT
    }
    for (s = this.Q1.firstValue(), 1 <= i && --i, e = -i; e <= i; e++)r = this.Q1.series().bars().valueAt(t + e), r && (r = r[o], f.isPercent() && (r = f.priceRange().convertToPercent(r, s)), u.push(f.priceToCoordinate(r)));
    switch (n) {
        case CanvasEx.MARKLOC_ABOVEBAR:
            return MathEx.min(u) - 15;
        case CanvasEx.MARKLOC_BELOWBAR:
            return MathEx.max(u) + 15
    }
};
J33.isNaNOrUndefOrNull = function (n) {
    return isNaN(n) || void 0 === n || null === n
};
J33.isIndexValid = function (n, t) {
    return 0 <= n && n < t._length()
};
J33.prototype.items = function () {
    return this.m_items
};
J33.prototype.update = function () {
    this._invalidated = !0
};
J33.prototype._updateImpl = function () {
    var f, n, s, u;
    if (this.m_items.clear(), this._histogramBase = null, !this.m_model.timeScale().isEmpty() && !this.m_study.priceScale().isEmpty() && (f = this.m_model.timeScale().visibleBars().clone(), !f.isEmpty())) {
        var e = this.m_series.nearestIndex(f.firstBar(), SEARCH_NEAREST_RIGHT), o = this.m_series.nearestIndex(f.lastBar(), SEARCH_NEAREST_LEFT), f = this.m_study.offset(this._plotName);
        0 < f ? (e -= f, o += f) : (e += f, o -= f);
        var h = this.m_study.properties().styles[this._plotName].plottype.value(), l = 0 <= [TradingView.Study.PLOT_LINE, TradingView.Study.PLOT_AREA, TradingView.Study.PLOT_CIRCLES, TradingView.Study.PLOT_CROSS].indexOf(h), i = this.m_study.data(), h = this.m_study.firstValue();
        if (l && 0 < i._length()) {
            for (n = i._bsearch(e); J33.isIndexValid(n, i) && J33.isNaNOrUndefOrNull(i._valueAt(n)[this._plotIndex + 1]);)--n;
            for (e = J33.isIndexValid(n, i) ? i._indexAt(n) : e, n = i._bsearch(o); J33.isIndexValid(n, i) && J33.isNaNOrUndefOrNull(i._valueAt(n)[this._plotIndex + 1]);)n += 1;
            o = J33.isIndexValid(n, i) ? i._indexAt(n) : o
        }
        for (var c = i.range(e, o), i = this.m_study.priceScale(), a = i.properties().percentage.value(), v = this._getTranspValue(), n = c._start; n < c._end; ++n) {
            var r = c._indexAt(n), r = r + f, r = Math.floor(r), u = c._valueAt(n), t = u[this._plotIndex + 1], t = null !== t && void 0 !== t ? t : NaN;
            a && !isNaN(t) && (t = 100 * (t - h) / h);
            l && isNaN(t) || (r = new MathEx.Point(r, t), t = void 0 !== u[this._colorer + 1] || this._palette && this._palette.addDefaultColor, this._colorer && t && (t = u[this._colorer + 1], r.style = {}, void 0 != t ? (s = this._palette.valToIndex ? this._palette.valToIndex[t] : t, u = this._paletterProps.colors[s].color.value(), r.style.color = generateColor(u, v)) : (u = this.m_study.properties().styles[this._plotName].color.value(), r.style.color = generateColor(u, 100)), u = void 0 != s ? this._paletterProps.colors[s].width.value() : this.m_study.properties().styles[this._plotName].linewidth.value(), t = void 0 != s ? this._paletterProps.colors[s].style.value() : this.m_study.properties().styles[this._plotName].linestyle.value(), r.style.width = u, r.style.style = t), this.m_items.append(r))
        }
        if (i.pricesToCoordinates(this.m_items), this.m_model.timeScale().indexesToCoordinates(this.m_items), this.m_study.properties().styles[this._plotName].histogramBase && (this._histogramBase = this.m_study.priceScale().priceToCoordinate(this.m_study.properties().styles[this._plotName].histogramBase.value())), this.m_study === this.m_model.selectedSource())for (e = (new SelectionIndexes).calc(e, o), this._selectionData = {points: new List}, this._selectionData.hittestResult = HitTestResult.REGULAR, n = 0; n < e.size(); n++)r = e.item(n), u = this.m_study.data().valueAt(r), r += f, void 0 !== u && (t = u[this._plotIndex + 1], i.properties().percentage.value() && (t = 100 * (t - h) / h), s = this.m_model.timeScale().indexToCoordinate(Math.floor(r)), o = this.m_study.priceScale().priceToCoordinate(t), this._selectionData.points.append(new MathEx.Point(s, o)))
    }
};
J33.prototype._getTranspValue = function () {
    var n = 0, t, i;
    return(this.m_study.properties().transparency && (n = this.m_study.properties().transparency.value(), n = isNumber(n) ? n : 50), t = this.m_study.properties().styles[this._plotName], i = t.plottype.value(), "Volume@tv-basicstudies" === this.m_study.metaInfo().id && i === TradingView.Study.PLOT_COLUMNS) ? n : (0 <= [TradingView.Study.PLOT_AREA, TradingView.Study.PLOT_AREA_WITH_BREAKS, TradingView.Study.PLOT_COLUMNS].indexOf(i) && t.transparency && (n = t.transparency.value(), n = isNumber(n) ? n : 50), n)
};
J33.prototype.renderer = function () {
    var t = this.m_study.properties().styles[this._plotName];
    if (t.visible.value() && this.m_study.priceScale()) {
        this._invalidated && (this._updateImpl(), this._invalidated = !1);
        var n = {}, i = this._getTranspValue(), r = t.color.value();
        n.barSpacing = this.m_model.timeScale().barSpacing();
        n.items = this.m_items;
        n.histogramBase = this._histogramBase ? this._histogramBase : this.m_study.priceScale().height();
        n.lineIndex = 0;
        n.lineColor = generateColor(t.color.value(), i);
        n.lineStyle = t.linestyle.value();
        n.lineWidth = t.linewidth.value();
        this._colorer && (r = this._paletterProps.colors[0].color.value(), n.lineWidth = this._paletterProps.colors[0].width.value(), n.lineColor = generateColor(this._paletterProps.colors[0].color.value(), i));
        n.lineWidth = isNumber(n.lineWidth) ? n.lineWidth : 1;
        n.color2 = generateColor(r, i);
        var r = new RGBColor(r), u = TradingView.rgbToHsl(r.r, r.g, r.b), f = u[0] + .05;
        u[0] = f - Math.floor(f);
        u = TradingView.hslToRgb(u[0], u[1], u[2]);
        r.r = u[0];
        r.g = u[1];
        r.b = u[2];
        r = r.toHex();
        n.color1 = generateColor(r, i);
        n.bottom = n.histogramBase;
        this._colorer || (n.simpleMode = !0);
        i = new CompositeRenderer;
        r = t.joinPoints ? t.joinPoints.value() : !1;
        switch (t.plottype.value()) {
            case TradingView.Study.PLOT_LINE:
            case TradingView.Study.PLOT_LINE_WITH_BREAKS:
                i.append(new J68(n));
                break;
            case TradingView.Study.PLOT_AREA:
            case TradingView.Study.PLOT_AREA_WITH_BREAKS:
                i.append(new J53(n));
                break;
            case TradingView.Study.PLOT_HISTOGRAM:
                i.append(new J66(n));
                break;
            case TradingView.Study.PLOT_COLUMNS:
                i.append(new J60(n));
                break;
            case TradingView.Study.PLOT_CROSS:
                i.append(new J61(n));
                r && (t = TradingView.merge({}, n), t.lineWidth = 1, t.forceLineWidth = !0, i.append(new J68(t)));
                break;
            case TradingView.Study.PLOT_CIRCLES:
                i.append(new J58(n));
                r && (t = TradingView.merge({}, n), t.lineWidth = 1, t.ignorePaletteLineWidth = !0, i.append(new J68(t)));
                break;
            default:
                i.append(new J68(n))
        }
        return this.m_study === this.m_model.selectedSource() && i.append(new SelectionRenderer(this._selectionData)), i
    }
};
J30.prototype.items = function () {
    return this._items
};
J30.prototype.update = function () {
    this._invalidated = !0
};
J30.prototype._scalesReady = function () {
    var n = this.Q0.timeScale(), t = this.Q1.priceScale();
    return n && t && !n.isEmpty() && !t.isEmpty()
};
J30.prototype._updateImpl = function () {
    var n;
    if (this._items.clear(), assert(this._scalesReady(), "Scales must be ready!"), n = this.Q0.timeScale().visibleBars().clone(), !n.isEmpty()) {
        var u = this.Q1.metaInfo().plots[this._plotIndex].palette, s = this.Q1.properties().palettes[u].colors, u = this.Q1.metaInfo().palettes[u], o = this.Q1.properties().styles[this._plotName].transparency.value(), t = this._series.nearestIndex(n.firstBar(), SEARCH_NEAREST_RIGHT), i = this._series.nearestIndex(n.lastBar(), SEARCH_NEAREST_LEFT), n = this.Q1.offset(this._plotName);
        for (0 < n ? (t -= n, i += n) : (t += n, i -= n), t = this.Q1.data().range(t, i), i = t._start; i < t._end; ++i) {
            var r = t._indexAt(i), r = r + n, f = t._valueAt(i)[this._plotIndex + 1], r = new MathEx.Point(Math.floor(r) - .5), e = isNumber(o) ? o : 50, e = Math.min(e, 100), e = Math.max(e, 0);
            void 0 != f ? (colorIndexInPalette = u.valToIndex ? u.valToIndex[f] : f, r.color = generateColor(s[colorIndexInPalette].color.value(), e)) : r.color = null;
            this._items.append(r)
        }
        this.Q0.timeScale().indexesToCoordinates(this._items)
    }
};
J30.prototype.renderer = function () {
    if (this.Q1.properties().styles[this._plotName].visible && this.Q1.properties().styles[this._plotName].visible.value() && this._scalesReady()) {
        this._invalidated && (this._updateImpl(), this._invalidated = !1);
        var t = {items: this._items, y: 0, h: this.Q1.priceScale().height(), w: Math.ceil(this.Q0.timeScale().barSpacing())}, n = new CompositeRenderer;
        return n.append(new J55(t)), n
    }
};
J36.prototype.items = function () {
    return this.m_items
};
J36.prototype.update = function () {
    this.m_invalidated = !0
};
J36.prototype._scalesReady = function () {
    var n = this.m_model.timeScale(), t = this.m_study.priceScale();
    return n && t && !n.isEmpty() && !t.isEmpty()
};
J36.prototype._updateImpl = function () {
    var r, a, s, l, u;
    if (this.m_items.clear(), this._scalesReady()) {
        var i = this.m_model.timeScale(), h = this.m_study.priceScale(), i = i.visibleBars().clone();
        if (!i.isEmpty()) {
            var f = this.m_series.nearestIndex(i.firstBar(), SEARCH_NEAREST_RIGHT), e = this.m_series.nearestIndex(i.lastBar(), SEARCH_NEAREST_LEFT), i = this.m_study.offset(this.m_plotName);
            0 < i ? (f -= i, e += i) : (f += i, e -= i);
            var o = this.m_study.data(), y = this.m_study.firstValue(), o = o.range(f, e), w = h.properties().percentage.value();
            for (h.priceRange(), h = this._getTranspValue(), f = (new SelectionIndexes).calc(f, e).toArray(), (e = this.m_study === this.m_model.selectedSource()) && (this.m_selectionData = {points: new List, hittestResult: HitTestResult.REGULAR, vertOffset: 0}), r = this.m_series.properties().style.value(), (r = r === TradingView.Series.STYLE_LINE ? "lineStyle" : r === TradingView.Series.STYLE_AREA ? "areaStyle" : null) ? a = r = this.m_series.properties()[r].priceSource.value() : (r = "high", a = "low"), s = o._start; s < o._end; ++s) {
                var p = o._indexAt(s), v = Math.floor(p + i), t = function (n) {
                    try {
                        var t = this.m_series[n || "close"](v)
                    } catch (i) {
                        t = null
                    }
                    return t
                }.bind(this), c = o._valueAt(s), n = c[this.m_plotIndex + 1];
                if (null !== n && void 0 !== n) {
                    if (w && (n = 100 * (n - y) / y), l = this.m_study.metaInfo().plots[this.m_plotIndex].type, u = this.m_study.properties().styles[this.m_plotName].location, l = (l = l == TradingView.Study.PLOT_TYPE_ARROWS) || u && 0 <= [CanvasEx.MARKLOC_ABOVEBAR, CanvasEx.MARKLOC_BELOWBAR].indexOf(u.value())) {
                        if (u = t(r), t = t(a), void 0 == u || void 0 == t)continue
                    } else t = u = n;
                    t = this._createItem(v, n, u, t);
                    void 0 != t && (n = void 0 !== c[this._colorer + 1] || this._palette && this._palette.addDefaultColor, this._colorer && n && (n = c[this._colorer + 1], t.style = {}, void 0 != n ? (n = this._paletterProps.colors[this._palette.valToIndex ? this._palette.valToIndex[n] : n].color.value(), t.style.color = generateColor(n, h)) : (n = this.m_study.properties().styles[this.m_plotName].color.value(), t.style.color = generateColor(n, 100))), this.m_model.timeScale().indexToCoordinate(Math.floor(v)), this.m_study.priceScale().priceToCoordinate(c), e && -1 !== $.inArray(p, f) && this.m_selectionData.points.append(t), this.m_items.append(t))
                }
            }
            this._convertItemsToCoordinates()
        }
    }
};
J36.prototype._getTranspValue = function () {
    var n = 0, t;
    return this.m_study.properties().transparency && (n = this.m_study.properties().transparency.value(), n = isNumber(n) ? n : 50), t = this.m_study.properties().styles[this.m_plotName], t.transparency && (n = t.transparency.value(), n = isNumber(n) ? n : 50), n
};
J36.prototype._createItem = function (n, t, i, r) {
    var f = this.m_study.properties().styles[this.m_plotName].location.value(), u = this.m_study.priceScale(), e = u.coordinateToPrice(u.height() * u.topMargin()), u = u.coordinateToPrice(u.height() * (1 - u.bottomMargin()));
    if (!t && f != CanvasEx.MARKLOC_ABSOLUTE)return null;
    switch (f) {
        case CanvasEx.MARKLOC_ABOVEBAR:
            t = i;
            break;
        case CanvasEx.MARKLOC_BELOWBAR:
            t = r;
            break;
        case CanvasEx.MARKLOC_TOP:
            t = e;
            break;
        case CanvasEx.MARKLOC_BOTTOM:
            t = u;
            break;
        case CanvasEx.MARKLOC_ABSOLUTE:
            break;
        default:
            throw Error("Bad value: " + f);
    }
    return new MathEx.Point(n, t)
};
J36.prototype._convertItemsToCoordinates = function () {
    var n = this.m_model.timeScale(), t = this.m_study.priceScale();
    n.indexesToCoordinates(this.m_items);
    t.pricesToCoordinatesEx(this.m_items.toArray(), function (n) {
        return n.y
    }, function (n, t) {
        n.y = t
    })
};
J36.prototype._calculateVerticalOffset = function (n, t) {
    var i;
    switch (n) {
        case CanvasEx.MARKLOC_ABOVEBAR:
        case CanvasEx.MARKLOC_BOTTOM:
            i = -t;
            break;
        case CanvasEx.MARKLOC_BELOWBAR:
        case CanvasEx.MARKLOC_TOP:
            i = t;
            break;
        default:
            i = 0
    }
    return i
};
J36.prototype._calculateShapeHeight = function (n) {
    return Math.round(n / 2)
};
J36.prototype.renderer = function () {
    var i;
    if (this.m_study.properties().styles[this.m_plotName].visible && this.m_study.properties().styles[this.m_plotName].visible.value() && this._scalesReady()) {
        i = this.m_model.timeScale();
        this.m_invalidated && (this._updateImpl(), this.m_invalidated = !1);
        var t = {}, r = this._getTranspValue(), n = i.barSpacing(), u = this._calculateShapeHeight(n), i = this.m_study.properties().styles[this.m_plotName].location.value(), i = this._calculateVerticalOffset(i, u + u / 2);
        return t.barSpacing = n, t.items = this.m_items, t.color = generateColor(this.m_study.properties().styles[this.m_plotName].color.value(), r), t.height = u, t.vertOffset = i, n = this.m_study.properties().styles[this.m_plotName].plottype.value(), r = TradingView.StudyPlotShapes.Data[n], void 0 == r && console.error("Unknown style " + n), n = new CompositeRenderer, n.append(new window[r.paneRendererClass](t)), this.m_study === this.m_model.selectedSource() && (this.m_selectionData.vertOffset = i, n.append(new SelectionRenderer(this.m_selectionData))), n
    }
};
inherit(J35, J36);
J35.prototype._calculateShapeHeight = function (n) {
    return Math.round(n)
};
J35.prototype.renderer = function () {
    var i, r, n, t;
    if (this.m_study.properties().styles[this.m_plotName].visible && this.m_study.properties().styles[this.m_plotName].visible.value() && this._scalesReady())return i = this.m_model.timeScale(), this.m_study.priceScale(), this.m_invalidated && (this._updateImpl(), this.m_invalidated = !1), r = {}, n = 0, this.m_study.properties().transparency && (n = this.m_study.properties().transparency.value(), n = isNumber(n) ? n : 50), t = this.m_study.properties().styles[this.m_plotName], t.transparency && (n = t.transparency.value(), n = isNumber(n) ? n : 50), i = i.barSpacing(), i = this._calculateShapeHeight(i), t = this.m_study.properties().styles[this.m_plotName].location.value(), t = this._calculateVerticalOffset(t, i), r.items = this.m_items, r.char = this.m_study.properties().styles[this.m_plotName].char.value(), r.height = i, r.vertOffset = t, r.color = generateColor(this.m_study.properties().styles[this.m_plotName].color.value(), n), n = new CompositeRenderer, n.append(new J73(r)), this.m_study === this.m_model.selectedSource() && (this.m_selectionData.vertOffset = t, n.append(new SelectionRenderer(this.m_selectionData))), n
};
inherit(J34, J36);
J34.prototype.renderer = function () {
    var t, n, i;
    if (this.m_study.properties().styles[this.m_plotName].visible && this.m_study.properties().styles[this.m_plotName].visible.value() && this._scalesReady())return this.m_invalidated && (this._updateImpl(), this.m_invalidated = !1), t = {}, n = 0, this.m_study.properties().transparency && (n = this.m_study.properties().transparency.value(), n = isNumber(n) ? n : 50), i = this.m_study.properties().styles[this.m_plotName], i.transparency && (n = i.transparency.value(), n = isNumber(n) ? n : 50), i = this.m_model.timeScale().barSpacing(), t.items = this.m_items, t.barSpacing = i, t.colorup = generateColor(this.m_study.properties().styles[this.m_plotName].colorup.value(), n), t.colordown = generateColor(this.m_study.properties().styles[this.m_plotName].colordown.value(), n), t.colorBorder = generateColor("#000000", n), t.minHeight = this.m_study.properties().styles[this.m_plotName].minHeight.value(), t.maxHeight = this.m_study.properties().styles[this.m_plotName].maxHeight.value(), n = new CompositeRenderer, n.append(new J54(t)), this.m_study === this.m_model.selectedSource() && (t = this.m_selectionData, t.barSpacing = i, n.append(new SelectionRendererArrowsUpDown(t))), n
};
J34.prototype._createItem = function (n, t, i, r) {
    if (0 !== t) {
        Math.abs(t) > this._maxAbsValue && (this._maxAbsValue = Math.abs(t));
        var u = 0 < t;
        return new PaneRendererArrowsUpDownItem(n, u ? r : i, t, u)
    }
};
J34.prototype._convertItemsToCoordinates = function () {
    var n = this.m_model.timeScale(), t = this.m_study.priceScale(), u, f;
    if (n.indexesToCoordinates(this.m_items), t.pricesToCoordinatesEx(this.m_items.toArray(), function (n) {
        return n.y
    }, function (n, t) {
        n.y = t
    }), n = Math.abs(this.m_study.properties().styles[this.m_plotName].minHeight.value()), t = Math.abs(this.m_study.properties().styles[this.m_plotName].maxHeight.value()), n > t)var i = n, n = t, t = i;
    for (var t = (t - n) / this._maxAbsValue, i = this.m_items.toArray(), r = 0; r < i.length; r++)u = i[r], f = Math.abs(u.height), u.height = f * t + n
};
inherit(J51, PriceAxisView);
J51.prototype.update = function () {
    this._invalidated = !0
};
J51.prototype._updateImpl = function () {
    this._visible = !1;
    this._text = "";
    var n = this.Q1.lastValueData(this._plotIndex);
    n && (this._visible = !0, this._text = n.text, this._coordinate = n.coordinate, this._floatCoordinate = n.floatCoordinate, this._background = n.color, this._textHeight = this.Q1.priceScale().m_markBuilder.fontHeight())
};
J51.prototype.coordinate = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.coordinate.call(this)
};
J51.prototype.renderer = function () {
    this._invalidated && (this._updateImpl(), this._invalidated = !1);
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: this._visible};
    return new PriceAxisViewRenderer(n)
};
J51.prototype.text = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.text.call(this)
};
inherit(StudyDataWindowView, DataWindowView);
StudyDataWindowView.prototype.update = function () {
    this._invalidated = !0
};
StudyDataWindowView.prototype._updateImpl = function () {
    var r, n;
    for (this._header = this.Q1.title(!0), this._title = this.Q1.title(), r = $.t("n/a"), n = 0; n < this._items.size(); ++n)this._items.item(n).setValue(r);
    if (!this.Q0.timeScale().isEmpty()) {
        var f = this.Q1.metaInfo().plots, t = null, r = {};
        if (f)for (n = 0; n < f.length; n++)this.Q1.isSelfColorerPlot(n) && (r[f[n].target] = {index: n}, r[f[n].target].palette = this.Q1.metaInfo().palettes[f[n].palette], r[f[n].target].paletterProps = this.Q1.properties().palettes[f[n].palette]);
        for (var f = this.Q0.crossHairSource().index, e = this.Q1.formatter(), n = 0; n < this._items.size(); ++n) {
            var u = this._items.item(n).plotId, t = this._items.item(n).plotIndex, i = this.Q1.offset(u), i = this.Q1.nearestIndex(f - i, SEARCH_NEAREST_LEFT);
            void 0 !== i && (i = this.Q1.data().valueAt(i) || this.Q1.data().last()) && (t = i[t + 1], isNumber(t) && (this._items.item(n).setValue(e.format(t)), t = this.Q1.properties().styles[u].color.value(), r[u] && i.length > r[u].index + 1 ? (i = i[r[u].index + 1], void 0 != i ? (t = r[u].palette, u = r[u].paletterProps, t = t.valToIndex ? t.valToIndex[i] : i, this._items.item(n).setColor(u.colors[t].color.value())) : this._items.item(n).setColor(t)) : this._items.item(n).setColor(t)))
        }
    }
};
StudyDataWindowView.prototype.items = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), this._items
};
inherit(DataVendorStudyDataWindowView, StudyDataWindowView);
DataVendorStudyDataWindowView.prototype.additional = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), this._additional
};
DataVendorStudyDataWindowView.prototype._updateImpl = function () {
    var n = TradingView.getDataVendorString(this.Q1.symbolInfo());
    return this._additional = n ? "(Data Provided by " + n + ")" : void 0, StudyDataWindowView.prototype._updateImpl.call(this)
};
inherit(StudyStatusView, StatusView);
StudyStatusView.prototype.color = function () {
    return this.Q1._failed ? "#ff0000" : StatusView.prototype.color.call(this)
};
StudyStatusView.prototype.update = function () {
    this._text = this.Q1._failed ? this.Q1.title(!0) + ": " + this.Q1.status() : this.Q1.title(!0) + " " + this.Q1.status()
};
_90.prototype.addAnchors = function (n) {
    if (this.isAnchorsRequired()) {
        var t = this._points.clone();
        this.Q0.lineBeingCreated() == this.J99 && t.removeAt(t.size() - 1);
        n.append(this.createLineAnchor({points: t}))
    }
};
_90.prototype.update = function () {
    var i = this.J99.priceScale(), n = this.Q0.timeScale(), r, t;
    if (i && !i.isEmpty() && !n.isEmpty())for (this._points = new List, this._floatPoints = new List, i = this.J99.points(), n = 0; n < i.size(); n++) {
        if (r = i.item(n), t = this.J99.pointToScreenPoint(r), !t)break;
        r = t[0];
        r.data = n;
        t = t[1];
        t.data = n;
        this._floatPoints.append(r);
        this._points.append(t)
    }
};
_90.prototype.currentPoint = function () {
    var n = this.Q0.crossHairSource();
    return new MathEx.Point(n.x, n.y)
};
_90.prototype.anchorColor = function () {
    return this.J99.isBeingEdited() ? "#D61AD3" : this.Q0.isDark() ? "#FFFFFF" : "#606060"
};
_90.prototype.isHoveredSource = function () {
    return this.J99 === this.Q0.hoveredSource()
};
_90.prototype.isSelectedSource = function () {
    return this.J99 === this.Q0.selectedSource()
};
_90.prototype.isAnchorsRequired = function () {
    return this.isHoveredSource() || this.isSelectedSource()
};
_90.prototype.createLineAnchor = function (n) {
    return new LineAnchor($.extend({color: this.anchorColor(), backgroundColor: this.Q0.backgroundColor(), currentPoint: this.currentPoint(), linePointBeingEdited: this.Q0.linePointBeingEdited(), hittestResult: HitTestResult.CHANGEPOINT, radius: (TradingView.isMobile.any() ? 15 : 7) + (this.isSelectedSource() ? 1 : 0), strokeWidth: (TradingView.isMobile.any() ? 3 : 1) + (this.isSelectedSource() ? 1 : 0)}, n))
};
TradingView.study_Compare = function (n, t, i, r) {
    this._symbolLabelView = new TradingView.J38(n, this, "compare");
    TradingView.Study.call(this, n, t, i, r);
    var u = this;
    this.Q2.minTick.listeners().subscribe(null, function () {
        u._createFormatter()
    });
    this.properties().minTick.listeners().subscribe(null, function () {
        u.Q0.Q20(new D22(D22.FULL_UPDATE))
    });
    this.Q2.merge({skipHistogramBaseOnAutoScale: !0})
};
inherit(TradingView.study_Compare, TradingView.Study);
TradingView.study_Compare.prototype.createViews = function () {
    this._dataWindowView || (this._dataWindowView = new DataVendorStudyDataWindowView(this, this.Q0));
    TradingView.Study.prototype.createViews.call(this);
    this._paneViews.append(this._symbolLabelView)
};
TradingView.study_Compare.prototype._createFormatter = function () {
    var n = this.properties().inputs.symbol.value(), n = this._resolvedSymbols ? this._resolvedSymbols[n] : null;
    if ("default" == this.properties().minTick.value())this._formatter = new PriceFormatter(n ? n.pricescale : 100, n ? n.minmov : 1, n ? n.fractional : !1); else {
        var n = this.properties().minTick.value(), n = isNumber(n) ? ["100", "1", "false"] : n.split(","), t = parseInt(n[0]), i = parseInt(n[1]);
        this._formatter = new PriceFormatter(t, i, "true" === n[2])
    }
    this.priceScale() && this.priceScale().updateFormatter()
};
TradingView.study_Compare.prototype.symbol = function () {
    var n = this.properties().inputs.symbol.value(), t = this._resolvedSymbols ? this._resolvedSymbols[n] : null;
    return(t ? t.name : n).toUpperCase()
};
TradingView.study_Compare.prototype.title = function (n) {
    n = this.properties().inputs.symbol.value();
    var t = this._resolvedSymbols ? this._resolvedSymbols[n] : null;
    return(t ? t.name + ", " + t.exchange : n).toUpperCase()
};
TradingView.study_Compare.prototype.symbolInfo = function () {
    if (!this._resolvedSymbols)return null;
    var n = this.Q2.inputs.symbol.value();
    return n ? this._resolvedSymbols[n] : null
};
TradingView.study_Compare.prototype.lastPriceLabelFixedCoordinate = function () {
    return this._priceAxisViews.item(0)._fixedCoordinate
};
AreaBackgroundRenderer.prototype.hitTest = function (n) {
    selectionTolerance(this.lineWidth);
    for (var t = 1; t < this._data.points1.length; ++t)if (currY1 = this._data.points1[t], currY2 = this._data.points2[t], x = this._data.timePoints[t], x == n.x && (n.y >= currY1 && n.y <= currY2 || n.y <= currY1 && n.y >= currY2))return new HitTestResult(HitTestResult.REGULAR);
    return null
};
AreaBackgroundRenderer.prototype.draw = function (n) {
    if (0 !== this._data.points1.length && 0 !== this._data.points2.length)for (var v = this._data.timePoints, s = this._data.points1, h = this._data.points2, c = this._data.getBarSpacing() / 4, u = paneRendererCoordinateIsValid, f = isNumber(this._data.transparency) ? this._data.transparency : 50, f = Math.min(f, 100), f = Math.max(f, 0), f = generateColor(this._data.backcolor, f), t, i, e, o, l, a, r = 0; r < this._data.timePoints.length; r++)if (i = v[r], e = s[r], o = h[r], l = s[r + 1], a = h[r + 1], u(e) && u(o) && (t || (t = {points1: [], points2: [], timePoints: []}), t.points1.push(e), t.points2.push(o), t.timePoints.push(i)), t && (!u(l) || !u(a))) {
        for (1 === t.timePoints.length && (t.timePoints = [t.timePoints[0] - c, t.timePoints[0] + c], t.points1.push(t.points1[0]), t.points2.push(t.points2[0])), n.beginPath(), n.moveTo(t.timePoints[0], t.points1[0]), i = 1; i < t.timePoints.length; i++)n.lineTo(t.timePoints[i], t.points1[i]);
        for (0 < t.timePoints.length && 0 < t.points2.length && n.lineTo(t.timePoints[t.timePoints.length - 1], t.points2[t.timePoints.length - 1]), i = t.timePoints.length - 2; 0 <= i; i--)n.lineTo(t.timePoints[i], t.points2[i]);
        n.closePath();
        n.fillStyle = f;
        n.fill();
        t = null
    }
};
TradingView._53 = function (n) {
    this.J99 = n;
    this._points1 = [];
    this._points2 = [];
    this._timePoints = [];
    this._getBarSpacing = n.model().timeScale().barSpacing.bind(n.model().timeScale());
    this._invalidated = !0
};
TradingView._53.prototype.update = function () {
    this._invalidated = !0
};
TradingView._53.prototype._updateImpl = function () {
    var i, o, n, f;
    if (this._points1 = [], this._points2 = [], this._timePoints = [], this._visible() && (i = this.J99.priceScale(), o = this.J99.Q0.timeScale(), i && !i.isEmpty() && !this.J99.Q0.timeScale().isEmpty() && !this.J99._series.bars().isEmpty())) {
        var h = this.J99.data()._columns.indexOf(this._plotAId()) + 1, c = this.J99.data()._columns.indexOf(this._plotBId()) + 1, n = this.J99.Q0.timeScale().visibleBars();
        if (!n.isEmpty()) {
            var r = this.J99.offset(this._plotAId()), t = this.J99._series.nearestIndex(n.firstBar(), SEARCH_NEAREST_RIGHT), n = this.J99._series.nearestIndex(n.lastBar(), SEARCH_NEAREST_LEFT);
            if (0 < r ? (t -= r, n += r) : (t += r, n -= r), t = this.J99.data().range(t, n), 0 < this.J99.data()._items.length)for (this.J99.data(), n = this.J99.firstValue(), f = t._start; f < t._end; ++f) {
                var s = t._indexAt(f), u = t._valueAt(f), s = s + r, e = u[h];
                i.properties().percentage.value() && (e = 100 * (e - n) / n);
                this._points1.push(e);
                u = u[c];
                i.properties().percentage.value() && (u = 100 * (u - n) / n);
                this._points2.push(u);
                this._timePoints.push(o.indexToCoordinate(s))
            }
            i.pricesArrayToCoordinates(this._points1);
            i.pricesArrayToCoordinates(this._points2)
        }
    }
};
TradingView._53.prototype.renderer = function () {
    this._invalidated && (this._updateImpl(), this._invalidated = !1);
    var n = {};
    return n.points1 = this._points1, n.points2 = this._points2, n.timePoints = this._timePoints, n.getBarSpacing = this._getBarSpacing, n.backcolor = this._color(), n.transparency = this._transparency(), new AreaBackgroundRenderer(n)
};
TradingView._53.prototype._plotAId = function () {
    assert(!1, "Pure virtual call!")
};
TradingView._53.prototype._plotBId = function () {
    assert(!1, "Pure virtual call!")
};
TradingView._53.prototype._color = function () {
    assert(!1, "Pure virtual call!")
};
TradingView._53.prototype._transparency = function () {
    assert(!1, "Pure virtual call!")
};
TradingView._53.prototype._visible = function () {
    assert(!1, "Pure virtual call!")
};
TradingView._55 = function (n) {
    TradingView._53.call(this, n)
};
inherit(TradingView._55, TradingView._53);
TradingView._55.prototype._plotAId = function () {
    return this.J99.properties().area[0].name.value()
};
TradingView._55.prototype._plotBId = function () {
    return this.J99.properties().area[1].name.value()
};
TradingView._55.prototype._color = function () {
    return this.J99.properties().areaBackground.backgroundColor.value()
};
TradingView._55.prototype._transparency = function () {
    return this.J99.properties().areaBackground.transparency.value()
};
TradingView._55.prototype._visible = function () {
    return this.J99.properties().areaBackground.fillBackground.value()
};
TradingView.J2 = function (n, t, i) {
    TradingView._53.call(this, n);
    assert(t.type === StudyMetaInfo.FilledArea.TYPE_PLOTS, "Wrong filledArea type: " + t.type);
    this._fillMetaInfo = t;
    this._fillStyleProps = i
};
inherit(TradingView.J2, TradingView._53);
TradingView.J2.prototype._plotAId = function () {
    return this._fillMetaInfo.objAId
};
TradingView.J2.prototype._plotBId = function () {
    return this._fillMetaInfo.objBId
};
TradingView.J2.prototype._color = function () {
    return this._fillStyleProps.color.value()
};
TradingView.J2.prototype._transparency = function () {
    return this._fillStyleProps.transparency.value()
};
TradingView.J2.prototype._visible = function () {
    return this._fillStyleProps.visible.value()
};
TradingView._58 = function (n, t) {
    this.J99 = t;
    this.Q2 = n;
    this._points = new List;
    this._points.append(new MathEx.Point(-1, -1))
};
TradingView._58.prototype.update = function () {
    var n = this.J99.priceScale(), t;
    !n || n.isEmpty() ? this._points.setItem(0, new MathEx.Point(-1, -1)) : (t = this.Q2.value.value(), isNumber(t) ? this._points.setItem(0, new MathEx.Point(-1, n.priceToCoordinate(t))) : this._points.setItem(0, new MathEx.Point(-1, NaN)))
};
TradingView._58.prototype.renderer = function () {
    var n = {};
    return n.points = this._points, n.color = this.Q2.color.value(), n.linewidth = this.Q2.linewidth.value(), n.linestyle = this.Q2.linestyle.value(), n.hitTestResult = HitTestResult.REGULAR, new HorzLineRenderer(n)
};
BandBackgroundRenderer.prototype.draw = function (n) {
    var i, t, r;
    0 !== this._data.points.length && (i = n.canvas.width, n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), t = Math.min(this._data.points[0], this._data.points[1]), r = Math.max(this._data.points[0], this._data.points[1]), n.fillRect(0, t, i, r - t))
};
BandBackgroundRenderer.prototype.hitTest = function () {
    return null
};
TradingView._57 = function (n) {
    this.J99 = n;
    this._points = []
};
TradingView._57.prototype.update = function () {
    if (this._points = [], this.J99.properties().bandsBackground.fillBackground.value()) {
        var t = this.J99.properties().bands[0], i = this.J99.properties().bands[1], n = this.J99.priceScale();
        n && !n.isEmpty() && (this._points.push(n.priceToCoordinate(t.value.value())), this._points.push(n.priceToCoordinate(i.value.value())))
    }
};
TradingView._57.prototype.renderer = function () {
    var n = {};
    return n.points = this._points, n.backcolor = this.J99.properties().bandsBackground.backgroundColor.value(), n.transparency = this.J99.properties().bandsBackground.transparency.value(), new BandBackgroundRenderer(n)
};
TradingView._84 = function (n, t, i) {
    this.J99 = n;
    this._points = [];
    assert(t.type === StudyMetaInfo.FilledArea.TYPE_HLINES, "Wrong filledArea type: " + t.type);
    this._initBandIndexes(t.objAId, t.objBId);
    this._fillStyleProps = i
};
TradingView._84.prototype._initBandIndexes = function (n, t) {
    var i, r;
    for (this._bandBKey = this._bandAKey = null, i = 0; i < this.J99.metaInfo().bands.length; ++i)r = this.J99.metaInfo().bands[i], void 0 == this._bandAKey && r.id === n ? this._bandAKey = i : void 0 == this._bandBKey && r.id === t && (this._bandBKey = i)
};
TradingView._84.prototype.update = function () {
    if (this._points = [], this._fillStyleProps.visible.value()) {
        var t = this.J99.properties().bands[this._bandAKey], i = this.J99.properties().bands[this._bandBKey], n = this.J99.priceScale();
        n && !n.isEmpty() && (this._points.push(n.priceToCoordinate(t.value.value())), this._points.push(n.priceToCoordinate(i.value.value())))
    }
};
TradingView._84.prototype.renderer = function () {
    var n = {};
    return n.points = this._points, n.backcolor = this._fillStyleProps.color.value(), n.transparency = this._fillStyleProps.transparency.value(), new BandBackgroundRenderer(n)
};
J50.prototype.minIndex = void 0;
J50.prototype.maxIndex = void 0;
J50.prototype.merge = function (n) {
    for (var i = this._marksBySpan, o = {}, e = 0; e < n.length; e++) {
        var r = n[e], u = r.index, t = r.span, f = this._marksByIndex[r.index];
        if (f) {
            if (f.index === r.index && f.span === r.span) {
                f.time = r.time;
                continue
            }
            this._removeTickmark(f)
        }
        this._marksByIndex[u] = r;
        this.minIndex <= u || (this.minIndex = u);
        this.maxIndex >= u || (this.maxIndex = u);
        i[t] || (i[t] = []);
        i[t].push(r);
        o[t] = !0
    }
    for (t = i.length; t--;)i[t] && (i[t].length || delete i[t], o[t] && i[t].sort(this._sortByIndexAsc));
    delete this._cache
};
J50.prototype._removeTickmark = function (n) {
    var t = n.index;
    this._marksByIndex[t] === n && (delete this._marksByIndex[t], t <= this.minIndex && this.minIndex++, t >= this.maxIndex && this.maxIndex--, this.maxIndex < this.minIndex && (delete this.minIndex, delete this.maxIndex), t = this._marksBySpan[n.span], n = t.indexOf(n), -1 !== n && t.splice(n, 1))
};
J50.prototype._sortByIndexAsc = function (n, t) {
    return n.index - t.index
};
J50.prototype.removeTail = function (n) {
    var i = {}, t;
    this.maxIndex = 0;
    for (t in this._marksByIndex)this._marksByIndex[t].time < n && (i[t] = this._marksByIndex[t], this.maxIndex = Math.max(this.maxIndex, t));
    this._marksByIndex = i
};
J50.prototype.addTail = function (n) {
    for (var t = 0; t < n.length; t++)n[t].index = this.maxIndex + t + 1;
    this.merge(n)
};
J50.prototype.indexToTime = function (n) {
    return(n = this._marksByIndex[n]) ? new Date(1e3 * n.time) : null
};
J50.prototype.build = function (n, t) {
    var e = Math.ceil(t / n), i, o, a, f, u, s;
    if (this._maxbar === e && this._cache)return this._cache;
    for (this._maxbar = e, i = [], o = this._marksBySpan.length; o--;)if (this._marksBySpan[o]) {
        for (var h = i, i = [], v = h.length, r = 0, y = this._marksBySpan[o], p = y.length, u = Infinity, c = -Infinity, l = 0; l < p; l++) {
            for (a = y[l], f = a.index; r < v;)if (u = h[r], s = u.index, s < f)r++, i.push(u), c = s, u = Infinity; else {
                u = s;
                break
            }
            u - f >= e && f - c >= e && (i.push(a), c = f)
        }
        for (; r < v; r++)i.push(h[r])
    }
    return this._cache = i
};
J50.prototype.state = function () {
    for (var n = [], t = this._marksBySpan.length; t--;)this._marksBySpan[t] && (n = n.concat(this._marksBySpan[t]));
    return{marks: n}
};
J50.prototype.restoreState = function (n) {
    this._marksByIndex = {};
    this._marksBySpan = [];
    delete this.maxIndex;
    delete this.minIndex;
    n && n.marks && n.marks.length && this.merge(n.marks)
};
TimePoint.prototype.date = function () {
    return this.m_date
};
TimePoint.prototype.setDate = function (n) {
    this.m_date = n
};
var MONTH_NAMES = void 0, MINUTE_SPAN = 20, HOUR_SPAN = 30, DAY_SPAN = 40, WEEK_SPAN = 50, MONTH_SPAN = 60, YEAR_SPAN = 70, DEFAULT_BAR_SPACING = 6, MAX_BAR_SPACING = 50, MIN_BAR_SPACING = .5, DEFAULT_RIGHT_OFFSET = 5;
J49.prototype.reset = function () {
    this._visibleBarsCache = null;
    this.m_points = new TimeIndexes;
    this.m_stateSnapshot = this.m_scaleStartPoint = this.m_scrollStartPoint = null;
    this.m_tickmarks = new J50
};
J49.prototype.restoreDefault = function () {
    this._visibleBarsCache = null;
    this.m_barSpacing = DEFAULT_BAR_SPACING;
    this.m_rightOffset = this.Q2.rightOffset.value();
    this.saveDefault("barSpacing");
    this._correctOffset();
    this.recalcLockedScale()
};
J49.prototype.rightOffset = function () {
    return this.m_rightOffset
};
J49.prototype.scrollToRealtime = function (n) {
    var i = this.Q2.rightOffset.value(), u, r, t;
    n ? (u = this, n = this.m_rightOffset, r = this.m_width / this.m_barSpacing - 10, 0 < r && i > r && (i = r), t = this.Q0, $({offset: n}).animate({offset: i}, {duration: 1e3, easing: "easeInOutQuint", step: function (n) {
        u._visibleBarsCache = null;
        u.m_rightOffset = n;
        t.recalculateAllPanes();
        t.Q20(new D22(D22.LIGHT_UPDATE));
        t.recalcVisibleRangeStudy(t.Q19())
    }})) : (this._visibleBarsCache = null, this.m_rightOffset = i, this._correctOffset())
};
J49.prototype.points = function () {
    return this.m_points
};
J49.prototype.width = function () {
    return this.m_width
};
J49.prototype.barSpacing = function () {
    return this.m_barSpacing
};
J49.prototype.setWidth = function (n) {
    this._visibleBarsCache = null;
    !isFinite(n) || 0 >= n || (this._locked && this.m_width && (this.m_barSpacing *= n / this.m_width), this.m_width = n, this._correctOffset())
};
J49.prototype.visibleBars = function () {
    if (this._visibleBarsCache)return this._visibleBarsCache;
    if (!this.isEmpty()) {
        var n = Math.ceil(this.m_width / this.m_barSpacing) - 1, t = Math.round(this.m_rightOffset + this.m_points.lastTimePointIndex());
        return this._visibleBarsCache = n = new BarsRange(t - n, t)
    }
};
J49.prototype.isEmpty = function () {
    return 0 === this.m_width || 0 === this.m_points.size()
};
J49.prototype.indexToCoordinate = function (n, t) {
    if (this.isEmpty() || !isInteger(n))return 0;
    var i = this.m_points.lastTimePointIndex() + this.m_rightOffset - n, i = this.m_width - (i + .5) * this.m_barSpacing;
    return t ? i : Math.round(i)
};
J49.prototype.barIndexesToCoordinates = function (n) {
    var t;
    for (n = n.toArray(), t = 0; t < n.length; t++) {
        var i = n[t].time, i = this.m_points.lastTimePointIndex() + this.m_rightOffset - i, i = this.m_width - (i + .5) * this.m_barSpacing;
        n[t].time = Math.round(i);
        n[t].exactTime = i
    }
};
J49.prototype.indexesToCoordinates = function (n) {
    n = n.toArray();
    for (var i = this.m_points.lastTimePointIndex() + this.m_rightOffset, i = this.m_width - i * this.m_barSpacing - .5 * this.m_barSpacing, t = 0; t < n.length; t++)n[t].x = Math.round(i + n[t].x * this.m_barSpacing)
};
J49.prototype.coordinateToIndex = function (n) {
    return n = (this.m_width + 1 - n) / this.m_barSpacing, n = this.m_points.lastTimePointIndex() + this.m_rightOffset - n, n = Math.round(1e6 * n) / 1e6, Math.ceil(n)
};
J49.prototype.timeToCoordinate = function (n) {
    function i(n) {
        return 0 >= n || n >= this.m_width
    }

    var t = this.m_points.closestIndexLeft(n), f = this.m_points.valueAt(t), t = this.indexToCoordinate(t, !0), r, u;
    return i(t) ? null : (r = this.barSpacing(), u = function () {
        var n = this.m_points.lastTimePointIndex();
        return this.m_points.valueAt(n) - this.m_points.valueAt(n - 1)
    }.call(this), n = Math.round(t + (n - f) / u * r) + 1, i(n) ? null : n)
};
J49.prototype.alignCoordinate = function (n) {
    return this.isEmpty() ? n : (n = this.coordinateToIndex(n), this.indexToCoordinate(n))
};
J49.prototype.timePointToIndex = function (n) {
    return this.m_points.indexOf(n, !0)
};
J49.prototype.indexToTimePoint = function (n) {
    return(n = this.m_points.valueAt(n)) ? new Date(1e3 * n) : null
};
J49.prototype.indexToUserTime = function (n) {
    return this.m_tickmarks.indexToTime(n)
};
J49.prototype.marks = function () {
    var n, f;
    if (this.isEmpty())return null;
    for (var i = this.m_barSpacing, r = Math.round(75 / i), t = this.visibleBars(), e = Math.max(t.firstBar(), t.firstBar() - r), r = Math.max(t.lastBar(), t.lastBar() - r), i = this.m_tickmarks.build(i, 75), t = [], u = 0; u < i.length; ++u)n = i[u], e <= n.index && n.index <= r && (f = this.m_tickmarks.indexToTime(n.index), null !== f && t.push({coord: this.indexToCoordinate(n.index), label: this.formatLabel(f, n.span), span: n.span, major: n.label >= DAY_SPAN ? 1 : 0}));
    return t
};
J49.prototype.state = function (n) {
    var t = {};
    return t.m_barSpacing = this.barSpacing(), t.m_rightOffset = this.m_rightOffset, n && (0 < this.m_points.size() && (t.m_lastVisibleBar = this.m_points.valueAt(this.m_points.lastTimePointIndex())), t.points = this.m_points.state(), t.tickmarks = this.m_tickmarks.state(), t.width = this.m_width), t
};
J49.prototype.restoreState = function (n, t, i) {
    this._visibleBarsCache = null;
    void 0 === n.m_barSpacing ? TradingView.logDebug("J49.restoreState: invalid state") : void 0 === n.m_rightOffset ? TradingView.logDebug("J49.restoreState: invalid state") : (this.m_barSpacing = n.m_barSpacing, this.m_rightOffset = n.m_rightOffset, this.m_restoredLastTimePoint = n.m_lastVisibleBar, i && this.m_restoredLastTimePoint && (i = this.m_points.indexOf(this.m_restoredLastTimePoint), lastIndex = this.m_points.lastTimePointIndex(), offset = lastIndex - i, this.m_rightOffset = -offset + n.m_rightOffset), t && (this.m_points.restoreState(n.points), this.m_tickmarks.restoreState(n.tickmarks), n.width && (this._locked = !0, 0 < this.m_width && (this.m_barSpacing *= this.m_width / n.width))), this._correctOffset())
};
J49.prototype.setOffset = function (n) {
    this._visibleBarsCache = null;
    void 0 === n ? TradingView.logDebug("J49.setOffset: invalid state") : (this.m_rightOffset = n, this._correctOffset())
};
J49.prototype.setBarSpacing = function (n) {
    this._visibleBarsCache = null;
    void 0 === n ? TradingView.logDebug("J49.setBarSpacing: invalid state") : this.m_barSpacing = n
};
J49.prototype._correctOffset = function () {
    if (!this.isEmpty()) {
        var n = this.m_width / this.m_barSpacing - 10;
        0 < n && this.m_rightOffset > n && (this.m_rightOffset = n, this._visibleBarsCache = null);
        n = this.m_points.size() - 10;
        this.m_rightOffset < -n && (this.m_rightOffset = -n, this._visibleBarsCache = null)
    }
};
J49.prototype.maxOffset = function () {
    return this.m_width / this.m_barSpacing - 10
};
J49.prototype.startScale = function (n) {
    this.m_scrollStartPoint && this.endScroll();
    null !== this.m_scaleStartPoint || null !== this.m_stateSnapshot || this.isEmpty() || (this.m_scaleStartPoint = n, this.m_stateSnapshot = this.state())
};
J49.prototype.scaleTo = function (n) {
    if (this._visibleBarsCache = null, delete this.m_restoredLastTimePoint, null !== this.m_stateSnapshot) {
        n = MathEx.clamp(this.m_width - n, 0, this.m_width);
        var t = MathEx.clamp(this.m_width - this.m_scaleStartPoint, 0, this.m_width);
        0 !== n && 0 !== t && (this.m_barSpacing = this.m_stateSnapshot.m_barSpacing * n / t, this.m_barSpacing < MIN_BAR_SPACING ? this.m_barSpacing = MIN_BAR_SPACING : this.m_barSpacing > MAX_BAR_SPACING && (this.m_barSpacing = MAX_BAR_SPACING), this._correctOffset(), this.recalcLockedScale())
    }
};
J49.prototype.endScale = function () {
    null !== this.m_scaleStartPoint && (this.m_stateSnapshot = this.m_scaleStartPoint = null, this.saveDefault("barSpacing"))
};
J49.prototype.saveDefault = function (n) {
    TradingView.saveDefaultProperties(!0);
    this.Q2[n].setValue(this["m_" + n]);
    TradingView.saveDefaultProperties(!1)
};
J49.prototype.startScroll = function (n) {
    null !== this.m_scrollStartPoint || null !== this.m_stateSnapshot || this.isEmpty() || (this.m_scrollStartPoint = n, this.m_stateSnapshot = this.state())
};
J49.prototype.scrollTo = function (n) {
    this._visibleBarsCache = null;
    delete this.m_restoredLastTimePoint;
    null !== this.m_scrollStartPoint && (n = (this.m_scrollStartPoint - n) / this.barSpacing(), this.m_rightOffset = this.m_stateSnapshot.m_rightOffset + n, this._correctOffset(), this.Q0.mainSeries().priceScale().properties().percentage.value() && this.recalcLockedScale())
};
J49.prototype.scrollToOffsetAnimated = function (n, t) {
    if (!isFinite(n))throw new RangeError("offset is required and must be finite number");
    if (void 0 === t && (t = 400), !isFinite(t) || 0 >= t)throw new RangeError("animationDuration (optional) must be finite positive number");
    var i = this, u = this.m_rightOffset, f = +new Date, r = this.Q0;
    (function e() {
        i._visibleBarsCache = null;
        var o = (new Date - f) / t;
        1 <= o ? (i.m_rightOffset = n, i._visibleBarsCache = null, r.recalculateAllPanes(), r.Q20(new D22(D22.LIGHT_UPDATE))) : (i.m_rightOffset = u + (n - u) * o, r.recalculateAllPanes(), setTimeout(e, 20))
    })()
};
J49.prototype.endScroll = function () {
    null !== this.m_scrollStartPoint && (this.m_stateSnapshot = this.m_scrollStartPoint = null)
};
J49.prototype._currentSavedPosition = function () {
    if (!this.isEmpty()) {
        var n = this.m_points.indexOf(this.m_restoredLastTimePoint, !0);
        isInteger(n) && (n = this.m_points.lastTimePointIndex() - n, this.m_rightOffset -= n);
        delete this.m_restoredLastTimePoint
    }
};
J49.prototype.update = function (n, t, i, r) {
    this._visibleBarsCache = null;
    this.m_tickmarks.merge(r);
    this.m_points.merge(n, t, i);
    this.m_restoredLastTimePoint && this._currentSavedPosition()
};
J49.prototype.addTail = function (n, t, i) {
    this.m_tickmarks.removeTail(t);
    n = n.params;
    t = this.m_tickmarks.maxIndex + (i ? 0 : 1);
    for (var r = 0; r < n.marks.length; r++)n.marks[r].index = t + r;
    this.m_tickmarks.addTail(n.marks);
    this.m_points.addTail(n.changes, i);
    this.m_rightOffset -= n.changes.length
};
J49.prototype.formatLabel = function (n, t) {
    if (!(n && n instanceof Date))return"incorrect time";
    var i = this.Q0.mainSeries().isDWM();
    return t < MINUTE_SPAN && !i ? numberToStringWithLeadingZero(n.getUTCHours(), 2) + ":" + numberToStringWithLeadingZero(n.getUTCMinutes(), 2) + ":" + numberToStringWithLeadingZero(n.getUTCSeconds(), 2) : t < DAY_SPAN && !i ? numberToStringWithLeadingZero(n.getUTCHours(), 2) + ":" + numberToStringWithLeadingZero(n.getUTCMinutes(), 2) : t < WEEK_SPAN || t < MONTH_SPAN ? getPersianDate(n.getUTCFullYear(), n.getUTCMonth() + 1, n.getDate() - 1)[2] : t < YEAR_SPAN ? (MONTH_NAMES || (MONTH_NAMES = _createMonthNames()), MONTH_NAMES[n.getUTCMonth()]) : getPersianDate(n.getUTCFullYear(), n.getUTCMonth(), n.getDate() - 1)[0]
};
J49.prototype.normalizeBarIndex = function (n) {
    var t = 0, i = 0;
    return n < this.m_points.firstTimePointIndex() ? (t = this.m_points.valueAt(this.m_points.firstTimePointIndex()), i = n - this.m_points.firstTimePointIndex()) : n > this.m_points.lastTimePointIndex() ? (t = this.m_points.valueAt(this.m_points.lastTimePointIndex()), i = n - this.m_points.lastTimePointIndex()) : (t = this.m_points.valueAt(n), i = 0), {time_t: t, offset: i}
};
J49.prototype.denormalizeTimePoint = function (n) {
    var t = this.m_points.indexOf(n.time_t);
    if (void 0 !== t)return t + n.offset
};
J49.prototype.zoomToBarsRange = function (n, t) {
    if (!(t <= n)) {
        var i = this.m_points.lastTimePointIndex();
        i && (this.m_rightOffset = t - i);
        this.m_barSpacing = this.width() / (t - n + 1);
        this._visibleBarsCache = null
    }
};
J49.prototype.recalcLockedScale = function () {
    var r, t;
    if (this.Q0.m_mainSeries.properties().lockScale.value() && !this.isEmpty()) {
        var n = this.Q0.m_mainSeries.priceScale(), i = this.Q0.m_mainSeries, t = i.data().boxSize;
        t || (i.fixBoxSize(), t = i.data().boxSize);
        t && (n.properties().percentage.value() && (r = i.data().search(i.getRealVisibleRange().m_firstBar).value[CLOSE_PLOT], t = PriceRange.prototype.convertToPercent.call(null, r + t, r) - PriceRange.prototype.convertToPercent.call(null, r, r)), t = n.internalHeight() / (this.barSpacing() / t), n = i.priceScale().priceRange(), n && t == n.length() || (!n || n.isEmpty() ? (n = this.visibleBars(), n = i.priceRange(n.firstBar(), n.lastBar())) : (t = (t - n.length()) / 2, n.m_minValue -= t, n.m_maxValue += t), i.priceScale().setPriceRange(n)))
    }
};
J49.prototype.correctBarSpacing = function () {
    !this.isEmpty() && this.points().size() < this.width() / this.barSpacing() && (this.setOffset(DEFAULT_RIGHT_OFFSET), this.setBarSpacing(Math.min(this.width() / (this.points().size() + this.rightOffset()), MAX_BAR_SPACING)))
};
J49.prototype.canZoomIn = function () {
    return this.m_barSpacing < MAX_BAR_SPACING
};
J49.prototype.canZoomOut = function () {
    return this.m_barSpacing > MIN_BAR_SPACING
};
SelectionRenderer.RADIUS = 3.5;
SelectionRenderer.prototype.tolerance = 2;
SelectionRenderer.prototype.draw = function (n) {
    var u, i, r, t;
    if (this._data)for (n.strokeStyle = "#6B6B6B", n.fillStyle = "#D6D6D6", u = this._data.vertOffset || 0, i = 0; i < this._data.points.size(); i++)r = this._data.points.item(i), t = r, void 0 === t.x || isNaN(t.x) || null === t.x || void 0 === t.y || isNaN(t.y) || null === t.y || this._drawMarker(n, r, u)
};
SelectionRenderer.prototype._drawMarker = function (n, t, i) {
    n.beginPath();
    n.arc(t.x + .5, t.y + .5 + i, SelectionRenderer.RADIUS, 0, 2 * Math.PI, !0);
    n.closePath();
    n.fill();
    n.stroke()
};
SelectionRenderer.prototype.hitTest = function (n) {
    var t, i;
    if (!this._data)return null;
    for (t = 0; t < this._data.points.size(); t++)if (i = this._data.points.item(t), i.substract(n).length() <= SelectionRenderer.RADIUS + this.tolerance)return new HitTestResult(this._data.hittestResult, i.data);
    return null
};
LineAnchor.OUTER_RADIUS = TradingView.isMobile.any() ? 16 : 8;
LineAnchor.prototype.tolerance = 2;
LineAnchor.prototype.draw = function (n) {
    for (var s = this._data.currentPoint, u = this._data.outerStrokeWidth || 1, f = 0; f < this._data.points.size(); f++) {
        var t = this._data.points.item(f), e = t.substract(s).length(), i = isInteger(t.data) && this._data.linePointBeingEdited === t.data, r = this.radius, o = this._data.strokeWidth || 2, e = e <= r + this.tolerance ? 1 : 0, r = r + e, o = o + e;
        i || (t.square ? (n.fillStyle = this._data.backgroundColor, n.fillRect(t.x - r, t.y - r, 2 * r, 2 * r), n.fillStyle = this._data.color, i = r - u, n.fillRect(t.x - i, t.y - i, 2 * i, 2 * i), i = r - u - o, n.fillStyle = this._data.backgroundColor, n.fillRect(t.x - i, t.y - i, 2 * i, 2 * i)) : (n.beginPath(), n.arc(t.x, t.y, r, 0, 2 * Math.PI, !0), n.closePath(), n.fillStyle = this._data.backgroundColor, n.fill(), n.beginPath(), n.arc(t.x, t.y, r - u, 0, 2 * Math.PI, !0), n.closePath(), n.fillStyle = this._data.color, n.fill(), n.beginPath(), n.arc(t.x, t.y, r - u - o, 0, 2 * Math.PI, !0), n.closePath(), n.fillStyle = this._data.backgroundColor, n.fill()))
    }
};
LineAnchor.prototype.hitTest = function (n) {
    for (var i, t = 0; t < this._data.points.size(); t++)if (i = this._data.points.item(t), i.substract(n).length() <= this.radius + this.tolerance)return new HitTestResult(this._data.hittestResult, i.data);
    return null
};
SelectionRendererArrowsUpDown = function (n) {
    SelectionRenderer.call(this, n)
};
inherit(SelectionRendererArrowsUpDown, SelectionRenderer);
SelectionRendererArrowsUpDown.prototype._drawMarker = function (n, t, i) {
    var r = t.isUp ? 1 : -1, u = J54.prototype._calculateVerticalOffset(this._data.barSpacing), f = J54.prototype._calculateMinHeight(this._data.barSpacing);
    i = i + r * u + r * f;
    n.beginPath();
    n.arc(t.x + .5, t.y + .5 + i, SelectionRenderer.RADIUS, 0, 2 * Math.PI, !0);
    n.closePath();
    n.fill();
    n.stroke()
};
CompositeRenderer.prototype.append = function (n) {
    this._renderers.append(n)
};
CompositeRenderer.prototype.draw = function (n) {
    for (var t = 0; t < this._renderers.size(); t++)n.save(), this._renderers.item(t).draw(n), n.restore()
};
CompositeRenderer.prototype.drawBackground = function (n) {
    for (var t = 0; t < this._renderers.size(); t++)this._renderers.item(t).drawBackground && this._renderers.item(t).drawBackground(n)
};
CompositeRenderer.prototype.hitTest = function (n) {
    for (var i, t = this._renderers.size() - 1; 0 <= t; t--)if (i = this._renderers.item(t).hitTest(n), i)return i;
    return!1
};
SelectionIndexes.DENSITY = 10;
SelectionIndexes.prototype.calc = function (n, t) {
    for (var r = new List, i = n; i <= t; i++)0 == i % SelectionIndexes.DENSITY && r.append(i);
    return r
};
inherit(J48, PriceAxisView);
J48.prototype.update = function () {
    this._invalidated = !0
};
J48.prototype.setActive = function (n) {
    this._active = n
};
J48.prototype._updateImpl = function () {
    var n, t, i;
    if (this._visible = !1, this._text = "", this.Q0.timeScale() && !this.Q0.timeScale().isEmpty() && this._linetool.priceScale() && !this._linetool.priceScale().isEmpty() && !(this.Q0.selectedSource() !== this._linetool && !this._linetool.customization.forcePriceAxisLabel || this.Q0.timeScale().visibleBars().isEmpty() || this._linetool.points().size() <= this._pointIndex) && (n = this._linetool.points().item(this._pointIndex), isFinite(n.price))) {
        if (t = this._linetool.priceScale(), t.isPercent()) {
            if (i = this._linetool.ownerSource().firstValue(), !isNumber(i))return;
            n.price = t.priceRange().convertToPercent(n.price, i)
        }
        this._text = t.formatter().format(n.price);
        this._coordinate = t.priceToCoordinate(n.price);
        this._textHeight = t.m_markBuilder.fontHeight();
        this._visible = !0
    }
};
J48.prototype.renderer = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), new PriceAxisViewRenderer({text: this._text, coordinate: this._coordinate, color: this._color, borderColor: this._borderColor, background: this._active ? this._activeBackground : this._background, textHeight: this._textHeight, visible: this._visible})
};
J48.prototype.text = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.text.call(this)
};
inherit(LineToolTimeAxisView, TimeAxisView);
LineToolTimeAxisView.prototype.setActive = function (n) {
    this._active = n
};
LineToolTimeAxisView.prototype.update = function () {
    this._invalidated = !0
};
LineToolTimeAxisView.prototype.updateImpl = function () {
    if (this._visible = !1, !(this.Q0.timeScale().isEmpty() || this._linetool.points().size() <= this._pointindex || this._linetool !== this.Q0.selectedSource())) {
        this._text = "";
        var n = this._linetool.points().item(this._pointindex).index;
        this._coordinate = this.Q0.timeScale().indexToCoordinate(n);
        (n = this.Q0.timeScale().indexToUserTime(n)) && (this._text = new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(n));
        this._visible = !0;
        this._invalidated = !1
    }
};
LineToolTimeAxisView.prototype.renderer = function () {
    return this._invalidated && this.updateImpl(), new TimeAxisViewRenderer({text: this._text, coordinate: this._coordinate, color: this._color, background: this._active ? this._activeBackground : this._background, borderColor: this._borderColor, textHeight: this._textHeight, visible: this._visible})
};
inherit(J47, DataSource);
J47.LINEEND_NORMAL = 0;
J47.LINEEND_ARROW = 1;
J47.LINEEND_CIRCLE = 2;
J47.PointPriceProperty = function (n, t) {
    Property.call(this);
    this._lineSource = n;
    this._pointIndex = t
};
inherit(J47.PointPriceProperty, Property);
J47.prototype.getType = function () {
    return TradingView.className(this.constructor)
};
J47.prototype.getConstructor = function () {
    return this._constructor || null
};
J47.prototype.isActualSymbol = function () {
    return this._isActualSymbol
};
J47.prototype.calcIsActualSymbol = function () {
    var n = this.Q2, t = this.Q0.mainSeries(), i = t.symbolInfo();
    this._isActualSymbol = i && n.symbolInfo ? n.symbolInfo.listed_exchange.value() === i.listed_exchange && n.symbolInfo.short_name.value() === i.name : n.symbol.value() === t.symbol() || n.symbol.value().split(":").slice(-1)[0] === t.symbol().split(":").slice(-1)[0]
};
J47.PointPriceProperty.prototype.value = function () {
    var n = this._lineSource.points().item(this._pointIndex).price;
    return parseFloat(this._lineSource.priceScale().formatter().format(n))
};
J47.PointPriceProperty.prototype.setValue = function (n) {
    var t = this._lineSource.points().item(this._pointIndex);
    t.price = parseFloat(n);
    this._lineSource.setPoint(this._pointIndex, t);
    this._lineSource.Q0.updateSource(this._lineSource);
    this._listeners.fire(this);
    this._lineSource.endChanging()
};
J46 = function (n, t) {
    Property.call(this);
    this._lineSource = n;
    this._pointIndex = t
};
inherit(J46, Property);
J46.prototype.value = function () {
    return this._lineSource.points().item(this._pointIndex).index
};
J46.prototype.setValue = function (n) {
    var t = this._lineSource.points().item(this._pointIndex), i;
    t.index = n;
    n = this._lineSource.priceScale();
    n.isPercent() && (i = this._lineSource.ownerSource().firstValue(), t.price = n.priceRange().convertToPercent(t.price, i));
    this._lineSource.setPoint(this._pointIndex, t);
    this._lineSource.Q0.updateSource(this._lineSource);
    this._listeners.fire(this);
    this._lineSource.endChanging()
};
J47.prototype._createPointsProperties = function () {
    var i, n, t;
    for (this.Q2.addProperty("points"), i = this.Q2.points, n = 0; n < this.pointsCount(); n++)i.addProperty(n), t = i[n], t.addProperty("price"), t.price = new J47.PointPriceProperty(this, n), t.addProperty("bar"), t.bar = new J46(this, n)
};
J47.prototype.priceScale = function () {
    return this._ownerSource ? this._ownerSource.m_priceScale : null
};
J47.prototype.symbol = function () {
    return this.Q2.symbol.value()
};
J47.prototype.properties = function () {
    return this.Q2
};
J47.prototype.isSavedInStudyTemplates = function () {
    return!1
};
J47.prototype.state = function (n) {
    var t = {type: TradingView.className(this.constructor), id: this.id(), state: this.properties().state(), points: this._timePoint.toArray(), zorder: this.zorder()};
    return delete t.state.points, n && (t.indexes = this._points.toArray()), this.ownerSource() && (t.ownerSource = this.ownerSource().id()), this.isFixed() && (t.positionPercents = (this._positionPercents || this.calcPositionPercents()).toArray()), "version"in this && 1 !== this.version && (t.version = this.version), t
};
J47.prototype.template = function () {
    var n = this.properties().state();
    return delete n.points, delete n.symbol, delete n.symbolInfo, n
};
J47.prototype.restoreTemplate = function (n) {
    delete n.symbolInfo;
    this.Q0._undoModel.drawingLoadTemplate(this, n)
};
J47.prototype.clearData = function () {
    this._points = new List
};
J47.prototype.currentPointsetId = function () {
    return"pointset_" + this._currentPointsetId
};
J47.prototype.stop = function () {
    this._currentPointsetId && (this.Q0.chartApi().removePointset(this.currentPointsetId()), this._currentPointsetId = null)
};
J47.prototype.isStarted = function () {
    return!!this._currentPointsetId
};
J47.prototype.restart = function () {
    this.isFixed() || (this._currentPointsetId = 0, this.createServerPoints())
};
J47.prototype.tryCreateServerPoints = function () {
    this.isFixed() || this._currentPointsetId || this.createServerPoints()
};
J47.prototype.normalizePoint = function (n) {
    var t = this.Q0.timeScale().normalizeBarIndex(n.index);
    return t.price = n.price, t
};
J47.prototype.normalizePoints = function () {
    var n, t;
    for (this._timePoint.clear(), n = 0; n < this._points.size(); n++) {
        if (t = this.Q0.timeScale().normalizeBarIndex(this._points.item(n).index), !t.time_t) {
            this._timePoint.clear();
            break
        }
        t.price = this._points.item(n).price;
        this._timePoint.append(t)
    }
};
J47.prototype.denormalizeTimePoints = function () {
    for (var i, n = [], t = 0; t < this._timePoint.size(); t++)if (i = this.Q0.timeScale().denormalizeTimePoint(this._timePoint.item(t)), void 0 === i) {
        n = [];
        break
    } else n.push({index: i, price: this._timePoint.item(t).price});
    0 < n.length && (this._points = new List(n))
};
J47.prototype.restorePoints = function (n, t, i) {
    this._timePoint = new List(n);
    this._points = new List(t);
    i || this.denormalizeTimePoints()
};
J47.prototype.restorePositionPercents = function (n) {
    this._positionPercents = new List(n)
};
J47.prototype.propertiesChanged = function () {
    this.updateAllViews();
    this.Q0.updateSource(this)
};
J47.prototype.points = function () {
    for (var i, n = [], t = 0; t < this._points.size(); t++)i = this._points.item(t), n.push({index: i.index, price: i.price, time: i.time});
    return this._lastPoint && n.push({index: this._lastPoint.index, price: this._lastPoint.price, time: this._lastPoint.time}), n = new List(n), this._currentMovingPoint && this._startMovingPoint && this.correctPoints(n), n
};
J47.prototype.fixedPoints = function () {
    var t = new List, n;
    if (this._positionPercents && !this.priceScale().isEmpty())for (n = 0; n < this._positionPercents.size(); n++) {
        var i = this._positionPercents.item(n), r = this.Q0.timeScale().width() * i.x, i = this.priceScale().height() * i.y;
        t.append(new MathEx.Point(r, i))
    } else for (n = 0; n < this._fixedPoints.size(); n++)t.append(this._fixedPoints.item(n).clone());
    return this._lastPoint && t.append(this._lastPoint.clone()), this._currentMovingPoint && this._startMovingPoint && this.correctFixedPoints(t), t
};
J47.prototype.addPoint = function (n, t) {
    var i, r;
    return t && t.shift && 2 <= this.points().size() && this.Q2.snapTo45Degrees && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2)), i = this.priceScale(), i.isPercent() && (r = this.ownerSource().firstValue(), n.price = i.priceRange().convertFromPercent(n.price, r)), this._points.append(n), (i = this._points.size() == this.pointsCount()) ? (this._lastPoint = null, this.normalizePoints(), this.createServerPoints()) : this._lastPoint = n, i
};
J47.prototype.addFixedPoint = function (n) {
    return this._fixedPoints.append(n), (n = this._fixedPoints.size() == this.pointsCount()) && this.calcPositionPercents(), n
};
J47.prototype.calcPositionPercents = function () {
    var n;
    if (!this.priceScale() || this.priceScale().isEmpty())return new List;
    for (this._positionPercents = new List, n = 0; n < this._fixedPoints.size(); n++) {
        var t = this._fixedPoints.item(0), i = t.x / this.Q0.timeScale().width(), t = t.y / this.priceScale().height();
        this._positionPercents.append({x: i, y: t})
    }
    return this._positionPercents
};
J47.prototype.restoreFixedPoints = function () {
    this._fixedPoints = this.fixedPoints()
};
J47.prototype.onData = function (n) {
    var i;
    if (n.params.customId === this.currentPointsetId() && 0 !== n.params.plots.length) {
        for (i = 0; i < n.params.plots.length; i++) {
            var t = n.params.plots[i], r = this._timePoint.item(t.index), r = {index: t.value[0], time: new Date(1e3 * t.value[1]), price: r.price};
            this._points.size() <= t.index ? this._points.append(r) : this._points.setItem(t.index, r)
        }
        this.checkAlert && this.checkAlert();
        this.updateAllViews();
        this.Q0.updateSource(this)
    }
};
J47.prototype.correctPricesToPercents = function () {
    for (var t, i = this.priceScale(), r = this.ownerSource().firstValue(), n = 0; n < this._points.size(); n++)t = this._points.item(n), t.price = i.priceRange().convertFromPercent(t.price, r)
};
J47.prototype.startChanging = function (n) {
    n < this.m_priceAxisViews.size() && this.m_priceAxisViews.item(n).setActive(!0);
    n < this.m_timeAxisViews.size() && this.m_timeAxisViews.item(n).setActive(!0)
};
J47.prototype.setPoint = function (n, t, i) {
    if (i && i.shift && this.Q2.snapTo45Degrees && (i = 0 === n ? 1 : n - 1, this._snapPoint45Degree(t, this.points().item(i))), i = this.priceScale(), i.isPercent()) {
        var r = this.ownerSource().firstValue();
        t.price = i.priceRange().convertFromPercent(t.price, r)
    }
    this._points.setItem(n, t);
    this.normalizePoints()
};
J47.prototype.startMoving = function (n) {
    var t, i;
    this.isFixed() && this.restoreFixedPoints();
    t = this.priceScale();
    t.isPercent() && (i = this.ownerSource().firstValue(), n.price = t.priceRange().convertFromPercent(n.price, i));
    this._startMovingPoint = n
};
J47.prototype.move = function (n) {
    var t = this.priceScale(), i;
    t.isPercent() && (i = this.ownerSource().firstValue(), n.price = t.priceRange().convertFromPercent(n.price, i));
    this._currentMovingPoint = n;
    this.updateAllViews()
};
J47.prototype.correctPoints = function (n) {
    for (var i, r = this._currentMovingPoint.index - this._startMovingPoint.index, u = this._currentMovingPoint.price - this._startMovingPoint.price, t = 0; t < n.size(); t++)i = n.item(t), i.index += r, i.price += u, n.setItem(t, i)
};
J47.prototype.correctFixedPoints = function (n) {
    for (var i = this._currentMovingPoint.substract(this._startMovingPoint), t = 0; t < n.size(); t++)n.setItem(t, n.item(t).add(i))
};
J47.prototype.endMoving = function () {
    this.Q2.interval.setValue(this.Q0.mainSeries().interval());
    var n = !1;
    this._currentMovingPoint && this._startMovingPoint && (n = this._currentMovingPoint.index != this._startMovingPoint.index, this.isFixed() ? this.correctFixedPoints(this._fixedPoints) : this.correctPoints(this._points), this._currentMovingPoint = this._startMovingPoint = null);
    this.isFixed() ? (this.calcPositionPercents(), this.updateAllViews()) : (this.normalizePoints(), this.updateAllViews(), n && this.createServerPoints())
};
J47.prototype.endChanging = function () {
    this.Q2.interval.setValue(this.Q0.mainSeries().interval());
    this.normalizePoints();
    this.createServerPoints();
    for (var n = 0; n < this.m_priceAxisViews.size(); n++)this.m_priceAxisViews.item(n).setActive(!1);
    for (n = 0; n < this.m_timeAxisViews.size(); n++)this.m_timeAxisViews.item(n).setActive(!1)
};
J47.prototype.paneViews = function (n) {
    if (!this._isActualSymbol || !this.Q2.visible.value() || TradingView.drawingState.hideAllDrawings().value() && this.userEditEnabled())return null;
    n = new List;
    for (var t = this._paneViews.length - 1; 0 <= t; --t)n.append(this._paneViews[t]);
    return n
};
J47.prototype.dataWindowView = function () {
    return null
};
J47.prototype.statusView = function () {
    return null
};
J47.prototype.priceAxisViews = function (n, t) {
    var r, i, u;
    return this._isActualSymbol && n.Q19().contains(this) && t === this.priceScale() ? (i = new List, this.Q0.lineBeingEdited() === this && (r = this.Q0.linePointBeingEdited(), r < this.m_priceAxisViews.size())) ? (i = this.m_priceAxisViews.clone(), u = i.item(r), i.removeAt(r), i.append(u), i) : this.m_priceAxisViews : null
};
J47.prototype.timeAxisViews = function () {
    var t, n, i;
    return this.Q0.lineBeingEdited() === this && (t = this.Q0.linePointBeingEdited(), t < this.m_timeAxisViews.size()) ? (n = this.m_timeAxisViews.clone(), i = n.item(t), n.removeAt(t), n.append(i), n) : this.m_timeAxisViews
};
J47.prototype.updateAllViews = function () {
    var n, t;
    if (!this._isActualSymbol || !this.Q2.visible.value())return null;
    if (n = this.paneViews(), null !== n)for (n = n.toArray(), t = 0; t < n.length; t++)n[t].update();
    for (n = this.m_priceAxisViews.toArray(), t = 0; t < n.length; t++)n[t].update();
    for (n = this.m_timeAxisViews.toArray(), t = 0; t < n.length; t++)n[t].update()
};
J47.prototype.setLastPoint = function (n, t) {
    var i, r;
    t && t.shift && 2 <= this.points().size() && this.Q2.snapTo45Degrees && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2));
    i = this.priceScale();
    i.isPercent() && (r = this.ownerSource().firstValue(), n.price = i.priceRange().convertFromPercent(n.price, r));
    this._lastPoint = n;
    this.updateAllViews()
};
J47.prototype.setLastFixedPoint = function (n) {
    this._lastFixedPoint = n;
    this.updateAllViews()
};
J47.prototype.title = function () {
    return"Line Tool"
};
J47._pointSetId = 1;
J47.prototype.start = function () {
    this.createServerPoints()
};
J47.prototype.createServerPoints = function () {
    var t, r;
    if (!this._recursiveGuard && this._isActualSymbol && this.Q0.chartApi().connected() && (this._currentPointsetId && this.Q0.chartApi().removePointset(this.currentPointsetId()), !this.Q0.timeScale().isEmpty() && (0 === this._timePoint.size() && this.normalizePoints(), 0 !== this._timePoint.size()))) {
        this._currentPointsetId = ++J47._pointSetId;
        for (var u = this.Q0.mainSeries().symbolId(), f = this.properties().interval.value(), i = [], n = 0; n < this._timePoint.size(); n++)t = this._timePoint.item(n), i.push([t.time_t, t.offset]);
        r = this;
        this.Q0.chartApi().createPointset(this.currentPointsetId(), "turnaround", u, f, i, function (n) {
            r.onData(n)
        })
    }
};
J47.prototype.isBeingEdited = function () {
    return this === this.Q0.lineBeingEdited() || this === this.Q0.sourceBeingMoved
};
J47.prototype.isFixed = function () {
    return this.properties().locked && this.properties().locked.value()
};
J47.prototype.isLocked = J47.prototype.isFrozen = function () {
    return this.properties().frozen && this.properties().frozen.value()
};
J47.prototype._tooltipFieldsHash = {};
J47.prototype._tooltipFieldsOrder = "time price index time0 price0 time1 price1 time2 price2 time3 price3 time4 price4 distance term pointsPerBar".split(" ");
J47.prototype._tooltipFieldsOrdered = null;
J47.prototype._formatTooltip = function () {
    return null === this._tooltipFieldsOrdered && (this._tooltipFieldsOrdered = new OrderedHash(this._tooltipFieldsHash, OrderedHash.byOrder(this._tooltipFieldsOrder))), this._tooltipFieldsOrdered.array.filter(function (n) {
        return null !== n.value && "" !== n.value
    }).map(function (n) {
        return"<span>" + n.title + ":<\/span> " + n.value
    }).join("<br />")
};
J47.prototype.pointToScreenPoint = function (n) {
    var u = this.Q0.timeScale(), t = this.priceScale(), i, f, r;
    if (!t || t.isEmpty() || u.isEmpty())return new MathEx.Point(0, 0);
    if (i = null, t.isPercent()) {
        if (!this.ownerSource())return;
        if (i = this.ownerSource().firstValue(), null === i || !isFinite(i))return
    }
    f = u.indexToCoordinate(n.index, !0);
    r = n.price;
    t.isPercent() && (r = t.priceRange().convertToPercent(r, i));
    var e = t.priceToCoordinate(r, !0), i = new MathEx.Point(f, e), f = u.indexToCoordinate(n.index, !1), e = t.priceToCoordinate(r, !1);
    return n = new MathEx.Point(f, e), [i, n]
};
J47.prototype.screenPointToPoint = function (n) {
    var r = this.Q0.timeScale(), i = this.priceScale(), r = r.coordinateToIndex(n.x), t;
    if (n = i.coordinateToPrice(n.y), t = null, i.isPercent()) {
        if (!this.ownerSource())return;
        if (t = this.ownerSource().firstValue(), null === t || !isFinite(t))return
    }
    return i.isPercent() && (n = i.priceRange().convertFromPercent(n, t)), {price: n, index: r}
};
J47.prototype.tags = function () {
    return[this._constructor]
};
J47.prototype._snapPoint45Degree = function (n, t, i) {
    var f = this.Q0.timeScale(), s = f.indexToCoordinate(t.index), r = f.indexToCoordinate(n.index) - s, o = this.m_priceScale, e = t.price, u = n.price, h;
    firstValue = this.ownerSource().firstValue();
    o.isPercent() && (e = o.priceRange().convertToPercent(e, firstValue));
    h = o.priceToCoordinate(e);
    u = o.priceToCoordinate(u) - h;
    switch (Math.round(Math.atan2(r, u) / Math.PI * 4)) {
        case 2:
        case-2:
            if (!i) {
                n.price = e;
                break
            }
        case 0:
        case 4:
        case-4:
            if (!i) {
                n.index = t.index;
                break
            }
        default:
            e = Math.sqrt(r * r + u * u);
            i = 0 > r ? -1 : 1;
            t = 0 > u ? -1 : 1;
            r = Math.max(Math.abs(u), Math.abs(r));
            u = r * Math.sqrt(2) / e;
            r = Math.round(f.coordinateToIndex(s + r / u * i));
            correctedDiff = Math.abs(f.indexToCoordinate(r) - s);
            f = o.coordinateToPrice(h + correctedDiff * t);
            n.index = r;
            n.price = f
    }
};
J47.prototype.createPriceAxisView = function (n) {
    return new J48(this, n)
};
J47.prototype.version = 1;
J47.isLineTool = function (n) {
    return(n = TradingView[n]) ? isInherited(n, J47) : !1
};
D63 = function (n, t, i, r) {
    var u = new _92(this, n);
    t.push(u);
    J47.call(this, n, t, i);
    this.properties().listeners().subscribe(this, D63.prototype.changeStyles);
    this._constructor = r;
    this._inputs = this._graphics = this._metaInfo = this._indexes = this._nonseriesdata = this._studyId = null
};
inherit(D63, J47);
D63.prototype.pointsCount = function () {
    throw Error("Reimplement this in a child class");
};
D63.prototype.title = function () {
    return this._metaInfo.description
};
D63.prototype.studyId = function () {
    return this._metaInfo.id
};
D63.prototype._requestStudy = function () {
    throw Error("Reimplement this in a child class");
};
D63.prototype.changeStyles = function () {
    var t, n;
    if (this._inputs) {
        n = D0.splitInputs(this.properties().inputs.state());
        n = n.obj;
        for (t in n)if (n[t] !== this._inputs[t]) {
            this._inputs = n;
            this._requestStudy();
            break
        }
    } else n = D0.splitInputs(this.properties().inputs.state()), this._inputs = TradingView.clone(n.obj), this._requestStudy()
};
D63.prototype._checkTurnaround = function (n) {
    return n === this._turnaround || n == this.Q0.mainSeries()._turnaround || n === this.Q0.mainSeries()._turnaround + "_" + this._turnaround
};
D63.prototype.stop = function () {
    J47.prototype.stop.call(this);
    this._studyId && this.Q0.chartApi().removeStudy(this._studyId)
};
D63.prototype.onData = function () {
    throw Error("Reimplement this in a child class");
};
D63.prototype._correctedPoint = function (n) {
    var t = parseInt(this.Q0.mainSeries().bars().first(), 10), i = parseInt(this.Q0.mainSeries().bars().last(), 10);
    return n.index = Math.max(n.index, t), n.index = Math.min(n.index, i), n
};
D63.prototype.addPoint = function (n) {
    return J47.prototype.addPoint.call(this, this._correctedPoint(n))
};
D63.prototype.setLastPoint = function (n) {
    return J47.prototype.setLastPoint.call(this, this._correctedPoint(n))
};
D63.prototype.move = function () {
};
D63.prototype.clearData = function () {
    this._indexes = this._nonseriesdata = null;
    this._graphics = new D62(this._metaInfo);
    this.updateAllViews()
};
D63.prototype.state = function (n) {
    var t = J47.prototype.state.call(this, n);
    return n && (t.nonseriesdata = this._nonseriesdata, t.nonseriesindexes = this._indexes, t.graphics = this._graphics.graphics()), this.metaInfo()instanceof StudyMetaInfo ? t.metaInfo = this.metaInfo().state() : (t.metaInfo = $.extend({}, this.metaInfo()), t.metaInfo.id = StudyMetaInfo.parseIdString(t.metaInfo.id + (t.metaInfo.version ? "-" + t.metaInfo.version : "")).fullId), t
};
D63.prototype.restoreData = function (n) {
    this._nonseriesdata = n.nonseriesdata ? n.nonseriesdata : null;
    this._indexes = n.nonseriesindexes ? n.nonseriesindexes : null;
    this._graphics.setGraphics(n.graphics ? n.graphics : D62.emptyGraphics())
};
D63.prototype.setPoint = function (n, t) {
    this._indexes = this._nonseriesdata = null;
    J47.prototype.setPoint.call(this, n, this._correctedPoint(t))
};
D63.prototype.disconnect = function () {
    this._studyId = 0
};
D63.prototype.graphics = function () {
    return this._graphics.graphics()
};
D63.prototype.firstValue = function () {
    return this.Q0.mainSeries().data().firstValue()
};
D63.prototype.formatter = function () {
    return this.Q0.mainSeries().data().formatter()
};
D63.prototype.metaInfo = function () {
    return this._metaInfo
};
inherit(_92, _90);
_92.prototype.renderer = function () {
    var i = new CompositeRenderer, t, r, n;
    return 2 > this._points.size() || this.J99._nonseriesdata || this.J99._graphics && !this.J99._graphics.isEmpty() ? i : (t = this._points.item(0), r = this._points.item(1), Math.min(t.x, r.x), Math.max(t.x, r.x), n = {}, n.points = (new List).append(t), n.color = "#808080", n.linewidth = this.J99._doNotNeedLine ? 0 : 1, n.linestyle = CanvasEx.LINESTYLE_SOLID, i.append(new VertLineRenderer(n)), n = {}, n.points = (new List).append(r), n.color = "#808080", n.linewidth = this.J99._doNotNeedLine ? 0 : 1, n.linestyle = CanvasEx.LINESTYLE_SOLID, i.append(new VertLineRenderer(n)), t = {points: (new List).append(t).append(r), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: "#808080", linewidth: this.J99._doNotNeedLine ? 0 : 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(t)), i)
};
inherit(J31, _90);
J31.prototype.renderer = function () {
    var n = new CompositeRenderer;
    return this.isAnchorsRequired() && (n.append(new SelectionRenderer({points: this._points})), n.append(this.createLineAnchor({points: this._points}))), n
};
D67 = function (n) {
    this._data = n
};
D67.prototype.hitTest = function () {
    return null
};
D67.prototype.draw = function (n) {
    n.font = "9px WYekan";
    n.fillStyle = this._data.backColor;
    var t = n.measureText(this._data.text).width, i = this._data.pos;
    "left" == this._data.align && (i = t + 4 + 2 - 1);
    n.save();
    n.translate(.5, .5);
    n.fillRect(i - 6 - t, this._data.coordinate - this._data.textHeight / 2 - 1, t + 4 + 2, this._data.textHeight + 2);
    n.fillStyle = this._data.color;
    n.textBaseline = "middle";
    n.fillText(this._data.text, i - 2 - t, this._data.coordinate);
    n.restore()
};
TradingView.J38 = function (n, t, i, r) {
    this.Q0 = n;
    this.J99 = t;
    this._plotIndex = i;
    this._getterName = r ? r : "symbol";
    this._cache = {};
    this._invalidated = !0
};
TradingView.J38.prototype.update = function () {
    this._invalidated = !0
};
TradingView.J38.prototype.updateImpl = function () {
    this._visible = !1;
    var n = this.J99.lastValueData(this._plotIndex, !1);
    n && this.J99.priceScale().properties().showSymbolLabels.value() && (this._visible = !0, this._coordinate = n.coordinate, this._color = n.color, this._text = this.J99[this._getterName](), this._textHeight = this.J99.priceScale().m_markBuilder.fontHeight())
};
TradingView.J38.prototype.renderer = function () {
    var i, t, n;
    return(this._invalidated && (this.updateImpl(), this._invalidated = !1), !this._visible) ? new CompositeRenderer : (i = this.Q0.paneForSource(this.J99), t = "right", i.leftPriceScale() == this.J99.priceScale() && (t = "left"), n = this.Q0.properties(), (i = !i.leftPriceScale().mainSource() || !i.rightPriceScale().mainSource()) && n.scalesProperties.showLeftScale.value() && !n.scalesProperties.showRightScale.value() && (t = "left"), !i && ("left" == t && !n.scalesProperties.showLeftScale.value() || "right" == t && !n.scalesProperties.showRightScale.value())) ? new CompositeRenderer : (n = this._coordinate, this.J99.lastPriceLabelFixedCoordinate && (n = this.J99.lastPriceLabelFixedCoordinate() || n), t = {coordinate: n, backColor: this._color, color: new RGBColor(this._color).blackWhiteContrast(), text: this._text, pos: this.Q0.timeScale().width(), textHeight: this._textHeight, align: t}, new D67(t))
};
PoligonRenderer.prototype.draw = function (n) {
    var t, i;
    if (!this._data.points.isEmpty()) {
        for (n.beginPath(), n.lineCap = "butt", n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.lineStyle = this._data.linestyle, t = this._data.points.item(0), n.moveTo(t.x, t.y), t = 0; t < this._data.points.size(); t++)i = this._data.points.item(t), n.lineTo(i.x, i.y);
        this._data.filled && this._data.fillBackground && (n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill());
        this._data.filled && !this._data.skipClosePath && n.closePath();
        0 < this._data.linewidth && n.stroke()
    }
};
PoligonRenderer.prototype.hitTest = function (n) {
    var i, t, r, u;
    if (void 0 !== this._data.mouseTouchable && !this._data.mouseTouchable)return null;
    for (i = TradingView.isMobile.any() ? 24 : 3, t = 1; t < this._data.points.size(); t++)if (r = this._data.points.item(t - 1), u = this._data.points.item(t), MathEx.distanceToSegment(r, u, n).distance <= i)return this._hittest;
    return this._data.filled && this._data.fillBackground && MathEx.isInPolygon(this._data.points, n) ? this._hittest : null
};
TradingView._60 = function (n, t) {
    _90.call(this, n, t)
};
inherit(TradingView._60, _90);
TradingView._60.prototype.renderer = function () {
    var u, n;
    if (this._pattern && 2 == this.J99.points().size()) {
        var i = this.J99.points().item(0).index, r = this.J99.points().item(1).index, r = i < r ? this._points.item(0) : this._points.item(1);
        if (!r)return new CompositeRenderer;
        if (u = Math.abs((this._points.item(0).x - this._points.item(1).x) / (this._pattern.length - 1)), this.J99.properties().mode.value() == TradingView.LineToolBarsPattern.BARS_MODE)for (i = new CompositeRenderer, new List, n = 0; n < this._pattern.length; n++) {
            var f = Math.round(r.x + n * u + .5), e = r.y + Math.round(this._pattern[n].high), o = r.y + Math.round(this._pattern[n].low), t = {};
            t.points = (new List).append(new MathEx.Point(f - 1, e)).append(new MathEx.Point(f + 1, o));
            t.color = this.J99.properties().color.value();
            t.linewidth = 1;
            t.backcolor = this.J99.properties().color.value();
            t.fillBackground = !0;
            t.transparency = 10;
            i.append(new RectangleRenderer(t))
        } else i = new CompositeRenderer, t = {}, t.barSpacing = u, t.items = this._pattern, t.histogramBase = 0, t.lineIndex = 0, t.lineColor = generateColor(this.J99.properties().color.value(), 10), t.lineStyle = CanvasEx.LINESTYLE_SOLID, t.lineWidth = 2, t.hittest = new HitTestResult(HitTestResult.MOVEPOINT), i.append(new J68(t));
        this.isAnchorsRequired() && i.append(this.createLineAnchor({points: this._points}))
    } else {
        if (i = new CompositeRenderer, 2 > this._points.size())return i;
        r = this._points.item(0);
        u = this._points.item(1);
        Math.min(r.x, u.x);
        Math.max(r.x, u.x);
        n = {};
        n.points = (new List).append(r);
        n.color = "#808080";
        n.linewidth = 1;
        n.linestyle = CanvasEx.LINESTYLE_SOLID;
        i.append(new VertLineRenderer(n));
        n = {};
        n.points = (new List).append(u);
        n.color = "#808080";
        n.linewidth = 1;
        n.linestyle = CanvasEx.LINESTYLE_SOLID;
        i.append(new VertLineRenderer(n));
        r = {points: (new List).append(r).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        i.append(new TrendLineRenderer(r))
    }
    return i
};
TradingView._60.prototype.update = function () {
    var e;
    if (_90.prototype.update.call(this), !(!this.J99.priceScale() || this.J99.priceScale().isEmpty() || 2 > this._points.size()))if (this.J99._pattern && 0 < this.J99._pattern.length && 2 == this.J99.points().size()) {
        var o = Math.abs((this._points.item(0).x - this._points.item(1).x) / (this.J99._pattern.length - 1)), r = this.J99.priceScale(), i = this.J99._pattern;
        if (this.J99.properties().mode.value() == TradingView.LineToolBarsPattern.BARS_MODE) {
            if (this._pattern = [], r.isPercent()) {
                for (var u = this.J99.ownerSource().firstValue(), t = [], f = r.priceRange(), n = i.length; n--;)t[n] = [], t[n][HIGH_PLOT] = f.convertToPercent(i[n][HIGH_PLOT], u), t[n][LOW_PLOT] = f.convertToPercent(i[n][LOW_PLOT], u);
                i = t
            }
            for (u = r.priceToCoordinate(i[0][HIGH_PLOT]), n = 0; n < i.length; n++)o = r.priceToCoordinate(i[n][HIGH_PLOT]) - u, t = r.priceToCoordinate(i[n][LOW_PLOT]) - u, this._pattern.push({high: o, low: t})
        } else {
            if (this._pattern = new List, r.isPercent()) {
                for (u = this.J99.ownerSource().firstValue(), t = [], f = r.priceRange(), n = i.length; n--;)t[n] = [], t[n][CLOSE_PLOT] = f.convertToPercent(i[n][CLOSE_PLOT], u);
                i = t
            }
            for (u = r.priceToCoordinate(i[0][CLOSE_PLOT]), n = this.J99.points().item(0).index, t = this.J99.points().item(1).index, t = this._points.item(n > t ? 1 : 0), f = t.x, n = 0; n < i.length; n++)e = t.y + r.priceToCoordinate(i[n][CLOSE_PLOT]) - u, e = new MathEx.Point(f + n * o, e), this._pattern.append(e)
        }
    } else delete this._pattern
};
TradingView.LineToolBarsPattern = function (n, t) {
    this._constructor = "LineToolBarsPattern";
    var i = t ? t : new _52("linetoolbarspattern");
    J47.call(this, n, new TradingView._60(this, n), i);
    i.mirrored.listeners().subscribe(this, TradingView.LineToolBarsPattern.prototype.mirror);
    i.flipped.listeners().subscribe(this, TradingView.LineToolBarsPattern.prototype.flip);
    i.addExclusion("mirrored");
    i.addExclusion("flipped")
};
inherit(TradingView.LineToolBarsPattern, J47);
TradingView.LineToolBarsPattern.BARS_MODE = 0;
TradingView.LineToolBarsPattern.LINE_MODE = 1;
TradingView.LineToolBarsPattern.prototype.additionalActions = function (n) {
    var t = new Action({checked: this.properties().mirrored.value(), checkable: !0, text: $.t("Mirrored"), callbackContext: {target: this}}), i = new Action({checked: this.properties().flipped.value(), checkable: !0, text: $.t("Flipped"), callbackContext: {target: this}});
    return t.callbacks().subscribe(null, function (t) {
        t = t.callbackContext().target;
        n.setProperty(t.properties().mirrored, !t.properties().mirrored.value(), "Bats Pattern Mirroring");
        t.updateAllViews();
        t.Q0.updateSource(t)
    }), i.callbacks().subscribe(null, function (t) {
        t = t.callbackContext().target;
        n.setProperty(t.properties().flipped, !t.properties().flipped.value(), "Bats Pattern Flipping");
        t.updateAllViews();
        t.Q0.updateSource(t)
    }), [t, i]
};
TradingView.LineToolBarsPattern.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolBarsPattern.prototype.state = function (n) {
    return n = J47.prototype.state.call(this, n), n.pattern = this._pattern, n
};
TradingView.LineToolBarsPattern.prototype.restoreData = function (n) {
    n.pattern && (this._pattern = n.pattern)
};
TradingView.LineToolBarsPattern.prototype.title = function () {
    return"Bars Pattern"
};
TradingView.LineToolBarsPattern.prototype.cloneData = function (n) {
    this._pattern = TradingView.clone(n._pattern)
};
TradingView.LineToolBarsPattern.prototype.mirror = function () {
    for (var n = this._pattern, u = n[0][HIGH_PLOT], i = Math.min(n[0][LOW_PLOT], n[0][HIGH_PLOT]), r = Math.max(n[0][LOW_PLOT], n[0][HIGH_PLOT]), t = 1; t < n.length; t++)i = Math.min(i, n[t][LOW_PLOT]), r = Math.max(r, n[t][HIGH_PLOT]);
    if (i < r)for (i = (i + r) / 2, t = 0; t < n.length; t++)n[t][HIGH_PLOT] = i - (n[t][HIGH_PLOT] - i), n[t][LOW_PLOT] = i - (n[t][LOW_PLOT] - i), n[t][OPEN_PLOT] = i - (n[t][OPEN_PLOT] - i), n[t][CLOSE_PLOT] = i - (n[t][CLOSE_PLOT] - i);
    u = n[0][HIGH_PLOT] - u;
    n = n[n.length - 1][LOW_PLOT] - n[0][HIGH_PLOT];
    this._points.item(0).price += u;
    this._points.item(1).price = this._points.item(0).price + n;
    this.updateAllViews()
};
TradingView.LineToolBarsPattern.prototype.flip = function () {
    var n, t;
    for (this._points.item(0).price = this._points.item(1).price, n = 0; n < this._pattern.length / 2; n++)t = this._pattern[n], this._pattern[n] = this._pattern[this._pattern.length - n - 1], this._pattern[this._pattern.length - n - 1] = t;
    n = this._pattern[this._pattern.length - 1][LOW_PLOT] - this._pattern[0][HIGH_PLOT];
    this._points.item(1).price = this._points.item(0).price + n;
    this.updateAllViews()
};
TradingView.LineToolBarsPattern.prototype.addPoint = function (n, t) {
    var r = this.Q0.mainSeries(), i = r.nearestIndex(n.index, SEARCH_NEAREST_RIGHT), f;
    if (n.price = this.properties().mode.value() == TradingView.LineToolBarsPattern.BARS_MODE ? r.bars().valueAt(i)[HIGH_PLOT] : r.bars().valueAt(i)[CLOSE_PLOT], i = this.priceScale().priceRange().length(), n.price += .05 * i, i = r.priceScale(), i.isPercent() && (r = r.firstValue(), n.price = i.priceRange().convertToPercent(n.price, r)), r = J47.prototype.addPoint.call(this, n, t)) {
        var i = Math.min(this.points().item(0).index, this.points().item(1).index), u = Math.max(this.points().item(0).index, this.points().item(1).index), i = this.Q0.mainSeries().nearestIndex(i, SEARCH_NEAREST_RIGHT), u = this.Q0.mainSeries().nearestIndex(u, SEARCH_NEAREST_LEFT);
        for (this.points().item(0).index > this.points().item(1).index && (this._points.item(0).price = this._points.item(1).price), this._pattern = []; i <= u; i++)f = this.Q0.mainSeries().data().valueAt(i), this._pattern.push(TradingView.clone(f))
    }
    return r
};
TradingView.LineToolBarsPattern.prototype.setPoint = function (n, t, i) {
    var r = this._points.item(0).price - this._points.item(1).price;
    1 == n && t.index <= this._points.item(0).index && (t.index = this._points.item(0).index + 1);
    0 == n && t.index >= this._points.item(1).index && (t.index = this._points.item(1).index - 1);
    J47.prototype.setPoint.call(this, n, t, i);
    1 == n ? this._points.item(0).price = this._points.item(1).price + r : this._points.item(1).price = this._points.item(0).price - r
};
inherit(_66, _90);
_66.prototype.renderer = function () {
    var f = new CompositeRenderer, t, n;
    if (2 > this._points.size() || 2 > this.J99.points().size())return f;
    t = this.J99.properties();
    t.fillBackground && t.fillBackground.value() && (n = {}, n.points = this._points, n.color = "white", n.linewidth = 0, n.backcolor = t.backgroundColor.value(), n.fillBackground = !0, n.transparency = t.backgroundTransparency.value(), f.append(new RectangleRenderer(n)));
    var r = this, o = function (n, t) {
        var i = {};
        i.points = (new List).append(n).append(t);
        i.width = r.Q0.timeScale().width();
        i.height = r.J99.priceScale().height();
        i.color = r.J99.properties().linecolor.value();
        i.linewidth = r.J99.properties().linewidth.value();
        i.linestyle = CanvasEx.LINESTYLE_SOLID;
        i.extendleft = !1;
        i.extendright = !1;
        i.leftend = J47.LINEEND_NORMAL;
        i.rightend = J47.LINEEND_NORMAL;
        f.append(new TrendLineRenderer(i))
    }, i = this._points.item(0), u = this._points.item(1), u = new MathEx.Point(i.x, u.y);
    o(i, u);
    i = this._points.item(0);
    u = this._points.item(1);
    i = new MathEx.Point(u.x, i.y);
    o(i, u);
    var i = this._points.item(0), u = this._points.item(1), n = (i.y + u.y) / 2, o = new MathEx.Point(i.x, n), e = new MathEx.Point(u.x, n), n = {};
    n.points = (new List).append(o).append(e);
    n.width = r.Q0.timeScale().width();
    n.height = r.J99.priceScale().height();
    n.color = r.J99.properties().linecolor.value();
    n.linewidth = r.J99.properties().linewidth.value();
    n.linestyle = CanvasEx.LINESTYLE_DASHED;
    n.extendleft = !1;
    n.extendright = !1;
    n.leftend = J47.LINEEND_NORMAL;
    n.rightend = J47.LINEEND_ARROW;
    f.append(new TrendLineRenderer(n));
    var n = this.J99.points().item(0).index, e = this.J99.points().item(1).index, o = e - n, n = this.Q0.timeScale().indexToUserTime(n), s = this.Q0.timeScale().indexToUserTime(e), e = "";
    return n && s && (n = (s.valueOf() - n.valueOf()) / 1e3, e = ", " + (new TimeSpanFormatter).format(n)), n = {}, n.points = (new List).append(i.add(u).scaled(.5)), n.text = $.t("{0} bars").format(o) + e, n.color = t.textcolor.value(), n.font = t.font.value(), n.offsetX = 0, n.offsetY = 0, n.vertAlign = "top", n.horzAlign = "center", n.backgroundRoundRect = 0, n.backgroundHorzInflate = .4 * t.fontsize.value(), n.backgroundVertInflate = .2 * t.fontsize.value(), n.fontsize = t.fontsize.value(), t.fillLabelBackground && t.fillLabelBackground.value() && (n.backgroundColor = t.labelBackgroundColor.value(), n.backgroundTransparency = 1 - t.labelBackgroundTransparency.value() / 100 || 0), t.drawBorder && t.drawBorder.value() && (n.borderColor = t.borderColor.value()), f.append(new TextRenderer(n, this._rendererCache)), this.isAnchorsRequired() && f.append(this.createLineAnchor({points: this._points})), f
};
TradingView.LineToolDateRange = function (n, t) {
    this._constructor = "LineToolDateRange";
    var i = t ? t : new _52("linetooldaterange");
    J47.call(this, n, new _66(this, n), i)
};
inherit(TradingView.LineToolDateRange, J47);
TradingView.LineToolDateRange.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolDateRange.prototype.title = function () {
    return"Date Range"
};
inherit(J6, _90);
J6.prototype.renderer = function () {
    var e = new CompositeRenderer, t, n;
    if (2 > this._points.size() || 2 > this.J99.points().size())return e;
    t = this.J99.properties();
    t.fillBackground && t.fillBackground.value() && (n = {}, n.points = this._points, n.color = "white", n.linewidth = 0, n.backcolor = t.backgroundColor.value(), n.fillBackground = !0, n.transparency = t.backgroundTransparency.value(), e.append(new RectangleRenderer(n)));
    var f = this, n = function (n, t) {
        var i = {};
        i.points = (new List).append(n).append(t);
        i.width = f.Q0.timeScale().width();
        i.height = f.J99.priceScale().height();
        i.color = f.J99.properties().linecolor.value();
        i.linewidth = f.J99.properties().linewidth.value();
        i.linestyle = CanvasEx.LINESTYLE_SOLID;
        i.extendleft = !1;
        i.extendright = !1;
        i.leftend = J47.LINEEND_NORMAL;
        i.rightend = J47.LINEEND_NORMAL;
        e.append(new TrendLineRenderer(i))
    }, u = this._points.item(0), i = this._points.item(1), i = new MathEx.Point(i.x, u.y);
    n(u, i);
    u = this._points.item(0);
    i = this._points.item(1);
    u = new MathEx.Point(u.x, i.y);
    n(u, i);
    var u = this._points.item(0), i = this._points.item(1), n = (u.x + i.x) / 2, r = new MathEx.Point(n, u.y), o = new MathEx.Point(n, i.y), n = {};
    n.points = (new List).append(r).append(o);
    n.width = f.Q0.timeScale().width();
    n.height = f.J99.priceScale().height();
    n.color = f.J99.properties().linecolor.value();
    n.linewidth = f.J99.properties().linewidth.value();
    n.linestyle = CanvasEx.LINESTYLE_DASHED;
    n.extendleft = !1;
    n.extendright = !1;
    n.leftend = J47.LINEEND_NORMAL;
    n.rightend = J47.LINEEND_ARROW;
    e.append(new TrendLineRenderer(n));
    var r = this.J99.points().item(0).price, o = this.J99.points().item(1).price, n = o - r, s = 100 * n / r, s = this.J99.priceScale().formatter().format(n) + " (" + Math.round(100 * s) / 100 + "%)", n = {};
    return o > r ? (r = i.clone(), r.y -= 2 * t.fontsize.value(), r.x = .5 * (u.x + i.x)) : (r = i.clone(), r.x = .5 * (u.x + i.x), r.y += .7 * t.fontsize.value()), n.points = (new List).append(r), n.text = s, n.color = t.textcolor.value(), n.font = t.font.value(), n.offsetX = 0, n.offsetY = 0, n.vertAlign = "middle", n.horzAlign = "center", n.fontsize = t.fontsize.value(), n.backgroundRoundRect = 0, n.backgroundHorzInflate = .4 * t.fontsize.value(), n.backgroundVertInflate = .2 * t.fontsize.value(), t.fillLabelBackground && t.fillLabelBackground.value() && (n.backgroundColor = t.labelBackgroundColor.value(), n.backgroundTransparency = 1 - t.labelBackgroundTransparency.value() / 100 || 0), t.drawBorder && t.drawBorder.value() && (n.borderColor = t.borderColor.value()), e.append(new TextRenderer(n, this._rendererCache)), this.isAnchorsRequired() && e.append(this.createLineAnchor({points: this._points})), e
};
TradingView.LineToolPriceRange = function (n, t) {
    this._constructor = "LineToolPriceRange";
    var i = t ? t : new _52("linetoolpricerange");
    J47.call(this, n, new J6(this, n), i)
};
inherit(TradingView.LineToolPriceRange, J47);
TradingView.LineToolPriceRange.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolPriceRange.prototype.title = function () {
    return"Price Range"
};
ParallelChannelRenderer.prototype.extendPoints = function (n, t, i, r) {
    var u = new MathEx.Point(0, 0);
    return i = new MathEx.Point(i, r), this._data.extendleft && (r = n.substract(t), (r = MathEx.intersectRayWithRect(n, n.add(r), u, i)) && (n = r)), this._data.extendright && (r = t.substract(n), (r = MathEx.intersectRayWithRect(t, t.add(r), u, i)) && (t = r)), this._data.extendleft && !MathEx.pointInRect(n, u, i) && MathEx.pointInRect(t, u, i) && (r = MathEx.intersectRayWithRect(t, n, u, i)) && (n = r), this._data.extendright && !MathEx.pointInRect(t, u, i) && MathEx.pointInRect(n, u, i) && (r = MathEx.intersectRayWithRect(n, t, u, i)) && (t = r), [n, t]
};
ParallelChannelRenderer.prototype.draw = function (n) {
    var i, r;
    if (!(2 > this._data.points.size())) {
        n.lineCap = "butt";
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        n.lineStyle = this._data.linestyle;
        var t = this._data.points.item(0), i = this._data.points.item(1), t = this.extendPoints(t, i, this._data.width, this._data.height);
        if (this._data.skipLines || CanvasEx.drawLine(n, t[0].x, t[0].y, t[1].x, t[1].y), 4 == this._data.points.size() && (i = this._data.points.item(2), r = this._data.points.item(3), i && r)) {
            if (i = this.extendPoints(i, r, this._data.width, this._data.height), this._data.skipLines || this._data.skipTopLine || CanvasEx.drawLine(n, i[0].x, i[0].y, i[1].x, i[1].y), this._data.fillBackground) {
                var r = Math.max(t[1].x, i[1].x), u = Math.max(t[1].y, i[1].y), f = Math.min(i[0].x, t[0].x), e = Math.min(i[0].y, t[0].y);
                if (!(isFinite(r) && isFinite(u) && isFinite(f) && isFinite(e)))return;
                n.fillStyle = generateColor(this._data.backcolor, this._data.transparency);
                n.beginPath();
                n.moveTo(t[0].x, t[0].y);
                n.lineTo(t[1].x, t[1].y);
                this._data.extendright && (r = MathEx.optionalCorner(t[1], i[1], this._data.width, this._data.height)) && n.lineTo(r.x, r.y);
                n.lineTo(i[1].x, i[1].y);
                n.lineTo(i[0].x, i[0].y);
                this._data.extendleft && (r = MathEx.optionalCorner(i[0], t[0], this._data.width, this._data.height)) && n.lineTo(r.x, r.y);
                n.lineTo(t[0].x, t[0].y);
                n.fill()
            }
            this._data.showMidline && !this._data.skipLines && (n.strokeStyle = this._data.midcolor, n.lineWidth = this._data.midlinewidth, n.lineStyle = this._data.midlinestyle, t = this._data.points.item(0).add(this._data.points.item(2)).scaled(.5), i = this._data.points.item(1).add(this._data.points.item(3)).scaled(.5), i = this.extendPoints(t, i, this._data.width, this._data.height), (t = TrendLineRenderer.prototype.lineClipping(i[0], i[1], this._data.width, this._data.height)) && CanvasEx.drawLine(n, Math.round(t[0].x), Math.round(t[0].y), Math.round(t[1].x), Math.round(t[1].y)))
        }
    }
};
ParallelChannelRenderer.prototype.hitTest = function (n) {
    var i, f, t, r, u;
    if (2 > this._data.points.size())return null;
    if (this._data.floatPoints ? (i = this._data.floatPoints.item(0), f = this._data.floatPoints.item(1)) : (i = this._data.points.item(0), f = this._data.points.item(1)), t = this.extendPoints(i, f, this._data.width, this._data.height), t = MathEx.distanceToSegment(t[0], t[1], n), 3 >= t.distance)return new HitTestResult(HitTestResult.MOVEPOINT);
    if (this._data.floatPoints ? (r = this._data.floatPoints.item(2), u = this._data.floatPoints.item(3)) : (r = this._data.points.item(2), u = this._data.points.item(3)), 4 == this._data.points.size() && !this._data.skipTopLine) {
        if (!r || !u)return null;
        if (t = this.extendPoints(r, u, this._data.width, this._data.height), t = MathEx.distanceToSegment(t[0], t[1], n), 3 >= t.distance)return new HitTestResult(HitTestResult.MOVEPOINT);
        if (this._data.showMidline && !this._data.skipLines) {
            var t = this._data.points.item(0).add(this._data.points.item(2)).scaled(.5), e = this._data.points.item(1).add(this._data.points.item(3)).scaled(.5), t = this.extendPoints(t, e, this._data.width, this._data.height), t = MathEx.distanceToSegment(t[0], t[1], n);
            if (3 >= t.distance)return new HitTestResult(HitTestResult.MOVEPOINT)
        }
    }
    return this._data.hittestOnBackground && this._data.fillBackground && 4 == this._data.points.size() && (i = (new List).append(i).append(f).append(u).append(r), MathEx.isInPolygon(i, n)) ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(_98, _90);
_98.prototype.update = function () {
    if (_90.prototype.update.call(this), this.J99.priceScale() && !this.J99.priceScale().isEmpty() && 0 != this.J99.points().size() && (this.J99._priceOffset || this.J99.calculatePriceDiff(), 3 === this._points.size() && this.J99._priceOffset)) {
        var t = this._points.item(0), r = this._points.item(1), n = this.J99._priceOffset + this.J99.points().item(0).price, i = this.J99._priceOffset + this.J99.points().item(1).price;
        this._p3 = t.clone();
        this._p4 = r.clone();
        t = this.J99.priceScale();
        t.isLog() ? (t = .5 * (n + i) - this.J99._priceOffset, n = .5 * (n + i), i = this.J99.priceScale().priceToCoordinate(t), n = this.J99.priceScale().priceToCoordinate(n) - i, this._p3.y += n, this._p4.y += n) : (t.isPercent() && (r = this.J99.ownerSource().firstValue(), n = t.priceRange().convertToPercent(n, r), i = t.priceRange().convertToPercent(i, r)), this._p3.y = this.J99.priceScale().priceToCoordinate(n), this._p4.y = this.J99.priceScale().priceToCoordinate(i))
    }
};
_98.prototype.renderer = function () {
    var n = {}, t, i;
    return(n.points = new List, 1 < this._points.size() && (n.points.append(this._points.item(0)), n.points.append(this._points.item(1))), 2 < this._points.size() && (n.points.append(this._p3), n.points.append(this._p4)), n.color = this.J99.properties().linecolor.value(), n.width = this.Q0.timeScale().width(), n.height = this.J99.priceScale().height(), t = this.J99.properties(), n.linewidth = t.linewidth.value(), n.linestyle = t.linestyle.value(), n.extendleft = t.extendLeft.value(), n.extendright = t.extendRight.value(), n.fillBackground = t.fillBackground.value(), n.backcolor = t.backgroundColor.value(), n.transparency = t.transparency.value(), n.showMidline = t.showMidline.value(), n.midlinewidth = t.midlinewidth.value(), n.midlinestyle = t.midlinestyle.value(), n.midcolor = t.midlinecolor.value(), n.fillBackground = t.fillBackground.value(), n.hittestOnBackground = TradingView.isMobile.any(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new ParallelChannelRenderer(n)), n = new List, n.append(this._points.item(0)), this._points.item(1) && n.append(this._points.item(1)), this._p3 && (n.append(this._p3.add(this._p4).scaled(.5)), n.item(2).data = 2), i = 3 == this._points.size() && !this._p3, this.Q0.lineBeingCreated() != this.J99 || i || n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n})), t) : new ParallelChannelRenderer(n)
};
TradingView.LineToolParallelChannel = function (n, t) {
    this._constructor = "LineToolParallelChannel";
    var i = t ? t : new _52("linetoolparallelchannel");
    J47.call(this, n, new _98(this, n), i)
};
inherit(TradingView.LineToolParallelChannel, J47);
TradingView.LineToolParallelChannel.prototype.addPoint = function (n) {
    if (n = J47.prototype.addPoint.call(this, n)) {
        var t = this.points().item(0);
        this._points.item(2).index = t.index;
        this._points.item(2).price = t.price + this._priceOffset
    }
    return n
};
TradingView.LineToolParallelChannel.prototype.calculatePriceDiff = function () {
    var t, u;
    if (3 === this.points().size()) {
        var n = this.points().item(0), i = this.points().item(1), r = this.points().item(2);
        if (n.index !== i.index && (t = this.priceScale(), null !== t))if (t.isLog()) {
            if (u = this.Q0.timeScale(), !u.isEmpty()) {
                var f = u.indexToCoordinate(n.index), e = u.indexToCoordinate(i.index), n = t.priceToCoordinate(n.price), i = t.priceToCoordinate(i.price), u = u.indexToCoordinate(r.index);
                t.priceToCoordinate(r.price);
                f = n + (i - n) / (e - f) * (u - f);
                r = t.priceToCoordinate(r.price) - f;
                n = .5 * (n + i);
                f = t.coordinateToPrice(n);
                this._priceOffset = t.coordinateToPrice(n + r) - f
            }
        } else t = (i.price - n.price) / (i.index - n.index), this._priceOffset = r.price - (n.price + t * (r.index - n.index))
    }
};
TradingView.LineToolParallelChannel.prototype.setLastPoint = function (n, t) {
    t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(0));
    J47.prototype.setLastPoint.call(this, n);
    this.calculatePriceDiff()
};
TradingView.LineToolParallelChannel.prototype.restorePoints = function (n, t, i) {
    J47.prototype.restorePoints.call(this, n, t, i);
    n && 3 <= n.length && (this._priceOffset = n[2].price - n[0].price)
};
TradingView.LineToolParallelChannel.prototype.setPoint = function (n, t, i) {
    i && i.shift && 2 > n && this._snapPoint45Degree(t, this.points().item(1 - n));
    J47.prototype.setPoint.call(this, n, t, i);
    2 === n && this.calculatePriceDiff();
    n = this.points().item(0);
    this._points.item(2).index = n.index;
    this._points.item(2).price = n.price + this._priceOffset
};
TradingView.LineToolParallelChannel.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolParallelChannel.prototype.title = function () {
    return"Parallel Channel"
};
TradingView.LineToolParallelChannel.prototype.addPoint = function (n, t) {
    return t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(0)), J47.prototype.addPoint.call(this, n, t)
};
TradingView.LineToolParallelChannel.prototype.fixAfterRestorePriceAxis = function () {
    this.priceScale().isLog() || delete this._priceOffset
};
TradingView.LineToolParallelChannel.prototype.cloneData = function (n) {
    this._priceOffset = n._priceOffset
};
TradingView.LineToolParallelChannel.prototype.restoreData = function (n) {
    n.priceOffset && (this._priceOffset = n.priceOffset)
};
TradingView.LineToolParallelChannel.prototype.state = function (n) {
    return n = J47.prototype.state.call(this, n), n.priceOffset = this._priceOffset, n
}, function () {
    var n, t = {priceRange: {width: 15, height: 14, data: [134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255]}, barsRange: {width: 16, height: 15, data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 136, 136, 136, 56, 134, 134, 138, 255, 134, 134, 138, 255, 137, 137, 137, 74, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 137, 137, 137, 74, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}, angle: {width: 14, height: 12, data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 130, 130, 134, 76, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255, 134, 134, 138, 255]}};
    TrendLineStatsRenderer.prototype._preRender = function () {
        var u, e, f, i;
        if (!this._preRendered) {
            n || (u = document.createElement("canvas"), u.width = 0, u.height = 0, n = u.getContext("2d"));
            this._data.points.item(0);
            var r = textX = this._data.points.item(0).x + (this._data.offsetX || 0), o = textY = this._data.points.item(0).y + (this._data.offsetY || 0), c = this._fontSize, u = this._lineSpacing, t = (c + u) * this._lines.length - u;
            if (n.textBaseline = "top", n.font = this.fontStyle(), u = [], this._data.wordWrapWidth)for (e = this._data.wordWrapWidth, f = 0; f < this._lines.length; f++)u.push(this._data.wordWrapWidth); else for (f = e = 0; f < this._lines.length; f++)i = n.measureText(this._lines[f]).width, u.push(i), e = Math.max(e, i);
            if (this._data.backgroundColor || this._data.borderColor || this._data.highlightBorder && this._data.wordWrapWidth) {
                var i = {top: this._data.paddingTop || 0, right: this._data.paddingRight || 0, bottom: this._data.paddingBottom || 0, left: this._data.paddingLeft || 0}, s = 0, h = 0;
                this._data.backgroundHorzInflate && (s = this._data.backgroundHorzInflate / 2, i.left += s, i.right += s, s = -s);
                this._data.backgroundVertInflate && (h = this._data.backgroundVertInflate / 2, i.top += h, i.bottom += h, h = -h);
                c = "number" == typeof this._data.padding ? this._data.padding : ~~(c / 6);
                for (f in i)i[f] || (i[f] = c);
                t = {x: Math.floor(r + s), y: Math.floor(o + h), w: Math.ceil(e + i.left + i.right), h: Math.ceil(t + i.top + i.bottom)};
                textX += i.left + s;
                textY += i.top + h;
                ("bottom" == this._data.vertAlign || "middle" == this._data.vertAlign) && (o = "middle" == this._data.vertAlign ? o - t.h / 2 : o - t.h - (t.y - o), textY += o - t.y, t.y = o);
                ("right" == this._data.horzAlign || "center" == this._data.horzAlign) && (r = "center" == this._data.horzAlign ? r - t.w / 2 : r - t.w - (t.x - r), textX += r - t.x, t.x = r, !0 !== this._data.doNotAlignText && ("right" == this._data.horzAlign ? (n.textAlign = "end", textX += e) : (n.textAlign = "center", textX += e / 2)));
                0 != t.w % 2 && t.w++;
                t.x += .5;
                t.y += .5;
                this._boundingRect = [new MathEx.Point(t.x, t.y), new MathEx.Point(t.x + t.w, t.y + t.h)];
                this._rect = t;
                this._padding = i;
                this._defaultPadding = c
            } else("bottom" == this._data.vertAlign || "middle" == this._data.vertAlign) && (textY -= Math.round(t * ("middle" == this._data.vertAlign ? .5 : 1))), r = textX, ("right" == this._data.horzAlign || "center" == this._data.horzAlign) && (r -= Math.round(e * ("center" == this._data.horzAlign ? .5 : 1))), this._boundingRect = [new MathEx.Point(r, textY), new MathEx.Point(r + e, textY + t)];
            this._textPoint = {x: textX, y: textY};
            this._textSizeCache && (this._textSizeCache.widths = u);
            this._preRendered = !0
        }
    };
    TrendLineStatsRenderer.prototype._drawIcon = function (n, i, r, u) {
        if (t.hasOwnProperty(u)) {
            if (u = t[u], !u.src) {
                u.src = document.createElement("canvas");
                u.src.width = u.width;
                u.src.height = u.height;
                for (var e = u.src.getContext("2d"), o = e.createImageData(u.width, u.height), f = 0; f < u.data.length; f++)o.data[f] = u.data[f];
                e.putImageData(o, 0, 0)
            }
            n.drawImage(u.src, i, r)
        }
    }
}();
TrendLineStatsRenderer.prototype.fontStyle = function () {
    return(this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._fontSize + "px " + this._data.font
};
TrendLineStatsRenderer.prototype.draw = function (n) {
    var r, f, t, i, u;
    if (0 !== this._data.points.size())for (this._preRender(), r = this._fontSize, f = r + this._lineSpacing, n.textBaseline = "top", n.font = this.fontStyle(), (this._data.backgroundColor || this._data.borderColor || this._data.highlightBorder && this._data.wordWrapWidth) && this._rect ? (t = this._rect, "right" != this._data.horzAlign && "center" != this._data.horzAlign || !0 === this._data.doNotAlignText || (n.textAlign = "right" == this._data.horzAlign ? "end" : "center"), this._data.backgroundRoundRect ? (n.roundRect(t.x, t.y, t.w, t.h, this._data.backgroundRoundRect), this._data.backgroundColor && (n.fillStyle = this._data.backgroundColor, n.globalAlpha = this._data.backgroundTransparency, n.fill(), n.globalAlpha = 1), this._data.borderColor) && (i = "number" == typeof this._data.borderWidth ? this._data.borderWidth : ~~Math.max(r / 12, 1), n.strokeStyle = this._data.borderColor, n.lineWidth = i, n.stroke()) : (this._data.backgroundColor && (n.fillStyle = this._data.backgroundColor, n.globalAlpha = this._data.backgroundTransparency, n.fillRect(t.x, t.y, t.w, t.h), n.globalAlpha = 1), this._data.borderColor) ? (i = "number" == typeof this._data.borderWidth ? this._data.borderWidth : ~~Math.max(r / 12, 1), n.strokeStyle = this._data.borderColor, n.lineWidth = i, n.strokeRect(t.x - i / 2, t.y - i / 2, t.w + i, t.h + i)) : this._data.highlightBorder && (n.strokeStyle = this._data.color, n.lineWidth = 1, n.beginPath(), u = [3, 1], n.dashedLineTo(t.x - .5, i = t.y - .5, r = t.x + t.w + .5, i, u), n.dashedLineTo(r, i, r, i = t.y + t.h + .5, u), n.dashedLineTo(r = t.x - .5, i, t.x + t.w + .5, i, u), n.dashedLineTo(r, t.y - .5, r, i, u), n.globalAlpha = .5, n.stroke(), n.globalAlpha = 1), this._data.icons && this._data.icons.forEach(function (i, r) {
        this._drawIcon(n, t.x + this._defaultPadding, t.y + this._padding.top + f * r, i)
    }, this)) : "right" == this._data.horzAlign ? n.textAlign = "end" : "center" == this._data.horzAlign && (n.textAlign = "center"), i = this._textPoint.x, r = this._textPoint.y, n.fillStyle = this._data.color, u = 0; u < this._lines.length; u++)n.fillText(this._lines[u], i, r), r += f
};
TrendLineStatsRenderer.prototype.hitTest = function (n) {
    return 0 === this._data.points.size() ? null : (this._preRender(), this._boundingRect ? MathEx.pointInRect(n, this._boundingRect[0], this._boundingRect[1]) ? this._hittest : null : null)
};
TrendLineRenderer.prototype.drawArrow = function (n, t, i, r) {
    if (!(1 > t.substract(n).length())) {
        var u = t.substract(n).normalized();
        n = u.scaled(5 * r);
        n = t.substract(n);
        u = u.transponed().scaled(3 * r);
        r = n.add(u);
        n = n.substract(u);
        CanvasEx.drawLine(i, Math.round(r.x), Math.round(r.y), t.x, t.y);
        CanvasEx.drawLine(i, Math.round(n.x), Math.round(n.y), t.x, t.y)
    }
};
TrendLineRenderer.prototype.lineClipping = function (n, t, i, r) {
    return(n = CohenSutherland(n.x, n.y, t.x, t.y, 0, 0, i, r)) ? [
        {x: n[0], y: n[1]},
        {x: n[2], y: n[3]}
    ] : !1
};
TrendLineRenderer.prototype.expandPoints = function (n, t, i, r) {
    var u = new MathEx.Point(0, 0);
    return i = new MathEx.Point(i, r), this._data.extendleft && (r = n.substract(t), (r = MathEx.intersectRayWithRect(n, n.add(r), u, i)) && (n = r)), this._data.extendright && (r = t.substract(n), (r = MathEx.intersectRayWithRect(t, t.add(r), u, i)) && (t = r)), [n, t]
};
TrendLineRenderer.prototype.drawCircle = function (n, t, i, r) {
    r = $.extend({fillStyle: "#000000"}, r);
    t.save();
    t.fillStyle = r.fillStyle;
    t.beginPath();
    t.arc(n.x, n.y, i, 0, 2 * Math.PI, !1);
    t.fill();
    r.strokeWidth && (t.lineWidth = r.strokeWidth, t.stroke());
    t.restore()
};
TrendLineRenderer.prototype.draw = function (n) {
    var t, i, r;
    this._data.points && 2 > this._data.points.size() || this._data.floatPoints && 2 > this._data.floatPoints.size() || (n.lineCap = "butt", n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.lineStyle = this._data.linestyle, this._data.floatPoints ? (t = this._data.floatPoints.item(0), i = this._data.floatPoints.item(1)) : (t = this._data.points.item(0), i = this._data.points.item(1)), this._data.overlayLineEndings ? r = [$.extend(!0, {}, t), $.extend(!0, {}, i)] : this.drawEnds(n, [t, i]), t = this.expandPoints(t, i, this._data.width, this._data.height), (t = this.lineClipping(t[0], t[1], this._data.width, this._data.height)) && 0 < this._data.linewidth && CanvasEx.drawLine(n, Math.round(t[0].x), Math.round(t[0].y), Math.round(t[1].x), Math.round(t[1].y)), this._data.overlayLineEndings && this.drawEnds(n, r))
};
TrendLineRenderer.prototype.drawEnds = function (n, t) {
    var i = t[0], r = t[1];
    switch (this._data.leftend) {
        case J47.LINEEND_ARROW:
            this.drawArrow(r, i, n, n.lineWidth);
            break;
        case J47.LINEEND_CIRCLE:
            this.drawCircle(i, n, n.lineWidth, this._data.endstyle)
    }
    switch (this._data.rightend) {
        case J47.LINEEND_ARROW:
            this.drawArrow(i, r, n, n.lineWidth);
            break;
        case J47.LINEEND_CIRCLE:
            this.drawCircle(r, n, n.lineWidth, this._data.endstyle)
    }
};
TrendLineRenderer.prototype.hitTest = function (n) {
    var r, t, i;
    return this._data.points && 2 > this._data.points.size() || this._data.floatPoints && 2 > this._data.floatPoints.size() ? null : (r = TradingView.isMobile.any() ? 24 : 3, this._data.floatPoints ? (t = this._data.floatPoints.item(0), i = this._data.floatPoints.item(1)) : (t = this._data.points.item(0), i = this._data.points.item(1)), t = this.expandPoints(t, i, this._data.width, this._data.height), MathEx.distanceToSegment(t[0], t[1], n).distance <= r ? this._hittest : null)
};
inherit(J43, _90);
J43.prototype.update = function () {
    this._invalidated = !0
};
J43.prototype.updateImpl = function () {
    var t = this.J99.points(), i, r, h, e, l, u, o, f, c;
    if (!(2 > t.size())) {
        var n = t.item(0), t = t.item(1), r = this.Q0.timeScale().visibleBars();
        if (void 0 != r && !r.isEmpty() && (r = r.clone(), this._label = null, i = this.J99.properties(), (!(n.index < r.firstBar() && t.index < r.firstBar()) || i.extendLeft.value() || i.extendRight.value()) && (_90.prototype.update.call(this), !(0 > this._points.item(0).x && 0 > this._points.item(1).x) || i.extendLeft.value() || i.extendRight.value()))) {
            r = [];
            this.J99.properties().showPriceRange.value() && this.J99.priceScale() && (u = t.price - n.price, h = u / n.price, h = this.J99.priceScale().formatter().format(u) + " (" + (new PercentageFormatter).format(100 * h) + ")", (i = this.Q0.mainSeries().base()) && (i = Math.round(u * i), h += ", " + i), r.push("priceRange"));
            var i = this.J99.properties().showBarsRange.value(), f = this.J99.properties().showDateTimeRange.value(), a = this.J99.properties().showDistance.value();
            if ((i || f || a) && (e = "", i && (o = t.index - n.index, e += $.t("{0} bars").format(o)), f && (f = this.Q0.timeScale().indexToUserTime(n.index), c = this.Q0.timeScale().indexToUserTime(t.index), f && c && (f = (c.valueOf() - f.valueOf()) / 1e3, (f = (new TimeSpanFormatter).format(f)) && (e += i ? " (" + f + ")" : f))), a && (e && (e += ", "), "undefined" == typeof u && (u = t.price - n.price), "undefined" == typeof o && (o = t.index - n.index), u = Math.round(1e5 * Math.sqrt(u * u + o * o)) / 1e5, e += $.t("distance: {0}").format(u)), e && r.push("barsRange")), this.J99.properties().showAngle.value()) {
                var n = this.J99.pointToScreenPoint(n), t = this.J99.pointToScreenPoint(t), s, n = n instanceof Array ? n[0] : n instanceof MathEx.Point ? n : null, t = t instanceof Array ? t[0] : t instanceof MathEx.Point ? t : null;
                n instanceof MathEx.Point && t instanceof MathEx.Point && (n = t.substract(n), 0 < n.length() && (n = n.normalized(), s = Math.acos(n.x), 0 < n.y && (s = -s)));
                "number" != typeof s || isNaN(s) || (l = Math.round(180 * s / Math.PI) + "º", r.push("angle"))
            }
            this._label = [h, e, l].filter(function (n) {
                return n
            }).join("\n") || null;
            this._icons = r;
            this._invalidated = !1
        }
    }
};
J43.prototype.renderer = function () {
    var i, n, u, t, r;
    return(this._invalidated && this.updateImpl(), i = new CompositeRenderer, this._invalidated || !this.J99.priceScale()) ? i : (n = {}, n.points = this._points, n.floatPoints = this._floatPoints, n.width = this.Q0.timeScale().width(), n.height = this.J99.priceScale().height(), n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), n.extendleft = this.J99.properties().extendLeft.value(), n.extendright = this.J99.properties().extendRight.value(), n.leftend = this.J99.properties().leftEnd.value(), n.rightend = this.J99.properties().rightEnd.value(), i.append(new TrendLineRenderer(n)), u = this.isAnchorsRequired(), (u || this.J99.properties().alwaysShowStats.value()) && this._label && 2 == this._points.size() && (t = {points: (new List).append(this._points.item(1)), text: this._label, color: this.J99.properties().textcolor.value(), font: TradingView.LineToolTrendLine.LABEL_FONT, fontsize: TradingView.LineToolTrendLine.LABEL_FONTSIZE, lineSpacing: TradingView.LineToolTrendLine.LABEL_LINESPACING, backgroundColor: TradingView.LineToolTrendLine.LABEL_BGCOLOR, borderColor: TradingView.LineToolTrendLine.LABEL_BORDERCOLOR, borderWidth: 1, padding: TradingView.LineToolTrendLine.LABEL_PADDING, paddingLeft: 30, doNotAlignText: !0, icons: this._icons}, r = TradingView.LineToolTrendLine.LABEL_OFFSET, this._points.item(1).y < this._points.item(0).y ? (t.vertAlign = "bottom", t.offsetY = -r) : t.offsetY = r, this._points.item(1).x < this._points.item(0).x ? (t.horzAlign = "right", t.offsetX = -r) : t.offsetX = r, i.append(new TrendLineStatsRenderer(t, this._rendererCache))), u && (n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), i.append(this.createLineAnchor({points: n}))), i)
};
TradingView.LineToolTrendLine = function (n, t) {
    this._constructor = "LineToolTrendLine";
    var i = t ? t : new _52("linetooltrendline");
    J47.call(this, n, new J43(this, n), i)
};
inherit(TradingView.LineToolTrendLine, J47);
TradingView.LineToolTrendLine.LABEL_OFFSET = 8;
TradingView.LineToolTrendLine.LABEL_FONT = "Arial";
TradingView.LineToolTrendLine.LABEL_FONTSIZE = 12;
TradingView.LineToolTrendLine.LABEL_LINESPACING = 10;
TradingView.LineToolTrendLine.LABEL_BGCOLOR = "rgba(255,255,255,.8)";
TradingView.LineToolTrendLine.LABEL_BORDERCOLOR = "#e3e3e3";
TradingView.LineToolTrendLine.LABEL_PADDING = 8;
TradingView.LineToolTrendLine.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolTrendLine.prototype.title = function () {
    return"Trend Line"
}, function () {
    function n(n, t, i, r, u, f) {
        var e = 0;
        return n < i ? e |= 1 : n > u && (e |= 2), t < r ? e |= 4 : t > f && (e |= 8), e
    }

    window.CohenSutherland = function (t, i, r, u, f, e, o, s) {
        for (var h = n(t, i, f, e, o, s), v = n(r, u, f, e, o, s), y = !1, c, l, a, p = 0; ;) {
            if (1e3 < p)throw Error("Cohen - Sutherland algorithm: infinity loop");
            if (p++, h | v)if (h & v)break; else a = h ? h : v, a & 8 ? (c = t + (r - t) * (s - i) / (u - i), l = s) : a & 4 ? (c = t + (r - t) * (e - i) / (u - i), l = e) : a & 2 ? (l = i + (u - i) * (o - t) / (r - t), c = o) : (l = i + (u - i) * (f - t) / (r - t), c = f), a == h ? (t = c, i = l, h = n(t, i, f, e, o, s)) : (r = c, u = l, v = n(r, u, f, e, o, s)); else {
                y = !0;
                break
            }
        }
        return y ? [t, i, r, u] : !1
    }
}();
RectangleRenderer.prototype.draw = function (n) {
    if (!(2 > this._data.points.size())) {
        n.lineCap = "butt";
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        n.lineStyle = this._data.linestyle;
        var t = this._data.points.item(0), i = this._data.points.item(1).substract(t);
        n.beginPath();
        n.rect(t.x, t.y, i.x, i.y);
        0 < this._data.linewidth && n.stroke();
        this._data.fillBackground && (n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill())
    }
};
RectangleRenderer.prototype.hitTest = function (n) {
    if (2 > this._data.points.size() || this._data.nohittest)return null;
    var i = this._data.points.item(0), t = this._data.points.item(1), u = new MathEx.Point(t.x, i.y), f = new MathEx.Point(i.x, u.y), r = MathEx.distanceToSegment(i, u, n);
    return 3 >= r.distance ? new HitTestResult(HitTestResult.MOVEPOINT) : (r = MathEx.distanceToSegment(u, t, n), 3 >= r.distance) ? new HitTestResult(HitTestResult.MOVEPOINT) : (r = MathEx.distanceToSegment(t, f, n), 3 >= r.distance) ? new HitTestResult(HitTestResult.MOVEPOINT) : (r = MathEx.distanceToSegment(f, i, n), 3 >= r.distance || this._data.fillBackground && (u = Math.min(i.x, t.x), f = Math.max(i.x, t.x), r = Math.min(i.y, t.y), t = Math.max(i.y, t.y), i = new MathEx.Point(u, r), t = new MathEx.Point(f, t), MathEx.pointInRect(n, i, t)) ? new HitTestResult(HitTestResult.MOVEPOINT) : null)
};
inherit(J8, _90);
J8.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().color.value(), n.linewidth = this.J99.properties().linewidth.value(), n.backcolor = this.J99.properties().backgroundColor.value(), n.fillBackground = this.J99.properties().fillBackground.value(), n.transparency = this.J99.properties().transparency.value(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new RectangleRenderer(n)), n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n})), t) : new RectangleRenderer(n)
};
TradingView.LineToolRectangle = function (n, t) {
    this._constructor = "LineToolRectangle";
    var i = t ? t : new _52("linetoolrectangle");
    J47.call(this, n, new J8(this, n), i)
};
inherit(TradingView.LineToolRectangle, J47);
TradingView.LineToolRectangle.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolRectangle.prototype.title = function () {
    return"Rectangle"
};
EllipseRenderer.prototype.draw = function (n) {
    var i, t, u;
    if (!(2 > this._data.points.size()))if (i = this._data.points.item(0), t = this._data.points.item(1), 3 > this._data.points.size())n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.beginPath(), n.moveTo(i.x, i.y), n.lineTo(t.x, t.y), n.stroke(); else if (u = this._data.points.item(2), u = MathEx.distanceToLine(i, t, u).distance, 1 > u)n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.beginPath(), n.moveTo(i.x, i.y), n.lineTo(t.x, t.y), n.stroke(); else {
        var r = t.substract(i), i = i.add(t).scaled(.5), t = new MathEx.Point(-r.y, r.x), t = t.normalized();
        i.add(t.scaled(u));
        i.add(t.scaled(-u));
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        var t = r.length(), f = r.y / t, r = Math.acos(r.x / t);
        0 > f && (r = -r);
        var f = this._data.points.item(2), e = MathEx.Matrix.translate(-i.x, -i.y), f = e.mult(f), e = MathEx.Matrix.rotate(-r), f = e.mult(f), e = MathEx.Matrix.scale(1, t / (2 * u)), f = e.mult(f);
        this._data.clockwise = 0 > f.y ? !0 : !1;
        n.save();
        n.beginPath();
        n.translate(i.x, i.y);
        n.rotate(r);
        n.scale(1, 2 * u / t);
        n.arc(0, 0, .5 * t, this._data.angleFrom, this._data.angleTo, this._data.clockwise);
        n.restore();
        n.stroke();
        this._data.fillBackground && (n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill())
    }
};
EllipseRenderer.prototype._additionalPointTest = function () {
    return!0
};
EllipseRenderer.prototype.hitTest = function (n) {
    if (3 > this._data.points.size())return null;
    var i = this._data.points.item(0), t = this._data.points.item(1), f = this._data.points.item(2), f = MathEx.distanceToLine(i, t, f).distance, u = t.substract(i), t = i.add(t).scaled(.5), i = new MathEx.Point(-u.y, u.x), i = i.normalized();
    t.add(i.scaled(f));
    t.add(i.scaled(-f));
    var i = u.length(), r = u.y / i, u = Math.acos(u.x / i);
    if (0 > r && (u = -u), r = MathEx.Matrix.translate(-t.x, -t.y), n = r.mult(n), t = r.mult(this._data.points.item(2)), r = MathEx.Matrix.rotate(-u), n = r.mult(n), t = r.mult(t), r = MathEx.Matrix.scale(1, i / (2 * f)), n = r.mult(n), t = r.mult(t), f = n.length(), !this._additionalPointTest(n, t))return null;
    if (this._data.fillBackground && !this._data.noHitTestOnBackground) {
        if (f <= .5 * i)return new HitTestResult(HitTestResult.MOVEPOINT)
    } else if (3 >= Math.abs(f - .5 * i))return new HitTestResult(HitTestResult.MOVEPOINT);
    return null
};
inherit(_69, _90);
_69.prototype.renderer = function () {
    var u = new CompositeRenderer, n, i, t;
    if (2 > this._points.size())return u;
    if (n = {}, n.points = this._points, n.color = this.J99.properties().color.value(), n.linewidth = this.J99.properties().linewidth.value(), n.backcolor = this.J99.properties().backgroundColor.value(), n.fillBackground = this.J99.properties().fillBackground.value(), n.transparency = this.J99.properties().transparency.value(), u.append(new EllipseRenderer(n)), this.isAnchorsRequired()) {
        if (i = n.points.item(0), t = n.points.item(1), 2 == this._points.size())return this.addAnchors(u), u;
        var n = n.points.item(2), r = MathEx.distanceToLine(i, t, n).distance, n = t.substract(i), f = i.add(t).scaled(.5), e = new MathEx.Point(-n.y, n.x), e = e.normalized(), n = f.add(e.scaled(r)), r = f.add(e.scaled(-r)), i = new MathEx.Point(i.x, i.y);
        i.data = 0;
        t = new MathEx.Point(t.x, t.y);
        t.data = 1;
        n = new MathEx.Point(n.x, n.y);
        n.data = 2;
        r = new MathEx.Point(r.x, r.y);
        r.data = 3;
        f = new List;
        f.append(i).append(t).append(n).append(r);
        u.append(this.createLineAnchor({points: f}))
    }
    return u
};
TradingView.LineToolEllipse = function (n, t) {
    this._constructor = "LineToolEllipse";
    var i = t ? t : new _52("linetoolellipse");
    J47.call(this, n, new _69(this, n), i);
    this.version = TradingView.LineToolEllipse.version
};
inherit(TradingView.LineToolEllipse, J47);
TradingView.LineToolEllipse.prototype.startChanging = function (n, t) {
    if (J47.prototype.startChanging.call(this, n, t), 0 == n || 1 == n) {
        var i = this.pointToScreenPoint(this._points.item(0))[0], r = this.pointToScreenPoint(this._points.item(1))[0], u = this.pointToScreenPoint(this._points.item(2))[0];
        this._dist = MathEx.distanceToLine(i, r, u).distance
    }
};
TradingView.LineToolEllipse.prototype.setPoint = function (n, t) {
    var u = this.pointToScreenPoint(this._points.item(0))[0], i = this.pointToScreenPoint(this._points.item(1))[0], r = this.pointToScreenPoint(this._points.item(2))[0], f = this.priceScale(), e;
    f.isPercent() && (e = this.ownerSource().firstValue(), t.price = f.priceRange().convertFromPercent(t.price, e));
    switch (n) {
        case 0:
            u = this.pointToScreenPoint(t)[0];
            f = i.substract(u);
            u = u.add(i).scaled(.5);
            i = new MathEx.Point(-f.y, f.x);
            i = i.normalized();
            r = u.add(i.scaled(this._dist));
            r = this.screenPointToPoint(r);
            this._points.setItem(0, t);
            this._points.setItem(2, r);
            break;
        case 1:
            r = MathEx.distanceToLine(u, i, r).distance;
            i = this.pointToScreenPoint(t)[0];
            f = i.substract(u);
            u = u.add(i).scaled(.5);
            i = new MathEx.Point(-f.y, f.x);
            i = i.normalized();
            r = u.add(i.scaled(this._dist));
            r = this.screenPointToPoint(r);
            this._points.setItem(1, t);
            this._points.setItem(2, r);
            break;
        case 2:
            t = this.pointToScreenPoint(t)[0];
            r = MathEx.distanceToLine(u, i, t).distance;
            f = i.substract(u);
            u = u.add(i).scaled(.5);
            i = new MathEx.Point(-f.y, f.x);
            i = i.normalized();
            r = u.add(i.scaled(r));
            r = this.screenPointToPoint(r);
            this._points.setItem(2, r);
            break;
        case 3:
            t = this.pointToScreenPoint(t)[0];
            r = MathEx.distanceToLine(u, i, t).distance;
            f = i.substract(u);
            u = u.add(i).scaled(.5);
            i = new MathEx.Point(-f.y, f.x);
            i = i.normalized();
            r = u.add(i.scaled(r));
            r = this.screenPointToPoint(r);
            this._points.setItem(2, r)
    }
    this.normalizePoints()
};
TradingView.LineToolEllipse.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolEllipse.prototype.title = function () {
    return"Ellipse"
};
TradingView.LineToolEllipse.version = 2;
TradingView.LineToolEllipse.prototype.migrateVersion = function (n, t, i) {
    1 == n && 2 == this._points.size() && (t = this._points.item(0).price, i = .5 * (this._points.item(0).price + this._points.item(1).price), this._points.setItem(0, {price: i, index: this._points.item(0).index}), this._points.setItem(1, {price: i, index: this._points.item(1).index}), this._points.append({price: t, index: this._points.item(0).index}));
    1 == n && 2 == this._timePoint.size() && (t = this._timePoint.item(0).price, i = .5 * (this._timePoint.item(0).price + this._timePoint.item(1).price), this._timePoint.item(0).price = i, this._timePoint.item(1).price = i, n = {price: t, offset: this._timePoint.item(0).offset, time_t: this._timePoint.item(0).time_t}, this._timePoint.append(n))
};
HorzLineRenderer.prototype.draw = function (n) {
    if (0 === this._data.points.size())return null;
    if (!1 !== this._data.visible) {
        var t = this._data.points.item(0).y, i = n.canvas.width;
        n.lineCap = "square";
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        n.lineStyle = this._data.linestyle;
        CanvasEx.drawLine(n, 0, t, i, t)
    }
};
HorzLineRenderer.prototype.hitTest = function (n) {
    return!1 === this._data.visible || 0 === this._data.points.size() ? null : 3 >= Math.abs(n.y - this._data.points.item(0).y) ? new HitTestResult(this._data.hitTestResult) : null
};
inherit(_85, _90);
_85.prototype.renderer = function () {
    var i = new CompositeRenderer, n = {}, t;
    if (n.points = this._points, n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), n.hitTestResult = HitTestResult.MOVEPOINT, t = this.J99.properties(), i.append(new HorzLineRenderer(n)), this.J99.properties().showLabel.value() && 1 == this._points.size()) {
        var u = t.vertLabelsAlign.value(), f = t.horzLabelsAlign.value(), r = this._points.item(0), e = 0, o = 0;
        "left" == f ? r.x = 3 : "right" == f ? (r.x = this.Q0.timeScale().width(), o = -5) : r.x = this.Q0.timeScale().width() / 2;
        "middle" == u ? e = -this.J99.properties().fontsize.value() / 6 : "bottom" == u && (e = -4);
        t = {points: (new List).append(r), text: t.text.value(), color: t.textcolor.value(), vertAlign: u, horzAlign: f, font: t.font.value(), offsetX: o, offsetY: e, bold: this.J99.properties().bold.value(), italic: this.J99.properties().italic.value(), fontsize: this.J99.properties().fontsize.value()};
        i.append(new TextRenderer(t, this._rendererCache))
    }
    return this.isAnchorsRequired() && (i.append(new HorzLineRenderer(n)), n = new List, n.append(new MathEx.Point(this.Q0.timeScale().width() / 2, this._points.item(0).y)), i.append(this.createLineAnchor({points: n, hittestResult: HitTestResult.MOVEPOINT}))), i
};
inherit(LineToolHorzLinePriceAxisView, PriceAxisView);
LineToolHorzLinePriceAxisView.prototype.update = function () {
    this._invaildated = !0
};
LineToolHorzLinePriceAxisView.prototype.updateImpl = function () {
    var n, t;
    if (0 !== this.J99.points().size() && this.J99.priceScale() && !this.J99.priceScale().isEmpty()) {
        if (this._background = this.J99.properties().linecolor.value(), n = this.J99.points().item(0).price, this.J99.priceScale().isPercent()) {
            if (t = this.J99.ownerSource().firstValue(), null === t)return;
            n = this.J99.priceScale().priceRange().convertToPercent(n, t)
        }
        this._floatCoordinate = this.J99.priceScale().priceToCoordinate(n, !0);
        this._coordinate = Math.round(this._floatCoordinate);
        this._textHeight = this.J99.priceScale().m_markBuilder.fontHeight();
        this.J99.priceScale().formatter() && (this._text = this.J99.priceScale().formatter().format(n))
    }
};
LineToolHorzLinePriceAxisView.prototype.renderer = function () {
    this._invaildated && this.updateImpl();
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: !0};
    return new PriceAxisViewRenderer(n)
};
LineToolHorzLinePriceAxisView.prototype.coordinate = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.coordinate.call(this)
};
TradingView.LineToolHorzLine = function (n, t) {
    this._constructor = "LineToolHorzLine";
    var i = t ? t : new _52("linetoolhorzline");
    J47.call(this, n, new _85(this, n), i);
    this._priceAxisView = new LineToolHorzLinePriceAxisView(this, n)
};
inherit(TradingView.LineToolHorzLine, J47);
TradingView.LineToolHorzLine.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolHorzLine.prototype.title = function () {
    return"Horizontal Line"
};
TradingView.LineToolHorzLine.prototype.priceAxisViews = function (n, t) {
    return this.isActualSymbol() ? this.Q0.paneForSource(this) === n && t === this.priceScale() && this.properties().showPrice.value() ? (new List).append(this._priceAxisView) : null : null
};
TradingView.LineToolHorzLine.prototype.updateAllViews = function () {
    J47.prototype.updateAllViews.call(this);
    this._priceAxisView.update()
};
HorzRayRenderer.prototype.draw = function (n) {
    if (0 === this._data.points.size())return null;
    var t = n.canvas.width, i = this._data.points.item(0).y, r = Math.max(0, this._data.points.item(0).x), t = Math.max(t, this._data.points.item(0).x);
    n.lineCap = "square";
    n.strokeStyle = this._data.color;
    n.lineWidth = this._data.linewidth;
    n.lineStyle = this._data.linestyle;
    CanvasEx.drawLine(n, r, i, t, i)
};
HorzRayRenderer.prototype.hitTest = function (n) {
    return 0 === this._data.points.size() || n.x < this._data.points.item(0).x ? null : 3 >= Math.abs(n.y - this._data.points.item(0).y) ? new HitTestResult(this._data.hitTestResult) : null
};
inherit(_86, _90);
_86.prototype.renderer = function () {
    var i = new CompositeRenderer, t = {}, n;
    if (t.points = this._points, t.color = this.J99.properties().linecolor.value(), t.linewidth = this.J99.properties().linewidth.value(), t.linestyle = this.J99.properties().linestyle.value(), t.hitTestResult = HitTestResult.MOVEPOINT, n = this.J99.properties(), i.append(new HorzRayRenderer(t)), this.J99.properties().showLabel.value() && 1 == this._points.size()) {
        var t = n.vertLabelsAlign.value(), u = n.horzLabelsAlign.value(), r = this._points.item(0).clone(), f = 0, e = 0;
        "right" == u ? (r.x = this.Q0.timeScale().width(), e = -5) : "center" == u && (r.x = (r.x + this.Q0.timeScale().width()) / 2);
        "middle" == t ? f = -this.J99.properties().fontsize.value() / 6 : "bottom" == t && (f = -4);
        n = {points: (new List).append(r), text: n.text.value(), color: n.textcolor.value(), vertAlign: t, horzAlign: u, font: n.font.value(), offsetX: e, offsetY: f, bold: this.J99.properties().bold.value(), italic: this.J99.properties().italic.value(), fontsize: this.J99.properties().fontsize.value()};
        i.append(new TextRenderer(n, this._rendererCache))
    }
    return this.isAnchorsRequired() && (n = new List, n.append(this._points.item(0)), i.append(this.createLineAnchor({points: n}))), i
};
inherit(LineToolHorzRayPriceAxisView, PriceAxisView);
LineToolHorzRayPriceAxisView.prototype.update = function () {
    0 !== this.J99.points().size() && this.J99.priceScale() && !this.J99.priceScale().isEmpty() && (this._background = this.J99.properties().linecolor.value(), this._coordinate = this.J99.priceScale().priceToCoordinate(this.J99.points().item(0).price), this._textHeight = this.J99.priceScale().m_markBuilder.fontHeight(), this._text = this.J99.priceScale().formatter().format(this.J99.points().item(0).price))
};
LineToolHorzRayPriceAxisView.prototype.renderer = function () {
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: !0};
    return new PriceAxisViewRenderer(n)
};
TradingView.LineToolHorzRay = function (n, t) {
    this._constructor = "LineToolHorzRay";
    var i = t ? t : new _52("linetoolhorzray");
    J47.call(this, n, new _86(this, n), i);
    this._priceAxisView = new LineToolHorzRayPriceAxisView(this, n)
};
inherit(TradingView.LineToolHorzRay, J47);
TradingView.LineToolHorzRay.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolHorzRay.prototype.title = function () {
    return"Horizontal Ray"
};
TradingView.LineToolHorzRay.prototype.priceAxisViews = function (n, t) {
    return this.symbol() !== this.Q0.mainSeries().symbol() ? null : this.Q0.paneForSource(this) === n && t === this.priceScale() && this.properties().showPrice.value() ? (new List).append(this._priceAxisView) : null
};
TradingView.LineToolHorzRay.prototype.updateAllViews = function () {
    J47.prototype.updateAllViews.call(this);
    this._priceAxisView.update()
};
VertLineRenderer.prototype.draw = function (n) {
    var t, i;
    0 === this._data.points.size() || 0 >= this._data.linewidth || (t = this._data.points.item(0).x, n.translate(1, 0), i = n.canvas.width, n.lineCap = "square", n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.lineStyle = this._data.linestyle, CanvasEx.drawLine(n, t, 0, t, i))
};
VertLineRenderer.prototype.hitTest = function (n) {
    if (0 === this._data.points.size())return null;
    var t = this._hittest || new HitTestResult(HitTestResult.MOVEPOINT);
    return 3 >= Math.abs(n.x - this._data.points.item(0).x) ? t : null
};
inherit(J45, _90);
J45.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new VertLineRenderer(n)), n = new List, n.append(new MathEx.Point(this._points.item(0).x, this.J99.priceScale().height() / 2)), t.append(this.createLineAnchor({points: n, hittestResult: HitTestResult.MOVEPOINT})), t) : new VertLineRenderer(n)
};
inherit(LineToolVertLineTimeAxisView, TimeAxisView);
LineToolVertLineTimeAxisView.prototype.update = function () {
    this._invalidated = !0
};
LineToolVertLineTimeAxisView.prototype.updateImpl = function () {
    if (!this.Q0.timeScale().isEmpty() && 0 !== this.J99.points().size()) {
        this._text = "";
        this._background = this.J99.properties().linecolor.value();
        var n = this.J99.points().item(0).index;
        this._coordinate = this.Q0.timeScale().indexToCoordinate(n);
        (n = this.Q0.timeScale().indexToUserTime(n)) && (this._text = new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(n));
        this._invalidated = !1
    }
};
LineToolVertLineTimeAxisView.prototype.renderer = function () {
    this._invalidated && this.updateImpl();
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: 18};
    return new TimeAxisViewRenderer(n)
};
TradingView.LineToolVertLine = function (n, t) {
    this._constructor = "LineToolVertLine";
    var i = t ? t : new _52("linetoolvertline");
    J47.call(this, n, new J45(this, n), i);
    this._timeAxisView = new LineToolVertLineTimeAxisView(this, n)
};
inherit(TradingView.LineToolVertLine, J47);
TradingView.LineToolVertLine.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolVertLine.prototype.title = function () {
    return"Vertical Line"
};
TradingView.LineToolVertLine.prototype.timeAxisViews = function () {
    return this.symbol() !== this.Q0.mainSeries().symbol() ? null : this.properties().showTime.value() ? (new List).append(this._timeAxisView) : null
};
TradingView.LineToolVertLine.prototype.updateAllViews = function () {
    J47.prototype.updateAllViews.call(this);
    this._timeAxisView.update()
};
ChannelRenderer.prototype.extendPoints = function (n, t, i) {
    var u = new MathEx.Point(0, -5e3), r;
    return i = new MathEx.Point(i, 5e3), r = t.substract(n), (r = MathEx.intersectRayWithRect(t, t.add(r), u, i)) && (t = r), !MathEx.pointInRect(n, u, i) && MathEx.pointInRect(t, u, i) && (r = MathEx.intersectRayWithRect(t, n, u, i)) && (n = r), !MathEx.pointInRect(t, u, i) && MathEx.pointInRect(n, u, i) && (r = MathEx.intersectRayWithRect(n, t, u, i)) && (t = r), [n, t]
};
ChannelRenderer.prototype.draw = function (n) {
    var t = n.canvas.width, i = this.extendPoints(this._data.p1, this._data.p2, t), t = this.extendPoints(this._data.p3, this._data.p4, t);
    n.beginPath();
    n.moveTo(i[0].x, i[0].y);
    n.lineTo(i[1].x, i[1].y);
    i[1].x < t[1].x && n.lineTo(t[1].x, i[1].y);
    n.lineTo(t[1].x, t[1].y);
    n.lineTo(t[0].x, t[0].y);
    n.lineTo(i[0].x, i[0].y);
    n.fillStyle = generateColor(this._data.color, this._data.transparency);
    n.fill()
};
ChannelRenderer.prototype.hitTest = function (n) {
    if (!this._data.hittestOnBackground)return null;
    var t = this._data.width, i = this.extendPoints(this._data.p1, this._data.p2, t), t = this.extendPoints(this._data.p3, this._data.p4, t), r = [new MathEx.Point(i[0].x, i[0].y), new MathEx.Point(i[1].x, i[1].y)];
    return i[1].x < t[1].x && r.push(new MathEx.Point(t[1].x, i[1].y)), r.push(new MathEx.Point(t[1].x, t[1].y)), r.push(new MathEx.Point(t[0].x, t[0].y)), r.push(new MathEx.Point(i[0].x, i[0].y)), MathEx.isInPolygon(new List(r), n) ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(J1, _90);
J1.prototype.update = function () {
    _90.prototype.update.call(this);
    0 !== this._points.size() && (this._medianPoint = 3 === this._points.size() ? this._points.item(1).add(this._points.item(2)).scaled(.5) : 2 === this._points.size() ? this._points.item(1) : this._points.item(0), this._medianPoint.data = 3)
};
J1.prototype.renderer = function () {
    var i = new CompositeRenderer, r, t, n;
    if (2 > this._points.size() || !this._medianPoint)return i;
    if (r = {points: (new List).append(this._points.item(0)).append(this._medianPoint), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(r)), 3 > this._points.size())return this.addAnchors(i), i;
    r = {points: (new List).append(this._points.item(1)).append(this._points.item(2)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    i.append(new TrendLineRenderer(r));
    for (var r = this._points.item(2).substract(this._points.item(1)).scaled(.5), e = this._medianPoint.substract(this._points.item(0)), s = 0, a = this.J99.properties().fillBackground.value(), c = this.J99.properties().transparency.value(), f = 0; 8 >= f; f++)if (t = "level" + f, t = this.J99.properties()[t], t.visible.value()) {
        var u = this._medianPoint.addScaled(r, t.coeff.value()), o = u.add(e), h = this._medianPoint.addScaled(r, -t.coeff.value()), l = h.add(e);
        a && (n = {}, n.width = this.Q0.timeScale().width(), n.p1 = u, n.p2 = o, n.p3 = this._medianPoint.addScaled(r, s), n.p4 = n.p3.add(e), n.color = t.color.value(), n.transparency = c, n.hittestOnBackground = TradingView.isMobile.any(), i.append(new ChannelRenderer(n)), n = {}, n.width = this.Q0.timeScale().width(), n.p1 = h, n.p2 = l, n.p3 = this._medianPoint.addScaled(r, -s), n.p4 = n.p3.add(e), n.color = t.color.value(), n.transparency = c, n.hittestOnBackground = TradingView.isMobile.any(), i.append(new ChannelRenderer(n)));
        s = t.coeff.value();
        o = {points: (new List).append(u).append(o), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        u = new HitTestResult(HitTestResult.MOVEPOINT, null, f);
        i.append(new TrendLineRenderer(o, u));
        t = {points: (new List).append(h).append(l), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        u = new HitTestResult(HitTestResult.MOVEPOINT, null, f);
        i.append(new TrendLineRenderer(t, u))
    }
    return this.addAnchors(i), i
};
inherit(J12, J1);
J12.prototype.renderer = function () {
    var i = new CompositeRenderer, n, r, t;
    if (2 > this._points.size())return i;
    if ((n = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(n)), !this._medianPoint || !this._modifiedBase) || (r = {points: (new List).append(this._modifiedBase).append(this._medianPoint), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(r)), 3 > this._points.size()))return this.addAnchors(i), i;
    r = {points: (new List).append(this._points.item(1)).append(this._points.item(2)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    i.append(new TrendLineRenderer(r));
    for (var r = this._points.item(2).substract(this._points.item(1)).scaled(.5), e = this._medianPoint.substract(this._modifiedBase), o = 0, a = this.J99.properties().fillBackground.value(), h = this.J99.properties().transparency.value(), u = 0; 8 >= u; u++)if (t = "level" + u, t = this.J99.properties()[t], t.visible.value()) {
        var f = this._medianPoint.addScaled(r, t.coeff.value()), c = f.add(e), s = this._medianPoint.addScaled(r, -t.coeff.value()), l = s.add(e);
        a && (n = {}, n.p1 = f, n.p2 = c, n.p3 = this._medianPoint.addScaled(r, o), n.p4 = n.p3.add(e), n.color = t.color.value(), n.transparency = h, i.append(new ChannelRenderer(n)), n = {}, n.p1 = s, n.p2 = l, n.p3 = this._medianPoint.addScaled(r, -o), n.p4 = n.p3.add(e), n.color = t.color.value(), n.transparency = h, i.append(new ChannelRenderer(n)));
        o = t.coeff.value();
        f = {points: (new List).append(f).append(c), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        n = new HitTestResult(HitTestResult.MOVEPOINT, null, u);
        i.append(new TrendLineRenderer(f, n));
        t = {points: (new List).append(s).append(l), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        n = new HitTestResult(HitTestResult.MOVEPOINT, null, u);
        i.append(new TrendLineRenderer(t, n))
    }
    return this.addAnchors(i), i
};
J12.prototype.update = function () {
    J1.prototype.update.call(this);
    1 < this._points.size() && (this._modifiedBase = this._points.item(0).add(this._points.item(1)).scaled(.5))
};
inherit(J11, J12);
J11.prototype.update = function () {
    if (J1.prototype.update.call(this), 2 < this._points.size()) {
        var n = this._points.item(0).x, t = .5 * (this._points.item(0).y + this._points.item(1).y);
        this._modifiedBase = new MathEx.Point(n, t)
    }
};
inherit(_88, J1);
_88.prototype.update = function () {
    J1.prototype.update.call(this);
    1 < this._points.size() && (this._modifiedBase = this._points.item(0).add(this._points.item(1)).scaled(.5))
};
_88.prototype.renderer = function () {
    var i = new CompositeRenderer, r, n, t;
    if (2 > this._points.size())return i;
    if (!this._medianPoint || !this._modifiedBase || (3 == this._points.size() && (r = {points: (new List).append(this._modifiedBase).append(this._points.item(2)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(r))), n = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(n)), 3 > this._points.size()))return this.addAnchors(i), i;
    r = {points: (new List).append(this._points.item(1)).append(this._points.item(2)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    i.append(new TrendLineRenderer(r));
    var r = this._points.item(2).substract(this._points.item(1)).scaled(.5), f = this._points.item(2).substract(this._modifiedBase), o = 0, a = this.J99.properties().fillBackground.value(), h = this.J99.properties().transparency.value(), u = {points: (new List).append(this._medianPoint).append(this._medianPoint.add(f)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    for (i.append(new TrendLineRenderer(u)), u = 0; 8 >= u; u++)if (t = "level" + u, t = this.J99.properties()[t], t.visible.value()) {
        var e = this._medianPoint.addScaled(r, t.coeff.value()), c = e.add(f), s = this._medianPoint.addScaled(r, -t.coeff.value()), l = s.add(f);
        a && (n = {}, n.p1 = e, n.p2 = c, n.p3 = this._medianPoint.addScaled(r, o), n.p4 = n.p3.add(f), n.color = t.color.value(), n.transparency = h, i.append(new ChannelRenderer(n)), n = {}, n.p1 = s, n.p2 = l, n.p3 = this._medianPoint.addScaled(r, -o), n.p4 = n.p3.add(f), n.color = t.color.value(), n.transparency = h, i.append(new ChannelRenderer(n)));
        o = t.coeff.value();
        e = {points: (new List).append(e).append(c), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        n = new HitTestResult(HitTestResult.MOVEPOINT, null, u);
        i.append(new TrendLineRenderer(e, n));
        t = {points: (new List).append(s).append(l), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        n = new HitTestResult(HitTestResult.MOVEPOINT, null, u);
        i.append(new TrendLineRenderer(t, n))
    }
    return this.addAnchors(i), i
};
TradingView.LineToolPitchfork = function (n, t) {
    this._constructor = "LineToolPitchfork";
    var i = t ? t : new _52("linetoolpitchfork");
    J47.call(this, n, new J1(this, n), i);
    this.Q2.style.listeners().subscribe(this, TradingView.LineToolPitchfork.prototype._recreatePaneView);
    this._recreatePaneView()
};
inherit(TradingView.LineToolPitchfork, J47);
TradingView.LineToolPitchfork.STYLE_ORIGINAL = 0;
TradingView.LineToolPitchfork.STYLE_SCHIFF = 1;
TradingView.LineToolPitchfork.STYLE_INSIDE = 2;
TradingView.LineToolPitchfork.STYLE_SCHIFF2 = 3;
TradingView.LineToolPitchfork.prototype.additionalActions = function () {
    for (var i, n = [], r = ["Original", "Modified Schiff", "Inside", "Schiff"], t = 0; 4 > t; t++)i = new Action({checked: this.properties().style.value() == t, checkable: !0, text: $.t(r[t]), callbackContext: {target: this, value: t}}), i.callbacks().subscribe(null, function (n) {
        var t = n.callbackContext();
        n = t.target;
        t = t.value;
        n.properties().style.setValue(t);
        n.updateAllViews();
        n.Q0.updateSource(n)
    }), n.push(i);
    return[n[0], n[3], n[1], n[2]]
};
TradingView.LineToolPitchfork.prototype._recreatePaneView = function () {
    this.Q2.style.value() == TradingView.LineToolPitchfork.STYLE_ORIGINAL ? this._paneViews = [new J1(this, this.Q0)] : this.Q2.style.value() == TradingView.LineToolPitchfork.STYLE_SCHIFF ? this._paneViews = [new J12(this, this.Q0)] : this.Q2.style.value() == TradingView.LineToolPitchfork.STYLE_SCHIFF2 ? this._paneViews = [new J11(this, this.Q0)] : this.Q2.style.value() == TradingView.LineToolPitchfork.STYLE_INSIDE && (this._paneViews = [new _88(this, this.Q0)])
};
TradingView.LineToolPitchfork.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolPitchfork.prototype.title = function () {
    return $.t("Pitchfork")
};
TradingView.LineToolPitchfork.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(J0, _90);
J0.prototype.update = function () {
    _90.prototype.update.call(this);
    0 !== this._points.size() && (this._medianPoint = 3 === this._points.size() ? this._points.item(1).add(this._points.item(2)).scaled(.5) : 2 === this._points.size() ? this._points.item(1) : this._points.item(0), this._medianPoint.data = 3)
};
J0.prototype.renderer = function () {
    var i = new CompositeRenderer, r, t, u, o, n;
    if (2 > this._points.size() || !this._medianPoint)return i;
    if (r = {points: (new List).append(this._points.item(0)).append(this._medianPoint), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, i.append(new TrendLineRenderer(r)), 3 > this._points.size())return this.addAnchors(i), i;
    r = {points: (new List).append(this._points.item(1)).append(this._points.item(2)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this.J99.properties().median.color.value(), linewidth: this.J99.properties().median.linewidth.value(), linestyle: this.J99.properties().median.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    i.append(new TrendLineRenderer(r));
    for (var r = 0, e = this._points.item(2).substract(this._points.item(1)).scaled(.5), h = this.J99.properties().fillBackground.value(), s = this.J99.properties().transparency.value(), f = 0; 8 >= f; f++)t = "level" + f, t = this.J99.properties()[t], t.visible.value() && (u = this._medianPoint.addScaled(e, t.coeff.value()), o = this._medianPoint.addScaled(e, -t.coeff.value()), h && (n = {}, n.width = this.Q0.timeScale().width(), n.p1 = this._points.item(0), n.p2 = u, n.p3 = this._points.item(0), n.p4 = this._medianPoint.addScaled(e, r), n.color = t.color.value(), n.transparency = s, n.hittestOnBackground = TradingView.isMobile.any(), i.append(new ChannelRenderer(n)), n = {}, n.width = this.Q0.timeScale().width(), n.p1 = this._points.item(0), n.p2 = o, n.p3 = this._points.item(0), n.p4 = this._medianPoint.addScaled(e, -r), n.color = t.color.value(), n.transparency = s, n.hittestOnBackground = TradingView.isMobile.any(), i.append(new ChannelRenderer(n))), r = t.coeff.value(), n = {points: (new List).append(this._points.item(0)).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u = new HitTestResult(HitTestResult.MOVEPOINT, null, f), i.append(new TrendLineRenderer(n, u)), t = {points: (new List).append(this._points.item(0)).append(o), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.color.value(), linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u = new HitTestResult(HitTestResult.MOVEPOINT, null, f), i.append(new TrendLineRenderer(t, u)));
    return this.addAnchors(i), i
};
TradingView.LineToolPitchfan = function (n, t) {
    this._constructor = "LineToolPitchfan";
    var i = t ? t : new _52("linetoolpitchfan");
    J47.call(this, n, new J0(this, n), i)
};
inherit(TradingView.LineToolPitchfan, J47);
TradingView.LineToolPitchfan.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolPitchfan.prototype.title = function () {
    return"Pitchfan"
};
TradingView.LineToolPitchfan.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
TradingView.LineToolSchiffPitchfork = function (n, t) {
    var i = t ? t : new _52("linetoolschiffpitchfork");
    TradingView.LineToolPitchfork.call(this, n, i);
    this._constructor = "LineToolSchiffPitchfork"
};
inherit(TradingView.LineToolSchiffPitchfork, TradingView.LineToolPitchfork);
TradingView.LineToolSchiffPitchfork.prototype.title = function () {
    return $.t("Modified Schiff Pitchfork")
};
TradingView.LineToolSchiffPitchfork2 = function (n, t) {
    var i = t ? t : new _52("linetoolschiffpitchfork2");
    TradingView.LineToolPitchfork.call(this, n, i);
    this._constructor = "LineToolSchiffPitchfork2"
};
inherit(TradingView.LineToolSchiffPitchfork2, TradingView.LineToolPitchfork);
TradingView.LineToolSchiffPitchfork2.prototype.title = function () {
    return $.t("Schiff Pitchfork")
};
TradingView.LineToolInsidePitchfork = function (n, t) {
    var i = t ? t : new _52("linetoolinsidepitchfork");
    TradingView.LineToolPitchfork.call(this, n, i);
    this._constructor = "LineToolInsidePitchfork"
};
inherit(TradingView.LineToolInsidePitchfork, TradingView.LineToolPitchfork);
TradingView.LineToolInsidePitchfork.prototype.title = function () {
    return $.t("Inside Pitchfork")
}, function () {
    var n;
    TextRenderer.prototype.wordWrap = function (t, i, r) {
        var o, f, u, e;
        if (n || (o = document.createElement("canvas"), o.width = 0, o.height = 0, n = o.getContext("2d")), i = +i, t = (t + "").split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/), t[t.length - 1] || t.pop(), !isFinite(i) || 0 >= i)return t;
        for (n.font = r || this.fontStyle(), r = [], o = 0; o < t.length; o++)if (f = t[o], u = n.measureText(f).width, u <= i)r.push(f); else for (f = f.split(/([-\)\]\},.!?:;])|(\s+)/); f.length;) {
            if (u = ~~(i / u * (f.length + 2) / 3), 0 >= u || n.measureText(f.slice(0, 3 * u - 1).join("")).width <= i)for (; n.measureText(f.slice(0, 3 * (u + 1) - 1).join("")).width <= i;)u++; else for (; 0 < u && n.measureText(f.slice(0, 3 * --u - 1).join("")).width > i;);
            if (0 < u)r.push(f.slice(0, 3 * u - 1).join("")), f.splice(0, 3 * u); else {
                if (u = f[0] + (f[1] || ""), e = 1 === e ? 1 : ~~(i / n.measureText(u) * u.length), n.measureText(u.substr(0, e)).width <= i)for (; n.measureText(u.substr(0, e + 1)).width <= i;)e++; else for (; 1 < e && n.measureText(u.substr(0, --e)).width > i;);
                1 > e && (e = 1);
                r.push(u.substr(0, e));
                f[0] = u.substr(e);
                f[1] = ""
            }
            if (u = n.measureText(f.join("")).width, u <= i) {
                r.push(f.join(""));
                break
            }
        }
        return r
    }
}();
TextRenderer.prototype._x = function () {
    return this._data.points.item(0).x + this._data.offsetX
};
TextRenderer.prototype._y = function () {
    var n = this._fontSize * this._lines.length, t;
    this._data.scaleY && (n *= this._data.scaleY);
    t = this._data.points.item(0).y + this._data.offsetY + n;
    switch (this._data.vertAlign) {
        case"bottom":
            t -= n;
            break;
        case"middle":
            t -= n / 2
    }
    return t
};
TextRenderer.prototype.fontStyle = function () {
    return(this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._fontSize + "px " + this._data.font
};
TextRenderer.prototype.draw = function (n) {
    var h, i, t, u, s, f, r, c;
    if (0 !== this._data.points.size()) {
        var l = this._x(), o = this._y(), e = this._fontSize;
        this._data.scaleY && (e *= this._data.scaleY);
        o -= e * (this._lines.length - 1);
        n.textBaseline = "alphabetic";
        n.font = this.fontStyle();
        switch (this._data.horzAlign) {
            case"left":
                n.textAlign = "start";
                break;
            case"right":
                n.textAlign = "end";
                break;
            case"center":
                n.textAlign = "center"
        }
        if (n.translate(l + .5, o + .5), o = l = 0, e = this._fontSize, this._data.scaleX && this._data.scaleY && (h = Math.min(this._data.scaleX, this._data.scaleY), n.scale(h, h)), h = [], this._data.wordWrapWidth)for (i = this._data.wordWrapWidth, t = 0; t < this._lines.length; t++)h.push(this._data.wordWrapWidth); else for (t = i = 0; t < this._lines.length; t++)u = n.measureText(this._lines[t]).width, h.push(u), i = Math.max(i, u);
        if (this._data.backgroundColor || this._data.borderColor || this._data.highlightBorder && this._data.wordWrapWidth) {
            t = l;
            switch (this._data.horzAlign) {
                case"right":
                    t -= i;
                    break;
                case"center":
                    t -= i / 2
            }
            s = e * this._lines.length;
            f = ~~(e / 6);
            this._data.backgroundHorzInflate && (i += 2 * this._data.backgroundHorzInflate, t -= this._data.backgroundHorzInflate);
            this._data.backgroundVertInflate && (s += 2 * this._data.backgroundVertInflate, o += this._data.backgroundVertInflate);
            t = Math.floor(t - f);
            u = Math.floor(o - e);
            i = Math.ceil(i + 2 * f);
            s = Math.ceil(s + 2 * f);
            0 != i % 2 && i++;
            this._data.backgroundVertInflate && (o += this._data.backgroundVertInflate);
            this._data.backgroundRoundRect ? (n.roundRect(t, u, i, s, this._data.backgroundRoundRect), this._data.backgroundColor && (n.fillStyle = this._data.backgroundColor, n.globalAlpha = this._data.backgroundTransparency, n.fill(), n.globalAlpha = 1), this._data.borderColor) && (r = ~~Math.max(e / 12, 1), n.strokeStyle = this._data.borderColor, n.lineWidth = r, n.stroke()) : (this._data.backgroundColor && (n.fillStyle = this._data.backgroundColor, n.globalAlpha = this._data.backgroundTransparency, n.fillRect(t, u, i, s), n.globalAlpha = 1), this._data.borderColor) ? (r = ~~Math.max(e / 12, 1), n.strokeStyle = this._data.borderColor, n.lineWidth = r, n.strokeRect(t - r / 2, u - r / 2, i + r, s + r)) : this._data.highlightBorder && (n.strokeStyle = this._data.color, n.lineWidth = 1, n.beginPath(), c = [3, 1], n.dashedLineTo(t - .5, r = u - .5, f = t + i + .5, r, c), n.dashedLineTo(f, r, f, r = u + s + .5, c), n.dashedLineTo(f = t - .5, r, t + i + .5, r, c), n.dashedLineTo(f, u - .5, f, r, c), n.globalAlpha = .5, n.stroke(), n.globalAlpha = 1)
        }
        for (n.fillStyle = this._data.color, t = 0; t < this._lines.length; t++)n.fillText(this._lines[t], l, o), o += e;
        this._textSizeCache && (this._textSizeCache.widths = h)
    }
};
TextRenderer.prototype.hitTest = function (n) {
    var i, u, r, f, t;
    if (0 === this._data.points.size() || (t = this._fontSize, this._data.scaleY && (t *= this._data.scaleY), i = this._textSizeCache.widths, !i))return null;
    for (u = 0, r = 0; r < i.length; r++)u = Math.max(u, i[r]);
    return this._data.scaleX && (u *= this._data.scaleX), i = this._data.points.item(0).x + this._data.offsetX, r = this._data.points.item(0).y + this._data.offsetY, "bottom" == this._data.vertAlign && (r -= this._lines.length * this._fontSize), "middle" == this._data.vertAlign && (r -= this._lines.length * this._fontSize / 2), "right" == this._data.horzAlign ? i -= u : "center" == this._data.horzAlign && (i -= u / 2), f = this._data.backgroundColor || this._data.borderColor ? ~~(t / 6) : 0, t = this._data.borderColor ? ~~Math.max(t / 12, 1) : 0, n.x >= i - f - t && n.x <= i + u + f + t && n.y >= r - t && n.y <= r + this._lines.length * this._fontSize + 2 * f + t ? this._hittest : null
};
inherit(J39, _90);
J39.prototype.update = function () {
    this._renderer = null;
    _90.prototype.update.call(this)
};
J39.prototype.renderer = function () {
    var i;
    if (this._renderer)return this._renderer;
    if (i = this.J99.priceScale(), !i || i.isEmpty())return this._renderer = new CompositeRenderer;
    var t = {}, n = this.J99.properties(), r = n.locked && n.locked.value();
    return t.points = r ? this.J99.fixedPoints() : this._points, t.text = n.text.value(), t.color = n.color.value(), t.font = n.font.value(), t.offsetX = this._offsetX ? this._offsetX : 0, t.offsetY = this._offsetY ? this._offsetY : 0, t.vertAlign = this._vertAlign ? this._vertAlign : "top", t.horzAlign = this._horzAlign ? this._horzAlign : "left", t.fontsize = n.fontsize.value(), n.fillBackground && n.fillBackground.value() && (t.backgroundColor = n.backgroundColor.value(), t.backgroundTransparency = 1 - n.backgroundTransparency.value() / 100 || 0), n.drawBorder && n.drawBorder.value() && (t.borderColor = n.borderColor.value()), n.wordWrap && n.wordWrap.value() && (t.wordWrapWidth = n.wordWrapWidth.value()), t.bold = n.bold && n.bold.value(), t.italic = n.italic && n.italic.value(), t.highlightBorder = this.Q0.selectedSource() === this.J99, r || !n.fixedSize || n.fixedSize.value() || (t.scaleX = this.J99.Q0.timeScale().barSpacing() / this.J99._barSpacing, n = i.height() / i.priceRange().length(), this.J99._isPriceDencityLog && !i.isLog() && (n = i.priceRange().minValue(), r = i.priceRange().maxValue(), n = i._toLog(n), r = i._toLog(r), n = r - n, n = i.height() / n), !this.J99._isPriceDencityLog && i.isLog() && (n = i.priceRange().minValue(), r = i.priceRange().maxValue(), n = i._fromLog(n), r = i._fromLog(r), n = r - n, n = i.height() / n), t.scaleY = n / this.J99._priceDencity, (!isFinite(t.scaleY) || 0 >= t.scaleY) && delete t.scaleY), n = new TextRenderer(t, this._rendererCache), this.isAnchorsRequired() && 1 === t.points.size() && !this._noSelection ? (r = t.points.item(0), i = new CompositeRenderer, i.append(n), t.wordWrapWidth && (t = new MathEx.Point(r.x + t.wordWrapWidth + ~~(t.fontsize / 6), r.y + (t.lines ? t.lines.length * t.fontsize / 2 + ~~(t.fontsize / 6) : 0)), t.data = 0, i.append(this.createLineAnchor({points: (new List).append(t)}))), this._renderer = i) : this._renderer = n, this._renderer
};
TradingView.LineToolText = function (n, t) {
    this._constructor = "LineToolText";
    var i = t ? t : new _52("linetooltext");
    J47.call(this, n, new J39(this, n), i);
    this._timeScale = n.timeScale();
    this._barSpacing = n.timeScale().barSpacing()
};
inherit(TradingView.LineToolText, J47);
TradingView.LineToolText.MIN_WIDTH = 100;
TradingView.LineToolText.prototype.setPoint = function (n, t) {
    var i = this.properties(), r;
    0 === n && i.wordWrapWidth && i.wordWrapWidth.value() && (r = i.locked && i.locked.value() ? this.fixedPoints().item(0).x : this._timeScale.indexToCoordinate(this.points().item(0).index), r = this._timeScale.indexToCoordinate(t.index) - r - ~~(i.fontsize.value() / 6), isFinite(r) && i.wordWrapWidth.setValue(Math.max(TradingView.LineToolText.MIN_WIDTH, r)))
};
TradingView.LineToolText.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolText.prototype.title = function () {
    return $.t("Text")
};
TradingView.LineToolText.prototype.setPriceScale = function (n) {
    DataSource.prototype.setPriceScale.call(this, n);
    n && n.priceRange() && (this._priceDencity = n.height() / n.priceRange().length(), this._isPriceDencityLog = n.isLog())
};
TradingView.LineToolText.prototype.restoreSize = function () {
    this._barSpacing = this.Q0.timeScale().barSpacing();
    this._priceDencity = this.priceScale().height() / this.priceScale().priceRange().length();
    this.updateAllViews();
    this.Q0.updateSource(this)
};
TradingView.LineToolText.prototype.restoreTemplate = function (n) {
    delete n.locked;
    delete n.text;
    J47.prototype.restoreTemplate.call(this, n)
};
TradingView.LineToolTextAbsolute = function (n, t) {
    var i = t ? t : new _52("linetooltextabsolute");
    i.locked.value() || i.locked.setValue(!0);
    TradingView.LineToolText.call(this, n, i)
};
inherit(TradingView.LineToolTextAbsolute, TradingView.LineToolText);
TradingView.LineToolTextAbsolute.prototype.title = function () {
    return $.t("Anchored Text")
};
TradingView.LineToolText.prototype.state = function (n) {
    var t = J47.prototype.state.call(this, n);
    return n && (t.state.fixedSize = !1), t
};
TradingView.LineToolThumbUp = function (n, t) {
    this._constructor = "LineToolThumbUp";
    var i = t ? t : new Property(defaults("linetoolthumbup"));
    J47.call(this, n, new _97(this, n, this.image, 20, 20, -11, 0), i);
    this._paneViews[0].setAnchors(new MathEx.Point(0, 0))
};
inherit(TradingView.LineToolThumbUp, J47);
TradingView.LineToolThumbUp.prototype.image = new Image;
TradingView.LineToolThumbUp.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACG0lEQVR4AWMgBajE205TTrD7D8R7VRJtQxgoBSDD9r++8n/68bX/leNt91NkmEKCg4BOhvv/7S/O/d/y9DTIlT8pMlAx3q4kqDv7/9KHB/8vfXAAZOAfsg0DhpeoerLT/zmXtv6ffXfn/6ZD8/4rxdqcJT/s4m168pa0/V/1+Mj/6Xe2/XdvTfovF2SWS57rEmxCjfP9/q95cOT//Pt7/k+6sem/SpLDfwZBQX4yYtXBA+TVicdW/l/+6ND/aXe2gl0YPa0MFIYQnGi3TjHB3hVFI0wSxoZhy5Lg/70Hlv5f//TE/zn3dv2feGvj/5l3d4D5e19dAieh3v1LgGptN+AzEKQQjPcANW16dvr/wgf7/k+5vfl//80N/6fd3gqO6Y3PTv7f8vzM/x0vzoP14jVw24uzQINO/V/75DjYsKlAQybc3AgyEORKsKGzgC6dC3T1ikeHCRu45OEBcPKYcWf7/8m3N8MMQ8cgcZChhA2cfW8nRBNhDFI7yA3sPb/6v3Kc7VOqGZi2rPm/fITFLKoY2Hxq8X+dTPf/km66xkQlbM101/+WFaH/XVoT/6esbPrfcmbJ/+6ra/4X75r0P3p+5X8toLxckEknUBsbvhzHCcRSoGzMKSNsJmKmFClup1EhG2C6QzHG+h2wYP0pH2p+RcbPaImgtpQ1UB0XEDMSzMdQRcxAzA7EvEAsCsSyQCwPtVAAiFnRDQMAkGceWYhDo88AAAAASUVORK5CYII=";
TradingView.LineToolThumbUp.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolThumbUp.prototype.title = function () {
    return"Thumb Up"
};
TradingView.LineToolThumbDown = function (n, t) {
    this._constructor = "LineToolThumbDown";
    var i = t ? t : new _52("linetoolthumbdown");
    J47.call(this, n, new _97(this, n, this.image, 20, 20, -6, -18), i);
    this._paneViews[0].setAnchors(new MathEx.Point(0, 0))
};
inherit(TradingView.LineToolThumbDown, J47);
TradingView.LineToolThumbDown.prototype.image = new Image;
TradingView.LineToolThumbDown.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAB70lEQVR4AWNAB4dsVUT3WCrU7bOQP7zXQuH/Xgv523stFSbsNley2e+gzcNACgBqLNhvq/r/SkbQ/wcNWf9fT6n//7Sj6P+N/Ij/JwIs/4PkIJYgMFgfgo0Au8xlVA/Yq/9/3JL//3lrwf+nNan/H1ck/n9Slfz/WVPO/xddpf9fTaj+/2pSLRi/ntaI38Ad5goTrmUF/39am/7/IdBFD7KC/t9P9///IDPw/8Oc0P+PCqP+PyqJ/f+4NA6MnzVk4Tdwj4XCg0dVKf8f5oX/v5/mRwiDDMVtIFQQ5D2Qi6hn4OOyeJBiqhkIUjSSDNxsKrf3RoovKKlgMwAsfj3W9f8RJy3iEvZ8A5moVcayJ2CS5wIt/z/ICIAbdjPR8/8+K6X/TepiZUDlakAsBcSc+HIeGxCLArGCNh+r6V5Lxf8Pc0PBBt7LDPp/yEHj/1QdiWKgPBcQM5GUp7eYycWf9Lf4/6goGuzKixEO/xcbyC6AuoiRgVSw01z+2L3S+P+PCiL/30kP+L/fRuV/oZKgLumGIWL8z9PaNGA2DPt/OsDi/0I9mS6gMCvpJiHy9a9HZXHgQuKAnfr/UhUxZbDryAXbzOQv384KBpUusOTAwkAJWGokXbjRWO4WyLANJnILwa6jELADsTgQS4JjlgQAAD+B93SzAgQRAAAAAElFTkSuQmCC";
TradingView.LineToolThumbDown.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolThumbDown.prototype.title = function () {
    return"Thumb Down"
};
TradingView.LineToolThumbDown.prototype.version = TradingView.LineToolThumbUp.prototype.version = 2;
TradingView.LineToolThumbUp.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = 0, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(12, 0)))
};
TradingView.LineToolThumbDown.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = 0, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(7, 18)))
};
BalloonRenderer.prototype.draw = function (n) {
    var t;
    if (0 !== this._data.points.size()) {
        n.font = [this._data.fontWeight, this._data.fontSize + "px", this._data.fontFamily].join(" ");
        t = n.measureText(this._data.label);
        t.height = this._data.fontSize;
        var i = {left: 15, top: (30 - t.height) / 2}, t = t.width + 2 * i.left, r = this._data.points.item(0).x - (i.left + 20), u = this._data.points.item(0).y - 39;
        this._measureCache && $.extend(this._measureCache, {innerWidth: t, innerHeight: 30, padding: i});
        n.translate(.5 + r, .5 + u);
        n.beginPath();
        n.moveTo(24, 30);
        n.lineTo(15, 30);
        n.arcTo(-1e3, 0, 1e3, 0, 15);
        n.lineTo(t - 15, 0);
        n.arcTo(1e3, 30, -1e3, 30, 15);
        n.lineTo(33, 30);
        n.quadraticCurveTo(33, 34, 35, 39);
        n.quadraticCurveTo(27, 36, 24, 30);
        n.fillStyle = generateColor(this._data.backgroundColor, this._data.transparency);
        n.fill();
        n.strokeStyle = this._data.borderColor;
        n.lineWidth = 2;
        n.stroke();
        n.closePath();
        n.textBaseline = "top";
        n.fillStyle = this._data.color;
        n.fillText(this._data.label, i.left, i.top - 1)
    }
};
BalloonRenderer.prototype.hitTest = function (n) {
    if (0 === this._data.points.size() || !this._measureCache.padding)return null;
    var t = this._data.points.item(0).x - (this._measureCache.padding.left + 20), i = this._data.points.item(0).y - (this._measureCache.innerHeight + 9);
    return MathEx.pointInRect(n, new MathEx.Point(t, i), new MathEx.Point(t + this._measureCache.innerWidth, i + this._measureCache.innerHeight)) ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(_56, _90);
_56.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().color.value(), n.borderColor = this.J99.properties().borderColor.value(), n.backgroundColor = this.J99.properties().backgroundColor.value(), n.transparency = this.J99.properties().transparency.value(), n.fontWeight = this.J99.properties().fontWeight.value(), n.fontSize = this.J99.properties().fontsize.value(), n.fontFamily = this.J99.properties().font.value(), n.label = this.J99.properties().text.value(), n.image = this._image, this.isAnchorsRequired() && 1 == n.points.size()) ? (t = new CompositeRenderer, t.append(new BalloonRenderer(n, this._rendererCache)), t.append(new SelectionRenderer({points: n.points})), t) : new BalloonRenderer(n, this._rendererCache)
};
TradingView.LineToolBalloon = function (n, t) {
    this._constructor = "LineToolBalloon";
    var i = t ? t : new _52("linetoolballoon");
    J47.call(this, n, new _56(this, n), i)
};
inherit(TradingView.LineToolBalloon, J47);
TradingView.LineToolBalloon.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolBalloon.prototype.title = function () {
    return"Balloon"
};
CalloutRenderer.ROUND_RADIUS = 8;
CalloutRenderer.TEXT_MARGINS = 2, function () {
    var n;
    CalloutRenderer.prototype.wordWrap = function (t, i) {
        var f, o, s, u, r, e;
        if (n || (f = document.createElement("canvas"), f.width = 0, f.height = 0, n = f.getContext("2d")), i = +i, f = (t + "").split(/[^\S\r\n]*(?:\r\n|\r|\n|$)/), f[f.length - 1] || f.pop(), !isFinite(i) || 0 >= i)return f;
        for (n.font = this.fontStyle(), o = [], s = 0; s < f.length; s++)if (u = f[s], r = n.measureText(u).width, r <= i)o.push(u); else for (u = u.split(/([-\)\]\},.!?:;])|(\s+)/); u.length;) {
            if (r = ~~(i / r * (u.length + 2) / 3), 0 >= r || n.measureText(u.slice(0, 3 * r - 1).join("")).width <= i)for (; n.measureText(u.slice(0, 3 * (r + 1) - 1).join("")).width <= i;)r++; else for (; 0 < r && n.measureText(u.slice(0, 3 * --r - 1).join("")).width > i;);
            if (0 < r)o.push(u.slice(0, 3 * r - 1).join("")), u.splice(0, 3 * r); else {
                if (r = u[0] + (u[1] || ""), e = 1 === e ? 1 : ~~(i / n.measureText(r) * r.length), n.measureText(r.substr(0, e)).width <= i)for (; n.measureText(r.substr(0, e + 1)).width <= i;)e++; else for (; 1 < e && n.measureText(r.substr(0, --e)).width > i;);
                1 > e && (e = 1);
                o.push(r.substr(0, e));
                u[0] = r.substr(e);
                u[1] = ""
            }
            if (r = n.measureText(u.join("")).width, r <= i) {
                o.push(u.join(""));
                break
            }
        }
        return o
    }
}();
CalloutRenderer.prototype.hitTest = function (n) {
    if (2 > this._data.points.size())return null;
    var i = this._data.points.item(0), t = this._data.points.item(1);
    return 3 > i.substract(n).length() ? new HitTestResult(HitTestResult.CHANGEPOINT, 0) : (i = t.x - this._textSizeCache.totalWidth / 2, t = t.y - this._textSizeCache.totalHeight / 2, n.x >= i && n.x <= i + this._textSizeCache.totalWidth && n.y >= t && n.y <= t + this._textSizeCache.totalHeight ? new HitTestResult(HitTestResult.MOVEPOINT) : null)
};
CalloutRenderer.prototype.fontStyle = function () {
    return(this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._data.fontSize + "px " + this._data.font
};
CalloutRenderer.prototype.draw = function (n) {
    var t, r, h, c;
    if (!(2 > this._data.points.size())) {
        t = this._data.points.item(0).clone();
        r = this._data.points.item(1).clone();
        n.lineCap = "butt";
        n.strokeStyle = this._data.bordercolor;
        n.lineWidth = this._data.linewidth;
        n.textBaseline = "bottom";
        n.font = this.fontStyle();
        h = this._data.fontSize * this._data.lines.length;
        c = this._data.wordWrapWidth || this._data.lines.reduce(function (t, i) {
            return Math.max(t, n.measureText(i).width)
        }, 0);
        this._textSizeCache.textHeight = h;
        this._textSizeCache.textHeight = c;
        var i = CalloutRenderer.ROUND_RADIUS, l = CalloutRenderer.TEXT_MARGINS, u = c + 2 * l + 2 * i, f = h + 2 * l + 2 * i;
        this._textSizeCache.totalWidth = u;
        this._textSizeCache.totalHeight = f;
        var s = r.x - u / 2, o = r.y - f / 2, e = 0, c = c + 2 * l > 2 * i, h = h + 2 * l > 2 * i;
        for (t.x > s + u ? e = 20 : t.x > s && (e = 10), t.y > o + f ? e += 2 : t.y > o && (e += 1), n.save(), n.translate(s, o), t.x -= s, t.y -= o, r.x -= s, r.y -= o, n.beginPath(), n.moveTo(i, 0), 10 == e && (c ? (n.lineTo(r.x - i, 0), n.lineTo(t.x, t.y), n.lineTo(r.x + i, 0)) : n.lineTo(t.x, t.y)), n.lineTo(u - i, 0), 20 == e ? (n.lineTo(t.x, t.y), n.lineTo(u, i)) : n.arcTo(u, 0, u, i, i), 21 == e && (h ? (n.lineTo(u, r.y - i), n.lineTo(t.x, t.y), n.lineTo(u, r.y + i)) : n.lineTo(t.x, t.y)), n.lineTo(u, f - i), 22 == e ? (n.lineTo(t.x, t.y), n.lineTo(u - i, f)) : n.arcTo(u, f, u - i, f, i), 12 == e && (c ? (n.lineTo(r.x + i, f), n.lineTo(t.x, t.y), n.lineTo(r.x - i, f)) : n.lineTo(t.x, t.y)), n.lineTo(i, f), 2 == e ? (n.lineTo(t.x, t.y), n.lineTo(0, f - i)) : n.arcTo(0, f, 0, f - i, i), 1 == e && (h ? (n.lineTo(0, r.y + i), n.lineTo(t.x, t.y), n.lineTo(0, r.y - i)) : n.lineTo(t.x, t.y)), n.lineTo(0, i), 0 == e ? (n.lineTo(t.x, t.y), n.lineTo(i, 0)) : n.arcTo(0, 0, i, 0, i), n.stroke(), n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill(), n.fillStyle = this._data.color, o = i + l + this._data.fontSize, s = i + l, t = 0; t < this._data.lines.length; t++)n.fillText(this._data.lines[t], s, o), o += this._data.fontSize;
        n.restore()
    }
};
inherit(_62, _90);
_62.prototype.update = function () {
    _90.prototype.update.call(this);
    this.J99._calculatePoint2()
};
_62.prototype.renderer = function () {
    var t, n, i, r;
    return this._points.item(0) ? (2 > this._points.size(0)) ? void 0 : (t = this.J99.properties(), n = {}, n.points = new List, n.points.append(this._points.item(0)), i = this._points.item(1).clone(), i.x = this._points.item(0).x + this.J99._barOffset * this.Q0.timeScale().barSpacing(), n.points.append(i), n.color = t.color.value(), n.linewidth = t.linewidth.value(), n.backcolor = t.backgroundColor.value(), n.transparency = t.transparency.value(), n.text = t.text.value(), n.font = t.font.value(), n.fontSize = t.fontsize.value(), n.bordercolor = t.bordercolor.value(), t.wordWrap && t.wordWrap.value() && (n.wordWrapWidth = t.wordWrapWidth.value()), n.bold = t.bold && t.bold.value(), n.italic = t.italic && t.italic.value(), i = new CalloutRenderer(n, this._textSizeCache), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(i), i = n.points.item(1), r = n.points.clone(), r.removeAt(r.size() - 1), t.append(this.createLineAnchor({points: r})), n.wordWrapWidth && (n = new MathEx.Point(i.x + (n.wordWrapWidth >> 1) + CalloutRenderer.ROUND_RADIUS + CalloutRenderer.TEXT_MARGINS, i.y), n.data = 1, t.append(this.createLineAnchor({points: (new List).append(n)}))), t) : i : new CompositeRenderer
};
TradingView.LineToolCallout = function (n, t) {
    this._constructor = "LineToolCallout";
    var i = t ? t : new _52("linetoolcallout");
    J47.call(this, n, new _62(this, n), i);
    this._barOffset = 0;
    this._timeScale = n.timeScale()
};
inherit(TradingView.LineToolCallout, J47);
TradingView.LineToolCallout.MIN_WIDTH = 100;
TradingView.LineToolCallout.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolCallout.prototype.title = function () {
    return"Callout"
};
TradingView.LineToolCallout.prototype.correctPoints = function (n) {
    var i = this._currentMovingPoint.index - this._startMovingPoint.index, r = this._currentMovingPoint.price - this._startMovingPoint.price, t = n.item(1);
    t.index += i;
    t.price += r;
    n.setItem(1, t)
};
TradingView.LineToolCallout.prototype.addPoint = function (n) {
    return(n = J47.prototype.addPoint.call(this, n)) && this._calculateBarOffset(), n
};
TradingView.LineToolCallout.prototype._calculateBarOffset = function () {
    1 < this.points().size() && (this._barOffset = this.points().item(1).index - this.points().item(0).index)
};
TradingView.LineToolCallout.prototype.setLastPoint = function (n) {
    J47.prototype.setLastPoint.call(this, n);
    2 == this.points().size() && this._calculateBarOffset()
};
TradingView.LineToolCallout.prototype.setPoint = function (n, t) {
    var u;
    switch (n) {
        case 0:
            J47.prototype.setPoint.call(this, n, t);
            this._calculateBarOffset();
            break;
        case 1:
            if (u = this.properties(), !u.wordWrapWidth)break;
            var i = this._points, r = this._dragStartLeftEdgeIndex, f = Math.round((t.index - r) / 2);
            if (isFinite(r) && isFinite(f)) {
                if (i.setItem(1, {index: r + f, price: i.item(1).price}), this._calculateBarOffset(), this.normalizePoints(), i = this._timeScale.indexToCoordinate(r + 2 * f) - this._timeScale.indexToCoordinate(r) - CalloutRenderer.ROUND_RADIUS - CalloutRenderer.TEXT_MARGINS, !isFinite(i))break;
                u.wordWrapWidth.setValue(Math.max(TradingView.LineToolCallout.MIN_WIDTH, i))
            } else i.setItem(1, t), this._calculateBarOffset(), this.normalizePoints()
    }
};
TradingView.LineToolCallout.prototype.startDragPoint = function (n, t) {
    var i = this.properties();
    1 === n && i.wordWrap && i.wordWrap.value() && (this._dragStartLeftEdgeIndex = 2 * this.points().item(1).index - t.index)
};
TradingView.LineToolCallout.prototype.move = function (n) {
    J47.prototype.move.call(this, n);
    this._calculateBarOffset()
};
TradingView.LineToolCallout.prototype.state = function (n) {
    return n = J47.prototype.state.call(this, n), n.barOffset = this._barOffset, n
};
TradingView.LineToolCallout.prototype.restoreData = function (n) {
    n.barOffset ? this._barOffset = n.barOffset : this._calculateBarOffset();
    this._calculatePoint2()
};
TradingView.LineToolCallout.prototype.setPriceScale = function (n) {
    DataSource.prototype.setPriceScale.call(this, n);
    n && n.priceRange() && this._calculatePoint2()
};
TradingView.LineToolCallout.prototype._calculatePoint2 = function () {
    if (this.Q0.lineBeingEdited() != this && this.Q0.sourceBeingMoved() != this && !(2 > this._points.size())) {
        var n = this.points().item(0), t = this.points().item(1);
        this._points.setItem(1, {price: t.price, index: n.index + this._barOffset})
    }
};
TriangleRenderer.prototype.draw = function (n) {
    if (!(2 > this._data.points.size())) {
        n.lineCap = "butt";
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        n.lineStyle = this._data.linestyle;
        var t = this._data.points.item(0), i = this._data.points.item(1), r;
        r = 2 == this._data.points.size() ? i : this._data.points.item(2);
        n.beginPath();
        n.moveTo(t.x, t.y);
        n.lineTo(i.x, i.y);
        n.lineTo(r.x, r.y);
        n.lineTo(t.x, t.y);
        this._data.fillBackground && (n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill());
        n.stroke()
    }
};
TriangleRenderer.prototype.hitTest = function (n) {
    if (2 > this._data.points.size())return null;
    var i = this._data.points.item(0), r = this._data.points.item(1), u = this._data.points.item(2), t = MathEx.distanceToSegment(i, r, n);
    return 3 >= t.distance ? new HitTestResult(HitTestResult.MOVEPOINT) : (t = MathEx.distanceToSegment(r, u, n), 3 >= t.distance) ? new HitTestResult(HitTestResult.MOVEPOINT) : (t = MathEx.distanceToSegment(u, i, n), 3 >= t.distance || this._data.fillBackground && MathEx.pointInTriangle(i, r, u, n) ? new HitTestResult(HitTestResult.MOVEPOINT) : null)
};
inherit(J44, _90);
J44.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().color.value(), n.linewidth = this.J99.properties().linewidth.value(), n.backcolor = this.J99.properties().backgroundColor.value(), n.fillBackground = this.J99.properties().fillBackground.value(), n.transparency = this.J99.properties().transparency.value(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new TriangleRenderer(n)), n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n})), t) : new TriangleRenderer(n)
};
TradingView.LineToolTriangle = function (n, t) {
    this._constructor = "LineToolTriangle";
    var i = t ? t : new _52("linetooltriangle");
    J47.call(this, n, new J44(this, n), i)
};
inherit(TradingView.LineToolTriangle, J47);
TradingView.LineToolTriangle.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolTriangle.prototype.title = function () {
    return"Triangle"
};
inherit(ArcRenderer, EllipseRenderer);
ArcRenderer.prototype._additionalPointTest = function (n, t) {
    return 0 <= n.y * t.y
};
ArcRenderer.prototype.draw = function (n) {
    var i, t, e;
    if (!(2 > this._data.points.size()))if (i = this._data.points.item(0), t = this._data.points.item(1), 3 > this._data.points.size())n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.beginPath(), n.moveTo(i.x, i.y), n.lineTo(t.x, t.y), n.stroke(); else if (e = this._data.points.item(2), e = MathEx.distanceToLine(i, t, e).distance, 1 > e)n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.beginPath(), n.moveTo(i.x, i.y), n.lineTo(t.x, t.y), n.stroke(); else {
        var u = t.substract(i), r = i.add(t).scaled(.5), t = new MathEx.Point(-u.y, u.x), t = t.normalized();
        r.add(t.scaled(e));
        r.add(t.scaled(-e));
        n.strokeStyle = this._data.color;
        n.lineWidth = this._data.linewidth;
        var t = u.length(), f = u.y / t, u = Math.acos(u.x / t);
        0 > f && (u = -u);
        f = this._data.points.item(2);
        r = MathEx.Matrix.translate(-r.x, -r.y);
        f = r.mult(f);
        r = MathEx.Matrix.rotate(-u);
        f = r.mult(f);
        r = MathEx.Matrix.scale(1, t / (2 * e));
        f = r.mult(f);
        this._data.clockwise = 0 > f.y ? !0 : !1;
        n.save();
        n.beginPath();
        n.translate(i.x, i.y);
        n.rotate(u);
        i = 1 - Math.sqrt(3) / 2;
        n.scale(1, e / (t * i));
        this._data.clockwise ? n.arc(.5 * t, t * Math.sqrt(3) / 2, t, -2 * Math.PI / 3, -Math.PI / 3, !1) : n.arc(.5 * t, -t * Math.sqrt(3) / 2, t, Math.PI / 3, 2 * Math.PI / 3, !1);
        n.restore();
        n.stroke();
        this._data.fillBackground && (n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill())
    }
};
inherit(_54, _90);
_54.prototype.renderer = function () {
    var n = {}, f, i, r;
    if (n.points = this._points, n.color = this.J99.properties().color.value(), n.linewidth = this.J99.properties().linewidth.value(), n.backcolor = this.J99.properties().backgroundColor.value(), n.fillBackground = this.J99.properties().fillBackground.value(), n.transparency = this.J99.properties().transparency.value(), this.isAnchorsRequired()) {
        f = new CompositeRenderer;
        f.append(new ArcRenderer(n));
        var e = new List, t = n.points.item(0), r = new MathEx.Point(t.x, t.y);
        if (r.data = 0, e.append(r), 1 == n.points.size())return f;
        if (i = n.points.item(1), r = new MathEx.Point(i.x, i.y), r.data = 1, 2 == n.points.size())return this.addAnchors(f), f;
        e.append(r);
        var r = n.points.item(2), o = MathEx.distanceToLine(t, i, r).distance, u = i.substract(t), t = t.add(i).scaled(.5), i = new MathEx.Point(-u.y, u.x), i = i.normalized(), r = t.add(i.scaled(o)), i = t.add(i.scaled(-o)), s = u.length(), h = u.y / s, u = Math.acos(u.x / s);
        return 0 > h && (u = -u), n = n.points.item(2), t = MathEx.Matrix.translate(-t.x, -t.y), n = t.mult(n), t = MathEx.Matrix.rotate(-u), n = t.mult(n), t = MathEx.Matrix.scale(1, s / (2 * o)), n = t.mult(n), n = 0 <= n.y ? new MathEx.Point(r.x, r.y) : new MathEx.Point(i.x, i.y), n.data = 2, e.append(n), f.append(this.createLineAnchor({points: e})), f
    }
    return new ArcRenderer(n)
};
TradingView.LineToolArc = function (n, t) {
    this._constructor = "LineToolArc";
    var i = t ? t : new _52("linetoolarc");
    J47.call(this, n, new _54(this, n), i);
    this.version = TradingView.LineToolArc.version
};
inherit(TradingView.LineToolArc, J47);
TradingView.LineToolArc.prototype.startChanging = function (n, t) {
    if (J47.prototype.startChanging.call(this, n, t), 0 == n || 1 == n) {
        var i = this.pointToScreenPoint(this._points.item(0))[0], r = this.pointToScreenPoint(this._points.item(1))[0], u = this.pointToScreenPoint(this._points.item(2))[0];
        this._dist = MathEx.distanceToLine(i, r, u).distance
    }
};
TradingView.LineToolArc.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolArc.prototype.title = function () {
    return"Arc"
};
TradingView.LineToolArc.prototype.setPoint = function (n, t) {
    var i = this.pointToScreenPoint(this._points.item(0))[0], e = this.pointToScreenPoint(this._points.item(1))[0], f = this.pointToScreenPoint(this._points.item(2))[0], s = this.priceScale(), u;
    s.isPercent() && (u = this.ownerSource().firstValue(), t.price = s.priceRange().convertFromPercent(t.price, u));
    switch (n) {
        case 0:
            var i = this.pointToScreenPoint(t)[0], u = e.substract(i), r = i.add(e).scaled(.5), i = new MathEx.Point(-u.y, u.x), i = i.normalized(), f = r.add(i.scaled(this._dist)), f = this.screenPointToPoint(f);
            this._points.setItem(0, t);
            this._points.setItem(2, f);
            break;
        case 1:
            s = MathEx.distanceToLine(i, e, f).distance;
            e = this.pointToScreenPoint(t)[0];
            u = e.substract(i);
            r = i.add(e).scaled(.5);
            i = new MathEx.Point(-u.y, u.x);
            i = i.normalized();
            f = r.add(i.scaled(this._dist));
            f = this.screenPointToPoint(f);
            this._points.setItem(1, t);
            this._points.setItem(2, f);
            break;
        case 2:
            t = this.pointToScreenPoint(t)[0];
            var s = MathEx.distanceToLine(i, e, t).distance, u = e.substract(i), r = i.add(e).scaled(.5), i = new MathEx.Point(-u.y, u.x), i = i.normalized(), f = r.add(i.scaled(s)), i = r.add(i.scaled(-s)), e = u.length(), o = u.y / e, u = Math.acos(u.x / e);
            0 > o && (u = -u);
            r = MathEx.Matrix.translate(-r.x, -r.y);
            t = r.mult(t);
            o = r.mult(f);
            r = MathEx.Matrix.rotate(-u);
            t = r.mult(t);
            o = r.mult(o);
            r = MathEx.Matrix.scale(1, e / (2 * s));
            t = r.mult(t);
            o = r.mult(o);
            f = 0 <= t.y * o.y ? new MathEx.Point(f.x, f.y) : new MathEx.Point(i.x, i.y);
            f = this.screenPointToPoint(f);
            this._points.setItem(2, f)
    }
    this.normalizePoints()
};
TradingView.LineToolArc.version = 2;
TradingView.LineToolArc.prototype.migrateVersion = function (n, t) {
    1 == n && 2 == this._points.size() && (t = (2 * this._points.item(0).price + 3 * this._points.item(1).price) / 5, this._points.append({price: t, index: this._points.item(1).index}));
    1 == n && 2 == this._timePoint.size() && (t = (2 * this._timePoint.item(0).price + 3 * this._timePoint.item(1).price) / 5, n = {price: t, offset: this._timePoint.item(1).offset, time_t: this._timePoint.item(1).time_t}, this._timePoint.append(n))
};
TradingView.LineToolArrow = function (n, t) {
    this._constructor = "LineToolArrow";
    var i = t ? t : new _52("linetoolarrow");
    TradingView.LineToolTrendLine.call(this, n, i)
};
inherit(TradingView.LineToolArrow, TradingView.LineToolTrendLine);
TradingView.LineToolArrow.prototype.title = function () {
    return"Arrow"
};
inherit(_61, _90);
_61.prototype.update = function () {
    this._invalidated = !0
};
_61.prototype._smoothArray = function (n, t) {
    for (var f, r, u = Array(n.length), i = 0; i < n.length; i++) {
        for (f = new MathEx.Point(0, 0), r = 0; r < t; r++)var e = Math.max(i - r, 0), o = Math.min(i + r, n.length - 1), f = f.add(n[e]), f = f.add(n[o]);
        u[i] = f.scaled(.5 / t)
    }
    return u.push(n[n.length - 1]), u
};
_61.prototype._updateInternal = function () {
    var i, n, u, t;
    if (_90.prototype.update.call(this), i = Math.max(1, this.J99.properties().smooth.value()), n = this._points.toArray(), 0 != n.length) {
        for (u = [n[0]], t = 1; t < n.length; t++) {
            for (var f = n[t].substract(n[t - 1]), r = f.length(), e = Math.floor(r / i), f = f.normalized().scaled(r / e), r = 0; r < e - 1; r++)u.push(n[t - 1].add(f.scaled(r)));
            u.push(n[t])
        }
        i = this._smoothArray(u, i);
        this._points = new List(i)
    }
};
_61.prototype.renderer = function () {
    var n, t, i;
    return(this._invalidated && (this._updateInternal(), this._invalidated = !1), n = {}, t = this.J99.properties(), n.points = this._points, n.color = t.linecolor.value(), n.linewidth = t.linewidth.value(), n.linestyle = t.linestyle.value(), n.skipClosePath = !0, t.fillBackground.value() && this.Q0.lineBeingCreated() !== this.J99 && (n.filled = !0, n.fillBackground = !0, n.backcolor = t.backgroundColor.value(), n.transparency = t.transparency.value()), this.isAnchorsRequired() && this.J99.finished()) ? (t = new CompositeRenderer, t.append(new PoligonRenderer(n)), 0 < n.points.size() && (i = new List, i.append(n.points.item(0)), i.append(n.points.item(n.points.size() - 1)), t.append(new SelectionRenderer({points: i}))), t) : new PoligonRenderer(n)
};
TradingView.LineToolBrush = function (n, t) {
    this._constructor = "LineToolBrush";
    var i = t ? t : new _52("linetoolbrush");
    J47.call(this, n, new _61(this, n), i);
    this._finished = !1
};
inherit(TradingView.LineToolBrush, J47);
TradingView.LineToolBrush.prototype.pointsCount = function () {
    return-1
};
TradingView.LineToolBrush.prototype.finished = function () {
    return this._finished
};
TradingView.LineToolBrush.prototype.finish = function () {
    this._finished = !0;
    this._lastPoint = null;
    this.normalizePoints();
    this.createServerPoints()
};
TradingView.LineToolBrush.prototype.title = function () {
    return"Brush"
};
TradingView.LineToolBrush.prototype.percentDistance = function (n, t) {
    return Math.abs((t - n) / n)
};
TradingView.LineToolBrush.prototype.addPoint = function (n) {
    if (this._finished)return!0;
    if (this._lastPoint = null, 0 < this._points.size()) {
        var t = this._points.item(this._points.size() - 1), t = this.pointToScreenPoint(t)[1];
        if (2 > this.pointToScreenPoint(n)[1].substract(t).length())return this._finished
    }
    return J47.prototype.addPoint.call(this, n), this._finished
};
TradingView.LineToolBrush.prototype.restorePoints = function (n, t, i) {
    J47.prototype.restorePoints.call(this, n, t, i);
    this._finished = !0
};
TradingView.LineToolRay = function (n, t) {
    this._constructor = "LineToolRay";
    var i = t ? t : new _52("linetoolray");
    TradingView.LineToolTrendLine.call(this, n, i)
};
inherit(TradingView.LineToolRay, TradingView.LineToolTrendLine);
TradingView.LineToolRay.prototype.title = function () {
    return"Ray"
};
TradingView.LineToolExtended = function (n, t) {
    this._constructor = "LineToolExtended";
    var i = t ? t : new _52("linetoolextended");
    TradingView.LineToolTrendLine.call(this, n, i)
};
inherit(TradingView.LineToolExtended, TradingView.LineToolTrendLine);
TradingView.LineToolExtended.prototype.title = function () {
    return"Extended Line"
};
TradingView.LineToolArrowMark = function (n, t) {
    var i = t ? t : new _52("linetoolarrowmark");
    J47.call(this, n, new _97(this, n, this.image, this.width, this.height, this.offsetX, this.offsetY), i)
};
inherit(TradingView.LineToolArrowMark, J47);
TradingView.LineToolArrowMark.prototype.width = 21;
TradingView.LineToolArrowMark.prototype.height = 21;
TradingView.LineToolArrowMark.prototype.offsetX = 0;
TradingView.LineToolArrowMark.prototype.offsetY = 0;
TradingView.LineToolArrowMark.prototype.paneViews = function (n) {
    return n = J47.prototype.paneViews.call(this, n), null !== n && this._textPaneView && n.append(this._textPaneView), n
};
TradingView.LineToolArrowMark.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolArrowMark.prototype.title = function () {
    return"Arrow Mark"
};
TradingView.LineToolArrowMarkLeft = function (n, t) {
    this._constructor = "LineToolArrowMarkLeft";
    TradingView.LineToolArrowMark.call(this, n, t);
    this._textPaneView = new J39(this, n, 22, -3, "middle", "left");
    this._textPaneView._noSelection = !0
};
inherit(TradingView.LineToolArrowMarkLeft, TradingView.LineToolArrowMark);
TradingView.LineToolArrowMarkLeft.prototype.image = new Image;
TradingView.LineToolArrowMarkLeft.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB50lEQVR4AWMgETAKKAgIAGkQ5mCgAmCWdtTWV4yxvgFkWwKxOKUGssr5Gccrx9t+Vk6w+w/kxwKxIrmGMTKIivIohFvONKsI+e/cl/ofamgGECuTYyCTqJ2mqlK01Vnr+uj/HjNy/1v1J8AMzSTHUBYZP6MgpTjb97bNsf9dpmf9N++J/W/UEQEztAiIbUEGo2EpIObE8C4oVuVDzLuBmv869aT8t5+c+t+0K/q/YXs4GGsWeIAMRscwy/yhBiO8K2ijJKcYZXXYuj7qv/u0nP/W/Yn/jTsjQYYRwliDhUXKy8BVKdbmuW1T7H+3Gdn/LXrjQN4FaSDLUBa5MItyoOAvp67k/45T0pC9S56hSrHWhY4tif9D5pUDXZjz36w7Blkx+S5VDLNoBUWMY3fKfwdExMAw+WEq7Wvkoxhn+waUhFwRSYhcQxGxL26jpqQYbX3CBpjY3aeDYj+BothHpFNxcW75cIvJpmXB/516Uv/bT0r5b9IVRUY6xQSssr6GkcAc9dGuNe6/y7RMMnMUJmCWcNTSBgbHZeuG6P+eM/P+W/VRlPcRwSGoJMgvH265yKIq/L9LfzqKoZSXp0Em6cDy9BvU0Dhyy1PM4PAwMFWKs7kFZFsBsQQDlQAjr4a0MJAWxFdHAQAcI3sGHsO1dgAAAABJRU5ErkJggg==";
TradingView.LineToolArrowMarkLeft.prototype.offsetX = 1;
TradingView.LineToolArrowMarkLeft.prototype.offsetY = -10;
TradingView.LineToolArrowMarkLeft.prototype.title = function () {
    return"Arrow Mark Left"
};
TradingView.LineToolArrowMarkUp = function (n, t) {
    this._constructor = "LineToolArrowMarkUp";
    TradingView.LineToolArrowMark.call(this, n, t);
    this._textPaneView = new J39(this, n, 0, 18, "top", "center");
    this._textPaneView._noSelection = !0
};
inherit(TradingView.LineToolArrowMarkUp, TradingView.LineToolArrowMark);
TradingView.LineToolArrowMarkUp.prototype.image = new Image;
TradingView.LineToolArrowMarkUp.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAACBklEQVR4AWMgErAoxVoXgmgGKgEWxTCLVseWxP9yYRbl1DCYSdrXyEc5we5vyLzy/0D6l5SXgStInFwDGcVt1JQU42zfOHan/HebkfPfqSv5v1KszXNBGyU5kDzpRoqLcytGW5+wbY797zA59b9Zd8x/xylp/22bYv8rRlkdBqrgINVIVvlwi8k29dH/Xadn/Tftiv5v2B4Opt1mZP+3ro/6Lx9i3k1K+DLL+hpGmpYF/3efnvPfvCcWZCAcW/TG/XeflvMfFM4yfkZBxIQvo4SjlrZSnO1Hp57U/9b9Cf+NOiKQDQXxgeKJ/516Uv4D1b0XtdNUxRu+gkqC/MBwvGzXGvffflLKf+POSISBCAwWtweGMyi8laKtzjKIivLgCUfLRdYN0f9dpmX+N+mKghiCieHh6wIMb2tguCuEW84E6ccIR7kgk3SLqvD/njPzYOFICIPVeczI/W9WEfJfzs84HmQOIhw9DEyV422/ufSn/7fqg4cjIQxWZwUMd+e+1P9A/Z+lHbX1weHLqyEtrBRncwsYm/+RsWaBBz4DwfLoehRjrG8IKAgIgOMHiK2AOA6IM6G4CKgIr6EgeZA6qPoMII4FYksgFmCA5gwJIFYEYmUotiXSUFuYHqh+cXw5TZlIQ5WxaR4mhuLBZBkqBcT+oJjFg/3B6kgAnFANyniwFEQdJgAAOuN7Bp7MBuYAAAAASUVORK5CYII=";
TradingView.LineToolArrowMarkUp.prototype.offsetX = -9;
TradingView.LineToolArrowMarkUp.prototype.offsetY = 0;
TradingView.LineToolArrowMarkUp.prototype.title = function () {
    return"Arrow Mark Up"
};
TradingView.LineToolArrowMarkRight = function (n, t) {
    this._constructor = "LineToolArrowMarkRight";
    TradingView.LineToolArrowMark.call(this, n, t);
    this._textPaneView = new J39(this, n, -22, -3, "middle", "right");
    this._textPaneView._noSelection = !0
};
inherit(TradingView.LineToolArrowMarkRight, TradingView.LineToolArrowMark);
TradingView.LineToolArrowMarkRight.prototype.image = new Image;
TradingView.LineToolArrowMarkRight.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB60lEQVR4AWPAAziAWJBXQ1oYSDMyUAlIALGVUpzNLQkPA1Mgm5kahioCcZxygt1/5Xjbb3JBJulAPiulhioDcSbIUJf+9P8WVeH/5cMtFwkqCfKDgoNiQ636Ev57zsz7b90Q/V8x2vqyhKOWNqHg4ARiKZAhaNgWiItAhhp1RPw374n97zIt879da9x/pTjbj7K+hpE4gwNqoD9IMzasWeDx37A9HIxNuqL+209K+e/Uk/rftCwYGBwWkxnExbkRwYHpTZBGgti4M/K/dX/Cf/fpOf9t6sHBcULcRk0JaAYT6YYiMDw4XKdn/bdtjv2vGGf7RtrXyAdoDguZhiKwaVf0f4fJqf8du1NAQfVXMcyiFWQwmYYisFl3zH+3GTn/Q+aV/3dsSfyvFGtdSLFLHaek/XfqSga59JdcmEU5yKVkh6lFbxzQhdn/bZtiga6zeS7lZeAKMpCC2E/87z4t5791fdR/xSirw4I2SnKg2CcxnSK8aw+MGKceSMTIh5h3Q0szRvJzFCQJgXLUexk/oyCQd8nP+8DE7jEjF+jd6P9K0VZnRe00VWHeJcfQDJChzn2p/80qQv4rhFvOZBAV5QF5l5LyNBZann6W8zOOp0Z5Kg7Eloox1jekHbX1qVLyQ2NVQEBBQIBU7wIAOFZ7BmG7RzYAAAAASUVORK5CYII=";
TradingView.LineToolArrowMarkRight.prototype.offsetX = -19;
TradingView.LineToolArrowMarkRight.prototype.offsetY = -10;
TradingView.LineToolArrowMarkRight.prototype.title = function () {
    return"Arrow Mark Right"
};
TradingView.LineToolArrowMarkDown = function (n, t) {
    this._constructor = "LineToolArrowMarkDown";
    TradingView.LineToolArrowMark.call(this, n, t);
    this._textPaneView = new J39(this, n, 0, -23, "bottom", "center");
    this._textPaneView._noSelection = !0
};
inherit(TradingView.LineToolArrowMarkDown, TradingView.LineToolArrowMark);
TradingView.LineToolArrowMarkDown.prototype.image = new Image;
TradingView.LineToolArrowMarkDown.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAB/UlEQVR4AWPAATj3Wij8J4RB6hhIAFIgTS9a8nBhmKFSpBiqDNJ0P80PF4YZqkyyobfD7HDh4WJolaKY+G5zhXvoMXva2xifoWB5dD07zeTvFKvxioDMFY6RFUgEGvzzQVk8OGafVib9v5fkhc9QkDxIHVj9vaKY/7vM5b+HS/JFA80TAhnKA8TGZSoiS057GYFiFqzhTpQTPkNB8iB1YPUnPQz+5ykKzQGaYwjE3CBDmUCuBWKHabqSZ0656oI0EY1B6idoSx4F6reDupIJFrTMQCwtxsYcvNZY5uU5T0OiDDwLdOFKI9knvMzM/kD9kmBz0AAbEKs6iHAX7zSX/3nF3xyvgZd8Tf9vM5P/ZiXAmQdNBazYEgIjEHOBwiVHXmjWcSctnAbeDLH5f8xR83+SjNBEoHo9sD4owGWwIBDb9mtJHMIVviDxDg3x3UB11kDMD9ZHADCDwkeAmdlvhZHMI2C4oRh4xl3//1IDmbvszAxeQHXiUPWEATR8lE0EubJB4QYMP7CBF31M/m82k/usy8uRCpRXAKsjEXCCwiteVqD/qIPG/+tBVv/3WCj8C5Pi7wCKawMxBwMZgBEaXlbtGuI7T7ro/G9QFdsI5JsDMR/+cCQcvuLsLAzubRoSa4FsJyAWBSdwsgEifKVBXoYmcBYGagCoQZzEGggAoyq6zKXuV5gAAAAASUVORK5CYII=";
TradingView.LineToolArrowMarkDown.prototype.offsetX = -9;
TradingView.LineToolArrowMarkDown.prototype.offsetY = -18;
TradingView.LineToolArrowMarkDown.prototype.title = function () {
    return"Arrow Mark Down"
};
TradingView.LineToolArrowMarkRight.prototype.version = TradingView.LineToolArrowMarkLeft.prototype.version = TradingView.LineToolArrowMarkDown.prototype.version = TradingView.LineToolArrowMarkUp.prototype.version = 2;
TradingView.LineToolArrowMarkDown.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = -10, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(0, 21)), this._textPaneView._offsetX = 0, this._textPaneView._offsetY = -4)
};
TradingView.LineToolArrowMarkUp.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = -10, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(0, 0)), this._textPaneView._offsetX = 0, this._textPaneView._offsetY = 18)
};
TradingView.LineToolArrowMarkRight.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = 0, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(0, 0)), this._textPaneView._offsetX = 0, this._textPaneView._offsetY = 10)
};
TradingView.LineToolArrowMarkLeft.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = 0, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(0, 0)), this._textPaneView._offsetX = 21, this._textPaneView._offsetY = 10)
};
TradingView.LineToolFlagMark = function (n, t) {
    this._constructor = "LineToolFlagMark";
    var i = t ? t : new _52("linetoolflagmark");
    J47.call(this, n, new _97(this, n, this.image, 25, 25, -8, -21), i);
    this._paneViews[0].setAnchors(new MathEx.Point(0, 0))
};
inherit(TradingView.LineToolFlagMark, J47);
TradingView.LineToolFlagMark.prototype.image = new Image;
TradingView.LineToolFlagMark.prototype.image.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAsElEQVR4AWMYWcDExOS/YUd4hWF7+H90bNAePpO2liDwJTxyi2htyVXLvlBOWlry2bAtVIumwWXQERFF4zgJ20iPiP8JDCpLeqSuJ6ZdoRJ0SMIRx7QbQtmItgSXnGFbRCzMEnIzK8ISWgL6WzJqibGxsYaFhYUC7SxBWMQPNMjazMxMjebBZWhoKAq00NHc3FyL5nFiaWkpDTTYz8jISI/mEW9qaqoExGFgS+gFRgEAaE0hWxrw50oAAAAASUVORK5CYII=";
TradingView.LineToolFlagMark.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolFlagMark.prototype.title = function () {
    return"Flag Mark"
};
TradingView.LineToolFlagMark.prototype.version = 2;
TradingView.LineToolFlagMark.prototype.migrateVersion = function (n) {
    1 == n && (this.version = 1, this._paneViews[0]._offsetX = 0, this._paneViews[0]._offsetY = 0, this._paneViews[0].setAnchors(new MathEx.Point(9, 21)))
};
NoteRendererSource.prototype.update = function (n) {
    this._data && (!this._data || n.markerColor == this._data.markerColor && n.width == this._data.width && n.height == this._data.height) || this._createSource(n.width, n.height, n.markerColor);
    this._data = n
};
NoteRendererSource.prototype._createSource = function (n, t, i) {
    this._sourceCanvas = document.createElement("canvas");
    this._sourceCanvas.width = n;
    this._sourceCanvas.height = t;
    this._translate = new MathEx.Point(-n / 2, -t + .5);
    0 == this._translate.x % 1 && (this._translate.x += .5);
    var r = this._sourceCanvas.getContext("2d"), u = .6 * n;
    r.fillStyle = i;
    r.beginPath();
    r.moveTo(n / 2, t);
    r.quadraticCurveTo(n, n / 1.15, n, n / 2);
    r.arc(n / 2, n / 2, n / 2, 0, Math.PI, !0);
    r.quadraticCurveTo(0, n / 1.15, n / 2, t);
    r.fill();
    r.globalCompositeOperation = "destination-out";
    r.beginPath();
    r.moveTo((n - u) / 2, n / 2);
    r.arc(n / 2, n / 2, u / 2, 0, 2 * Math.PI);
    r.fill()
};
NoteRendererSource.prototype.drawOn = function (n) {
    var t = new MathEx.Point(Math.round(this._data.point.x), Math.round(this._data.point.y)).add(this._translate);
    n.drawImage(this._sourceCanvas, t.x, t.y)
};
NoteRendererSource.prototype.hasPoint = function (n) {
    var t = this._data.point.add(this._translate), i = new MathEx.Point(this._data.point.x - this._translate.x, this._data.point.y);
    return MathEx.pointInRect(n, t, i)
};
NoteRenderer.prototype.draw = function (n) {
    this.J99.drawOn(n);
    this._data.tooltipVisible && this.drawTooltipOn(n)
};
NoteRenderer.prototype.drawTooltipOn = function (n) {
    var f;
    n.save();
    f = String(this._data.text).replace(/^\s+|\s+$/g, "").replace(/[\r\n]+/g, "\n");
    n.font = (this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._data.fontSize + "px " + this._data.font;
    var f = TextRenderer.prototype.wordWrap(f, TradingView.LineToolNote.TOOLTIP_WIDTH - 2 * TradingView.LineToolNote.TOOLTIP_PADDING, n.font), u = this._data.point, l = TradingView.LineToolNote.TOOLTIP_LINESPACING, s = TradingView.LineToolNote.TOOLTIP_WIDTH, e = f.length * this._data.fontSize + 2 * TradingView.LineToolNote.TOOLTIP_PADDING;
    1 < f.length && (e += (f.length - 1) * l);
    var r = Math.round(u.x - s / 2), t = Math.round(u.y - this._data.height - e - 8), h = 20 > u.x || u.x + 20 > this._data.vpWidth, c = h ? null : "top", o = h ? null : Math.round(u.x);
    for (10 > t ? t = u.y + 13 : c = "bottom", 10 > r ? r += Math.abs(r - 10) : r + s + 10 > this._data.vpWidth && (r -= r + s + 10 - this._data.vpWidth), n.fillStyle = generateColor(this._data.backgroundColor, this._data.backgroundTransparency), n.strokeStyle = this._data.markerColor, n.lineWidth = 1, n.beginPath(), n.moveTo(r, t), h || "top" != c || (n.lineTo(o - 7, t), n.lineTo(o, t - 7), n.lineTo(o + 7, t)), n.lineTo(r + s, t), n.lineTo(r + s, t + e), h || "bottom" != c || (n.lineTo(o + 7, t + e), n.lineTo(o, t + e + 7), n.lineTo(o - 7, t + e)), n.lineTo(r, t + e), n.closePath(), n.fill(), n.stroke(), n.textBaseline = "middle", n.fillStyle = this._data.textColor, u = r + TradingView.LineToolNote.TOOLTIP_PADDING, t = t + TradingView.LineToolNote.TOOLTIP_PADDING + this._data.fontSize / 2, i = 0; i < f.length; i++)n.fillText(f[i].replace(/^\s+/, ""), u, t), t += this._data.fontSize + l;
    n.restore()
};
NoteRenderer.prototype.hitTest = function (n) {
    if (this.J99.hasPoint(n))return new HitTestResult(HitTestResult.MOVEPOINT)
};
inherit(NotePaneView, _90);
NotePaneView.prototype.renderer = function () {
    var t = new CompositeRenderer, n = this.J99.properties(), i = n.locked && n.locked.value() ? this.J99.fixedPoints() : this._points, r;
    return 1 > i.size() ? t : (r = this.isAnchorsRequired(), n = $.extend(n.state(), {point: i.item(0), width: 24, height: 32, tooltipVisible: r, vpWidth: this.Q0.m_timeScale.m_width, vpHeight: this.J99.m_priceScale.m_height}), this._rendererSource.update(n), t.append(new NoteRenderer(this._rendererSource, n)), r && t.append(new SelectionRenderer({points: i})), t)
};
TradingView.LineToolNote = function (n, t) {
    this._constructor = "LineToolNote";
    var i = t ? t : new _52("linetoolnote");
    J47.call(this, n, new NotePaneView(this, n), i);
    this.version = TradingView.LineToolNote.version
};
inherit(TradingView.LineToolNote, J47);
TradingView.LineToolNote.TOOLTIP_WIDTH = 300;
TradingView.LineToolNote.TOOLTIP_PADDING = 10;
TradingView.LineToolNote.TOOLTIP_LINESPACING = 5;
TradingView.LineToolNote.version = 1;
TradingView.LineToolNote.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolNote.prototype.title = function () {
    return $.t("Note")
};
TradingView.LineToolNote.prototype.restoreTemplate = function (n) {
    delete n.locked;
    delete n.text;
    J47.prototype.restoreTemplate.call(this, n)
};
TradingView.LineToolNoteAbsolute = function (n, t) {
    var i = t ? t : new _52("linetoolnoteabsolute");
    i.locked.value() || i.locked.setValue(!0);
    TradingView.LineToolNote.call(this, n, i)
};
inherit(TradingView.LineToolNoteAbsolute, TradingView.LineToolNote);
TradingView.LineToolNoteAbsolute.prototype.title = function () {
    return $.t("Anchored Note")
};
TradingView.LineToolNote.prototype.state = function (n) {
    var t = J47.prototype.state.call(this, n);
    return n && (t.state.fixedSize = !1), t
};
PriceLabelRenderer.prototype.draw = function (n) {
    var t;
    if (0 !== this._data.points.size()) {
        n.font = [this._data.fontWeight, this._data.fontSize + "px", this._data.fontFamily].join(" ");
        t = n.measureText(this._data.label);
        t.height = this._data.fontSize;
        var i = t.width + 20, t = t.height + 10, r = this._data.points.item(0).x - -9, u = this._data.points.item(0).y - (t + 15);
        this._measureCache && $.extend(this._measureCache, {innerWidth: i, innerHeight: t, tailLeft: -9, tailHeight: 15});
        n.translate(.5 + r, .5 + u);
        n.beginPath();
        n.moveTo(12, t);
        n.lineTo(-9, t + 15);
        n.lineTo(-10, t + 15 - 1);
        n.lineTo(5, t);
        n.lineTo(3, t);
        n.arcTo(0, t, 0, 0, 3);
        n.lineTo(0, 3);
        n.arcTo(0, 0, i, 0, 3);
        n.lineTo(i - 3, 0);
        n.arcTo(i, 0, i, t, 3);
        n.lineTo(i, t - 3);
        n.arcTo(i, t, 0, t, 3);
        n.lineTo(12, t);
        n.fillStyle = generateColor(this._data.backgroundColor, this._data.transparency);
        n.fill();
        n.strokeStyle = this._data.borderColor;
        n.lineWidth = 2;
        n.stroke();
        n.closePath();
        n.textBaseline = "top";
        n.fillStyle = this._data.color;
        n.fillText(this._data.label, 10, 4);
        n.translate(-.5, -.5);
        n.beginPath();
        n.arc(-9, t + 15, 2.5, 0, 2 * Math.PI, !1);
        n.fillStyle = generateColor(this._data.borderColor, this._data.transparency);
        n.fill();
        n.strokeStyle = this._chartModel.backgroundColor();
        n.lineWidth = 1;
        n.stroke();
        n.closePath()
    }
};
PriceLabelRenderer.prototype.hitTest = function (n) {
    if (0 === this._data.points.size())return null;
    var t = this._data.points.item(0).x - this._measureCache.tailLeft, i = this._data.points.item(0).y - (this._measureCache.innerHeight + this._measureCache.tailHeight);
    return MathEx.pointInRect(n, new MathEx.Point(t, i), new MathEx.Point(t + this._measureCache.innerWidth, i + this._measureCache.innerHeight)) ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(J5, _90);
J5.prototype.update = function () {
    var n, i, t;
    _90.prototype.update.call(this);
    0 < this.J99.points().size() && (t = this.J99.points().item(0).price, n = this.J99.priceScale(), n && !n.isEmpty() && (n.isPercent() && (i = this.J99.ownerSource().firstValue(), t = n.priceRange().convertToPercent(t, i)), this._priceLabel = n.formatter().format(t)))
};
J5.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.borderColor = this.J99.properties().borderColor.value(), n.backgroundColor = this.J99.properties().backgroundColor.value(), n.color = this.J99.properties().color.value(), n.fontWeight = this.J99.properties().fontWeight.value(), n.fontSize = this.J99.properties().fontsize.value(), n.fontFamily = this.J99.properties().font.value(), n.transparency = this.J99.properties().transparency.value(), n.label = this._priceLabel, n.image = this._image, this.isAnchorsRequired() && 1 == n.points.size()) ? (t = new CompositeRenderer, t.append(new PriceLabelRenderer(n, this._rendererCache, this.Q0)), t.append(new SelectionRenderer({points: n.points})), t) : new PriceLabelRenderer(n, this._rendererCache, this.Q0)
};
TradingView.LineToolPriceLabel = function (n, t) {
    this._constructor = "LineToolPriceLabel";
    var i = t || new _52("linetoolpricelabel");
    J47.call(this, n, new J5(this, n), i)
};
inherit(TradingView.LineToolPriceLabel, J47);
TradingView.LineToolPriceLabel.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolPriceLabel.prototype.title = function () {
    return"Price Label"
};
PredictionRenderer.prototype.drawBalloon = function (n, t, i, r, u, f) {
    return(f = f || 20, n.beginPath(), "down" === u) ? (t = new MathEx.Point(t.x - f, t.y - 11 - r), n.moveTo(t.x + 3, t.y), n.lineTo(t.x + i - 3, t.y), n.arcTo(t.x + i, t.y, t.x + i, t.y + 3, 3), n.lineTo(t.x + i, t.y + r - 3), n.arcTo(t.x + i, t.y + r, t.x + i - 3, t.y + r, 3), n.lineTo(t.x + f + 5, t.y + r), n.lineTo(t.x + f, t.y + r + 5), n.lineTo(t.x + f - 5, t.y + r), n.lineTo(t.x + 3, t.y + r), n.arcTo(t.x, t.y + r, t.x, t.y + r - 3, 3), n.lineTo(t.x, t.y + 3), n.arcTo(t.x, t.y, t.x + 3, t.y, 3), t) : (t = new MathEx.Point(t.x - f, t.y + 6 + 5 + r), n.moveTo(t.x + 3, t.y), n.lineTo(t.x + i - 3, t.y), n.arcTo(t.x + i, t.y, t.x + i, t.y - 3, 3), n.lineTo(t.x + i, t.y - r + 3), n.arcTo(t.x + i, t.y - r, t.x + i - 3, t.y - r, 3), n.lineTo(t.x + f + 5, t.y - r), n.lineTo(t.x + f, t.y - r - 5), n.lineTo(t.x + f - 5, t.y - r), n.lineTo(t.x + 3, t.y - r), n.arcTo(t.x, t.y - r, t.x, t.y - r + 3, 3), n.lineTo(t.x, t.y - 3), n.arcTo(t.x, t.y, t.x + 3, t.y, 3), new MathEx.Point(t.x, t.y - r))
};
PredictionRenderer.prototype.drawTargetLabel = function (n) {
    var i = this._data.points.item(1), f, h, o, s;
    n.save();
    n.translate(.5, .5);
    n.font = "normal " + this._targetFontSize3 + "px " + this._font;
    var e = 1.5 * this._targetFontSize1 + 1.5 * this._targetFontSize2 + 3, c = n.measureText(this._data.targetLine1).width, u = n.measureText(this._data.targetLine2).width;
    n.font = "normal " + this._targetFontSize2 + "px " + this._font;
    var r = n.measureText(this._data.targetLine3).width, t = n.measureText(this._data.targetLine4).width, u = Math.max(c + u, r + t + 10) + 20, t = "up" === this._data.direction ? "down" : "up", l = i.x + u - n.canvas.width + 5, l = Math.max(20, Math.min(u - 15, l)), t = this.drawBalloon(n, i, u, e, t, l);
    if (n.save(), n.fillStyle = generateColor(this._data.targetBackColor, this._data.transparency), n.fill(), n.restore(), n.save(), n.lineWidth = 2, n.strokeStyle = generateColor(this._data.targetStrokeColor, this._data.transparency), n.stroke(), n.restore(), n.beginPath(), n.arc(i.x, i.y, 3, 0, 2 * Math.PI, !1), n.fillStyle = this._data.centersColor, n.fill(), n.textAlign = "left", n.fillStyle = this._data.targetTextColor, n.font = "normal " + this._targetFontSize3 + "px " + this._font, n.fillText(this._data.targetLine1, t.x + 6, t.y + this._targetFontSize1 + 4), n.fillText(this._data.targetLine2, t.x + 6 + c + 5, t.y + this._targetFontSize1 + 4), n.font = "normal " + this._targetFontSize2 + "px " + this._font, i = t.y + this._targetFontSize1 + 8 + this._targetFontSize2, n.fillText(this._data.targetLine3, t.x + 6, i), n.drawImage(this._data.clockWhite, t.x + 6 + r + 6, i - this._targetFontSize2 + 3), n.fillText(this._data.targetLine4, t.x + 6 + r + 13 + 5, i), this._data.status) {
        r = this._targetFontSize1 + 4;
        n.font = "bold " + this._targetFontSize1 + "px " + this._font;
        switch (this._data.status) {
            case TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS:
                f = $.t("SUCCESS");
                h = generateColor(this._data.successBackground, this._data.transparency);
                o = this._data.successTextColor;
                s = this._data.successIcon;
                break;
            case TradingView.LineToolPrediction.ALERT_STATUS_FAILURE:
                f = $.t("FAILURE");
                h = generateColor(this._data.failureBackground, this._data.transparency);
                o = this._data.failureTextColor;
                s = this._data.failureIcon
        }
        i = n.measureText(f).width;
        i = Math.round((u - i) / 2);
        n.fillStyle = h;
        "up" === this._data.direction ? (n.roundRect(t.x - 1, t.y - r - 2, u + 2, r, 5), n.fill(), n.fillStyle = o, n.fillText(f, t.x + i, t.y - 5), n.drawImage(s, t.x + i - 13, t.y - 14)) : (n.roundRect(t.x - 1, t.y + e + 3, u + 2, r, 5), n.fill(), n.fillStyle = o, n.fillText(f, t.x + i, t.y + e + r - 1), n.drawImage(s, t.x + i - 13, t.y + e + 5))
    }
    n.restore()
};
PredictionRenderer.prototype.drawStartLabel = function (n) {
    var t, i;
    n.save();
    n.translate(.5, .5);
    n.font = "normal " + this._sourceFontSize1 + "px " + this._font;
    t = 1.5 * this._sourceFontSize1 + 1.5 * this._sourceFontSize2;
    i = n.measureText(this._data.sourceLine1).width;
    n.font = "normal " + this._fontsize2 + "px " + this._font;
    var r = n.measureText(this._data.sourceLine2).width, r = Math.max(i, r) - 5, i = this._data.points.item(0), t = this.drawBalloon(n, i, r, t, this._data.direction);
    n.fillStyle = generateColor(this._data.sourceBackColor, this._data.transparency);
    n.fill();
    n.lineWidth = 2;
    n.strokeStyle = generateColor(this._data.sourceStrokeColor, this._data.transparency);
    n.stroke();
    n.beginPath();
    n.arc(i.x, i.y, 3, 0, 2 * Math.PI, !1);
    n.fillStyle = this._data.centersColor;
    n.fill();
    n.textAlign = "left";
    n.fillStyle = this._data.sourceTextColor;
    n.font = "normal " + this._sourceFontSize1 + "px " + this._font;
    n.fillText(this._data.sourceLine1, t.x + 3, t.y + this._sourceFontSize1 + 2);
    n.font = "normal " + this._sourceFontSize2 + "px " + this._font;
    n.fillText(this._data.sourceLine2, t.x + 3, t.y + this._sourceFontSize1 + 4 + this._sourceFontSize2);
    n.restore()
};
PredictionRenderer.prototype.draw = function (n) {
    var i, u, t, s, r, f, e;
    if (!(2 > this._data.points.size())) {
        if (n.lineCap = "butt", n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.lineStyle = this._data.linestyle, i = this._data.points.item(0), u = this._data.points.item(1), new MathEx.Point(i.y, u.x), t = u.substract(i), 1 > Math.abs(t.x) || 1 > Math.abs(t.y) ? (n.beginPath(), n.moveTo(i.x, i.y), n.lineTo(u.x, u.y)) : (n.save(), n.beginPath(), n.translate(i.x, i.y), n.scale(1, t.y / t.x), n.moveTo(0, 0), n.arcTo(t.x, 0, t.x, t.x, Math.abs(t.x)), n.lineTo(t.x, t.x), n.restore()), n.stroke(), this.drawTargetLabel(n), this.drawStartLabel(n), i = Math.max(8, 4 * this._data.linewidth), n.fillStyle = this._data.color, s = 0 > t.y ? 1 : -1, 1 > Math.abs(t.x) || 1 > Math.abs(t.y))r = Math.atan(t.x / t.y); else {
            f = Math.abs(t.x);
            e = Math.abs(t.y);
            Math.sqrt((3 * f + e) * (3 * e + f));
            var h = 0, c = Math.PI / 2, o = (h + c) / 2;
            if (t.length() > i)for (; ;) {
                var r = f * Math.sin(o), l = e * (1 - Math.cos(o)), a = Math.sqrt((r - f) * (r - f) + (l - e) * (l - e));
                if (1 > Math.abs(a - i))break;
                a > i ? h = o : c = o;
                o = (h + c) / 2
            }
            r = Math.atan((f - r) / (e - l));
            0 > t.x * t.y && (r = -r)
        }
        n.save();
        n.beginPath();
        n.translate(u.x, u.y);
        n.rotate(-r);
        n.moveTo(0, 0);
        n.lineTo(-i / 2, s * i);
        n.lineTo(i / 2, s * i);
        n.lineTo(0, 0);
        n.restore();
        n.fill()
    }
};
PredictionRenderer.prototype.targetLabelHitTest = function (n) {
    var i = this._data.points.item(1), t = 1.5 * this._targetFontSize1 + 1.5 * this._targetFontSize2, e = this._targetFontSize1 * this._data.targetLine1.length, r = this._targetFontSize1 * this._data.targetLine2.length, u = this._targetFontSize2 * this._data.targetLine3.length, f = this._targetFontSize2 * this._data.targetLine4.length;
    return this._data.status && (t += 1.5 * this._targetFontSize1), e = Math.max(e + r, u + f) - 20, f = "up" === this._data.direction ? -1 : 1, r = i.x - 20, u = i.y + 5 * f, t = i.y + (5 + t) * f, i = Math.min(u, t), t = Math.max(u, t), n.x >= r && n.x <= r + e && n.y >= i && n.y <= t ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
PredictionRenderer.prototype.sourceLabelHitTest = function (n) {
    var r = 1.5 * this._sourceFontSize1 + 1.5 * this._sourceFontSize2, e = Math.max(this._sourceFontSize1 * this._data.sourceLine1.length, this._sourceFontSize2 * this._data.sourceLine2.length), t = this._data.points.item(0), u = "up" === this._data.direction ? 1 : -1, f = t.x - 20, i = t.y + 5 * u, t = t.y + (5 + r) * u, r = Math.min(i, t), i = Math.max(i, t);
    return n.x >= f && n.x <= f + e && n.y >= r && n.y <= i ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
PredictionRenderer.prototype.hitTest = function (n) {
    if (2 > this._data.points.size())return null;
    var t = this._data.points.item(0), r = this._data.points.item(1), i = r.substract(t);
    new MathEx.Point(t.y, r.x);
    var i = r.substract(t), t = n.substract(t), r = Math.abs(i.x), u = Math.abs(i.y), i = MathEx.sign(i.y) * (u - u * Math.sqrt(1 - t.x * t.x / (r * r)));
    return 3 > Math.abs(i - t.y) ? new HitTestResult(HitTestResult.MOVEPOINT) : (i = this.targetLabelHitTest(n)) ? i : this.sourceLabelHitTest(n)
};
inherit(J4, _90);
J4.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.targetLine1 = this._targetLine1, n.targetLine2 = this._targetLine2, n.targetLine3 = this._targetLine3, n.targetLine4 = this._targetLine4, n.status = this.J99.properties().status.value(), n.transparency = this.J99.properties().transparency.value(), n.targetBackColor = this.J99.properties().targetBackColor.value(), n.targetStrokeColor = this.J99.properties().targetStrokeColor.value(), n.targetTextColor = this.J99.properties().targetTextColor.value(), n.sourceBackColor = this.J99.properties().sourceBackColor.value(), n.sourceStrokeColor = this.J99.properties().sourceStrokeColor.value(), n.sourceTextColor = this.J99.properties().sourceTextColor.value(), n.successBackground = this.J99.properties().successBackground.value(), n.successTextColor = this.J99.properties().successTextColor.value(), n.failureBackground = this.J99.properties().failureBackground.value(), n.failureTextColor = this.J99.properties().failureTextColor.value(), n.intermediateBackColor = this.J99.properties().intermediateBackColor.value(), n.intermediateTextColor = this.J99.properties().intermediateTextColor.value(), n.sourceLine1 = this._sourceLine1, n.sourceLine2 = this._sourceLine2, n.direction = this._direction, n.clockWhite = this._clockWhite, n.clockBlack = this._clockBlack, n.successIcon = this._successIcon, n.failureIcon = this._failureIcon, n.finished = this._finished, n.centersColor = new RGBColor(this.Q0.Q2.paneProperties.background._value).blackWhiteContrast(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new PredictionRenderer(n)), n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n})), t) : new PredictionRenderer(n)
};
J4.prototype.update = function () {
    var i, n, t, r;
    _90.prototype.update.call(this);
    this._targetLine4 = this._targetLine3 = this._targetLine2 = this._targetLine1 = "";
    2 > this.J99.points().size() || !this.J99.priceScale() || (i = this.J99.points().item(1), n = this.J99.points().item(0), this._targetLine3 = this.J99.priceScale().formatter().format(i.price), t = i.price - n.price, r = 0 > t ? "-" : "+", this._targetLine1 = this.J99.priceScale().formatter().format(Math.abs(t)), t = Math.abs((Math.round(t / n.price * 1e4) / 100).toPrecision(3)), this._targetLine1 = r + this._targetLine1 + " (" + r + t + "%)", r = this.Q0.timeScale().indexToUserTime(n.index), t = this.Q0.timeScale().indexToUserTime(i.index), n.time && i.time && (r = isString(n.time) ? new Date(Date.parse(n.time)) : n.time, t = isString(i.time) ? new Date(Date.parse(i.time)) : i.time), t && r && (this._targetLine4 = (new DateFormatter).format(t), this.Q0.mainSeries().isDWM() || (this._targetLine4 = this._targetLine4 + "  " + new TimeFormatter("%h:%m").format(t)), i = (t.valueOf() - r.valueOf()) / 1e3, this._targetLine2 = $.t("in", {context: "dates"}) + " " + (new TimeSpanFormatter).format(i)), this._sourceLine1 = this.J99.priceScale().formatter().format(n.price), this._sourceLine2 = "", (n = this.Q0.timeScale().indexToUserTime(n.index)) && (this._sourceLine2 = (new DateFormatter).format(n), this.Q0.mainSeries().isDWM() || (this._sourceLine2 = this._sourceLine2 + " " + new TimeFormatter("%h:%m").format(n))), this._direction = this.J99.direction() === TradingView.LineToolPrediction.DIRECTION_UP ? "up" : "down", this._finished = this.Q0.lineBeingCreated() !== this.J99 && this.Q0.lineBeingEdited() !== this.J99 && this.Q0.sourceBeingMoved() !== this.J99)
};
TradingView.LineToolPrediction = function (n, t) {
    this._constructor = "LineToolPrediction";
    var i = t ? t : new _52("linetoolprediction");
    i.merge({status: TradingView.LineToolPrediction.ALERT_STATUS_WAITING});
    J47.call(this, n, new J4(this, n), i)
};
TradingView.LineToolPrediction.ALERT_STATUS_WAITING = 0;
TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS = 1;
TradingView.LineToolPrediction.ALERT_STATUS_FAILURE = 2;
TradingView.LineToolPrediction.DIRECTION_UP = 1;
TradingView.LineToolPrediction.DIRECTION_DOWN = 2;
inherit(TradingView.LineToolPrediction, J47);
TradingView.LineToolPrediction.prototype.status = function () {
    return this.Q2.status.value()
};
TradingView.LineToolPrediction.prototype.setStatus = function (n) {
    return this.Q2.status.setValue(n)
};
TradingView.LineToolPrediction.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolPrediction.prototype.title = function () {
    return"Forecast"
};
TradingView.LineToolPrediction.prototype.restorePoints = function (n, t, i) {
    J47.prototype.restorePoints.call(this, n, t, i);
    this.checkAlert()
};
TradingView.LineToolPrediction.prototype.checkAlert = function () {
    var n, t, i;
    2 > this._points.size() || this.Q0.mainSeries().bars().isEmpty() || (n = this._points.item(1), this.status() ? n.index > this.Q0.timeScale().points().lastTimePointIndex() && this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING) : (this.Q0.mainSeries().bars().last(), this.Q0.timeScale().indexToTimePoint(n.index)) && (t = this.Q0.mainSeries().bars().valueAt(n.index), i = this.direction(), i === TradingView.LineToolPrediction.DIRECTION_UP && t[HIGH_PLOT] >= n.price ? this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS) : i === TradingView.LineToolPrediction.DIRECTION_DOWN && t[LOW_PLOT] <= n.price ? this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_SUCCESS) : (n = this.Q0.mainSeries().bars().last().value, t[TIME_PLOT] !== n[TIME_PLOT] && this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_FAILURE))))
};
TradingView.LineToolPrediction.prototype.addPoint = function (n) {
    return(n = J47.prototype.addPoint.call(this, n)) && this.checkAlert(), n
};
TradingView.LineToolPrediction.prototype.endChanging = function () {
    J47.prototype.endChanging.call(this);
    this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING);
    this.checkAlert()
};
TradingView.LineToolPrediction.prototype.onData = function (n) {
    J47.prototype.onData.call(this, n);
    this.checkAlert()
};
TradingView.LineToolPrediction.prototype.endMoving = function () {
    J47.prototype.endMoving.call(this);
    this.setStatus(TradingView.LineToolPrediction.ALERT_STATUS_WAITING);
    this.checkAlert()
};
TradingView.LineToolPrediction.prototype.direction = function () {
    if (2 > this.points().size())return TradingView.LineToolPrediction.DIRECTION_UP;
    var n = this.points().item(0);
    return this.points().item(1).price > n.price ? TradingView.LineToolPrediction.DIRECTION_UP : TradingView.LineToolPrediction.DIRECTION_DOWN
};
inherit(J3, _90);
J3.prototype.renderer = function () {
    var n = {}, t;
    return(n.points = this._points, n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), n.filled = this.J99.properties().filled.value(), n.backcolor = this.J99.properties().backgroundColor.value(), n.fillBackground = this.J99.properties().fillBackground.value(), n.transparency = this.J99.properties().transparency.value(), this.isAnchorsRequired()) ? (t = new CompositeRenderer, t.append(new PoligonRenderer(n)), n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n})), t) : new PoligonRenderer(n)
};
TradingView.LineToolPolyline = function (n, t) {
    this._constructor = "LineToolPolyline";
    var i;
    t ? i = t : (i = new _52("linetoolpolyline"), i.filled.setValue(!1));
    J47.call(this, n, new J3(this, n), i)
};
inherit(TradingView.LineToolPolyline, J47);
TradingView.LineToolPolyline.prototype.pointsCount = function () {
    return-1
};
TradingView.LineToolPolyline.prototype.title = function () {
    return"Polyline"
};
TradingView.LineToolPolyline.prototype.addPoint = function (n) {
    var f = this.Q0.timeScale().indexToCoordinate(n.index), r = n.price, i = null;
    if (this.priceScale().isPercent() && (i = this.ownerSource().firstValue()), r = this.priceScale().priceToCoordinate(r), 0 < this._points.size()) {
        var t = this._points.item(this._points.size() - 1), u = this.Q0.timeScale().indexToCoordinate(t.index), t = t.price;
        if (this.priceScale().isPercent() && (t = this.priceScale().priceRange().convertToPercent(t, i)), t = this.priceScale().priceToCoordinate(t), 5 > new MathEx.Point(f, r).substract(new MathEx.Point(u, t)).length())return this._lastPoint = null, this.normalizePoints(), this.createServerPoints(), !0;
        if (t = this._points.item(0), u = this.Q0.timeScale().indexToCoordinate(t.index), t = t.price, this.priceScale().isPercent() && (t = this.priceScale().priceRange().convertToPercent(t, i)), i = this.priceScale().priceToCoordinate(t), 5 > new MathEx.Point(f, r).substract(new MathEx.Point(u, i)).length())return this.Q2.filled.setValue(!0), this._lastPoint = null, this.normalizePoints(), this.createServerPoints(), !0
    }
    return J47.prototype.addPoint.call(this, n)
};
TradingView.LineToolPolyline.prototype.setPoint = function (n, t) {
    if (J47.prototype.setPoint.call(this, n, t), !(this.Q0.timeScale().isEmpty() || this.priceScale().isEmpty() || n !== this._points.size() - 1 && 0 !== n)) {
        var r = this.Q0.timeScale().indexToCoordinate(t.index), u = this.priceScale().priceToCoordinate(t.price), i = this._points.item(0), f = this.Q0.timeScale().indexToCoordinate(i.index), i = this.priceScale().priceToCoordinate(i.price);
        5 > new MathEx.Point(r, u).substract(new MathEx.Point(f, i)).length() && this.Q2.filled.setValue(!0)
    }
};
inherit(_82, _90);
_82.prototype.renderer = function () {
    var u = new CompositeRenderer;
    if (2 > this._points.size())return console.log("_82:1 point"), this.addAnchors(u), u;
    for (var r = this._points.item(0), i = this._points.item(1), e = Math.min(r.x, i.x), o = Math.min(r.y, i.y), s = Math.max(r.x, i.x), h = Math.max(r.y, i.y), f = this.J99.properties(), c = this.J99.properties().fillHorzBackground.value(), l = this.J99.properties().horzTransparency.value(), a = this.J99.properties().fillVertBackground.value(), v = this.J99.properties().vertTransparency.value(), n = 0; n < this._hlevels.length; n++) {
        if (0 < n && c) {
            var t = this._hlevels[n - 1], r = new MathEx.Point(e, this._hlevels[n].y), i = new MathEx.Point(s, t.y), t = {nohittest: !0};
            t.points = (new List).append(r).append(i);
            t.color = this._hlevels[n].color;
            t.linewidth = 0;
            t.backcolor = this._hlevels[n].color;
            t.fillBackground = !0;
            t.transparency = l;
            u.append(new RectangleRenderer(t))
        }
        r = new MathEx.Point(e, this._hlevels[n].y);
        i = new MathEx.Point(s, this._hlevels[n].y);
        t = {points: (new List).append(r).append(i), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._hlevels[n].color, linewidth: f.linewidth.value(), linestyle: f.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        u.append(new TrendLineRenderer(t));
        f.showLeftLabels.value() && (r = {points: (new List).append(r), text: "" + this._hlevels[n].coeff, color: this._hlevels[n].color, vertAlign: "middle", horzAlign: "right", font: f.font.value(), offsetX: -5, offsetY: 0, fontsize: 12}, u.append(new TextRenderer(r, this._rendererCache)));
        f.showRightLabels.value() && (i = {points: (new List).append(i), text: "" + this._hlevels[n].coeff, color: this._hlevels[n].color, vertAlign: "middle", horzAlign: "left", font: f.font.value(), offsetX: 5, offsetY: 0, fontsize: 12}, u.append(new TextRenderer(i, this._rendererCache)))
    }
    for (n = 0; n < this._vlevels.length; n++)r = new MathEx.Point(this._vlevels[n].x, o), i = new MathEx.Point(this._vlevels[n].x, h), 0 < n && a && (t = this._vlevels[n - 1], e = new MathEx.Point(t.x, o), t = {nohittest: !0}, t.points = (new List).append(e).append(i), t.color = this._vlevels[n].color, t.linewidth = 0, t.backcolor = this._vlevels[n].color, t.fillBackground = !0, t.transparency = v, u.append(new RectangleRenderer(t))), t = {points: (new List).append(r).append(i), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._vlevels[n].color, linewidth: f.linewidth.value(), linestyle: f.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u.append(new TrendLineRenderer(t)), f.showTopLabels.value() && (e = {points: (new List).append(r), text: "" + this._vlevels[n].coeff, color: this._vlevels[n].color, vertAlign: "bottom", horzAlign: "center", font: f.font.value(), offsetX: 0, offsetY: -5, fontsize: 12}, u.append(new TextRenderer(e, this._rendererCache))), f.showBottomLabels.value() && (i = {points: (new List).append(i), text: "" + this._vlevels[n].coeff, color: this._vlevels[n].color, vertAlign: "top", horzAlign: "center", font: f.font.value(), offsetX: 0, offsetY: 5, fontsize: 12}, u.append(new TextRenderer(i, this._rendererCache)));
    return this.addAnchors(u), u
};
_82.prototype.update = function () {
    var u, f, r, o, i, t, n;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        for (u = this.J99.points().item(0), f = this.J99.points().item(1), this._hlevels = [], r = f.price - u.price, this.J99.priceScale().isPercent() && (o = this.J99.ownerSource().firstValue()), i = 1; 7 >= i; i++)if (t = "hlevel" + i, n = this.J99.properties()[t], n.visible.value()) {
            var t = n.coeff.value(), n = n.color.value(), e = u.price + t * r;
            this.J99.priceScale().isPercent() && (e = this.J99.priceScale().priceRange().convertToPercent(e, o));
            e = this.J99.priceScale().priceToCoordinate(e);
            this._hlevels.push({coeff: t, color: n, y: e})
        }
        for (this._vlevels = [], f = f.index - u.index, i = 1; 7 >= i; i++)t = "vlevel" + i, n = this.J99.properties()[t], n.visible.value() && (t = n.coeff.value(), n = n.color.value(), r = Math.round(u.index + t * f), r = this.Q0.timeScale().indexToCoordinate(r), this._vlevels.push({coeff: t, color: n, x: r}))
    }
};
TradingView.LineToolGannSquare = function (n, t) {
    this._constructor = "LineToolGannSquare";
    var i = t ? t : new _52("linetoolgannsquare");
    J47.call(this, n, new _82(this, n), i)
};
inherit(TradingView.LineToolGannSquare, J47);
TradingView.LineToolGannSquare.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolGannSquare.prototype.title = function () {
    return"Gann Box"
};
inherit(_81, _90);
_81.prototype.update = function () {
    var i, r, n;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        i = this._points.item(0);
        r = this._points.item(1);
        this._fans = [];
        for (var o = r.x - i.x, s = r.y - i.y, u = 1; 9 >= u; u++)if (n = "level" + u, n = this.J99.properties()[n], n.visible.value()) {
            var t = n.coeff1.value(), e = n.coeff2.value(), f = t / e, h = n.color.value(), c = "" + t + "/" + e;
            t > e ? (t = r.x, f = i.y + s / f) : (t = i.x + o * f, f = r.y);
            this._fans.push({label: c, color: h, x: t, y: f, index: u, linewidth: n.linewidth.value(), linestyle: n.linestyle.value(), index: u})
        }
    }
};
_81.prototype.renderer = function () {
    var r = new CompositeRenderer, i, u, f, n;
    if (2 > this._points.size())return r;
    i = this._points.item(0);
    this._points.item(1);
    for (var e = this.J99.properties(), s = this.J99.properties().fillBackground.value(), o = this.J99.properties().transparency.value(), t = 0; t < this._fans.length; t++)u = new MathEx.Point(this._fans[t].x, this._fans[t].y), s && (4 > this._fans[t].index ? (f = new MathEx.Point(this._fans[t + 1].x, this._fans[t + 1].y), n = {}, n.width = this.Q0.timeScale().width(), n.p1 = i, n.p2 = u, n.p3 = i, n.p4 = f, n.color = this._fans[t].color, n.transparency = o, n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n))) : 4 < this._fans[t].index && 0 < t && (f = new MathEx.Point(this._fans[t - 1].x, this._fans[t - 1].y), n = {}, n.width = this.Q0.timeScale().width(), n.p1 = i, n.p2 = u, n.p3 = i, n.p4 = f, n.color = this._fans[t].color, n.transparency = o, n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n)))), f = {points: (new List).append(i).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._fans[t].color, linewidth: this._fans[t].linewidth, linestyle: this._fans[t].linestyle, extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, n = new HitTestResult(HitTestResult.MOVEPOINT, null, this._fans[t].index), r.append(new TrendLineRenderer(f, n)), e.showLabels.value() && (u = {points: (new List).append(u), text: this._fans[t].label, color: this._fans[t].color, vertAlign: "middle", horzAlign: "left", font: e.font.value(), offsetX: 0, offsetY: -5, fontsize: 12}, r.append(new TextRenderer(u, this._rendererCache)));
    return this.isAnchorsRequired() && (i = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && i.removeAt(i.size() - 1), r.append(this.createLineAnchor({points: i}))), r
};
TradingView.LineToolGannFan = function (n, t) {
    this._constructor = "LineToolGannFan";
    var i = t ? t : new _52("linetoolgannfan");
    J47.call(this, n, new _81(this, n), i)
};
inherit(TradingView.LineToolGannFan, J47);
TradingView.LineToolGannFan.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolGannFan.prototype.title = function () {
    return"Gann Fan"
};
TradingView.LineToolGannFan.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(_72, _90);
_72.prototype.update = function () {
    var h, r, o, c, e, s;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        var r = this.J99.points().item(0), i = this.J99.points().item(1), n = !1, t = this.J99.properties();
        if (t.reverse && t.reverse.value() && (n = t.reverse.value()), this._levels = [], h = n ? i.price - r.price : r.price - i.price, r = n ? r.price : i.price, this.J99.priceScale().isPercent() && (o = this.J99.ownerSource().firstValue(), null === o))return;
        for (i = 1; 11 >= i; i++)if (n = t["level" + i], n.visible.value()) {
            var f = n.coeff.value(), l = n.color.value(), u = r + f * h;
            this.J99.priceScale().isPercent() && (u = this.J99.priceScale().priceRange().convertToPercent(u, o));
            c = this.J99.priceScale().priceToCoordinate(u);
            s = function (n) {
                return t.coeffsAsPercents.value() ? "" + Math.round(1e4 * n) / 100 + "%" : "" + n
            };
            t.showCoeffs.value() && t.showPrices.value() ? e = "" + s(f) + "(" + this.J99.priceScale().formatter().format(u) + ")" : t.showCoeffs.value() ? e = "" + s(f) : t.showPrices.value() && (e = "" + this.J99.priceScale().formatter().format(u));
            this._levels.push({coeff: f, color: l, y: c, label: e, linewidth: n.linewidth.value(), linestyle: n.linestyle.value(), index: i})
        }
    }
};
_72.prototype.renderer = function () {
    var f = new CompositeRenderer, h, o, s, i;
    if (2 > this._points.size())return f;
    var r = this._points.item(0), u = this._points.item(1), e = Math.min(r.x, u.x);
    Math.min(r.y, u.y);
    h = Math.max(r.x, u.x);
    Math.max(r.y, u.y);
    for (var t = this.J99.properties(), l = t.fillBackground.value(), a = t.transparency.value(), c = t.extendLines.value() ? this.Q0.timeScale().width() : h, n = 0; n < this._levels.length; n++) {
        if (0 < n && l) {
            var u = this._levels[n - 1], r = new MathEx.Point(e, this._levels[n].y), u = new MathEx.Point(c, u.y), i = {};
            i.nohittest = !TradingView.isMobile.any();
            i.points = (new List).append(r).append(u);
            i.color = this._levels[n].color;
            i.linewidth = 0;
            i.backcolor = this._levels[n].color;
            i.fillBackground = !0;
            i.transparency = a;
            f.append(new RectangleRenderer(i))
        }
        var r = new MathEx.Point(e, this._levels[n].y), u = new MathEx.Point(h, this._levels[n].y), i = {points: (new List).append(r).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._levels[n].color, linewidth: this._levels[n].linewidth, linestyle: this._levels[n].linestyle, extendleft: !1, extendright: t.extendLines.value(), leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, v = new HitTestResult(HitTestResult.MOVEPOINT, null, this._levels[n].index);
        if (f.append(new TrendLineRenderer(i, v)), t.showCoeffs.value() || t.showPrices.value()) {
            i = t.vertLabelsAlign.value();
            switch (t.horzLabelsAlign.value()) {
                case"left":
                    o = r;
                    s = "right";
                    break;
                case"center":
                    o = r.add(u).scaled(.5);
                    s = "center";
                    break;
                case"right":
                    t.extendLines.value() ? (o = new MathEx.Point(c - 4, this._levels[n].y), s = "right") : (o = new MathEx.Point(c + 4, this._levels[n].y), s = "left")
            }
            r = {points: (new List).append(o), text: this._levels[n].label, color: this._levels[n].color, vertAlign: i, horzAlign: s, font: t.font.value(), offsetX: -5, offsetY: "top" == i ? 0 : -5, fontsize: 12};
            f.append(new TextRenderer(r, this._rendererCache))
        }
    }
    return t.trendline.visible.value() && (i = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.trendline.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, f.append(new TrendLineRenderer(i))), this.isAnchorsRequired() && (e = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && e.removeAt(e.size() - 1), f.append(this.createLineAnchor({points: e}))), f
};
TradingView.LineToolFibRetracement = function (n, t) {
    this._constructor = "LineToolFibRetracement";
    var i = t ? t : new _52("linetoolfibretracement");
    J47.call(this, n, new _72(this, n), i);
    this.version = TradingView.LineToolFibRetracement.version
};
inherit(TradingView.LineToolFibRetracement, J47);
TradingView.LineToolFibRetracement.version = 2;
TradingView.LineToolFibRetracement.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibRetracement.prototype.title = function () {
    return"Fib Retracement"
};
TradingView.LineToolFibRetracement.prototype.migrateVersion = function (n) {
    1 == n && this.properties().extendLines.setValue(!0)
};
TradingView.LineToolFibRetracement.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(J41, _90);
J41.prototype.update = function () {
    var u, s, o, h, e;
    if (_90.prototype.update.call(this), !(3 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        var u = this.J99.points().item(0), i = this.J99.points().item(1), c = this.J99.points().item(2), t = !1, n = this.J99.properties();
        for (n.reverse && n.reverse.value() && (t = n.reverse.value()), this._levels = [], u = t ? u.price - i.price : i.price - u.price, this.J99.priceScale().isPercent() && (s = this.J99.ownerSource().firstValue()), i = 1; 11 >= i; i++)if (t = n["level" + i], t.visible.value()) {
            var f = t.coeff.value(), l = t.color.value(), r = c.price + f * u;
            this.J99.priceScale().isPercent() && (r = this.J99.priceScale().priceRange().convertToPercent(r, s));
            o = function (t) {
                return n.coeffsAsPercents.value() ? "" + Math.round(1e4 * t) / 100 + "%" : "" + t
            };
            h = this.J99.priceScale().priceToCoordinate(r);
            n.showCoeffs.value() && n.showPrices.value() ? e = "" + o(f) + "(" + this.J99.priceScale().formatter().format(r) + ")" : n.showCoeffs.value() ? e = "" + o(f) : n.showPrices.value() && (e = "" + this.J99.priceScale().formatter().format(r));
            this._levels.push({coeff: f, color: l, y: h, label: e, linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), index: i})
        }
    }
};
J41.prototype.renderer = function () {
    var u = new CompositeRenderer, e, h, o, s, i;
    if (2 > this._points.size())return u;
    var f = this._points.item(0), r = this._points.item(1), t = this.J99.properties(), i = {points: (new List).append(f).append(r), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.trendline.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    if (u.append(new TrendLineRenderer(i)), 3 > this._points.size())return this.addAnchors(u), u;
    e = this._points.item(2);
    i = {points: (new List).append(r).append(e), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.trendline.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    u.append(new TrendLineRenderer(i));
    h = Math.min(e.x, r.x);
    Math.min(f.y, r.y);
    e = Math.max(e.x, r.x);
    Math.max(f.y, r.y);
    for (var l = t.fillBackground.value(), a = t.transparency.value(), c = t.extendLines.value() ? this.Q0.timeScale().width() : e, n = 0; n < this._levels.length; n++) {
        0 < n && l && (r = this._levels[n - 1], f = new MathEx.Point(h, this._levels[n].y), r = new MathEx.Point(c, r.y), i = {}, i.nohittest = !TradingView.isMobile.any(), i.points = (new List).append(f).append(r), i.color = this._levels[n].color, i.linewidth = 0, i.backcolor = this._levels[n].color, i.fillBackground = !0, i.transparency = a, u.append(new RectangleRenderer(i)));
        var f = new MathEx.Point(h, this._levels[n].y), r = new MathEx.Point(e, this._levels[n].y), i = {points: (new List).append(f).append(r), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._levels[n].color, linewidth: this._levels[n].linewidth, linestyle: this._levels[n].linestyle, extendleft: !1, extendright: t.extendLines.value(), leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, v = new HitTestResult(HitTestResult.MOVEPOINT, null, this._levels[n].index);
        if (u.append(new TrendLineRenderer(i, v)), t.showCoeffs.value() || t.showPrices.value()) {
            i = t.vertLabelsAlign.value();
            switch (t.horzLabelsAlign.value()) {
                case"left":
                    o = f;
                    s = "right";
                    break;
                case"center":
                    o = f.add(r).scaled(.5);
                    s = "center";
                    break;
                case"right":
                    t.extendLines.value() ? (o = new MathEx.Point(c - 4, this._levels[n].y), s = "right") : (o = new MathEx.Point(c + 4, this._levels[n].y), s = "left")
            }
            f = {points: (new List).append(o), text: this._levels[n].label, color: this._levels[n].color, vertAlign: i, horzAlign: s, font: t.font.value(), offsetX: -5, offsetY: "top" == i ? 0 : -5, fontsize: 12};
            u.append(new TextRenderer(f, this._rendererCache))
        }
    }
    return this.addAnchors(u), u
};
TradingView.LineToolTrendBasedFibExtension = function (n, t) {
    this._constructor = "LineToolTrendBasedFibExtension";
    var i = t ? t : new _52("linetooltrendbasedfibextension");
    J47.call(this, n, new J41(this, n), i);
    this.version = TradingView.LineToolTrendBasedFibExtension.version
};
inherit(TradingView.LineToolTrendBasedFibExtension, J47);
TradingView.LineToolTrendBasedFibExtension.version = 2;
TradingView.LineToolTrendBasedFibExtension.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolTrendBasedFibExtension.prototype.title = function () {
    return"Trend-Based Fib Extension"
};
TradingView.LineToolTrendBasedFibExtension.prototype.migrateVersion = function (n) {
    1 == n && this.properties().extendLines.setValue(!0)
};
TradingView.LineToolTrendBasedFibExtension.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(_74, _90);
_74.prototype.update = function () {
    var u, f, r, o, t, i, n;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        for (u = this.J99.points().item(0), f = this.J99.points().item(1), this._hlevels = [], r = f.price - u.price, this.J99.priceScale().isPercent() && (o = this.J99.ownerSource().firstValue()), t = 1; 7 >= t; t++)if (i = "hlevel" + t, n = this.J99.properties()[i], n.visible.value()) {
            var i = n.coeff.value(), n = n.color.value(), e = u.price + i * r;
            this.J99.priceScale().isPercent() && (e = this.J99.priceScale().priceRange().convertToPercent(e, o));
            e = this.J99.priceScale().priceToCoordinate(e);
            this._hlevels.push({coeff: i, color: n, y: e, index: t})
        }
        for (this._vlevels = [], f = f.index - u.index, t = 1; 7 >= t; t++)i = "vlevel" + t, n = this.J99.properties()[i], n.visible.value() && (i = n.coeff.value(), n = n.color.value(), r = Math.round(u.index + i * f), r = this.Q0.timeScale().indexToCoordinate(r), this._vlevels.push({coeff: i, color: n, x: r, index: t}))
    }
};
_74.prototype.renderer = function () {
    var f = new CompositeRenderer, s;
    if (2 > this._points.size())return f;
    for (var r = this._points.item(0), u = this._points.item(1), l = Math.min(r.x, u.x), h = Math.min(r.y, u.y), a = Math.max(r.x, u.x), c = Math.max(r.y, u.y), t = this.J99.properties(), e = t.grid.color.value(), i = t.grid.linewidth.value(), o = t.grid.linestyle.value(), n = 0; n < this._hlevels.length; n++)r = new MathEx.Point(l, this._hlevels[n].y), u = new MathEx.Point(a, this._hlevels[n].y), t.grid.visible.value() && (s = {points: (new List).append(r).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: e, linewidth: i, linestyle: o, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, f.append(new TrendLineRenderer(s))), t.showLeftLabels.value() && (r = {points: (new List).append(r), text: "" + this._hlevels[n].coeff, color: this._hlevels[n].color, vertAlign: "middle", horzAlign: "right", font: t.font.value(), offsetX: -5, offsetY: 0, fontsize: 12}, f.append(new TextRenderer(r, this._rendererCache))), t.showRightLabels.value() && (u = {points: (new List).append(u), text: "" + this._hlevels[n].coeff, color: this._hlevels[n].color, vertAlign: "middle", horzAlign: "left", font: t.font.value(), offsetX: 5, offsetY: 0, fontsize: 12}, f.append(new TextRenderer(u, this._rendererCache)));
    for (n = 0; n < this._vlevels.length; n++)r = new MathEx.Point(this._vlevels[n].x, h), u = new MathEx.Point(this._vlevels[n].x, c), t.grid.visible.value() && (s = {points: (new List).append(r).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: e, linewidth: i, linestyle: o, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, f.append(new TrendLineRenderer(s))), t.showTopLabels.value() && (r = {points: (new List).append(r), text: "" + this._vlevels[n].coeff, color: this._vlevels[n].color, vertAlign: "bottom", horzAlign: "center", font: t.font.value(), offsetX: 0, offsetY: -5, fontsize: 12}, f.append(new TextRenderer(r, this._rendererCache))), t.showBottomLabels.value() && (u = {points: (new List).append(u), text: "" + this._vlevels[n].coeff, color: this._vlevels[n].color, vertAlign: "top", horzAlign: "center", font: t.font.value(), offsetX: 0, offsetY: 5, fontsize: 12}, f.append(new TextRenderer(u, this._rendererCache)));
    for (h = t.fillBackground.value(), c = t.transparency.value(), r = this._points.item(0), u = this._points.item(1), n = 0; n < this._hlevels.length; n++)o = new MathEx.Point(u.x, this._hlevels[n].y), 0 < n && h && (e = new MathEx.Point(u.x, this._hlevels[n - 1].y), i = {}, i.width = this.Q0.timeScale().width(), i.p1 = r, i.p2 = o, i.p3 = r, i.p4 = e, i.color = this._hlevels[n].color, i.transparency = c, i.hittestOnBackground = TradingView.isMobile.any(), f.append(new ChannelRenderer(i))), s = {points: (new List).append(r).append(o), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._hlevels[n].color, linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, e = new HitTestResult(HitTestResult.MOVEPOINT, null, {type: "h", index: this._hlevels[n].index}), f.append(new TrendLineRenderer(s, e));
    for (n = 0; n < this._vlevels.length; n++)o = new MathEx.Point(this._vlevels[n].x, u.y), 0 < n && h && (e = new MathEx.Point(this._vlevels[n - 1].x, u.y), i = {}, i.width = this.Q0.timeScale().width(), i.p1 = r, i.p2 = o, i.p3 = r, i.p4 = e, i.color = this._vlevels[n].color, i.transparency = c, i.hittestOnBackground = TradingView.isMobile.any(), f.append(new ChannelRenderer(i))), s = {points: (new List).append(r).append(o), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: this._vlevels[n].color, linewidth: t.linewidth.value(), linestyle: t.linestyle.value(), extendleft: !1, extendright: !0, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, e = new HitTestResult(HitTestResult.MOVEPOINT, null, {type: "v", index: this._vlevels[n].index}), f.append(new TrendLineRenderer(s, e));
    return this.isAnchorsRequired() && (t = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && t.removeAt(t.size() - 1), f.append(this.createLineAnchor({points: t}))), f
};
TradingView.LineToolFibSpeedResistanceFan = function (n, t) {
    this._constructor = "LineToolFibSpeedResistanceFan";
    var i = t ? t : new _52("linetoolfibspeedresistancefan");
    J47.call(this, n, new _74(this, n), i)
};
inherit(TradingView.LineToolFibSpeedResistanceFan, J47);
TradingView.LineToolFibSpeedResistanceFan.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibSpeedResistanceFan.prototype.title = function () {
    return"Fib Speed Resistance Fan"
};
TradingView.LineToolFibSpeedResistanceFan.prototype.processErase = function (n, t) {
    var i = "h" == t.type ? "hlevel" + t.index : "vlevel" + t.index, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
FibArcRenderer.prototype.draw = function (n) {
    n.lineCap = "butt";
    n.strokeStyle = this._data.color;
    n.lineWidth = this._data.linewidth;
    n.translate(this._data.center.x, this._data.center.y);
    n.beginPath();
    0 < this._data.dir ? n.arc(0, 0, this._data.radius, 0, Math.PI, !1) : n.arc(0, 0, this._data.radius, Math.PI, 0, !1);
    n.stroke();
    this._data.fillBackground && (this._data.radius2 && (0 < this._data.dir ? n.arc(0, 0, this._data.radius2, Math.PI, 0, !0) : n.arc(0, 0, this._data.radius2, 0, Math.PI, !0)), n.fillStyle = generateColor(this._data.color, this._data.transparency), n.fill())
};
FibArcRenderer.prototype.hitTest = function (n) {
    if (MathEx.sign(n.y - this._data.center.y) !== this._data.dir)return null;
    n = n.substract(this._data.center).length();
    var t = this._hittest || new HitTestResult(HitTestResult.MOVEPOINT);
    if (this._data.hittestOnBackground) {
        if (Math.abs(n) <= this._data.radius + 3)return t
    } else if (3 > Math.abs(n - this._data.radius))return t;
    return null
};
inherit(_73, _90);
_73.prototype.update = function () {
    var f, i, n, e, s;
    if (_90.prototype.update.call(this), !(2 > this._points.size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        var t = this._points.item(0), u = this._points.item(1), h = t.substract(u).length();
        for (this._levels = [], f = this.J99.properties(), i = 1; 11 >= i; i++)if (n = f["level" + i], n.visible.value()) {
            var r = n.coeff.value(), c = n.color.value(), l = u.substract(t).length() * r, o;
            f.showCoeffs.value() && (o = "" + r);
            e = MathEx.sign(u.y - t.y);
            s = new MathEx.Point(t.x, t.y + e * h * r);
            this._levels.push({coeff: r, color: c, label: o, radius: l, dir: e, labelPoint: s, linewidth: n.linewidth.value(), linestyle: n.linestyle.value(), index: i})
        }
    }
};
_73.prototype.renderer = function () {
    var f = new CompositeRenderer, i, t, n, e;
    if (2 > this._points.size())return f;
    i = this._points.item(0);
    this._points.item(1);
    for (var r = this.J99.properties(), o = r.fillBackground.value(), s = r.transparency.value(), u = 0; u < this._levels.length; u++)t = this._levels[u], n = {}, n.center = i, n.color = t.color, n.linewidth = t.linewidth, n.radius = t.radius, n.dir = t.dir, n.transparency = s, n.fillBackground = o, n.hittestOnBackground = TradingView.isMobile.any(), 0 < u && (n.radius2 = this._levels[u - 1].radius), e = new HitTestResult(HitTestResult.MOVEPOINT, null, t.index), f.append(new FibArcRenderer(n, e)), r.showCoeffs.value() && (t = {points: (new List).append(t.labelPoint), text: this._levels[u].label, color: this._levels[u].color, vertAlign: "middle", horzAlign: "right", font: r.font.value(), offsetX: 0, offsetY: 0, fontsize: 12}, f.append(new TextRenderer(t, this._rendererCache)));
    return r.trendline.visible.value() && (i = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: r.trendline.color.value(), linewidth: r.trendline.linewidth.value(), linestyle: r.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, f.append(new TrendLineRenderer(i))), this.isAnchorsRequired() && (i = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && i.removeAt(i.size() - 1), f.append(this.createLineAnchor({points: i}))), f
};
TradingView.LineToolFibSpeedResistanceArcs = function (n, t) {
    this._constructor = "LineToolFibSpeedResistanceArcs";
    var i = t ? t : new _52("linetoolfibspeedresistancearcs");
    J47.call(this, n, new _73(this, n), i)
};
inherit(TradingView.LineToolFibSpeedResistanceArcs, J47);
TradingView.LineToolFibSpeedResistanceArcs.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibSpeedResistanceArcs.prototype.title = function () {
    return"Fib Speed Resistance Arcs"
};
TradingView.LineToolFibSpeedResistanceArcs.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(_76, _90);
_76.prototype.update = function () {
    var r, n, u, f, t;
    if (_90.prototype.update.call(this), !(1 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty()) && (r = this.J99.points().item(0), 2 === this.J99.points().size() && (n = this.J99.points().item(1)), u = this.J99.properties(), f = this.J99.points().item(0).index, !this.Q0.timeScale().visibleBars().isEmpty()))for (this._levels = [], r = n ? n.index - r.index : 1, n = 1; 11 >= n; n++)if (t = u["level" + n], t.visible.value()) {
        var i = Math.round(f + t.coeff.value() * r), i = this.Q0.timeScale().indexToCoordinate(i), i = {index: n, x: i, color: t.color.value(), width: t.linewidth.value(), style: t.linestyle.value()};
        u.showLabels.value() && (i.text = t.coeff.value(), i.y = this.J99.priceScale().height());
        this._levels.push(i)
    }
};
_76.prototype.renderer = function () {
    for (var i, e, o, s, r, u = new CompositeRenderer, t = this.J99.properties(), n = 0; n < this._levels.length; n++) {
        if (i = {}, i.points = (new List).append(new MathEx.Point(this._levels[n].x, 0)), i.color = this._levels[n].color, i.linewidth = this._levels[n].width, i.linestyle = this._levels[n].style, r = new HitTestResult(HitTestResult.MOVEPOINT, null, this._levels[n].index), u.append(new VertLineRenderer(i, r)), 0 < n && t.fillBackground.value()) {
            var h = this._levels[n - 1], r = new MathEx.Point(this._levels[n].x, 0), h = new MathEx.Point(h.x, this.J99.priceScale().height()), f = {nohittest: !0};
            f.points = (new List).append(r).append(h);
            f.color = this._levels[n].color;
            f.linewidth = 0;
            f.backcolor = this._levels[n].color;
            f.fillBackground = !0;
            f.transparency = t.transparency.value();
            u.append(new RectangleRenderer(f))
        }
        if (void 0 !== this._levels[n].text) {
            r = t.horzLabelsAlign.value();
            r = "left" == r ? "right" : "right" == r ? "left" : "center";
            switch (r) {
                case"left":
                    o = 3;
                    break;
                case"center":
                    o = 0;
                    break;
                case"right":
                    o = -3
            }
            switch (t.vertLabelsAlign.value()) {
                case"top":
                    e = new MathEx.Point(this._levels[n].x, 0);
                    s = 5;
                    break;
                case"middle":
                    e = new MathEx.Point(this._levels[n].x, .5 * this._levels[n].y);
                    s = 0;
                    break;
                case"bottom":
                    e = new MathEx.Point(this._levels[n].x, this._levels[n].y);
                    s = -10
            }
            i = {points: (new List).append(e), text: "" + this._levels[n].text, color: i.color, vertAlign: "middle", horzAlign: r, font: t.font.value(), offsetX: o, offsetY: s, fontsize: 12};
            u.append(new TextRenderer(i, this._rendererCache))
        }
    }
    return 2 === this._points.size() && (t = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.trendline.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u.append(new TrendLineRenderer(t))), this.isAnchorsRequired() && (2 === this.J99.points().size() ? (t = this._points.clone(), u.append(this.createLineAnchor({points: t}))) : 0 < this._points.size() && (t = new List, t.append(new MathEx.Point(this._points.item(0).x, this.J99.priceScale().height() / 2)), u.append(this.createLineAnchor({points: t, hittestResult: HitTestResult.MOVEPOINT})))), u
};
TradingView.LineToolFibTimeZone = function (n, t) {
    this._constructor = "LineToolFibTimeZone";
    var i = t ? t : new _52("linetoolfibtimezone");
    J47.call(this, n, new _76(this, n), i);
    this.version = TradingView.LineToolFibTimeZone.version
};
inherit(TradingView.LineToolFibTimeZone, J47);
TradingView.LineToolFibTimeZone.version = 2;
TradingView.LineToolFibTimeZone.prototype.migrateVersion = function (n, t, i) {
    if (1 === n) {
        for (i.properties.level1.color.setValue(i.properties.baselinecolor.value()), n = 2; 11 >= n; n++)i.properties["level" + n].color.setValue(i.properties.linecolor.value());
        for (n = 1; 11 >= n; n++)i.properties["level" + n].linewidth.setValue(i.properties.linewidth.value()), i.properties["level" + n].linestyle.setValue(i.properties.linestyle.value())
    }
};
TradingView.LineToolFibTimeZone.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibTimeZone.prototype.title = function () {
    return"Fib Time Zone"
};
TradingView.LineToolFibTimeZone.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
EllipseRendererSimple.prototype.draw = function (n) {
    n.lineCap = "butt";
    n.strokeStyle = this._data.color;
    n.lineWidth = this._data.linewidth;
    n.lineStyle = this._data.linestyle;
    var t = this._data.points.item(0), i = this._data.points.item(1), r = Math.abs(t.x - i.x), u = Math.abs(t.y - i.y), t = t.add(i).scaled(.5);
    if (!(1 > r || 1 > u)) {
        if (this._data.wholePoints) {
            var i = this._data.wholePoints.item(0), f = this._data.wholePoints.item(1), e = Math.abs(i.x - f.x);
            Math.abs(i.y - f.y)
        }
        n.save();
        n.translate(t.x, t.y);
        n.scale(1, u / r);
        n.beginPath();
        n.arc(0, 0, r / 2, 0, 2 * Math.PI, !1);
        n.restore();
        n.stroke();
        this._data.fillBackground && (this._data.wholePoints && (n.translate(t.x, t.y), n.scale(1, u / r), n.arc(0, 0, e / 2, 0, 2 * Math.PI, !0)), n.fillStyle = generateColor(this._data.backcolor, this._data.transparency), n.fill())
    }
};
EllipseRendererSimple.prototype.hitTest = function (n) {
    if (2 > this._data.points.size())return null;
    var t = this._data.points.item(0), i = this._data.points.item(1), r = .5 * Math.abs(t.x - i.x);
    Math.abs(t.y - i.y);
    var u = Math.abs(t.x - i.x), f = Math.abs(t.y - i.y), e = t.add(i).scaled(.5);
    if (n = n.substract(e), 1 > u || 1 > f)return null;
    if (n.y /= (i.y - t.y) / (i.x - t.x), t = n.x * n.x + n.y * n.y - r * r, t = MathEx.sign(t) * Math.sqrt(Math.abs(t / r)), r = this._hittest || new HitTestResult(HitTestResult.MOVEPOINT), this._data.fillBackground && !this._data.noHitTestOnBackground) {
        if (3 > t)return r
    } else if (3 > Math.abs(t))return r;
    return null
};
inherit(_71, _90);
_71.prototype.update = function () {
    var e, n, t, u, r, f, s;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty()))for (n = this._points.item(0), t = this._points.item(1), this._center = n.add(t).scaled(.5), e = Math.abs(t.x - n.x), n = Math.abs(t.y - n.y), this._levels = [], t = this.J99.properties(), u = 1; 11 >= u; u++)if (r = t["level" + u], r.visible.value()) {
        var i = r.coeff.value(), h = r.color.value(), o = new List;
        o.append(new MathEx.Point(this._center.x - .5 * e * i, this._center.y - .5 * n * i));
        o.append(new MathEx.Point(this._center.x + .5 * e * i, this._center.y + .5 * n * i));
        t.showCoeffs.value() && (f = i, f = t.coeffsAsPercents.value() ? "" + Math.round(1e4 * f) / 100 + "%" : "" + f);
        s = new MathEx.Point(this._center.x, this._center.y + .5 * n * i);
        this._levels.push({coeff: i, color: h, label: f, points: o, labelPoint: s, linewidth: r.linewidth.value(), linestyle: r.linestyle.value(), index: u})
    }
};
_71.prototype.renderer = function () {
    var u = new CompositeRenderer, i, t, f;
    if (2 > this._points.size())return u;
    this._points.item(0);
    this._points.item(1);
    for (var n = this.J99.properties(), e = n.fillBackground.value(), o = n.transparency.value(), r = 0; r < this._levels.length; r++)i = this._levels[r], t = {}, t.points = i.points, t.color = i.color, t.linewidth = i.linewidth, t.backcolor = i.color, 0 < r && (t.wholePoints = this._levels[r - 1].points), t.fillBackground = e, t.transparency = o, t.noHitTestOnBackground = !TradingView.isMobile.any(), f = new HitTestResult(HitTestResult.MOVEPOINT, null, i.index), u.append(new EllipseRendererSimple(t, f)), n.showCoeffs.value() && (i = {points: (new List).append(i.labelPoint), text: this._levels[r].label, color: this._levels[r].color, vertAlign: "middle", horzAlign: "right", font: n.font.value(), offsetX: 0, offsetY: 0, fontsize: 12}, u.append(new TextRenderer(i, this._rendererCache)));
    return n.trendline.visible.value() && (n = {points: (new List).append(this._points.item(0)).append(this._points.item(1)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: n.trendline.color.value(), linewidth: n.trendline.linewidth.value(), linestyle: n.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u.append(new TrendLineRenderer(n))), this.isAnchorsRequired() && (n = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), u.append(this.createLineAnchor({points: n}))), u
};
TradingView.LineToolFibCircles = function (n, t) {
    this._constructor = "LineToolFibCircles";
    var i = t ? t : new _52("linetoolfibcircles");
    J47.call(this, n, new _71(this, n), i)
};
inherit(TradingView.LineToolFibCircles, J47);
TradingView.LineToolFibCircles.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibCircles.prototype.title = function () {
    return"Fib Circles"
};
TradingView.LineToolFibCircles.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
ArcWedgeRenderer.prototype.draw = function (n) {
    if (n.strokeStyle = this._data.color, n.lineWidth = this._data.linewidth, n.beginPath(), n.arc(this._data.center.x, this._data.center.y, this._data.radius, this._data.edge1, this._data.edge2, !0), n.stroke(), this._data.fillBackground) {
        if (n.arc(this._data.center.x, this._data.center.y, this._data.prevRadius, this._data.edge2, this._data.edge1, !1), this._data.gradient) {
            var t = n.createRadialGradient(this._data.center.x, this._data.center.y, this._data.prevRadius, this._data.center.x, this._data.center.y, this._data.radius);
            t.addColorStop(0, generateColor(this._data.color1, this._data.transparency));
            t.addColorStop(1, generateColor(this._data.color2, this._data.transparency));
            n.fillStyle = t
        } else n.fillStyle = generateColor(this._data.color, this._data.transparency);
        n.fill()
    }
};
ArcWedgeRenderer.prototype.hitTest = function (n) {
    var t = n.substract(this._data.center).length(), u = this._hittest || new HitTestResult(HitTestResult.MOVEPOINT);
    if (this._data.fillBackground) {
        if (t <= this._data.radius) {
            var r = this._data.p1.substract(this._data.center).normalized(), i = this._data.p2.substract(this._data.center).normalized(), t = n.substract(this._data.center).normalized();
            if (n = r.dotProduct(i), r = t.dotProduct(r), t = t.dotProduct(i), r >= n && t >= n)return u
        }
    } else if (4 >= Math.abs(t - this._data.radius) && (t = n.substract(this._data.p1).length(), i = n.substract(this._data.p2).length(), t = Math.max(t, i), i = this._data.p1.substract(this._data.p2).length(), t <= i))return u;
    return null
};
inherit(_77, _90);
_77.prototype._levelsCount = function () {
    return 11
};
_77.prototype.update = function () {
    var o;
    if (_90.prototype.update.call(this), this._levels = [], !(3 > this._points.size())) {
        var i = this._points, r = i.item(0), h = i.item(1), u = i.item(2), i = h.substract(r).normalized(), u = u.substract(r).normalized(), n = new MathEx.Point(1, 0), f = new MathEx.Point(0, 1), t = Math.acos(i.dotProduct(n));
        for (0 > i.dotProduct(f) && (t = 2 * Math.PI - t), this._edge1 = t, n = Math.acos(u.dotProduct(n)), 0 > u.dotProduct(f) && (n = 2 * Math.PI - n), this._edge2 = n, t < n && (this._edge1 = Math.max(t, n), this._edge2 = Math.min(t, n) + 2 * Math.PI), Math.abs(t - n) > Math.PI && (this._edge1 = Math.min(t, n), this._edge2 = Math.max(t, n) - 2 * Math.PI), f = this.J99.properties(), t = 1; t <= this._levelsCount(); t++)if (n = f["level" + t], n.visible.value()) {
            var s = n.coeff.value(), l = n.color.value(), e = h.substract(r).length() * s, c;
            f.showCoeffs.value() && (c = "" + s);
            o = i.add(u).scaled(.5).normalized().scaled(e);
            o = r.add(o);
            this._levels.push({coeff: s, color: l, label: c, radius: e, labelPoint: o, p1: r.add(i.scaled(e)), p2: r.add(u.scaled(e)), linewidth: n.linewidth.value(), linestyle: n.linestyle.value(), index: t})
        }
    }
};
_77.prototype.renderer = function () {
    var u = new CompositeRenderer, i, t, s;
    if (2 > this._points.size())return u;
    var r = this.J99.properties(), n = this._points, e = n.item(0), o = n.item(1), i = {points: (new List).append(e).append(o), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: r.trendline.color.value(), linewidth: r.trendline.linewidth.value(), linestyle: r.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    if (u.append(new TrendLineRenderer(i)), 3 > this._points.size())return this.addAnchors(u), u;
    var f = n.item(2), n = f.data, i = o.substract(e).length();
    for (o.substract(e).normalized(), f = f.substract(e).normalized(), f = e.add(f.scaled(i)), f.data = n, i = {points: (new List).append(e).append(f), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: r.trendline.color.value(), linewidth: r.trendline.linewidth.value(), linestyle: r.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, u.append(new TrendLineRenderer(i)), n = this._levels.length - 1; 0 <= n; n--)i = this._levels[n], t = {}, t.center = this._points.item(0), t.radius = i.radius, t.prevRadius = 0 < n ? this._levels[n - 1].radius : 0, t.edge = this._edge, t.color = i.color, t.linewidth = 1, t.edge1 = this._edge1, t.edge2 = this._edge2, t.p1 = i.p1, t.p2 = i.p2, t.fillBackground = r.fillBackground.value(), t.transparency = r.transparency.value(), s = new HitTestResult(HitTestResult.MOVEPOINT, null, i.index), u.append(new ArcWedgeRenderer(t, s)), r.showCoeffs.value() && (i = {points: (new List).append(i.labelPoint), text: this._levels[n].label, color: this._levels[n].color, vertAlign: "middle", horzAlign: "center", font: r.font.value(), offsetX: 0, offsetY: 0, fontsize: 12, bold: !0}, u.append(new TextRenderer(i, this._rendererCache)));
    return this.isAnchorsRequired() && (n = (new List).append(e).append(o), this.Q0.lineBeingCreated() != this.J99 && n.append(f), u.append(this.createLineAnchor({points: n}))), u
};
TradingView.LineToolFibWedge = function (n, t) {
    this._constructor = "LineToolFibSpeedResistanceArcs";
    var i = t ? t : new _52("linetoolfibwedge");
    J47.call(this, n, new _77(this, n), i)
};
inherit(TradingView.LineToolFibWedge, J47);
TradingView.LineToolFibWedge.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolFibWedge.prototype.title = function () {
    return"Fib Wedge"
};
TradingView.LineToolFibWedge.prototype.setPoint = function (n, t) {
    if (J47.prototype.setPoint.call(this, n, t), !this._recursiveGuard) {
        if (this._recursiveGuard = !0, 2 == n) {
            var i = this.pointToScreenPoint(this._points.item(0))[0], r = this.pointToScreenPoint(this._points.item(1))[0], u = this.pointToScreenPoint(this._points.item(2))[0], u = u.substract(i).length(), r = r.substract(i).normalized(), r = i.add(r.scaled(u)), i = this.priceScale().coordinateToPrice(r.y);
            n = Math.round(this.Q0.timeScale().coordinateToIndex(r.x));
            this.Q2.points[1].price.setValue(i);
            this.Q2.points[1].bar.setValue(n)
        } else {
            var i = this.pointToScreenPoint(this._points.item(0))[0], r = this.pointToScreenPoint(this._points.item(1))[0], u = this.pointToScreenPoint(this._points.item(2))[0], f = r.substract(i).length(), r = u.substract(i).normalized(), u = i.add(r.scaled(f)), i = this.priceScale().coordinateToPrice(u.y);
            n = Math.round(this.Q0.timeScale().coordinateToIndex(u.x));
            this.Q2.points[2].price.setValue(i);
            this.Q2.points[2].bar.setValue(n)
        }
        this._recursiveGuard = !1
    }
};
TradingView.LineToolFibWedge.prototype.addPoint = function (n) {
    var t, i, r;
    return 2 == this._points.size() && (t = this.pointToScreenPoint(this._points.item(0))[0], i = this.pointToScreenPoint(this._points.item(1))[0], this.priceScale().isPercent() && (r = this.ownerSource().firstValue(), n.price = this.priceScale().priceRange().convertFromPercent(n.price, r)), n = this.pointToScreenPoint(n)[0], i = i.substract(t).length(), n = n.substract(t).normalized(), n = t.add(n.scaled(i)), t = this.priceScale().coordinateToPrice(n.y), n = {index: Math.round(this.Q0.timeScale().coordinateToIndex(n.x)), price: t}), J47.prototype.addPoint.call(this, n)
};
TradingView.LineToolFibWedge.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
inherit(J7, _77);
J7.prototype.update = function () {
    _77.prototype.update.call(this)
};
J7.prototype._levelsCount = function () {
    return 1
};
J7.prototype.renderer = function () {
    var r = new CompositeRenderer;
    if (2 > this._points.size())return r;
    var t = this.J99.properties(), f = this._points, i = f.item(0), n = f.item(1), e = {points: (new List).append(i).append(n), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    if (r.append(new TrendLineRenderer(e)), 3 > this._points.size())return this.addAnchors(r), r;
    var u = f.item(2), f = u.data, e = n.substract(i).length();
    return n.substract(i).normalized(), n = u.substract(i).normalized(), u = i.add(n.scaled(e)), u.data = f, e = {points: (new List).append(i).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: t.trendline.color.value(), linewidth: t.linewidth.value(), linestyle: t.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, r.append(new TrendLineRenderer(e)), i = this._levels[0], n = {}, n.center = this._points.item(0), n.radius = i.radius, n.prevRadius = 0, n.edge = this._edge, n.color = t.trendline.color.value(), n.color1 = t.color1.value(), n.color2 = t.color2.value(), n.linewidth = t.linewidth.value(), n.edge1 = this._edge1, n.edge2 = this._edge2, n.p1 = i.p1, n.p2 = i.p2, n.fillBackground = t.fillBackground.value(), n.transparency = t.transparency.value(), n.gradient = !0, r.append(new ArcWedgeRenderer(n)), this.addAnchors(r), r
};
TradingView.LineToolProjection = function (n, t) {
    this._constructor = "LineToolProjection";
    var i = t ? t : new _52("linetoolprojection");
    J47.call(this, n, new J7(this, n), i)
};
inherit(TradingView.LineToolProjection, TradingView.LineToolFibWedge);
TradingView.LineToolProjection.prototype.title = function () {
    return"Projection"
};
inherit(_68, _90);
_68.prototype.renderer = function () {
    var u, f, s, c, e;
    if (!this._wave)return null;
    for (var o = new CompositeRenderer, t = this.J99.properties(), i = t.wavesize.value(), r = this.J99.labels(), n = 0; n < this._wave.length; n++)o.append(new TrendLineRenderer(this._wave[n]));
    if (u = 1, 2 < this._points.size())var f = this._points.item(2), n = this._points.item(1), u = MathEx.sign(f.y - n.y);
    f = [];
    s = 0;
    this.Q0.lineBeingCreated() == this.J99 && (s = 1);
    for (var l = new RGBColor(this.Q0.backgroundColor()).blackWhiteContrast(), h = t.color.value(), n = 0; n < this._points.size() - s; n++, u = -u)c = r[i][n], e = {points: (new List).append(this._points.item(n)), text: c, color: new RGBColor(h).darken("black" == l ? 15 : -15).toHex(), vertAlign: 1 == u ? "top" : "bottom", horzAlign: "center", font: "Arial", offsetX: 0, offsetY: 1 == u ? 5 : -10, fontsize: 12}, f.push(e), t.showBackground.value() && (e.borderColor = h, e.backgroundColor = generateColor(h, 60)), "" != c && o.append(new TextRenderer(e, this._rendererCache[n], new HitTestResult(HitTestResult.CHANGEPOINT, n)));
    if (this.isAnchorsRequired()) {
        for (t = new List, i = 0; i < f.length; i++)r = this._points.item(i).clone(), r.y = f[i].points.item(0).y, r.data = i, t.append(r);
        this.Q0.lineBeingCreated() == this.J99 && 0 < t.size() && t.removeAt(t.size() - 1);
        o.append(this.createLineAnchor({points: t}))
    }
    return o
};
_68.prototype.update = function () {
    var e, s, i, u, n, t;
    _90.prototype.update.call(this);
    this._wave = [];
    var i = this.J99.properties(), r = this.J99.priceScale(), f = this.Q0.timeScale();
    if (r && !r.isEmpty() && !f.isEmpty() && (this.J99.priceScale().isPercent() && (e = this.J99.ownerSource().firstValue()), s = i.color.value(), i.showWave.value()))for (i = this.J99.points(), u = 1; u < i.size(); u++) {
        n = i.item(u - 1);
        t = i.item(u);
        this.Q0.mainSeries().bars().valueAt(n.index);
        this.Q0.mainSeries().bars().valueAt(t.index);
        var o = f.indexToCoordinate(n.index), h = f.indexToCoordinate(t.index), n = n.price, t = t.price;
        this.J99.priceScale().isPercent() && (n = this.J99.priceScale().priceRange().convertToPercent(n, e), t = this.J99.priceScale().priceRange().convertToPercent(t, e));
        n = r.priceToCoordinate(n);
        t = r.priceToCoordinate(t);
        o = {points: (new List).append(new MathEx.Point(o, n)).append(new MathEx.Point(h, t)), width: f.width(), height: r.height(), color: generateColor(s, 0), linewidth: 3, linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_CIRCLE, rightend: J47.LINEEND_CIRCLE, endstyle: {strokeWidth: 1, fillStyle: this.Q0.backgroundColor()}, overlayLineEndings: !0};
        this._wave.push(o)
    }
};
TradingView.LineToolElliott = function (n, t) {
    var i = t ? t : new _52("linetoolelliott");
    J47.call(this, n, new _68(this, n), i)
};
inherit(TradingView.LineToolElliott, J47);
TradingView.LineToolElliott.prototype.title = function () {
    return"Elliott Labels"
};
TradingView.LineToolElliott5Points = function (n, t) {
    var i = t ? t : new _52("linetoolelliott");
    J47.call(this, n, new _68(this, n), i);
    this.version = TradingView.LineToolElliott5Points.version
};
inherit(TradingView.LineToolElliott5Points, TradingView.LineToolElliott);
TradingView.LineToolElliott5Points.version = 2;
TradingView.LineToolElliott5Points.prototype.pointsCount = function () {
    return 6
};
TradingView.LineToolElliott5Points.prototype.labels = function () {
    return[" i ii iii iv v".split(" "), " (i) (ii) (iii) (iv) (v)".split(" "), " ((i)) ((ii)) ((iii)) ((iv)) ((v))".split(" "), " 1 2 3 4 5".split(" "), " (1) (2) (3) (4) (5)".split(" "), " ((1)) ((2)) ((3)) ((4)) ((5))".split(" "), " I II III IV V".split(" "), " (I) (II) (III) (IV) (V)".split(" "), " ((I)) ((II)) ((III)) ((IV)) ((V))".split(" ")]
};
TradingView.LineToolElliott5Points.prototype.migrateVersion = function (n) {
    1 == n && (n = $.extend({}, this._timePoint.item(0)), this._timePoint.insert(n, 0), 0 < this._points.size() && (n = $.extend({}, this._points.item(0)), this._points.insert(n, 0)))
};
TradingView.LineToolElliottSubminuette = function (n, t) {
    this._constructor = "LineToolElliottSubminuette";
    var i = t ? t : new _52("linetoolelliottsubminuette");
    TradingView.LineToolElliott5Points.call(this, n, i)
};
inherit(TradingView.LineToolElliottSubminuette, TradingView.LineToolElliott5Points);
TradingView.LineToolElliottMinor = function (n, t) {
    this._constructor = "LineToolElliottMinor";
    var i = t ? t : new _52("linetoolelliottminor");
    TradingView.LineToolElliott5Points.call(this, n, i)
};
inherit(TradingView.LineToolElliottMinor, TradingView.LineToolElliott5Points);
TradingView.LineToolElliottCircle = function (n, t) {
    this._constructor = "LineToolElliottCircle";
    var i = t ? t : new _52("linetoolelliottcircle");
    TradingView.LineToolElliott5Points.call(this, n, i)
};
inherit(TradingView.LineToolElliottCircle, TradingView.LineToolElliott5Points);
TradingView.LineToolElliott3Points = function (n, t) {
    var i = t ? t : new _52("linetoolelliott");
    J47.call(this, n, new _68(this, n), i);
    this.version = TradingView.LineToolElliott3Points.version
};
inherit(TradingView.LineToolElliott3Points, TradingView.LineToolElliott);
TradingView.LineToolElliott3Points.version = 2;
TradingView.LineToolElliott3Points.prototype.pointsCount = function () {
    return 4
};
TradingView.LineToolElliott3Points.prototype.labels = function () {
    return[
        ["", "a", "b", "c"],
        ["", "A", "B", "C"]
    ]
};
TradingView.LineToolElliott3Points.prototype.migrateVersion = function (n) {
    1 == n && (n = $.extend({}, this._timePoint.item(0)), this._timePoint.insert(n, 0), 0 < this._points.size() && (n = $.extend({}, this._points.item(0)), this._points.insert(n, 0)))
};
TradingView.LineToolElliottMinorRetr = function (n, t) {
    this._constructor = "LineToolElliottMinorRetr";
    var i = t ? t : new _52("linetoolelliottminorretr");
    TradingView.LineToolElliott3Points.call(this, n, i)
};
inherit(TradingView.LineToolElliottMinorRetr, TradingView.LineToolElliott3Points);
TradingView.LineToolElliottMajorRetr = function (n, t) {
    this._constructor = "LineToolElliottMajorRetr";
    var i = t ? t : new _52("linetoolelliottmajorretr");
    TradingView.LineToolElliott3Points.call(this, n, i)
};
inherit(TradingView.LineToolElliottMajorRetr, TradingView.LineToolElliott3Points);
inherit(_93, _90);
_93.prototype.update = function () {
    var i, r;
    if (_90.prototype.update.call(this), !(2 > this.J99.points().size()) && (i = this.Q0.timeScale(), this.J99.priceScale() && !this.J99.priceScale().isEmpty() && !i.isEmpty())) {
        var n = this.J99.points().item(0), t = this.J99.points().item(1), t = t ? t.index - n.index : 1;
        if (this._lines = [], 0 !== t)if (r = i.visibleBars(), 0 < t)for (n = n.index; n <= r.lastBar(); n += t)this._lines.push({x: i.indexToCoordinate(n)}); else for (n = n.index; n >= r.firstBar(); n += t)this._lines.push({x: i.indexToCoordinate(n)})
    }
};
_93.prototype.renderer = function () {
    var t = new CompositeRenderer;
    if (2 > this._points.size())return t;
    var i = this._points.item(0), r = this._points.item(1), n = this.J99.properties(), n = {points: (new List).append(i).append(r), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: n.trendline.color.value(), linewidth: n.trendline.linewidth.value(), linestyle: n.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    for (t.append(new TrendLineRenderer(n)), n = this.J99.properties(), i = 0; i < this._lines.length; i++)r = {points: (new List).append(new MathEx.Point(this._lines[i].x, 0)), color: n.linecolor.value(), linewidth: n.linewidth.value(), linestyle: n.linestyle.value()}, t.append(new VertLineRenderer(r));
    return this.isAnchorsRequired() && (2 === this.J99.points().size() ? (n = this._points.clone(), t.append(this.createLineAnchor({points: n}))) : (n = new List, n.append(new MathEx.Point(this._points.item(0).x, this.J99.priceScale().height() / 2)), t.append(this.createLineAnchor({points: n, hittestResult: HitTestResult.MOVEPOINT})))), t
};
TradingView.LineToolCircleLines = function (n, t) {
    this._constructor = "LineToolCircleLines";
    var i = t ? t : new _52("linetoolcirclelines");
    J47.call(this, n, new _93(this, n), i)
};
inherit(TradingView.LineToolCircleLines, J47);
TradingView.LineToolCircleLines.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolCircleLines.prototype.title = function () {
    return"Cyclic Lines"
};
TradingView.LineToolVbPFixed = function (n, t, i) {
    var u = TradingView.Study.lineToolNameForPointsBasedStudy("VbPFixed@tv-volumebyprice"), r;
    i = i ? i : StudyMetaInfo.findStudyMetaInfo(n.studiesMetaData(), "VbPFixed@tv-volumebyprice");
    r = n.studyVersioning();
    t = t ? t : TradingView.prepareStudyProperties(i, null, null, r);
    var r = new J31(this, n), f = new TradingView.Study.StudyPaneView_hhists(this, n), e = new TradingView.Study.StudyPaneView_horizlines(this, n), o = new TradingView.Study.StudyPaneView_polygons(this, n);
    D63.call(this, n, [r, f, e, o], t, u);
    this._turnaroundCounter = 1;
    this._turnaround = "vbpfixed_" + this._turnaroundCounter;
    this._metaInfo = i;
    this._graphics = new D62(i);
    this._formatter = new VolumeFormatter
};
inherit(TradingView.LineToolVbPFixed, D63);
TradingView.LineToolVbPFixed.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolVbPFixed.prototype._requestStudy = function () {
    var t = this.points().item(0), n = this.points().item(1), i = Math.min(t.index, n.index), t = Math.max(t.index, n.index), r;
    i === t ? this.clearData() : (i = this.Q0.mainSeries().bars().valueAt(i), t = this.Q0.mainSeries().bars().valueAt(t), i && t) && (i = 1e3 * i[TIME_PLOT], t = 1e3 * t[TIME_PLOT], n = [], n.push(this.properties().inputs.rows.value()), n.push(this.properties().inputs.volume.value()), n.push(i), n.push(t), n.push(this.properties().inputs.vaVolume.value()), r = this, this._studyId ? (this._turnaround = "vbpfixed_" + ++this._turnaroundCounter, this.Q0.chartApi().modifyStudy(this._studyId, this._turnaround, n, function (n) {
        r.onData(n)
    })) : (this._studyId = TradingView.Study.makeNextStudyId(), this.Q0.chartApi().createStudy(this._studyId, this._turnaround, this.Q0.mainSeries()._seriesId, this._metaInfo.id + "-1!", n, function (n) {
        r.onData(n)
    })))
};
TradingView.LineToolVbPFixed.prototype.onData = function (n) {
    "data_update" === n.method && n.params.customId === "pointset_" + this._currentPointsetId ? (J47.prototype.onData.call(this, n), 2 == this._points.size() && this._requestStudy()) : "data_update" === n.method && n.params.customId === this._studyId && this._checkTurnaround(n.params.turnaround) && (n.params.nonseries.d = "" !== n.params.nonseries.d ? JSON.parse(n.params.nonseries.d) : "", "" !== n.params.nonseries.d && (this._graphics.process(n.params.nonseries), this._correctPoints(this._graphics.graphics())), 0 < n.params.nonseries.indexes.length && (this._indexes = n.params.nonseries.indexes), this.updateAllViews(), this.Q0.updateSource(this))
};
TradingView.LineToolVbPFixed.prototype._correctPoints = function (n) {
    var u, f;
    if (n && (void 0 == n.indexes || 0 != n.indexes.length)) {
        n = n.hhists["0"].data;
        for (var t = null, i = null, r = 0; r < n.length; ++r)u = n[r].priceLow, f = n[r].priceHigh, (!t || u < t) && (t = u), (!i || f > i) && (i = f);
        this._points.item(0).price = i;
        this._points.item(1).price = t
    }
};
TradingView.LineToolVbPFixed.prototype.calcIsActualSymbol = function () {
    this._isActualSymbol = !0
};
TradingView.LineToolVbPFixed.prototype.formatter = function () {
    return this._formatter
};
J9 = function (n, t) {
    _90.call(this, n, t);
    this._rendererCache = {}
};
inherit(J9, _90);
J9.prototype._formatInTicks = function (n) {
    var t = this.Q0.mainSeries().base();
    return Math.round(n * t)
};
J9.INDEX_ENTRY = 0;
J9.INDEX_CLOSE = 1;
J9.INDEX_ACTUALENTRY = 2;
J9.INDEX_ACTUALCLOSE = 3;
J9.prototype.update = function () {
    var n, t, i;
    if (_90.prototype.update.call(this), this._profitLevel = this._stopLevel = null, n = this.Q0.timeScale(), t = this.J99.priceScale(), t && !t.isEmpty() && !n.isEmpty() && 0 != this.J99.points().size() && 0 != this._points.size() && this.Q0.mainSeries().bars().last() && !(2 > this.J99.points().size()) && 0 != this.Q0.mainSeries().bars().size()) {
        if (this._isClosed = 4 == this.J99.points().size()) {
            if (n = this.J99.points().item(J9.INDEX_ACTUALCLOSE).price, this.J99.points().item(J9.INDEX_ACTUALCLOSE).index < parseInt(this.J99.Q0.mainSeries().bars().first()))return;
            i = Math.min(parseInt(this.J99.Q0.mainSeries().bars().last()), this.J99.points().item(J9.INDEX_ACTUALCLOSE).index)
        } else {
            if (this.J99.points().item(J9.INDEX_CLOSE).index < parseInt(this.J99.Q0.mainSeries().bars().first()))return;
            i = Math.min(parseInt(this.J99.Q0.mainSeries().bars().last()), this.J99.points().item(J9.INDEX_CLOSE).index);
            n = this.Q0.mainSeries().bars().valueAt(i)[CLOSE_PLOT]
        }
        this._closeBar = this.J99.Q0.timeScale().indexToCoordinate(i);
        var r = this.J99.priceScale(), f = this.J99.stopPrice(), e = this.J99.profitPrice();
        if (this._pl = 1 < this.J99.points().size() ? this.J99.calculatePL(n) : 0, r.isPercent())var u = this.J99.ownerSource().firstValue(), f = r.priceRange().convertToPercent(f, u), e = r.priceRange().convertToPercent(e, u), n = r.priceRange().convertToPercent(n, u);
        this._entryLevel = this._points.item(J9.INDEX_ENTRY).y;
        this._stopLevel = t.priceToCoordinate(f);
        this._profitLevel = t.priceToCoordinate(e);
        this._closeLevel = t.priceToCoordinate(n);
        this._closeBar = this.J99.Q0.timeScale().indexToCoordinate(i)
    }
};
J9.prototype.renderer = function () {
    var h = new CompositeRenderer, c, r, f;
    if (2 > this._points.size() || 2 > this.J99.points().size())return h;
    c = this;
    r = this.J99.properties();
    this.Q0.timeScale();
    var e = this._points.item(J9.INDEX_ENTRY).x, o = this._points.item(J9.INDEX_ACTUALENTRY) ? this._points.item(J9.INDEX_ACTUALENTRY).x : this._points.item(J9.INDEX_CLOSE).x, u = this._points.item(J9.INDEX_ACTUALCLOSE) ? this._points.item(J9.INDEX_ACTUALCLOSE).x : this._points.item(J9.INDEX_CLOSE).x, s = this._points.item(J9.INDEX_CLOSE).x, i = new MathEx.Point(e, this._entryLevel), t = new MathEx.Point(s, this._stopLevel), n = {};
    n.points = (new List).append(i).append(t);
    n.color = "white";
    n.linewidth = 0;
    n.backcolor = r.stopBackground.value();
    n.fillBackground = !0;
    n.transparency = r.stopBackgroundTransparency.value();
    h.append(new RectangleRenderer(n));
    0 > this._pl && (i = new MathEx.Point(o, this._entryLevel), t = new MathEx.Point(u, this._closeLevel), n = {}, n.points = (new List).append(i).append(t), n.color = "white", n.linewidth = 0, n.backcolor = r.stopBackground.value(), n.fillBackground = !0, f = .01 * r.stopBackgroundTransparency.value(), n.transparency = 100 - 100 * (1 - f * f * f), h.append(new RectangleRenderer(n)));
    i = new MathEx.Point(e, this._entryLevel);
    t = new MathEx.Point(s, this._profitLevel);
    n = {};
    n.points = (new List).append(i).append(t);
    n.color = "white";
    n.linewidth = 0;
    n.backcolor = r.profitBackground.value();
    n.fillBackground = !0;
    n.transparency = r.profitBackgroundTransparency.value();
    h.append(new RectangleRenderer(n));
    0 < this._pl && (i = new MathEx.Point(o, this._entryLevel), t = new MathEx.Point(u, this._closeLevel), n = {}, n.points = (new List).append(i).append(t), n.color = "white", n.linewidth = 0, n.backcolor = r.profitBackground.value(), n.fillBackground = !0, f = .01 * r.profitBackgroundTransparency.value(), n.transparency = 100 - 100 * (1 - f * f * f), h.append(new RectangleRenderer(n)));
    o = function (n, t, i) {
        var r = {};
        r.points = (new List).append(n).append(t);
        r.width = c.Q0.timeScale().width();
        r.height = c.J99.priceScale().height();
        r.color = i ? i : c.J99.properties().linecolor.value();
        r.linewidth = c.J99.properties().linewidth.value();
        r.linestyle = CanvasEx.LINESTYLE_SOLID;
        r.extendleft = !1;
        r.extendright = !1;
        r.leftend = J47.LINEEND_NORMAL;
        r.rightend = J47.LINEEND_NORMAL;
        h.append(new TrendLineRenderer(r))
    };
    this._points.item(J9.INDEX_ACTUALENTRY) && (i = this._points.item(J9.INDEX_ACTUALENTRY), t = this._isClosed ? this._points.item(J9.INDEX_ACTUALCLOSE) : new MathEx.Point(this._closeBar, this._closeLevel), n = {}, n.points = (new List).append(i).append(t), n.width = c.Q0.timeScale().width(), n.height = c.J99.priceScale().height(), n.color = c.J99.properties().linecolor.value(), n.linewidth = 1, n.linestyle = CanvasEx.LINESTYLE_DASHED, n.extendleft = !1, n.extendright = !1, n.leftend = J47.LINEEND_NORMAL, n.rightend = J47.LINEEND_ARROW, h.append(new TrendLineRenderer(n)));
    var c = this, n = function (n, t, i, u, f, e) {
        if (c.isAnchorsRequired() || TradingView.printing) {
            var o = {};
            o.points = (new List).append(n);
            o.text = t;
            o.color = r.textcolor.value();
            o.font = r.font.value();
            o.offsetX = 3;
            o.offsetY = f;
            o.vertAlign = u;
            o.horzAlign = "center";
            o.backgroundRoundRect = 4;
            o.backgroundColor = i;
            o.fontsize = r.fontsize.value();
            o.backgroundHorzInflate = 4;
            o.backgroundVertInflate = 2;
            e && (o.borderColor = e);
            h.append(new TextRenderer(o, c._rendererCache))
        }
    }, u = this.J99.entryPrice(), f = this.J99.stopPrice(), i = this.J99.profitPrice(), a = Math.abs(f - u), y = Math.round(1e4 * a / u) / 100, v = Math.abs(i - u), p = Math.round(1e4 * v / u) / 100, l = Math.abs(u - i) / Math.abs(u - f), i = new MathEx.Point(e, this._points.item(J9.INDEX_ENTRY).y), t = new MathEx.Point(s, this._points.item(J9.INDEX_ENTRY).y);
    return o(i, t), i = new MathEx.Point((e + s) / 2, Math.round(this._points.item(0).y) + .5), t = "", this._points.item(1) && void 0 !== this._pl && (t = this._isClosed ? " " + $.t("Closed", {context: "line_tool_position"}) : $.t("Open", {context: "line_tool_position"}), t = $.t("{0} P&L: {1}").format(t, this.J99.priceScale().formatter().format(this._pl)) + "\n"), t += $.t("Risk/Reward Ratio: {0}").format(Math.round(100 * l) / 100) + " ", l = r.linecolor.value(), 0 > this._pl ? l = r.stopBackground.value() : 0 < this._pl && (l = r.profitBackground.value()), n(i, t, l, "middle", 0, "white"), i = new MathEx.Point(e, this._stopLevel), t = new MathEx.Point(s, this._stopLevel), o(i, t, r.stopBackground.value()), i = new MathEx.Point((e + s) / 2, this._stopLevel), t = $.t("Stop: {0} ({1}%)").format(this.J99.priceScale().formatter().format(a), y), n(i, t, r.stopBackground.value(), u < f ? "bottom" : "top", u < f ? -12 : -1), i = new MathEx.Point(e, this._profitLevel), t = new MathEx.Point(s, this._profitLevel), o(i, t, r.profitBackground.value()), i = new MathEx.Point((e + s) / 2, this._profitLevel), t = $.t("Target: {0} ({1}%)").format(this.J99.priceScale().formatter().format(v), p), n(i, t, r.profitBackground.value(), u < f ? "top" : "bottom", u < f ? -1 : -12), this.isAnchorsRequired() && (o = new List, n = this._points.item(0).clone(), n.data = 0, o.append(n), u = new MathEx.Point(e, this._stopLevel), u.data = 1, o.append(u), e = new MathEx.Point(e, this._profitLevel), e.data = 2, o.append(e), s = new MathEx.Point(s, n.y), s.data = 3, o.append(s), h.append(this.createLineAnchor({points: o}))), h
};
inherit(LineToolRiskRewardPriceAxisView, PriceAxisView);
LineToolRiskRewardPriceAxisView.prototype.update = function () {
    if (0 !== this.J99.points().size() && this.J99.priceScale() && !this.J99.priceScale().isEmpty()) {
        var n = this.J99.properties()[this._pricePropName].value();
        this._background = this.J99.properties()[this._colorPropName].value();
        this._coordinate = this.J99.priceScale().priceToCoordinate(n);
        this._textHeight = this.J99.priceScale().m_markBuilder.fontHeight();
        this._text = this.J99.priceScale().formatter().format(n)
    }
};
LineToolRiskRewardPriceAxisView.prototype.renderer = function () {
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: !0};
    return new PriceAxisViewRenderer(n)
};
TradingView.LineToolRiskReward = function (n, t) {
    var i = t ? t : new _52("linetoolriskreward"), e;
    if (J47.call(this, n, new J9(this, n), i), this.Q2.addExclusion && (this.Q2.addExclusion("stopLevel"), this.Q2.addExclusion("profitLevel")), !t.stopLevel && !t.profitLevel) {
        var f = n.timeScale().visibleBars(), u = f.firstBar(), f = f.lastBar(), r = n.mainSeries().priceRange(u, f), u = n.mainSeries().priceScale();
        if (u.isLog() && (f = u.logicalToPrice(r.minValue()), r = u.logicalToPrice(r.maxValue()), r = new PriceRange(f, r)), u.isPercent())var o = n.mainSeries().firstValue(), f = u.priceRange().convertFromPercent(r.minValue(), o), r = u.priceRange().convertFromPercent(r.maxValue(), o), r = new PriceRange(f, r);
        r && !r.isEmpty() && (u = Math.round(.2 * r.length() * n.mainSeries().base()), i.merge({stopLevel: u, profitLevel: u}))
    }
    e = this;
    i.stopLevel.listeners().subscribe(this, TradingView.LineToolRiskReward.prototype.recalculate);
    i.stopLevel.listeners().subscribe(null, function () {
        e.properties().stopPrice._listeners.fire(e.properties().stopPrice)
    });
    i.profitLevel.listeners().subscribe(this, TradingView.LineToolRiskReward.prototype.recalculate);
    i.profitLevel.listeners().subscribe(null, function () {
        e.properties().targetPrice._listeners.fire(e.properties().targetPrice)
    });
    i.addProperty("entryPrice");
    i.entryPrice = new TradingView.LineToolRiskReward.PriceProperty(this, 0);
    i.addProperty("stopPrice");
    i.stopPrice = new TradingView.LineToolRiskReward.StopPriceProperty(this);
    i.addProperty("targetPrice");
    i.targetPrice = new TradingView.LineToolRiskReward.TargetPriceProperty(this);
    this._entryPriceAxisView = new LineToolRiskRewardPriceAxisView(this, n, "entryPrice", "linecolor");
    this._stopPriceAxisView = new LineToolRiskRewardPriceAxisView(this, n, "stopPrice", "stopBackground");
    this._profitPriceAxisView = new LineToolRiskRewardPriceAxisView(this, n, "targetPrice", "profitBackground");
    this.version = TradingView.LineToolRiskReward.version
};
inherit(TradingView.LineToolRiskReward, J47);
TradingView.LineToolRiskReward.version = 2;
TradingView.LineToolRiskReward.prototype.migrateVersion = function (n, t, i) {
    1 == n && 1 <= this._points.size() && (n = new List, n.append(this._points.item(0)), t = this._points.item(0), t = {price: t.price, index: t.index + 50}, n.append(t), this._points.item(1) && n.append(this._points.item(1)), this._points.item(2) && n.append(this._points.item(2)), this._points = n, 1 <= this._timePoint.size() && (i = new List, t = this._timePoint.item(0), i.append(t), i.append({price: t.price, time_t: t.time_t, offset: t.offset + 50}), this._timePoint.item(1) && n.append(this._points.item(1)), this._timePoint.item(2) && n.append(this._points.item(2)), this._timePoint = i))
};
TradingView.LineToolRiskReward.prototype.checkAlert = function () {
    this.recalculate()
};
TradingView.LineToolRiskReward.prototype.priceAxisViews = function (n, t) {
    return this._isActualSymbol ? this.Q0.paneForSource(this) === n && t === this.priceScale() ? (new List).append(this._entryPriceAxisView).append(this._stopPriceAxisView).append(this._profitPriceAxisView) : null : null
};
TradingView.LineToolRiskReward.prototype.updateAllViews = function () {
    !this._isActualSymbol || !this.Q2.visible.value() || TradingView.drawingState.hideAllDrawings().value() && this.userEditEnabled() || (J47.prototype.updateAllViews.call(this), this._entryPriceAxisView.update(), this._stopPriceAxisView.update(), this._profitPriceAxisView.update())
};
TradingView.LineToolRiskReward.prototype.setPoint = function (n, t) {
    var i = this.priceScale(), r;
    i.isPercent() && (r = this.ownerSource().firstValue(), t.price = i.priceRange().convertFromPercent(t.price, r));
    switch (n) {
        case 0:
            t.price = this._roundPrice(t.price);
            i.isPercent() && (t.price = i.priceRange().convertToPercent(t.price, r));
            J47.prototype.setPoint.call(this, n, t);
            this.recalculate();
            break;
        case 1:
            this.properties().stopPrice.setValue(this.preparseStopPrice(t.price));
            break;
        case 2:
            this.properties().targetPrice.setValue(this.preparseProfitPrice(t.price));
            break;
        case 3:
            t.price = this._roundPrice(t.price);
            i.isPercent() && (t.price = i.priceRange().convertToPercent(t.price, r));
            J47.prototype.setPoint.call(this, 1, t);
            this.recalculate()
    }
};
TradingView.LineToolRiskReward.PriceProperty = function (n, t) {
    J47.PointPriceProperty.call(this, n, t)
};
inherit(TradingView.LineToolRiskReward.PriceProperty, J47.PointPriceProperty);
TradingView.LineToolRiskReward.PriceProperty.prototype.setValue = function (n) {
    var t = this._lineSource.points().item(this._pointIndex);
    t.price = parseFloat(n);
    this._lineSource.setPoint(this._pointIndex, t);
    this._lineSource.recalculate();
    this._lineSource.Q0.updateSource(this._lineSource);
    this._listeners.fire(this);
    this._lineSource.endChanging()
};
TradingView.LineToolRiskReward.StopPriceProperty = function (n) {
    TradingView.LineToolRiskReward.PriceProperty.call(this, n, 1)
};
inherit(TradingView.LineToolRiskReward.StopPriceProperty, TradingView.LineToolRiskReward.PriceProperty);
TradingView.LineToolRiskReward.StopPriceProperty.prototype.value = function () {
    var n = this._lineSource.stopPrice();
    return parseFloat(this._lineSource.priceScale().formatter().format(n))
};
TradingView.LineToolRiskReward.StopPriceProperty.prototype.setValue = function (n) {
    n = Math.round(Math.abs(n - this._lineSource.entryPrice()) * this._lineSource.Q0.mainSeries().base());
    this._lineSource.properties().stopLevel.setValue(n);
    this._lineSource.properties().stopLevel.listeners().fire(this._lineSource.properties().stopLevel)
};
TradingView.LineToolRiskReward.TargetPriceProperty = function (n) {
    TradingView.LineToolRiskReward.PriceProperty.call(this, n, 2)
};
inherit(TradingView.LineToolRiskReward.TargetPriceProperty, TradingView.LineToolRiskReward.PriceProperty);
TradingView.LineToolRiskReward.TargetPriceProperty.prototype.value = function () {
    var n = this._lineSource.profitPrice();
    return parseFloat(this._lineSource.priceScale().formatter().format(n))
};
TradingView.LineToolRiskReward.TargetPriceProperty.prototype.setValue = function (n) {
    n = Math.round(Math.abs(n - this._lineSource.entryPrice()) * this._lineSource.Q0.mainSeries().base());
    this._lineSource.properties().profitLevel.setValue(n);
    this._lineSource.properties().profitLevel.listeners().fire(this._lineSource.properties().profitLevel)
};
TradingView.LineToolRiskReward.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolRiskReward.prototype.title = function () {
    return"Risk/Reward"
};
TradingView.LineToolRiskReward.prototype.addPoint = function (n) {
    var t = this.priceScale(), i;
    return t.isPercent() && (i = this.ownerSource().firstValue(), n.price = t.priceRange().convertFromPercent(n.price, i)), n.price = this._roundPrice(n.price), this._points.append(n), t = {price: n.price, index: n.index + 50}, this._points.append(t), (n = this.calculateActualEntry(n, t)) && (this._points.append(n), (t = this.findClosePoint(n, t)) && this._points.append(t)), this._lastPoint = null, this.normalizePoints(), this.createServerPoints(), !0
};
TradingView.LineToolRiskReward.prototype._roundPrice = function (n) {
    var t = this.Q0.mainSeries().base();
    return Math.round(n * t) / t
};
TradingView.LineToolRiskReward.prototype.recalculate = function () {
    var n;
    if (this.properties().interval.value() == this.Q0.mainSeries().interval() && 0 != this.points().size()) {
        var i = this.properties().targetPrice.value(), r = this.properties().stopPrice.value(), t = new List;
        t.append(this._points.item(0));
        t.append(this._points.item(1));
        n = this.calculateActualEntry(this.points().item(0), this.points().item(1));
        n && (t.append(n), (n = this.findClosePoint(n, this.points().item(1))) && t.append(n));
        this._points = t;
        i !== this.properties().targetPrice.value() && this.properties().targetPrice._listeners.fire(this.properties().targetPrice);
        r !== this.properties().stopPrice.value() && this.properties().stopPrice._listeners.fire(this.properties().stopPrice)
    }
};
TradingView.LineToolRiskReward.prototype.startMoving = function (n) {
    n.price = this._roundPrice(n.price);
    J47.prototype.startMoving.call(this, n)
};
TradingView.LineToolRiskReward.prototype.move = function (n) {
    n.price = this._roundPrice(n.price);
    J47.prototype.move.call(this, n);
    this.recalculate();
    this._entryPriceAxisView.update()
};
TradingView.LineToolRiskReward.prototype.correctPoints = function (n) {
    J47.prototype.correctPoints.call(this, (new List).append(n.item(0)).append(n.item(1)))
};
TradingView.LineToolRiskReward.prototype.entryPrice = function () {
    return this.points().item(0).price
};
TradingView.LineToolRiskReward.prototype.findClosePoint = function (n, t) {
    for (var i, u = this.Q0.mainSeries().bars(), f = parseInt(u.first(), 10), r = Math.max(n.index, f), f = parseInt(u.last(), 10); r <= Math.min(f, t.index); r++)if (i = u.valueAt(r), i = this.checkStopPrice(i), null != i)return{index: r, price: i};
    return null
};
TradingView.LineToolRiskReward.prototype.calculateActualEntry = function (n, t) {
    for (var f, u = this.Q0.mainSeries().bars(), i = parseInt(u.first(), 10), r = Math.max(n.index, i), i = n.price, e = parseInt(u.last(), 10); r <= Math.min(e, t.index); r++)if (f = u.valueAt(r), f[HIGH_PLOT] >= i && f[LOW_PLOT] <= i)return{index: r, price: i};
    return null
};
TradingView.LineToolRiskRewardShort = function (n, t) {
    this._constructor = "LineToolRiskRewardShort";
    var i = t ? t : new _52("linetoolriskrewardshort");
    TradingView.LineToolRiskReward.call(this, n, i)
};
inherit(TradingView.LineToolRiskRewardShort, TradingView.LineToolRiskReward);
TradingView.LineToolRiskRewardShort.prototype.title = function () {
    return"Risk/Reward short"
};
TradingView.LineToolRiskRewardShort.prototype.stopPrice = function () {
    return this.entryPrice() + this.properties().stopLevel.value() / this.Q0.mainSeries().base()
};
TradingView.LineToolRiskRewardShort.prototype.profitPrice = function () {
    return this.entryPrice() - this.properties().profitLevel.value() / this.Q0.mainSeries().base()
};
TradingView.LineToolRiskRewardShort.prototype.calculatePL = function (n) {
    return this.entryPrice() - n
};
TradingView.LineToolRiskRewardShort.prototype.preparseStopPrice = function (n) {
    n = this._roundPrice(n);
    var t = this.entryPrice() + 1 / this.Q0.mainSeries().base();
    return Math.max(n, t)
};
TradingView.LineToolRiskRewardShort.prototype.preparseProfitPrice = function (n) {
    n = this._roundPrice(n);
    var t = this.entryPrice() - 1 / this.Q0.mainSeries().base();
    return Math.min(n, t)
};
TradingView.LineToolRiskRewardShort.prototype.checkStopPrice = function (n) {
    var t = this.stopPrice(), i = this.profitPrice();
    return n[HIGH_PLOT] >= t ? this.stopPrice() : n[LOW_PLOT] <= i ? this.profitPrice() : null
};
TradingView.LineToolRiskRewardLong = function (n, t) {
    this._constructor = "LineToolRiskRewardLong";
    var i = t ? t : new _52("linetoolriskrewardlong");
    TradingView.LineToolRiskReward.call(this, n, i)
};
inherit(TradingView.LineToolRiskRewardLong, TradingView.LineToolRiskReward);
TradingView.LineToolRiskRewardLong.prototype.stopPrice = function () {
    return this.entryPrice() - this.properties().stopLevel.value() / this.Q0.mainSeries().base()
};
TradingView.LineToolRiskRewardLong.prototype.profitPrice = function () {
    return this.entryPrice() + this.properties().profitLevel.value() / this.Q0.mainSeries().base()
};
TradingView.LineToolRiskRewardLong.prototype.calculatePL = function (n) {
    return n - this.entryPrice()
};
TradingView.LineToolRiskRewardLong.prototype.preparseStopPrice = function (n) {
    n = this._roundPrice(n);
    var t = this.entryPrice() - 1 / this.Q0.mainSeries().base();
    return Math.min(n, t)
};
TradingView.LineToolRiskRewardLong.prototype.preparseProfitPrice = function (n) {
    n = this._roundPrice(n);
    var t = this.entryPrice() + 1 / this.Q0.mainSeries().base();
    return Math.max(n, t)
};
TradingView.LineToolRiskRewardLong.prototype.checkStopPrice = function (n) {
    var t = this.stopPrice(), i = this.profitPrice();
    return n[LOW_PLOT] <= t ? this.stopPrice() : n[HIGH_PLOT] >= i ? this.profitPrice() : null
};
TradingView.LineToolRiskRewardLong.prototype.title = function () {
    return"Risk/Reward long"
};
inherit(_99, _90);
_99.prototype.renderer = function () {
    if (2 > this._points.size())return null;
    var i = this.J99.properties(), r = new CompositeRenderer, n = new List;
    n.append(this._points.item(0));
    n.append(this._points.item(1));
    n.append(3 > this._points.size() ? this._points.item(1) : this._points.item(2));
    var f = this, u = function (n, t) {
        return{points: (new List).append(n), text: t, color: i.textcolor.value(), vertAlign: "middle", horzAlign: "center", font: i.font.value(), offsetX: 0, offsetY: 0, bold: i.bold && i.bold.value(), italic: i.italic && i.italic.value(), fontsize: i.fontsize.value(), backgroundColor: f.J99.properties().color.value(), backgroundRoundRect: 4}
    }, e = function (n, t) {
        return{points: (new List).append(n).append(t), width: f.Q0.timeScale().width(), height: f.J99.priceScale().height(), color: f.J99.properties().color.value(), linewidth: 1, linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}
    }, t = {};
    return t.points = n, t.color = i.color.value(), t.linewidth = i.linewidth.value(), t.backcolor = i.backgroundColor.value(), t.fillBackground = i.fillBackground.value(), t.transparency = i.transparency.value(), r.append(new TriangleRenderer(t)), 3 < this._points.size() && (n = new List, n.append(this._points.item(2)), n.append(this._points.item(3)), n.append(5 == this._points.size() ? this._points.item(4) : this._points.item(3)), t = {}, t.points = n, t.color = i.color.value(), t.linewidth = i.linewidth.value(), t.backcolor = i.backgroundColor.value(), t.fillBackground = i.fillBackground.value(), t.transparency = i.transparency.value(), r.append(new TriangleRenderer(t))), 3 <= this._points.size() && (n = this._points.item(0).add(this._points.item(2)).scaled(.5), n = u(n, this._ABRetracement), r.append(new TextRenderer(n, this._rendererCache))), 4 <= this._points.size() && (n = this._points.item(1).add(this._points.item(3)).scaled(.5), t = e(this._points.item(1), this._points.item(3)), r.append(new TrendLineRenderer(t)), n = u(n, this._BCRetracement), r.append(new TextRenderer(n, this._rendererCache))), 5 <= this._points.size() && (n = this._points.item(2).add(this._points.item(4)).scaled(.5), n = u(n, this._CDRetracement), r.append(new TextRenderer(n, this._rendererCache)), t = e(this._points.item(0), this._points.item(4)), r.append(new TrendLineRenderer(t)), n = this._points.item(0).add(this._points.item(4)).scaled(.5), n = u(n, this._XDRetracement), r.append(new TextRenderer(n, this._rendererCache))), n = u(this._points.item(0), "X"), this._points.item(1).y > this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache)), n = u(this._points.item(1), "A"), this._points.item(1).y < this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache)), 2 < this._points.size() && (n = u(this._points.item(2), "B"), this._points.item(2).y < this._points.item(1).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache))), 3 < this._points.size() && (n = u(this._points.item(3), "C"), this._points.item(3).y < this._points.item(2).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache))), 4 < this._points.size() && (n = u(this._points.item(4), "D"), this._points.item(4).y < this._points.item(3).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && (n = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), r.append(this.createLineAnchor({points: n}))), r
};
_99.prototype.update = function () {
    var i, r;
    if (_90.prototype.update.call(this), 3 <= this.J99.points().size()) {
        var u = this.J99.points().item(0), n = this.J99.points().item(1), t = this.J99.points().item(2);
        this._ABRetracement = Math.round(1e3 * Math.abs((t.price - n.price) / (n.price - u.price))) / 1e3
    }
    4 <= this.J99.points().size() && (i = this.J99.points().item(3), this._BCRetracement = Math.round(1e3 * Math.abs((i.price - t.price) / (t.price - n.price))) / 1e3);
    5 <= this.J99.points().size() && (r = this.J99.points().item(4), this._CDRetracement = Math.round(1e3 * Math.abs((r.price - i.price) / (i.price - t.price))) / 1e3, this._XDRetracement = Math.round(1e3 * Math.abs((r.price - n.price) / (n.price - u.price))) / 1e3)
};
TradingView.LineTool5PointsPattern = function (n, t) {
    this._constructor = "LineTool5PointsPattern";
    var i = t ? t : new _52("linetool5pointspattern");
    J47.call(this, n, new _99(this, n), i)
};
inherit(TradingView.LineTool5PointsPattern, J47);
TradingView.LineTool5PointsPattern.prototype.pointsCount = function () {
    return 5
};
TradingView.LineTool5PointsPattern.prototype.title = function () {
    return"XABCD Pattern"
};
TradingView.LineTool5PointsPattern.prototype._tooltipFieldsHash = {time0: {title: "Date 1", value: null}, price0: {title: "Price 1", value: null}, time1: {title: "Date 2", value: null}, price1: {title: "Price 2", value: null}, time2: {title: "Date 3", value: null}, price2: {title: "Price 3", value: null}, time3: {title: "Date 4", value: null}, price3: {title: "Price 4", value: null}, time4: {title: "Date 5", value: null}, price4: {title: "Price 5", value: null}};
TradingView.LineTool5PointsPattern.prototype._updateTooltip = function () {
    var i = this._tooltipFieldsHash, n = this.points().m_values, t, r;
    n[0] && (t = this.Q0.timeScale().indexToUserTime(n[0].index), i.time0.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price0.value = this.Q0.mainSeries()._formatter.format(n[0].price));
    n[1] && (r = this.Q0.timeScale().indexToUserTime(n[1].index), i.time1.value = r ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(r) : 0, i.price1.value = this.Q0.mainSeries()._formatter.format(n[1].price));
    n[2] && (t = this.Q0.timeScale().indexToUserTime(n[2].index), i.time2.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price2.value = this.Q0.mainSeries()._formatter.format(n[2].price));
    n[3] && (t = this.Q0.timeScale().indexToUserTime(n[3].index), i.time3.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price3.value = this.Q0.mainSeries()._formatter.format(n[3].price));
    n[4] && (t = this.Q0.timeScale().indexToUserTime(n[4].index), i.time4.value = r ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price4.value = this.Q0.mainSeries()._formatter.format(n[4].price))
};
TradingView.LineTool5PointsPattern.prototype.tooltip = function () {
    return this._updateTooltip(), this._formatTooltip()
};
inherit(_91, _90);
_91.prototype.renderer = function () {
    if (2 > this._points.size())return null;
    var r = this.J99.properties(), i = new CompositeRenderer, t = this._points, e = this, u = function (n, t) {
        return{points: (new List).append(n), text: t, color: r.textcolor.value(), vertAlign: "middle", horzAlign: "center", font: r.font.value(), offsetX: 0, offsetY: 0, bold: r.bold && r.bold.value(), italic: r.italic && r.italic.value(), fontsize: r.fontsize.value(), backgroundColor: e.J99.properties().color.value(), backgroundRoundRect: 4}
    }, f = function (n, t, i, u) {
        return{points: (new List).append(n).append(t), width: e.Q0.timeScale().width(), height: e.J99.priceScale().height(), color: generateColor(e.J99.properties().color.value(), i), linewidth: u ? u : r.linewidth.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}
    }, n = f(t.item(0), t.item(1), 0);
    return i.append(new TrendLineRenderer(n)), 3 <= t.size() && (n = f(t.item(1), t.item(2), 0), i.append(new TrendLineRenderer(n))), 4 == t.size() && (n = f(t.item(2), t.item(3), 0), i.append(new TrendLineRenderer(n))), n = u(this._points.item(0), "A"), this._points.item(1).y > this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache)), n = u(this._points.item(1), "B"), this._points.item(1).y < this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache)), 2 < this._points.size() && (n = u(this._points.item(2), "C"), this._points.item(2).y < this._points.item(1).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache))), 3 < this._points.size() && (n = u(this._points.item(3), "D"), this._points.item(3).y < this._points.item(2).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache))), 3 <= this._points.size() && (t = this._points.item(0).add(this._points.item(2)).scaled(.5), n = f(this._points.item(0), this._points.item(2), 70, 1), i.append(new TrendLineRenderer(n)), n = u(t, this._ABRetracement), i.append(new TextRenderer(n, this._rendererCache))), 4 <= this._points.size() && (t = this._points.item(1).add(this._points.item(3)).scaled(.5), n = f(this._points.item(1), this._points.item(3), 70, 1), i.append(new TrendLineRenderer(n)), n = u(t, this._CDRetracement), i.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && (t = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && t.removeAt(t.size() - 1), i.append(this.createLineAnchor({points: t}))), i
};
_91.prototype.update = function () {
    if (_90.prototype.update.call(this), 3 <= this.J99.points().size()) {
        var n = this.J99.points().item(0), t = this.J99.points().item(1), i = this.J99.points().item(2);
        this._ABRetracement = Math.round(1e3 * Math.abs((i.price - t.price) / (t.price - n.price))) / 1e3
    }
    4 == this.J99.points().size() && (n = this.J99.points().item(3), this._CDRetracement = Math.round(1e3 * Math.abs((n.price - i.price) / (i.price - t.price))) / 1e3)
};
TradingView.LineToolABCD = function (n, t) {
    this._constructor = "LineToolABCD";
    var i = t ? t : new _52("linetoolabcd");
    J47.call(this, n, new _91(this, n), i)
};
inherit(TradingView.LineToolABCD, J47);
TradingView.LineToolABCD.prototype.pointsCount = function () {
    return 4
};
TradingView.LineToolABCD.prototype.title = function () {
    return"ABCD Pattern"
};
TradingView.LineToolABCD.prototype._tooltipFieldsHash = {time0: {title: "Date 1", value: null}, price0: {title: "Price 1", value: null}, time1: {title: "Date 2", value: null}, price1: {title: "Price 2", value: null}, time2: {title: "Date 3", value: null}, price2: {title: "Price 3", value: null}, time3: {title: "Date 4", value: null}, price3: {title: "Price 4", value: null}};
TradingView.LineToolABCD.prototype._updateTooltip = function () {
    var i = this._tooltipFieldsHash, n = this.points().m_values, t;
    n[0] && (t = this.Q0.timeScale().indexToUserTime(n[0].index), i.time0.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price0.value = this.Q0.mainSeries()._formatter.format(n[0].price));
    n[1] && (t = this.Q0.timeScale().indexToUserTime(n[1].index), i.time1.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price1.value = this.Q0.mainSeries()._formatter.format(n[1].price));
    n[2] && (t = this.Q0.timeScale().indexToUserTime(n[2].index), i.time2.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price2.value = this.Q0.mainSeries()._formatter.format(n[2].price));
    n[3] && (t = this.Q0.timeScale().indexToUserTime(n[3].index), i.time3.value = t ? new DateTimeFormatter(this.Q0.mainSeries().isDWM()).format(t) : 0, i.price3.value = this.Q0.mainSeries()._formatter.format(n[3].price))
};
TradingView.LineToolABCD.prototype.tooltip = function () {
    return this._updateTooltip(), this._formatTooltip()
};
inherit(_96, _90);
_96.prototype.renderer = function () {
    if (2 > this._points.size())return null;
    var i = this.J99.properties(), r = new CompositeRenderer, u = this, f = function (n, t) {
        return{points: (new List).append(n), text: t, color: i.textcolor.value(), vertAlign: "middle", horzAlign: "center", font: i.font.value(), offsetX: 0, offsetY: 0, bold: i.bold && i.bold.value(), italic: i.italic && i.italic.value(), fontsize: i.fontsize.value(), backgroundColor: u.J99.properties().color.value(), backgroundRoundRect: 4}
    }, n = function (n, t) {
        return{points: (new List).append(n).append(t), width: u.Q0.timeScale().width(), height: u.J99.priceScale().height(), color: u.J99.properties().color.value(), linewidth: i.linewidth.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}
    }, t = n(this._points.item(0), this._points.item(1));
    return r.append(new TrendLineRenderer(t)), 3 <= this._points.size() && (t = n(this._points.item(1), this._points.item(2)), r.append(new TrendLineRenderer(t))), 4 == this._points.size() && (t = n(this._points.item(2), this._points.item(3)), r.append(new TrendLineRenderer(t)), this._intersectPoint ? (n = new List, n.append(this._startPoint1), n.append(this._startPoint2), n.append(this._intersectPoint), t = {}, t.points = n, t.color = i.color.value(), t.linewidth = i.linewidth.value(), t.backcolor = i.backgroundColor.value(), t.fillBackground = i.fillBackground.value(), t.transparency = i.transparency.value(), r.append(new TriangleRenderer(t))) : this._intersectPoint1 && this._intersectPoint2 && (n = new List, n.append(this._startPoint1), n.append(this._startPoint2), n.append(this._intersectPoint2), n.append(this._intersectPoint1), t = {filled: !0, fillBackground: !0}, t.points = n, t.color = i.color.value(), t.linewidth = i.linewidth.value(), t.backcolor = i.backgroundColor.value(), t.transparency = i.transparency.value(), r.append(new PoligonRenderer(t)))), n = f(this._points.item(0), "A"), this._points.item(1).y > this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache)), n = f(this._points.item(1), "B"), this._points.item(1).y < this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache)), 2 < this._points.size() && (n = f(this._points.item(2), "C"), this._points.item(2).y < this._points.item(1).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache))), 3 < this._points.size() && (n = f(this._points.item(3), "D"), this._points.item(3).y < this._points.item(2).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), r.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && (n = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), r.append(this.createLineAnchor({points: n}))), r
};
_96.prototype.update = function () {
    var o;
    if (_90.prototype.update.call(this), this._valid = !1, 4 == this._points.size()) {
        var t = this._points.item(0), i = this._points.item(1), u = this._points.item(2), f = this._points.item(3);
        if (!(1 > Math.abs(u.x - t.x) || 1 > Math.abs(f.x - i.x))) {
            var n = Math.min(t.x, i.x), n = Math.min(n, u.x), n = Math.min(n, f.x), r = (u.y - t.y) / (u.x - t.x), s = t.y + (n - t.x) * r, e = (f.y - i.y) / (f.x - i.x), h = i.y + (n - i.x) * e;
            1e-6 > Math.abs(r - e) || (this._startPoint1 = new MathEx.Point(n, s), this._startPoint2 = new MathEx.Point(n, h), o = (i.y - t.y + (t.x * r - i.x * e)) / (r - e), this._valid = !0, delete this._intersectPoint, delete this._intersectPoint1, delete this._intersectPoint2, o < n && (n = Math.max(t.x, i.x), n = Math.max(n, u.x), n = Math.max(n, f.x), s = t.y + (n - t.x) * r, h = i.y + (n - i.x) * e, this._startPoint1 = new MathEx.Point(n, s), this._startPoint2 = new MathEx.Point(n, h)), this._intersectPoint = new MathEx.Point(o, t.y + (o - t.x) * r))
        }
    }
};
TradingView.LineToolTrianglePattern = function (n, t) {
    this._constructor = "LineToolTrianglePattern";
    var i = t ? t : new _52("linetooltrianglepattern");
    J47.call(this, n, new _96(this, n), i)
};
inherit(TradingView.LineToolTrianglePattern, J47);
TradingView.LineToolTrianglePattern.prototype.pointsCount = function () {
    return 4
};
TradingView.LineToolTrianglePattern.prototype.title = function () {
    return"Triangle Pattern"
};
inherit(_95, _90);
_95.prototype.renderer = function () {
    var u;
    if (2 > this._points.size())return null;
    for (var t = this.J99.properties(), i = new CompositeRenderer, f = this, r = function (n, i) {
        return{points: (new List).append(n), text: i, color: t.textcolor.value(), vertAlign: "middle", horzAlign: "center", font: t.font.value(), offsetX: 0, offsetY: 0, bold: t.bold && t.bold.value(), italic: t.italic && t.italic.value(), fontsize: t.fontsize.value(), backgroundColor: f.J99.properties().color.value(), backgroundRoundRect: 4}
    }, e = function (n, i, r, u) {
        return{points: (new List).append(n).append(i), width: f.Q0.timeScale().width(), height: f.J99.priceScale().height(), color: generateColor(f.J99.properties().color.value(), r), linewidth: u ? u : t.linewidth.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}
    }, n = 1; n < this._points.size(); n++)u = e(this._points.item(n - 1), this._points.item(n), 0), i.append(new TrendLineRenderer(u));
    return this._retrace1 && (u = e(this._points.item(1), this._points.item(3), 70, 1), i.append(new TrendLineRenderer(u)), n = this._points.item(1).add(this._points.item(3)).scaled(.5), n = r(n, this._retrace1), i.append(new TextRenderer(n, this._rendererCache))), this._retrace2 && (u = e(this._points.item(3), this._points.item(5), 70, 1), i.append(new TrendLineRenderer(u)), n = this._points.item(5).add(this._points.item(3)).scaled(.5), n = r(n, this._retrace2), i.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && (r = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && r.removeAt(r.size() - 1), i.append(this.createLineAnchor({points: r}))), i
};
_95.prototype.update = function () {
    if (_90.prototype.update.call(this), delete this._retrace1, delete this._retrace2, 4 <= this.J99.points().size()) {
        var n = this.J99.points().item(1), t = this.J99.points().item(2), i = this.J99.points().item(3);
        this._retrace1 = Math.round(100 * Math.abs((i.price - t.price) / (t.price - n.price))) / 100
    }
    6 <= this.J99.points().size() && (i = this.J99.points().item(3), n = this.J99.points().item(4), t = this.J99.points().item(5), this._retrace2 = Math.round(100 * Math.abs((t.price - n.price) / (n.price - i.price))) / 100)
};
TradingView.LineToolThreeDrivers = function (n, t) {
    this._constructor = "LineToolThreeDrivers";
    var i = t ? t : new _52("linetoolthreedrivers");
    J47.call(this, n, new _95(this, n), i)
};
inherit(TradingView.LineToolThreeDrivers, J47);
TradingView.LineToolThreeDrivers.prototype.pointsCount = function () {
    return 7
};
TradingView.LineToolThreeDrivers.prototype.title = function () {
    return"Three Drivers Pattern"
};
inherit(_94, _90);
_94.prototype.renderer = function () {
    var r, s, h;
    if (2 > this._points.size())return null;
    for (var t = this.J99.properties(), i = new CompositeRenderer, o = this, f = function (n, i) {
        return{points: (new List).append(n), text: $.t(i), color: t.textcolor.value(), horzAlign: "center", font: t.font.value(), offsetX: 0, offsetY: 0, bold: t.bold && t.bold.value(), italic: t.italic && t.italic.value(), fontsize: t.fontsize.value(), backgroundColor: o.J99.properties().color.value(), backgroundRoundRect: 4}
    }, u = function (n, i, r, u) {
        return{points: (new List).append(n).append(i), width: o.Q0.timeScale().width(), height: o.J99.priceScale().height(), color: generateColor(o.J99.properties().color.value(), r), linewidth: u ? u : t.linewidth.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}
    }, n = function (n, i, r) {
        var u = new List;
        return u.append(n), u.append(i), u.append(r), n = {}, n.points = u, n.color = t.color.value(), n.linewidth = 0, n.backcolor = t.backgroundColor.value(), n.fillBackground = t.fillBackground.value(), n.transparency = t.transparency.value(), n
    }, e = 1; e < this._points.size(); e++)r = u(this._points.item(e - 1), this._points.item(e), 0), i.append(new TrendLineRenderer(r));
    return 5 <= this._points.size() && (h = e = !1, this._intersect1 ? r = this._intersect1 : (r = this._points.item(2), e = !0), this._intersect2 ? s = this._intersect2 : (s = this._points.item(4), h = !0), r = u(r, s, 0), r.extendleft = e, r.extendright = h, i.append(new TrendLineRenderer(r)), u = n(this._points.item(2), this._points.item(3), this._points.item(4)), i.append(new TriangleRenderer(u))), this._intersect1 && (u = n(this._intersect1, this._points.item(1), this._points.item(2)), i.append(new TriangleRenderer(u))), this._intersect2 && (u = n(this._points.item(4), this._points.item(5), this._intersect2), i.append(new TriangleRenderer(u))), 2 <= this._points.size() && (n = this._points.item(1), n = f(n, "Left Shoulder"), this._points.item(1).y < this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache))), 4 <= this._points.size() && (n = this._points.item(3), n = f(n, "Head"), this._points.item(3).y < this._points.item(2).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache))), 6 <= this._points.size() && (n = this._points.item(5), n = f(n, "Right Shoulder"), this._points.item(5).y < this._points.item(4).y ? (n.vertAlign = "bottom", n.offsetY = -10) : (n.vertAlign = "top", n.offsetY = 5), i.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && (f = this._points.clone(), this.Q0.lineBeingCreated() == this.J99 && f.removeAt(f.size() - 1), i.append(this.createLineAnchor({points: f}))), i
};
_94.prototype.update = function () {
    var r, n;
    if (_90.prototype.update.call(this), delete this._intersect1, delete this._intersect2, 5 <= this._points.size()) {
        var n = this._points.item(0), t = this._points.item(1), i = this._points.item(2);
        this._points.item(3);
        r = this._points.item(4);
        n = MathEx.intersectSegment(i, r, n, t);
        null !== n && (t = r.substract(i), this._intersect1 = i.add(t.scaled(n)))
    }
    7 == this._points.size() && (n = this._points.item(5), t = this._points.item(6), n = MathEx.intersectSegment(i, r, n, t), null !== n && (t = r.substract(i), this._intersect2 = i.add(t.scaled(n))))
};
TradingView.LineToolHeadAndShoulders = function (n, t) {
    this._constructor = "LineToolHeadAndShoulders";
    var i = t ? t : new _52("linetoolheadandshoulders");
    J47.call(this, n, new _94(this, n), i)
};
inherit(TradingView.LineToolHeadAndShoulders, J47);
TradingView.LineToolHeadAndShoulders.prototype.pointsCount = function () {
    return 7
};
TradingView.LineToolHeadAndShoulders.prototype.title = function () {
    return"Head & Shoulders"
};
inherit(J42, _90);
J42.prototype.update = function () {
    var i, n;
    if (_90.prototype.update.call(this), !(3 > this.J99.points().size() || !this.J99.priceScale() || this.J99.priceScale().isEmpty() || this.Q0.timeScale().isEmpty())) {
        var r = this.J99.points().item(0), t = this.J99.points().item(1), u = this.J99.points().item(2);
        if (this._levels = [], t.index != r.index && (r = t.index - r.index, t = this.J99.properties(), u = u.index, !this.Q0.timeScale().visibleBars().isEmpty()))for (i = 1; 11 >= i; i++)if (n = t["level" + i], n.visible.value()) {
            var f = n.coeff.value(), e = n.color.value(), o = Math.round(u + f * r), n = {x: this.Q0.timeScale().indexToCoordinate(o), coeff: f, color: e, linewidth: n.linewidth.value(), linestyle: n.linestyle.value(), index: i};
            t.showCoeffs.value() && (n.text = f, n.y = this.J99.priceScale().height());
            this._levels.push(n)
        }
    }
};
J42.prototype.renderer = function () {
    var r = new CompositeRenderer, o, s, h, t;
    if (2 > this._points.size())return r;
    var e = this._points.item(0), t = this._points.item(1), i = this.J99.properties(), f = {points: (new List).append(e).append(t), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: i.trendline.color.value(), linewidth: i.trendline.linewidth.value(), linestyle: i.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    if (r.append(new TrendLineRenderer(f)), 3 > this._points.size())return this.addAnchors(r), r;
    f = this._points.item(2);
    f = {points: (new List).append(t).append(f), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: i.trendline.color.value(), linewidth: i.trendline.linewidth.value(), linestyle: i.trendline.linestyle.value(), extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
    r.append(new TrendLineRenderer(f));
    for (var f = i.fillBackground.value(), c = i.transparency.value(), n = 0; n < this._levels.length; n++) {
        if (0 < n && f) {
            var e = new MathEx.Point(this._levels[n - 1].x, 0), t = new MathEx.Point(this._levels[n].x, this.J99.priceScale().height()), u = {nohittest: !0};
            u.points = (new List).append(e).append(t);
            u.color = this._levels[n].color;
            u.linewidth = 0;
            u.backcolor = this._levels[n].color;
            u.fillBackground = !0;
            u.transparency = c;
            r.append(new RectangleRenderer(u))
        }
        if (void 0 !== this._levels[n].text) {
            t = i.horzLabelsAlign.value();
            t = "left" == t ? "right" : "right" == t ? "left" : "center";
            switch (t) {
                case"left":
                    s = 3;
                    break;
                case"center":
                    s = 0;
                    break;
                case"right":
                    s = -3
            }
            switch (i.vertLabelsAlign.value()) {
                case"top":
                    o = new MathEx.Point(this._levels[n].x, 0);
                    h = 5;
                    break;
                case"middle":
                    o = new MathEx.Point(this._levels[n].x, .5 * this._levels[n].y);
                    h = 0;
                    break;
                case"bottom":
                    o = new MathEx.Point(this._levels[n].x, this._levels[n].y);
                    h = -10
            }
            t = {points: (new List).append(o), text: "" + this._levels[n].text, color: this._levels[n].color, vertAlign: "middle", horzAlign: t, font: i.font.value(), offsetX: s, offsetY: h, fontsize: 12};
            r.append(new TextRenderer(t, this._rendererCache))
        }
        t = {};
        t.points = (new List).append(new MathEx.Point(this._levels[n].x, 0));
        t.color = this._levels[n].color;
        t.linewidth = this._levels[n].linewidth;
        t.linestyle = this._levels[n].linestyle;
        e = new HitTestResult(HitTestResult.MOVEPOINT, null, this._levels[n].index);
        r.append(new VertLineRenderer(t, e))
    }
    return this.addAnchors(r), r
};
TradingView.LineToolTrendBasedFibTime = function (n, t) {
    this._constructor = "LineToolTrendBasedFibTime";
    var i = t ? t : new _52("linetooltrendbasedfibtime");
    J47.call(this, n, new J42(this, n), i);
    this.version = TradingView.LineToolTrendBasedFibTime.version
};
inherit(TradingView.LineToolTrendBasedFibTime, J47);
TradingView.LineToolTrendBasedFibTime.version = 1;
TradingView.LineToolTrendBasedFibTime.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolTrendBasedFibTime.prototype.title = function () {
    return"Trend-Based Fib Time"
};
TradingView.LineToolTrendBasedFibTime.prototype.migrateVersion = function () {
};
TradingView.LineToolTrendBasedFibTime.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
GannArcRenderer.prototype.draw = function (n) {
    var t, i;
    n.lineCap = "butt";
    n.strokeStyle = this._data.color;
    n.lineWidth = this._data.linewidth;
    n.translate(this._data.center.x, this._data.center.y);
    var r = this._data.edge.substract(this._data.center), r = r.y / r.x, t = this._data.point.substract(this._data.center);
    t.y /= r;
    t = t.length();
    i = this._data.prevPoint.substract(this._data.center);
    i.y /= r;
    i = i.length();
    n.scale(1, r);
    this._data.fillBack && (this._data.point.x < this._data.center.x && (t = -t, i = -i), n.beginPath(), n.moveTo(i, 0), n.lineTo(t, 0), n.arcTo(t, t, 0, t, Math.abs(t)), n.lineTo(0, i), n.arcTo(i, i, i, 0, Math.abs(i)), n.fillStyle = generateColor(this._data.color, this._data.transparency), n.fill());
    n.beginPath();
    this._data.point.x > this._data.center.x ? n.arc(0, 0, Math.abs(t), 0, Math.PI / 2, !1) : n.arc(0, 0, Math.abs(t), -Math.PI / 2, -Math.PI, !0);
    n.scale(1, 1 / r);
    n.stroke()
};
GannArcRenderer.prototype.hitTest = function (n) {
    var t, i, r;
    n = n.substract(this._data.center);
    t = this._data.edge.substract(this._data.center);
    i = t.y / t.x;
    n.y /= i;
    r = this._data.point.substract(this._data.center);
    r.y /= i;
    var r = r.length(), u = n.length(), f = this._data.prevPoint.substract(this._data.center);
    if (f.y /= i, i = f.length(), this._data.fillBack) {
        if (u >= i && u <= r && 0 <= t.x * n.x && 0 <= t.y * n.y)return new HitTestResult(HitTestResult.MOVEPOINT)
    } else if (5 > Math.abs(u - r) && 0 <= t.x * n.x && 0 <= t.y * n.y)return new HitTestResult(HitTestResult.MOVEPOINT);
    return null
};
inherit(_80, _90);
_80.prototype.update = function () {
    _90.prototype.update.call(this);
    this.J99._cornerPoint && this._points.append(this.J99.pointToScreenPoint(this.J99._cornerPoint)[0])
};
_80.prototype.renderer = function () {
    var u = this.J99.properties(), s = new CompositeRenderer, r, c;
    if (2 > this._points.size())return this.addAnchors(s), s;
    for (var n = this._points.item(0), f = 3 == this._points.size() ? this._points.item(2) : this._points.item(1), l = this._points.item(1), h = 0; 6 > h; h++)if (r = u.levels[h], r.visible.value()) {
        var i = h / 5, t = n.x + i * (f.x - n.x), e = n.y, o = f.y, t = {points: (new List).append(new MathEx.Point(t, e)).append(new MathEx.Point(t, o)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: r.color.value(), linewidth: r.width.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        s.append(new TrendLineRenderer(t));
        e = n.y + i * (f.y - n.y);
        t = n.x;
        i = f.x;
        t = {points: (new List).append(new MathEx.Point(t, e)).append(new MathEx.Point(i, e)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: r.color.value(), linewidth: r.width.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        s.append(new TrendLineRenderer(t))
    }
    for (h in u.fanlines._childs)o = u.fanlines[h], o.visible.value() && (r = o.x.value(), i = o.y.value(), r > i ? (t = f.x, i /= r, e = n.y + i * (f.y - n.y)) : (e = f.y, i = r / i, t = n.x + i * (f.x - n.x)), t = {points: (new List).append(n).append(new MathEx.Point(t, e)), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: o.color.value(), linewidth: o.width.value(), linestyle: CanvasEx.LINESTYLE_SOLID, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, s.append(new TrendLineRenderer(t)));
    o = n;
    for (h in u.arcs._childs)c = u.arcs[h], c.visible.value() && (r = c.x.value() / 5, i = c.y.value() / 5, t = n.x + r * (f.x - n.x), e = n.y + i * (f.y - n.y), new MathEx.Point(t, e).substract(n).length(), t = {center: n, point: new MathEx.Point(t, e), edge: f, color: c.color.value(), linewidth: c.width.value(), fillBack: u.arcsBackground.fillBackground.value(), transparency: u.arcsBackground.transparency.value(), prevPoint: o}, s.append(new GannArcRenderer(t)), o = t.point);
    return this.isAnchorsRequired() && (u = (new List).append(n).append(l), this.Q0.lineBeingCreated() == this.J99 && u.removeAt(u.size() - 1), s.append(this.createLineAnchor({points: u}))), s
};
TradingView.LineToolGannComplex = function (n, t) {
    this._constructor = "LineToolGannComplex";
    var i = t ? t : new _52("linetoolganncomplex");
    J47.call(this, n, new _80(this, n), i)
};
inherit(TradingView.LineToolGannComplex, J47);
TradingView.LineToolGannComplex.prototype._recalcSecondPoint = function () {
    var n = this.Q0.mainSeries().properties().style.value(), t = this.Q0.mainSeries().interval();
    (n !== this._currentStyle || t !== this._currentInterval) && (n = this.pointToScreenPoint(this.points().item(0))[0], t = this.pointToScreenPoint(this.points().item(2))[0].substract(n), n = n.add(t.scaled(.2 / Math.sqrt(2))), n = this.screenPointToPoint(n), this._points.setItem(1, n))
};
TradingView.LineToolGannComplex.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolGannComplex.prototype.title = function () {
    return"Gann Square"
};
TradingView.LineToolGannComplex.prototype._fixThirdPoint = function (n) {
    if (!(2 > this.points().size())) {
        var t = this.pointToScreenPoint(this.points().item(0))[0], i = this.pointToScreenPoint(this.points().item(1))[0], r = i.substract(t);
        n ? t = t.add(r.scaled(5 * Math.sqrt(2))) : (n = 0 > r.x ? -1 : 1, r = 0 > r.y ? -1 : 1, i = i.substract(t).length(), t = t.add(new MathEx.Point(5 * i * n, 5 * i * r)));
        this._cornerPoint = this.screenPointToPoint(t)
    }
};
TradingView.LineToolGannComplex.prototype.setPoint = function (n, t, i) {
    return n = J47.prototype.setPoint.call(this, n, t, i), this._fixThirdPoint(i && i.shift), this._points.setItem(2, this._cornerPoint), delete this._cornerPoint, i = this.Q0.mainSeries().properties().style.value(), t = this.Q0.mainSeries().interval(), this._currentStyle = i, this._currentInterval = t, n
};
TradingView.LineToolGannComplex.prototype.setLastPoint = function (n, t) {
    var i = J47.prototype.setLastPoint.call(this, n, t);
    return this._fixThirdPoint(t && t.shift), i
};
TradingView.LineToolGannComplex.prototype.addPoint = function (n, t) {
    var i = this.Q0.mainSeries().properties().style.value(), r = this.Q0.mainSeries().interval();
    return this._currentStyle = i, this._currentInterval = r, i = this.priceScale(), i.isPercent() && (r = this.ownerSource().firstValue(), n.price = i.priceRange().convertFromPercent(n.price, r)), i = t && t.shift, this._points.append(n), this._lastPoint = null, (r = this._points.size() == this.pointsCount()) ? (this._fixThirdPoint(i), this._points.append(this._cornerPoint), delete this._cornerPoint, this.normalizePoints(), this.createServerPoints()) : this._lastPoint = n, r
};
TradingView.LineToolGannComplex.prototype.onData = function (n) {
    J47.prototype.onData.call(this, n);
    this._recalcSecondPoint()
};
inherit(_70, _90);
_70.prototype.update = function () {
    var f, i, r, s, t, u;
    if (_90.prototype.update.call(this), !(3 > this._points.size() || 3 > this.J99.points().size())) {
        f = this._points.item(0);
        i = this._points.item(1);
        this._points.item(2);
        this.norm = this._points.item(2).substract(this._points.item(0));
        this._labels = [];
        for (var n = this.J99.properties(), f = this.J99.points().item(0), i = this.J99.points().item(1), f = f.price - i.price, i = i.price, o = function (t) {
            return n.coeffsAsPercents.value() ? "" + Math.round(1e4 * t) / 100 + "%" : "" + t
        }, e = 1; 11 >= e; e++)r = n["level" + e].coeff.value(), t = i + r * f, this.J99.priceScale().isPercent() && (s = this.J99.ownerSource().firstValue(), t = this.J99.priceScale().priceRange().convertToPercent(t, s)), n.showCoeffs.value() && n.showPrices.value() ? u = "" + o(r) + "(" + this.J99.priceScale().formatter().format(t) + ")" : n.showCoeffs.value() ? u = "" + o(r) : n.showPrices.value() && (u = "" + this.J99.priceScale().formatter().format(t)), this._labels.push(u)
    }
};
_70.prototype.renderer = function () {
    function l(t, u, f) {
        var e, o, s = n.vertLabelsAlign.value();
        switch (n.horzLabelsAlign.value()) {
            case"left":
                e = t;
                o = "right";
                break;
            case"center":
                e = t.add(u).scaled(.5);
                o = "center";
                break;
            case"right":
                e = u;
                o = "left"
        }
        t = {points: (new List).append(e), text: f, color: i.color, vertAlign: s, horzAlign: o, font: n.font.value(), offsetX: -5, offsetY: "top" == s ? 0 : -5, fontsize: 12};
        r.append(new TextRenderer(t, a._rendererCache))
    }

    var r = new CompositeRenderer, a, o, i, f, h;
    if (2 > this._points.size())return this.addAnchors(r), r;
    var n = this.J99.properties(), e = this._points.item(0), s = this._points.item(1);
    if (3 > this._points.size())return e = {points: (new List).append(e).append(s), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: n.level1.color.value(), linewidth: n.level1.linewidth.value(), linestyle: n.level1.linestyle.value(), extendleft: n.extendLeft.value(), extendright: n.extendRight.value(), leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, r.append(new TrendLineRenderer(e)), this.addAnchors(r), r;
    for (a = this, o = 1; 11 > o; o++)if (i = n["level" + o], i.visible.value()) {
        for (f = o + 1; 11 >= f; f++)if (h = n["level" + f], h.visible.value())break;
        if (!h)break;
        var u = this.norm.scaled(i.coeff.value()), f = e.add(u), u = s.add(u), c = this.norm.scaled(h.coeff.value()), v = e.add(c), c = s.add(c), t = {};
        t.points = new List;
        t.points.append(f);
        t.points.append(u);
        t.points.append(v);
        t.points.append(c);
        t.color = i.color.value();
        t.width = this.Q0.timeScale().width();
        t.height = this.J99.priceScale().height();
        t.linewidth = i.linewidth.value();
        t.linestyle = i.linestyle.value();
        t.extendleft = n.extendLeft.value();
        t.extendright = n.extendRight.value();
        t.backcolor = i.color.value();
        t.transparency = n.transparency.value();
        t.skipTopLine = !0;
        t.fillBackground = n.fillBackground.value();
        t.hittestOnBackground = TradingView.isMobile.any();
        r.append(new ParallelChannelRenderer(t));
        (n.showCoeffs.value() || n.showPrices.value()) && l(f, u, this._labels[o - 1])
    }
    return i = n.level11, i.visible.value() && (u = this.norm.scaled(i.coeff.value()), f = e.add(u), u = s.add(u), e = {points: (new List).append(f).append(u), width: this.Q0.timeScale().width(), height: this.J99.priceScale().height(), color: i.color.value(), linewidth: i.linewidth.value(), linestyle: i.linestyle.value(), extendleft: n.extendLeft.value(), extendright: n.extendRight.value(), leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL}, r.append(new TrendLineRenderer(e)), (n.showCoeffs.value() || n.showPrices.value()) && l(f, u, this._labels[10])), this.addAnchors(r), r
};
TradingView.LineToolFibChannel = function (n, t) {
    this._constructor = "LineToolFibChannel";
    var i = t ? t : new _52("linetoolfibchannel");
    J47.call(this, n, new _70(this, n), i);
    this.version = TradingView.LineToolFibChannel.version
};
inherit(TradingView.LineToolFibChannel, J47);
TradingView.LineToolFibChannel.version = 1;
TradingView.LineToolFibChannel.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolFibChannel.prototype.title = function () {
    return"Fib Channel"
};
TradingView.LineToolFibChannel.prototype.processErase = function (n, t) {
    var i = "level" + t, i = this.properties()[i].visible;
    n.setProperty(i, !1, "Erase level line")
};
FibSpiralRenderer.prototype._fibNumbers = function () {
    return[0, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89]
};
FibSpiralRenderer.prototype._continiusFib = function (n) {
    var t = this._fibNumbers(), i = Math.floor(n), r = Math.ceil(n);
    return r >= t.length ? null : (n = Math.pow(n - i, 1.15), t[i] + (t[r] - t[i]) * n)
};
FibSpiralRenderer.prototype.hitTest = function (n) {
    var i = this._data.points.item(0), u = this._data.points.item(1).substract(i), i = n.substract(i), r, t;
    for (n = u.normalized(), r = n.transponed(), t = i.normalized(), n = Math.acos(n.dotProduct(t)), 0 > Math.asin(r.dotProduct(t)) && (n = 2 * Math.PI - n), i = i.length(), r = 0; 4 > r; r++)if (t = this._continiusFib(n / (.5 * Math.PI) + 4 * r), t = t * u.length() / 5, null !== t && 5 > Math.abs(t - i))return new HitTestResult(HitTestResult.MOVEPOINT);
    return null
};
FibSpiralRenderer.prototype.draw = function (n) {
    var t, i, u;
    n.lineCap = "round";
    n.strokeStyle = this._data.color;
    t = this._data.points.item(0);
    i = this._data.points.item(1);
    n.translate(t.x, t.y);
    var r = i.substract(t), t = r.length(), r = r.normalized(), i = Math.acos(r.x);
    for (0 > Math.asin(r.y) && (i = 2 * Math.PI - i), n.rotate(i), n.scale(t / 5, t / 5), n.lineWidth = this._data.linewidth, CanvasEx.setLineStyle(n, this._data.linestyle), r = Math.PI / 100, n.moveTo(0, 0), u = 0; u < 50 * (this._fibNumbers().length - 1); u++) {
        var f = u * r, e = this._continiusFib(u / 50), o = Math.cos(f) * e, f = Math.sin(f) * e;
        n.lineTo(o, f)
    }
    n.scale(5 / t, 5 / t);
    n.rotate(-i);
    n.stroke()
};
inherit(_75, _90);
_75.prototype.renderer = function () {
    var t = new CompositeRenderer, n;
    return 2 > this._points.size() ? t : (n = {}, n.points = this._points, n.width = this.Q0.timeScale().width(), n.height = this.J99.priceScale().height(), n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), n.extendleft = !1, n.extendright = !0, n.leftend = J47.LINEEND_NORMAL, n.rightend = J47.LINEEND_NORMAL, t.append(new TrendLineRenderer(n)), n = {}, n.points = this._points, n.floatPoints = this._floatPoints, n.width = this.Q0.timeScale().width(), n.height = this.J99.priceScale().height(), n.color = this.J99.properties().linecolor.value(), n.linewidth = this.J99.properties().linewidth.value(), n.linestyle = this.J99.properties().linestyle.value(), t.append(new FibSpiralRenderer(n)), this.isAnchorsRequired() && (t.append(new TrendLineRenderer(n)), n = n.points.clone(), this.Q0.lineBeingCreated() == this.J99 && n.removeAt(n.size() - 1), t.append(this.createLineAnchor({points: n}))), t)
};
TradingView.LineToolFibSpiral = function (n, t) {
    this._constructor = "LineToolFibSpiral";
    var i = t ? t : new _52("linetoolfibspiral");
    J47.call(this, n, new _75(this, n), i)
};
inherit(TradingView.LineToolFibSpiral, J47);
TradingView.LineToolFibSpiral.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolFibSpiral.prototype.title = function () {
    return"Fib Spiral"
};
inherit(_67, _90);
_67.prototype.update = function () {
    var n, t, i;
    _90.prototype.update.call(this);
    this._label = null;
    2 > this.J99.points().size() || !this.J99.priceScale() || (n = this.J99.points().item(0), t = this.J99.points().item(1), this._price1 = this.J99.priceScale().formatter().format(n.price), this._price2 = this.J99.priceScale().formatter().format(t.price), 3 == this.J99.points().size() && (i = this.J99.points().item(2), this._price3 = this.J99.priceScale().formatter().format(i.price), n = t.price - n.price, this._price4 = this.J99.priceScale().formatter().format(i.price + n)))
};
_67.prototype.renderer = function () {
    var r = new CompositeRenderer, o, h, s, c, t, f, n;
    if (2 > this._points.size())return r;
    var u = this._points.item(0), e = this._points.item(1), i = this.J99.properties(), a = this.Q0, l = this.J99, i = l.properties();
    return(3 <= this._points.size() && (o = this._points.item(2), o.x = e.x, s = e.y - u.y, h = u.clone(), h.y = o.y + s, h.data = 3, i.fillBackground.value() && (n = {}, s = a.timeScale().width(), l.priceScale().height(), c = i.extendLeft.value(), t = i.extendRight.value(), c || t ? !c && t ? (n = {}, n.width = s, n.p1 = u, n.p2 = e, n.p3 = h, n.p4 = o, n.color = i.backgroundColor.value(), n.transparency = i.transparency.value(), n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n))) : c && !t ? (n = {}, n.width = s, n.p1 = e, n.p2 = u, n.p3 = o, n.p4 = h, n.color = i.backgroundColor.value(), n.transparency = i.transparency.value(), n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n))) : (n = u.add(e).scaled(.5), c = h.add(o).scaled(.5), t = {}, t.width = s, t.p1 = n, t.p2 = e, t.p3 = c, t.p4 = o, t.color = i.backgroundColor.value(), t.transparency = i.transparency.value(), t.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(t)), t = {}, t.width = s, t.p1 = n, t.p2 = u, t.p3 = c, t.p4 = h, t.color = i.backgroundColor.value(), t.transparency = i.transparency.value(), t.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(t))) : (n.points = new List([u, e, o, h]), n.color = "rgba(0,0,0,0)", n.linewidth = 0, n.linestyle = CanvasEx.LINESTYLE_SOLID, n.filled = !0, n.backcolor = i.backgroundColor.value(), n.fillBackground = !0, n.transparency = i.transparency.value(), r.append(new PoligonRenderer(n))))), s = function (n, t) {
        return{points: (new List).append(n).append(t), width: a.timeScale().width(), height: l.priceScale().height(), color: i.linecolor.value(), linewidth: i.linewidth.value(), linestyle: i.linestyle.value(), extendleft: i.extendLeft.value(), extendright: i.extendRight.value(), leftend: i.leftEnd.value(), rightend: i.rightEnd.value()}
    }, r.append(new TrendLineRenderer(s(u, e))), f = this, n = function (n, t, i, u) {
        f.J99.properties().showPrices.value() && (i = {points: (new List).append(n), text: i, color: f.J99.properties().textcolor.value(), horzAlign: n.x > t.x ? "left" : "right", vertAlign: "middle", font: f.J99.properties().font.value(), offsetX: n.x > t.x ? -5 : 5, offsetY: -5, bold: f.J99.properties().bold.value(), italic: f.J99.properties().italic.value(), fontsize: f.J99.properties().fontsize.value()}, r.append(new TextRenderer(i, f._rendererCache)), i = {points: (new List).append(t), text: u, color: f.J99.properties().textcolor.value(), horzAlign: n.x < t.x ? "left" : "right", vertAlign: "middle", font: f.J99.properties().font.value(), offsetX: n.x > t.x ? -5 : 5, offsetY: -5, bold: f.J99.properties().bold.value(), italic: f.J99.properties().italic.value(), fontsize: f.J99.properties().fontsize.value()}, r.append(new TextRenderer(i, f._rendererCache)))
    }, r.append(new TrendLineRenderer(s(u, e))), n(u, e, this._price1, this._price2), 2 == this._points.size()) ? (this.addAnchors(r), r) : (r.append(new TrendLineRenderer(s(h, o))), n(o, h, this._price3, this._price4), this.isAnchorsRequired() && (u = (new List).append(u).append(e).append(o).append(h), this.Q0.lineBeingCreated() == this.J99 && u.removeAt(u.size() - 1), r.append(this.createLineAnchor({points: u}))), r)
};
TradingView.LineToolDisjointAngle = function (n, t) {
    this._constructor = "LineToolDisjointAngle";
    var i = t ? t : new _52("linetooldisjointangle");
    J47.call(this, n, new _67(this, n), i);
    this.version = TradingView.LineToolDisjointAngle.version
};
inherit(TradingView.LineToolDisjointAngle, J47);
TradingView.LineToolDisjointAngle.version = 1;
TradingView.LineToolDisjointAngle.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolDisjointAngle.prototype.title = function () {
    return"Disjoint Angle"
};
TradingView.LineToolDisjointAngle.prototype.addPoint = function (n, t) {
    return t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2)), J47.prototype.addPoint.call(this, n)
};
TradingView.LineToolDisjointAngle.prototype.setLastPoint = function (n, t) {
    return t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2)), J47.prototype.setLastPoint.call(this, n)
};
TradingView.LineToolDisjointAngle.prototype.setPoint = function (n, t, i) {
    var r = .5 * (this._points.item(1).price + this._points.item(2).price);
    i && i.shift && 1 == n && this._snapPoint45Degree(t, this.points().item(0));
    3 > n && J47.prototype.setPoint.call(this, n, t);
    0 != n && 2 != n && (1 == n ? (n = this._points.item(1).price - r, this._points.item(2).price = this._points.item(1).price - 2 * n) : 3 == n && (n = this.priceScale(), i = t.price, n.isPercent() && (r = this.ownerSource().firstValue(), i = n.priceRange().convertFromPercent(i, r)), n = i - this._points.item(2).price, this._points.item(0).price = this._points.item(1).price - n, this._points.item(0).index = t.index))
};
inherit(_78, _90);
_78.prototype.update = function () {
    if (_90.prototype.update.call(this), this._label2 = this._label1 = null, !(2 > this.J99.points().size()) && this.J99.priceScale()) {
        var n = this.J99.points().item(0), t = this.J99.points().item(1);
        this._price1 = this.J99.priceScale().formatter().format(n.price);
        this._price2 = this.J99.priceScale().formatter().format(t.price);
        3 == this.J99.points().size() && (n = this.J99.points().item(2), this._price3 = this.J99.priceScale().formatter().format(n.price))
    }
};
_78.prototype.renderer = function () {
    var r = new CompositeRenderer, e, o, h, c, t, f, n;
    if (2 > this._points.size())return r;
    var u = this._points.item(0), s = this._points.item(1), i = this.J99.properties(), l = this.Q0, a = this.J99;
    return(3 == this._points.size() && (e = this._points.item(2), e.x = s.x, o = u.clone(), o.y = e.y, o.data = 3, i.fillBackground.value() && (n = {}, h = l.timeScale().width(), a.priceScale().height(), c = i.extendLeft.value(), t = i.extendRight.value(), c || t ? !c && t ? (n = {}, n.width = h, n.p1 = u, n.p2 = s, n.p3 = o, n.p4 = e, n.color = i.backgroundColor.value(), n.transparency = i.transparency.value(), n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n))) : c && !t ? (n = {}, n.width = h, n.p1 = s, n.p2 = u, n.p3 = e, n.p4 = o, n.color = i.backgroundColor.value(), n.transparency = i.transparency.value(), n.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(n))) : (n = u.add(s).scaled(.5), c = o.add(e).scaled(.5), t = {}, t.width = h, t.p1 = n, t.p2 = s, t.p3 = c, t.p4 = e, t.color = i.backgroundColor.value(), t.transparency = i.transparency.value(), t.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(t)), t = {}, t.width = h, t.p1 = n, t.p2 = u, t.p3 = c, t.p4 = o, t.color = i.backgroundColor.value(), t.transparency = i.transparency.value(), t.hittestOnBackground = TradingView.isMobile.any(), r.append(new ChannelRenderer(t))) : (n.points = new List([u, s, e, o]), n.color = "rgba(0,0,0,0)", n.linewidth = 0, n.linestyle = CanvasEx.LINESTYLE_SOLID, n.filled = !0, n.backcolor = i.backgroundColor.value(), n.fillBackground = !0, n.transparency = i.transparency.value(), r.append(new PoligonRenderer(n))))), h = function (n, t) {
        return{points: (new List).append(n).append(t), width: l.timeScale().width(), height: a.priceScale().height(), color: i.linecolor.value(), linewidth: i.linewidth.value(), linestyle: i.linestyle.value(), extendleft: i.extendLeft.value(), extendright: i.extendRight.value(), leftend: i.leftEnd.value(), rightend: i.rightEnd.value()}
    }, r.append(new TrendLineRenderer(h(u, s))), 2 == this._points.size()) ? (this.addAnchors(r), r) : (f = this, n = function (n, t, i, u) {
        f.J99.properties().showPrices.value() && (i = {points: (new List).append(n), text: i, color: f.J99.properties().textcolor.value(), horzAlign: n.x > t.x ? "left" : "right", vertAlign: "middle", font: f.J99.properties().font.value(), offsetX: n.x > t.x ? -5 : 5, offsetY: -5, bold: f.J99.properties().bold.value(), italic: f.J99.properties().italic.value(), fontsize: f.J99.properties().fontsize.value()}, r.append(new TextRenderer(i, f._rendererCache)), i = {points: (new List).append(t), text: u, color: f.J99.properties().textcolor.value(), horzAlign: n.x < t.x ? "left" : "right", vertAlign: "middle", font: f.J99.properties().font.value(), offsetX: n.x > t.x ? -5 : 5, offsetY: -5, bold: f.J99.properties().bold.value(), italic: f.J99.properties().italic.value(), fontsize: f.J99.properties().fontsize.value()}, r.append(new TextRenderer(i, f._rendererCache)))
    }, r.append(new TrendLineRenderer(h(u, s))), n(u, s, this._price1, this._price2), 2 == this._points.size()) ? r : (r.append(new TrendLineRenderer(h(o, e))), n(e, o, this._price3, this._price3), this.isAnchorsRequired() && (u = (new List).append(u).append(s).append(e).append(o), this.Q0.lineBeingCreated() == this.J99 && u.removeAt(u.size() - 1), r.append(this.createLineAnchor({points: u}))), r)
};
TradingView.LineToolFlatBottom = function (n, t) {
    this._constructor = "LineToolFlatBottom";
    var i = t ? t : new _52("linetoolflatbottom");
    J47.call(this, n, new _78(this, n), i);
    this.version = TradingView.LineToolFlatBottom.version
};
inherit(TradingView.LineToolFlatBottom, J47);
TradingView.LineToolFlatBottom.version = 1;
TradingView.LineToolFlatBottom.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolFlatBottom.prototype.title = function () {
    return"Flat Bottom"
};
TradingView.LineToolFlatBottom.prototype.addPoint = function (n, t) {
    return t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2)), J47.prototype.addPoint.call(this, n)
};
TradingView.LineToolFlatBottom.prototype.setLastPoint = function (n, t) {
    return t && t.shift && 2 == this.points().size() && this._snapPoint45Degree(n, this.points().item(this.points().size() - 2)), J47.prototype.setLastPoint.call(this, n)
};
TradingView.LineToolFlatBottom.prototype.setPoint = function (n, t, i) {
    this._points.item(1);
    this._points.item(2);
    i && i.shift && 1 == n && this._snapPoint45Degree(t, this.points().item(0));
    3 > n ? J47.prototype.setPoint.call(this, n, t) : this._points.item(0).index = t.index
};
IconRenderer.prototype.draw = function (n) {
    var i = String.fromCharCode(this._data.icon), r, t;
    n.font = this._data.size + "px FontAwesome";
    r = n.measureText(i).width;
    n.textBaseline = "middle";
    t = this._data.point;
    n.translate(t.x, t.y);
    n.rotate(this._data.angle - Math.PI / 2);
    n.scale(this._data.scale, 1);
    t = 65536 * this._data.icon + this._data.size;
    this._cache[t] = r;
    this._data.selected && (n.fillStyle = "rgba(80, 80, 80, 0.2)", n.fillRect(-this._cache[t] / 2, -this._data.size / 2, this._cache[t], this._data.size));
    n.fillStyle = this._data.color;
    n.fillText(i, -this._cache[t] / 2, 0)
};
IconRenderer.prototype.hitTest = function (n) {
    var t = this._cache[65536 * this._data.icon + this._data.size] * this._data.scale, i = MathEx.Matrix.rotate(-this._data.angle);
    return n = n.substract(this._data.point), n = i.mult(n), Math.abs(n.y) <= t / 2 && Math.abs(n.x) <= this._data.size / 2 ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(_87, _90);
_87.anchorLimit = 80;
_87.prototype.renderer = function () {
    var u = new CompositeRenderer;
    if (1 > this._points.size())return u;
    var n = this.J99.properties(), t = {point: this._points.item(0), color: n.color.value(), size: n.size.value(), icon: n.icon.value(), angle: n.angle.value(), scale: n.scale.value(), selected: this.isAnchorsRequired()}, e = this.Q0, o = this.J99;
    if (u.append(new IconRenderer(t, this._cache)), this.isAnchorsRequired()) {
        var i = this._cache[65536 * t.icon + t.size], r = t.size, t = this._points.item(0), f = n.scale.value(), r = new MathEx.Point(Math.max(_87.anchorLimit, r) / 2, 0), i = new MathEx.Point(0, Math.max(_87.anchorLimit, f * i) / 2), n = MathEx.Matrix.rotate(n.angle.value()), r = n.mult(r), i = n.mult(i), n = t.add(r);
        n.data = 0;
        r = t.substract(r);
        r.data = 1;
        f = t.add(i);
        f.data = 2;
        f.square = !0;
        i = t.substract(i);
        i.data = 3;
        i.square = !0;
        t = {points: (new List).append(n).append(r), width: e.timeScale().width(), height: o.priceScale().height(), color: "#808080", linewidth: 1, linestyle: CanvasEx.LINESTYLE_DASHED, extendleft: !1, extendright: !1, leftend: J47.LINEEND_NORMAL, rightend: J47.LINEEND_NORMAL};
        e = new TrendLineRenderer(t);
        e._hittest = null;
        u.append(e);
        u.append(this.createLineAnchor({points: (new List).append(n).append(r).append(f).append(i)}))
    }
    return u
};
TradingView.LineToolIcon = function (n, t) {
    this._constructor = "LineToolIcon";
    var i = t ? t : new _52("linetoolicon");
    i.addExclusion("angle");
    i.addExclusion("scale");
    J47.call(this, n, new _87(this, n), i);
    this.version = TradingView.LineToolIcon.version
};
TradingView.LineToolIcon._getAvailIcons = function () {
    for (var t = [], t = t.concat([61536, 61537, 61538, 61539]), t = t.concat([61725, 61726]), t = t.concat([61575, 61576, 61796, 61797]), t = t.concat([61779, 61780, 61781, 61782, 61783, 61784, 61785, 61786]), i = t.slice(0), n = 61440; 61846 >= n; n++)-1 != $.inArray(n, t) || 15 == n % 16 && 61487 !== n || 61620 <= n && 61630 >= n || 61718 != n && 61719 != n && 61472 != n && 61619 != n && i.push(n);
    return i
};
TradingView.LineToolIcon.availIcons = TradingView.LineToolIcon._getAvailIcons();
inherit(TradingView.LineToolIcon, J47);
TradingView.LineToolIcon.version = 1;
TradingView.LineToolIcon.prototype.pointsCount = function () {
    return 1
};
TradingView.LineToolIcon.prototype.title = function () {
    return"Icon"
};
TradingView.LineToolIcon.prototype.startChanging = function (n, t) {
    J47.prototype.startChanging.call(this, n, t);
    var i = this.properties(), r = 65536 * i.icon.value() + i.size.value();
    this._startChangeWidth = this._paneViews[0]._cache[r];
    this._sizeScale = i.size.value() < _87.anchorLimit ? i.size.value() / _87.anchorLimit : 1;
    this._origScale = i.scale.value();
    this._resizeRatio = this._startChangeWidth * this._origScale < _87.anchorLimit ? this._startChangeWidth / _87.anchorLimit : 1
};
TradingView.LineToolIcon.prototype.endChanging = function () {
    J47.prototype.endChanging.call(this);
    delete this._startChangeWidth;
    delete this._sizeScale;
    delete this._resizeRatio
};
TradingView.LineToolIcon.prototype.setPoint = function (n, t, i) {
    var r = this.priceScale(), u;
    r.isPercent() && (u = this.ownerSource().firstValue(), t.price = r.priceRange().convertFromPercent(t.price, u));
    i && i.shift && this.Q2.snapTo45Degrees && this._snapPoint45Degree(t, this.points().item(0));
    i = this.pointToScreenPoint(this.points().item(0))[1];
    r = this.pointToScreenPoint(t)[1];
    0 == n || 1 == n ? (t = r.substract(i).normalized(), i = 2 * r.substract(i).length(), i *= this._sizeScale, this.Q2.size.setValue(i), i = Math.acos(-t.x), 0 < Math.asin(t.y) && (i = 2 * Math.PI - i), 0 == n && (i += Math.PI), this.Q2.angle.setValue(i)) : (n = this._startChangeWidth, t = r.substract(i).length(), this._origScale * n < _87.anchorLimit ? (n = _87.anchorLimit / 2, this.Q2.scale.setValue(this._origScale * t / n)) : this.Q2.scale.setValue(t / (n / 2)))
};
inherit(J10, _90);
J10.prototype.update = function () {
    _90.prototype.update.call(this);
    this._distance = 0;
    3 == this._points.size() && (this._distance = MathEx.distanceToLine(this._points.item(0), this._points.item(1), this._points.item(2)).distance)
};
J10.prototype.renderer = function () {
    var e = new CompositeRenderer, t = this.J99.properties(), o = this._points.item(0), r, n;
    if (2 <= this._points.size() && (r = this._points.item(1)), 2 == this._points.size())n = {}, n.points = this._points, n.floatPoints = this._floatPoints, n.width = this.Q0.timeScale().width(), n.height = this.J99.priceScale().height(), n.color = t.color.value(), n.linewidth = 1, n.linestyle = CanvasEx.LINESTYLE_SOLID, n.extendleft = !1, n.extendright = !1, n.leftend = J47.LINEEND_NORMAL, n.rightend = J47.LINEEND_NORMAL, e.append(new TrendLineRenderer(n)); else if (3 == this._points.size()) {
        this._points.item(2);
        var u = r.substract(o), i = new MathEx.Point(u.y, -u.x).normalized().scaled(this._distance), f = i.scaled(-1), u = o.add(i), i = r.add(i), s = o.add(f), f = r.add(f), n = {};
        n.points = (new List).append(u).append(i).append(f).append(s);
        n.color = t.color.value();
        n.linewidth = this.J99.properties().linewidth.value();
        n.linestyle = CanvasEx.LINESTYLE_SOLID;
        n.filled = !0;
        n.backcolor = t.backgroundColor.value();
        n.fillBackground = t.fillBackground.value();
        n.transparency = t.transparency.value();
        e.append(new PoligonRenderer(n))
    }
    return this.isAnchorsRequired() && (t = new List, t.append(o), 2 <= this._points.size() && t.append(r), 3 == this._points.size() && (u.data = 2, s.data = 2, i.data = 2, f.data = 2, t.append(u), t.append(s), t.append(i), t.append(f)), e.append(this.createLineAnchor({points: t}))), e
};
TradingView.LineToolRotatedRectangle = function (n, t) {
    this._constructor = "LineToolRotatedRectangle";
    var i = t ? t : new _52("linetoolrotatedrectangle");
    J47.call(this, n, new J10(this, n), i)
};
inherit(TradingView.LineToolRotatedRectangle, J47);
TradingView.LineToolRotatedRectangle.prototype.startChanging = function (n, t) {
    if (J47.prototype.startChanging.call(this, n, t), 0 == n || 1 == n) {
        var i = this._paneViews[0], r = i._points.item(0), u = i._points.item(1), i = i._points.item(2);
        this._distance = MathEx.distanceToLine(r, u, i).distance
    }
};
TradingView.LineToolRotatedRectangle.prototype.setPoint = function (n, t, i) {
    J47.prototype.setPoint.call(this, n, t, i);
    (0 == n || 1 == n) && (t = this._paneViews[0], t.update(), n = t._points.item(0), t = t._points.item(1).substract(n), t = new MathEx.Point(t.y, -t.x).normalized().scaled(this._distance), n = n.add(t), n = this.screenPointToPoint(n), this._points.setItem(2, n))
};
TradingView.LineToolRotatedRectangle.prototype.endChanging = function () {
    delete this._distance
};
TradingView.LineToolRotatedRectangle.prototype.pointsCount = function () {
    return 3
};
TradingView.LineToolRotatedRectangle.prototype.title = function () {
    return"Rotated Rectangle"
};
AngleRenderer.prototype.hitTest = function () {
    return null
};
AngleRenderer.prototype.draw = function (n) {
    n.save();
    n.translate(this._data.point.x, this._data.point.y);
    n.strokeStyle = this._data.color;
    var t = [1, 2];
    "function" == typeof n.setLineDash ? n.setLineDash(t) : void 0 !== n.mozDash ? n.mozDash = t : void 0 !== n.webkitLineDash && (n.webkitLineDash = t);
    t = this._data.size;
    n.beginPath();
    n.moveTo(0, 0);
    n.lineTo(t, 0);
    n.arc(0, 0, t, 0, -this._data.angle, 0 < this._data.angle);
    n.stroke();
    n.restore()
};
inherit(J40, _90);
J40.prototype.update = function () {
    var t, f;
    if (_90.prototype.update.call(this), 0 < this._points.size() && void 0 !== this.J99._angle) {
        var n = this._points.item(0), i = Math.cos(this.J99._angle), u = -Math.sin(this.J99._angle), i = new MathEx.Point(i, u);
        this._secondPoint = n.addScaled(i, this.J99._distance);
        this._secondPoint.data = 1
    }
    if (this._label = null, !(2 > this.J99.points().size())) {
        var n = this.J99.points().item(0), u = this.J99.points().item(1), i = [], r, e;
        this.J99.properties().showPriceRange.value() && this.J99.priceScale() && (t = u.price - n.price, r = t / n.price, r = this.J99.priceScale().formatter().format(t) + " (" + (new PercentageFormatter).format(100 * r) + ")", f = this.Q0.mainSeries().base(), f && (t = Math.round(t * f), r += ", " + t), i.push("priceRange"));
        this.J99.properties().showBarsRange.value() && (n = u.index - n.index, e = "" + $.t("{0} bars").format(n), i.push("barsRange"));
        this._label = [r, e].filter(function (n) {
            return n
        }).join("\n") || null;
        this._icons = i
    }
};
J40.prototype.renderer = function () {
    var r = new CompositeRenderer, t, n, i;
    return this._secondPoint && 0 < this._points.size() && (t = {}, t.points = (new List).append(this._points.item(0)).append(this._secondPoint), t.width = this.Q0.timeScale().width(), t.height = this.J99.priceScale().height(), t.color = this.J99.properties().linecolor.value(), t.linewidth = this.J99.properties().linewidth.value(), t.linestyle = this.J99.properties().linestyle.value(), t.extendleft = this.J99.properties().extendLeft.value(), t.extendright = this.J99.properties().extendRight.value(), t.leftend = J47.LINEEND_NORMAL, t.rightend = J47.LINEEND_NORMAL, r.append(new TrendLineRenderer(t)), (this.isAnchorsRequired() || this.J99.properties().alwaysShowStats.value()) && this._label && 2 == this._points.size() && (n = {points: (new List).append(this._secondPoint), text: this._label, color: this.J99.properties().textcolor.value(), font: TradingView.LineToolTrendLine.LABEL_FONT, fontsize: TradingView.LineToolTrendLine.LABEL_FONTSIZE, lineSpacing: TradingView.LineToolTrendLine.LABEL_LINESPACING, backgroundColor: TradingView.LineToolTrendLine.LABEL_BGCOLOR, borderColor: TradingView.LineToolTrendLine.LABEL_BORDERCOLOR, borderWidth: 1, padding: TradingView.LineToolTrendLine.LABEL_PADDING, paddingLeft: 30, doNotAlignText: !0, icons: this._icons}, i = TradingView.LineToolTrendLine.LABEL_OFFSET, this._points.item(1).y < this._points.item(0).y ? (n.vertAlign = "bottom", n.offsetY = -i) : n.offsetY = i, this._points.item(1).x < this._points.item(0).x ? (n.horzAlign = "right", n.offsetX = -i) : n.offsetX = i, r.append(new TrendLineStatsRenderer(n, this._rendererCache))), n = {}, n.point = this._points.item(0), n.angle = this.J99._angle, n.color = this.J99.properties().linecolor.value(), n.size = 50, r.append(new AngleRenderer(n)), n = Math.round(180 * n.angle / Math.PI) + "º", i = this._points.item(0).clone(), i.x += 50, n = {points: (new List).append(i), text: n, color: this.J99.properties().textcolor.value(), horzAlign: "left", font: this.J99.properties().font.value(), offsetX: 5, offsetY: 0, bold: this.J99.properties().bold.value(), italic: this.J99.properties().italic.value(), fontsize: this.J99.properties().fontsize.value(), vertAlign: "middle"}, r.append(new TextRenderer(n, this._rendererCache))), this.isAnchorsRequired() && this._secondPoint && (t = t.points.clone(), this.Q0.lineBeingCreated() == this.J99 && t.removeAt(t.size() - 1), r.append(this.createLineAnchor({points: t}))), r
};
TradingView.LineToolTrendAngle = function (n, t) {
    this._constructor = "LineToolTrendAngleLine";
    var i = t ? t : new _52("linetooltrendangle");
    J47.call(this, n, new J40(this, n), i);
    this.Q2.addProperty("angle");
    this.Q2.angle = new TradingView.LineToolTrendAngle.AngleProperty(this)
};
inherit(TradingView.LineToolTrendAngle, J47);
TradingView.LineToolTrendAngle.AngleProperty = function (n) {
    Property.call(this);
    this._lineSource = n
};
inherit(TradingView.LineToolTrendAngle.AngleProperty, Property);
TradingView.LineToolTrendAngle.AngleProperty.prototype.value = function () {
    return Math.round(180 * this._lineSource._angle / Math.PI)
};
TradingView.LineToolTrendAngle.AngleProperty.prototype.setValue = function (n) {
    this._lineSource._angle = n * Math.PI / 180;
    n = this._lineSource.pointToScreenPoint(this._lineSource.points().item(0))[0];
    var t = Math.cos(this._lineSource._angle), i = -Math.sin(this._lineSource._angle), t = new MathEx.Point(t, i);
    n = n.addScaled(t, this._lineSource._distance);
    n = this._lineSource.screenPointToPoint(n);
    this._lineSource._points.setItem(1, n);
    this._lineSource.Q0.updateSource(this._lineSource);
    this._lineSource.updateAllViews();
    this._lineSource.Q0.updateSource(this._lineSource)
};
TradingView.LineToolTrendAngle.prototype.pointsCount = function () {
    return 2
};
TradingView.LineToolTrendAngle.prototype.title = function () {
    return"Trend Angle"
};
TradingView.LineToolTrendAngle.prototype._calculateAngle = function () {
    var t = this.pointToScreenPoint(this.points().item(0))[0], i = this.pointToScreenPoint(this.points().item(1))[0], n = i.substract(t);
    0 < n.length() ? (n = n.normalized(), this._angle = Math.acos(n.x), 0 < n.y && (this._angle = -this._angle), this._distance = i.substract(t).length()) : delete this._angle;
    this.properties().hasOwnProperty("angle") && this.properties().angle.listeners().fire(this.properties().angle)
};
TradingView.LineToolTrendAngle.prototype.addPoint = function (n, t) {
    var i = J47.prototype.addPoint.call(this, n, t);
    return i && this._calculateAngle(), i
};
TradingView.LineToolTrendAngle.prototype.setLastPoint = function (n, t) {
    J47.prototype.setLastPoint.call(this, n, t);
    1 < this.points().size() && this._calculateAngle()
};
TradingView.LineToolTrendAngle.prototype.setPoint = function (n, t, i) {
    J47.prototype.setPoint.call(this, n, t, i);
    1 < this.points().size() && this._calculateAngle()
};
TradingView.LineToolTrendAngle.prototype.restoreData = function (n) {
    this._angle = n.angle;
    this._distance = n.distance
};
TradingView.LineToolTrendAngle.prototype.state = function (n) {
    return n = J47.prototype.state.call(this, n), n.angle = this._angle, n.distance = this._distance, n
};
TradingView.LineToolTrendAngle.prototype.cloneData = function (n) {
    this._angle = n._angle;
    this._distance = n._distance
};
ChartTradingUtils = {_fontHeightCache: {}, _parseColor: function (n) {
    var t = document.createElement("div");
    return t.style.color = n, n = t.style.color.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i) || t.style.color.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\,\s*(\d*\.?\d+)\s*\)$/i), $(t).remove(), {r: n[1], g: n[2], b: n[3], a: n[4] || "1"}
}, getColorFromProperties: function (n, t) {
    var r = 1 - t.value() / 100, i = this._parseColor(n.value());
    return"rgba(" + i.r + "," + i.g + "," + i.b + "," + r + ")"
}, setColorToProperties: function (n, t, i) {
    n = this._parseColor(n);
    t.setValue("rgb(" + n.r + "," + n.g + "," + n.b + ")");
    i.setValue(Math.max(0, Math.min(100 * (1 - n.a), 100)))
}, _parseFont: function (n) {
    var t = document.createElement("div");
    return t.style.font = n, n = t.style.fontSize.match(/(\d+)pt/), n = {family: t.style.fontFamily, size: n && n[0] == t.style.fontSize ? n[1] : "", bold: "bold" == t.style.fontWeight, italic: "italic" == t.style.fontStyle}, $(t).remove(), n
}, getFontFromProperties: function (n, t, i, r) {
    return i = i.value() ? "bold" : "", r = r.value() ? "italic" : "", t = t.value() + "pt", n = n.value(), [i, r, t, n].join(" ")
}, setFontToProperties: function (n, t, i, r, u) {
    n = this._parseFont(n);
    0 < n.family.length && t.setValue(n.family);
    0 < n.size.length && i.setValue(n.size);
    r.setValue(n.bold);
    u.setValue(n.italic)
}, fontHeight: function (n) {
    var t, i;
    return this._fontHeightCache[n] || (t = document.createElement("span"), t.appendChild(document.createTextNode("height")), document.body.appendChild(t), t.style.cssText = "font: " + n + "; white-space: nowrap; display: inline;", i = t.offsetHeight, document.body.removeChild(t), this._fontHeightCache[n] = Math.ceil(i)), this._fontHeightCache[n]
}, drawPolyHoverOrPress: function (n, t, i, r) {
    r ? (n.save(), n.fillStyle = "rgba(0, 0, 0, 0.15)", CanvasEx.drawPoly(n, t, !0), n.restore()) : i && (n.save(), n.fillStyle = "rgba(0, 0, 0, 0.1)", CanvasEx.drawPoly(n, t, !0), n.restore())
}, repaint: function (n) {
    var t = new D22(D22.LIGHT_UPDATE);
    t.force = !0;
    n.Q20(t)
}, roundToMinTick: function (n, t) {
    var i = 1 / n.mainSource().base();
    return i * Math.round(t / i)
}};
TradingView.LineToolTrading = function (n, t, i) {
    this.customization = {forcePriceAxisLabel: !0, disableSelection: !0, disableErasing: !0};
    J47.call(this, n, t, i)
};
inherit(TradingView.LineToolTrading, J47);
TradingView.LineToolTrading.POINTS_COUNT = 1;
TradingView.LineToolTrading.prototype.pointsCount = function () {
    return TradingView.LineToolTrading.POINTS_COUNT
};
TradingView.LineToolTrading.prototype.hasContextMenu = function () {
    return!1
};
TradingView.LineToolTrading.prototype.state = function () {
    return null
};
TradingView.LineToolTrading.prototype.startMoving = function () {
    J47.prototype.startMoving.apply(this, arguments);
    this._cursorMoved = !1
};
TradingView.LineToolTrading.prototype.endMoving = function () {
    J47.prototype.endMoving.apply(this, arguments);
    this._cursorMoved = !1
};
TradingView.LineToolTrading.prototype.correctPoints = function (n) {
    var r, t, i;
    for (this._currentMovingPoint && this._startMovingPoint ? this._currentMovingPoint.price - this._startMovingPoint.price && (this._cursorMoved = !0) : this._cursorMoved = !1, r = 1 / this.priceScale().mainSource().base(), t = 0; t < n.size(); t++)i = n.item(t), this._cursorMoved && (i.price = this._currentMovingPoint.price), i.price = r * Math.round(i.price / r), n.setItem(t, i)
};
TradingView.LineToolTrading.prototype.userEditEnabled = function () {
    return!0
};
TradingView.LineToolTrading.prototype.isUserDeletable = function () {
    return!1
};
TradingView.LineToolTrading.prototype.showInObjectTree = function () {
    return!1
};
OrderLineAdapter.prototype.getPrice = function () {
    return this._line.points().item(0).price
};
OrderLineAdapter.prototype.setPrice = function (n) {
    var t = this._line.points().item(0);
    return t.price = n, this._line._points.setItem(0, t), this
};
OrderLineAdapter.prototype.getText = function () {
    return this._data.bodyText
};
OrderLineAdapter.prototype.setText = function (n) {
    return this._data.bodyText = n || "", this
};
OrderLineAdapter.prototype.getQuantity = function () {
    return this._data.quantityText
};
OrderLineAdapter.prototype.setQuantity = function (n) {
    return this._data.quantityText = n || "", this
};
OrderLineAdapter.prototype.getExtendLeft = function () {
    var n = this._line.properties().extendLeft.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.extendLeft.value() : n
};
OrderLineAdapter.prototype.setExtendLeft = function (n) {
    return this._line.properties().extendLeft.setValue(n), this
};
OrderLineAdapter.prototype.getLineLength = function () {
    var n = this._line.properties().lineLength.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineLength.value() : n
};
OrderLineAdapter.prototype.setLineLength = function (n) {
    return this._line.properties().lineLength.setValue(Math.max(0, Math.min(n, 100))), this
};
OrderLineAdapter.prototype.getLineColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().lineColor, this._line.properties().lineTransparency)
};
OrderLineAdapter.prototype.setLineColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().lineColor, this._line.properties().lineTransparency), this
};
OrderLineAdapter.prototype.getLineStyle = function () {
    var n = this._line.properties().lineStyle.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineStyle.value() : n
};
OrderLineAdapter.prototype.setLineStyle = function (n) {
    return this._line.properties().lineStyle.setValue(n), this
};
OrderLineAdapter.prototype.getLineWidth = function () {
    var n = this._line.properties().lineWidth.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineWidth.value() : n
};
OrderLineAdapter.prototype.setLineWidth = function (n) {
    return this._line.properties().lineWidth.setValue(n), this
};
OrderLineAdapter.prototype.getBodyBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBorderColor, this._line.properties().bodyBorderTransparency)
};
OrderLineAdapter.prototype.setBodyBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyBorderColor, this._line.properties().bodyBorderTransparency), this
};
OrderLineAdapter.prototype.getBodyBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBackgroundColor, this._line.properties().bodyBackgroundTransparency)
};
OrderLineAdapter.prototype.setBodyBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyBackgroundColor, this._line.properties().bodyBackgroundTransparency), this
};
OrderLineAdapter.prototype.getBodyTextColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyTextColor, this._line.properties().bodyTextTransparency)
};
OrderLineAdapter.prototype.setBodyTextColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyTextColor, this._line.properties().bodyTextTransparency), this
};
OrderLineAdapter.prototype.getBodyFont = function () {
    return ChartTradingUtils.getFontFromProperties(this._line.properties().bodyFontFamily, this._line.properties().bodyFontSize, this._line.properties().bodyFontBold, this._line.properties().bodyFontItalic)
};
OrderLineAdapter.prototype.setBodyFont = function (n) {
    return ChartTradingUtils.setFontToProperties(n, this._line.properties().bodyFontFamily, this._line.properties().bodyFontSize, this._line.properties().bodyFontBold, this._line.properties().bodyFontItalic), this
};
OrderLineAdapter.prototype.getQuantityBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBorderColor, this._line.properties().quantityBorderTransparency)
};
OrderLineAdapter.prototype.setQuantityBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityBorderColor, this._line.properties().quantityBorderTransparency), this
};
OrderLineAdapter.prototype.getQuantityBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBackgroundColor, this._line.properties().quantityBackgroundTransparency)
};
OrderLineAdapter.prototype.setQuantityBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityBackgroundColor, this._line.properties().quantityBackgroundTransparency), this
};
OrderLineAdapter.prototype.getQuantityTextColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityTextColor, this._line.properties().quantityTextTransparency)
};
OrderLineAdapter.prototype.setQuantityTextColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityTextColor, this._line.properties().quantityTextTransparency), this
};
OrderLineAdapter.prototype.getQuantityFont = function () {
    return ChartTradingUtils.getFontFromProperties(this._line.properties().quantityFontFamily, this._line.properties().quantityFontSize, this._line.properties().quantityFontBold, this._line.properties().quantityFontItalic)
};
OrderLineAdapter.prototype.setQuantityFont = function (n) {
    return ChartTradingUtils.setFontToProperties(n, this._line.properties().quantityFontFamily, this._line.properties().quantityFontSize, this._line.properties().quantityFontBold, this._line.properties().quantityFontItalic), this
};
OrderLineAdapter.prototype.getCancelButtonBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonBorderColor, this._line.properties().cancelButtonBorderTransparency)
};
OrderLineAdapter.prototype.setCancelButtonBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().cancelButtonBorderColor, this._line.properties().cancelButtonBorderTransparency), this
};
OrderLineAdapter.prototype.getCancelButtonBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonBackgroundColor, this._line.properties().cancelButtonBackgroundTransparency)
};
OrderLineAdapter.prototype.setCancelButtonBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().cancelButtonBackgroundColor, this._line.properties().cancelButtonBackgroundTransparency), this
};
OrderLineAdapter.prototype.getCancelButtonIconColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().cancelButtonIconColor, this._line.properties().cancelButtonIconTransparency)
};
OrderLineAdapter.prototype.setCancelButtonIconColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().cancelButtonIconColor, this._line.properties().cancelButtonIconTransparency), this
};
OrderLineAdapter.prototype.isFunction = function (n) {
    return"function" == typeof n
};
OrderLineAdapter.prototype.onCancel = function (n, t) {
    return t ? this.isFunction(t) && (this._onCancelData = n, this._onCancelCallback = t) : this.isFunction(n) && (this._onCancelCallback = n), this
};
OrderLineAdapter.prototype.callOnCancel = function () {
    this.isFunction(this._onCancelCallback) && this._onCancelCallback.call(this, this._onCancelData)
};
OrderLineAdapter.prototype.isOnCancelCallbackPresent = function () {
    return this.isFunction(this._onCancelCallback)
};
OrderLineAdapter.prototype.onModify = function (n, t) {
    return t ? this.isFunction(t) && (this._onModifyData = n, this._onModifyCallback = t) : this.isFunction(n) && (this._onModifyCallback = n), this
};
OrderLineAdapter.prototype.callOnModify = function () {
    this.isFunction(this._onModifyCallback) && this._onModifyCallback.call(this, this._onModifyData)
};
OrderLineAdapter.prototype.onMove = function (n, t) {
    return t ? this.isFunction(t) && (this._onMoveData = n, this._onMoveCallback = t) : this.isFunction(n) && (this._onMoveCallback = n), this
};
OrderLineAdapter.prototype.callOnMove = function () {
    this.isFunction(this._onMoveCallback) && this._onMoveCallback.call(this, this._onMoveData)
};
OrderLineAdapter.prototype.onContextMenu = function (n, t) {
    return t ? this.isFunction(t) && (this._onContextMenuData = n, this._onContextMenuCallback = t) : this.isFunction(n) && (this._onContextMenuCallback = n), this
};
OrderLineAdapter.prototype.callOnContextMenu = function () {
    if (this.isFunction(this._onContextMenuCallback))return this._onContextMenuCallback.call(this, this._onContextMenuData)
};
OrderLineAdapter.prototype.remove = function () {
    this._line.Q0.removeSource(this._line);
    delete this._line
};
OrderRenderer.prototype._height = function () {
    return Math.max(20, 1 + Math.max(ChartTradingUtils.fontHeight(this._adapter.getBodyFont()), ChartTradingUtils.fontHeight(this._adapter.getQuantityFont())))
};
OrderRenderer.prototype._bodyWidth = function (n) {
    if (0 == this._adapter.getText().length)return 0;
    n.save();
    n.font = this._adapter.getBodyFont();
    var t = n.measureText(this._adapter.getText()).width;
    return n.restore(), Math.round(20 + t)
};
OrderRenderer.prototype._quantityWidth = function (n) {
    if (0 == this._adapter.getQuantity().length)return 0;
    n.save();
    n.font = this._adapter.getQuantityFont();
    var t = n.measureText(this._adapter.getQuantity()).width;
    return n.restore(), Math.round(Math.max(this._height(), 10 + t))
};
OrderRenderer.prototype._cancelButtonWidth = function () {
    return this._adapter.isOnCancelCallbackPresent() ? this._height() : 0
};
OrderRenderer.prototype._drawLines = function (n, t, i, r, u) {
    n.save();
    n.strokeStyle = this._adapter.getLineColor();
    n.lineStyle = this._adapter.getLineStyle();
    n.lineWidth = this._adapter.getLineWidth();
    CanvasEx.drawLine(n, i, r, u, r);
    this._adapter.getExtendLeft() && CanvasEx.drawLine(n, 0, r, t, r);
    n.restore()
};
OrderRenderer.prototype._drawMovePoints = function (n, t, i) {
    var u;
    n.save();
    n.strokeStyle = this._adapter.getBodyBorderColor();
    n.fillStyle = this._adapter.getBodyBorderColor();
    t += 4;
    for (var f = t + 2, e = Math.floor((this._height() - 10) / 2) + 1, r = 0; r < e; ++r)u = i + 5 + 2 * r, CanvasEx.drawLine(n, t, u, f, u);
    n.restore()
};
OrderRenderer.prototype._drawBody = function (n, t, i) {
    n.strokeStyle = this._adapter.getBodyBorderColor();
    n.fillStyle = this._adapter.getBodyBackgroundColor();
    var r = this._bodyWidth(n), u = this._height();
    n.fillRect(t + .5, i + .5, r - 1, u - 1);
    n.strokeRect(t, i, r, u)
};
OrderRenderer.prototype._drawBodyText = function (n, t, i) {
    n.textAlign = "center";
    n.textBaseline = "middle";
    n.font = this._adapter.getBodyFont();
    n.fillStyle = this._adapter.getBodyTextColor();
    t += this._bodyWidth(n) / 2;
    i += this._height() / 2;
    n.fillText(this._adapter.getText(), 5 + t - 2, i)
};
OrderRenderer.prototype._drawQuantity = function (n, t, i, r) {
    n.save();
    n.strokeStyle = this._adapter.getQuantityBorderColor();
    n.fillStyle = this._adapter.getQuantityBackgroundColor();
    var u = this._quantityWidth(n), f = this._height();
    n.fillRect(t + .5, i + .5, u - 1, f - 1);
    r && n.clip && (n.beginPath(), n.rect(t + .5, i - .5, u + 1, f + 1), n.clip());
    n.strokeRect(t, i, u, f);
    n.restore()
};
OrderRenderer.prototype._drawQuantityText = function (n, t, i) {
    n.save();
    n.textAlign = "center";
    n.textBaseline = "middle";
    n.font = this._adapter.getQuantityFont();
    n.fillStyle = this._adapter.getQuantityTextColor();
    t += this._quantityWidth(n) / 2;
    i += this._height() / 2;
    n.fillText(this._adapter.getQuantity(), t, i);
    n.restore()
};
OrderRenderer.prototype._drawCancelButton = function (n, t, i, r) {
    var f, u, e;
    n.strokeStyle = this._adapter.getCancelButtonBorderColor();
    n.fillStyle = this._adapter.getCancelButtonBackgroundColor();
    u = this._cancelButtonWidth();
    f = this._height();
    n.fillRect(t + .5, i + .5, u - 1, f - 1);
    n.save();
    r && n.clip && (n.beginPath(), n.rect(t + .5, i - .5, u + 1, f + 1), n.clip());
    n.strokeRect(t, i, u, f);
    n.restore();
    r = t + u;
    f = i + f;
    n.strokeStyle = this._adapter.getCancelButtonIconColor();
    u = (this._cancelButtonWidth() - 8) / 2;
    e = (this._height() - 8) / 2;
    CanvasEx.drawPoly(n, [
        {x: t + u, y: i + e},
        {x: r - u, y: f - e}
    ], !0);
    CanvasEx.drawPoly(n, [
        {x: r - u, y: i + e},
        {x: t + u, y: f - e}
    ], !0)
};
OrderRenderer.prototype.draw = function (n) {
    if (this._data.points && !(1 > this._data.points.size())) {
        var i = n.canvas.width, u = this._bodyWidth(n), f = this._quantityWidth(n), t = u + f + this._cancelButtonWidth(), e = i - t, r = Math.max(this._adapter.getLineLength() / 100 * i, 1), e = Math.round(i - Math.min(e, r)), t = e - t, o = Math.round(this._data.points.item(0).y), r = Math.round(o - (this._height() + 1) / 2);
        this._cache.bodyRight = t + u;
        this._cache.quantityRight = t + u + f;
        this._cache.top = r;
        this._cache.bottom = r + this._height();
        this._cache.left = t;
        this._cache.right = e;
        this._drawLines(n, t, e, o, i);
        i = !1;
        0 != u && (this._drawBody(n, t, r), this._drawMovePoints(n, t, r), this._drawBodyText(n, t, r), i = !0);
        0 != f && (this._drawQuantity(n, t + u, r, i), this._drawQuantityText(n, t + u, r), i = !0);
        0 != this._cancelButtonWidth() && this._drawCancelButton(n, t + u + f, r, i)
    }
};
OrderRenderer.prototype.hitTest = function (n) {
    return 0 === this._data.points.size() || n.y < this._cache.top || n.y > this._cache.bottom ? null : n.x >= this._cache.left && n.x < this._cache.bodyRight ? new HitTestResult(HitTestResult.MOVEPOINT) : n.x >= this._cache.bodyRight && n.x < this._cache.quantityRight ? new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: this._adapter.callOnModify.bind(this._adapter), tooltip: {text: "Edit Order", rect: new TradingView.Rect(this._cache.bodyRight, this._cache.top, this._cache.quantityRight - this._cache.bodyRight, this._cache.bottom - this._cache.top)}}) : n.x >= this._cache.quantityRight && n.x < this._cache.right ? new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: this._adapter.callOnCancel.bind(this._adapter), tooltip: {text: "Cancel Order", rect: new TradingView.Rect(this._cache.quantityRight, this._cache.top, this._cache.right - this._cache.quantityRight, this._cache.bottom - this._cache.top)}}) : null
};
inherit(OrderPriceAxisView, J48);
OrderPriceAxisView.prototype._updateImpl = function () {
    J48.prototype._updateImpl.call(this);
    this._background = this._linetool.properties().lineColor.value()
};
inherit(OrderPaneView, _90);
OrderPaneView.prototype.renderer = function () {
    return new OrderRenderer({points: this._points}, this._rendererCache, this.J99._adapter)
};
TradingView.LineToolOrder = function (n, t) {
    this._adapter = new OrderLineAdapter(this);
    this._constructor = "LineToolOrder";
    var i = t || new _52("linetoolorder");
    TradingView.LineToolTrading.call(this, n, new OrderPaneView(this, n), i)
};
inherit(TradingView.LineToolOrder, TradingView.LineToolTrading);
TradingView.LineToolOrder.skipMagnetting = !0;
TradingView.LineToolOrder.prototype.title = function () {
    return"Order"
};
TradingView.LineToolOrder.prototype.endMoving = function (n) {
    var t = this._startMovingPoint && this._currentMovingPoint && this._startMovingPoint.price != this._currentMovingPoint.price;
    TradingView.LineToolTrading.prototype.endMoving.call(this);
    !n && t && this._adapter.callOnMove()
};
TradingView.LineToolOrder.prototype.createPriceAxisView = function (n) {
    return this._priceAxisView = new OrderPriceAxisView(this, n)
};
TradingView.LineToolOrder.prototype.paneViews = function (n) {
    return TradingView.printing || !this.Q0.properties().tradingProperties.showOrders.value() ? null : J47.prototype.paneViews.call(this, n)
};
TradingView.LineToolOrder.prototype.priceAxisViews = function (n, t) {
    return TradingView.printing || !this.Q0.properties().tradingProperties.showOrders.value() ? null : J47.prototype.priceAxisViews.call(this, n, t)
};
TradingView.LineToolOrder.prototype.hasContextMenu = function () {
    return!0
};
TradingView.LineToolOrder.prototype.contextMenuItems = function () {
    return this._adapter.callOnContextMenu()
};
PositionLineAdapter.prototype.getPrice = function () {
    return this._line.points().item(0).price
};
PositionLineAdapter.prototype.setPrice = function (n) {
    var t = this._line.points().item(0);
    return t.price = n, this._line._points.setItem(0, t), this
};
PositionLineAdapter.prototype.getText = function () {
    return this._data.bodyText
};
PositionLineAdapter.prototype.setText = function (n) {
    return this._data.bodyText = n || "", this
};
PositionLineAdapter.prototype.getQuantity = function () {
    return this._data.quantityText
};
PositionLineAdapter.prototype.setQuantity = function (n) {
    return this._data.quantityText = n || "", this
};
PositionLineAdapter.prototype.getExtendLeft = function () {
    var n = this._line.properties().extendLeft.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.extendLeft.value() : n
};
PositionLineAdapter.prototype.setExtendLeft = function (n) {
    return this._line.properties().extendLeft.setValue(n), this
};
PositionLineAdapter.prototype.getLineLength = function () {
    var n = this._line.properties().lineLength.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineLength.value() : n
};
PositionLineAdapter.prototype.setLineLength = function (n) {
    return this._line.properties().lineLength.setValue(Math.max(0, Math.min(n, 100))), this
};
PositionLineAdapter.prototype.getLineColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().lineColor, this._line.properties().lineTransparency)
};
PositionLineAdapter.prototype.setLineColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().lineColor, this._line.properties().lineTransparency), this
};
PositionLineAdapter.prototype.getLineStyle = function () {
    var n = this._line.properties().lineStyle.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineStyle.value() : n
};
PositionLineAdapter.prototype.setLineStyle = function (n) {
    return this._line.properties().lineStyle.setValue(n), this
};
PositionLineAdapter.prototype.getLineWidth = function () {
    var n = this._line.properties().lineWidth.value();
    return"inherit" == n ? this._line.Q0.properties().tradingProperties.lineWidth.value() : n
};
PositionLineAdapter.prototype.setLineWidth = function (n) {
    return this._line.properties().lineWidth.setValue(n), this
};
PositionLineAdapter.prototype.getBodyBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBorderColor, this._line.properties().bodyBorderTransparency)
};
PositionLineAdapter.prototype.setBodyBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyBorderColor, this._line.properties().bodyBorderTransparency), this
};
PositionLineAdapter.prototype.getBodyBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyBackgroundColor, this._line.properties().bodyBackgroundTransparency)
};
PositionLineAdapter.prototype.setBodyBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyBackgroundColor, this._line.properties().bodyBackgroundTransparency), this
};
PositionLineAdapter.prototype.getBodyTextColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().bodyTextColor, this._line.properties().bodyTextTransparency)
};
PositionLineAdapter.prototype.setBodyTextColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().bodyTextColor, this._line.properties().bodyTextTransparency), this
};
PositionLineAdapter.prototype.getBodyFont = function () {
    return ChartTradingUtils.getFontFromProperties(this._line.properties().bodyFontFamily, this._line.properties().bodyFontSize, this._line.properties().bodyFontBold, this._line.properties().bodyFontItalic)
};
PositionLineAdapter.prototype.setBodyFont = function (n) {
    return ChartTradingUtils.setFontToProperties(n, this._line.properties().bodyFontFamily, this._line.properties().bodyFontSize, this._line.properties().bodyFontBold, this._line.properties().bodyFontItalic), this
};
PositionLineAdapter.prototype.getQuantityBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBorderColor, this._line.properties().quantityBorderTransparency)
};
PositionLineAdapter.prototype.setQuantityBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityBorderColor, this._line.properties().quantityBorderTransparency), this
};
PositionLineAdapter.prototype.getQuantityBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityBackgroundColor, this._line.properties().quantityBackgroundTransparency)
};
PositionLineAdapter.prototype.setQuantityBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityBackgroundColor, this._line.properties().quantityBackgroundTransparency), this
};
PositionLineAdapter.prototype.getQuantityTextColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().quantityTextColor, this._line.properties().quantityTextTransparency)
};
PositionLineAdapter.prototype.setQuantityTextColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().quantityTextColor, this._line.properties().quantityTextTransparency), this
};
PositionLineAdapter.prototype.getQuantityFont = function () {
    return ChartTradingUtils.getFontFromProperties(this._line.properties().quantityFontFamily, this._line.properties().quantityFontSize, this._line.properties().quantityFontBold, this._line.properties().quantityFontItalic)
};
PositionLineAdapter.prototype.setQuantityFont = function (n) {
    return ChartTradingUtils.setFontToProperties(n, this._line.properties().quantityFontFamily, this._line.properties().quantityFontSize, this._line.properties().quantityFontBold, this._line.properties().quantityFontItalic), this
};
PositionLineAdapter.prototype.getReverseButtonBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonBorderColor, this._line.properties().reverseButtonBorderTransparency)
};
PositionLineAdapter.prototype.setReverseButtonBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().reverseButtonBorderColor, this._line.properties().reverseButtonBorderTransparency), this
};
PositionLineAdapter.prototype.getReverseButtonBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonBackgroundColor, this._line.properties().reverseButtonBackgroundTransparency)
};
PositionLineAdapter.prototype.setReverseButtonBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().reverseButtonBackgroundColor, this._line.properties().reverseButtonBackgroundTransparency), this
};
PositionLineAdapter.prototype.getReverseButtonIconColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().reverseButtonIconColor, this._line.properties().reverseButtonIconTransparency)
};
PositionLineAdapter.prototype.setReverseButtonIconColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().reverseButtonIconColor, this._line.properties().reverseButtonIconTransparency), this
};
PositionLineAdapter.prototype.getCloseButtonBorderColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonBorderColor, this._line.properties().closeButtonBorderTransparency)
};
PositionLineAdapter.prototype.setCloseButtonBorderColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().closeButtonBorderColor, this._line.properties().closeButtonBorderTransparency), this
};
PositionLineAdapter.prototype.getCloseButtonBackgroundColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonBackgroundColor, this._line.properties().closeButtonBackgroundTransparency)
};
PositionLineAdapter.prototype.setCloseButtonBackgroundColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().closeButtonBackgroundColor, this._line.properties().closeButtonBackgroundTransparency), this
};
PositionLineAdapter.prototype.getCloseButtonIconColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().closeButtonIconColor, this._line.properties().closeButtonIconTransparency)
};
PositionLineAdapter.prototype.setCloseButtonIconColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().closeButtonIconColor, this._line.properties().closeButtonIconTransparency), this
};
PositionLineAdapter.prototype.isFunction = function (n) {
    return"function" == typeof n
};
PositionLineAdapter.prototype.onReverse = function (n, t) {
    return t ? this.isFunction(t) && (this._onReverseData = n, this._onReverseCallback = t) : this.isFunction(n) && (this._onReverseCallback = n), this
};
PositionLineAdapter.prototype.callOnReverse = function () {
    this.isFunction(this._onReverseCallback) && this._onReverseCallback.call(this, this._onReverseData)
};
PositionLineAdapter.prototype.isOnReverseCallbackPresent = function () {
    return this.isFunction(this._onReverseCallback)
};
PositionLineAdapter.prototype.onClose = function (n, t) {
    return t ? this.isFunction(t) && (this._onCloseData = n, this._onCloseCallback = t) : this.isFunction(n) && (this._onCloseCallback = n), this
};
PositionLineAdapter.prototype.callOnClose = function () {
    this.isFunction(this._onCloseCallback) && this._onCloseCallback.call(this, this._onCloseData)
};
PositionLineAdapter.prototype.isOnCloseCallbackPresent = function () {
    return this.isFunction(this._onCloseCallback)
};
PositionLineAdapter.prototype.onModify = function (n, t) {
    return t ? this.isFunction(t) && (this._onModifyData = n, this._onModifyCallback = t) : this.isFunction(n) && (this._onModifyCallback = n), this
};
PositionLineAdapter.prototype.callOnModify = function () {
    this.isFunction(this._onModifyCallback) && this._onModifyCallback.call(this, this._onModifyData)
};
PositionLineAdapter.prototype.onContextMenu = function (n, t) {
    return t ? this.isFunction(t) && (this._onContextMenuData = n, this._onContextMenuCallback = t) : this.isFunction(n) && (this._onContextMenuCallback = n), this
};
PositionLineAdapter.prototype.callOnContextMenu = function () {
    if (this.isFunction(this._onContextMenuCallback))return this._onContextMenuCallback.call(this, this._onContextMenuData)
};
PositionLineAdapter.prototype.remove = function () {
    this._line.Q0.removeSource(this._line);
    delete this._line
};
PositionRenderer.prototype._height = function () {
    return Math.max(20, 1 + Math.max(ChartTradingUtils.fontHeight(this._adapter.getBodyFont()), ChartTradingUtils.fontHeight(this._adapter.getQuantityFont())))
};
PositionRenderer.prototype._bodyWidth = function (n) {
    if (0 == this._adapter.getText().length)return 0;
    n.save();
    n.font = this._adapter.getBodyFont();
    var t = n.measureText(this._adapter.getText()).width;
    return n.restore(), Math.round(10 + t)
};
PositionRenderer.prototype._quantityWidth = function (n) {
    if (0 == this._adapter.getQuantity().length)return 0;
    n.save();
    n.font = this._adapter.getQuantityFont();
    var t = n.measureText(this._adapter.getQuantity()).width;
    return n.restore(), Math.round(Math.max(this._height(), 10 + t))
};
PositionRenderer.prototype._reverseButtonWidth = function () {
    return this._adapter.isOnReverseCallbackPresent() ? this._height() : 0
};
PositionRenderer.prototype._closeButtonWidth = function () {
    return this._adapter.isOnCloseCallbackPresent() ? this._height() : 0
};
PositionRenderer.prototype._drawLines = function (n, t, i, r, u) {
    n.save();
    n.strokeStyle = this._adapter.getLineColor();
    n.lineStyle = this._adapter.getLineStyle();
    n.lineWidth = this._adapter.getLineWidth();
    CanvasEx.drawLine(n, i, r, u, r);
    this._adapter.getExtendLeft() && CanvasEx.drawLine(n, 0, r, t, r);
    n.restore()
};
PositionRenderer.prototype._drawBody = function (n, t, i) {
    n.strokeStyle = this._adapter.getBodyBorderColor();
    n.fillStyle = this._adapter.getBodyBackgroundColor();
    var r = this._bodyWidth(n), u = this._height();
    n.fillRect(t + .5, i + .5, r - 1, u - 1);
    n.strokeRect(t, i, r, u)
};
PositionRenderer.prototype._drawBodyText = function (n, t, i) {
    n.save();
    n.textAlign = "center";
    n.textBaseline = "middle";
    n.font = this._adapter.getBodyFont();
    n.fillStyle = this._adapter.getBodyTextColor();
    t += this._bodyWidth(n) / 2;
    i += this._height() / 2;
    n.fillText(this._adapter.getText(), t, i);
    n.restore()
};
PositionRenderer.prototype._drawQuantity = function (n, t, i) {
    n.strokeStyle = this._adapter.getQuantityBorderColor();
    n.fillStyle = this._adapter.getQuantityBackgroundColor();
    var r = this._quantityWidth(n), u = this._height();
    n.fillRect(t + .5, i + .5, r - 1, u - 1);
    n.strokeRect(t, i, r, u)
};
PositionRenderer.prototype._drawQuantityText = function (n, t, i) {
    n.save();
    n.textAlign = "center";
    n.textBaseline = "middle";
    n.font = this._adapter.getQuantityFont();
    n.fillStyle = this._adapter.getQuantityTextColor();
    t += this._quantityWidth(n) / 2;
    i += this._height() / 2;
    n.fillText(this._adapter.getQuantity(), t, i);
    n.restore()
};
PositionRenderer.prototype._drawReverseButton = function (n, t, i) {
    n.save();
    n.strokeStyle = this._adapter.getReverseButtonBorderColor();
    n.fillStyle = this._adapter.getReverseButtonBackgroundColor();
    var r = this._reverseButtonWidth(), u = this._height();
    n.fillRect(t + .5, i + .5, r - 1, u - 1);
    n.strokeRect(t, i, r, u);
    n.strokeStyle = this._adapter.getReverseButtonIconColor();
    r = function (n, t) {
        CanvasEx.drawLine(n, 0, 0, 0, t);
        CanvasEx.drawLine(n, -1, 1, 1, 1);
        CanvasEx.drawLine(n, -2, 2, 2, 2)
    };
    t += Math.round((this._reverseButtonWidth() - 6) / 2);
    i += 5;
    n.save();
    n.transform(1, 0, 0, 1, t, i);
    r(n, 10);
    n.transform(1, 0, 0, 1, 6, 10);
    n.rotate(Math.PI);
    r(n, 10);
    n.restore();
    n.restore()
};
PositionRenderer.prototype._drawCloseButton = function (n, t, i) {
    var r, u, f, e;
    n.save();
    n.strokeStyle = this._adapter.getCloseButtonBorderColor();
    n.fillStyle = this._adapter.getCloseButtonBackgroundColor();
    r = this._closeButtonWidth();
    u = this._height();
    n.fillRect(t + .5, i + .5, r - 1, u - 1);
    n.strokeRect(t, i, r, u);
    r = t + r;
    u = i + u;
    n.strokeStyle = this._adapter.getCloseButtonIconColor();
    f = (this._closeButtonWidth() - 8) / 2;
    e = (this._height() - 8) / 2;
    CanvasEx.drawPoly(n, [
        {x: t + f, y: i + e},
        {x: r - f, y: u - e}
    ], !0);
    CanvasEx.drawPoly(n, [
        {x: r - f, y: i + e},
        {x: t + f, y: u - e}
    ], !0);
    n.restore()
};
PositionRenderer.prototype.draw = function (n) {
    if (this._data.points && !(1 > this._data.points.size())) {
        var r = n.canvas.width, f = this._bodyWidth(n), e = this._quantityWidth(n), o = this._reverseButtonWidth(n), i = f + e + o + this._closeButtonWidth(), u = r - i, s = Math.max(this._adapter.getLineLength() / 100 * r, 1), u = Math.round(r - Math.min(u, s)), i = u - i, s = Math.round(this._data.points.item(0).y), t = Math.round(s - (this._height() + 1) / 2);
        this._cache.bodyRight = i + f;
        this._cache.quantityRight = this._cache.bodyRight + e;
        this._cache.reverseButtonRight = this._cache.quantityRight + o;
        this._cache.top = t;
        this._cache.bottom = t + this._height();
        this._cache.left = i;
        this._cache.right = u;
        this._drawLines(n, i, u, s, r);
        0 != f && (this._drawBody(n, i, t), this._drawBodyText(n, i, t));
        0 != e && (this._drawQuantity(n, this._cache.bodyRight, t), this._drawQuantityText(n, this._cache.bodyRight, t));
        0 != o && this._drawReverseButton(n, this._cache.quantityRight, t);
        0 != this._closeButtonWidth() && this._drawCloseButton(n, this._cache.reverseButtonRight, t)
    }
};
PositionRenderer.prototype.hitTest = function (n) {
    return 0 === this._data.points.size() || n.y < this._cache.top || n.y > this._cache.bottom ? null : n.x >= this._cache.bodyRight && n.x < this._cache.quantityRight ? new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: this._adapter.callOnModify.bind(this._adapter), tooltip: {text: "Edit Position", rect: new TradingView.Rect(this._cache.bodyRight, this._cache.top, this._cache.quantityRight - this._cache.bodyRight, this._cache.bottom - this._cache.top)}}) : n.x >= this._cache.quantityRight && n.x < this._cache.reverseButtonRight ? new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: this._adapter.callOnReverse.bind(this._adapter), tooltip: {text: "Reverse Position", rect: new TradingView.Rect(this._cache.quantityRight, this._cache.top, this._cache.reverseButtonRight - this._cache.quantityRight, this._cache.bottom - this._cache.top)}}) : n.x >= this._cache.reverseButtonRight && n.x < this._cache.right ? new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: this._adapter.callOnClose.bind(this._adapter), tooltip: {text: "Close Position", rect: new TradingView.Rect(this._cache.reverseButtonRight, this._cache.top, this._cache.right - this._cache.reverseButtonRight, this._cache.bottom - this._cache.top)}}) : null
};
inherit(PositionPriceAxisView, J48);
PositionPriceAxisView.prototype._updateImpl = function () {
    J48.prototype._updateImpl.call(this);
    this._background = this._linetool.properties().lineColor.value()
};
inherit(PositionPaneView, _90);
PositionPaneView.prototype.renderer = function () {
    return new PositionRenderer({points: this._points}, this._rendererCache, this.J99._adapter)
};
TradingView.LineToolPosition = function (n, t) {
    this._adapter = new PositionLineAdapter(this);
    this._constructor = "LineToolPosition";
    var i = t || new _52("linetoolposition");
    TradingView.LineToolTrading.call(this, n, new PositionPaneView(this, n), i)
};
inherit(TradingView.LineToolPosition, TradingView.LineToolTrading);
TradingView.LineToolPosition.skipMagnetting = !0;
TradingView.LineToolPosition.prototype.title = function () {
    return"Position"
};
TradingView.LineToolPosition.prototype.createPriceAxisView = function (n) {
    return this._priceAxisView = new PositionPriceAxisView(this, n)
};
TradingView.LineToolPosition.prototype.paneViews = function (n) {
    return TradingView.printing || !this.Q0.properties().tradingProperties.showPositions.value() ? null : J47.prototype.paneViews.call(this, n)
};
TradingView.LineToolPosition.prototype.priceAxisViews = function (n, t) {
    return TradingView.printing || !this.Q0.properties().tradingProperties.showPositions.value() ? null : J47.prototype.priceAxisViews.call(this, n, t)
};
TradingView.LineToolPosition.prototype.hasContextMenu = function () {
    return!0
};
TradingView.LineToolPosition.prototype.contextMenuItems = function () {
    return this._adapter.callOnContextMenu()
};
ExecutionsPositionController.prototype.getYCoordinate = function (n) {
    var i = 0, f = n.getDirection(), e = n._index, r = this._pane.mainDataSource(), u, t;
    for (r.bars && (u = "buy" == f ? 10 : -10, t = r.bars().search(e, SEARCH_NEAREST_LEFT), t && (e = t.index, i = "buy" == f ? t.value[LOW_PLOT] : t.value[HIGH_PLOT], i = r.priceScale().priceToCoordinate(i) + u)), r = this._pane.orderedSources(), u = r.length - 1; 0 <= u; --u)if (t = r[u], t instanceof TradingView.LineToolExecution && t._adapter.getDirection() == f && t._adapter._index == e) {
        if (t == n._line)break;
        i = "buy" == f ? i + t._adapter._height() : i - t._adapter._height()
    }
    return i
};
ExecutionLineAdapter.prototype._height = function () {
    var n = this.getArrowHeight(), t = this.getArrowSpacing();
    return this.getText() && ChartTradingUtils.fontHeight(this.getFont()), n + t + 0 + 10
};
ExecutionLineAdapter.prototype.getIndex = function () {
    var n = this._line.Q0.timeScale().m_points.lastTimePointIndex(), t = this._line.points().item(0).index;
    return n - t
};
ExecutionLineAdapter.prototype.setIndex = function (n) {
    n = this._line.Q0.timeScale().m_points.lastTimePointIndex() - Math.abs(n);
    this._line.startMoving(this._line.points().item(0));
    var t = TradingView.merge({}, this._line.points().item(0));
    return t.index = n, this._line.move(t), this._line.endMoving(), this
};
ExecutionLineAdapter.prototype.getTime = function () {
    return this._unixtime
};
ExecutionLineAdapter.prototype.setTime = function (n) {
    return this._unixtime = n, this._line.restorePoints([
        {offset: 0, price: this.getPrice(), time_t: n}
    ], []), this._line.createServerPoints(), this
};
ExecutionLineAdapter.prototype.getPrice = function () {
    return 0 < this._line.points().size() ? this._line.points().item(0).price : 0 < this._line._timePoint.size() ? this._line._timePoint.item(0).price : void 0
};
ExecutionLineAdapter.prototype.setPrice = function (n) {
    return 0 < this._line.points().size() && (this._line.points().item(0).price = n), 0 < this._line._timePoint.size() && (this._line._timePoint.item(0).price = n), this
};
ExecutionLineAdapter.prototype.getText = function () {
    return this._line.properties().text.value()
};
ExecutionLineAdapter.prototype.setText = function (n) {
    return this._line.properties().text.setValue(n || ""), this
};
ExecutionLineAdapter.prototype.getArrowHeight = function () {
    return this._line.properties().arrowHeight.value()
};
ExecutionLineAdapter.prototype.setArrowHeight = function (n) {
    return this._line.properties().arrowHeight.setValue(n || 5), this
};
ExecutionLineAdapter.prototype.getArrowSpacing = function () {
    return this._line.properties().arrowSpacing.value()
};
ExecutionLineAdapter.prototype.setArrowSpacing = function (n) {
    return this._line.properties().arrowSpacing.setValue(n || 1), this
};
ExecutionLineAdapter.prototype.getDirection = function () {
    return this._line.properties().direction.value()
};
ExecutionLineAdapter.prototype.setDirection = function (n) {
    return this._line.properties().direction.setValue(n || "buy"), this
};
ExecutionLineAdapter.prototype.getArrowColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().arrowColor, this._line.properties().arrowTransparency)
};
ExecutionLineAdapter.prototype.setArrowColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().arrowColor, this._line.properties().arrowTransparency), this
};
ExecutionLineAdapter.prototype.getTextColor = function () {
    return ChartTradingUtils.getColorFromProperties(this._line.properties().textColor, this._line.properties().textTransparency)
};
ExecutionLineAdapter.prototype.setTextColor = function (n) {
    return ChartTradingUtils.setColorToProperties(n, this._line.properties().textColor, this._line.properties().textTransparency), this
};
ExecutionLineAdapter.prototype.getFont = function () {
    return ChartTradingUtils.getFontFromProperties(this._line.properties().fontFamily, this._line.properties().fontSize, this._line.properties().fontBold, this._line.properties().fontItalic)
};
ExecutionLineAdapter.prototype.setFont = function (n) {
    return ChartTradingUtils.setFontToProperties(n, this._line.properties().fontFamily, this._line.properties().fontSize, this._line.properties().fontBold, this._line.properties().fontItalic), this
};
ExecutionLineAdapter.prototype.setTooltip = function (n) {
    n = null == n ? "" : n + "";
    this._line.properties().tooltip.setValue(n)
};
ExecutionLineAdapter.prototype.getTooltip = function () {
    return this._line.properties().tooltip.value()
};
ExecutionLineAdapter.prototype.remove = function () {
    this._line.Q0.removeSource(this._line);
    delete this._line
};
ExecutionRenderer.prototype._textWidth = function (n) {
    if (0 == this._adapter.getText().length)return 0;
    n.save();
    n.font = this._adapter.getFont();
    var t = n.measureText(this._adapter.getText()).width;
    return n.restore(), 5 + t
};
ExecutionRenderer.prototype._drawArrow = function (n, t, i) {
    n.save();
    n.strokeStyle = this._adapter.getArrowColor();
    n.fillStyle = this._adapter.getArrowColor();
    var r = this._adapter.getArrowHeight(), u = this._adapter.getDirection();
    n.transform(1, 0, 0, 1, t, i);
    "buy" != u && n.rotate(Math.PI);
    CanvasEx.drawLine(n, 0, 0, 0, r);
    CanvasEx.drawLine(n, -1, 1, 1, 1);
    CanvasEx.drawLine(n, -2, 2, 2, 2);
    n.restore()
};
ExecutionRenderer.prototype._drawText = function (n, t, i) {
    var r = this._adapter.getText();
    r && (n.save(), n.textAlign = "center", n.textBaseline = "middle", n.font = this._adapter.getFont(), n.fillStyle = this._adapter.getTextColor(), t += this._textWidth(n) / 2, i += ChartTradingUtils.fontHeight(this._adapter.getFont()) / 2, n.fillText(r, t, i - 1), n.restore())
};
ExecutionRenderer.prototype.draw = function (n) {
    var i, t, r;
    if (this._data.points && !(this._data.points.size() < TradingView.LineToolExecution.POINTS_COUNT) && (i = Math.round(this._data.points.item(0).x + .5), t = Math.round(this._data.points.item(0).y), this._drawArrow(n, i, t), r = this._textWidth(n), 0 != r)) {
        var u = this._adapter.getArrowHeight(), f = this._adapter.getArrowSpacing(), e = ChartTradingUtils.fontHeight(this._adapter.getFont()), t = "buy" == this._adapter.getDirection() ? t + u + f : t - u - f - e;
        this._drawText(n, Math.round(i - r / 2), t)
    }
};
ExecutionRenderer.prototype.hitTest = function (n) {
    if (this._data.points && !(this._data.points.size() < TradingView.LineToolExecution.POINTS_COUNT)) {
        var r = Math.round(this._data.points.item(0).x), t = Math.round(this._data.points.item(0).y), u = this._adapter.getArrowHeight(), i;
        if ("buy" == this._adapter.getDirection() ? (i = t, t += u) : i = t - u, n.x >= r - 2 && n.x <= r + 2 && n.y >= i && n.y <= t)return new HitTestResult(HitTestResult.CUSTOM, {mouseDownHandler: function () {
            TradingView.TradingWidget.journalDialog()
        }, tooltip: {text: this._adapter.getTooltip(), rect: new TradingView.Rect(r, i, 2, t - i)}})
    }
};
inherit(ExecutionPaneView, _90);
ExecutionPaneView.prototype._renderer = null;
ExecutionPaneView.prototype._rendererCached = !1;
ExecutionPaneView.prototype.update = function () {
    _90.prototype.update.call(this);
    this._renderer = null;
    this._rendererCached = !1
};
ExecutionPaneView.prototype.renderer = function () {
    var t;
    if (this._rendererCached)return this._renderer;
    this._rendererCached = !0;
    var n = this.J99, r = n._adapter, i = n.Q0.timeScale();
    return 0 == n.points().size() ? null : (t = n.points().item(0).index, (n = n.Q0.mainSeries().bars().search(t, SEARCH_NEAREST_LEFT)) && (t = n.index), r._index = t, !isFinite(t)) ? this._renderer = null : (n = i.visibleBars(), !n || t > n.lastBar() || t < n.firstBar()) ? this._renderer = null : (n = this.J99.Q0.paneForSource(this.J99).executionsPositionController(), i = i.indexToCoordinate(t), t = n.getYCoordinate(r), !isFinite(t)) ? this._renderer = null : (n = new List, n.append({x: i, y: t}), this._renderer = new ExecutionRenderer({points: n}, r))
};
TradingView.LineToolExecution = function (n, t) {
    this._adapter = new ExecutionLineAdapter(this);
    this._constructor = "LineToolExecution";
    var i = t || new _52("linetoolexecution");
    this.customization = {forcePriceAxisLabel: !1, disableSelection: !0, disableErasing: !0};
    J47.call(this, n, new ExecutionPaneView(this, n), i)
};
inherit(TradingView.LineToolExecution, J47);
TradingView.LineToolExecution.POINTS_COUNT = 1;
TradingView.LineToolExecution.skipMagnetting = !0;
TradingView.LineToolExecution.prototype.pointsCount = function () {
    return TradingView.LineToolExecution.POINTS_COUNT
};
TradingView.LineToolExecution.prototype.title = function () {
    return"Execution"
};
TradingView.LineToolExecution.prototype.hasContextMenu = function () {
    return!1
};
TradingView.LineToolExecution.prototype.state = function () {
    return null
};
TradingView.LineToolExecution.prototype.paneViews = function (n) {
    return TradingView.printing || !this.Q0.properties().tradingProperties.showExecutions.value() ? null : J47.prototype.paneViews.call(this, n)
};
TradingView.LineToolExecution.prototype.userEditEnabled = function () {
    return!1
};
TradingView.LineToolExecution.prototype.showInObjectTree = function () {
    return!1
};
D24 = function (n, t, i) {
    var r = this._mtpStudyId() + "@mtp-mtpredictor";
    i = i || StudyMetaInfo.findStudyMetaInfo(n.studiesMetaData(), r);
    t = t || TradingView.prepareStudyProperties(i, null, null, n.studyVersioning());
    r = TradingView.Study.lineToolNameForPointsBasedStudy(r);
    D63.call(this, n, this.createPaneViews(n), t, r);
    this._doNotNeedLine = !0;
    this._turnaroundCounter = 0;
    this._nextTurnaround();
    this._metaInfo = i;
    this._graphics = new D62(i);
    this._formatter = new VolumeFormatter
};
inherit(D24, D63);
D24.prototype.series = function () {
    return isInherited(this._ownerSource.constructor, TradingView.Series) ? this._ownerSource : this._ownerSource.series()
};
D24.prototype.calcIsActualSymbol = function () {
    return J47.prototype.calcIsActualSymbol.call(this)
};
D24.prototype._nextTurnaround = function () {
    this._turnaround = this._mtpStudyId() + "_" + ++this._turnaroundCounter
};
D24.prototype.createPaneViews = function (n) {
    return[new J31(this, n), new TradingView.Study.StudyPaneView_textmarks(this, n), new TradingView.Study.StudyPaneView_polygons(this, n), new TradingView.Study.StudyPaneView_lines(this, n)]
};
D24.prototype.onData = function (n) {
    "data_update" === n.method && n.params.customId === "pointset_" + this._currentPointsetId ? (J47.prototype.onData.call(this, n), this._points.size() == this.pointsCount() && this._requestStudy()) : "data_update" === n.method && n.params.customId === this._studyId && this._checkTurnaround(n.params.turnaround) && (n.params.nonseries.d = "" !== n.params.nonseries.d ? JSON.parse(n.params.nonseries.d) : "", "" !== n.params.nonseries.d && this._graphics.process(n.params.nonseries), 0 < n.params.nonseries.indexes.length && (this._indexes = n.params.nonseries.indexes), this.updateAllViews(), this.Q0.updateSource(this))
};
D24.prototype._requestStudy = function () {
    var i = this, t = function (n) {
        i.onData(n)
    }, n = this._studyInputs();
    n && (this._studyId ? (this._nextTurnaround(), this.Q0.chartApi().modifyStudy(this._studyId, this._turnaround, n, t)) : (this._studyId = TradingView.Study.makeNextStudyId(), this.Q0.chartApi().createStudy(this._studyId, this._turnaround, this.Q0.mainSeries()._seriesId, this._metaInfo.id + "-1!", n, t)))
};
D37 = function (n, t, i) {
    D24.call(this, n, t, i)
};
inherit(D37, D24);
D37.prototype._mtpStudyId = function () {
    return"mtp_riskreward"
};
D37.prototype.pointsCount = function () {
    return 3
};
D37.getTooltipText = function (n) {
    return n && 0 != n._points.size() ? 1 == n._points.size() ? "Select Stop Bar" : 2 == n._points.size() ? "Select Target Point" : null : "Select Entry Setup Bar"
};
D37.prototype._studyInputs = function () {
    var n = this.points().item(0).index, t = this.points().item(1).index, i = this.points().item(2).index, n = this.Q0.mainSeries().bars().valueAt(n), t = this.Q0.mainSeries().bars().valueAt(t), i = this.Q0.mainSeries().bars().valueAt(i);
    return n && t && i ? [1e3 * n[TIME_PLOT], 1e3 * t[TIME_PLOT], 1e3 * i[TIME_PLOT], this.points().item(2).price, this.properties().inputs.account_size.value(), this.properties().inputs.percent_risk.value(), this.properties().inputs.tickEntryOffset.value(), this.properties().inputs.tickStopOffset.value()] : null
};
D26 = function (n, t, i) {
    D24.call(this, n, t, i);
    this._symbolIntervalChanged = !1;
    this.Q0.mainSeries().onSymbolIntervalChanged().subscribe(this, this.onSymbolIntervalChanged)
};
inherit(D26, D24);
D26.prototype._mtpStudyId = function () {
    return"mtp_decisionpoint"
};
D26.prototype.onSymbolIntervalChanged = function () {
    this._symbolIntervalChanged = !0
};
D26.prototype.pointsCount = function () {
    return 1
};
D26.prototype._studyInputs = function () {
    var n = this.points().item(0).index;
    return(n = this.Q0.mainSeries().bars().valueAt(n)) ? [this.properties().inputs.displayZoneLabels.value(), this._symbolIntervalChanged, 1e3 * n[TIME_PLOT]] : null
};
D26.prototype.onData = function (n) {
    D24.prototype.onData.call(this, n);
    this._symbolIntervalChanged = !1
};
D33 = function (n, t, i) {
    D24.call(this, n, t, i)
};
inherit(D33, D24);
D33.prototype.pointsCount = function () {
    return 1
};
D33.prototype._studyInputs = function () {
    var n = this.points().item(0).index;
    return(n = this.Q0.mainSeries().bars().valueAt(n)) ? [this.properties().inputs.displayZoneLabels.value(), 1e3 * n[TIME_PLOT]] : null
};
D34 = function (n, t, i) {
    D33.call(this, n, t, i)
};
inherit(D34, D33);
D34.prototype._mtpStudyId = function () {
    return"mtp_ew_main"
};
D35 = function (n, t, i) {
    D33.call(this, n, t, i)
};
inherit(D35, D33);
D35.prototype._mtpStudyId = function () {
    return"mtp_ew_major"
};
D36 = function (n, t, i) {
    D33.call(this, n, t, i)
};
inherit(D36, D33);
D36.prototype._mtpStudyId = function () {
    return"mtp_ew_minor"
};
D25 = function (n, t, i) {
    D24.call(this, n, t, i)
};
inherit(D25, D24);
D25.prototype._mtpStudyId = function () {
    return"mtp_tsanalysis"
};
D25.prototype.pointsCount = function () {
    return 1
};
D25.prototype._studyInputs = function () {
    var n = this.points().item(0).index;
    return(n = this.Q0.mainSeries().bars().valueAt(n)) ? [this.properties().inputs.displayZoneLabels.value(), 1e3 * n[TIME_PLOT], this.properties().inputs.account_size.value(), this.properties().inputs.percent_risk.value(), this.properties().inputs.tickEntryOffset.value(), this.properties().inputs.tickStopOffset.value(), this.properties().inputs.minRRRatio.value(), this.properties().inputs.shouldFilterWPTZones.value(), this.properties().inputs.shouldFilterSTFTrends.value()] : null
};
D44 = function (n, t, i, r, u) {
    this._wptStudyId = r;
    this._pointsCount = u;
    D24.call(this, n, t, i)
};
inherit(D44, D24);
D44.prototype._studyInputs = function () {
    for (var n, i = [this.properties().inputs.displayZoneLabels.value()], t = 0; t < this.pointsCount(); ++t) {
        if (n = this.points().item(t).index, n = this.Q0.mainSeries().bars().valueAt(n), !n)return null;
        i.push(1e3 * n[TIME_PLOT])
    }
    return i
};
D44.prototype._mtpStudyId = function () {
    return this._wptStudyId
};
D44.prototype.pointsCount = function () {
    return this._pointsCount
};
D27 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_down1ora", 2)
};
inherit(D27, D44);
D27.getTooltipText = function (n) {
    return"Down Wave 1 or A: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D28 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_down2orb", 2)
};
inherit(D28, D44);
D28.getTooltipText = function (n) {
    return"Down Wave 2 or B: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D29 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_down3", 3)
};
inherit(D29, D44);
D29.getTooltipText = function (n) {
    return"Down Wave 3: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D30 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_down4", 2)
};
inherit(D30, D44);
D30.getTooltipText = function (n) {
    return"Down Wave 4: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D31 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_down5", 5)
};
inherit(D31, D44);
D31.getTooltipText = function (n) {
    return"Down Wave 5: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D32 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_downc", 3)
};
inherit(D32, D44);
D32.getTooltipText = function (n) {
    return"Down Wave C: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D38 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_up1ora", 2)
};
inherit(D38, D44);
D38.getTooltipText = function (n) {
    return"Up Wave 1 or A: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D39 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_up2orb", 2)
};
inherit(D39, D44);
D39.getTooltipText = function (n) {
    return"Up Wave 2 or B: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D40 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_up3", 3)
};
inherit(D40, D44);
D40.getTooltipText = function (n) {
    return"Up Wave 3: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D41 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_up4", 2)
};
inherit(D41, D44);
D41.getTooltipText = function (n) {
    return"Up Wave 4: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D42 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_up5", 5)
};
inherit(D42, D44);
D42.getTooltipText = function (n) {
    return"Up Wave 5: Select Point " + ((n ? n._points.size() : 0) + 1)
};
D43 = function (n, t, i) {
    D44.call(this, n, t, i, "mtp_wpt_upc", 3)
};
inherit(D43, D44);
D43.getTooltipText = function (n) {
    return"Up Wave C: Select Point " + ((n ? n._points.size() : 0) + 1)
};
MarkRenderer.prototype.draw = function (n) {
    if (0 !== this._data.points.size()) {
        var t = this._data.points.item(0).x + this._data.offsetX, i = this._data.points.item(0).y + this._data.offsetY;
        n.translate(-.5, -.5);
        n.drawImage(this._data.image, t, i, this._data.width, this._data.height)
    }
};
MarkRenderer.prototype.hitTest = function (n) {
    if (0 === this._data.points.size())return null;
    var t = this._data.points.item(0).clone();
    return this._data.offsetX && (t.x += this._data.offsetX), this._data.offsetY && (t.y += this._data.offsetY), MathEx.pointInRect(n, t, t.add(new MathEx.Point(this._data.width, this._data.height))) ? new HitTestResult(HitTestResult.MOVEPOINT) : null
};
inherit(_97, _90);
_97.prototype.setAnchors = function (n) {
    this._anchorsOffset = n
};
_97.prototype.renderer = function () {
    var n = {}, t, r, i;
    if (n.points = this._points, n.color = this.J99.properties().color.value(), n.image = this._image, n.offsetX = this._offsetX, n.offsetY = this._offsetY, n.width = this._width, n.height = this._height, this.isAnchorsRequired() && 1 == n.points.size()) {
        if (t = new CompositeRenderer, t.append(new MarkRenderer(n)), this._anchorsOffset) {
            for (r = new List, i = 0; i < n.points.size(); i++)r.append(n.points.item(i).clone().add(this._anchorsOffset));
            t.append(new SelectionRenderer({points: r}))
        } else t.append(new SelectionRenderer({points: n.points}));
        return t
    }
    return new MarkRenderer(n)
};
_97.prototype.update = function () {
    _90.prototype.update.call(this)
};
J79.version = 2;
J79.prototype.state = function (n) {
    for (var t = {panes: []}, i = 0; i < this.panes().size(); i++)t.panes.push(this.panes().item(i).state(!0, n));
    return t.timeScale = this.m_timeScale.state(n), i = this.publishedChartsTimelineSource(), t.chartProperties = {paneProperties: this.properties().paneProperties.state(), scalesProperties: this.properties().scalesProperties.state(), publishedChartsTimelineProperties: i ? i.state(n) : void 0}, t.version = J79.version, t.timezone = this.timezone(), t
};
J79.prototype.asyncState = function (n) {
    return this.publishedChartsTimelineSource().asyncState(n).pipe(function (n) {
        var t = {};
        return t.chartProperties = {publishedChartsTimelineProperties: n}, t
    })
};
J79.prototype.restoreState = function (n, t) {
    var r, i, u;
    if (n.panes)if (isArray(n.panes))if (1 > n.panes.length)TradingView.logDebug("J79.restoreState: invalid state"); else {
        for (n.chartProperties && !n.chartProperties.timezone && (n.chartProperties.timezone = n.timezone), n.chartProperties && (this.Q2.paneProperties.merge(n.chartProperties.paneProperties), this.Q2.scalesProperties.merge(n.chartProperties.scalesProperties), n.chartProperties.timezone && this.Q2.timezone.setValue(n.chartProperties.timezone), n.chartProperties.publishedChartsTimelineProperties && this.publishedChartsTimelineSource().restoreData(n.chartProperties.publishedChartsTimelineProperties, t), this.m_timeScale.restoreState(n.timeScale, t)), n.timeScale && this.m_timeScale.restoreState(n.timeScale, t), i = n.panes, this.panes().item(0).restoreState(i[0], t, n.version), i = 1; i < n.panes.length; i++)(this.panes().item(i) || this.createPane()).restoreState(n.panes[i], t, n.version);
        for (this._invalidateBarColorerCaches(), r = this.Q19(), i = 0; i < r.size(); i++)u = r.item(i), isInherited(u.constructor, J47) && u.calcIsActualSymbol();
        this._version = n.version;
        this.timeScale().recalcLockedScale();
        this.recalculateAllPanes();
        this.Q20(new D22(D22.FULL_UPDATE))
    } else TradingView.logDebug("J79.restoreState: invalid state"); else TradingView.logDebug("J79.restoreState: invalid state")
};
J79.prototype.restoreAxisState = function (n) {
    var t, i;
    if (n.panes)if (isArray(n.panes))if (1 > n.panes.length)TradingView.logDebug("J79.restoreAxisState: invalid state"); else {
        for (this.m_timeScale.restoreState(n.timeScale, !1, !0), t = 0; t < n.panes.length; t++)i = this.panes().item(t), i.m_leftPriceScale.restoreState(n.panes[t].leftAxisState), i.m_rightPriceScale.restoreState(n.panes[t].rightAxisState);
        this.recalculateAllPanes();
        this.Q20(new D22(D22.FULL_UPDATE))
    } else TradingView.logDebug("J79.restoreAxisState: invalid state"); else TradingView.logDebug("J79.restoreAxisState: invalid state")
};
J75.prototype.state = function (n, t, i) {
    function u(n) {
        return i && !n.isSavedInStudyTemplates() || n instanceof TradingView.AlertLabel || !n.state || !n.state()
    }

    var r = {};
    if (n)for (r.sources = [], n = 0; n < this.m_dataSources.size(); n++)u(this.m_dataSources.item(n)) || r.sources.push(this.m_dataSources.item(n).state(t));
    for (r.leftAxisState = this.m_leftPriceScale.state(), r.leftAxisSources = [], n = 0; n < this.m_leftPriceScale.Q19().size(); n++)u(this.m_leftPriceScale.Q19().item(n)) || r.leftAxisSources.push(this.m_leftPriceScale.Q19().item(n).id());
    for (r.rightAxisState = this.m_rightPriceScale.state(), r.rightAxisSources = [], n = 0; n < this.m_rightPriceScale.Q19().size(); n++)u(this.m_rightPriceScale.Q19().item(n)) || r.rightAxisSources.push(this.m_rightPriceScale.Q19().item(n).id());
    for (r.overlayPriceScales = {}, n = 0; n < this.m_dataSources.size(); n++)t = this.m_dataSources.item(n), this.isOverlay(t) && (r.overlayPriceScales[t.id()] = t.priceScale().state());
    return r.stretchFactor = this._stretchFactor, this.m_mainDataSource && (r.mainSourceId = this.m_mainDataSource.id()), r
};
J75.prototype.sourceById = function (n) {
    for (var t = 0; t < this.m_dataSources.size(); t++)if (this.m_dataSources.item(t).id() === n)return this.m_dataSources.item(t);
    return null
};
J75.prototype.restoreState = function (n, t, i) {
    var v, y, u, c, e, l, o, r, s, h;
    if (!n.leftAxisState || !n.rightAxisState)throw Error("invalid state");
    if (!n.leftAxisSources || !n.rightAxisSources)throw Error("invalid state");
    if (n.stretchFactor && (this._stretchFactor = n.stretchFactor), v = {}, n.sources)for (y = this.m_dataSources.contains(this.Q0.mainSeries()), this.clearSeries(), y && this.m_dataSources.append(this.Q0.mainSeries()), u = 0; u < n.sources.length; u++)if (r = n.sources[u].type, c = n.sources[u].id, v[c] = n.sources[u].ownerSource, e = n.sources[u].state, l = n.sources[u].zorder, "MainSeries" === r)y || (this.Q0.paneForSource(this.Q0.mainSeries()).removeDataSource(this.Q0.mainSeries()), this.m_dataSources.append(this.Q0.mainSeries())), o = e && e.style ? e.style : void 0, r = o == TradingView.Series.STYLE_PNF && e.pnfStyle.lockScale, e && !e.lockScale && (e.lockScale = r), o == TradingView.Series.STYLE_PNF && "ATR" == this.Q0.mainSeries().properties().pnfStyle.inputs.style.value() ? this.Q0.mainSeries().properties().pnfStyle.inputs.style._value = "Traditional" : o == TradingView.Series.STYLE_RENKO && "ATR" == this.Q0.mainSeries().properties().renkoStyle.inputs.style.value() && (this.Q0.mainSeries().properties().renkoStyle.inputs.style._value = "Traditional"), e && !e.hasOwnProperty("showSessions") && (e.showSessions = !1), e && !e.extendedHours && (e.extendedHours = !1), e && t && (e.showCountdown = !1), this.Q0.mainSeries().properties().merge(e), this.Q0.mainSeries()._prevChartStyle = this.Q0.mainSeries().properties().style.value(), this.Q0.mainSeries()._63(), this.Q0.mainSeries().setId(c), t && this.Q0.mainSeries().restoreData(n.sources[u].bars, n.sources[u].nsBars, n.sources[u].symbolInfo, n.sources[u].rtPrice, n.sources[u].boxSize), void 0 !== l && this.Q0.mainSeries().setZorder(l), this.Q0.mainSeries().properties().extendedHours.listeners().fire(this.Q0.mainSeries().properties().extendedHours), (l = this.Q0.mainSeries().symbolInfo()) && this.Q0.mainSeries().onSymbolResolved().fire(l); else {
        if (r.toLowerCase().startsWith("study")) {
            s = TradingView.clone(n.sources[u].metaInfo);
            $.extend(s, StudyMetaInfo.parseIdString(s.id));
            var f = e, o = this.Q0.studyVersioning(), r = o.patchPropsStateAndMetaInfo(f, s), f = r.propsState, s = r.metaInfo, a;
            t || (a = o.updateMetaInfo(s));
            h = a || s;
            h.isTVScript && !t && (r = StudyMetaInfo.parseIdString(h.fullId || h.id), pro.hasPackage(r.productId) || (h = D57.createScriptStubNoSrc(h.description, "Error: study not authorized!", h.scriptIdPart), $.extend(h, StudyMetaInfo.parseIdString(h.id)), a = s = h, f = {}));
            r = TradingView.prepareStudyPropertiesForLoadChart(s, a, f, null, o);
            r = TradingView.createStudy(this.Q0, r, this.Q0.mainSeries(), h);
            r.setId(c);
            this.m_dataSources.append(r);
            t && (o = o.patchStudyData(s, n.sources[u].data, n.sources[u].nonSeriesData, n.sources[u].indexes), r.restoreData(o.data, o.nsData, o.indexes))
        } else {
            for (s = TradingView[r], assert(isInherited(s, J47), "invalid data source type:" + r + " (expected to be a Line Tool)"), o = n.sources[u].points, f = !1, h = 0; h < o.length; h++)if (1e4 < Math.abs(o[h].offset)) {
                f = !0;
                break
            }
            if (f)continue;
            o = null;
            f = factoryDefaults("linetool");
            isInherited(s, D63) ? (o = this.Q0.studyVersioning(), n.sources[u] = o.patchPointsBasedStudyState(n.sources[u]), e = n.sources[u].state, TradingView.merge(f, e), s = n.sources[u].metaInfo, $.extend(s, StudyMetaInfo.parseIdString(s.fullId)), h = (a = o.updateMetaInfo(s)) || s, f = TradingView.prepareStudyPropsStateForLoadChart(h, s, f, null, o), t ? TradingView.merge(f, {fixedSize: !1}) : TradingView.merge(f, {fixedSize: !0}), e = new _52("study_" + h.id, f, !0), r = new TradingView[r](this.Q0, e, h)) : (s = r.toLowerCase(), TradingView.merge(f, factoryDefaults(s)), TradingView.merge(f, e), t ? TradingView.merge(f, {fixedSize: !1}) : TradingView.merge(f, {fixedSize: !0}), e = new _52(r.toLowerCase(), f), r = new TradingView[r](this.Q0, e));
            r.setId(c);
            f = n.sources[u].indexes ? n.sources[u].indexes : [];
            f = f.slice(0, n.sources[u].points.length);
            r.isFixed() ? r.restorePositionPercents(n.sources[u].positionPercents) : r.restorePoints(n.sources[u].points, f, t);
            r instanceof TradingView.LineToolBarsPattern || r instanceof TradingView.LineToolCallout || r instanceof TradingView.LineToolTrendAngle || r instanceof TradingView.LineToolParallelChannel ? r.restoreData(n.sources[u]) : t && r.restoreData && (f = n.sources[u], o && (f.graphics = o.patchPointsBasedStudyData(f.metaInfo, f.graphics)), r.restoreData(f));
            o = null == n.sources[u].version ? 1 : n.sources[u].version;
            f = null == r.version ? 1 : r.version;
            o != f && "function" == typeof r.migrateVersion && r.migrateVersion(o, f, {pane: this, model: this.Q0, properties: e});
            this.m_dataSources.append(r)
        }
        void 0 !== l && r.setZorder(l)
    }
    for (this.m_leftPriceScale.Q19().clear(), this.m_leftPriceScale._hasSeries = !1, f = defaults("chartproperties").paneProperties.leftAxisProperties, TradingView.merge(f, n.leftAxisState), this.m_leftPriceScale.restoreState(f), u = 0; u < n.leftAxisSources.length; u++)(r = this.dataSourceForId(n.leftAxisSources[u])) && (this.m_leftPriceScale.addDataSource(r), r.setPriceScale(this.m_leftPriceScale));
    for (this.m_rightPriceScale.Q19().clear(), this.m_rightPriceScale._hasSeries = !1, f = defaults("chartproperties").paneProperties.rightAxisProperties, TradingView.merge(f, n.rightAxisState), this.m_rightPriceScale.restoreState(f), u = 0; u < n.rightAxisSources.length; u++)(r = this.dataSourceForId(n.rightAxisSources[u])) && (this.m_rightPriceScale.addDataSource(r), r.setPriceScale(this.m_rightPriceScale));
    for (u = 0; u < this.m_dataSources.size(); u++)r = this.m_dataSources.item(u), this.m_rightPriceScale.Q19().contains(r) || this.m_leftPriceScale.Q19().contains(r) ? r._isOverlay = !1 : (r._isOverlay = !0, t = new J76(this.Q2.overlayPropreties), t.setHeight(this.m_height), t.setTopMargin(this.m_rightPriceScale.topMargin()), t.setBottomMargin(this.m_rightPriceScale.bottomMargin()), t.addDataSource(r), n.overlayPriceScales && n.overlayPriceScales[r.id()] && (f = n.overlayPriceScales[r.id()], f.m_isAutoScale = !0, f.m_isLog = !1, f.m_isPercentage = !1, t.restoreState(f)), r.setPriceScale(t));
    for (c in v)(u = v[c]) && (r = this.sourceById(c)) && this.sourceById(c).setOwnerSource(this.sourceById(u));
    for (u = 0; u < this.m_dataSources.size(); u++)if (r = this.m_dataSources.item(u), isInherited(r.constructor, PriceDataSource)) {
        this.m_mainDataSource = r;
        break
    }
    for (u = 0; u < this.m_dataSources.size(); u++)r = this.m_dataSources.item(u), isInherited(r.constructor, J47) && (r.ownerSource() || r.setOwnerSource(this.mainDataSource()), r.isFixed() && r.restoreFixedPoints(), 1 == i && r.priceScale().isPercent() && !r.isFixed() && r.correctPricesToPercents(), r.fixAfterRestorePriceAxis && r.fixAfterRestorePriceAxis());
    n.mainSourceId && (this.m_mainDataSource = this.dataSourceForId(n.mainSourceId));
    this._updateMargins();
    this._cachedHitTestSources = this._cachedOrderedSoruces = null
};
J79.prototype.studyTemplate = function (n) {
    for (var t = {panes: []}, i = 0; i < this.panes().size(); i++)t.panes.push(this.panes().item(i).state(!0, !1, !0));
    return n && (t.interval = this.mainSeries().interval()), t.version = J79.version, t
};
J79.prototype.restoreStudyTemplate = function (n, t) {
    this._undoModel.studyLoadTemplate(this._undoModel, this.studyTemplate(), n, t)
};
J79.prototype.theme = function () {
    var n = {};
    return n.chartProperties = {paneProperties: this.properties().paneProperties.state(), scalesProperties: this.properties().scalesProperties.state(), symbolWatermarkProperties: this.properties().symbolWatermarkProperties.state()}, n.mainSourceProperties = this.mainSeries().state().state, delete n.mainSourceProperties.symbol, delete n.mainSourceProperties.interval, delete n.chartProperties.paneProperties.topMargin, delete n.chartProperties.paneProperties.bottomMargin, n.version = J79.version, n
};
J79.prototype.restoreTheme = function (n) {
    var f = {hollowCandle: {related: "candle"}}, t, r, u, i;
    for (t in f)if (!n.mainSourceProperties[t + "Style"]) {
        r = n.mainSourceProperties[t + "Style"] = factoryDefaults("chartproperties.mainSeriesProperties." + t + "Style");
        u = n.mainSourceProperties[f[t].related + "Style"];
        for (i in u)i in r && (r[i] = u[i])
    }
    this._undoModel.chartLoadTheme(this, n)
};
TradingView.requestChartSnapshotBars = function (n, t) {
    function h(i) {
        n._currentRequest.requestFirstBarTime(i, e, function (r) {
            r.p[1] > u ? (n._currentRequest.disconnect(), delete n._currentRequest, n._haveNoMoreData = !0, t()) : c(i)
        })
    }

    function c(s) {
        var c = 1, a, v, l, h, y, p;
        for (n._haveNoMoreData = !0, a = !1, n._currentRequest.createSeries("series_id", "turnaround", s, e, ["bar_count", u - 1, -o], function (e) {
            switch (e.method) {
                case"data_update":
                    if (!e.params.plots.length)break;
                    var h = e.params.plots[0].value[TIME_PLOT], s = e.params.plots;
                    n._haveNoMoreData = s.length < o;
                    a = 0 == s.length;
                    f = h == u;
                    i.mainSeries().fixLastBar();
                    i.mainSeries().bars().addTail(s, f);
                    e = i.mainSeries().parseJapProjBars(e.params.nonseries);
                    i.mainSeries().m_data.m_nsBars = e.nsBars;
                    i.mainSeries().m_data.lastProjectionPrice = e.lastPrice;
                    i.model().recalculateAllPanes();
                    i.model().updateSource(i.mainSeries());
                    i.model().updateLineTools();
                    i.timeScale().scrollToOffsetAnimated(r);
                    break;
                case"series_completed":
                    c--;
                    0 === c && (n._currentRequest.disconnect(), delete n._currentRequest, t())
            }
        }), s = i.Q19(), v = {}, l = 0; l < s.size(); l++)h = s.item(l), isInherited(h.constructor, TradingView.Study) && -1 !== ["Volume", "Compare", "Overlay", "Sessions"].indexOf(h.metaInfo().shortId) && (y = "study_" + l, p = h.metaInfo().id + "-1!", v[y] = h, c++, n._currentRequest.createStudy(y, "turnaround", "series_id", p, h.inputs(), function (r) {
            var u = r.method;
            "study_completed" === u || "study_error" === u ? (c--, 0 === c && (n._currentRequest.disconnect(), delete n._currentRequest, t())) : "data_update" !== u || a || (v[r.params.customId].m_data.addTail(r.params.plots, f), i.model().recalculateAllPanes(), i.model().updateSource(i.mainSeries()))
        }))
    }

    var i = n.model(), e = i.mainSeries().interval(), u = i.mainSeries().bars().last().value[TIME_PLOT], r;
    if ("function" != typeof t && (t = new Function), null != n._currentRequest)TradingView.logDebug("requestSnapshotBars: unexpected requestSnapshotBars"); else if (r = i.timeScale().rightOffset(), !(0 > r || n._haveNoMoreData)) {
        var l = i.mainSeries().getSymbolString(), o = Math.max(Math.ceil(r), 100), f = !1, s = new TVChartApi;
        window.user && ("pro_realtime" === user.pro_plan || "pro_realtime_trial" === user.pro_plan) && s.authTokenRequired(!0);
        n._currentRequest = new ChartSession(s);
        n._currentRequest.connect(function (t) {
            var r, f, o;
            if ("connected" === t.method)t = i.model().timezone(), t || (t = defaults("chartproperties").mainSeriesProperties.timezone), n._currentRequest.switchTimezone(t), r = "symbol_id", f = function (t) {
                switch (t.method) {
                    case"symbol_error":
                        if (t.params[1] == TradingView.Series.PERMISSION_DENIED) {
                            switch (t.params[2]) {
                                case TradingView.Series.PD_REASON_EXTENDED_HOURS:
                                    i.mainSeries().properties().extendedHours.setValue(!1);
                                    t = i.mainSeries().getSymbolString();
                                    break;
                                case TradingView.Series.PD_REASON_SYMBOL:
                                    t = t.params[3];
                                    break;
                                default:
                                    t = t.params[2]
                            }
                            t && (r += "_re", n._currentRequest.resolveSymbol(r, t, f))
                        }
                        break;
                    default:
                        h(r)
                }
            }, n._currentRequest.resolveSymbol(r, l, f); else if ("timescale_update" === t.method) {
                var u = i.mainSeries().bars().last(), s = i.timeScale().indexToUserTime(u).valueOf() / 1e3, u = i.timeScale().points(), e = u.lastTimePointIndex(), e = u.valueAt(e);
                0 < t.params.changes.length && (o = t.params.changes[0] == e, o || (s += 1), i.timeScale().addTail(t, s, o), t = u.lastTimePointIndex(), t = u.valueAt(t), fixLineToolsPositions(i.model(), e, t))
            }
        })
    }
};
FutureBarsRenderer.prototype.hitTest = function () {
    return null
};
FutureBarsRenderer.prototype.draw = function (n) {
    n.fillStyle = "rgba(195,255,160, 0.3)";
    n.fillRect(Math.max(0, this._data.x), 0, this._data.width, this._data.height);
    n.strokeStyle = "#308020";
    n.beginPath();
    n.lineWidth = 1;
    var t = Math.round(this._data.x);
    n.moveTo(t, 0);
    n.lineTo(t, this._data.height);
    n.stroke()
};
TradingView._79 = function (n, t) {
    this._series = n;
    this._lastBar = t
};
TradingView._79.prototype.update = function () {
    this._x = this._series.m_model.timeScale().indexToCoordinate(this._lastBar) - .5 * this._series.m_model.timeScale().barSpacing() + 1
};
TradingView._79.prototype.renderer = function () {
    var n = {x: this._x, height: this._series.priceScale().height(), width: this._series.m_model.timeScale().width()};
    return new FutureBarsRenderer(n)
};
inherit(J96, J47);
J96.prototype._constructor = "Child class must override this member";
J96.prototype._initialize = function () {
    throw"Child class must override this member";
};
J96.prototype.onClicked = function () {
    throw"Child class must override this member";
};
J96.prototype._getData = function () {
    throw"Child class must override this member";
};
J96.prototype._createTooltip = function () {
    throw"Child class must override this member";
};
J96.prototype.updateDotData = function (n, t) {
    return t
};
J96.prototype.updatePlateData = function () {
};
J96.prototype._plateViewData = function () {
    return{}
};
J96.prototype.pinTooltip = function (n, t) {
    this.pinnedTooltips[n] = t
};
J96.prototype.timeScale = function () {
    return this.Q0.timeScale()
};
J96.prototype.getIntervalInTicks = function () {
    function t(n) {
        if (n = parseInt(n), n != n)throw new TypeError("Unexpected interval");
        return 60 * n
    }

    var n = t(1440), r = 7 * n, u = 31 * n, i = this.Q0.mainSeries().properties().interval.value();
    switch (i) {
        case"M":
            return u;
        case"W":
            return r;
        case"D":
            return n;
        default:
            return t(i)
    }
};
J96.prototype._maxDate = new Date(2037, 0, 1);
J96.prototype.getVisibleTickmarksRange = function () {
    if (this.timeScale().isEmpty())return{start: 0, end: 0};
    var n = this.timeScale().visibleBars();
    return(n.lastBar() > this.timeScale().points().firstTimePointIndex() && n.firstBar() < this.timeScale().points().lastTimePointIndex()) ? (end = n.lastBar() < this.timeScale().points().lastTimePointIndex() ? this.timeScale().indexToTimePoint(n.lastBar()) : this._maxDate, n = {start: this.timeScale().indexToTimePoint(Math.max(n.firstBar(), this.timeScale().points().firstTimePointIndex())), end: end}, {start: n.start ? n.start.getTime() / 1e3 : void 0, end: n.end ? n.end.getTime() / 1e3 : void 0}) : {start: 0, end: 0}
};
J96.prototype.getVisibleRangePlates = function () {
    var n = [], t = this.getVisibleTickmarksRange(), i = this.getIntervalInTicks();
    return $.each(this._marks, function (r, u) {
        u.tickmark >= t.start && u.tickmark <= t.end + i && n.push(u)
    }), n
};
J96.prototype.getPublishedPlates = function () {
    var n = {}, t = this;
    return is_authenticated ? ($.each(this.getVisibleRangePlates(), function (i, r) {
        r.is_public && (t.pinnedTooltips[r.id] || r.user__id == user.id) && (n[r.id] = r)
    }), n) : n
};
J96.prototype._maxPlatesPerBar = 10;
J96.prototype.filterDisplayedPlates = function (n) {
    return n = n.reduce(function (n, t) {
        var i = this._getIndex(t.tickmark);
        return n[i] || (n[i] = []), n[i].push(t), n
    }.bind(this), {}), n = Object.keys(n).reduce(function (t, i) {
        var r = n[i], r = r.sort(function (n, t) {
            return t.views_count - n.views_count
        }), r = r.slice(0, this._maxPlatesPerBar);
        return t.concat(r)
    }, [])
};
J96.prototype._layout = function (n) {
    switch (n) {
        default:
        case 0:
            return"up";
        case 1:
            return"down";
        case 2:
            return"up";
        case 3:
        case 4:
        case 5:
        case 6:
            return"up"
    }
};
J96.prototype._theme = function (n) {
    switch (n) {
        default:
        case 0:
            return"neutral";
        case 1:
            return"green";
        case 2:
            return"red";
        case 3:
            return"yellow";
        case 4:
            return"blue";
        case 5:
            return"green";
        case 6:
            return"red"
    }
};
J96.prototype._offset = function (n, t) {
    var i;
    switch (n) {
        default:
        case"up":
            i = t[HIGH_PLOT];
            break;
        case"down":
            i = t[LOW_PLOT]
    }
    return this.priceScale().isPercent() && (i = this.priceScale().priceRange().convertToPercent(i, this.ownerSource().firstValue())), this.priceScale().priceToCoordinate(i)
};
J96.prototype._getIndex = function (n) {
    return this.timeScale().points().closestIndexLeft(n)
};
J96.prototype.getViewData = function () {
    return{barWidth: this.barWidth(), plates: this.getPlatesViewData(), tooltip: this._tooltip}
};
J96.prototype.barWidth = function () {
    return this.timeScale().barSpacing()
};
J96.prototype.getPlatesViewData = function () {
    if (this.Q0.mainSeries().data().isEmpty())return[];
    for (var n = this.filterDisplayedPlates(this.getVisibleRangePlates()), f = this, i = {}, r = this.Q0.lastHittestData(), n = n.map(function (n) {
        var t = this._getIndex(n.tickmark), u = this._getBar(t);
        if (!u)return!1;
        var e = this._layout(n.direction), s = this._theme(n.direction), h = r && r.id == n.id, c = this.timeScale().indexToCoordinate(t), u = this._offset(e, u), o = 0;
        return t in i || (i[t] = {up: 0, down: 0}), o = i[t][e]++, TradingView.merge({id: n.id, x: c, y: u, order: o, direction: e, theme: s, hovered: h, pinned: !0 === f.pinnedTooltips[n.id], user__id: n.user__id, label: n.label, labelFontColor: n.labelFontColor || "#444", minSize: n.minSize || 0}, this._plateViewData(n))
    }.bind(this)), n = n.filter(function (n) {
        return!!n
    }), u = n.filter(function (n) {
        return 1 == n.hovered
    }), t = 0; t < n.length; t++)null != u[0] && n[t].user__id == u[0].user__id && (n[t].highlightByAuthor = !0);
    return n.sort(function (n, t) {
        return n.hovered && !t.hovered ? 1 : 0
    }), n
};
J96.prototype._getBar = function (n) {
    return this.Q0.mainSeries().data().valueAt(n)
};
J96.prototype.paneViews = function (n) {
    var t = this;
    return this.Q2.visible.value() ? (new List).append(new _59(this, n, function (n) {
        return new BarsMarksContainerRenderer(n.getViewData(), t)
    })) : new List
};
J96.prototype.dataWindowView = function () {
    return null
};
J96.prototype.priceAxisViews = function () {
    return null
};
J96.prototype.statusView = function () {
    return null
};
J96.prototype.updateAllViews = function () {
};
J96.prototype.pointsCount = function () {
    return 0
};
J96.prototype.properties = function () {
    return this.Q2
};
J96.prototype._rangeDifference = function (n) {
    return n = $.extend({}, n), this._loadedRange && (n.start < this._loadedRange.start ? n.end = this._loadedRange.start : n.end > this._loadedRange.end && (n.start = this._loadedRange.end)), n
};
J96.prototype._rangeUnion = function (n, t) {
    return n = $.extend({}, n), t && (n.start = Math.min(t.start, n.start), n.end = Math.max(t.end, n.end)), n
};
J96.prototype._pushGetDataStack = function (n) {
    if (!n.end || !n.start)throw new TypeError("Wrong tickmark range");
    this._getDataTimeout && clearTimeout(this._getDataTimeout);
    this._collectedRange = this._rangeUnion(n, this._collectedRange);
    this._getDataTimeout = setTimeout(function () {
        this._getData(this._collectedRange);
        this._getDataTimeout = this._collectedRange = null
    }.bind(this), 300)
};
J96.prototype.roundRange = function (n) {
    return{start: Math.round(n.start), end: Math.round(n.end)}
};
J96.prototype.refreshData = function () {
    this.getData(this._lastRange)
};
J96.prototype.getData = function (n) {
    if (!n.start || !n.end)throw new TypeError("Wrong range");
    this._lastRange = n;
    n = $.extend({}, n);
    n.end = this._maxDate / 1e3;
    this._pushGetDataStack(n)
};
J96.prototype._abortAllRequests = function () {
    this._requests.forEach(function (n) {
        n.abort()
    });
    this._requests = [];
    this._getDataTimeout && clearTimeout(this._getDataTimeout);
    this._getDataTimeout = this._collectedRange = null
};
J96.prototype.getNewData = function () {
    this._abortAllRequests();
    this._marks = {};
    this._loadedRange = null
};
_59.prototype.update = function () {
};
_59.prototype.renderer = function () {
    return this._rendererFactory(this.source)
};
BarsMarksContainerRenderer.prototype.draw = function (n) {
    n.save();
    for (var t = 0; t < this._plates.length; t++)if (this._plates[t].highlightByAuthor) {
        this._highlightByAuthor = !0;
        break
    }
    this._plates.forEach(this._drawItem.bind(this, n));
    this._tooltip.draw(this._plates.map(function (n) {
        return this._plateTransform(n)
    }.bind(this)), n);
    this._tooltip.endDraw();
    n.restore()
};
BarsMarksContainerRenderer.prototype._drawItem = function (n, t) {
    n.save();
    this._highlightByAuthor && !t.highlightByAuthor && (n.globalAlpha = .4);
    var i = this._dotTransform(t);
    i.mine ? this._drawTriangle(n, i) : this._drawDot(n, i);
    n.restore()
};
BarsMarksContainerRenderer.prototype._commonTransform = function (n) {
    var t = Math.max(1.4 * n.minSize, this._barWidth + 4), t = n.y + {up: -1, down: 1}[n.direction] * (t * (n.order + .6) + .25 * t);
    return{id: n.id, theme: this.themes[n.theme + (n.hovered || n.highlightByAuthor ? "_hovered" : "")], themeName: n.theme, x: Math.round(n.x + 1), y: Math.round(t), pinned: n.pinned, hovered: n.hovered}
};
BarsMarksContainerRenderer.prototype._dotTransform = function (n) {
    var t = this._commonTransform(n);
    return t.radius = Math.max(n.minSize / 2, .4 * this._barWidth), t.label = n.label, t.labelFontColor = n.labelFontColor, t.labelFontSize = Math.ceil(Math.max(10, Math.min(t.radius, 20))), this.Q0.updateDotData(n, t)
};
BarsMarksContainerRenderer.prototype._plateTransform = function (n) {
    var t = this._commonTransform(n);
    return this.Q0.updatePlateData(n, t)
};
BarsMarksContainerRenderer.THEMES = ["green", "red", "neutral", "yellow", "blue"];
BarsMarksContainerRenderer.prototype.themes = {green: {border: "#78C143", background: "#8DDD54", dotBorderWidth: 2}, red: {border: "#CC4545", background: "#ED5A5A ", dotBorderWidth: 2}, neutral: {border: "#EAC300", background: "#FFD400", dotBorderWidth: 2}, yellow: {border: "#EAC300", background: "#FFD400", dotBorderWidth: 2}, blue: {border: "#047ACE", background: "#0496FF", dotBorderWidth: 2}};
BarsMarksContainerRenderer.THEMES.forEach(function (n) {
    var t = BarsMarksContainerRenderer.prototype.themes;
    t[n + "_hovered"] = $.extend({}, t[n], {dotBorderWidth: 4})
});
BarsMarksContainerRenderer.prototype._drawTriangle = function (n, t) {
    n.strokeStyle = t.theme.border;
    n.fillStyle = t.theme.background;
    n.lineWidth = t.theme.dotBorderWidth;
    var i = t.radius, r = Math.cos(Math.PI / 6) * i, u = Math.sin(Math.PI / 6) * i;
    n.translate(t.x, t.y);
    "up" == t.direction && n.rotate(Math.PI);
    t.public || (n.lineWidth /= 2);
    n.beginPath();
    n.moveTo(0, -i);
    n.lineTo(r, u);
    n.lineTo(-r, u);
    n.lineTo(0, -i);
    n.closePath();
    n.stroke();
    t.public && n.fill()
};
BarsMarksContainerRenderer.prototype._drawDot = function (n, t) {
    n.strokeStyle = t.theme.border;
    n.fillStyle = t.theme.background;
    n.lineWidth = t.theme.dotBorderWidth;
    n.beginPath();
    n.arc(t.x, t.y, t.radius, 0, 2 * Math.PI, !0);
    n.closePath();
    n.stroke();
    n.fill();
    t.label && 6 < t.radius && (n.textAlign = "center", n.textBaseline = "middle", n.font = "bold " + t.labelFontSize + "px Arial", n.fillStyle = t.labelFontColor, n.fillText(t.label, t.x, t.y))
};
BarsMarksContainerRenderer.prototype.hitTest = function (n) {
    for (var i, t = this._plates.length - 1; 0 <= t; --t)if (i = this._hitTestDot(this._plates[t], n))return i;
    return null
};
BarsMarksContainerRenderer.prototype._hitTestDot = function (n, t) {
    var i = this._dotTransform(n), r = new MathEx.Point(i.x, i.y);
    return MathEx.isInCircle(r, Math.max(i.radius, 8), t) ? new HitTestResult(HitTestResult.REGULAR, n) : null
};
J97.prototype._createLayout = function () {
    throw"Child class must override this member";
};
J97.prototype._updatePlate = function () {
    throw"Child class must override this member";
};
J97.prototype._getContainer = function (n) {
    return this._container && this._context === n || (this._context = n, this._container = $(n.canvas).parent()), this._container
};
J97.prototype._plateArrowSize = 14;
J97.prototype.showPlate = function (n, t) {
    var r, i, u, f, e;
    this._currentId == n.id && this._layout && 0 != this._layout.length && null != this._layout[0].parentNode || (this._currentId = n.id, this._createLayout(), this._getContainer(t).append(this._layout), r = this, this._layout.hover(function () {
        r.tooltipHovered = !0;
        $(this).stop(!0).fadeTo(0, 1)
    }, function () {
        r.tooltipHovered = !1
    }));
    i = Math.round(n.barWidth / 2);
    15 < i && (i = 15);
    10 > i && (i = 10);
    this._updatePlate(n);
    u = n.x - this._layout.outerWidth() < this._plateArrowSize;
    f = t.canvas.width - n.x + Math.round(n.barWidth / 2 + i);
    u && (f -= this._layout.outerWidth() + 2 * this._plateArrowSize);
    e = t.canvas.height;
    this._layout.toggleClass("right", u);
    this._layout.css({top: Math.min(Math.max(n.y, 20), e - this._layout.outerHeight() - 10), right: f, fontSize: i + "px", display: "block"})
};
J97.prototype._removeLayout = function () {
    this.tooltipHovered || (this._layout.stop(!0), this._layout.remove())
};
J97.prototype._toggleLayout = function (n) {
    this._layout.toggle(n)
};
J97.prototype.hide = function (n) {
    this.tooltipHovered ? this._layout.stop(!0).fadeTo(0, 1) : this._layout.fadeOut(400, function () {
        $(this).remove();
        n()
    })
};
J97.prototype.setSource = function (n) {
    this.source = n
};
TooltipRenderer = function (n, t) {
    this.tooltips = {};
    this.tooltipFactory = n;
    this.source = t
};
TooltipRenderer.prototype.findOrCreateTooltip = function (n) {
    var t = this.tooltips[n.id];
    return null == t && (n.hovered || n.pinned) && (t = this._createTooltip(), this.tooltips[n.id] = t), t
};
TooltipRenderer.prototype.showPlate = function (n, t) {
    var i = this.findOrCreateTooltip(n);
    null != i && (i._drawPlate(n, t), i.plateData = n)
};
TooltipRenderer.prototype.draw = function (n, t) {
    this.hoveredId = null;
    for (var i = 0; i < n.length; i++)n[i].hovered && (this.hoveredId = n[i].id);
    n.forEach(function (n) {
        this.showPlate(n, t)
    }.bind(this))
};
TooltipRenderer.prototype.endDraw = function () {
    var t, n;
    for (t in this.tooltips)this.tooltips.hasOwnProperty(t) && (n = this.tooltips[t], n.toggleVisibility(), this.hoveredId && n.plateData.id != this.hoveredId && !n.plateData.pinned && (n.remove(), delete this.tooltips[t]))
};
TooltipRenderer.prototype.removeAll = function () {
    for (var n in this.tooltips)this.tooltips.hasOwnProperty(n) && this.tooltips[n].remove();
    this.tooltips = {}
};
TooltipRenderer.prototype.removeTooltip = function (n) {
    delete this.tooltips[n]
};
TooltipRenderer.prototype._createTooltip = function () {
    return new TooltipWrap(this, this.tooltipFactory())
};
TooltipWrap = function (n, t) {
    this.renderer = n;
    this._tooltip = t;
    this.visible = !1
};
TooltipWrap.prototype._drawPlate = function (n, t) {
    var i = this;
    this.visible = !0;
    this._tooltip.setSource(this.renderer.source);
    this._tooltip.showPlate(n, t);
    n.hovered || n.pinned || this._tooltip.hide(function () {
        i.renderer.removeTooltip(n.id)
    })
};
TooltipWrap.prototype.remove = function () {
    this._tooltip._removeLayout()
};
TooltipWrap.prototype.toggleVisibility = function () {
    this._tooltip._toggleLayout(this.visible);
    this.visible = !1
};
inherit(UserDefinedBarsMarks, J96);
UserDefinedBarsMarks.prototype._initialize = function () {
    this.Q2.visible.setValue(!0)
};
UserDefinedBarsMarks.prototype._constructor = "UserDefinedBarsMarks";
UserDefinedBarsMarks.prototype._plateViewData = function (n) {
    return{text: n.text}
};
UserDefinedBarsMarks.prototype.onClicked = function () {
    var n = this.Q0.lastHittestData().id;
    this._marks[n].onClicked()
};
UserDefinedBarsMarks.prototype._getData = function (n) {
    var i = this.Q0.mainSeries().symbolInfo();
    if (i) {
        var r = this.roundRange(this._rangeDifference(n)), t = this, u = this.Q0.mainSeries().properties().interval.value();
        Q16.getMarks(i, r.start, r.end, function (i) {
            i.forEach(function (n) {
                t._marks[n.id] = n
            }, t);
            t._loadedRange = t._rangeUnion(n, t._loadedRange);
            t.onNeedRepaint.fire()
        }, u)
    }
};
UserDefinedBarsMarks.prototype._createTooltip = function () {
    return new UserDefinedBarsMarksTooltip
};
UserDefinedBarsMarks.prototype.updatePlateData = function (n, t) {
    return t.barWidth = this.barWidth(), t.text = n.text, t.tooltipMargin = -1 * Math.max(n.minSize / 2, .4 * this.barWidth()), t
};
UserDefinedBarsMarks.prototype.hasContextMenu = function () {
    return!1
};
inherit(UserDefinedBarsMarksTooltip, J97);
UserDefinedBarsMarksTooltip.prototype._createLayout = function () {
    this._layout = $('<div class="bar-mark-tooltip"><\/div>');
    this._layout_text = $('<div class="text"><\/div>').appendTo(this._layout)
};
UserDefinedBarsMarksTooltip.prototype._updatePlate = function (n) {
    this._currentId = n.id;
    this._layout.css("border-color", n.theme.border);
    this._layout.css("margin-top", n.tooltipMargin + "px");
    this._layout_text.html(n.text);
    this._layout.append(this._layout_text)
};
J32.prototype.update = function () {
    if (this._visible = !1, this.J99.properties().showPriceLine.value()) {
        var n = this.J99.lastValueData("close", !0);
        n && (this._visible = !0, this._points = (new List).append(new MathEx.Point(0, n.coordinate)), this._color = n.color)
    }
};
J32.prototype.renderer = function () {
    var n = {};
    return n.points = this._points, n.color = this._color, n.linewidth = 1, n.linestyle = CanvasEx.LINESTYLE_DOTTED, n.hitTestResult = HitTestResult.REGULAR, n.visible = this._visible, new HorzLineRenderer(n)
};
D50 = function (n, t) {
    this.J99 = n;
    this.Q0 = t;
    this._invalidated = !0;
    this._text = "";
    this._coordinate = 0;
    this._background = "black";
    this._color = "white";
    this._textHeight = 14
};
inherit(D50, PriceAxisView);
D50.prototype.update = function () {
    this._invalidated = !0
};
D50.prototype.coordinate = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), PriceAxisView.prototype.coordinate.call(this)
};
D50.prototype._updateImpl = function () {
    this._visible = !1;
    this._text = "";
    var n = this.J99.lastValueData("close", !1);
    n && (this._text = n.text, this._floatCoordinate = n.floatCoordinate, this._coordinate = n.coordinate, this._textHeight = this.J99.priceScale().m_markBuilder.fontHeight(), this._background = n.color, this._visible = !0)
};
D50.prototype.renderer = function () {
    this._invalidated && (this._updateImpl(), this._invalidated = !1);
    var n = {text: this._text, coordinate: this._coordinate, color: this.color(), background: this._background, textHeight: this._textHeight, visible: this._visible};
    return new PriceAxisViewRenderer(n)
};
D49 = function (n, t) {
    DataWindowView.call(this);
    this.Q1 = n;
    this.Q0 = t;
    this._items.append(new DataWindowItem("Open", ""));
    this._items.append(new DataWindowItem("High", ""));
    this._items.append(new DataWindowItem("Low", ""));
    this._items.append(new DataWindowItem("Close", ""));
    this._invalidated = !0;
    this.update()
};
inherit(D49, DataWindowView);
D49.prototype._updateImpl = function () {
    var t, i, r, f;
    if (this._header = this.Q1.title(), !this.Q0.timeScale().isEmpty() && 0 !== this.Q1.data().size()) {
        r = !1;
        this.Q1.properties().style.value() === TradingView.Series.STYLE_BARS ? (t = this.Q1.properties().barStyle.upColor.value(), i = this.Q1.properties().barStyle.downColor.value(), r = this.Q1.properties().barStyle.barColorsOnPrevClose.value()) : this.Q1.properties().style.value() === TradingView.Series.STYLE_CANDLES ? (t = this.Q1.properties().candleStyle.upColor.value(), i = this.Q1.properties().candleStyle.downColor.value(), r = this.Q1.properties().candleStyle.barColorsOnPrevClose.value()) : this.Q1.properties().style.value() === TradingView.Series.STYLE_HOLLOW_CANDLES ? (t = this.Q1.properties().hollowCandleStyle.upColor.value(), i = this.Q1.properties().hollowCandleStyle.downColor.value(), r = !0) : this.Q1.properties().style.value() === TradingView.Series.STYLE_LINE ? t = i = this.Q1.properties().lineStyle.color.value() : this.Q1.properties().style.value() === TradingView.Series.STYLE_AREA && (t = i = this.Q1.properties().areaStyle.linecolor.value());
        var u = this.Q1.series(), n = this.Q0.crossHairSource().index, u = u.nearestIndex(n, SEARCH_NEAREST_LEFT);
        if (void 0 !== u) {
            if (n = this.Q1.data().valueAt(u), !(n && n[OPEN_PLOT] && n[HIGH_PLOT] && n[LOW_PLOT] && n[CLOSE_PLOT]))return;
            for (f = this.Q1.formatter(), this._items.item(0).setValue(f.format(n[OPEN_PLOT])), this._items.item(1).setValue(f.format(n[HIGH_PLOT])), this._items.item(2).setValue(f.format(n[LOW_PLOT])), this._items.item(3).setValue(f.format(n[CLOSE_PLOT])), t = r && 1 <= u ? this.Q1.data().valueAt(u - 1)[CLOSE_PLOT] <= n[CLOSE_PLOT] ? t : i : n[OPEN_PLOT] <= n[CLOSE_PLOT] ? t : i, i = 0; 4 > i; i++)this._items.item(i).setColor(t)
        }
        this._additional = (t = TradingView.getDataVendorString(this.Q1.symbolInfo())) ? "(Data Provided by " + t + ")" : void 0
    }
};
D49.prototype.items = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), this._items
};
D49.prototype.update = function () {
    this._invalidated = !0
};
D49.prototype.additional = function () {
    return this._invalidated && (this._updateImpl(), this._invalidated = !1), this._additional
};
TradingView.study_Overlay = function (n, t, i, r) {
    this._symbolLabelView = new TradingView.J38(n, this, "close");
    TradingView.Study.call(this, n, t, i, r);
    this._paneView = this._formatter = null;
    var u = this;
    this.properties().minTick.listeners().subscribe(null, function () {
        u._createFormatter();
        u.updateAllViews();
        u.Q0.Q20(new D22(D22.FULL_UPDATE))
    })
};
inherit(TradingView.study_Overlay, TradingView.Study);
TradingView.study_Overlay.prototype.symbol = function () {
    var n = this.properties().inputs.symbol.value(), t = this._resolvedSymbols ? this._resolvedSymbols[n] : null;
    return(t ? t.name : n).toUpperCase()
};
TradingView.study_Overlay.prototype.lastValueData = function (n, t) {
    var r = TradingView.Study.prototype.lastValueData.call(this, "close", t), i, u;
    if (!r)return r;
    i = this.properties();
    u = r.item;
    switch (i.style.value()) {
        case TradingView.Series.STYLE_BARS:
            r.color = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? i.barStyle.upColor.value() : i.barStyle.downColor.value();
            break;
        case TradingView.Series.STYLE_CANDLES:
            r.color = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? i.candleStyle.upColor.value() : i.candleStyle.downColor.value();
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            r.color = u[OPEN_PLOT] <= u[CLOSE_PLOT] ? i.candleStyle.upColor.value() : i.candleStyle.downColor.value();
            break;
        case TradingView.Series.STYLE_LINE:
            r.color = i.lineStyle.color.value();
            break;
        case TradingView.Series.STYLE_AREA:
            r.color = i.areaStyle.color1.value()
    }
    return r
};
TradingView.study_Overlay.prototype.createViews = function () {
    this._priceAxisViews = new List;
    this._priceAxisViewsBase = new List;
    this._priceAxisViewsBase.append(new D50(this, this.Q0));
    this._paneViews = new List;
    paneView = null;
    switch (this.Q2.style.value()) {
        case TradingView.Series.STYLE_BARS:
            paneView = new J15(this, this.Q0);
            break;
        case TradingView.Series.STYLE_CANDLES:
            paneView = new J16(this, this.Q0);
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            paneView = new J18(this, this.Q0);
            break;
        case TradingView.Series.STYLE_LINE:
            paneView = new J20(this, this.Q2.lineStyle.priceSource.value(), this.Q0);
            break;
        case TradingView.Series.STYLE_AREA:
            paneView = new J13(this, this.Q2.areaStyle.priceSource.value(), this.Q0)
    }
    this._paneViews.append(paneView);
    this._paneViews.append(new J32(this, this.Q0));
    this._paneViews.append(this._symbolLabelView);
    this._dataWindowView || (this._dataWindowView = new D49(this, this.Q0));
    this._statusView || (this._statusView = new StudyStatusView(this));
    this._priceAxisViews = (new List).appendAll(this._priceAxisViewsBase).appendAll(this._hlinesPriceAsisViews).appendAll(this._horizlinesPriceAsisViews)
};
TradingView.study_Overlay.prototype.barColorer = function () {
    return new SeriesBarColorer(this)
};
TradingView.study_Overlay.prototype.start = function () {
    this._formatter = null;
    TradingView.Study.prototype.start.call(this);
    this.priceScale() && this.priceScale().updateFormatter()
};
TradingView.study_Overlay.prototype._createFormatter = function () {
    var n;
    if ("default" == this.properties().minTick.value())n = this.properties().inputs.symbol.value(), n = this._resolvedSymbols[n], this._formatter = new PriceFormatter(n ? n.pricescale : 100, n ? n.minmov : 1, n ? n.fractional : !1); else {
        var n = this.properties().minTick.value(), n = isNumber(n) ? ["100", "1", "false"] : n.split(","), t = parseInt(n[0]), i = parseInt(n[1]);
        this._formatter = new PriceFormatter(t, i, "true" === n[2])
    }
    this.priceScale() && this.priceScale().updateFormatter()
};
TradingView.study_Overlay.prototype.formatter = function () {
    return this._formatter || this._createFormatter(), this._formatter
};
TradingView.study_Overlay.prototype._changeInputs = function () {
    TradingView.Study.prototype._changeInputs.call(this, this.inputs());
    this.m_formatter = null;
    this.priceScale().updateFormatter()
};
TradingView.study_Overlay.prototype.title = function () {
    var t = this.properties().inputs.symbol.value(), n = this._resolvedSymbols[t];
    return(n ? n.name + ", " + n.exchange : t).toUpperCase()
};
TradingView.study_Overlay.prototype.bars = function () {
    return this.m_data
};
TradingView.study_Overlay.prototype.open = function (n) {
    return this.bars().valueAt(n)[OPEN_PLOT]
};
TradingView.study_Overlay.prototype.high = function (n) {
    return this.bars().valueAt(n)[HIGH_PLOT]
};
TradingView.study_Overlay.prototype.low = function (n) {
    return this.bars().valueAt(n)[LOW_PLOT]
};
TradingView.study_Overlay.prototype.close = function (n) {
    return this.bars().valueAt(n)[CLOSE_PLOT]
};
TradingView.study_Overlay.prototype.hl2 = function (n) {
    return(this.high(n) + this.low(n)) / 2
};
TradingView.study_Overlay.prototype.hlc3 = function (n) {
    return(this.high(n) + this.low(n) + this.close(n)) / 3
};
TradingView.study_Overlay.prototype.ohlc4 = function (n) {
    return(this.open(n) + this.high(n) + this.low(n) + this.close(n)) / 4
};
TradingView.study_Overlay.prototype.symbolInfo = function () {
    if (!this._resolvedSymbols)return null;
    var n = this.Q2.inputs.symbol.value();
    return n ? this._resolvedSymbols[n] : null
};
TradingView.study_Overlay.prototype.lastPriceLabelFixedCoordinate = function () {
    return this._priceAxisViews.item(0)._fixedCoordinate
};
TradingView.Study.graphicsZOrderPriority = function (n) {
    switch (n) {
        case"polygons":
            return-100;
        case"trendchannels":
            return-90;
        default:
            return 0
    }
};
TradingView.Study.StudyPaneView_horizlines = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_horizlines.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_horizlines.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new TrendLineRenderer(this._data[n], new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_horizlines.prototype._updateViewInternal = function () {
    var h, t, r, o, s, c;
    if (this._data = [], h = this.Q1.graphics().horizlines, h && (t = this.Q1.priceScale(), r = this.Q1.Q0.timeScale(), t && !t.isEmpty() && r && !r.isEmpty()))for (var y = this.Q1.firstValue(), v = this.Q1.graphics().indexes, l = this.Q0.timeScale().visibleBars(), p = l.firstBar(), l = l.lastBar(), a = 0; a < h.length; a++)if (o = h[a], o.data && (s = this.Q1.properties().graphics.horizlines[o.styleId], s.visible.value()))for (c = 0; c < o.data.length; c++) {
        var i = o.data[c], u = v[i.startIndex], f = v[i.endIndex];
        if (!(!i.extendRight && Math.max(u, f) < p || !i.extendLeft && Math.min(u, f) > l)) {
            var n = {}, u = r.indexToCoordinate(u), f = r.indexToCoordinate(f), e = i.level;
            t.isPercent() && (e = t.priceRange().convertToPercent(e, y));
            e = t.priceToCoordinate(e);
            u = new MathEx.Point(u, e);
            f = new MathEx.Point(f, e);
            n.points = (new List).append(u).append(f);
            n.extendleft = i.extendLeft;
            n.extendright = i.extendRight;
            n.width = r.width();
            n.height = t.height();
            n.color = s.color.value();
            n.linewidth = s.width.value();
            n.linestyle = s.style.value();
            this._data.push(n)
        }
    }
};
TradingView.Study.StudyPaneView_vertlines = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_vertlines.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_vertlines.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new TrendLineRenderer(this._data[n], new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_vertlines.prototype._updateViewInternal = function () {
    var s, n, f, e, o, h, t, i;
    if (this._data = [], s = this.Q1.graphics().vertlines, s && (n = this.Q1.priceScale(), f = this.Q1.Q0.timeScale(), n && !n.isEmpty() && f && !f.isEmpty()))for (var y = this.Q1.firstValue(), l = this.Q1.graphics().indexes, a = this.Q0.timeScale().visibleBars(), w = a.firstBar(), a = a.lastBar(), v = 0; v < s.length; v++)if (e = s[v], e.data && (o = this.Q1.properties().graphics.vertlines[e.styleId], o.visible.value()))for (h = 0; h < e.data.length; h++)if (t = e.data[h], i = {}, !(l[t.index] < w || l[t.index] > a)) {
        var c = f.indexToCoordinate(l[t.index]) + 1, r = t.startPrice, u = t.endPrice, p = n.priceRange();
        t.extendBottom && (r = p.minValue());
        t.extendTop && (u = p.maxValue());
        n.isPercent() && (r = n.priceRange().convertToPercent(r, y), u = n.priceRange().convertToPercent(u, y));
        r = n.priceToCoordinate(r);
        u = n.priceToCoordinate(u);
        r = new MathEx.Point(c, r);
        c = new MathEx.Point(c, u);
        i.points = (new List).append(r).append(c);
        i.extendleft = t.extendBottom;
        i.extendright = t.extendTop;
        i.width = f.width();
        i.height = n.height();
        i.color = o.color.value();
        i.linewidth = o.width.value();
        i.linestyle = o.style.value();
        this._data.push(i)
    }
};
TradingView.Study.StudyPaneView_lines = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_lines.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_lines.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new TrendLineRenderer(this._data[n], new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_lines.prototype._updateViewInternal = function () {
    var h, t, u, f, e, c;
    if (this._data = [], h = this.Q1.graphics().lines, h && (t = this.Q1.priceScale(), u = this.Q1.Q0.timeScale(), t && !t.isEmpty() && u && !u.isEmpty()))for (var v = this.Q1.firstValue(), y = this.Q1.graphics().indexes, l = this.Q0.timeScale().visibleBars(), p = l.firstBar(), l = l.lastBar(), a = 0; a < h.length; a++)if (f = h[a], f.data && (e = this.Q1.properties().graphics.lines[f.styleId], e.visible.value()))for (c = 0; c < f.data.length; c++) {
        var n = f.data[c], i = y[n.startIndex] + (n.startOffset || 0), r = y[n.endIndex] + (n.endOffset || 0);
        if (!(!n.extendRight && Math.max(i, r) < p || !n.extendLeft && Math.min(i, r) > l)) {
            var o = {}, i = u.indexToCoordinate(i), r = u.indexToCoordinate(r), s = n.startPrice, n = n.endPrice;
            t.isPercent() && (s = t.priceRange().convertToPercent(s, v), n = t.priceRange().convertToPercent(n, v));
            s = t.priceToCoordinate(s);
            n = t.priceToCoordinate(n);
            i = new MathEx.Point(i, s);
            r = new MathEx.Point(r, n);
            o.points = (new List).append(i).append(r);
            o.color = e.color.value();
            o.linewidth = e.width.value();
            o.linestyle = e.style.value();
            this._data.push(o)
        }
    }
};
TradingView.Study.StudyPaneView_hlines = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = [];
    this._textData = [];
    this._textRendererCache = {}
};
TradingView.Study.StudyPaneView_hlines.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_hlines.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new HorzLineRenderer(this._data[n]));
    for (n = 0; n < this._textData.length; n++)t.append(new TextRenderer(this._textData[n], this._textRendererCache, new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_hlines.prototype._updateViewInternal = function () {
    this._calcHorzLinesData();
    this._calcTextData()
};
TradingView.Study.StudyPaneView_hlines.prototype._calcTextData = function () {
    var e, i, u, c, o, f, r, s, t, n, h;
    if (this._textData = [], e = this.Q1.graphics().hlines, e && (i = this.Q1.priceScale(), u = this.Q1.Q0.timeScale(), i && !i.isEmpty() && u && !u.isEmpty()))for (c = this.Q1.firstValue(), o = 0; o < e.length; o++)if (f = e[o], f.data && (r = this.Q1.properties().graphics.hlines[f.styleId], r.enableText.value() && r.showText.value()))for (s = 0; s < f.data.length; s++)t = f.data[s], n = {}, n.text = void 0 === t.text ? "" : t.text, n.color = r.color.value(), n.font = "arial", n.fontsize = r.fontSize.value(), t = t.level, i.isPercent() && (t = i.priceRange().convertToPercent(t, c)), t = i.priceToCoordinate(t), tp = r.textPos.value(), tp == CanvasEx.TEXTPOS_TOPLEFT || tp == CanvasEx.TEXTPOS_MIDDLELEFT || tp == CanvasEx.TEXTPOS_BOTTOMLEFT ? (h = 4, n.horzAlign = "left") : tp == CanvasEx.TEXTPOS_TOPCENTER || tp == CanvasEx.TEXTPOS_MIDDLECENTER || tp == CanvasEx.TEXTPOS_BOTTOMCENTER ? (h = u.width() / 2, n.horzAlign = "center") : (tp == CanvasEx.TEXTPOS_TOPRIGHT || tp == CanvasEx.TEXTPOS_MIDDLERIGHT || tp == CanvasEx.TEXTPOS_BOTTOMRIGHT) && (h = u.width(), n.horzAlign = "right"), tp == CanvasEx.TEXTPOS_TOPLEFT || tp == CanvasEx.TEXTPOS_TOPCENTER || tp == CanvasEx.TEXTPOS_TOPRIGHT ? (n.vertAlign = "bottom", t -= 4) : tp == CanvasEx.TEXTPOS_MIDDLELEFT || tp == CanvasEx.TEXTPOS_MIDDLECENTER || tp == CanvasEx.TEXTPOS_MIDDLERIGHT ? (n.vertAlign = "middle", t -= 2) : (tp == CanvasEx.TEXTPOS_BOTTOMLEFT || tp == CanvasEx.TEXTPOS_BOTTOMCENTER || tp == CanvasEx.TEXTPOS_BOTTOMRIGHT) && (n.vertAlign = "top"), p1 = new MathEx.Point(h, t), n.points = (new List).append(p1), n.offsetX = 0, n.offsetY = 0, this._textData.push(n)
};
TradingView.Study.StudyPaneView_hlines.prototype._calcHorzLinesData = function () {
    var f, t, s, e, r, u, o, n, i;
    if (this._data = [], f = this.Q1.graphics().hlines, f && (t = this.Q1.priceScale(), t && !t.isEmpty()))for (s = this.Q1.firstValue(), e = 0; e < f.length; e++)if (r = f[e], r.data && (u = this.Q1.properties().graphics.hlines[r.styleId], u.visible.value()))for (o = 0; o < r.data.length; o++)n = {}, i = r.data[o].level, t.isPercent() && (i = t.priceRange().convertToPercent(i, s)), i = t.priceToCoordinate(i), n.points = (new List).append(new MathEx.Point(0, i)), n.color = u.color.value(), n.linewidth = u.width.value(), n.linestyle = u.style.value(), n.hitTestResult = HitTestResult.REGULAR, this._data.push(n)
};
TradingView.Study.StudyPriceAxisView_hlines = function (n, t, i, r, u) {
    this.Q1 = n;
    this.Q0 = t;
    this._line = i;
    this._styleId = r;
    this._data = {};
    this._lineType = u;
    this._invalidated = !0
};
inherit(TradingView.Study.StudyPriceAxisView_hlines, PriceAxisView);
TradingView.Study.StudyPriceAxisView_hlines.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPriceAxisView_hlines.prototype.updateImpl = function () {
    var t, n, i;
    if (this._data = {}, this._data.visible = !1, t = this.Q1.priceScale(), t && !t.isEmpty() && this.Q1.properties().visible.value() && (n = this.Q1.properties().graphics[this._lineType][this._styleId], n.visible && n.visible.value() && n.showPrice && n.showPrice.value())) {
        if (i = this.Q1.firstValue(), this._data.visible = !0, this._data.color = "white", this._data.background = n.color.value(), n = this._line.level, t.isPercent()) {
            if (!isNumber(i))return;
            n = t.priceRange().convertToPercent(n, i)
        }
        this._data.coordinate = t.priceToCoordinate(n);
        this._data.textHeight = t.m_markBuilder.fontHeight();
        this._data.text = t.formatter().format(n)
    }
};
TradingView.Study.StudyPriceAxisView_hlines.prototype.renderer = function () {
    return this._invalidated && (this.updateImpl(), this._invalidated = !1), new PriceAxisViewRenderer(this._data)
};
TriangleTextMarkRenderer.prototype.fontStyle = function () {
    return(this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._data.fontSize + "px " + this._data.font
};
TriangleTextMarkRenderer.prototype.draw = function (n) {
    var t, e, o, r;
    if (this._data) {
        t = "up" == this._data.direction ? 1 : -1;
        e = this._data.point.x;
        "left" == this._data.halign ? e -= this._data.size : "right" == this._data.halign && (e += this._data.size);
        o = this._data.point.y;
        n.font = this.fontStyle();
        r = n.measureText(this._data.text).width;
        this._textCache.textWidth = r;
        var u = this._data.fontSize, f = .65 * u, i = 1 * u;
        n.save();
        n.translate(e + .5, o + .5);
        n.beginPath();
        n.moveTo(0, 0);
        switch (this._data.direction) {
            case"up":
            case"down":
                n.lineTo(f, i * t);
                n.lineTo(.5 * r + f, i * t);
                n.lineTo(.5 * r + f, (i + 1.75 * u) * t);
                n.lineTo(.5 * -r - f, (i + 1.75 * u) * t);
                n.lineTo(.5 * -r - f, i * t);
                n.lineTo(-f, i * t);
                n.lineTo(0, 0);
                n.strokeStyle = this._data.borderColor;
                n.stroke();
                n.fillStyle = this._data.color;
                n.fill();
                n.fillStyle = this._data.fontColor;
                n.fillText(this._data.text, .5 * -r, 0 > t ? t * i - .5 * u : i + 1.25 * u);
                break;
            default:
                throw this._data.direction + " doesn't supported by TriangleTextMarkRenderer";
        }
        n.restore()
    }
};
TriangleTextMarkRenderer.prototype.hitTest = function (n) {
    var t = this._textCache.textWidth, i = this._data.fontSize;
    switch (this._data.direction) {
        case"up":
        case"down":
            var u = "up" == this._data.direction ? 1 : -1, s = .65 * i, r = 1 * i, f = this._data.point.x;
            "left" == this._data.halign ? f -= this._data.size : "right" == this._data.halign && (f += this._data.size);
            var e = this._data.point.y, h = f + .5 * t + s, o = e + r * u, r = e + (r + 1.75 * i) * u;
            if ((r < o && (e = o, o = r, r = e), MathEx.pointInRect(n, new MathEx.Point(f - .5 * t - s, o), new MathEx.Point(h, r))) || (t = [
                {}
            ], t[0].x = this._data.point.x, t[0].y = this._data.point.y, t[1] = {}, t[1].x = this._data.point.x + .65 * i, t[1].y = this._data.point.y + i * u, t[2] = {}, t[2].x = this._data.point.x - .65 * i, t[2].y = this._data.point.y + i * u, i = (n.x - t[0].x) * (t[1].y - t[0].y) - (n.y - t[0].y) * (t[1].x - t[0].x), 0 < ((n.x - t[1].x) * (t[2].y - t[1].y) - (n.y - t[1].y) * (t[2].x - t[1].x)) * i && 0 < ((n.x - t[2].x) * (t[0].y - t[2].y) - (n.y - t[2].y) * (t[0].x - t[2].x)) * i))return new HitTestResult(HitTestResult.REGULAR);
            break;
        default:
            throw this._data.direction + " doesn't supported by TriangleTextMarkRenderer";
    }
    return null
};
RectangleTextMarkRenderer.prototype.fontStyle = function () {
    return(this._data.bold ? "bold " : "") + (this._data.italic ? "italic " : "") + this._data.fontSize + "px " + this._data.font
};
RectangleTextMarkRenderer.prototype.draw = function (n) {
    var t, i, r;
    if (this._data) {
        t = this._data.point.x;
        i = this._data.point.y;
        n.font = this.fontStyle();
        r = n.measureText(this._data.text).width;
        this._textCache.textWidth = r;
        n.save();
        n.translate(t + .5, i + .5);
        n.beginPath();
        n.moveTo(0, 0);
        t = this._data.valign;
        n.textAlign = this._data.halign;
        switch (t) {
            case"middle":
                n.textBaseline = "middle";
                break;
            case"top":
                n.textBaseline = "bottom";
                break;
            case"bottom":
                n.textBaseline = "hanging"
        }
        n.fillStyle = this._data.fontColor;
        n.fillText(this._data.text, 0, 0);
        n.restore()
    }
};
RectangleTextMarkRenderer.prototype.hitTest = function (n) {
    var t = this._data.point.x + .5, i = this._data.point.y + .5, r = this._textCache.textWidth, u = this._data.fontSize, f = this._data.halign;
    switch (this._data.valign) {
        case"middle":
            i -= u / 2;
            break;
        case"bottom":
            i -= u
    }
    switch (f) {
        case"right":
            t -= r;
            break;
        case"center":
            t -= r / 2
    }
    return f = new MathEx.Point(t, i), t = new MathEx.Point(t + r, i + u), MathEx.pointInRect(n, f, t) ? new HitTestResult(HitTestResult.REGULAR) : null
};
CircleShapeMarkRenderer.prototype.draw = function (n) {
    if (this._data) {
        var t = "down" == this._data.direction ? 1 : "up" == this._data.direction ? -1 : 0, i = this._data.point.x, r = this._data.point.y;
        n.save();
        n.fillStyle = this._data.color;
        n.beginPath();
        n.arc(i + 1, r + 2 * this._data.size * t + .5, this._data.size, 0, 2 * Math.PI);
        n.closePath();
        n.fill();
        n.stroke()
    }
};
CircleShapeMarkRenderer.prototype.hitTest = function (n) {
    var t = "down" == this._data.direction ? 1 : "up" == this._data.direction ? -1 : 0;
    return Math.pow(this._data.point.x + .5 - n.x, 2) + Math.pow(this._data.point.y + .5 + 2 * this._data.size * t - n.y, 2) <= Math.pow(this._data.size, 2) ? new HitTestResult(HitTestResult.REGULAR) : null
};
SquareShapeMarkRenderer.prototype.draw = function (n) {
    if (this._data) {
        var i = "down" == this._data.direction ? 1 : "up" == this._data.direction ? -1 : 0, t = parseInt(this._data.size), r = new MathEx.Point(this._data.point.x - t / 2, this._data.point.y - t / 2 + i * t), i = new MathEx.Point(this._data.point.x + t / 2, this._data.point.y + t / 2 + i * t).substract(r);
        n.beginPath();
        n.fillStyle = this._data.color;
        n.rect(r.x, r.y, i.x, i.y);
        n.stroke();
        n.fill()
    }
};
SquareShapeMarkRenderer.prototype.hitTest = function (n) {
    var r = "down" == this._data.direction ? 1 : "up" == this._data.direction ? -1 : 0, t = parseInt(this._data.size), i = new MathEx.Point(this._data.point.x - t / 2, this._data.point.y - t / 2 + r * t), t = new MathEx.Point(this._data.point.x + t / 2, this._data.point.y + t / 2 + r * t), r = new MathEx.Point(Math.min(i.x, t.x), Math.min(i.y, t.y)), i = new MathEx.Point(Math.max(i.x, t.x), Math.max(i.y, t.y));
    return MathEx.pointInRect(n, r, i) ? new HitTestResult(HitTestResult.REGULAR) : null
};
ArrowShapeMarkRenderer.prototype.draw = function (n) {
    if (this._data) {
        var h = this._arrowDirection, u = 1 * this._data.size, c = this._data.color, i = this._data.point.x + 1, t = this._data.point.y, r = 1.1 * u;
        switch (h) {
            case"up":
                t -= r;
                break;
            case"down":
                t += r
        }
        var r = u / 6, f = u / 4, e = u / 3, s = u / 2, o = .6666666 * u;
        n.save();
        n.fillStyle = c;
        n.beginPath();
        switch (h) {
            case"up":
                n.moveTo(i, t);
                n.lineTo(i - s, t + o);
                n.lineTo(i - f, t + o);
                n.lineTo(i, t + e);
                n.lineTo(i + f, t + o);
                n.lineTo(i + s, t + o);
                n.lineTo(i, t);
                break;
            case"down":
                n.moveTo(i, t + u);
                n.lineTo(i - s, t + e);
                n.lineTo(i - f, t + e);
                n.lineTo(i, t + o);
                n.lineTo(i + f, t + e);
                n.lineTo(i + s, t + e);
                n.lineTo(i, t + u);
                break;
            case"right":
                n.moveTo(i + r, t);
                n.lineTo(i - r, t - f);
                n.lineTo(i - r, t + f);
                n.lineTo(i + r, t);
                break;
            case"left":
                n.moveTo(i - r, t);
                n.lineTo(i + r, t - f);
                n.lineTo(i + r, t + f);
                n.lineTo(i - r, t)
        }
        n.closePath();
        n.fill();
        n.stroke()
    }
};
ArrowShapeMarkRenderer.prototype.hitTest = function (n) {
    var i = this._data.point.x, t = this._data.point.y, c = this._arrowDirection, r = 1 * this._data.size, u = r / 2, u = 1.1 * r;
    switch (c) {
        case"up":
            t -= u;
            break;
        case"down":
            t += u
    }
    var f = r / 6, e = r / 4, l = r / 3, u = r / 2, a = .6666666 * r;
    switch (c) {
        case"up":
            var o = new MathEx.Point(i, t), s = new MathEx.Point(i + u, t + a), h = new MathEx.Point(i - u, t + a);
            break;
        case"down":
            o = new MathEx.Point(i, t + r);
            s = new MathEx.Point(i + u, t + l);
            h = new MathEx.Point(i - u, t + l);
            break;
        case"right":
            o = new MathEx.Point(i + f, t);
            s = new MathEx.Point(i - f, t - e);
            h = new MathEx.Point(i - f, t + e);
            break;
        case"left":
            o = new MathEx.Point(i - f, t);
            s = new MathEx.Point(i + f, t - e);
            h = new MathEx.Point(i + f, t + e)
    }
    return MathEx.pointInTriangle(o, s, h, n) ? new HitTestResult(HitTestResult.REGULAR) : null
};
TradingView.Study.StudyPaneView_textmarks = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = [];
    this._textCache = []
};
inherit(TradingView.Study.StudyPaneView_textmarks, LocationToYMixin);
TradingView.Study.StudyPaneView_textmarks.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_textmarks.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)switch (this._data[n].shape) {
        case"triangle":
            t.append(new TriangleTextMarkRenderer(this._data[n], this._textCache[n]));
            break;
        case"rectangle":
            t.append(new RectangleTextMarkRenderer(this._data[n], this._textCache[n]))
    }
    return t
};
TradingView.Study.StudyPaneView_textmarks.prototype._updateViewInternal = function () {
    var s, o, e, n, r, h, a, i;
    if (this._data = [], s = this.Q1.graphics().textmarks, s && (o = this.Q1.priceScale(), e = this.Q0.timeScale(), o && !o.isEmpty() && e && !e.isEmpty()))for (var v = this.Q1.graphics().indexes, y = this.Q1.firstValue(), c = this.Q0.timeScale().visibleBars(), w = c.firstBar(), c = c.lastBar(), l = 0; l < s.length; l++)if (r = s[l], r.data && (n = this.Q1.properties().graphics.textmarks[r.styleId], n.visible.value()))for (r = r.data, h = 0; h < r.length; h++) {
        var u = r[h], t = {}, p = n.location.value(), b = n.shape.value(), f = v[u.time];
        if (!(f < w || f > c) && this.Q1.series().bars().valueAt(f)) {
            f = v[u.time] + (u.offset || 0);
            t.font = n.fontFamily.value();
            t.color = generateColor(n.color.value(), n.transparency.value());
            t.bold = n.fontBold.value();
            t.fontColor = generateColor(n.fontColor.value(), n.transparency.value());
            t.italic = n.fontItalic.value();
            t.fontSize = n.fontSize.value();
            t.text = u.text ? u.text : "";
            t.halign = n.halign.value();
            t.valign = void 0 != n.valign ? n.valign.value() : "middle";
            t.shape = n.shape.value();
            t.size = .5 * e.barSpacing();
            t.borderColor = "rgb(0, 0, 0)";
            switch (b) {
                case"triangle":
                    i = this._calcCoordsForTriangleShape(p, f, 50, u.price, y, o);
                    t.direction = i.direction;
                    a = Math.round(e.indexToCoordinate(f));
                    i = i.y;
                    break;
                case"rectangle":
                    i = this._calcCoordsForRectangleShape(p, f, u.price, y, o, e);
                    a = i.x;
                    i = i.y
            }
            t.point = new MathEx.Point(a, i);
            this._data.push(t);
            this._textCache.push({})
        }
    }
};
TradingView.Study.StudyPaneView_textmarks.prototype._calcCoordsForTriangleShape = function (n, t, i, r, u, f) {
    switch (n) {
        case CanvasEx.MARKLOC_TOP:
            n = f.height() - i;
            t = "down";
            break;
        case CanvasEx.MARKLOC_BOTTOM:
            n = i;
            t = "up";
            break;
        case CanvasEx.MARKLOC_ABSOLUTEDOWN:
            f.isPercent() && (r = f.priceRange().convertToPercent(r, u));
            n = f.priceToCoordinate(r);
            t = "down";
            break;
        case CanvasEx.MARKLOC_ABSOLUTEUP:
            f.isPercent() && (r = f.priceRange().convertToPercent(r, u));
            n = f.priceToCoordinate(r);
            t = "up";
            break;
        case CanvasEx.MARKLOC_ABOVEBAR:
            n = this._locationToY(n, t);
            t = "down";
            break;
        case CanvasEx.MARKLOC_BELOWBAR:
            n = this._locationToY(n, t);
            t = "up";
            break;
        default:
            n = this._locationToY(n, t);
            t = "up"
    }
    return{y: n, direction: t}
};
TradingView.Study.StudyPaneView_textmarks.prototype._calcCoordsForRectangleShape = function (n, t, i, r, u, f) {
    var e = Math.round(f.indexToCoordinate(t));
    switch (n) {
        case CanvasEx.MARKLOC_ABSOLUTEDOWN:
        case CanvasEx.MARKLOC_ABSOLUTEUP:
        case CanvasEx.MARKLOC_ABSOLUTE:
            u.isPercent() && (i = u.priceRange().convertToPercent(i, r));
            n = u.priceToCoordinate(i);
            break;
        case CanvasEx.MARKLOC_ABOVEBAR:
            n = this._locationToY(n, t);
            break;
        case CanvasEx.MARKLOC_BELOWBAR:
            n = this._locationToY(n, t);
            break;
        case CanvasEx.MARKLOC_RIGHT:
            e = f.width();
            u.isPercent() && (i = u.priceRange().convertToPercent(i, r));
            n = u.priceToCoordinate(i);
            break;
        case CanvasEx.MARKLOC_LEFT:
            e = f.width();
            u.isPercent() && (i = u.priceRange().convertToPercent(i, r));
            n = u.priceToCoordinate(i);
            break;
        default:
            n = this._locationToY(n, t)
    }
    return{x: e, y: n}
};
TradingView.Study.StudyPaneView_shapemarks = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = [];
    this._textCache = []
};
inherit(TradingView.Study.StudyPaneView_shapemarks, LocationToYMixin);
TradingView.Study.StudyPaneView_shapemarks.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_shapemarks.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)switch (this._data[n].shape) {
        case"circle":
            t.append(new CircleShapeMarkRenderer(this._data[n], this._textCache[n]));
            break;
        case"square":
            t.append(new SquareShapeMarkRenderer(this._data[n], this._textCache[n]));
            break;
        case"arrowUp":
            t.append(new ArrowShapeMarkRenderer(this._data[n], this._textCache[n], "up"));
            break;
        case"arrowDown":
            t.append(new ArrowShapeMarkRenderer(this._data[n], this._textCache[n], "down"));
            break;
        case"arrowRight":
            t.append(new ArrowShapeMarkRenderer(this._data[n], this._textCache[n], "right"));
            break;
        case"arrowLeft":
            t.append(new ArrowShapeMarkRenderer(this._data[n], this._textCache[n], "left"))
    }
    return t
};
TradingView.Study.StudyPaneView_shapemarks.prototype._updateViewInternal = function () {
    var h, e, r, i, f, c, t, u, n, s;
    if (this._data = [], h = this.Q1.graphics().shapemarks, h && (e = this.Q1.priceScale(), r = this.Q0.timeScale(), e && !e.isEmpty() && r && !r.isEmpty()))for (var v = this.Q1.graphics().indexes, l = this.Q0.timeScale().visibleBars(), y = l.firstBar(), l = l.lastBar(), a = 0; a < h.length; a++)if (f = h[a], f.data && (i = this.Q1.properties().graphics.shapemarks[f.styleId], i.visible.value()))for (f = f.data, c = 0; c < f.length; c++)if (t = f[c], u = v[t.time], !(u < y || u > l) && (n = {}, null != t.time && this.Q1.series().bars().valueAt(u))) {
        n.color = generateColor(i.color.value(), i.transparency.value());
        s = 0;
        "left" == i.halign.value() ? s -= r.barSpacing() / 2 + 1 : "right" == i.halign.value() && (s += r.barSpacing() / 2 + 1);
        n.size = i.size.value();
        n.shape = i.shape.value();
        var s = Math.round(r.indexToCoordinate(u)) + s, o = this.Q1.firstValue(), t = t.price;
        e.isPercent() && (t = e.priceRange().convertToPercent(t, o));
        t = e.priceToCoordinate(t);
        o = i.location.value();
        switch (o) {
            case CanvasEx.MARKLOC_ABSOLUTE:
                n.direction = "";
                break;
            case CanvasEx.MARKLOC_ABSOLUTEDOWN:
                n.direction = "down";
                break;
            case CanvasEx.MARKLOC_ABSOLUTEUP:
                n.direction = "up";
                break;
            case CanvasEx.MARKLOC_ABOVEBAR:
                t = this._locationToY(o, u, Math.floor(2 * n.size / r.barSpacing()) + 1);
                n.direction = "up";
                break;
            case CanvasEx.MARKLOC_BELOWBAR:
                t = this._locationToY(o, u, Math.floor(2 * n.size / r.barSpacing()) + 1);
                n.direction = "down";
                break;
            default:
                console.warn("Bad location value: " + o);
                t = this._locationToY(CanvasEx.MARKLOC_ABSOLUTEUP, u);
                n.direction = "up"
        }
        n.point = new MathEx.Point(s, t);
        this._data.push(n);
        this._textCache.push({})
    }
};
BackgroundRenderer.prototype.draw = function () {
};
BackgroundRenderer.prototype.drawBackground = function (n) {
    var t = this._data;
    clearRect(n, t.x1, t.y1, t.x2 - t.x1, t.y2 - t.y1, generateColor(this._data.color, this._data.transparency))
};
BackgroundRenderer.prototype.hitTest = function () {
    return null
};
TradingView.Study.StudyPaneView_backgrounds = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_backgrounds.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_backgrounds.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new BackgroundRenderer(this._data[n]));
    return t
};
TradingView.Study.StudyPaneView_backgrounds.prototype._hideExtendedHours = function (n) {
    return"inSession" === n || "outOfSession" === n ? !this.Q1._series.properties().extendedHours.value() : !1
};
TradingView.Study.StudyPaneView_backgrounds.prototype._updateViewInternal = function () {
    var f, n, e, y, p, r, t, u;
    if (this._data = [], f = this.Q1.graphics().backgrounds, f && (n = this.Q0.timeScale(), e = this.Q1.priceScale(), e && !e.isEmpty() && n && !n.isEmpty()))for (var v = this.Q1.graphics().indexes, s = this.Q0.timeScale().visibleBars(), w = s.firstBar(), s = s.lastBar(), h = 0; h < f.length; h++) {
        var o = f[h], r = o.styleId, o = o.data, c = this.Q1.properties().graphics.backgrounds[r];
        if (!this._hideExtendedHours(r) && c.visible.value())for (r = 0; r < o.length; r++) {
            var t = o[r], i = {}, l = v[t.start], a = v[t.stop];
            a < w || l > s || null == t.start || null == t.stop || (t = Math.ceil(n.indexToCoordinate(l, !0) - .5 * n.barSpacing()), u = Math.ceil(n.indexToCoordinate(a, !0) + .5 * n.barSpacing()), p == l - 1 && (t = y), y = u, p = a, 0 > t && 0 > u || t > n.width() && u > n.width() || (i.x1 = t, i.x2 = u, i.y1 = 0, i.y2 = e.height(), i.color = c.color.value(), i.transparency = c.transparency.value(), this._data.push(i)))
        }
    }
};
TradingView.Study.StudyPaneView_polygons = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_polygons.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_polygons.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new PoligonRenderer(this._data[n], new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_polygons.prototype._updateViewInternal = function () {
    var o, f, s, e, r, h;
    if (this._data = [], o = this.Q1.graphics().polygons, o && (f = this.Q1.priceScale(), s = this.Q1.Q0.timeScale(), f && !f.isEmpty() && s && !s.isEmpty()))for (var p = this.Q1.firstValue(), a = this.Q1.graphics().indexes, c = this.Q0.timeScale().visibleBars(), w = c.firstBar(), c = c.lastBar(), l = 0; l < o.length; l++)if (e = o[l], e.data && (r = this.Q1.properties().graphics.polygons[e.styleId], 100 != r.transparency.value()))for (h = 0; h < e.data.length; h++) {
        for (var u = e.data[h], n = Infinity, t = -Infinity, i = 0; u.points && i < u.points.length; i++)var v = a[u.points[i].index] + (u.points[i].offset || 0), n = Math.min(n, v), t = Math.max(t, v);
        if (!(t < w || n > c)) {
            for (n = {}, n.points = new List, i = 0; u.points && i < u.points.length; i++)objPoint = u.points[i], x = s.indexToCoordinate(a[objPoint.index] + (objPoint.offset || 0)), t = objPoint.level, f.isPercent() && (t = f.priceRange().convertToPercent(t, p)), y = f.priceToCoordinate(t), t = new MathEx.Point(x, y), t.data = i, n.points.append(t);
            n.color = r.color.value();
            n.backcolor = r.color.value();
            n.linewidth = void 0 != r.showBorder && r.showBorder.value() ? 1 : 0;
            n.linestyle = CanvasEx.LINESTYLE_SOLID;
            n.filled = !0;
            n.fillBackground = !0;
            n.transparency = r.transparency.value();
            n.mouseTouchable = r.mouseTouchable.value();
            this._data.push(n)
        }
    }
};
TradingView.Study.StudyPaneView_trendchannels = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = []
};
TradingView.Study.StudyPaneView_trendchannels.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_trendchannels.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    for (var t = new CompositeRenderer, n = 0; n < this._data.length; n++)t.append(new PoligonRenderer(this._data[n], new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_trendchannels.prototype._updateViewInternal = function () {
    var h, i, r, e, u, l;
    if (this._data = [], h = this.Q1.graphics().trendchannels, h && (i = this.Q1.priceScale(), r = this.Q1.Q0.timeScale(), i && !i.isEmpty() && r && !r.isEmpty()))for (var y = function (n) {
        return i.isPercent() && (n = i.priceRange().convertToPercent(n, c)), i.priceToCoordinate(n)
    }, b = function (n, t, i, r, u, f) {
        var e = new MathEx.Point(0, 0);
        return r = new MathEx.Point(i, r), u && (u = n.substract(t), (u = MathEx.intersectRayWithRect(n, n.add(u), e, r)) ? n = u : t.x = i), f && (u = t.substract(n), (u = MathEx.intersectRayWithRect(t, t.add(u), e, r)) ? t = u : t.x = i), [n, t]
    }, c = this.Q1.firstValue(), k = this.Q1.graphics().indexes, p = this.Q0.timeScale().visibleBars(), d = p.firstBar(), p = p.lastBar(), w = 0; w < h.length; w++)if (e = h[w], e.data)for (u = this.Q1.properties().graphics.trendchannels[e.styleId], l = 0; l < e.data.length; l++) {
        var t = e.data[l], o = k[t.startIndex], n = k[t.endIndex];
        if (!(Math.max(o, n) < d && !t.extendRight || Math.min(o, n) > p && !t.extendLeft)) {
            var a = y(t.startHighPrice, i, c), v = y(t.startLowPrice, i, c), f = y(t.endHighPrice, i, c), s = f - (a - v), o = r.indexToCoordinate(o), n = r.indexToCoordinate(n), a = new MathEx.Point(o, a), v = new MathEx.Point(o, v), f = new MathEx.Point(n, f), s = new MathEx.Point(n, s), f = b(a, f, r.width(), i.height(), t.extendLeft, t.extendRight), s = b(v, s, r.width(), i.height(), t.extendLeft, t.extendRight), a = f[0], f = f[1], v = s[0], s = s[1], n = {};
            n.points = new List;
            n.points.append(a);
            n.points.append(v);
            n.points.append(s);
            n.points.append(f);
            n.color = u.color.value();
            n.backcolor = u.color.value();
            n.linewidth = void 0 != u.borderWidth ? u.borderWidth.value() : 0;
            n.linestyle = CanvasEx.LINESTYLE_SOLID;
            n.filled = !0;
            n.fillBackground = !0;
            t.transparency ? (t = t.transparency + u.transparency.value(), n.transparency = Math.min(t, 100)) : n.transparency = u.transparency.value();
            n.mouseTouchable = !0;
            this._data.push(n)
        }
    }
};
TradingView.Study.StudyPaneView_hhists = function (n, t) {
    this.Q1 = n;
    this.Q0 = t;
    this._data = [];
    this._textData = [];
    this._textRendererCache = {}
};
TradingView.Study.StudyPaneView_hhists.prototype.update = function () {
    this._invalidated = !0
};
TradingView.Study.StudyPaneView_hhists.prototype.renderer = function () {
    this._invalidated && (this._updateViewInternal(), this._invalidated = !1);
    var t = new CompositeRenderer;
    for (var n in this._data)t.append(new HorizHistogramRenderer(this._data[n]));
    for (n = 0; n < this._textData.length; n++)t.append(new TextRenderer(this._textData[n], this._textRendererCache, new HitTestResult(HitTestResult.REGULAR)));
    return t
};
TradingView.Study.StudyPaneView_hhists.prototype._updateViewInternal = function () {
    var t, i, r, s, n, a;
    if (this._data = [], this._textData = [], t = this.Q1.priceScale(), i = this.Q0.timeScale(), t && !t.isEmpty() && i && !i.isEmpty() && (r = this.Q1.graphics().hhists, r))for (var f = this.Q1.graphics().indexes, e = this.Q0.timeScale().visibleBars(), v = e.firstBar(), e = e.lastBar(), o = 0; o < r.length; o++)if (n = r[o], s = this.Q1.properties().graphics.hhists[n.styleId], s.visible.value()) {
        n = n.dataObj;
        for (a in n) {
            for (var u = n[a], h = Infinity, c = -Infinity, l = u.length; l--;)h = Math.min(h, f[u[l].firstBarTime]), c = Math.max(c, f[u[l].lastBarTime]);
            c < v || h > e || this._updateDataForRenderers(u, s, t, i, f)
        }
    }
};
TradingView.Study.StudyPaneView_hhists.prototype._updateDataForRenderers = function (n, t, i, r, u) {
    for (var e, rt, ut, o, h, l, f, c, nt = [], tt = this._findMaxRate(n), it = this.Q1.firstValue(), a = null, v = null, w = null, d = {}, b = 0; b < n.length; b++)for (e = n[b], null === v && (v = this._findActualRateLength(e.rate)), null === a && (a = Math.abs(r.indexToCoordinate(u[e.firstBarTime]) - r.indexToCoordinate(u[e.lastBarTime])), a = t.percentWidth.value() * a / 100, a -= v, a = Math.max(a, 0)), rt = !1, o = 0; o < v; o++)if (0 != e.rate[o]) {
        if (d[o] = void 0 == d[o] ? e.rate[o] : d[o] + e.rate[o], i.isPercent() ? (h = i.priceRange().convertToPercent(e.priceHigh, it), l = i.priceRange().convertToPercent(e.priceLow, it)) : (h = e.priceHigh, l = e.priceLow), f = {}, f.y1 = i.priceToCoordinate(h) + 1, f.y2 = i.priceToCoordinate(l) - 1, 0 === b && (ut = f.y2, lastHistHeight = f.y2 - f.y1), l = t.location.value(), h = t.direction.value(), l == CanvasEx.HHISTLOC_ABSOLUTE && h == CanvasEx.HHISTDIR_LEFTTORIGHT)var y = r.indexToCoordinate(u[e.firstBarTime]), p = 1, k = "left"; else if (l == CanvasEx.HHISTLOC_ABSOLUTE && h == CanvasEx.HHISTDIR_RIGHTTOLEFT)y = r.indexToCoordinate(u[e.lastBarTime]), p = -1, k = "right"; else if (l == CanvasEx.HHISTLOC_RELATIVE && h == CanvasEx.HHISTDIR_LEFTTORIGHT)y = 0, p = 1, k = "left"; else if (l == CanvasEx.HHISTLOC_RELATIVE && h == CanvasEx.HHISTDIR_RIGHTTOLEFT)y = r.width(), p = -1, k = "right"; else throw Error("Unknown location/direction values: " + l + "/" + h);
        if (f.x1 = 0 == o ? y : y + p * (a * e.rate[o - 1] / tt + v), f.x2 = f.x1 + a * e.rate[o] / tt * p, f.colorBg = t.colors[o].value(), f.transparency = t.transparencies[o].value(), f.blendedColor = generateColor(f.colorBg, f.transparency), f.x0 = y, nt.push(f), w || (w = .6 * (f.y2 - f.y1)), !rt && t.showValues.value() && 7.5 <= w) {
            var rt = !0, s = {}, l = this.Q1.formatter(), g = function (n, t, i) {
                if (i == CanvasEx.HHISTDIR_LEFTTORIGHT)return n + t;
                if (i == CanvasEx.HHISTDIR_RIGHTTOLEFT)return t + n;
                throw Error("Unknown direction value: " + i);
            };
            for (s.text = "", c = 0; c < v; c++)s.text = g(s.text, l.format(e.rate[c]), h), c != v - 1 && (s.text = g(s.text, "x", h));
            if (s.color = t.valuesColor.value(), s.font = "arial", s.fontsize = w, s.horzAlign = k, s.vertAlign = "middle", p1 = new MathEx.Point(y + 3 * p, f.y2 - .61 * (f.y2 - f.y1)), s.points = (new List).append(p1), s.offsetX = 0, s.offsetY = 0, this._textData.push(s), b === n.length - 1) {
                for (f = y + 3 * p, c = ut + .39 * lastHistHeight, f = {text: "", color: TradingView.shiftColor(t.valuesColor.value(), 1.5), font: "arial", fontsize: w, horzAlign: k, vertAlign: "middle", points: (new List).append(new MathEx.Point(f, c)), offsetX: 0, offsetY: 0}, c = 0; c < v; c++)f.text = g(f.text, l.format(d[c]), h), c != v - 1 && (f.text = g(f.text, "x", h));
                this._textData.push(f)
            }
        }
    }
    0 < nt.length && this._data.push(nt)
};
TradingView.Study.StudyPaneView_hhists.prototype._findMaxRate = function (n) {
    for (var i, r = 0, u = 0, t = 0; t < n.length; t++) {
        for (i = u = 0; i < n[t].rate.length; i++)u += n[t].rate[i];
        r = Math.max(r, u)
    }
    return r
};
TradingView.Study.StudyPaneView_hhists.prototype._findActualRateLength = function (n) {
    for (var r, i = 0, t = 0; t < n.length; ++t)if (r = n[t], null !== r && void 0 !== r)i++; else break;
    return i
};
HorizHistogramRenderer.prototype.hitTest = function (n) {
    var t = searchCoord(this._data, n.y), i;
    return 0 > t ? null : (i = Math.min(this._data[t].x0, this._data[t].x2), t = Math.max(this._data[t].x0, this._data[t].x2), i <= n.x && n.x <= t ? new HitTestResult(HitTestResult.REGULAR) : null)
};
HorizHistogramRenderer.prototype.draw = function (n) {
    var t, u;
    n.save();
    for (var r = {}, f = [], i = 0; i < this._data.length; i++)t = this._data[i], r[t.blendedColor] ? r[t.blendedColor].push(t) : (f.push(t.blendedColor), r[t.blendedColor] = [t]);
    for (u = 0; u < f.length; u++) {
        for (i = f[u], n.fillStyle = i, n.strokeStyle = i, n.beginPath(), rects = r[i], i = 0; i < rects.length; i++)t = rects[i], n.rect(t.x1, t.y1, t.x2 - t.x1, t.y2 - t.y1);
        n.stroke();
        n.fill()
    }
    n.restore()
};
TradingView.study_ScriptWithDataOffset = function (n, t, i, r) {
    TradingView.Study.call(this, n, t, i, r)
};
inherit(TradingView.study_ScriptWithDataOffset, TradingView.Study);
TradingView.study_ScriptWithDataOffset.prototype.clearData = function () {
    TradingView.Study.prototype.clearData.call(this);
    this._underlyingData = new PlotList(this._plotFields)
};
TradingView.study_ScriptWithDataOffset.prototype._mergeData = function (n) {
    var t = 0 === this._underlyingData._length() ? null : this._underlyingData._indexAt(0), i;
    for (this._underlyingData.merge(n), t !== this._underlyingData._indexAt(0) && (this.m_data = new PlotList(this._underlyingData.columns())), this.m_data._start = this._underlyingData._start, this.m_data._end = this._underlyingData._end, i = this.m_data._length(), n = i; n < this._underlyingData._length(); ++n)t = TradingView.merge({}, this._underlyingData._valueAt(n)), this.m_data.add(this._underlyingData._indexAt(n), t);
    this._plotsForStrategyProcessing().forEach(function (n) {
        this._createStrategy(n.strategy, n.strategyIndex, n.targetIndex, i).rebuildData(this.m_data)
    }, this)
};
TradingView.study_ScriptWithDataOffset.prototype._plotsForStrategyProcessing = function () {
    var t = ["dataoffset"], n = [];
    return this._metaInfo.plots.forEach(function (i, r) {
        if (-1 < t.indexOf(i.type)) {
            var u = null;
            this._metaInfo.plots.forEach(function (n, t) {
                n.id == i.target && (u = t)
            });
            assert(0 <= u, "target plot not found for strategy plot " + i.id);
            n.push({strategy: i.type, strategyIndex: r, targetIndex: u})
        }
    }, this), n
};
TradingView.study_ScriptWithDataOffset.prototype._createStrategy = function (n, t, i, r) {
    return new TradingView.study_ScriptWithDataOffset["Strategy_" + n](t, i, r)
};
TradingView.study_ScriptWithDataOffset.Strategy_dataoffset = function (n, t, i) {
    this._strategyPlotIndex = n;
    this._targetPlotIndex = t;
    this._startIndex = i
};
TradingView.study_ScriptWithDataOffset.Strategy_dataoffset.prototype.rebuildData = function (n) {
    for (var u = this._targetPlotIndex + 1, s = this._strategyPlotIndex + 1, f = null, t = null, e = this._startIndex; e < n._length(); ++e) {
        var r = n._valueAt(e), o = r[u], i = r[s] ? Math.round(r[s]) : null;
        r[u] = null;
        r[s] = null;
        !i || 0 < i || ((i = e + i, r = {pointIndex: i, value: o}, t) ? t.pointIndex != r.pointIndex && (0 <= i && (n._items[i].value[u] = o), i = !1, f && (i = f.value <= t.value && t.value <= o || f.value >= t.value && t.value >= o), i ? 0 <= t.pointIndex && (n._items[t.pointIndex].value[u] = null) : f = t, t = r) : t = r)
    }
};
TradingView.getDataVendorString = function (n) {
    if (n && "QUANDL" == n.exchange)return"Quandl.com"
};
D20 = function (n, t, i) {
    this._options = i || {};
    this._w = n;
    this._opener = t;
    this._addMetric = 1;
    this._addOpened = !1
};
D20.prototype._interval = function (n) {
    n = $(n.target);
    n.hasClass("disabled") || (this._w.setInterval(n.data("interval")), this.close())
};
D20.prototype._quickTitle = function (n) {
    return n ? $.t("Remove from favorites") : $.t("Add to favorites")
};
D20.prototype._onQuick = function (n) {
    var t = $(n.target.parentNode), t = this._w.toggleQuick(t.data("interval"));
    return $(n.target.parentNode).toggleClass("quicked", t), $(n.target).attr("title", this._quickTitle(t)), !1
};
D20.prototype._onDelete = function (n) {
    return n = $(n.target.parentNode), this._w.removeInterval(n.data("interval")), this._reopen(), !1
};
D20.prototype._showControlButtons = function () {
    return!0
};
D20.prototype._append = function (n, t) {
    var i = $("<span>").addClass("item").toggleClass("active", t == this._w.getInterval()).toggleClass("quicked", this._w.inQuick(t)).toggleClass("disabled", !this._w.isAvailable(t)).text(this._w.fullLabel(t)).data("interval", t);
    this._showControlButtons() && (this._w.isDefaultInterval(t) || i.prepend($("<span>").addClass("delete").attr("title", "Remove custom interval").click(this._onDelete.bind(this))), this._w._options.notShowQuicks || i.prepend($("<span>").addClass("to-quick").attr("title", this._quickTitle(this._w.inQuick(t))).click(this._onQuick.bind(this))));
    i.click(this._interval.bind(this));
    n.append(i)
};
D20.prototype._appendAdd = function (n) {
    function f() {
        var t = parseInt(i.val()), n;
        1 > t && i.val(1);
        n = {1: 1440, 60: 24, D: 364, W: 52, M: 12}[this._addMetric];
        t > n && i.val(n)
    }

    var e = $("<span>").addClass("item-add"), u = $('<span class="item-add-wrap">').appendTo(e), i = $('<input type="text">').addClass("tv-text-input inset minutes").val(1).appendTo(u).TVTicker(), r = $("<span>").addClass("tv-button mins").append($("<span>")).append($("<i>")).appendTo(u), u = $("<span>").addClass("tv-button add").text("add").appendTo(u), o = {1: "minutes", 60: "hours", D: "days", W: "weeks", M: "months"}, t;
    r.find("span").text(o[this._addMetric || 1]);
    i.change(f.bind(this));
    t = this;
    TradingView.bindPopupMenu(r, null, {direction: "up", event: "button-popup", addClass: "thin small-font metrics", popupSpacing: ~~this._w._options.popupSpacing, onRemove: function () {
        t._addOpened = !1
    }});
    r.click(function () {
        t._addOpened = !0;
        r.trigger("button-popup", [$.map(o, function (n, i) {
            return{title: n.toUpperCase(), active: i == t._addMetric, action: function () {
                return t._addMetric = i, r.find("span").text(n), f.call(t), !1
            }}
        })])
    });
    u.click(function () {
        runOrGoPro(function () {
            var n = parseInt(i.val()), r;
            n == n && (r = parseInt(t._addMetric), r == r ? t._addInterval("" + n * t._addMetric) : t._addInterval("" + n + t._addMetric))
        }, {feature: "customIntervals"})
    });
    n.append($("<div>").addClass("separator"));
    n.append(e)
};
D20.prototype._addInterval = function () {
};
D20.prototype._open = function (n, t) {
    n.find(".item, .item-add, .separator").remove();
    var i = [], r = [], u = [], f = $("<span>").addClass("separator");
    $.each(t, function (n, t) {
        /^\d*[DWM]$/.test(t) ? u.push(t) : this._w.isHour(t) ? r.push(t) : i.push(t)
    }.bind(this));
    i.length && i.forEach(function (t) {
        this._append(n, t)
    }.bind(this));
    r.length && (n.append(f.clone()), r.forEach(function (t) {
        this._append(n, t)
    }.bind(this)));
    u.length && (n.append(f.clone()), u.forEach(function (t) {
        this._append(n, t)
    }.bind(this)));
    this._options.onWidget || J77.enabled("charting_library") || this._appendAdd(n)
};
D20.prototype._reopen = function () {
    this._open(this._menu, this._w._sorted(this._w._intervals))
};
D20.prototype.open = function (n) {
    var t = $("<div>").addClass("charts-popup-list intervals-list favored-list").toggleClass("touch", Modernizr.touch), i = this._w.mainButton().offset(), r = this._w.mainButton().outerHeight(), u = i.top + r + parseInt(this._options.popupSpacing || 0);
    t.appendTo(document.body);
    t.css({top: u, left: i.left}).show();
    this._menu = t;
    this._opener.addClass("active");
    this._open(t, n);
    n = Math.min($("body").height(), $(window).height()) - r - u - 10;
    this._setMaxHeight(t, n);
    setTimeout(function () {
        t.on("mousedownoutside", function (n) {
            this.close(n) && t.unbind("mousedownoutside")
        }.bind(this))
    }.bind(this), 0)
};
D20.prototype._setMaxHeight = function (n, t) {
    n.height() >= t && (n.css("max-height", t + "px"), n.width(n.width() + 18))
};
D20.prototype.close = function (n) {
    return n && $(n.target).parents("span.item-add, .charts-popup-list.metrics").length ? !1 : (this._menu.remove(), $(document.body).off(".interval-menu"), delete this._menu, this._opener.removeClass("active"), !0)
};
D21 = function (n) {
    this._options = $.extend({interval: 1}, n || {});
    this._e = $("<div>").addClass("intervals-container favored-list-container");
    this._quick = $("<div>").addClass("quick").appendTo(this._e);
    this._quicked = {};
    this._main = $("<span>").text(this.shortLabel(this._options.interval)).appendTo(this._quick);
    this._main.data("interval", this._options.interval);
    J77.enabled("header_interval_dialog_button") && this._setIntervalDialogButton();
    this._mainSub = $("<span>").addClass("submenu").attr("title", $.t("Time Interval")).append($("<i>")).appendTo(this._e);
    n && "string" == typeof n.submenuBtnAddClass && this._mainSub.addClass(n.submenuBtnAddClass);
    this._quick.on("click", this._selectInterval.bind(this));
    this._mainSub.on("click", this._selectMenu.bind(this));
    this._menu = new D20(this, this._mainSub, this._options);
    this.onResize = new Delegate;
    D45.intraday.subscribe(this._fullUpdate.bind(this));
    n.interval && D45.interval.setValue(n.interval);
    D45.interval.subscribe(this.activateInterval.bind(this), {callWithLast: !0});
    TVXWindowEvents.on("intervalwidget-change", this._onChangeInAnotherTab.bind(this));
    this._fullUpdate()
};
D21.prototype.forceUpdate = function () {
    this._fullUpdate(!0)
};
D21.prototype._fullUpdate = function (n) {
    this._setupIntervals(n);
    this._setupQuicks(n);
    this.reactivateInterval();
    this._resize()
};
D21.prototype._onChangeInAnotherTab = function () {
    this._fullUpdate(!0)
};
D21.DWMPattern = /^(\d*)([DWM])$/;
D21.prototype.DWMPattern = D21.DWMPattern;
D21.isDWM = function (n) {
    return(n = this.DWMPattern.exec(n + "")) ? {qty: n[1] || "1", unit: n[2]} : !1
};
D21.prototype.isDWM = D21.isDWM;
D21.prototype.isDefaultInterval = function (n) {
    return n in Q16.defaultResolutions()
};
D21.prototype._setupIntervals = function () {
    this._intervals = $.extend({}, Q16.defaultResolutions())
};
D21.prototype._sorted = function (n) {
    if (!Array.isArray(n)) {
        var t = [];
        $.each(n, function (n) {
            t.push(n)
        });
        n = t
    }
    return n.sort(function (n, t) {
        function i(n) {
            var t = D21.isDWM(n);
            return t ? {D: 1440, W: 10080, M: 43200}[t.unit] * t.qty : parseInt(n)
        }

        return i(n) - i(t)
    })
};
D21.prototype.setUpStarredItemsList = function (n) {
    for (var i = {}, t = 0; t < n.length; ++t)i[n[t]] = !0;
    this._setupQuicks(!1, i)
};
D21.prototype._setupQuicks = function (n, t) {
    (!this._options.notShowQuicks || t) && (t = t || {}, J77.enabled("star_some_intervals_by_default") && (t = {1: !0, 30: !0, 60: !0}), this._quicked = TVSettings.getJSON("IntervalWidget.quicks", t, n), this._quicked = this._removeCustomIntervalQuicks(this._quicked));
    this._addQuicked(this._quicked)
};
D21.prototype._removeCustomIntervalQuicks = function (n) {
    var t = {};
    return $.each(n, function (n, i) {
        this.isDefaultInterval(n) && (t[n] = i)
    }.bind(this)), t
};
D21.prototype.element = function () {
    return this._e
};
D21.prototype.mainButton = function () {
    return this._main
};
D21.prototype._quicks = function () {
    return this._quick.find("span").slice(0, -1)
};
D21.prototype.postfix = function (n, t) {
    if (t) {
        var i = " ";
        switch (n) {
            case"D":
                i += $.t("day", {count: t});
                break;
            case"W":
                i += $.t("week", {count: t});
                break;
            case"M":
                i += $.t("month", {count: t});
                break;
            case"m":
                i += $.t("minute", {count: t});
                break;
            case"h":
                i += $.t("hour", {count: t})
        }
        return i
    }
    switch (n) {
        case"m":
            return"";
        case"h":
            return $.t("h", {context: "dates"});
        default:
            return $.t(n.toUpperCase(), {count: 0})
    }
};
D21.prototype.isHour = function (n) {
    return 60 <= n && !(n % 60)
};
D21.prototype.readable = function (n, t, i) {
    var r = "m", u = this.isDWM(n);
    if (u && (n = u.qty, r = u.unit), n = parseInt(n), !n)throw new TypeError("Wrong interval value: " + n);
    return"m" === r && this.isHour(n) && (n = ~~(n / 60), r = "h"), t = t ? n : null, "" + (i && 1 === n && "m" != r ? "" : n) + this.postfix(r, t)
};
D21.prototype.shortLabel = function (n) {
    return translatedIntervalString(this.readable(n, !1))
};
D21.prototype.fullLabel = function (n) {
    return this.readable(n, !0)
};
D21.prototype._addQuicked = function (n) {
    this._quicks().remove();
    n = this._sorted(n);
    $.each(n, function (n, t) {
        var i = $("<span>").data("interval", t).text(this.shortLabel(t)).toggleClass("selected", t == this.getInterval()).toggleClass("disabled", !this.isAvailable(t));
        this._main.before(i)
    }.bind(this));
    this._resize()
};
D21.prototype._resize = function () {
    this.onResize.fire()
};
D21.prototype.addQuick = function (n) {
    this._quicked[n] = !0;
    this._addQuicked(this._quicked);
    this.saveSettings();
    this.reactivateInterval()
};
D21.prototype._quickWithInterval = function (n) {
    var t = null;
    return this._quicks().each(function (i, r) {
        return r = $(r), n == r.data("interval") ? (t = r, !1) : void 0
    }), t
};
D21.prototype.inQuick = function (n) {
    return null != this._quickWithInterval(n)
};
D21.prototype.removeQuick = function (n) {
    this._quickWithInterval(n) && (this._quickWithInterval(n).remove(), this._resize(), delete this._quicked[n], this.saveSettings(), this.reactivateInterval())
};
D21.prototype.toggleQuick = function (n) {
    var t = this.inQuick(n);
    return t ? this.removeQuick(n) : this.addQuick(n), !t
};
D21.prototype.hasQuicks = function () {
    return!!this._quicks().length
};
D21.prototype.deactivate = function () {
    this._quick.find("span").removeClass("selected")
};
D21.prototype.activateInterval = function (n) {
    this.deactivate();
    this.inQuick(n) ? this._quickWithInterval(n).addClass("selected") : (this.hasQuicks() && this._main.addClass("selected"), this._main.text(this.shortLabel(n)), this._main.data("interval", n))
};
D21.prototype.reactivateInterval = function () {
    this.activateInterval(this.getInterval())
};
D21.prototype.getInterval = function () {
    return D45.interval.value()
};
D21.prototype.setInterval = function (n) {
    D45.interval.setValue("" + n)
};
D21.prototype._selectInterval = function (n) {
    n = $(n.target);
    var t = n.data("interval");
    this.hasQuicks() || this.getInterval() != t ? n.hasClass("disabled") || this.setInterval(t) : this._selectMenu()
};
D21.prototype._selectMenu = function (n) {
    this._mainSub.hasClass("active") ? this._menu.close(n) : this._menu.open(this._sorted(this._intervals))
};
D21.prototype._setIntervalDialogButton = function () {
    this._intervalDialogButton = $("<span>").addClass("submenu interval-dialog-button apply-common-tooltip").attr("title", $.t("Open Interval Dialog")).append($("<i>")).appendTo(this._e).click(function () {
        var t = new ChangeIntervalDialog({callback: function (n) {
            D45.interval.setValue(n)
        }}).show(), n = $(this);
        n.addClass("active");
        t.on("destroy", function () {
            n.removeClass("active")
        })
    })
};
D21.prototype.addInterval = function () {
};
D21.prototype.removeInterval = function () {
};
D21.prototype.saveIntervals = function () {
};
D21.prototype.saveQuicked = function () {
    TVSettings.setJSON("IntervalWidget.quicks", this._quicked)
};
D21.prototype.saveSettings = function () {
    this.saveQuicked();
    this.saveIntervals();
    TVXWindowEvents.emit("intervalwidget-change")
};
D21.isMinute = function (n) {
    return n = parseInt(n), 1 <= n && 1440 >= n
};
D21.prototype.isMinute = D21.isMinute;
D21.prototype.isAvailable = function (n) {
    var t = D45.supportedResolutions.value(), i = !1, i = "undefined" != typeof t ? -1 != t.indexOf(n) : !0;
    return D45.intraday.value() ? i : this.isDWM(n) && i
};
D22 = function (n) {
    this._fullInvalidation = n ? n : D22.UPDATE_CURSOR_ONLY;
    this._invalidatedPanes = {}
};
D22.UPDATE_CURSOR_ONLY = 1;
D22.LIGHT_UPDATE = 2;
D22.FULL_UPDATE = 3;
D22.prototype.invalidatePane = function (n, t) {
    this._invalidatedPanes[n] = this._invalidatedPanes[n] ? Math.max(this._invalidatedPanes[n], t) : t
};
D22.prototype.invalidateAll = function (n) {
    this._fullInvalidation = Math.max(this._fullInvalidation, n)
};
D22.prototype.fullInvalidation = function () {
    return this._fullInvalidation
};
D22.prototype.invalidateForPane = function (n) {
    return this._invalidatedPanes[n] ? Math.max(this._invalidatedPanes[n], this._fullInvalidation) : this._fullInvalidation
};
D22.prototype.merge = function (n) {
    this.force = this.force || n.force;
    this._fullInvalidation = Math.max(this._fullInvalidation, n._fullInvalidation);
    for (var t in n._invalidatedPanes)this._invalidatedPanes[t] = this._invalidatedPanes[t] ? Math.max(this._invalidatedPanes[t], n._invalidatedPanes[t]) : n._invalidatedPanes[t]
};
D22.prototype.exclude = function (n) {
    this._fullInvalidation <= n && (this._fullInvalidation = 0);
    for (var t in this._invalidatedPanes)this._invalidatedPanes[t] <= n && (this._invalidatedPanes[t] = 0)
};
PropertyPagesFactory = function () {
    function n(n) {
        return n instanceof J47 ? n instanceof TradingView.LineToolRiskReward ? _25 : n instanceof TradingView.LineToolRegressionTrend ? _24 : n instanceof TradingView.LineToolEllipse || n instanceof TradingView.LineToolRotatedRectangle || n instanceof TradingView.LineToolArc ? null : n instanceof TradingView.LineToolTrendAngle ? _28 : n instanceof TradingView.LineToolParallelChannel || n instanceof TradingView.LineToolPolyline || n instanceof TradingView.LineToolText || n instanceof TradingView.LineToolFibWedge || n instanceof TradingView.LineToolBrush ? null : n instanceof TradingView.LineToolHorzLine ? _11 : n instanceof TradingView.LineToolBarsPattern || n instanceof TradingView.LineToolDisjointAngle || n instanceof TradingView.LineToolFlatBottom ? null : n instanceof TradingView.LineToolVertLine ? _35 : n instanceof D63 ? _43 : n instanceof TradingView.LineToolIcon || n instanceof TradingView.LineToolTrading || n instanceof TradingView.LineToolExecution ? null : _14 : n instanceof TradingView.Study ? n instanceof TradingView.study_ElliottWave ? _40 : n instanceof TradingView.study_Compare ? _38 : _41 : null
    }

    function t(n) {
        if (n instanceof TradingView.Series || n instanceof D7 || n instanceof TradingView.ESDStudyBase)return D85;
        if (n instanceof TradingView.Study)return n instanceof TradingView.study_PivotPointsHighLow ? _45 : n instanceof TradingView.study_PivotPointsStandard ? _46 : n instanceof TradingView.study_ZigZag ? _48 : n instanceof TradingView.study_Overlay ? _44 : n instanceof TradingView.study_LinearRegression ? _42 : "Volume@tv-basicstudies" == n.metaInfo().id ? _50 : n instanceof TradingView.study_VbPVisible || n instanceof TradingView.study_VbPSessions ? _51 : _47;
        if (n instanceof J47) {
            if (n instanceof TradingView.LineToolVbPFixed)return _51;
            if (n instanceof TradingView.LineToolRegressionTrend)return _42;
            if (n instanceof TradingView.LineToolTrendLine)return _32;
            if (n instanceof TradingView.LineToolTrendAngle)return _29;
            if (n instanceof TradingView.LineToolDateRange || n instanceof TradingView.LineToolPriceRange)return D95;
            if (n instanceof TradingView.LineToolHorzLine || n instanceof TradingView.LineToolHorzRay)return _12;
            if (n instanceof TradingView.LineToolVertLine)return _36;
            if (n instanceof TradingView.LineToolPitchfork)return _18;
            if (n instanceof TradingView.LineToolPitchfan)return _17;
            if (n instanceof TradingView.LineToolText)return _27;
            if (n instanceof TradingView.LineToolNote)return LineToolNotePropertyPage;
            if (n instanceof TradingView.LineToolCallout)return D93;
            if (n instanceof TradingView.LineToolRectangle || n instanceof TradingView.LineToolRotatedRectangle)return _23;
            if (n instanceof TradingView.LineToolEllipse)return D98;
            if (n instanceof TradingView.LineToolArc)return D87;
            if (n instanceof TradingView.LineToolTriangle)return _34;
            if (n instanceof TradingView.LineToolParallelChannel)return _16;
            if (n instanceof TradingView.LineToolDisjointAngle)return D96;
            if (n instanceof TradingView.LineToolFlatBottom)return _7;
            if (n instanceof TradingView.LineToolArrowMark)return D88;
            if (n instanceof TradingView.LineToolPriceLabel)return _21;
            if (n instanceof TradingView.LineToolIcon)return _13;
            if (n instanceof TradingView.LineToolBalloon)return D89;
            if (n instanceof TradingView.LineToolBrush)return D92;
            if (n instanceof TradingView.LineToolPrediction)return _20;
            if (n instanceof TradingView.LineToolPolyline)return _19;
            if (n instanceof TradingView.LineToolGannSquare)return _10;
            if (n instanceof TradingView.LineToolGannComplex)return _8;
            if (n instanceof TradingView.LineToolGannFan)return _9;
            if (n instanceof TradingView.LineToolFibRetracement)return _1;
            if (n instanceof TradingView.LineToolFibChannel)return D99;
            if (n instanceof TradingView.LineToolFibCircles)return D84;
            if (n instanceof TradingView.LineToolFibSpiral)return _4;
            if (n instanceof TradingView.LineToolFibSpeedResistanceArcs)return _2;
            if (n instanceof TradingView.LineToolTrendBasedFibExtension)return _30;
            if (n instanceof TradingView.LineToolTrendBasedFibTime)return _31;
            if (n instanceof TradingView.LineToolFibSpeedResistanceFan)return _3;
            if (n instanceof TradingView.LineToolFibTimeZone)return _5;
            if (n instanceof TradingView.LineToolProjection)return _22;
            if (n instanceof TradingView.LineToolFibWedge)return _6;
            if (n instanceof TradingView.LineToolCircleLines)return D94;
            if (n instanceof TradingView.LineToolElliott)return D97;
            if (n instanceof TradingView.LineToolBarsPattern)return D91;
            if (n instanceof TradingView.LineToolRiskReward)return _26;
            if (n instanceof TradingView.LineTool5PointsPattern)return _15;
            if (n instanceof TradingView.LineToolABCD)return D86;
            if (n instanceof TradingView.LineToolTrianglePattern)return _33;
            if (n instanceof TradingView.LineToolThreeDrivers)return D86;
            if (n instanceof TradingView.LineToolHeadAndShoulders)return _15;
            if (n instanceof D63)return _47
        }
        return null
    }

    function i(n) {
        return n instanceof TradingView.ESDStudyBase ? null : n instanceof TradingView.Study ? _39 : null
    }

    return{createInputsPropertyPage: function (t, i) {
        var r = n(t);
        return r ? new r(t.properties(), i, t) : null
    }, createStylesPropertyPage: function (n, i) {
        var r = t(n);
        return r ? new r(n.properties(), i, n) : null
    }, createDisplayPropertyPage: function (n, t) {
        var r = i(n);
        return r ? new r(n.properties(), t, n) : null
    }, hasInputsPropertyPage: function (t) {
        return!!n(t)
    }, hasStylesPropertyPage: function (n) {
        return!!t(n)
    }, hasDisplayPropertyPage: function (n) {
        return!!i(n)
    }}
}();
PropertyGroup.prototype.property = function () {
    return this._property
};
PropertyGroup.prototype.name = function () {
    return this._name
};
PropertyGroup.prototype.children = function () {
    return this._children
};
PropertyGroup.prototype.propertyPage = function () {
    return this._propertyPage
};
Q7.prototype.model = function () {
    return this.Q0
};
Q7.prototype.bindControl = function (n) {
    this._bindings.append(n)
};
Q7.prototype.loadData = function () {
    for (var t, n = 0; n < this._bindings.size(); n++)t = this._bindings.item(n), t.property && t.setValue(t.property().value())
};
Q7.prototype.saveData = function () {
    var n, t;
    for (this.Q0.beginUndoMacro(), n = 0; n < this._bindings.size(); n++)t = this._bindings.item(n), this.Q0.setProperty(t.property(), t.value());
    this.Q0.endUndoMacro()
};
Q7.prototype.createColorPicker = function () {
    return $(document.createElement("input")).addClass("colorpicker-widget").bind("customcolorchange", function (n, t) {
        TVSettings.setJSON("pickerCustomColors", t)
    }).tvcolorpicker({customColors: TVSettings.getJSON("pickerCustomColors", [])})
};
Q7.prototype.createTextEditor = function (n, t) {
    var i = {};
    return n && (i.width = n), t && (i.height = t), $(document.createElement("textarea")).css(i)
};
Q7.prototype.createCombo = function (n) {
    var t = $(document.createElement("select"));
    return n = n.reduce(function (n, t) {
        return n.add($(document.createElement("option")).prop({value: t, text: t}))
    }, $()), t.append(n)
};
Q7.prototype.createKeyCombo = function (n) {
    var t = $(document.createElement("select"));
    return $.each(n || [], function (n, i) {
        $(document.createElement("option")).prop({value: n, text: i}).appendTo(t)
    }), t
};
Q7.prototype.createFontEditor = function (n) {
    return n = n || factoryDefaults("chartproperties.editorFontsList"), this.createCombo(n)
};
Q7.prototype.createFontSizeEditor = function (n) {
    return this.createCombo(n || [10, 11, 12, 14, 16, 20, 24, 28, 32, 40]).addClass("tv-select-container-fontsize")
};
Q7.prototype.createSeriesMinTickEditor = function () {
    var t = "<select><option value='default'>" + $.t("Default") + "<\/option>", i = [
        {priceScale: 1, minMove: 1, frac: !1},
        {priceScale: 10, minMove: 1, frac: !1},
        {priceScale: 100, minMove: 1, frac: !1},
        {priceScale: 1e3, minMove: 1, frac: !1},
        {priceScale: 1e4, minMove: 1, frac: !1},
        {priceScale: 1e5, minMove: 1, frac: !1},
        {priceScale: 1e6, minMove: 1, frac: !1},
        {priceScale: 2, minMove: 1, frac: !0},
        {priceScale: 4, minMove: 1, frac: !0},
        {priceScale: 8, minMove: 1, frac: !0},
        {priceScale: 16, minMove: 1, frac: !0},
        {priceScale: 32, minMove: 1, frac: !0},
        {priceScale: 64, minMove: 1, frac: !0},
        {priceScale: 128, minMove: 1, frac: !0},
        {priceScale: 320, minMove: 1, frac: !0}
    ], r, n;
    for (r in i)n = i[r], t = t + ("<option value='" + (n.priceScale + "," + n.minMove + "," + n.frac) + "'>" + (n.minMove + "/" + n.priceScale) + "<\/option>");
    return $(t + "<\/select>")
};
Q7.prototype.createPrecisionEditor = function () {
    for (var t = "<select><option value='default'>" + $.t("Default") + "<\/option>", n = 0; 6 >= n; n++)t += "<option value='" + n + "'>" + n + "<\/option>";
    return $(t + "<\/select>")
};
Q7.prototype.createLabeledCell = function (n, t, i) {
    var u = null, r;
    return"number" == typeof n.valueOf() && (u = n, n = t, t = i), n += "", i = this._labelToId(n), r = $("<td>"), $("<label>").html(0 < n.length ? $.t(n) : "").attr("for", i).appendTo(r), u && r.attr("colspan", u), t && t.attr("id", i), r
};
Q7.prototype.createTableInTable = function (n) {
    return n = $("<tr>").appendTo(n), n = $("<td>").appendTo(n), $('<table cellpadding="0" cellspacing="0">').appendTo(n)
};
Q7.prototype._labelToId = function (n) {
    return"control" + n.replace(/(^| )\w/g, function (n) {
        return"-" + n.trim().toLowerCase()
    }) + Math.floor(1e3 * Math.random())
};
Q7.prototype.addRow = function (n) {
    return $(document.createElement("tr")).appendTo(n)
};
Q7.prototype.addLabeledRow = function (n, t, i, r) {
    var f = t && 0 < t.length ? $.t(t) : "", e = $(document.createElement("tr")), u = $(document.createElement("td")).html(f);
    return r && u.attr("colspan", 2), i && (t = this._labelToId(t), i.attr("id", t), u.html('<label for="' + t + '">' + f + "<\/label>")), e.append(u).appendTo(n)
};
Q7.prototype.addEditorRow = function (n, t, i, r) {
    var u = $(document.createElement("td"));
    return i.row = this.addLabeledRow(n, t, i, r), i.appendTo(u.appendTo(i.row)), i
};
Q7.prototype.addColorPickerRow = function (n, t) {
    return this.addEditorRow(n, t, this.createColorPicker())
};
Q7.prototype.addOffsetEditorRow = function (n, t) {
    var i = $("<input/>");
    return i.attr("type", "text"), i.css("width", "100px"), i.addClass("ticker"), this.addEditorRow(n, t, i)
};
Q7.prototype.addFontEditorRow = function (n, t) {
    return this.addEditorRow(n, t, this.createFontEditor())
};
Q7.prototype.refreshStateControls = function (n, t, i) {
    for (var u, f, r = 0; r < t.length; r++)u = t[r], f = n[u.id], f.toggle(this.parseRule(u.visible, t, i)), f.attr("disabled", !this.parseRule(u.visible, t, i))
};
Q7.prototype.parseRule = function (n, t, i) {
    return n ? (n = n.split("=="), 2 > n.length ? !1 : i[n[0]].value() == n[1]) : !0
};
Q7.prototype.destroy = function () {
    for (var n = this._bindings.size(); n--;)this._bindings.item(n).destroy();
    this._bindings.clear()
};
Binding.prototype._attachToControl = function (n, t) {
    var i = this;
    if (t)n.on("keyup change input", function (n) {
        n = i.value();
        i.setValueToProperty(n);
        i.setValue(n)
    }); else n.keypress(function (n) {
        13 == n.which && (n = i.value(), i.setValueToProperty(n), i.setValue(n))
    }), n.focusout(function (n) {
        n = i.value();
        i.setValueToProperty(n);
        i.setValue(n)
    }), n.change(function (n) {
        n = i.value();
        i.setValueToProperty(n);
        i.setValue(n)
    })
};
Binding.prototype.control = function () {
    return this._control
};
Binding.prototype.setValueToProperty = function (n) {
    this._undoModel.setProperty(this._property, n, this._undoText)
};
Binding.prototype.property = function () {
    return this._property
};
Binding.prototype.propertyChanged = function (n) {
    this.setValue(n.value())
};
Binding.prototype.destroy = function () {
    this._property && this._property.listeners().unsubscribe(this, Binding.prototype.propertyChanged)
};
inherit(SimpleStringBinder, Binding);
SimpleStringBinder.prototype.value = function () {
    var n = this._control.val(), t;
    if (this._transformFunction)if (isArray(this._transformFunction))for (t = 0; t < this._transformFunction.length; t++)n = this._transformFunction[t](n); else n = this._transformFunction(n);
    return n
};
SimpleStringBinder.prototype.setValue = function (n) {
    this._control.val() !== n && this._control.val(n)
};
inherit(Q8, Binding);
Q8.prototype._forEachSubControl = function (n) {
    this._subControlIds.forEach(function (t) {
        t = "#" + t;
        t = this.control().find(t);
        n.call(this, t)
    }, this)
};
Q8.prototype._parseSessions = function (n) {
    var t = n.split("-", 2);
    return 2 != t.length && (t = ["0", "0"]), n = parseInt(t[0]), t = parseInt(t[1]), [Math.floor(n / 100), n % 100, Math.floor(t / 100), t % 100]
};
Q8.prototype.value = function () {
    var n = [];
    this._forEachSubControl(function (t) {
        n.push(t.val())
    });
    var t = function (n, t) {
        return t.forEach(function (t) {
            n = t(n)
        }), ("0" + n).slice(-2)
    }, i = [ToIntTransformer(0), GreateTransformer(0), LessTransformer(23)], r = [ToIntTransformer(0), GreateTransformer(0), LessTransformer(59)];
    return t(n[0], i) + t(n[1], r) + "-" + t(n[2], i) + t(n[3], r)
};
Q8.prototype.setValue = function (n) {
    var t = this._parseSessions(n);
    this._forEachSubControl(function (n) {
        var r = n.val(), i = ("0" + t[0]).slice(-2);
        t.shift();
        r !== i && n.val(i)
    })
};
inherit(Q9, Binding);
Q9.prototype.value = function () {
    var n, t;
    return this._disabled ? (this._control.attr("disabled", !0), null) : (n = this._control.val(), n = this._toIntTransformer(n), 0 > n && (n = 0), t = this._mainSeries.bars().size(), t <= n && (n = t - 1), 1e3 * this._mainSeries.bars()._valueAt(this._mainSeries.bars().lastIndex() - n)[TIME_PLOT])
};
Q9.prototype.setValue = function (n) {
    this._disabled || null == n ? this._control.attr("disabled", !0) : 0 > n ? (this._control.val(-n), this._property.setValue(this.value())) : (n = this._mainSeries.data().timeToBarIndex(n / 1e3, SEARCH_FROM_RIGHT), null === n ? this._disabled = !0 : (n = this._mainSeries.bars().lastIndex() - n, this._control.val() !== n.toString() && this._control.val(n)))
};
inherit(Q10, Binding);
Q10.prototype.value = function () {
    return this._control.val()
};
Q10.prototype.setValue = function (n) {
    var t = this.value();
    n && t !== n && this._control.val(n)
};
inherit(Q11, Binding);
Q11.prototype.value = function () {
    var n = this._control.val();
    return this._transformFunction && (n = this._transformFunction(n)), n
};
Q11.prototype.setValue = function (n) {
    var t, i;
    if (this._control.val(n), this._control.selectbox)try {
        t = this._control.find("[value='" + n + "']");
        0 < t.length && (i = t[0], this._control.selectbox("change", i.value, i.text))
    } catch (r) {
    }
};
inherit(StaticContentBinder, Binding);
StaticContentBinder.prototype.value = function () {
    return this._property.value()
};
StaticContentBinder.prototype.setValue = function (n) {
    return this._control.html(n)
};
inherit(Q12, Binding);
Q12.prototype.value = function () {
    return this.control().is(":checked")
};
Q12.prototype.setValue = function (n) {
    var i;
    if (this.control().is(".visibility-switch")) {
        var r = {opacity: n ? 1 : .5}, t = n ? "enable" : "disable", u = this.control().data("hides");
        u ? u.closest("td").css(r) : (i = this.control(), i.parent().parent().data("visible", n).find("td").filter(function () {
            var n = $(this);
            return!n.find("label").length && n.find(":checkbox").attr("id") !== i.attr("id")
        }).each(function () {
            var i = $(this);
            i.children().each(function () {
                var u = $(this);
                u.is(".ui-slider") ? u.slider(t) : (u.is("select") ? u.selectbox(t) : u.is(".custom-select") ? u.data(t)() : u.prop("disabled", !n), i.css(r))
            })
        }))
    }
    return this.control().attr("checked", !!n)
};
inherit(DisabledBinder, Binding);
DisabledBinder.prototype.value = function () {
    return this.control().is(":disabled")
};
DisabledBinder.prototype.setValue = function (n) {
    return this.control().attr("disabled", !!n)
};
Q12.PushButtonBinder = function (n, t, i, r, u) {
    Binding.call(this, n, t, i, r, u);
    var f = this;
    i && n.click(function () {
        var n = $(this).toggleClass("active").hasClass("active");
        f.setValueToProperty(n)
    })
};
inherit(Q12.PushButtonBinder, Binding);
Q12.PushButtonBinder.prototype.value = function () {
    return this.control().hasClass("active")
};
Q12.PushButtonBinder.prototype.setValue = function (n) {
    return this.control().toggleClass("active", !!n)
};
inherit(Q14, Binding);
Q14.prototype.onActionCallback = function () {
    this._undoModel.setProperty(this._property, this.value(), this._undoText)
};
Q14.prototype.value = function () {
    return this.control().checked
};
Q14.prototype.setValue = function (n) {
    return this.control().checked = !!n
};
inherit(ColorBinding, Binding);
ColorBinding.prototype.value = function () {
    return this._control.val()
};
ColorBinding.prototype.setValue = function (n) {
    this._control.val(n);
    this._control.change();
    this._control.color && this._control.color.fromString(n)
};
TradingView.ToggleButtonBinding = function (n, t) {
    t.toggle(n.checked);
    t.content().click(function () {
        n.setChecked(t.toggled());
        n.callbacks().fire(n)
    })
};
inherit(SliderBinder, Binding);
SliderBinder.prototype.value = function () {
    return this._control.slider("option", "value")
};
SliderBinder.prototype.setValue = function (n) {
    this._control.slider("option", "value", n)
};
inherit(Q15, Q12);
Q15.prototype.onIntervalChanged = function () {
    1440 > +this._intervalProperty.value() ? this._control.attr({disabled: !1, checked: !!this._property.value()}) : this._control.attr({disabled: !0, checked: !1})
};
Q15.prototype.value = function () {
    return this._control.is(":disabled") ? this._property.value() : Q12.prototype.value.call(this)
};
Q15.prototype.setValue = function (n) {
    if (!this._control.is(":disabled"))return Q12.prototype.setValue.call(this, n)
};
Q15.prototype.destroy = function () {
    this._intervalProperty.listeners().unsubscribe(this, this.onIntervalChanged);
    delete this._intervalProperty;
    Q12.prototype.destroy.call(this, arguments)
};
WVBinding.prototype._attachToControl = function () {
    var n = this;
    this._wv.subscribe(this.setValue.bind(this), {callWithLast: !0});
    $(this._control).on("change", function () {
        n.setValueToProperty(n.value())
    })
};
WVBinding.prototype.control = function () {
    return this._control
};
WVBinding.prototype.value = function () {
    var n = $(this._control).val();
    return this._transformFunction && (n = this._transformFunction(n)), n
};
WVBinding.prototype.setValue = function (n) {
    $(this._control).val(n)
};
WVBinding.prototype.setValueToProperty = function (n) {
    D77.setWatchedValue(this._wv, n, this._undoText)
};
WVBinding.prototype.watchedValue = function () {
    return this._wv
};
WVBinding.prototype.destroy = function () {
    this._wv.destroy()
};
inherit(CheckboxWVBinding, WVBinding);
CheckboxWVBinding.prototype._attachToControl = function () {
    var n = this;
    this._wv.subscribe(this.setValue.bind(this), {callWithLast: !0});
    $(this._control).on("click", function () {
        n.setValueToProperty(n.value())
    })
};
CheckboxWVBinding.prototype.value = function () {
    var n = $(this._control).attr("checked");
    return this._not && (n = !n), this._transformFunction && (n = this._transformFunction(n)), n
};
CheckboxWVBinding.prototype.setValue = function (n) {
    this._not && (n = !n);
    $(this._control).attr("checked", !!n)
};
inherit(SeriesStylePropertyPageMixin, Q7);
SeriesStylePropertyPageMixin.prototype.getInputTitle = function (n, t) {
    return t.inputInfo ? t.inputInfo[n].name.value() : n.toLowerCase().replace(/\b\w/g, function (n) {
        return n.toUpperCase()
    })
};
SeriesStylePropertyPageMixin.prototype.prepareLayoutImpl = function (n, t, i, r) {
    var e, f, c, v;
    r = r || {};
    for (var l = {}, y = this, a = 0; a < n.inputs.length; a++) {
        var u = n.inputs[a], s = u.id, o = this.getInputTitle(s, i), h = $("<tr/>");
        if (h.appendTo(t), f = $("<td/>"), f.appendTo(h), f.addClass("propertypage-name-label"), f.text(o), e = $("<td" + (r.valueColspan ? ' colspan = "' + r.valueColspan + '"' : "") + "/>"), e.appendTo(h), f = null, u.options)for (f = $("<select/>"), c = 0; c < u.options.length; c++)v = u.options[c], $("<option value='" + v + "'>" + v + "<\/option>").appendTo(f); else f = $("<input/>"), "bool" === u.type ? f.attr("type", "checkbox") : f.attr("type", "text");
        f.appendTo(e);
        f.css("width", "100px");
        o = "Change " + o;
        u.options ? this.bindControl(new Q11(f, i.inputs[s], null, !0, this.model(), o)) : "integer" === u.type ? (transformers = [ToIntTransformer(u.defval)], u.min && transformers.push(GreateTransformer(u.min)), u.max && transformers.push(LessTransformer(u.max)), this.bindControl(new SimpleStringBinder(f, i.inputs[s], transformers, !1, this.model(), o)), f.addClass("ticker")) : "float" === u.type ? (transformers = [ToFloatTransformer(u.defval)], u.min && (e = void 0, (("BarSetRenko@tv-prostudies" == n.id || "BarSetPnF@tv-prostudies" == n.id) && "boxSize" == u.id || "BarSetKagi@tv-prostudies" == n.id && "reversalAmount" == u.id) && (e = this.Q0.model().mainSeries().symbolInfo(), e = e.minmov / e.pricescale), transformers.push(GreateTransformer(e ? e : u.min))), u.max && transformers.push(LessTransformer(u.max)), this.bindControl(new SimpleStringBinder(f, i.inputs[s], transformers, !1, this.model(), o)), f.addClass("ticker")) : "text" === u.type && this.bindControl(new SimpleStringBinder(f, this._property.inputs[s], null, !1, this.model(), o));
        f.change(function () {
            y.refreshStateControls(l, n.inputs, i.inputs)
        });
        l[u.id] = h
    }
    this.refreshStateControls(l, n.inputs, i.inputs)
};
SeriesStylePropertyPageMixin.prototype.getMetaInfo = function (n) {
    for (var i = this.Q0.m_model._studiesMetaData, t = 0; t < i.size(); t++)if (i.item(t).id === n)return i.item(t);
    return null
};
SeriesStylePropertyPageMixin.prototype._prepareSeriesStyleLayout = function (n, t, i, r) {
    var f = $("<tbody>").appendTo(n), u = this._candlesColorerTbody = $("<tbody>").appendTo(t), h = this._barsColorerTbody = $("<tbody>").appendTo(t), a = this._haColorerTbody = $("<tbody>").appendTo(t), s = this._candlesTbody = $("<tbody>").appendTo(i), e = this._hollowCandlesTbody = $("<tbody>").appendTo(i), y = this._haTbody = $("<tbody>").appendTo(i), o = this._barsTbody = $("<tbody>").appendTo(i), l = this._lineTbody = $("<tbody>").appendTo(i), c, v, p;
    t = this._areaTbody = $("<tbody>").appendTo(i);
    c = this._renkoTbody = $("<tbody>").appendTo(i);
    v = this._pbTbody = $("<tbody>").appendTo(i);
    n = this._kagiTbody = $("<tbody>").appendTo(i);
    i = this._pnfTbody = $("<tbody>").appendTo(i);
    f = this.addLabeledRow(f, "Style");
    p = $(document.createElement("td")).appendTo(f);
    p.addClass("property-wide-select");
    f = $(document.createElement("select"));
    $("<option value=" + TradingView.Series.STYLE_BARS + ">" + $.t("Bars") + "<\/option>").appendTo(f);
    $("<option value=" + TradingView.Series.STYLE_CANDLES + ">" + $.t("Candles") + "<\/option>").appendTo(f);
    $("<option value=" + TradingView.Series.STYLE_HOLLOW_CANDLES + ">" + $.t("Hollow Candles") + "<\/option>").appendTo(f);
    this instanceof _44 || $("<option value=" + TradingView.Series.STYLE_HEIKEN_ASHI + ">" + $.t("Heiken Ashi") + "<\/option>").appendTo(f);
    $("<option value=" + TradingView.Series.STYLE_LINE + ">" + $.t("Line") + "<\/option>").appendTo(f);
    $("<option value=" + TradingView.Series.STYLE_AREA + ">" + $.t("Area") + "<\/option>").appendTo(f);
    f.css("width", "100px").appendTo(p);
    this.switchStyle();
    this.bindControl(new Q11(f, r.style, parseInt, !0, this.model(), "Change Series Style", function (n) {
        this._undoModel.setChartStyleProperty(this._property, n, this._undoText)
    }));
    r.style.listeners().subscribe(this, this.switchStyle);
    var p = this.createColorPicker(), b = this.createColorPicker(), w = this.createColorPicker(), k = this.createColorPicker(), d = this.createColorPicker(), g = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(k).add(d)), nt = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(w)), tt = $("<input type='checkbox'/>"), u = this.addLabeledRow(u, "Color bars based on previous close", tt);
    $("<td>").append(tt).prependTo(u);
    u = this.addLabeledRow(s, "Candles");
    $("<td>").prependTo(u);
    $("<td>").append(p).appendTo(u);
    $("<td>").append(b).appendTo(u);
    u = this.addLabeledRow(s, "Borders", g);
    $("<td>").append(g).prependTo(u);
    $("<td>").append(k).appendTo(u);
    $("<td>").append(d).appendTo(u);
    u = this.addLabeledRow(s, "Wick", nt);
    $("<td>").append(nt).prependTo(u);
    $("<td>").append(w).appendTo(u);
    this.bindControl(new ColorBinding(p, r.candleStyle.upColor, !0, this.model(), "Change Candle Up Color"));
    this.bindControl(new ColorBinding(b, r.candleStyle.downColor, !0, this.model(), "Change Candle Down Color"));
    this.bindControl(new Q12(nt, r.candleStyle.drawWick, !0, this.model(), "Change Candle Wick Visibility"));
    this.bindControl(new ColorBinding(w, r.candleStyle.wickColor, !0, this.model(), "Change Candle Wick Color"));
    this.bindControl(new Q12(g, r.candleStyle.drawBorder, !0, this.model(), "Change Candle Border Visibility"));
    this.bindControl(new ColorBinding(k, r.candleStyle.borderUpColor, !0, this.model(), "Change Candle Up Border Color"));
    this.bindControl(new ColorBinding(d, r.candleStyle.borderDownColor, !0, this.model(), "Change Candle Down Border Color"));
    this.bindControl(new Q12(tt, r.candleStyle.barColorsOnPrevClose, !0, this.model(), "Change Color Bars Based On Previous Close"));
    s = this.createColorPicker();
    p = this.createColorPicker();
    b = this.createColorPicker();
    w = this.createColorPicker();
    k = this.createColorPicker();
    d = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(w).add(k));
    g = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(b));
    u = this.addLabeledRow(e, "Candles");
    $("<td>").prependTo(u);
    $("<td>").append(s).appendTo(u);
    $("<td>").append(p).appendTo(u);
    u = this.addLabeledRow(e, "Borders", d);
    $("<td>").append(d).prependTo(u);
    $("<td>").append(w).appendTo(u);
    $("<td>").append(k).appendTo(u);
    u = this.addLabeledRow(e, "Wick", g);
    $("<td>").append(g).prependTo(u);
    $("<td>").append(b).appendTo(u);
    this.bindControl(new ColorBinding(s, r.hollowCandleStyle.upColor, !0, this.model(), "Change Hollow Candle Up Color"));
    this.bindControl(new ColorBinding(p, r.hollowCandleStyle.downColor, !0, this.model(), "Change Hollow Candle Down Color"));
    this.bindControl(new Q12(g, r.hollowCandleStyle.drawWick, !0, this.model(), "Change Hollow Candle Wick Visibility"));
    this.bindControl(new ColorBinding(b, r.hollowCandleStyle.wickColor, !0, this.model(), "Change Hollow Candle Wick Color"));
    this.bindControl(new Q12(d, r.hollowCandleStyle.drawBorder, !0, this.model(), "Change Hollow Candle Border Visibility"));
    this.bindControl(new ColorBinding(w, r.hollowCandleStyle.borderUpColor, !0, this.model(), "Change Hollow Candle Up Border Color"));
    this.bindControl(new ColorBinding(k, r.hollowCandleStyle.borderDownColor, !0, this.model(), "Change Hollow Candle Down Border Color"));
    e = $("<input type='checkbox'/>");
    u = this.addLabeledRow(h, "Color bars based on previous close", e);
    $("<td>").append(e).prependTo(u);
    s = $("<input type='checkbox'/>");
    u = this.addLabeledRow(h, "HLC Bars", s);
    $("<td>").append(s).prependTo(u);
    u = this.addColorPickerRow(o, "Up Color");
    h = this.addColorPickerRow(o, "Down Color");
    this.bindControl(new ColorBinding(u, r.barStyle.upColor, !0, this.model(), "Change Bar Up Color"));
    this.bindControl(new ColorBinding(h, r.barStyle.downColor, !0, this.model(), "Change Bar Down Color"));
    this.bindControl(new Q12(e, r.barStyle.barColorsOnPrevClose, !0, this.model(), "Change Color Bars Based On Previous Close"));
    this.bindControl(new Q12(s, r.barStyle.dontDrawOpen, !0, this.model(), "Change HLC Bars"));
    h = TradingView.createPriceSourceEditor();
    u = this.addLabeledRow(l, "Price Source");
    $('<td colspan="3">').append(h).appendTo(u);
    u = this.addLabeledRow(l, "Type");
    u = $('<td colspan="3">').appendTo(u);
    u.addClass("property-wide-select");
    o = $(document.createElement("select"));
    $("<option value=" + TradingView.Series.STYLE_LINE_TYPE_SIMPLE + ">" + $.t("Simple") + "<\/option>").appendTo(o);
    $("<option value=" + TradingView.Series.STYLE_LINE_TYPE_MARKERS + ">" + $.t("With Markers") + "<\/option>").appendTo(o);
    $("<option value=" + TradingView.Series.STYLE_LINE_TYPE_STEP + ">" + $.t("Step") + "<\/option>").appendTo(o);
    o.appendTo(u);
    u = this.addLabeledRow(l, "Line");
    l = this.createColorPicker();
    e = TradingView.createLineWidthEditor();
    $("<td>").append(l).appendTo(u);
    $("<td>").append(e).appendTo(u);
    this.bindControl(new Q11(h, r.lineStyle.priceSource, null, !0, this.model(), "Change Price Source"));
    this.bindControl(new Q11(o, r.lineStyle.styleType, parseInt, !0, this.model(), "Change Line Type"));
    this.bindControl(new ColorBinding(l, r.lineStyle.color, !0, this.model(), "Change Line Color"));
    this.bindControl(new SliderBinder(e, r.lineStyle.linewidth, !0, this.model(), "Change Line Width"));
    r.haStyle && (l = this.createColorPicker(), h = this.createColorPicker(), o = this.createColorPicker(), e = this.createColorPicker(), s = this.createColorPicker(), p = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(e).add(s)), b = $("<input type='checkbox' class='visibility-switch'/>").data("hides", $(o)), w = $("<input type='checkbox'/>"), u = this.addLabeledRow(a, "Color bars based on previous close", w), $("<td>").append(w).prependTo(u), u = this.addLabeledRow(y, "Candles"), $("<td>").prependTo(u), $("<td>").append(l).appendTo(u), $("<td>").append(h).appendTo(u), u = this.addLabeledRow(y, "Borders", p), $("<td>").append(p).prependTo(u), $("<td>").append(e).appendTo(u), $("<td>").append(s).appendTo(u), u = this.addLabeledRow(y, "Wick", b), $("<td>").append(b).prependTo(u), $("<td>").append(o).appendTo(u), this.bindControl(new ColorBinding(l, r.haStyle.upColor, !0, this.model(), "Change Heiken Ashi Up Color")), this.bindControl(new ColorBinding(h, r.haStyle.downColor, !0, this.model(), "Change Heiken Ashi Down Color")), this.bindControl(new Q12(b, r.haStyle.drawWick, !0, this.model(), "Change Heiken Ashi Wick Visibility")), this.bindControl(new ColorBinding(o, r.haStyle.wickColor, !0, this.model(), "Change Heiken Ashi Wick Color")), this.bindControl(new Q12(p, r.haStyle.drawBorder, !0, this.model(), "Change Heiken Ashi Border Visibility")), this.bindControl(new ColorBinding(e, r.haStyle.borderUpColor, !0, this.model(), "Change Heiken Ashi Up Border Color")), this.bindControl(new ColorBinding(s, r.haStyle.borderDownColor, !0, this.model(), "Change Heiken Ashi Down Border Color")), this.bindControl(new Q12(w, r.haStyle.barColorsOnPrevClose, !0, this.model(), "Change Color Bars Based On Previous Close")));
    this instanceof _44 || J77.enabled("charting_library") || ($("<option value=" + TradingView.Series.STYLE_RENKO + ">Renko<\/option>").appendTo(f), $("<option value=" + TradingView.Series.STYLE_PB + ">Line break<\/option>").appendTo(f), $("<option value=" + TradingView.Series.STYLE_KAGI + ">Kagi<\/option>").appendTo(f), $("<option value=" + TradingView.Series.STYLE_PNF + ">Point & Figure<\/option>").appendTo(f), a = this.createColorPicker(), y = this.createColorPicker(), u = this.addLabeledRow(c, "Up bars"), $('<td class="some-colorpicker">').append(a).append(y).appendTo(u), f = this.createColorPicker(), l = this.createColorPicker(), u = this.addLabeledRow(c, "Down bars"), $('<td class="some-colorpicker">').append(f).append(l).appendTo(u), h = this.createColorPicker(), o = this.createColorPicker(), u = this.addLabeledRow(c, "Projection up bars"), $('<td class="some-colorpicker">').append(h).append(o).appendTo(u), e = this.createColorPicker(), s = this.createColorPicker(), u = this.addLabeledRow(c, "Projection down bars"), $('<td class="some-colorpicker">').append(e).append(s).appendTo(u), this.prepareLayoutImpl(this.getMetaInfo("BarSetRenko@tv-prostudies"), c, r.renkoStyle), this.bindControl(new ColorBinding(a, r.renkoStyle.upColor, !0, this.model(), "Change Bar Up Color")), this.bindControl(new ColorBinding(f, r.renkoStyle.downColor, !0, this.model(), "Change Bar Down Color")), this.bindControl(new ColorBinding(h, r.renkoStyle.upColorProjection, !0, this.model(), "Change Projection Bar Up Color")), this.bindControl(new ColorBinding(e, r.renkoStyle.downColorProjection, !0, this.model(), "Change Projection Bar Down Color")), this.bindControl(new ColorBinding(y, r.renkoStyle.borderUpColor, !0, this.model(), "Change Border Bar Up Color")), this.bindControl(new ColorBinding(l, r.renkoStyle.borderDownColor, !0, this.model(), "Change Border Bar Down Color")), this.bindControl(new ColorBinding(o, r.renkoStyle.borderUpColorProjection, !0, this.model(), "Change Projection Border Bar Up Color")), this.bindControl(new ColorBinding(s, r.renkoStyle.borderDownColorProjection, !0, this.model(), "Change Projection Border Bar Down Color")), c = this.createColorPicker(), a = this.createColorPicker(), u = this.addLabeledRow(v, "Up bars"), $('<td class="some-colorpicker">').append(c).append(a).appendTo(u), y = this.createColorPicker(), f = this.createColorPicker(), u = this.addLabeledRow(v, "Down bars"), $('<td class="some-colorpicker">').append(y).append(f).appendTo(u), l = this.createColorPicker(), h = this.createColorPicker(), u = this.addLabeledRow(v, "Projection up bars"), $('<td class="some-colorpicker">').append(l).append(h).appendTo(u), o = this.createColorPicker(), e = this.createColorPicker(), u = this.addLabeledRow(v, "Projection down bars"), $('<td class="some-colorpicker">').append(o).append(e).appendTo(u), this.prepareLayoutImpl(this.getMetaInfo("BarSetPriceBreak@tv-prostudies"), v, r.pbStyle, {valueColspan: 2}), this.bindControl(new ColorBinding(c, r.pbStyle.upColor, !0, this.model(), "Change Bar Up Color")), this.bindControl(new ColorBinding(y, r.pbStyle.downColor, !0, this.model(), "Change Bar Down Color")), this.bindControl(new ColorBinding(l, r.pbStyle.upColorProjection, !0, this.model(), "Change Projection Bar Up Color")), this.bindControl(new ColorBinding(o, r.pbStyle.downColorProjection, !0, this.model(), "Change Projection Bar Down Color")), this.bindControl(new ColorBinding(a, r.pbStyle.borderUpColor, !0, this.model(), "Change Border Bar Up Color")), this.bindControl(new ColorBinding(f, r.pbStyle.borderDownColor, !0, this.model(), "Change Border Bar Down Color")), this.bindControl(new ColorBinding(h, r.pbStyle.borderUpColorProjection, !0, this.model(), "Change Projection Border Bar Up Color")), this.bindControl(new ColorBinding(e, r.pbStyle.borderDownColorProjection, !0, this.model(), "Change Projection Border Bar Down Color")), v = this.addColorPickerRow(n, "Up bars"), u = this.addColorPickerRow(n, "Down bars"), c = this.addColorPickerRow(n, "Projection up bars"), a = this.addColorPickerRow(n, "Projection down bars"), this.prepareLayoutImpl(this.getMetaInfo("BarSetKagi@tv-prostudies"), n, r.kagiStyle), this.bindControl(new ColorBinding(v, r.kagiStyle.upColor, !0, this.model(), "Change Bar Up Color")), this.bindControl(new ColorBinding(u, r.kagiStyle.downColor, !0, this.model(), "Change Bar Down Color")), this.bindControl(new ColorBinding(c, r.kagiStyle.upColorProjection, !0, this.model(), "Change Projection Bar Up Color")), this.bindControl(new ColorBinding(a, r.kagiStyle.downColorProjection, !0, this.model(), "Change Projection Bar Down Color")), n = this.addColorPickerRow(i, "Up bars"), v = this.addColorPickerRow(i, "Down bars"), u = this.addColorPickerRow(i, "Projection up bars"), c = this.addColorPickerRow(i, "Projection down bars"), this.prepareLayoutImpl(this.getMetaInfo("BarSetPnF@tv-prostudies"), i, r.pnfStyle), this.bindControl(new ColorBinding(n, r.pnfStyle.upColor, !0, this.model(), "Change Bar Up Color")), this.bindControl(new ColorBinding(v, r.pnfStyle.downColor, !0, this.model(), "Change Bar Down Color")), this.bindControl(new ColorBinding(u, r.pnfStyle.upColorProjection, !0, this.model(), "Change Projection Bar Up Color")), this.bindControl(new ColorBinding(c, r.pnfStyle.downColorProjection, !0, this.model(), "Change Projection Bar Down Color")));
    i = TradingView.createPriceSourceEditor();
    u = this.addLabeledRow(t, "Price Source");
    $('<td colspan="3">').appendTo(u).append(i);
    n = this.createColorPicker();
    v = TradingView.createLineWidthEditor();
    u = this.addLabeledRow(t, "Line");
    $("<td>").appendTo(u).append(n);
    $('<td colspan="2">').appendTo(u).append(v);
    c = this.createColorPicker();
    a = this.createColorPicker();
    y = TradingView.createTransparencyEditor(a);
    u = this.addLabeledRow(t, "Fill");
    $("<td>").appendTo(u).append(c);
    $("<td>").appendTo(u).append(a);
    $("<td>").appendTo(u).append(y);
    this.bindControl(new Q11(i, r.areaStyle.priceSource, null, !0, this.model(), "Change Price Source"));
    this.bindControl(new ColorBinding(n, r.areaStyle.linecolor, !0, this.model(), "Change Line Color"));
    this.bindControl(new SliderBinder(v, r.areaStyle.linewidth, !0, this.model(), "Change Line Width"));
    this.bindControl(new ColorBinding(c, r.areaStyle.color1, !0, this.model(), "Change Line Color"));
    this.bindControl(new ColorBinding(a, r.areaStyle.color2, !0, this.model(), "Change Line Color"));
    this.bindControl(new SliderBinder(y, r.areaStyle.transparency, !0, this.model(), "Change Area Transparency"))
};
TradingView.LinetoolTemplatesList = function (n, t, i) {
    this._toolName = n;
    this._applyTemplate = t;
    this._options = $.extend({saveAsText: "Save As...", applyDefaultText: "Apply Defaults"}, i || {});
    this._list = [];
    J77.enabled("charting_library") || (this.templatesDeferred = this.loadData())
};
TradingView.LinetoolTemplatesList._cache = {};
TradingView.LinetoolTemplatesList.prototype.getData = function () {
    return this._list
};
TradingView.LinetoolTemplatesList.prototype.loadData = function () {
    var n = this;
    return this._toolName in TradingView.LinetoolTemplatesList._cache ? (this._list = TradingView.LinetoolTemplatesList._cache[this._toolName], $.Deferred().resolve()) : $.get("/drawing-templates/" + this._toolName + "/", function (t) {
        n._list = t;
        TradingView.LinetoolTemplatesList._cache[n._toolName] = t
    }).error(function (n) {
        console.warn("Failed to load drawing template: " + n.responseText)
    })
};
TradingView.LinetoolTemplatesList.prototype.templatesLoaded = function () {
    return this.templatesDeferred
};
TradingView.LinetoolTemplatesList.prototype.invalidateToolCache = function () {
    delete TradingView.LinetoolTemplatesList._cache[this._toolName]
};
TradingView.LinetoolTemplatesList.prototype.createButton = function (n) {
    var t = this, i;
    return n = $.extend({}, n, t._options), i = $("<a><\/span><\/a>").addClass(n.buttonClass ? n.buttonClass : "tv-button").html(n.buttonInner ? n.buttonInner : 'Template<span class="icon-dropdown">'), TradingView.bindPopupMenu(i, null, {event: "button-popup"}), i.bind("click", function (i) {
        if (i.stopPropagation(), !$(this).is("active")) {
            i = [];
            "function" == typeof n.getDataForSaveAs && i.push({title: n.saveAsText, action: function () {
                runOrSignIn(function () {
                    var i = function (i) {
                        var r = JSON.stringify(n.getDataForSaveAs());
                        t.saveTemplate(i, r)
                    }.bind(t);
                    TradingView.showChartNameDialog(i, "Save template as...", "Template name", 64)
                })
            }, addClass: "special"});
            "function" == typeof n.defaultsCallback && i.push({title: n.applyDefaultText, action: n.defaultsCallback, addClass: "special"});
            var r = [];
            $.each(t._list, function (n, i) {
                r.push({title: i, action: function () {
                    t.loadTemplate.call(t, i)
                }, deleteAction: function () {
                    runOrSignIn(function () {
                        D83.showConfirm("Template", "Do you realy want to delete " + (i ? '"' + i + '"' : "") + " template?", function () {
                            t.removeTemplate.call(t, i)
                        })
                    })
                }})
            });
            r.length && (r.sort(function (n, t) {
                return n = n.title.toUpperCase(), t = t.title.toUpperCase(), n == t ? 0 : n > t ? 1 : -1
            }), i.push({separator: !0}), i = i.concat(r));
            $(this).trigger("button-popup", [i])
        }
    }), i
};
TradingView.LinetoolTemplatesList.prototype.loadTemplate = function (n) {
    var t = this;
    return $.get("/drawing-template/" + this._toolName + "/?templateName=" + encodeURIComponent(n), function (n) {
        t._applyTemplate(JSON.parse(n.content))
    }).error(function (n) {
        console.warn(n.responseText)
    })
};
TradingView.LinetoolTemplatesList.prototype.removeTemplate = function (n) {
    n && ($.post("/remove-drawing-template/", {name: n, tool: this._toolName}).error(function (n) {
        console.warn(n.responseText)
    }), this.invalidateToolCache(), this._list = $.grep(this._list, function (t) {
        return t != n
    }))
};
TradingView.LinetoolTemplatesList.prototype.saveTemplate = function (n, t) {
    var i = this, r, u;
    n && t && (n = clean(n), r = -1 != $.inArray(n, i._list), u = function () {
        $.post("/save-drawing-template/", {name: n, tool: i._toolName, content: t}, function () {
            r || i._list.push(n)
        }).error(function (n) {
            console.warn(n.responseText)
        });
        i.invalidateToolCache()
    }, r ? D83.showConfirm("Confirm replacing", 'Do you realy want to replace "' + n + '"?', u) : u())
};
TradingView.LinetoolTemplatesList.prototype.deleteAction = function (n) {
    var t = this;
    runOrSignIn(function () {
        D83.showConfirm("Template", "Do you realy want to delete " + (n ? '"' + n + '"' : "") + " template?", function () {
            t.removeTemplate.call(t, n)
        })
    })
};
TradingView.LinetoolTemplatesList.prototype.showSaveDialog = function (n) {
    var t = this;
    runOrSignIn(function () {
        TradingView.showChartNameDialog(function (i) {
            var r = JSON.stringify(n.template());
            t.saveTemplate(i, r)
        }, "Save template as...", "Template name", 64)
    })
};
inherit(_49, Q7);
_49.prototype.applyTemplate = function (n) {
    this._linetool.restoreTemplate(n);
    this.Q0.model().updateSource(this._linetool);
    this.loadData()
};
_49.prototype.createTemplateButton = function (n) {
    var t = this;
    return n = $.extend({}, n, {getDataForSaveAs: function () {
        return t._linetool.template()
    }.bind(t)}), this._templateList.createButton(n)
};
_49.prototype.appendTemplateRow = function (n) {
    var t, i;
    is_authenticated && (t = $(document.createElement("tr")), t.appendTo(n), i = $(document.createElement("td")), i.attr("colspan", 2), i.appendTo(t), t = $('<div class="dialog-theme-buttons"><\/div>').appendTo(i), this.templateButton = $(this.createTemplateButton()), this.templateButton.appendTo(t), $('<tr><td class="property-page-separator-cell" colspan="6"><div class="property-page-separator"><\/div><\/td><\/tr>').appendTo(n))
};
"undefined" != typeof FlashCanvas && FlashCanvas.setOptions({disableContextMenu: !0});
TradingView.setCanvasSize = function (n, t) {
    n.width = t.w;
    n.height = t.h;
    "undefined" == typeof FlashCanvas && n.getContext("2d").translate(.5, .5)
};
TradingView.addCanvasTo = function (n, t) {
    var i = document.createElement("canvas");
    return n.append(i), "undefined" != typeof FlashCanvas && FlashCanvas.initElement(i), TradingView.setCanvasSize(i, t), i
};
TradingView.Rect = function (n, t, i, r) {
    this.x = n;
    this.y = t;
    this.w = i;
    this.h = r
};
D61 = function (n, t) {
    this.w = n;
    this.h = t
};
D61.prototype.equals = function (n) {
    return this.w === n.w && this.h === n.h
};
TradingView.Point = function (n, t) {
    this.x = n;
    this.y = t
};
TradingView.setAbsoluteRect = function (n, t) {
    n.css("position", "absolute");
    n.css("left", t.x + "px");
    n.css("top", t.y + "px");
    n.width(t.w);
    n.height(t.h)
};
TradingView.setAbsolutePos = function (n, t) {
    n.css("position", "absolute");
    n.css("left", t.x + "px");
    n.css("top", t.y + "px")
};
TradingView.addLocalCoordsToMouseEvent = function (n, t) {
    var i = n.offset();
    t.localX = t.pageX - i.left;
    t.localY = t.pageY - i.top
};
TradingView.processEvent = function (n, t, i, r) {
    r && (TradingView.addLocalCoordsToMouseEvent(t, n), r.call(i, n, t))
};
TradingView.MOUSE_RIGHT_BUTTON = 2;
TradingView.setMouseEventHandler = function (n, t, i) {
    var v = function (r) {
        n.off("mousemove.chartgui");
        var u = function (r) {
            (!TradingView.mousePressed || Modernizr.touch) && (TradingView.processEvent(r, n, t, t.mouseMoveEvent), i && r.preventDefault())
        };
        n.on("mousemove.chartgui", u);
        Modernizr.touch && u(r);
        TradingView.processEvent(r, n, t, t.mouseEnterEvent);
        i && r.preventDefault()
    }, h, a;
    n.mouseenter(v);
    var o = 0, r = null, y = function () {
        window.clearTimeout(r);
        o = 0;
        r = null
    }, c = 0, l = 0, u = null, f = function (f) {
        void 0 === f.button && (f.button = 0);
        (Modernizr.touch || f.originalEvent.touches) && (f.pageX = f.originalEvent.touches[0].pageX, f.pageY = f.originalEvent.touches[0].pageY, f.localX = f.originalEvent.touches[0].pageX, f.localY = f.originalEvent.touches[0].pageY, v(f));
        var e = function (r) {
            void 0 === r.button && (r.button = 0);
            (Modernizr.touch || r.originalEvent.touches) && (r.pageX = r.originalEvent.touches[0].pageX, r.pageY = r.originalEvent.touches[0].pageY, r.localX = r.originalEvent.touches[0].pageX, r.localY = r.originalEvent.touches[0].pageY, r.clientX = r.originalEvent.touches[0].pageX, r.clientY = r.originalEvent.touches[0].pageY, c = r.pageX, l = r.pageY, clearTimeout(u));
            r.button !== TradingView.MOUSE_RIGHT_BUTTON && TradingView.processEvent(r, n, t, t.pressedMouseMoveEvent);
            i && r.preventDefault()
        }, s = function (f) {
            void 0 === f.button && (f.button = 0);
            (Modernizr.touch || f.originalEvent.touches) && (f.pageX = c, f.pageY = l, f.localX = c, f.localY = l, clearTimeout(u));
            TradingView.mousePressed = !1;
            $(document.body).off("mousemove.chartgui");
            $(document.body).off("mouseup.chartgui");
            Modernizr.touch || f.originalEvent.touches ? ($(document.body).off("touchmove.chartgui"), $(document.body).off("touchend.chartgui"), h(f)) : ($(document.body).off("mousemove.chartgui touchmove.chartgui"), $(document.body).off("mouseup.chartgui touchend.chartgui"));
            f.button !== TradingView.MOUSE_RIGHT_BUTTON && (TradingView.processEvent(f, n, t, t.mouseUpEvent), ++o, r && 1 < o ? (TradingView.processEvent(f, n, t, t.mouseDoubleClickEvent), y()) : TradingView.processEvent(f, n, t, t.mouseClickEvent));
            i && f.preventDefault();
            Modernizr.touch && h(f)
        };
        if (Modernizr.touch ? ($(document.body).off("touchmove.chartgui"), $(document.body).off("touchend.chartgui"), $(document.body).on("touchmove.chartgui", e), $(document.body).on("touchend.chartgui", s), u = setTimeout(function () {
            a(f)
        }, 500)) : ($(document.body).off("mousemove.chartgui touchmove.chartgui"), $(document.body).off("mouseup.chartgui touchend.chartgui"), $(document.body).on("mousemove.chartgui touchmove.chartgui", e), $(document.body).on("mouseup.chartgui touchend.chartgui", s)), TradingView.mousePressed = !0, f.button !== TradingView.MOUSE_RIGHT_BUTTON && (TradingView.processEvent(f, n, t, t.mouseDownEvent), r || (o = 0, r = window.setTimeout(y, 500))), i) {
            f.preventDefault();
            try {
                window.focus()
            } catch (p) {
            }
        }
    };
    n.on("touchcancel", function () {
        clearTimeout(u)
    });
    if (Modernizr.touch)n.on("touchstart.chartgui", f), n.on("touchstartoutside mousedownoutside", function (i) {
        TradingView.processEvent(i, n, t, t.mouseDownOutsideEvent)
    }), n.on("gesturestart", function (i) {
        TradingView.processEvent(i, n, t, t.gestureStartEvent);
        clearTimeout(u)
    }), n.on("gesturechange", function (i) {
        i.scale = i.originalEvent.scale;
        TradingView.processEvent(i, n, t, t.gestureChangeEvent)
    }), n.on("gestureend", function (i) {
        TradingView.processEvent(i, n, t, t.gestureEndEvent)
    }); else if (n.on("mousedown.chartgui touchstart.chartgui", f), n.on("touchstartoutside  mousedownoutside", function (i) {
        TradingView.processEvent(i, n, t, t.mouseDownOutsideEvent)
    }), navigator.msPointerEnabled && window.MSGesture) {
        var f = new MSGesture, s = !1, p = 1, e = n.get(0);
        f.target = e;
        e.gesture = f;
        e.gesture.pointerType = null;
        e.pointers = [];
        f.pointerType = null;
        n.on("pointerdown", function (n) {
            if (n.target === this)if (null === this.gesture.pointerType)this.gesture.target = e, this.gesture.addPointer(n.originalEvent.pointerId), this.gesture.pointerType = n.originalEvent.pointerType; else if (n.originalEvent.pointerType === this.gesture.pointerType)this.gesture.addPointer(n.originalEvent.pointerId); else {
                var t = new MSGesture;
                t.target = n.originalEvent.target;
                n.originalEvent.target.gesture = t;
                n.originalEvent.target.gesture.pointerType = n.originalEvent.pointerType;
                n.originalEvent.target.gesture.addPointer(n.originalEvent.pointerId)
            }
        });
        n.on("MSGestureChange", function (i) {
            i.scale = p *= 1 * (i.originalEvent.scale - 1) + 1;
            s || 1 === i.originalEvent.scale || (s = !0, TradingView.processEvent(i, n, t, t.gestureStartEvent));
            s && TradingView.processEvent(i, n, t, t.gestureChangeEvent)
        });
        n.on("MSGestureEnd", function (i) {
            s = !1;
            p = 1;
            TradingView.processEvent(i, n, t, t.gestureEndEvent)
        })
    }
    h = function (r) {
        n.off("mousemove.chartgui touchmove.chartgui");
        TradingView.processEvent(r, n, t, t.mouseLeaveEvent);
        i && r.preventDefault()
    };
    n.mouseleave(h);
    a = function (r) {
        TradingView.processEvent(r, n, t, t.contextMenuEvent);
        i && r.preventDefault()
    };
    n.contextMenu && n.contextMenu(a)
};
TradingView.clientRect = function (n) {
    var t = n.offset(), i = n.width();
    return n = n.height(), new TradingView.Rect(t.left, t.top, i, n)
};
TradingView.offsetPosition = function (n) {
    var t = 0, i = 0;
    do t += n.offsetLeft, i += n.offsetTop, n = n.offsetParent; while (n);
    return{left: t, top: i}
};
TradingView.addColorPicker = function (n) {
    var t = $("<input>");
    return t.appendTo(n), t.tvcolorpicker(), TVSettings && (t.tvcolorpicker.setCustomColors = TVSettings.setJSON("pickerCustomColors", []), t.bind("customcolorchange", function (n, t) {
        TVSettings.setJSON("pickerCustomColors", t)
    })), t
};
TradingView.createLineStyleEditor = function () {
    return new HTMLHelper.Combobox([
        {value: CanvasEx.LINESTYLE_SOLID, html: '<div class="linestyle solidline"/>'},
        {value: CanvasEx.LINESTYLE_DOTTED, html: '<div class="linestyle dottedline"/>'},
        {value: CanvasEx.LINESTYLE_DASHED, html: '<div class="linestyle dashedline"/>'}
    ])
};
TradingView.createShapeLocationEditor = function () {
    return $('<select><option value="' + CanvasEx.MARKLOC_ABOVEBAR + '">Above Bar<\/option><option value="' + CanvasEx.MARKLOC_BELOWBAR + '">Below Bar<\/option><option value="' + CanvasEx.MARKLOC_TOP + '">Top<\/option><option value="' + CanvasEx.MARKLOC_BOTTOM + '">Bottom<\/option><option value="' + CanvasEx.MARKLOC_ABSOLUTE + '">Absolute<\/option><\/select>')
};
TradingView.createShapeStyleEditor = function () {
    for (var i, n = "<select>", r = Object.keys(TradingView.StudyPlotShapes.Data), t = 0; t < r.length; ++t)i = TradingView.StudyPlotShapes.Data[r[t]], n = n + ('<option value="' + i.id + '">' + i.guiName + "<\/option>");
    return $(n + "<\/select>")
};
TradingView.createLineWidthEditor = function () {
    return $('<div class="linewidth-slider">').slider({min: 1, max: 4, step: 1})
};
TradingView.createVisibilityEditor = function () {
    return $("<input type='checkbox' class='visibility-switch'/>")
};
TradingView.createTextEditor = function () {
    var n = $("<input/>");
    return n.attr("type", "text"), n
};
TradingView.createTextPosEditor = function () {
    return new HTMLHelper.Combobox([
        {value: CanvasEx.TEXTPOS_TOPLEFT, html: "Top Left"},
        {value: CanvasEx.TEXTPOS_TOPCENTER, html: "Top Center"},
        {value: CanvasEx.TEXTPOS_TOPRIGHT, html: "Top Right"},
        {value: CanvasEx.TEXTPOS_MIDDLELEFT, html: "Middle Left"},
        {value: CanvasEx.TEXTPOS_MIDDLECENTER, html: "Middle Center"},
        {value: CanvasEx.TEXTPOS_MIDDLERIGHT, html: "Middle Right"},
        {value: CanvasEx.TEXTPOS_BOTTOMLEFT, html: "Bottom Left"},
        {value: CanvasEx.TEXTPOS_BOTTOMCENTER, html: "Bottom Center"},
        {value: CanvasEx.TEXTPOS_BOTTOMRIGHT, html: "Bottom Right"}
    ])
};
TradingView.createHHistDirectionEditor = function () {
    var n = $("<select />");
    return $("<option value='" + CanvasEx.HHISTDIR_LEFTTORIGHT + "'>Left<\/option>").appendTo(n), $("<option value='" + CanvasEx.HHISTDIR_RIGHTTOLEFT + "'>Right<\/option>").appendTo(n), n
};
TradingView.createTransparencyEditor = function (n) {
    var t = $('<div class="transparency-slider"><div class="gradient"><\/div><\/div>').slider({min: 0, max: 100, step: 1}), i = ["-moz-linear-gradient(left, %COLOR 0%, transparent 100%)", "-webkit-gradient(linear, left top, right top, color-stop(0%,%COLOR), color-stop(100%,transparent))", "-webkit-linear-gradient(left, %COLOR 0%,transparent 100%)", "-o-linear-gradient(left, %COLOR 0%,transparent 100%)", "linear-gradient(to right, %COLOR 0%,transparent 100%)"];
    return t.setColor = function (n) {
        var r = t.find(".gradient");
        $.browser.msie ? r.css("filter", "progid:DXImageTransform.Microsoft.gradient(startColorstr='" + n + "', EndColor=0, GradientType=1)") : i.forEach(function (t) {
            r.css("background-image", t.replace(/%COLOR/, n))
        })
    }, n ? (t.setColor(n.val() || "black"), n.on("change", function (n) {
        t.setColor(n.target.value)
    })) : t.setColor("black"), t
};
TradingView.createPlotEditor = function () {
    var n = $("<select />");
    return $("<option value='" + TradingView.Study.PLOT_LINE + "'>" + $.t("Line") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_LINE_WITH_BREAKS + "'>" + $.t("Line With Breaks") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_HISTOGRAM + "'>" + $.t("Histogram") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_CROSS + "'>" + $.t("Cross", {context: "chart_type"}) + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_AREA + "'>" + $.t("Area") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_AREA_WITH_BREAKS + "'>" + $.t("Area With Breaks") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_COLUMNS + "'>" + $.t("Columns") + "<\/option>").appendTo(n), $("<option value='" + TradingView.Study.PLOT_CIRCLES + "'>" + $.t("Circles") + "<\/option>").appendTo(n), n
};
TradingView.createPriceSourceEditor = function () {
    var n = $("<select>");
    return $("<option value='open'>" + $.t("Open") + "<\/option>").appendTo(n), $("<option value='high'>" + $.t("High") + "<\/option>").appendTo(n), $("<option value='low'>" + $.t("Low") + "<\/option>").appendTo(n), $("<option value='close'>" + $.t("Close") + "<\/option>").appendTo(n), $("<option value='hl2'>" + $.t("(H + L)/2") + "<\/option>").appendTo(n), $("<option value='hlc3'>" + $.t("(H + L + C)/3") + "<\/option>").appendTo(n), $("<option value='ohlc4'>" + $.t("(O + H + L + C)/4") + "<\/option>").appendTo(n), n
};
TradingView.cacheUrl = function (n) {
    $("<img>").attr("src", n)
};
TradingView.themeImageHTML = function (n) {
    return"<img src='" + TradingView.themeResourceFullPath(n) + "' style='display:block'/>"
};
TradingView.animate = function (n, t, i, r, u) {
    var f = r || 250, s = $.easing[u] || $.easing.easeOutCubic, e = 0, h = Date.now(), o = function (r) {
        r = (r ? 1e12 > r ? Date.now() : r : Date.now()) - h;
        var u = Math.min(n, s(null, r, 0, n, f)), c = u - e;
        e = u;
        t(c);
        r >= f ? "function" == typeof i && i() : requestAnimationFrame(o)
    };
    requestAnimationFrame(o)
};
D14 = function (n, t, i) {
    this._options = i = i || {};
    this._name = n;
    this._container = $('<div class="favored-list-container" />');
    i.addClass && this._container.addClass(i.addClass);
    this._quick_container = $('<div class="quick" />').appendTo(this._container);
    this._submenu = $('<span class="submenu">' + (this._options.submenuHtml || "") + "<i><\/i><\/span>").appendTo(this._container);
    i.tooltip && (this._submenu.attr("title", i.tooltip), i.addTooltipClass && this._submenu.addClass(i.addTooltipClass));
    this._activeButton = null;
    this._onChange = new Delegate;
    this._onSelect = new Delegate;
    this._onResize = new Delegate;
    this._onOpen = new Delegate;
    this._load(t);
    TradingView.bindPopupMenu(this._container, null, {direction: "down", reverse: !0, addClass: "narrow favored-list" + (i.popupAddClass ? " " + i.popupAddClass : ""), event: "popup-menu", popupSpacing: i.popupSpacing});
    this._submenu.on("click", this._openMenu.bind(this));
    if (!$.browser.msie)TVXWindowEvents.on(n + "-change", $.proxy(this, "_onChangeInAnotherTab"));
    return this
};
D14.prototype._openMenu = function () {
    this._onOpen.fire();
    this._submenu.trigger("popup-menu", [this._data])
};
D14.prototype._onChangeInAnotherTab = function () {
    this.reload(this._data)
};
D14.prototype.reload = function (n) {
    this._quick_container.empty();
    this._load(n)
};
D14.prototype._load = function (n) {
    var t = this;
    this._quicks = this._options.showJustDefaultQuicks ? this._options.defaultFavorites || [] : this._options.notShowQuicks ? [] : TVSettings.getJSON(this._name + ".quicks", this._options.defaultFavorites || [], !0);
    this._list = [];
    $.grep(n, function (n) {
        return!n.separator
    }).forEach(function (n, i) {
        var r = {index: i, data: n, toQuickButton: $('<span class="to-quick" title=""><\/span>'), toggleFavorite: function (n, i) {
            var u = void 0 !== n ? n : !this.isFavorite();
            u ? this.markFavorite() : this.unmarkFavorite();
            t._toggleFavorite(r, u, i)
        }, markFavorite: function () {
            this.toQuickButton && this.toQuickButton.attr("title", $.t("Remove from favorites")).addClass("quicked")
        }, unmarkFavorite: function () {
            this.toQuickButton && this.toQuickButton.attr("title", $.t("Add to favorites")).removeClass("quicked")
        }, isFavorite: function () {
            return-1 < t._quicks.indexOf(n.id)
        }, active: function () {
            return this.data.active()
        }, drop: function () {
            return this.data.drop()
        }}, u;
        t._options.notShowQuicks && $.extend(r, {toQuickButton: null});
        r.data.toQuickButtonStyle && r.toQuickButton && r.toQuickButton.css(r.data.toQuickButtonStyle);
        t._list.push(r);
        u = {action: function () {
            t._change(r)
        }, buttons: [], active: t._options.notShowActive ? function () {
            return!1
        } : function () {
            return t._active && r === t._active
        }};
        t._options.notShowQuicks || u.buttons.push({el: r.toQuickButton, handler: function (n) {
            r.toggleFavorite();
            n.stopPropagation()
        }});
        "function" == typeof r.data.drop && u.buttons.push({el: $('<span class="delete" title="Delete"><\/span>'), handler: function (n) {
            r.drop();
            n.stopPropagation()
        }});
        $.extend(n, u);
        r.toggleFavorite(r.isFavorite(), !0)
    });
    this._data = n;
    this._options.notShowActive || this._addActive(this._list[0]);
    this._onResize.fire()
};
D14.prototype._toggleFavorite = function (n, t, i) {
    if (!this._options.notShowQuicks || this._options.showJustDefaultQuicks) {
        if (t) {
            n.favorite_button = this._createButton(n, this._quick_container);
            var r = this._lastFavoriteButton(n);
            r ? n.favorite_button.insertAfter(r.favorite_button) : n.favorite_button.prependTo(this._quick_container)
        } else i || this._removeButton(n);
        i || (t ? -1 == this._quicks.indexOf(n.data.id) && this._quicks.push(n.data.id) : -1 < this._quicks.indexOf(n.data.id) && this._quicks.splice(this._quicks.indexOf(n.data.id), 1), this._saveFavorite(), this._markActive(), this._onResize.fire())
    }
};
D14.prototype._lastFavoriteButton = function (n) {
    for (n = n.index - 1; 0 <= n; n--)if (this._list[n] && this._list[n].favorite_button)return this._list[n]
};
D14.prototype._saveFavorite = function () {
    this._options.notShowQuicks || (TVSettings.setJSON(this._name + ".quicks", this._quicks), TVXWindowEvents.emit(this._name + "-change"))
};
D14.prototype._createButton = function (n) {
    var r = this, t = n.data.favoriteButton, i = $("<span><\/span>").data("item", n), u;
    t.addClass && i.addClass(t.addClass);
    t.text && i.text(n.text);
    t.title && i.prop("title", t.title);
    t.icon && (u = $("<i><\/i>").appendTo(i), t.icon.image && u.css("background-image", t.icon.image || ""), t.icon.offset && u.css("background-position", "string" == typeof t.icon.quickOffset ? t.icon.quickOffset : t.icon.quickOffset.x + "px " + t.icon.quickOffset.y + "px"));
    i.on("click", function (t) {
        r._change(n);
        0 === r._quicks.length && r._openMenu();
        t.preventDefault()
    });
    return i
};
D14.prototype._removeButton = function (n) {
    n.favorite_button && (n.favorite_button.remove(), n.favorite_button = null)
};
D14.prototype._markActive = function (n) {
    var t, i, r;
    this._options.notShowActive || (t = this, this._active && ((n = this._active, n.isFavorite()) ? (r = t._quick_container.find(".just_active"), this._btnToggleActiveView(r, !1)) : (i = this._addActive(n), 0 !== this._quicks.length && this._btnToggleActiveView(i, !0))), $.map(this._list, function (i) {
        n !== i || 0 === t._quicks.length ? t._btnToggleActiveView(i.favorite_button, !1) : i.favorite_button && t._btnToggleActiveView(n.favorite_button, !0)
    }), i && i.hasClass("selected") ? this._container.addClass("not-favored-active") : this._container.removeClass("not-favored-active"))
};
D14.prototype._btnToggleActiveView = function (n, t) {
    if (n) {
        var i, r = n.data("item");
        r && r.data && r.data.icon && (i = r.data.icon);
        t ? (n.addClass("selected"), i = i.offsetActive ? i.offsetActive : null) : (n.removeClass("selected"), i = i.offset ? i.offset : null);
        i && n.children("i").css("background-position", "string" == typeof i ? i : i.x + "px " + i.y + "px")
    }
};
D14.prototype._addActive = function (n) {
    return this._quick_container.find(".just_active").remove(), this._createButton(n).appendTo(this._quick_container).addClass("just_active")
};
D14.prototype._clearActive = function () {
    this._quick_container.find(".just_active").remove()
};
D14.prototype._clearActive = function () {
};
D14.prototype._setActive = function (n) {
    return this._active === n ? !1 : (this._active = n, this._markActive(), !0)
};
D14.prototype._change = function (n) {
    if (this._onSelect.fire(n.data.id), this._setActive(n))this._onChange.fire(n.data.id); else return!1
};
D14.prototype.element = function () {
    return this._container
};
D14.prototype._getItemByValue = function (n) {
    for (var t in this._list)if (this._list[t].data.id == n)return this._list[t];
    throw Error("undefined value " + n + " in FavoredList");
};
D14.prototype.onChange = function () {
    return this._onChange
};
D14.prototype.onSelect = function () {
    return this._onSelect
};
D14.prototype.onResize = function () {
    return this._onResize
};
D14.prototype.onOpen = function () {
    return this._onOpen
};
D14.prototype.setValue = function (n) {
    n = this._getItemByValue(n);
    this._setActive(n)
};
D14.prototype.value = function () {
    if (this._active)return this._active.data.value
};
D14.prototype.removeById = function (n, t) {
    var i = $.grep(this._data, function (t) {
        return t.id != n
    });
    this.reload(i);
    "function" == typeof t && t()
};
TradingView.bindPopupMenu = function (n, t, i) {
    var u, f;
    n = $(n);
    i = i || {};
    u = (i.event || "click") + ".popup-menu";
    i.hideEvent && (f = i.hideEvent + ".popup-menu");
    var e = new Function, r = e, o = {}, s = function (u, f, s) {
        function b(t) {
            t = $(t.target).parents().andSelf();
            t.is(h) || t.is(n) || t.is(".charts-popup-tab-headers, .charts-popup-itemheader") || r()
        }

        function ft(n) {
            n = $(n.target).parents().andSelf();
            n.is(".charts-popup-tab-headers, .charts-popup-itemheader") || i.notCloseOnButtons && n.is(".icon-save, .icon-delete") || r()
        }

        function k(t, r, u) {
            var e, f, a, v, o, y, s;
            if (t instanceof TradingView.bindPopupMenu.TabGroup) {
                if (t.tabs && t.tabs.length)if (1 !== t.tabs.length || t.tabs[0].title) {
                    var h = $('<div class="charts-popup-tab-group"><\/div>').appendTo(u), c = $('<div class="charts-popup-tab-headers"><\/div>').appendTo(h), l = null;
                    $.each(t.tabs || [], function (n, i) {
                        var u, r;
                        if (i.items && i.items.length) {
                            u = $('<div class="charts-popup-tab"><\/div>').hide().appendTo(h);
                            $.each(i.items, function () {
                                k(this, void 0, u)
                            });
                            r = $('<span class="charts-popup-tab-header">').append($('<a href="javascript://" class="charts-popup-tab-header-label">').text(i.name)).appendTo(c);
                            r.on("click", function (n) {
                                r.is(".active") || (c.find(".charts-popup-tab-header.active").removeClass("active"), r.addClass("active"), h.find(".charts-popup-tab").hide(), u.show(), n && n.preventDefault(), "function" == typeof t.onChange && t.onChange.call(t, i.name))
                            });
                            (!l || i.active) && (l = r, c.find(".charts-popup-tab-header.active").removeClass("active"), r.addClass("active"), h.find(".charts-popup-tab").hide(), u.show())
                        }
                    })
                } else $.each(t.tabs[0].items, function () {
                    k(this, void 0, u)
                })
            } else if (t instanceof TradingView.bindPopupMenu.Group)e = $('<div class="charts-popup-group"><\/div>').appendTo(u), t.title && (r = $('<div class="charts-popup-itemheader"><\/div>').text(t.title).prepend($('<span class="charts-popup-itemheader-icon"><\/span>')), t.collapsible && (e.addClass("charts-popup-group-collapsible"), e.toggleClass("collapsed", t.collapsed), r.on("click", function () {
                if (e.toggleClass("collapsed"), "function" == typeof t.onChange)t.onChange(e.hasClass("collapsed"))
            })), e.append(r)), $.each(t.items, function () {
                k(this, 1, e)
            }); else if (t instanceof TradingView.bindPopupMenu.Header)u.append($('<div class="charts-popup-itemheader"><\/div>').text(t.title)); else if (t.separator)f = $('<span class="separator"><\/span>'), u.append(f); else {
                if (f = $('<a class="item" href="#">'), "function" == typeof t.deleteAction && "function" == typeof t.saveAction && f.addClass("item-twobuttons"), t.url && f.attr("href", t.url), t.target && f.attr("target", t.target), r || f.addClass("first"), "function" == typeof t.active ? t.active(t) && f.addClass("active") : t.active && f.addClass("active"), t.addClass && f.addClass(t.addClass), t.addData && f.data(t.addData), t.disabled && f.addClass("disabled"), "function" == typeof t.action && (a = t.action, r = function (n) {
                    var i = $(n.target).parents().andSelf();
                    i.is(o) || i.is(s) || (a.apply(f, arguments), !t.url && n && "function" == typeof n.preventDefault && n.preventDefault())
                }, i.upAction ? f.bind("mouseup", r) : f.bind("click", r)), t.date ? (r = $('<span class="title"><\/span>').appendTo(f), $('<span class="date"><\/span>').text(t.date || "").appendTo(f)) : t.icon ? (r = $('<span class="icon"><\/span>').appendTo(f), r.css("background-image", t.icon.image || ""), t.icon.offset && r.css("background-position", "string" == typeof t.icon.offset ? t.icon.offset : t.icon.offset.x + "px " + t.icon.offset.y + "px"), r = $('<span class="title"><\/span>').appendTo(f)) : r = $('<span class="title-expanded"><\/span>').appendTo(f), t.html ? r.html(t.html) : r.text(t.title || ""), "function" == typeof t.deleteAction) {
                    v = t.deleteAction;
                    r = t.deleteAction.title || "Delete";
                    o = $('<span class="icon-delete">');
                    o.attr("title", r);
                    o.on("click", function (n) {
                        v.apply(f, arguments);
                        n.preventDefault()
                    });
                    f.append(o)
                }
                if ("function" == typeof t.saveAction) {
                    y = t.saveAction;
                    r = t.saveAction.title || "Save";
                    s = $('<span class="icon-save">');
                    s.attr("title", r);
                    s.on("click", function (n) {
                        y.apply(f, arguments);
                        n.preventDefault()
                    });
                    f.append(s)
                }
                t.buttons instanceof Array && t.buttons.length && t.buttons.forEach(function (n) {
                    if (n.el instanceof $ || (n.el = $(n.el)), n.el.appendTo(f), n.handler)n.el.on("click", function () {
                        n.handler.apply(f, arguments)
                    })
                });
                "undefined" != typeof t.counter && (r = t.counterBlue ? "blue" : "", $('<span class="counter"><\/span>').text(t.counter + "").addClass(r).appendTo(f));
                u.append(f);
                n.data("popup-menu", u)
            }
        }

        var h, d, ut, et, g;
        if (f = f || t, "function" == typeof f && (f = f()), $(this).hasClass("open"))if (s)r(), s = o.scrollTop; else return;
        if (r = function () {
            o.scrollTop = h.scrollTop();
            h.remove();
            n.removeClass("active open");
            n.data("popup-menu", null);
            $(document).off("click", ft);
            $(document).off("mousedown", b);
            Modernizr.touch && $(document).off("touchstart.chartgui", b);
            $(document).off("selectstart.popup-menu");
            r = e;
            i.onRemove && i.onRemove()
        }, n.addClass("active open"), h = $('<div class="charts-popup-list">'), i.addClass && h.addClass(i.addClass), $.each(f, function (n) {
            k(this, n, h)
        }), setTimeout(function () {
            $(document).on("click", ft);
            $(document).on("mousedown", b);
            Modernizr.touch && $(document).on("touchstart.chartgui", b)
        }, 0), i.upAction)$(document).on("selectstart.popup-menu", function () {
            return!1
        });
        h.appendTo(document.body);
        d = $(window).width();
        f = Math.min($(window).height(), $("body").height());
        var nt = n.outerWidth(), y = n.outerHeight(), c = n.offset();
        s = $(window).scrollTop() || 0;
        c.top -= s;
        var tt = h.outerWidth(), it = h.outerHeight(), l = void 0 != i.viewportSpacing ? i.viewportSpacing : 10, a = i.popupSpacing ? ~~i.popupSpacing : 1, p = i.popupDrift ? ~~i.popupDrift : 0, w = it - h.height(), v = i.direction ? i.direction : "down", rt = !!i.reverse;
        "down" == v && (ut = f - c.top - y - a - l - w, et = c.top - a - l - w, ut < Math.max(it || 0, 100) && et > ut && (v = "up"));
        switch (v) {
            case"down":
            case"up":
                "down" == v ? h.css("top", c.top + y + a + "px") : h.css("bottom", f - c.top + a + "px").css("top", "auto");
                rt ? (Math.max(c.left + p + nt - tt, l), h.css("left", Math.max(c.left + p + nt - tt, l) + "px").css("right", "auto")) : h.css("left", c.left + p + "px").css("right", "auto");
                break;
            case"right":
            case"left":
                a = Math.max(a, 4);
                "right" == v ? h.css("left", Math.floor(c.left + nt + a) + "px").css("right", "auto") : h.css("left", Math.floor(Math.max(c.left - tt - a, l)) + "px").css("right", "auto");
                rt ? h.css("top", Math.floor(Math.max(c.top + p + y - it, l)) + "px") : h.css("top", Math.floor(c.top + p) + "px")
        }
        for (h.show(), "up" == v || {left: 1, right: 1}[v] && rt ? "up" == v ? h.css("max-height", c.top - a - l - w + "px") : h.css("max-height", c.top + y - a - l - w + "px") : h.css("max-height", f - c.top - y - a - l - w + "px"), i.careRightBorder && (d += $(window).scrollLeft(), parseInt(h.css("left")) + h.width() + l > d && h.css("left", d - h.width() - l + "px").css("right", "auto")), i.careBottomBorder && parseInt(h.css("top")) + h.height() + l > f + s && h.css("top", f - h.height() - l + s + "px"), s = n.parents().andSelf(), f = s.size(); f--;)if ("fixed" === s.eq(f).css("position")) {
            g = s.eq(f);
            break
        }
        g && (g = h.offset(), h.css({position: "fixed", left: g.left - $(document).scrollLeft(), right: "auto"}));
        u && u.preventDefault()
    };
    u && n.bind(u, s);
    f && n.bind(f, function () {
        r()
    });
    i.runOpened && s()
};
TradingView.bindPopupMenu.TabGroup = function TabGroup(n) {
    if (!(this instanceof TabGroup))return new TabGroup(n);
    n = n || {};
    this.tabs = [];
    "function" == typeof n.onChange && (this.onChange = n.onChange)
};
TradingView.bindPopupMenu.TabGroup.prototype.appendTab = function (n, t, i) {
    if (n = null == n ? "" : n + "", t || (t = []), i || (i = {}), !Array.isArray(t))throw new TypeError("items must be an array");
    return this.tabs.push({name: n, items: t, active: !!i.active}), t
};
TradingView.bindPopupMenu.Header = function Header(n) {
    if (!(this instanceof Header))return new Header(n);
    this.title = n
};
TradingView.bindPopupMenu.Group = function Group(n) {
    if (!(this instanceof Group))return new Group(n);
    n = n || {};
    this.items = [];
    this.title = null == n.title ? "" : n.title + "";
    this.collapsible = !!n.collapsible;
    this.collapsed = !!n.collapsed;
    "function" == typeof n.onChange && (this.onChange = n.onChange)
};
TradingView.bindPopupMenu.Group.prototype.push = function () {
    this.items.push.apply(this.items, arguments)
};
TradingView.unbindPopupMenu = function (n) {
    n = $(n);
    n.unbind(".popup-menu");
    n.removeData("popup-menu")
};
TradingView.showChartNameDialog = function (n, t, i, r, u, f) {
    var o = t ? t : $.t("Save New Chart Layout"), e = D83.createDialog(o);
    if (t = function () {
        var i = e.find('input[name="name"]'), r = i.val(), f = [], t, s;
        if (u)for (t = 0; t < u.length; t++)"bool" === u[t].type && (s = e.find('input[name="' + u[t].name + '"]'), f.push(s[0].checked));
        return r ? (n(r, f), D83.destroy(o)) : (D83.showError($.t("Please enter chart name"), D83.get(o)), i.focus()), !1
    }, r = r || "", e.css("width", "400px"), e.find(".tv-dialog-content").html('<div class="main"><form><p>' + $.t(i ? i : "Chart name") + ':<\/p><p class="tv-dialogs-name"><input type="text" name="name" maxlength="' + r + '"/><\/p><p class="tv-dialog-right"><\/p><\/form><\/div>'), u)for (i = e.find(".tv-dialog-right"), r = 0; r < u.length; r++)if ("bool" === u[r].type) {
        var s = $('<p class="tv-dialogs-name"><\/p>'), h = u[r].hint ? $('<div class="tv-dialogs-label-hint"><\/div>').blueTooltip($.t(u[r].hint), "bottom") : null, c = $('<label><input type="checkbox" style="vertical-align:top;margin-top:2px" name="' + u[r].name + '"/> ' + $.t(u[r].title) + "<\/label>");
        s.append(c, h).insertBefore(i)
    }
    e.find("form").submit(t);
    $('<a class="tv-button wide ok">' + $.t("OK") + "<\/a>").click(t).css({"margin-right": "5px"}).appendTo(e.find(".tv-dialog-right"));
    $('<a class="tv-button wide cancel">' + $.t("Cancel") + "<\/a>").click(function () {
        D83.destroy(o)
    }).appendTo(e.find(".tv-dialog-right"));
    "function" == typeof f && f(e);
    D83.positionDialog(e, {left: $(window).width() / 2 - e.width() / 2, top: $(window).height() / 2 - e.height() / 2});
    D83.applyHandlers(e);
    e.find('input[name="name"]').focus()
};
D1 = function (n, t, i) {
    var r = this;
    this.HIGHLIGHT_STUDY_NUM_FLICKS = 2;
    this._BASIC_STUDIES_PACKAGE_NAME = "tv-basicstudies";
    this._CUSTOM_STUDIES_PACKAGE_NAME = "Script$USER";
    this._PUBLISHED_STUDIES_PACKAGE_NAME = "Script$PUB";
    this._SCRIPTING_PACKAGE_NAME = "tv-scripting";
    this._BASIC_STUDIES_PAGE_NAME = J77.enabled("plain_studymarket") ? "Technical Analysis" : "Built-ins";
    this.Q5 = n;
    this._chart = n.activeChartWidget.value();
    this._options = $.extend({}, this.DEFAULT_OPTIONS, i || {});
    this.concretizeOptions();
    this._studies = this._market = null;
    this._packagesWithTabNames = {};
    this._user = t;
    this._favs = [];
    this._pages = {};
    this._tabs = {};
    this._headers = {};
    this.favsChanged = new Delegate;
    this.layoutChanged = new Delegate;
    this.visibilityChanged = new Delegate;
    this.studiesReady = new $.Deferred;
    this.marketPagesReady = new $.Deferred;
    this._pubSearchPage = -1;
    this._pubSearchEntries = [];
    this._pubSearchDfd = null;
    TVXWindowEvents.on("StudyFavoritesChanged", function (n) {
        r._onExternalFavoritesChanged(JSON.parse(n))
    })
};
D1.prototype.init = function () {
    this._initialized || (this.setupMarketInfo(), this.getStudyInfo(), this.setUser(this._user), this.prepareLayout(), this.attachHandlers(), this._initialized = !0)
};
D1.prototype.DEFAULT_OPTIONS = {onWidget: !1, hideMarketPages: !1, selectBasicPage: !0, minimized: !1, searchKeywords: {earning: /EPS/, earnings: /EPS/, "trailing twelve months": /TTM/}, popularFundamentals: [
    {name: "Income Statement", studies: "Script$EDGR_TOTAL_REVENUE@tv-scripting Script$EDGR_DILUTED_EPS_NET_INCOME@tv-scripting Script$EDGR_NET_INCOME@tv-scripting Script$EDGR_EBITDA@tv-scripting Script$EDGR_EBIT@tv-scripting Script$EDGR_EQUITY_EARNINGS@tv-scripting".split(" ")},
    {name: "Profitability", studies: ["Script$EDGR_GROSS_MARGIN@tv-scripting", "Script$EDGR_AFTER_TAX_MARGIN@tv-scripting", "Script$EDGR_GROSS_PROFIT@tv-scripting"]},
    {name: "Dividend", studies: ["Script$EDGR_DIVIDEND_YIELD@tv-scripting", "Script$EDGR_DIVIDENDS_PAID@tv-scripting"]},
    {name: "Current Valuation", studies: ["Script$EDGR_MARKET_CAP@tv-scripting", "Script$EDGR_PRICE_EARNINGS_TTM@tv-scripting", "Script$EDGR_PRICE_EARNINGS_TO_GROWTH_TTM@tv-scripting", "Script$EDGR_PRICE_BOOK_VALUE_PER_SHARE@tv-scripting"]},
    {name: "Other", studies: ["Script$EDGR_DEBT_TO_EQUITY@tv-scripting", "Script$EDGR_FREE_CASH_FLOW@tv-scripting", "Script$EDGR_RETURN_ON_EQUITY@tv-scripting", "Script$EDGR_ACCOUNTING_CHANGE@tv-scripting", "Script$EDGR_ACCOUNTS_PAYABLE@tv-scripting"]}
]};
D1.prototype._FAV_KEY = "studyMarket.favorites";
D1.prototype._PAGE_KEY = "studyMarket.page";
D1.prototype._MARKET_TAB_IS_OPEN_KEY = "studyMarket.marketTabIsOpen";
D1.prototype._TECHNICAL_TAB_IS_OPEN_KEY = "studyMarket.technicalTabIsOpen";
D1.prototype._ECONOMY_TAB = "Economy & Symbols";
D1.prototype._FILTER_KEY = "studyMarket.filter";
D1.prototype.onCustomScriptModified = function () {
    this._initialized && (this.getStudyInfo(), this.resetCustomScriptPage(), this.loadFavorites(), this.updateSearchPage())
};
D1.prototype.onPublishedScriptModified = function () {
    this._initialized && (this.getStudyInfo(), this.resetPublishedScriptPage(), this.loadFavorites(), this.updateSearchPage())
};
D1.prototype.concretizeOptions = function () {
    this._options.onWidget && (this._options.hideMarketPages = !0, this._options.selectBasicPage = !0, this._options.minimized = !0)
};
D1.prototype.setupMarketInfo = function () {
    this._market = {products: pro.getStudies(), order: pro.getStudiesOrder()};
    this._market.order = $.grep(this._market.order, function (n) {
        return"Script$EOTPRO" != n
    });
    this.setupSubproductsInfo()
};
D1.prototype.setupSubproductsInfo = function () {
    var r, t, n, i;
    for (this._subProductIds = {}, r = Object.keys(this._market.products), t = 0; t < r.length; ++t)if (n = this._market.products[r[t]], void 0 != n.subproduct_ids)for (i = 0; i < n.subproduct_ids.length; ++i)this._subProductIds[n.subproduct_ids[i]] = n.id
};
D1.prototype.getStudyInfo = function () {
    this._chart.withModel(this, function () {
        this.setupStudyInfo()
    })
};
D1.prototype.setupStudyInfo = function () {
    var n = this._chart.model().studiesMetaData().toArray();
    this._studies = {};
    n = n.filter(function (n) {
        return!this.isHidedStudy(n)
    }, this);
    n.forEach(function (n) {
        var i = this.getStudyPackageName(n), t;
        "Script$EOTPRO" == i || this._options.minimized && i != this._BASIC_STUDIES_PACKAGE_NAME || (t = this.resolvePackageName(i), assert(void 0 != t, "Cannot resolve packageName " + i), this._studies[t] || (this._studies[t] = []), this._studies[t].push(n))
    }.bind(this), this);
    this.studiesReady.resolve()
};
D1.prototype.resolvePackageName = function (n) {
    return n in this._subProductIds ? this._subProductIds[n] : n
};
D1.prototype.setUser = function (n) {
    is_authenticated ? this.setupUserData(n) : this.setAnonymous()
};
D1.prototype.setupUserData = function (n) {
    this._user = n;
    this.loadFavorites();
    this.updateMarketPages()
};
D1.prototype.setAnonymous = function () {
    this.setupUserData(null, []);
    this.favsChanged.fire()
};
D1.prototype.isHidedStudy = function (n) {
    return!!n.is_hidden_study
};
D1.prototype.loadFavorites = function () {
    for (var i, r = TVSettings.getJSON(this._FAV_KEY, []), n = [], t = 0; t < r.length; t++)i = StudyMetaInfo.cutFullId(r[t]), -1 === n.indexOf(i) && n.push(i);
    this._favs = n;
    this.favsChanged.fire()
};
D1.prototype.saveFavorites = function () {
    TVSettings.setJSON(this._FAV_KEY, this._favs)
};
D1.prototype.prepareLayout = function () {
    var n = this;
    this._widget = $('<div class="insert-study-dialog"><div class="insert-study-row insert-study-title tv-dialog-title"><a class="tv-dialog-title-close"><\/a>' + $.t("Indicators") + '<\/div><div class="insert-study-row insert-study-body"><div class="insert-study-tabs"><div class="insert-study-tabs-list-container"><ul class="insert-study-tabs-list"><\/ul><\/div><\/div><div class="insert-study-main"><div class="insert-study-headers"><\/div><div class="insert-study-pages insert-study-row"><\/div><\/div><\/div><\/div>');
    this._w_title = this._widget.find(".insert-study-title");
    this._w_tabs_container = this._widget.find(".insert-study-tabs-list-container");
    this._w_tabs = this._widget.find(".insert-study-tabs-list");
    this._w_pages = this._widget.find(".insert-study-pages");
    this._w_pages.onScrollToEnd = new Delegate;
    this._w_headers = this._widget.find(".insert-study-headers");
    this._widget.draggable(D83._constrainDraggableOptionsIfNeeded({handle: ".insert-study-title"})).css({position: "absolute", zIndex: 17});
    this.preparePages();
    this._options.minimized && this._widget.addClass("minimized");
    this._w_pages.scroll(function () {
        var t = $.map(n._w_pages.children(":visible"), function (n) {
            return $(n).outerHeight(!0)
        }).reduce(function (n, t) {
            return n + t
        }, 0), i = n._w_headers.outerHeight(!0), r = n._widget.find(".insert-study-main").height();
        t > r - i && t - n._w_pages.scrollTop() == r - i && n._w_pages.onScrollToEnd.fire()
    });
    this._widget.appendTo("body");
    this.hide()
};
D1.prototype.currentPage = function () {
    return this._pages[this._currentPageTitle]
};
D1.prototype.preparePages = function () {
    this.addSearchPage();
    J77.enabled("items_favoriting") && this.addFavoritesPage();
    this.prepareBasicPage();
    this._options.minimized || J77.enabled("charting_library") || (this.preparePublishedScriptPage(), this.prepareCustomScriptPage());
    this.prepareMarketPages();
    this._options.minimized || J77.enabled("charting_library") || (this.prepareFundamentalsPage(), this.studiesReady.done(function () {
    }.bind(this)));
    this.addEconomyPage();
    this._scroll = new D59(this._w_tabs_container, this._w_tabs, {showBottomShadow: !1})
};
D1.prototype.addEconomyPage = function () {
    var n = this.addPage(this._ECONOMY_TAB, {showTitle: !0}), n = $('<div class="economy-page">').appendTo(n);
    this.addSymbolWidget = new AddSymbolWidget(this.Q5);
    this.addSymbolWidget.show();
    n.append(this.addSymbolWidget._widget)
};
D1.prototype.addFavoritesPage = function () {
    this.addPage("Favorites", {showTitle: !0}).addClass("page-padded")
};
D1.prototype.prepareBasicPage = function () {
    var n = this, t = n.addPage(this._BASIC_STUDIES_PAGE_NAME, {packageName: this._BASIC_STUDIES_PACKAGE_NAME, technical: !J77.enabled("plain_studymarket"), showTitle: !0});
    this._basicPage = t;
    t.addClass("page-padded");
    n.studiesReady.done(function () {
        n.resetBasicPage()
    });
    n._options.selectBasicPage && n.selectPage(this._BASIC_STUDIES_PAGE_NAME)
};
D1.prototype.prepareCustomScriptPage = function () {
    var n = this;
    n.addPage("My Scripts", {packageName: this._CUSTOM_STUDIES_PACKAGE_NAME, technical: !0, showTitle: !0}).addClass("page-padded");
    n.studiesReady.done(function () {
        n.resetCustomScriptPage()
    })
};
D1.prototype.preparePublishedScriptPage = function () {
    var n = this, t = n.addPage("Public Library", {packageName: this._CUSTOM_STUDIES_PACKAGE_NAME, technical: !0, showTitle: !0, titleHref: "/p/", wikiHref: "https://www.tradingview.com/stock-charts-support/index.php/Public_Library"});
    t.addClass("page-padded");
    n.studiesReady.done(function () {
        n.resetPublishedScriptPage()
    });
    t.on("show-page", function () {
        n._onPublishedScriptPageShown(t)
    })
};
D1.prototype._onPublishedScriptPageShown = function () {
    0 > this._pubSearchPage && this._pubslishedScriptsLoadMore()
};
D1.prototype._pubslishedScriptsLoadMore = function () {
    var n = this, t;
    this._pubslishedScriptsLoading || (t = this.getPage("Public Library"), $('<div class="loading-indicator-small"><\/div>').appendTo(t), this._pubslishedScriptsLoading = !0, this._loadNextPubSearchPage().done(function () {
        n.resetPublishedScriptPage();
        n._pubslishedScriptsLoading = !1
    }))
};
D1.prototype.resetBasicPage = function () {
    var n = this.getPage(this._BASIC_STUDIES_PAGE_NAME);
    this._studies && studyMarket.preparePageStudies(n, this._studies[this._BASIC_STUDIES_PACKAGE_NAME] || [])
};
D1.prototype.resetCustomScriptPage = function () {
    if (!this._options.minimized && window.scriptLib && this._studies) {
        var i = this.getPage("My Scripts"), n = this._studies.Script$USER || [], t = $.Deferred();
        window.scriptLib && n.length ? scriptLib.requestUserScripts(function (i) {
            for (var f, e, u, r = n.length; r--;)if (f = n[r].scriptIdPart, f) {
                for (delete n[r].scriptName, e = null, u = i.length; u--;)if (i[u].scriptIdPart === f) {
                    e = i[u];
                    break
                }
                e ? n[r].scriptName = i[u].scriptName : n.splice(r, 1)
            } else n.splice(r, 1);
            t.resolve(n)
        }) : t.resolve(n);
        t.done(function (n) {
            n.length ? studyMarket.preparePageStudies(i, n) : studyMarket.appendTVScriptBtn(i)
        })
    }
};
D1.prototype._createPublishedScriptMetaInfo = function (n) {
    var t = this.Q5.activeChartWidget.value(), t = StudyMetaInfo.createMetaInfoStub(n, t.studyScriptingPkgVers);
    return t.author = n.author, t.scriptName = n.scriptName, t.scriptDescription = n.description, t.agreeCount = n.agreeCount, t.imageUrl = n.imageUrl, t
};
D1.prototype.resetPublishedScriptPage = function () {
    if (!this._options.minimized) {
        var n = this, t = this.getPage("Public Library"), i = this._pubSearchEntries.map(function (t) {
            return n._createPublishedScriptMetaInfo(t)
        });
        n.preparePageStudies(t, i, null, !0);
        t = n._pubslishedScriptsLoadMore.bind(n);
        n._w_pages.onScrollToEnd.unsubscribe(n, t);
        (void 0 === n._pubSearchPageMax || null === n._pubSearchPageMax || 0 <= n._pubSearchPage && n._pubSearchPage !== n._pubSearchPageMax) && n._w_pages.onScrollToEnd.subscribe(n, t)
    }
};
D1.prototype.prepareFundamentalsPage = function (n) {
    var t = this;
    n = this.addPage("Fundamentals", {packageName: "Script$EDGR", showTitle: !0});
    this.studiesReady.done(function () {
        function h() {
            for (var n, r = [], u = $.map(f, function (n) {
                return n.id
            }), i = 0; i < t._options.popularFundamentals.length; i++)n = t._options.popularFundamentals[i], n.studies = n.studies.filter(function (n) {
                return-1 != u.indexOf(n)
            }).map(function (n) {
                return f.filter(function (t) {
                    return n === t.id
                })[0]
            }), n.studies.length && r.push(n);
            return r
        }

        var f = this._studies.Script$EDGR, e, r, o, s;
        if ("undefined" !== f) {
            if (e = n, r = h(), n.addClass("page-with-popular"), r.length) {
                var e = $("<div><\/div>"), i = $("<div><\/div>"), u = $('<div><div class="column column-left"><\/div><div class="column column-right"><\/div><\/div>'), c = u.find(".column-left").css("width", "50%"), l = u.find(".column-right").css("width", "50%"), a = function () {
                    for (var t = 0, n = 0; n < r.length; n++)t += r[n].studies.length;
                    return t
                }(), v = function (n) {
                    var i = $('<div class="insert-study-items"><\/div>');
                    return t.fillStudies(i, n.studies, null), i.prepend('<div class="subgroup-header">' + n.name + "<\/div>"), i
                };
                for (n.append(i), i.append('<div class="header-container with-divider"><div class="group-header">All Metrics<\/div><\/div>'), i.append(e), n.prepend(u), n.append(i), u = i = 0; i < r.length; i++)o = r[i], s = v(o), u < a / 2 ? c.append(s) : l.append(s), u += o.studies.length
            }
            this.preparePageStudies(e, f)
        }
    }.bind(this))
};
D1.prototype.appendTVScriptBtn = function (n) {
    var i = this, t;
    n && (t = $('<br><a class="add-custom-script-btn"> Create your first script now!<\/a>').on("click", function (n) {
        i.hide();
        scriptEditor.show();
        n.stopPropagation()
    }), n.empty(), n.append("<p>Welcome to the TradingView custom scripting engine. It allows you to create your own custom studies or modify existing. You do not have any scripts created.<\/p>"), n.find("p").append(t))
};
D1.prototype.appendPubScriptBtn = function (n) {
    n && n.html("<p>No public library scripts were found.<\/p>")
};
D1.prototype.prepareMarketPages = function () {
    this._options.hideMarketPages || this.studiesReady.done(function () {
        var t = this, n = this._market.order.map(function (n) {
            return t._market.products[n]
        });
        n.sort(function (n, t) {
            return n.name < t.name ? -1 : n.name > t.name ? 1 : 0
        });
        n.forEach(function (n) {
            n.$page = this.addPage(n.name, {market: "tv-volumebyprice" != n.id, packageName: n.id, subProductIds: n.subproduct_ids || []});
            n.$page.addClass("offer-page")
        }, this);
        this.selectPage(TVSettings.getValue(this._PAGE_KEY, this._basicPage));
        this.marketPagesReady.resolve()
    }.bind(this))
};
D1.prototype.addSearchPage = function () {
    var n = this, t, r, i;
    n._tabs.search = $('<div class="search"><div class="left-border"><\/div><div class="right-border"><\/div><input type="text" name="q" value="" autocomplete="off" placeholder="' + $.t("Search") + '"><div><\/div><a class="input-reset"><\/a><\/div>').data("title", "search");
    n._pages.search = $('<div class="page-search"><\/div>').data("title", "search");
    t = n._tabs.search.find("input");
    r = n._tabs.search.find(".input-reset");
    n._search_value = null;
    n._search_input = t;
    this._widget.find(".insert-study-tabs").prepend(n._tabs.search);
    n._w_pages.prepend(n._pages.search);
    r.on("click", function () {
        t.val("").trigger("input").focus()
    });
    t.focus(function () {
        n.search(t.val())
    });
    t.on("input", function () {
        r.toggle("" !== this.value);
        var t = $(this);
        i && clearTimeout(i);
        i = setTimeout(function () {
            i = void 0;
            n.search(t.val())
        }, 200)
    })
};
D1.prototype.search = function (n, t, i) {
    var r = this, u, f, e;
    (this._search_value !== n || t) && (u = this._pages.search, f = [], "" !== n && (f.push({re: new RegExp("(" + n.split("").map(function (n) {
        return RegExpEscape(n)
    }).join(")(.*?)(") + ")", "i"), fuzzyHighlight: !0}), n.toLowerCase()in this.DEFAULT_OPTIONS.searchKeywords && f.push({re: this.DEFAULT_OPTIONS.searchKeywords[n.toLowerCase()], fuzzyHighlight: !1})), this._search_value = n, u.html(""), e = $.Deferred(), r._currentAsyncSearchDfd = e, J77.enabled("plain_studymarket") ? e.resolve([]) : D56.suggest(n).done(function (n) {
        var i = [], t;
        for (n = n && n.results || [], t = 0; t < n.length; t++)i.push(r._createPublishedScriptMetaInfo(n[t]));
        e.resolve(i)
    }).fail(function () {
        e.resolve([])
    }), e.done(function (n) {
        var o, s, t, i, l, a, v;
        if (r._currentAsyncSearchDfd === e) {
            for (var c = Object.keys(r._studies).concat(r._PUBLISHED_STUDIES_PACKAGE_NAME).sort(), h = [r._BASIC_STUDIES_PACKAGE_NAME, r._PUBLISHED_STUDIES_PACKAGE_NAME, r._CUSTOM_STUDIES_PACKAGE_NAME], i = h.length; i--;)o = h[i], s = c.indexOf(o), -1 !== s && (c.splice(s, 1), c.unshift(o));
            for (h = 0; h < c.length; h++) {
                if (o = c[h], s = [], o === r._PUBLISHED_STUDIES_PACKAGE_NAME)s = n; else for (t = r._studies[o], i = 0; i < t.length; i++)if (l = t[i], f.length)for (a = 0; a < f.length; a++)v = f[a].re, v.lastIndex = 0, v.test(l.description_localized) && s.push(l); else s.push(l);
                if (s.length) {
                    i = $('<div class="insert-study-items"><div>');
                    t = o;
                    switch (o) {
                        case r._BASIC_STUDIES_PACKAGE_NAME:
                            t = r._BASIC_STUDIES_PAGE_NAME;
                            break;
                        case"Script$USER":
                            t = "My Scripts";
                            break;
                        case"Script$PUB":
                            t = "Public Library";
                            break;
                        default:
                            o in r._packagesWithTabNames && (t = r._packagesWithTabNames[t])
                    }
                    u.append('<div class="search-header">' + $.t(t) + "<\/div>");
                    u.append(i);
                    r.fillStudies(i, s, f)
                }
            }
            u.is(":has(li)") || u.is(":has(.not-found)") || u.append('<p class="not-found">' + $.t("No indicators matched your criteria.") + "<\/p>");
            r.layoutChanged.fire()
        }
    }));
    i || this.selectPage("search")
};
D1.prototype.updateSearchPage = function () {
    var n = this._tabs.search.find("input").val();
    this.search(n, !0, !0)
};
D1.prototype.updateMarketPages = function () {
    $.when(this.marketPagesReady).done(function () {
        var n;
        this._market.order.forEach(function (t) {
            n = this._market.products[t];
            pro.hasPackage(n.id) ? (t = this._studies[n.id]) ? this.preparePageStudies(n.$page, t, n) : console.warn("Subscripted study package " + n.id + " absent in metaInfo.") : this.preparePageOffer(n.$page, n)
        }, this)
    }.bind(this))
};
D1.prototype.preparePageStudies = function (n, t, i, r) {
    var u = $('<div class="insert-study-items"/>');
    n.empty();
    n.append(u);
    i && n.find(".insert-study-items").css({width: 199, float: "left"}).end().append('<div class="insert-study-offer-container">' + pro.prepareProductPage(i) + "<\/div>");
    r || (t = this.sortStudies(t));
    this.fillStudies(u, t, null)
};
D1.prototype.preparePageOffer = function (n, t) {
    n.data("html", pro.prepareProductOfferPage(t));
    n.data("offer", t)
};
D1.prototype.addPage = function (n, t) {
    t = $.extend({}, t);
    var i = $.t(n), r = n.toLowerCase(), f = $("<div><\/div>").data("title", r), u = $('<li title="' + i + '"><\/li>').text(i).data("title", r), i = $(Mustache.render('<div class="insert-study-header">{{#showTitle}}<div class="header-text">{{#technical}}' + $.t("Technical Analysis") + ': {{/technical}}{{#titleHref}}<a href="{{titleHref}}" target="_blank"><u>{{title}}<\/u><\/a>{{/titleHref}}{{^titleHref}}{{title}}{{/titleHref}}{{#wikiHref}}<a href="{{wikiHref}}" target="_blank" class="tv-dialogs-label-hint apply-common-tooltip" title="Wiki"><\/a>{{/wikiHref}}<\/div>{{/showTitle}}<\/div>', {showTitle: t.showTitle, title: i, technical: t.technical, titleHref: t.titleHref, wikiHref: t.wikiHref})).data("title", r).appendTo(this._w_headers).hide();
    return t.beta && u.append('<span class="beta-sign">Beta<\/span>'), t.packageName && (this._packagesWithTabNames[t.packageName] = n), this._pages[r] = f, this._tabs[r] = u, this._headers[r] = i, t.technical ? (i = this._getOrCreateTechincalTab().find("ul"), i.append(u)) : t.market ? (i = this._getOrCreateMarketTab().find("ul"), i.append(u)) : this._w_market_tabs ? u.insertBefore(this._w_market_tabs) : this._w_tabs.append(u), this._w_pages.append(f), f.toggle(r === this._currentPageTitle), f
};
D1.prototype._getOrCreateMarketTab = function () {
    if (this._w_market_tabs)return this._w_market_tabs;
    var n = TVSettings.getBool(this._MARKET_TAB_IS_OPEN_KEY, !0);
    return this._w_market_tabs = $('<li class="tabs market-tabs"><div class="text open">Marketplace Add-ons<\/div><ul><\/ul><\/li>'), this._w_tabs.append(this._w_market_tabs), this.toggleMarketTabs(n), this._w_market_tabs
};
D1.prototype._getOrCreateTechincalTab = function () {
    if (this._w_technical_tabs)return this._w_technical_tabs;
    var n = TVSettings.getBool(this._TECHNICAL_TAB_IS_OPEN_KEY, !0);
    return this._w_technical_tabs = $('<li class="tabs technical-tabs"><div class="text open">' + $.t("Technical Analysis") + "<\/div><ul><\/ul><\/li>"), this._w_tabs.append(this._w_technical_tabs), this.toggleTechnicalTabs(n), this._w_technical_tabs
};
D1.prototype.hide = function () {
    this._widget.hide();
    this.visibilityChanged.fire(!1);
    TradingView.keyboardBinder.removeListener("StudyMarket");
    var n = D83.dialogs.indexOf(this._widget);
    -1 !== n && D83.dialogs.splice(n, 1)
};
D1.prototype.show = function () {
    this.init();
    this._widget.show();
    this._widget.css("z-index", D83.dialogs.length + 110);
    this._widget.on("mousedownoutside", function (n) {
        $(n.target).parents().andSelf().is(".colorpicker, .charts-popup-list, .tvcolorpicker-popup, .symbol-edit-popup, .tv-dialog-shadowbox, .fancybox-overlay") || (this._widget.unbind("mousedownoutside"), this.hide())
    }.bind(this));
    this._widget.on("keyup.hideDialogStudy", function (n) {
        "27" == n.which && (this._widget.unbind("keyup.hideDialogStudy"), this.hide())
    }.bind(this));
    this._clearInput();
    this.loadFavorites();
    this._scroll.scrollTo(0);
    this.updateLayout(!0);
    this.visibilityChanged.fire(!0);
    this.focusAddSymbolInput(this._currentPageTitle);
    TradingView.keyboardBinder.registerListener("StudyMarket", function (n) {
        return n.ctrlKey || "47" == n.which ? !1 : n.which && 13 === n.which ? (n.target === this._search_input.get(0) && this._insertStudyByShortDescription(), !0) : !n.charCode || !n.which || 32 >= n.which || /^(input|textarea)$/i.test(n.target.tagName) ? !1 : (n.preventDefault(), this._search_input.focus(), this._search_input[0].value = String.fromCharCode(n.charCode), !0)
    }.bind(this));
    D83.dialogs.push(this._widget)
};
D1.prototype.isVisible = function () {
    return!!this._initialized && this._widget.is(":visible")
};
D1.prototype.updateLayout = function (n) {
    var t = this._widget.find(".insert-study-body"), i;
    t.css("height", "");
    this._widget.css("width", "");
    i = D83.calcHeight(this._widget.height(), t.height());
    t.height(i);
    D83.resizeContentWidth(this._widget.width(), this._widget);
    t = this._w_headers.outerHeight(!0);
    i = this._widget.find(".insert-study-main").height();
    this._w_pages.height(i - t);
    var t = Math.min($(window).height(), $("body").height()), i = $(window).width(), r = this._widget.outerWidth(), u = $("body").hasClass("on-cme-widget") ? 10 : 20, f = this._widget.height();
    n && this._widget.css({left: Math.max(0, i - r) / 2, top: Math.max(u, t - f) / 2})
};
D1.prototype.getPage = function (n) {
    return n = n.toLowerCase(), this._pages[n]
};
D1.prototype.focusAddSymbolInput = function (n) {
    n == this._ECONOMY_TAB.toLowerCase() && this.addSymbolWidget.focus()
};
D1.prototype.selectPage = function (n) {
    var t, i;
    if (this.focusAddSymbolInput(n), t = "", "string" == typeof n ? t = n.toLowerCase() : n instanceof $ && (t = n.data("title")), this._currentPageTitle !== t)if (t in this._pages && t in this._tabs && ("favorites" != t || this.hasVisibleFavorites())) {
        for (_title in this._pages)n = t === _title, i = this._pages[_title], this._headers[_title] && this._headers[_title].toggle(n), i.toggle(n), this._tabs[_title].toggleClass("active", n), n && (i.data("html") && (i.html(i.data("html")), i.data("html", null)), i.trigger("show-page"), n = this._tabs[_title].parents(".tabs"), n.is(".technical-tabs") ? this.toggleTechnicalTabs(!0) : n.is(".market-tabs") && this.toggleMarketTabs(!0));
        this._currentPageTitle = t;
        this._w_pages.scrollTop(0);
        this.layoutChanged.fire();
        TVSettings.setValue(this._PAGE_KEY, t)
    } else this.selectPage(this._basicPage)
};
D1.prototype.attachHandlers = function () {
    var n = Modernizr.touch ? "touchend" : "click";
    this._w_tabs.on(n, "li", this.selectThisPage.bind(this));
    this._w_tabs.on(n, "li.market-tabs", this.marketTabsClickHandler.bind(this));
    this._w_tabs.on(n, "li.technical-tabs", this.technicalTabsClickHandler.bind(this));
    J77.enabled("items_favoriting") && (this._w_pages.on(n, ".insert-study-items .fav", this.toggleItem.bind(this)), this.favsChanged.subscribe(this, this.updateFavorites));
    this._w_pages.on(n, ".insert-study-items .source", this.viewSourceCode.bind(this));
    this._w_pages.on(n, ".insert-study-items .open-chart-popup", this.openChartPopup.bind(this));
    this._w_pages.on(n, ".insert-study-items .delete", this.deleteScript.bind(this));
    this._w_pages.on(n, ".insert-study-items li a", function (n) {
        n.stopPropagation()
    });
    this._w_pages.on(n, ".insert-study-items li", this.insertThisStudy.bind(this));
    this._widget.on(n, function (n) {
        n.stopPropagation()
    });
    this._widget.on(n, ".insert-study-subscribe-button", this.subscribePackage.bind(this));
    this.layoutChanged.subscribe(this, this.updateLayout);
    loginStateChange.subscribe(this, this.onLoginStateChange);
    this._w_title.on(n, "a", this.hide.bind(this));
    this._widget.on("click", ".insert-study-offer-info-screenshots", function (n) {
        n.currentTarget.getAttribute("data-fancybox-inited") || (n.currentTarget.setAttribute("data-fancybox-inited", !0), $(this).find("a").fancybox({type: "image", live: !1, afterShow: function () {
            $(".fancybox-overlay").on("click", function (n) {
                n.stopPropagation()
            })
        }}), setTimeout(function () {
            $(n.target).click()
        }, 0));
        n.preventDefault()
    })
};
D1.prototype.selectThisPage = function (n) {
    var t = $(n.currentTarget).data("title");
    t && "search" != t && this.selectPage(t);
    n.stopPropagation()
};
D1.prototype.marketTabsClickHandler = function (n) {
    n.stopPropagation();
    this.toggleMarketTabs()
};
D1.prototype.toggleMarketTabs = function (n) {
    var u = this, t = this._w_market_tabs.find("ul"), r = this._w_market_tabs.find(".text"), i = function () {
        TVSettings.setValue(u._MARKET_TAB_IS_OPEN_KEY, r.hasClass("open"));
        u.layoutChanged.fire()
    };
    "boolean" == typeof n ? n ? (t.is(":visible") ? t.slideDown(50, i) : (t.css("display", "block"), i()), r.addClass("open")) : (t.is(":visible") ? t.slideUp(50, i) : (t.css("display", "none"), i()), r.removeClass("open")) : (r.toggleClass("open"), t.slideToggle(50, i))
};
D1.prototype.technicalTabsClickHandler = function (n) {
    n.stopPropagation();
    this.toggleTechnicalTabs()
};
D1.prototype.toggleTechnicalTabs = function (n) {
    var u = this, t = this._w_technical_tabs.find("ul"), r = this._w_technical_tabs.find(".text"), i = function () {
        TVSettings.setValue(u._TECHNICAL_TAB_IS_OPEN_KEY, r.hasClass("open"));
        u.layoutChanged.fire()
    };
    "boolean" == typeof n ? n ? (t.is(":visible") ? t.slideDown(50, i) : (t.css("display", "block"), i()), r.addClass("open")) : (t.is(":visible") ? t.slideUp(50, i) : (t.css("display", "none"), i()), r.removeClass("open")) : (r.toggleClass("open"), t.slideToggle(50, i))
};
D1.prototype.toggleItem = function (n) {
    return n = $(n.target).parent().data("study"), this.toggleFavorite(n.id), this.toggleEverywhere(n.id), !1
};
D1.prototype.toggleEverywhere = function (n) {
    var t = this.isFavorite(n);
    this._widget.find(".insert-study-items li").filter(function (t, i) {
        var r = $(i).data("study");
        return r ? StudyMetaInfo.cutFullId(r.id) == n : !1
    }).find(".fav").toggleClass("in-fav", t).attr("title", this.favTitle(t))
};
D1.prototype.toggleFavorite = function (n) {
    this.isFavorite(n) ? this.removeFavorite(n) : this.addFavorite(n)
};
D1.prototype.isFavorite = function (n) {
    return n = StudyMetaInfo.cutFullId(n), -1 != this._favs.indexOf(n)
};
D1.prototype.addFavorite = function (n) {
    return(n = StudyMetaInfo.cutFullId(n), this.isFavorite(n)) ? !1 : (this._favs.push(n), this.saveFavorites(), TVXWindowEvents.emit("StudyFavoritesChanged", JSON.stringify(this._favs)), this.favsChanged.fire(), window.is_authenticated && (n = (/^Script\$(PUB;\d+)@tv-scripting/.exec(n) || 0)[1]) && D56.info([n]).done(function (n) {
        n && n[0] && n[0].imageUrl && $.ajax({url: "/vote-for-chart/", type: "POST", dataType: "json", data: {image_url: n[0].imageUrl, vote: 1}})
    }), !0)
};
D1.prototype.removeFavorite = function (n) {
    return n = StudyMetaInfo.cutFullId(n), this.isFavorite(n) ? (this._favs.splice(this._favs.indexOf(n), 1), this.saveFavorites(), TVXWindowEvents.emit("StudyFavoritesChanged", JSON.stringify(this._favs)), this.favsChanged.fire(), !0) : !1
};
D1.prototype.updateFavorites = function () {
    var u = this.getVisibleFavorites(), i, t, r;
    if (0 === u.length)"favorites" === this._currentPageTitle && this.selectPage(this._basicPage), this._widget.find(".insert-study-items li .fav").removeClass("in-fav"), this._tabs.favorites.hide(); else {
        for (var n = this, e = $.Deferred(), f = [], o = [], s = 0; s < u.length; s++)if (i = u[s], t = n.getStudyPackageName({id: i}), t === n._PUBLISHED_STUDIES_PACKAGE_NAME)(i = (/^Script\$([^@]+)/.exec(i) || 0)[1]) && o.push(i); else for (t = n._studies[t] || [], r = 0; r < t.length; r++)if (StudyMetaInfo.cutFullId(t[r].id) == i) {
            f.push(t[r]);
            break
        }
        !o.length || this._options.minimized ? e.resolve(f) : D56.info(o).done(function (t) {
            for (var i = 0; i < t.length; i++)f.push(n._createPublishedScriptMetaInfo(t[i]))
        }).always(function () {
            e.resolve(f)
        });
        e.done(function (t) {
            n.preparePageStudies(n._pages.favorites, t);
            n._widget.find(".insert-study-items li").find(".fav").removeClass("in-fav");
            u.forEach(n.toggleEverywhere, n)
        });
        this._tabs.favorites.show()
    }
};
D1.prototype.hasFavorites = function () {
    return!!this._favs.length
};
D1.prototype.hasVisibleFavorites = function () {
    return!!this.getVisibleFavorites().length
};
D1.prototype.getVisibleFavorites = function () {
    return this.checkExcludePackageStudies(this._favs)
};
D1.prototype.viewSourceCode = function (n) {
    n.stopPropagation();
    this.hide();
    var t = $(n.target).parent().data("study");
    this.studyIsPublishedScript(t) ? window.scriptEditor.show({scriptIdPart: t.scriptIdPart, scriptSource: t.TVScriptSourceCode}) : scriptLib.requestBuiltinAndUserScripts(function (n) {
        for (var i = n.length; i--;)if (n[i].scriptIdPart === t.scriptIdPart) {
            window.scriptEditor.show(n[i]);
            break
        }
    })
};
D1.prototype.openChartPopup = function (n) {
    n.stopPropagation();
    n.preventDefault();
    n = $(n.target).parent().data("study");
    TradingView.historyManager.push(new TradingView.HistoryManager.ChartPage(n.imageUrl, n.scriptName || n.description))
};
D1.prototype.deleteScript = function (n) {
    n.stopPropagation();
    n.preventDefault();
    var i = $(n.target).closest("li"), t = i.data("study");
    D83.showConfirm("Confirmation", "Do you really want to delete script '" + (t.scriptName || t.description) + "'?", function () {
        scriptLib.requestDeleteScript(t.scriptIdPart, function () {
            console.log("deleted");
            i.remove()
        })
    })
};
D1.prototype.checkExcludePackageStudies = function (n) {
    var t = this;
    return n.filter(function (n) {
        var i = this.getStudyPackageName({id: n});
        return i === this._PUBLISHED_STUDIES_PACKAGE_NAME ? !0 : t._studies[i] && 0 < $.grep(t._studies[i], function (t) {
            return n === t.id
        }).length ? i === this._BASIC_STUDIES_PACKAGE_NAME || i === this._CUSTOM_STUDIES_PACKAGE_NAME || i === this._SCRIPTING_PACKAGE_NAME || "Script$EDGR" === i || pro.hasPackage(i) && i in this._studies : !1
    }, this)
};
D1.prototype.sortStudies = function (n) {
    return n.sort(function (n, t) {
        return n = n.scriptName || n.description_localized, t = t.scriptName || t.description_localized, n > t ? 1 : n < t ? -1 : 0
    })
};
D1.prototype.fillStudies = function (n, t, i) {
    n.empty();
    t.forEach(function (t) {
        t ? li = this.createStudyListItem(t, i) : (li = document.createElement("li"), li.className = "placeholder");
        n.append(li)
    }, this)
};
D1.prototype.createStudyListItem = function (n, t) {
    var e = document.createElement("li"), f, s, r, u, h, l;
    $.data(e, "study", n);
    var i = n.description_localized || $.t(n.scriptName || "", {context: "study"}), o = this.isFavorite(n.id), c = [];
    if (t && i)for (f = [], t instanceof RegExp ? f.push({re: t, fuzzyHighlight: !1}) : $.isArray(t) && (f = t), s = 0; s < f.length; s++)if (r = f[s].re, r.lastIndex = 0, r = r.exec(i))if (f[s].fuzzyHighlight)for (u = r.index, h = 1; h < r.length; h++)l = r[h].length, h % 2 && (c[u] = !0), u += l; else for (u = 0; u < r[0].length; u++)c[r.index + u] = !0;
    return i = '<span class="text">' + i.replace(/./g, function (n, t) {
        return"<" === n ? n = "&lt;" : "&" === n ? n = "&amp;" : '"' === n && (n = "&quot;"), c[t] && (n = '<span class="match">' + n + "<\/span>"), n
    }) + "<\/span>", J77.enabled("items_favoriting") && (i = '<span class="fav' + (o ? " in-fav" : "") + ' apply-common-tooltip" title="' + this.favTitle(o) + '"><\/span>' + i), n.author && n.author.username && (i += '<span class="author"><a href="/u/' + n.author.username + '" target="_blank">' + n.author.username + "<\/a><\/span>"), n.agreeCount && (i += '<span class="agrees apply-common-tooltip" title="Total agrees">' + n.agreeCount + " like" + (1 < n.agreeCount ? "s" : "") + "<\/span>"), o = n.TVScriptSourceCode && (0 === n.id.indexOf(this._PUBLISHED_STUDIES_PACKAGE_NAME) || 0 === n.id.indexOf(this._CUSTOM_STUDIES_PACKAGE_NAME)), !TradingView.isMobileView && o && (e.className = "custom-script", i += '<span class="source apply-common-tooltip" title="Source code">{}<\/span>'), J77.enabled("graying_disabled_tools_enabled") && Q16.studiesAccessController.isToolGrayed(n.description) && (e.className += " grayed"), n.imageUrl ? i += '<div class="open-chart-popup apply-common-tooltip" title="Read more...">...<\/div>' : o && window.scriptLib && (i += '<div class="delete apply-common-tooltip" title="Delete script"><i><\/i><\/div>'), e.innerHTML = i, e
};
D1.prototype.favTitle = function (n) {
    return n ? $.t("Remove from favorites") : $.t("Add to favorites")
};
D1.prototype.insertThisStudy = function (n) {
    if (n = $(n.target).closest("li"), !n.hasClass("placeholder")) {
        var t = n.data("study");
        if (J77.enabled("graying_disabled_tools_enabled") && Q16.studiesAccessController.isToolGrayed(t.description))Q17.emit("onGrayedObjectClicked", {type: "study", name: t.description}); else return n.highlight(this.HIGHLIGHT_STUDY_NUM_FLICKS), this.insertStudy(t), !1
    }
};
D1.prototype.insertStudy = function (n) {
    var t = this.Q5.activeChartWidget.value();
    t && (n = StudyMetaInfo.replaceWithFullStudyMetaInfo(t.model().studiesMetaData(), n), t.insertStudyOrShowDialog(n), this._is_on_chart = !0)
};
D1.prototype.subscribePackage = function (n) {
    (n = $(n.target).closest(".insert-study-pages > div").data("offer")) && TradingView.visitPaymentPage(n.id)
};
D1.prototype.onLoginStateChange = function (n) {
    n || this.setUser(window.user)
};
D1.prototype.getStudyList = function (n) {
    if (!this.studiesReady.isResolved())return[];
    var t = [];
    for (var i in this._studies)(i == this._BASIC_STUDIES_PACKAGE_NAME || pro.hasPackage(i)) && (this._studies[i].forEach(function (n) {
        t.push(n)
    }), n && t.push({separator: !0}));
    return n && t.splice(t.length - 1, 1), t
};
D1.prototype.getStudyPackageName = function (n) {
    if (n && n.id) {
        var t = StudyMetaInfo.getPackageName(n.id);
        return t !== this._SCRIPTING_PACKAGE_NAME ? t : (n = n.id.split("@")[0], 0 !== n.indexOf("Script$")) ? t : (t = n.indexOf("_"), -1 !== t ? n.substring(0, t) : /^Script\$USER;/.test(n) ? "Script$USER" : /^Script\$PUB;/.test(n) ? "Script$PUB" : /^Script\$STD;/.test(n) ? this._BASIC_STUDIES_PACKAGE_NAME : n)
    }
};
D1.prototype.studyIsUserTVScript = function (n) {
    if (n && n.id)return"Script$USER" === this.getStudyPackageName(n)
};
D1.prototype.studyIsPublishedScript = function (n) {
    if (n && n.id)return"Script$PUB" === this.getStudyPackageName(n)
};
D1.prototype.selectSearchPage = function () {
    this.selectPage("search");
    this._clearInput()
};
D1.prototype._insertStudyByShortDescription = function () {
    for (var n, i = this._search_value, i = i.trim(), r = this._studies[this._BASIC_STUDIES_PACKAGE_NAME], t = 0; t < r.length; t++)if (n = r[t], n.shortDescription && n.shortDescription.toUpperCase() === i.toUpperCase()) {
        this.insertStudy(n);
        break
    }
};
D1.prototype._clearInput = function () {
    this._search_input.val("");
    "search" === this._currentPageTitle && this._search_input.val("").trigger("input").focus()
};
D1.prototype._loadNextPubSearchPage = function () {
    var n = this, t;
    return n._pubSearchDfd ? n._pubSearchDfd : (t = n._pubSearchPage + 1, n._pubSearchDfd = D56.suggest(void 0, t), n._pubSearchDfd.done(function (i) {
        n._pubSearchPageMax = i.max_offset;
        n._pubSearchPage = t;
        n._pubSearchEntries = n._pubSearchEntries.concat(i.results || [])
    }), n._pubSearchDfd.always(function () {
        delete n._pubSearchDfd
    }), n._pubSearchDfd)
};
D1.prototype._onExternalFavoritesChanged = function (n) {
    for (var r, t = [], i = 0; i < n.length; i++)r = StudyMetaInfo.cutFullId(n[i]), -1 === t.indexOf(r) && t.push(r);
    this._favs = t;
    this.saveFavorites();
    this.favsChanged.fire()
};
TradingView.deleteStudyTemplate = function (n, t) {
    TradingView.getStudyTemplatesList.Q20();
    $.post("/remove-study-template/", {name: n}, t)
};
D65 = function (n) {
    this._options = n || {};
    this.Q5 = this._options.Q6;
    this._SAVE_AS_TITLE = "Save Study Template As...";
    this._list = [];
    this._favoredList = this._$wrapper = null;
    this._loaded = !1;
    this._onFirstLoad = new Delegate;
    this.onFavoriteListResize = new Delegate
};
D65.prototype.appendMenuButtonTo = function (n) {
    n && (this._$wrapper = n, this._generateFavoriteList())
};
D65.prototype.refreshStudyTemplateList = function (n) {
    var t = this;
    TradingView.getStudyTemplatesList(function (i) {
        t._list = i || [];
        "function" == typeof n && n()
    })
};
D65.prototype._generateFavoriteList = function () {
    var n = this;
    this._favoredList = new D14("StudyTemplates", n._listPreparedForFavorite(), {addClass: "study-template-widget", popupAddClass: "study-template-popup", notShowActive: !0, popupSpacing: this._options.popupSpacing, notShowQuicks: this._options.notShowQuicks, tooltip: "Study Templates", addTooltipClass: "apply-common-tooltip"});
    this._favoredList.element().appendTo(this._$wrapper);
    this._favoredList.onSelect().subscribe(n, function (n) {
        n != this._SAVE_AS_TITLE && this.applyStudyTemplate(n)
    });
    this._favoredList.onSelect().subscribe(n, function (n) {
        n === this._SAVE_AS_TITLE && this.showSaveAsDiaolg()
    });
    this._favoredList.onResize().subscribe(n.Q5, n.Q5.updateLayout);
    this._favoredList.onResize().subscribe(this.onFavoriteListResize, this.onFavoriteListResize.fire);
    this._favoredList.onOpen().subscribe(n, function () {
        n.refreshFavoriteDropdownMenu()
    })
};
D65.prototype._listPreparedForFavorite = function (n) {
    var t = this;
    n = this.plainList("default");
    var r = this.plainList("custom"), i = [
        {id: t._SAVE_AS_TITLE, title: t._SAVE_AS_TITLE, addClass: "special", toQuickButtonStyle: {display: "none"}},
        {separator: !0}
    ], u = function (n, i) {
        return $.map(n, function (n) {
            var r = {id: n, title: n, favoriteButton: {icon: {}, title: n, addClass: "apply-common-tooltip"}};
            return i && (r.drop = function () {
                this.deleteStudyTemplate(n)
            }.bind(t)), r
        })
    };
    return r.length && (i = i.concat(u(r, !0)).concat([
        {separator: !0}
    ])), i.concat(u(n))
};
D65.prototype.applyStudyTemplate = function (n) {
    var t = this.Q5.activeChartWidget.value();
    TVSettings.setValue("defaultStudyTemplate", n);
    $.get("/study-template/?templateName=" + encodeURIComponent(n), function (i) {
        TradingView.trackEvent("GUI", "Load Study Template");
        t.model().model().restoreStudyTemplate(JSON.parse(i.content), n)
    })
};
D65.prototype.showSaveAsDiaolg = function () {
    var n = this, t = this.Q5.activeChartWidget.value(), i = function (i, r) {
        i = clean(i);
        var u = r[0], u = JSON.stringify(t.model().model().studyTemplate(u)), f = {name: i, content: u}, u = function () {
            $.post("/save-study-template/", f, function (t) {
                t.error || (TVSettings.setValue("defaultStudyTemplate", i), TradingView.getStudyTemplatesList.Q20(), n.refreshFavoriteDropdownMenu())
            }).error(function (n) {
                console.error(n.responseText)
            })
        };
        -1 != $.inArray(i, n.plainList()) ? D83.showConfirm("Confirm replace", 'Do you realy want to replace "' + i + "\"?<br><small>Note: default study templates won't be removed permanently<\/small>", u) : u()
    }, r = function (t) {
        n.refreshStudyTemplateList(function () {
            t.find('[name="name"]').inputselectable({list: n.plainList().sort(), closeHandle: t})
        })
    };
    runOrSignIn(function () {
        TradingView.showChartNameDialog(i, "Save new study template", "Template name", 255, [
            {title: "Save Interval", name: "save_interval", type: "bool", hint: 'When selecting this checkbox the study template will set "' + t.model().model().mainSeries().interval() + '" interval on a chart'}
        ], r)
    }, !0)
};
D65.prototype.refreshFavoriteDropdownMenu = function () {
    var t = this, n = this._favoredList;
    n && t.refreshStudyTemplateList(function () {
        n.reload(t._listPreparedForFavorite());
        n._container.hasClass("active") && (n._container.trigger("click"), n._openMenu.call(n))
    })
};
D65.prototype.deleteStudyTemplate = function (n) {
    var t = this, i = "Do you realy want to delete " + (n ? '"' + n + '"' : "") + " study template?";
    runOrSignIn(function () {
        D83.showConfirm("Study Template", i, function () {
            TradingView.deleteStudyTemplate(n, function () {
                setTimeout(function () {
                    t.refreshFavoriteDropdownMenu()
                }, 0)
            })
        })
    })
};
D65.prototype.container = function () {
    return this._favoredList ? this._favoredList._container : null
};
D65.prototype.list = function () {
    return this._list
};
D65.prototype.plainList = function (n) {
    return"default" === n ? $.map(jQuery.grep(this._list, function (n) {
        return!!n.is_default
    }), function (n) {
        return n.name
    }) : "custom" === n ? $.map(jQuery.grep(this._list, function (n) {
        return!n.is_default
    }), function (n) {
        return n.name
    }) : $.map(this._list, function (n) {
        return n.name
    })
};
Action = function (n) {
    n || (n = {});
    this.checkable = n.checkable || !1;
    this.checked = n.checked || null;
    this.enabled = void 0 == n.enabled ? !0 : n.enabled;
    this.visible = n.visible || !0;
    this.font = n.font || "Arial";
    this.icon = n.icon || null;
    this.iconText = n.iconText || null;
    this.iconVisibleInMenu = n.iconVisibleMenu || !0;
    this.deleteButton = n.deleteButton || null;
    this.shortcut = null;
    this.setShortCut(n.shortcut);
    this.statusTip = n.statusTip || null;
    this.text = n.text || null;
    this.toolTip = n.toolTip || null;
    this.htmlclass = n.htmlclass || null;
    this._callbackContext = n.callbackContext || this;
    this._callbacks = new Delegate;
    this.subActions = n.subActions || []
};
Action.prototype.callbacks = function () {
    return this._callbacks
};
Action.prototype.callbackContext = function () {
    return this._callbackContext
};
Action.prototype.setCallbackContext = function (n) {
    this._callbackContext = n
};
Action.prototype.hasSubActions = function () {
    return this.subActions && this.subActions.length
};
Action.prototype.setChecked = function (n) {
    this.checked = n
};
Action.prototype._toggleChecked = function () {
    this.checked = !this.checked
};
Action.prototype.setVisible = function (n) {
    this.visible = n
};
Action.prototype.setEnabled = function (n) {
    this.enabled = n
};
Action.prototype.disable = function () {
    this.setEnabled(!1)
};
Action.prototype.enable = function () {
    this.setEnabled(!0)
};
Action.prototype.setShortCut = function (n) {
    n && (this.shortcut = n, this._bindShortCut())
};
Action.prototype._bindShortCut = function () {
    var n = this, t = "." + this.shortcut;
    $(document).unbind(t);
    $(document).bind("keydown" + t, this.shortcut, function (t) {
        return t.preventDefault(), n.enabled ? (n.executeCallback(), !1) : void 0
    })
};
Action.prototype.setIconVisible = function (n) {
    this.iconVisibleInMenu = n
};
Action.prototype.executeCallback = function (n) {
    this._lastEvent = n;
    this._toggleChecked();
    this._callbacks.fire(this)
};
ActionSeparator = function () {
    Action.call(this);
    this.subActions = this.font = null;
    this.htmlclass = "action-separator"
};
inherit(ActionSeparator, Action);
ActionPlaceholder = function (n) {
    Action.call(this);
    this.deferred = n
};
inherit(ActionPlaceholder, Action);
ContextMenu = {INSERT_AT_END: 0, INSERT_AT_START: 1, INSERT_AT_POS: 2, WRAPPER_TAG: "div", WRAPPER_ATTRIBUTES: {"class": "context-menu-wrapper"}, MENU_TAG: "table", ITEM_ROW_TAG: "tr", ICON_CELL_TAG: "td", TEXT_CELL_TAG: "td", RIGHT_CELL_TAG: "td", SUBMENU_CELL_TAG: "td", instances: [], createMenu: function (n, t, i) {
    return n = new ContextMenu.Menu(n, t, i), this.instances.push(n), n
}, createMenuFromActions: function (n, t) {
    var i = new ContextMenu.Items(n, t);
    return this.instances.push(i), i
}, hideAll: function () {
    for (instance in this.instances)this.instances[instance].hide()
}}, function () {
    function n(t) {
        return null == t._parentMenu ? null : (t = t._parentMenu, null == t._parentMenuItem ? t : n(t._parentMenuItem))
    }

    ContextMenu.Item = function (n, t) {
        this.action = n;
        this._parentMenu = t
    };
    ContextMenu.Item.prototype._createIconTag = function () {
        var n = this._iconTagAttributes();
        return this.jqIcon = HTMLHelper.Element.create(ContextMenu.ICON_CELL_TAG, n), this.jqIcon.addClass("context-menu"), this.jqIcon
    };
    ContextMenu.Item.prototype._createDeleteButton = function () {
        if (!this.action.deleteButton)return null;
        var i = this, n = this.action.deleteButton.action, t = HTMLHelper.Element.create("span", {"class": "context-menu-delete-button"});
        n && t.click(function () {
            return n.call(i), !1
        });
        this.jqSubmenu.addClass("delete-spacer");
        this.jqSubmenu.append(t)
    };
    ContextMenu.Item.prototype._createTextTag = function () {
        var n = this._textTagAttributes();
        return this.jqText = HTMLHelper.Element.create(ContextMenu.TEXT_CELL_TAG, n), this.jqIcon.addClass("context-menu"), this.jqText
    };
    ContextMenu.Item.prototype._createRightTag = function () {
        var n = this._rightTagAttributes();
        return this.jqRight = HTMLHelper.Element.create(ContextMenu.RIGHT_CELL_TAG, n), this.jqIcon.addClass("context-menu"), this.jqRight
    };
    ContextMenu.Item.prototype._createSubmenuTag = function () {
        var n = this._submenuTagAttributes();
        return this.jqSubmenu = HTMLHelper.Element.create(ContextMenu.SUBMENU_CELL_TAG, n), this.jqIcon.addClass("context-menu"), this.jqSubmenu
    };
    ContextMenu.Item.prototype._iconTagAttributes = function () {
        var t = {}, n = [];
        return this.action && (this.action.icon ? (n.push("icon"), n.push(this.action.icon.replace(/\./, "_"))) : this.action.checkable ? (n.push("icon"), this.action.checked ? n.push("checked-icon") : n.push("unchecked-icon")) : n.push("spacer")), t["class"] = n.join(" "), t
    };
    ContextMenu.Item.prototype._textTagAttributes = function () {
        return{"class": "text", html: this.action ? this.action.text : ""}
    };
    ContextMenu.Item.prototype.highlight = function (n) {
        n ? (this.jqRow.addClass("context-menu-hover"), this.jqIcon.addClass("context-menu-hover")) : (this.jqRow.removeClass("context-menu-hover"), this.jqIcon.removeClass("context-menu-hover"));
        this.action && this.action.hasSubActions() && (n ? this.jqSubmenu.addClass("expanded") : this.jqSubmenu.removeClass("expanded"))
    };
    ContextMenu.Item.prototype._rightTagAttributes = function () {
        var n = {}, t = ["right"];
        return this.action && this.action.shortcut && (t.push("shortcut"), n["class"] = t.join(" "), n.html = this.action.shortcut), n
    };
    ContextMenu.Item.prototype._submenuTagAttributes = function () {
        var n = {};
        return n["class"] = this.action && this.action.hasSubActions() ? "submenu-arrow" : "context-menu spacer", n
    };
    ContextMenu.Item.prototype.render = function () {
        this._createRow();
        this.jqRow.append(this._createIconTag());
        this.jqRow.append(this._createTextTag());
        this.jqRow.append(this._createRightTag());
        this.jqRow.append(this._createSubmenuTag());
        this._createDeleteButton();
        this.appendCallback();
        var n = this;
        return this.jqRow.mouseenter(function (t) {
            n.showSubmenu(t);
            n.highlight(!0);
            n._parentMenu && n._parentMenu._parentMenuItem && n._parentMenu._parentMenuItem.highlight(!0)
        }), this.jqRow.mouseleave(function () {
            n.highlight(!1)
        }), this.jqRow
    };
    ContextMenu.Item.prototype._createRow = function () {
        var i = this._rowTagAttributes(), t, n;
        this.jqRow = HTMLHelper.Element.create(ContextMenu.ITEM_ROW_TAG, i);
        this.jqRow.addClass("context-menu");
        t = this;
        this.action && !this.action.hasSubActions() && (n = function (t) {
            t.destroy();
            t._parentMenuItem && n(t._parentMenuItem._parentMenu)
        }, this.jqRow.click(function () {
            n(t._parentMenu)
        }))
    };
    ContextMenu.Item.prototype.showSubmenu = function (n) {
        this._parentMenu.closeOtherSubmenus(this);
        (!this.action || this.action.hasSubActions()) && (this._menu || (this._menu = ContextMenu.createMenu(this.action.subActions, null, this)), this.jqRow.position(), this.jqRow.height(), this.jqRow.width(), this.jqRow.offset(), n.pageX = this._parentMenu.jqMenu.width() - 2, n.pageY = this.jqSubmenu.offset().top - this._parentMenu.jqMenu.offset().top - 1, this._menu.show(n, this._parentMenu.jqMenu))
    };
    ContextMenu.Item.prototype._rowTagAttributes = function () {
        var n = [];
        return this.action && (!1 === this.action.enabled && n.push("disabled"), !1 === this.action.visible && n.push("hidden"), this.action.font && n.push("font_" + this.action.font), this.action.hasSubActions() && n.push("has_submenu"), this.action.htmlclass && n.push(this.action.htmlclass)), {"class": n.join(" ")}
    };
    ContextMenu.Item.prototype.appendCallback = function () {
        var n = this;
        this.jqRow.click(function (t) {
            n.action.enabled && n.action.executeCallback(t)
        })
    };
    ContextMenu.Item.prototype.getTopLevelMenu = function () {
        return n(this)
    };
    ContextMenu.ItemPlaceholder = function (n, t) {
        this.action = n;
        this._parentMenu = t
    };
    ContextMenu.ItemPlaceholder.prototype.render = function (n) {
        this._createRow();
        var t = this;
        return this.action.deferred.then(function (i) {
            var r, u;
            for (r in i)u = t._parentMenu.addItem(i[r]), ContextMenu.Menu.renderItem(n, u)
        }).always(function () {
            t.jqRow.hide()
        }), this.jqRow
    };
    ContextMenu.ItemPlaceholder.prototype._createIconTag = function () {
        var n = this._iconTagAttributes();
        return this.jqIcon = HTMLHelper.Element.create(ContextMenu.ICON_CELL_TAG, n), this.jqIcon.addClass("context-menu"), this.jqIcon
    };
    ContextMenu.ItemPlaceholder.prototype._createRow = function () {
        var n = this._rowTagAttributes();
        this.jqRow = HTMLHelper.Element.create(ContextMenu.ITEM_ROW_TAG, n);
        this.jqRow.append(this._createIconTag());
        this.jqRow.addClass("context-menu")
    };
    ContextMenu.ItemPlaceholder.prototype._rowTagAttributes = function () {
        var n = [];
        return this.action && n.push("spinner"), {"class": n.join(" ")}
    };
    ContextMenu.ItemPlaceholder.prototype.highlight = function () {
    };
    ContextMenu.ItemPlaceholder.prototype._iconTagAttributes = function () {
        var n = {}, t = [];
        return t.push("spacer"), n["class"] = t.join(" "), n.colspan = "10", n
    }
}(jQuery), function (n) {
    function t(n) {
        var r = [], i;
        for (n = n.m_items, i = 0; i < n.length; i++)n[i]._menu && (r.push(n[i]._menu), r = r.concat(t(n[i]._menu)));
        return r
    }

    ContextMenu.Menu = function (t, i, r) {
        this.options = {};
        this._parentMenuItem = r;
        n.extend(this.options, i);
        this.options["class"] && (this.options.attributes["class"] = this.options["class"]);
        this.m_wrapper = this.jqMenu = null;
        this.m_items = [];
        for (var u in t)this.addItem(t[u])
    };
    ContextMenu.Menu.prototype.addItem = function (n) {
        return n = n instanceof ActionPlaceholder ? new ContextMenu.ItemPlaceholder(n, this) : new ContextMenu.Item(n, this), this.m_items.push(n), n
    };
    ContextMenu.Menu.renderItem = function (n, t) {
        n.append(t.render(n))
    };
    ContextMenu.Menu.prototype.closeOtherSubmenus = function (n) {
        for (n = 0; n < this.m_items.length; ++n)this.m_items[n].highlight(!1), this.m_items[n]._menu && (this.m_items[n]._menu.destroy(), this.m_items[n]._menu = null)
    };
    ContextMenu.Menu.prototype.isShown = function () {
        return null !== this.jqMenu
    };
    ContextMenu.Menu.prototype.render = function () {
        var t = this.getAttributes(), i, r;
        if (this._parentMenuItem) {
            this.jqMenu = t = n("<table>");
            t.attr("cellspacing", "0");
            t.attr("cellpadding", "0");
            t.addClass("context-menu");
            t.addClass("submenu");
            for (i in this.m_items)r = this.m_items[i], ContextMenu.Menu.renderItem(t, r)
        } else for (i in this.jqMenu = t = HTMLHelper.Element.create(ContextMenu.MENU_TAG, t), this.m_items)r = this.m_items[i], ContextMenu.Menu.renderItem(t, r);
        return this.jqMenu
    };
    ContextMenu.Menu.prototype.getAttributes = function () {
        var n = {}, t = ["context-menu"];
        return this.options.attributes && this.options.attributes["class"] && t.push(this.options.attributes["class"]), n.cellspacing = 0, n.cellpadding = 0, n["class"] = t.join(), n
    };
    ContextMenu.Menu.prototype.deploy = function (t, i) {
        return this.jqMenu = this.wrapper().append(this.render()), i ? (n(i).data("submenu", this.jqMenu), n(document.body).append(this.jqMenu), this.jqMenu.data("parent-menu", i), this.jqMenu.data("parent-item", t.currentTarget)) : n(document.body).append(this.jqMenu), HTMLHelper.unbindContextMenu(this.jqMenu), this._setCoords(t), this.jqMenu
    };
    ContextMenu.Menu.prototype.show = function (n, t) {
        this.deploy(n, t).show()
    };
    ContextMenu.Menu.prototype.hide = function () {
        this.isShown() && this.destroy()
    };
    ContextMenu.Menu.prototype.destroy = function () {
        n.each(this.m_items, function (n, t) {
            t._menu && t._menu.destroy()
        });
        this.jqMenu && (this.jqMenu.remove(), this.jqMenu = null);
        this.m_wrapper.empty()
    };
    ContextMenu.Menu.prototype._setCoords = function (t) {
        var u = this.jqMenu, o, i;
        n(this.jqMenu.data("parent-menu"));
        var r = n(this.jqMenu.data("parent-item")), f = n(window).width(), e = Math.min(n(window).height(), n("body").height()), s = n(document).scrollTop(), h = n(document).scrollLeft();
        for (this.jqMenu.css({maxWidth: f - 10, maxHeight: e - 10}), o = u.outerWidth(), u = u.outerHeight(), r.size() ? (i = r.offset(), i = {top: i.top - 1, left: i.left + r.outerWidth()}) : i = {top: t.pageY, left: t.pageX}, this.jqMenu.offset(i), r = {}, r.top = Math.min(i.top, e + s - u - 5), r.left = Math.min(i.left, f + h - o - 5), t = t.target; t && t !== document; t = t.parentNode)if ("fixed" === n(t).css("position")) {
            this.jqMenu.css("position", "fixed");
            break
        }
        this.jqMenu.offset(r)
    };
    ContextMenu.Menu.prototype._wrapper = function () {
        var i = this, r = ContextMenu.WRAPPER_ATTRIBUTES;
        return this._parentMenuItem ? this.m_wrapper = HTMLHelper.Element.create(ContextMenu.WRAPPER_TAG, r) : (this.m_wrapper = HTMLHelper.createPopup(r, void 0, {mouseDownOutsideEvent: function (r) {
            var u = n();
            n.each(t(i), function () {
                u = u.add(this.m_wrapper)
            });
            n(r.target).parents().andSelf().is(u) || i.hide()
        }}), this.m_wrapper.addClass("topmenu")), this.m_wrapper
    };
    ContextMenu.Menu.prototype.wrapper = function () {
        return this.m_wrapper || this._wrapper()
    }
}(jQuery);
TradingView._defaultChartSymbol = "FX:SPX500";
D7 = function (n) {
    var u = this, t;
    this._startSpinner(n.jqParent);
    TradingView.drawingState.init();
    t = this;
    TradingView.drawingState.tool.subscribe(function (n) {
        var i, r;
        t.Q0 && (t.Q0.model().setCurrentTool(n), TradingView.isMobile.any() && (i = t._paneWidgets[0], J47.isLineTool(n) && "LineToolBrush" !== n ? (n = .5 * t.Q0.model().timeScale().width(), r = .5 * i._state.defaultPriceScale().height(), t.Q0.model().setCurrentPosition(n, r, i._state), i._updateTooltip(n, r)) : i._hideTooltip()), t.Q0 && TradingView.isMobile.any() && t.Q0.model().crossHairSource().updateAllViews())
    });
    this._options = n = n || {};
    var e = n.jqParent, c = n.sizeFunc, l = n.content, o = n.readOnly, a = n.containsData, v = n.onWidget, y = n.onCmeWidget, f = n.timezone, s = n.withDateRanges, p = n.hideSymbolSearch, r = n.defSymbol, i = n.defInterval, h = -1 !== $.inArray(n.defStyle, $.map($.grep(Object.keys(TradingView.Series), function (n) {
        return/^STYLE_\w+/.test(n)
    }), function (n) {
        return TradingView.Series[n]
    })) ? n.defStyle : void 0;
    this.Q5 = n.Q6 || null;
    this._withDateRanges = ("undefined" == typeof s ? !o : !!s) && J77.enabled("timeframes_toolbar");
    this._jqParent = void 0 !== e ? e : $(document.body);
    this._setContent(l);
    this._readOnly = o;
    this._containsData = a;
    this._defSymbol = r;
    this._defInterval = i;
    this._defStyle = h;
    this._onCmeWidget = (this._onWidget = !!v) ? !!y : !1;
    this._sizeFunc = c || function () {
        var n = u._jqParent.width(), t = u._jqParent.height() - (u._withDateRanges ? 22 : 0);
        return new TradingView.Rect(0, 0, n, t)
    };
    this._hideSymbolSearch = p;
    this._jqMainDiv = null;
    this._rect = this._sizeFunc();
    this._jqMainTable = null;
    this._paneWidgets = [];
    this._paneSeparators = [];
    this._timeAxisWidget = null;
    this._frameTime = 30;
    this.Q0 = null;
    this._metaInfo = {};
    (n = this._contentSeriesProperties()) && (r = n.symbol, i = n.interval);
    !D21 || D21.isMinute(i) || D21.isDWM(i) || (i = void 0);
    this.Q2 = new _52("chartproperties");
    this.Q2.mainSeriesProperties.merge(defaults("chartproperties.mainSeriesProperties"));
    this.Q2.mainSeriesProperties.merge({visible: !0, symbol: r ? r : TradingView._defaultChartSymbol, shortName: "", timeframe: "", onWidget: this._onWidget, interval: i || "D", style: h, lineStyle: {styleType: factoryDefaults("chartproperties.mainSeriesProperties.lineStyle.styleType")}});
    this._containsData && this.Q2.mainSeriesProperties.merge({showCountdown: !1});
    f && TradingView.timezoneIsAvailable(f) && this.Q2.timezone.setValue(f);
    this.onCmeWidget() && this.Q2.timezone.setValue("exchange");
    this._tagsChanged = new Delegate;
    this._modelCreated = new Delegate;
    this._disconnected = new Delegate;
    this._reconnectBailout = new Delegate;
    this._connected = new Delegate;
    this._redrawPanes = new Delegate;
    this.chartWidgetInitialized = new Delegate;
    this._studiesMetaData = new List;
    this._studiesMigrations = new List;
    this._chartSession = new ChartSession(Q16);
    this.lhsPriceAxisWidthChanged = new Delegate;
    this.rhsPriceAxisWidthChanged = new Delegate;
    this.createLogo = null
};
D7.prototype.refreshMarks = function () {
    this.model().barsMarksSources().map(function (n) {
        n.refreshData()
    })
};
D7._nextMetadataId = 1;
D7.prototype._onStudiesMetadata = function (n) {
    var u = this, r, t, i;
    if ("studies_metadata" === n.method) {
        for (this._studiesMigrations = new List, r = n.params[1].migrations, i = 0; r && i < r.length; i++)this._studiesMigrations.append(r[i]);
        for (t = n.params[1].metainfo, i = 0; i < t.length; i++)D0._fixInputsMaxValue(null, t[i]);
        for (i = 0; i < t.length; i++)_applyLocalizationToMetadata(t[i]);
        t = t.concat(this.privateMetaInfo(TradingView.FundamentalsGenerator));
        t = t.concat(this.privateMetaInfo(TradingView.EotProGenerator));
        TradingView.Q18("alerts") && !u.onWidget() && this._setAlertsStudiesList(t);
        void 0 != PineAddons ? (n = D7._filterAuthorizedMetaInfo(PineAddons.TimWestStudiesMetaInfo), t = t.concat(n), n = D7._filterAuthorizedMetaInfo(PineAddons.SpyderCrusherStudiesMetaInfo), t = t.concat(n), n = D7._filterAuthorizedMetaInfo(PineAddons.AlphaLabStudiesMetaInfo), t = t.concat(n), n = PineAddons.ESDMetaInfo, t = t.concat(n)) : console.error("PineAddons is undefined. All Pine Script products will be unavailable");
        (n = this._tvScriptsRequestDfd) || (n = $.Deferred().resolve([]));
        n.done(function (n) {
            u._onScriptSources(n, t)
        })
    }
};
D7.prototype._setAlertsStudiesList = function (n) {
    this._alertsStudiesList = $.map($.grep(n, function (n) {
        n = n.plots || [];
        for (var t = 0; t < n.length; t++)if ("line" === n[t].type)return!0;
        return!1
    }), function (n) {
        return n.id
    })
};
D7.prototype.canCreateAlertForDataSource = function (n) {
    function t(n) {
        var t, i, r, u;
        if (n instanceof D58 && (n = n.bars()), n instanceof PlotList && (n = n.state().data), !$.isArray(n))return!0;
        for (t = n.length - 1; 0 <= t; t--) {
            if (i = n[t], !$.isArray(i.value))return!0;
            for (r = i.value.length - 1; 0 < r; r--)if (u = i.value[r], null !== u && void 0 !== u && !isNaN(u))return!0
        }
        return!1
    }

    if (this.onWidget() || !J77.enabled("alerts") || !TradingView.Q18("alerts"))return!1;
    var i = n === this.Q0.mainSeries(), r = n instanceof TradingView.Study, u = n && n.data && n.data() && n.data().isEmpty && !n.data().isEmpty() && t(n.data()), f = n.metaInfo && n.metaInfo() && n.metaInfo().isTVScript, e = n.metaInfo && n.metaInfo() && -1 != $.inArray(n.metaInfo().fullId, this._alertsStudiesList);
    return n.uniqueId && n.uniqueId() && (i || r && u && (f || e))
};
D7._filterAuthorizedMetaInfo = function (n) {
    for (var r, u, i = [], t = 0; t < n.length; ++t)r = n[t], u = StudyMetaInfo.parseIdString(r.id).productId, pro.hasPackage(u) && i.push(r);
    return i
};
D7.prototype.privateMetaInfo = function (n) {
    return n ? new n(StudyMetaInfo.CURRENT_METAINFO_FORMAT_VERSION).generateMetaInfo() : []
};
D7.prototype._onScriptSources = function (n, t) {
    var r, i, u, f, e;
    if (!this.onWidget()) {
        for (r = null, i = 0; i < t.length; ++i)if (u = t[i], u.id.startsWith("Script@tv-scripting-")) {
            r = StudyMetaInfo.parseIdString(u.id).version;
            break
        }
        if (null != r)for (this.studyScriptingPkgVers = r, i = 0; i < n.length; ++i)try {
            f = n[i].scriptName;
            TradingView.logDebug("Loading script: '" + f + "'.");
            e = StudyMetaInfo.createMetaInfoStub(n[i], r);
            t.push(e)
        } catch (o) {
            console.error("Could not process script (skipped): " + f + " (" + o.message + ")")
        } else console.error("Could not find tv-scripting package in metadata response")
    }
    for (i = 0; i < t.length; i++)StudyMetaInfo.addStudyMetaInfo(this._studiesMetaData, t[i]);
    StudyMetaInfo.sortStudiesMetainfo(this._studiesMetaData);
    this._init();
    this.chartWidgetInitialized.fire()
};
D7.prototype._init = function () {
    var n = this;
    !this._containsData && this._content && this._content.timeScale && !this._content.timeScale.m_lastVisibleBar && (this._content.timeScale.m_rightOffset = this.Q2.timeScale.rightOffset.value());
    this.initColors();
    this._makeDefaultGui();
    this._makeDefaultModel();
    this._chartSession && this._chartSession.connected() && this.Q0.restart();
    this._content && (this.initColors(), this._updateGui(), this.update());
    n.Q0.mainSeries().marketStatus.subscribe(function (t) {
        n.indicatorImage && n._updateDataAndMarketStatus(t, n.Q0.mainSeries().status())
    }, {callWithLast: !0});
    this._resizeHandler = function () {
        this._rect = this._sizeFunc();
        TradingView.setAbsoluteRect(this._jqMainDiv, this._rect);
        this._adjustSize();
        this.Q0 && this.Q0.mainSeries().requestMoreData();
        this.paint()
    }.bind(this);
    this._resizeHandler();
    this._jqMainDiv.appendTo(this._jqParent);
    this._spinner && (this._spinner.stop(), delete this._spinner);
    $(window).keydown(function (n) {
        27 == n.which && n.preventDefault()
    });
    this._containsData || this._jqMainDiv.mousewheel(function (n, t, i, r) {
        if (!(!TradingView.onWidget() && parent && parent !== window && parent.IS_DEMO_PAGE || !this.model() || this.noScroll || this.model().timeScale().isEmpty())) {
            n = n.pageX - 5;
            t = this._paneWidgets[0].lhsPriceAxisWidget.size.w;
            var u = this._timeAxisWidget.size.w;
            return t && (n = Math.max(0, n - t)), n = Math.min(n, u), n = J77.enabled("right_bar_stays_on_scroll") ? 1 : 2 * (n / u - .5), t = Math.min(1, Math.abs(r)), 0 < r ? this.model().zoomIn(n, t) : 0 > r && this.model().zoomOut(n, t), i && this.model().scrollChart(-80 * i), !1
        }
    }.bind(this));
    this._initBarsMarksSources();
    TradingView.Q18("esdindicatorfeature") && this.initESDTimelineWidget();
    this.setAutoScaleOnSymbolChange();
    this.readOnly() || this._hideSymbolSearch || D69.registerDialogKeypressHandler(this);
    this.adaptOnChartLogo(this.Q2.paneProperties.background.value())
};
D7.prototype._initBarsMarksSources = function () {
    var n = this;
    this.withModel(this, function () {
        this.model().barsMarksSources().map(function (t) {
            t.onNeedRepaint.subscribe(n, n.paint)
        })
    })
};
D7.prototype.initESDTimelineWidget = function () {
    new TradingView.ESDTimelineWidget(this)
};
D7.prototype.setAutoScaleOnSymbolChange = function () {
    this.withModel(this, function () {
        this.model().mainSeries().onStartLoading().subscribe(this, function () {
            (!this.model().mainSeries()instanceof TradingView.Series || !this.model().mainSeries().properties().lockScale.value()) && 0 == this.model().mainSeries().data().size() && this.model().mainSeries().priceScale().setAutoScale(!0)
        })
    })
};
D7.prototype.initColors = function () {
    this.Q2.paneProperties.background.listeners().subscribe(this, D7.prototype.setBackgroundColor);
    this.Q2.paneProperties.gridProperties.color.listeners().subscribe(this, D7.prototype.redrawPanes);
    this.Q2.scalesProperties.lineColor.listeners().subscribe(this, D7.prototype.setScaleLineColor);
    this.Q2.scalesProperties.textColor.listeners().subscribe(this, D7.prototype.setScaleTextColor)
};
D7.prototype.paneWidgets = function () {
    return new List(this._paneWidgets)
};
D7.prototype.paneByCanvas = function (n) {
    for (var t = 0; t < this._paneWidgets.length; t++)if (this._paneWidgets[t].canvas === n || this._paneWidgets[t].top_canvas === n)return this._paneWidgets[t];
    return null
};
D7.prototype.paneByState = function (n) {
    for (var t = 0; t < this._paneWidgets.length; t++)if (this._paneWidgets[t]._state === n)return this._paneWidgets[t];
    return null
};
D7.prototype.priceAxisByCanvas = function (n) {
    for (var i, t = 0; t < this._paneWidgets.length; t++)if (i = this._paneWidgets[t].priceAxisByCanvas(n), i)return i;
    return null
};
D7.prototype.timeAxisByCanvas = function (n) {
    return n === this._timeAxisWidget.canvas || n === this._timeAxisWidget.top_canvas ? this._timeAxisWidget : null
};
D7.prototype.properties = function () {
    return this.Q2
};
D7.prototype.emulateCriticalError = function () {
    this._chartSession.removeSeries(-1, null)
};
D7.prototype.readOnly = function () {
    return this._readOnly
};
D7.prototype.onDisconnected = function () {
    return this._disconnected
};
D7.prototype.onReconnectBailout = function () {
    return this._reconnectBailout
};
D7.prototype.onConnected = function () {
    return this._connected
};
D7.prototype.onRedrawPanes = function () {
    return this._redrawPanes
};
D7.prototype.modelCreated = function () {
    return this._modelCreated
};
D7.prototype.setResolution = function (n) {
    if (this.Q0) {
        var t = this.Q0.mainSeries().properties().interval;
        this.Q0.setScreenChartProperty(t, n, this, $.t("Change Resolution"))
    } else this.Q2.mainSeriesProperties.merge({interval: n})
};
D7.prototype.getResolution = function () {
    return this.Q0 ? this.Q0.mainSeries().properties().interval.value() : this.Q2.mainSeriesProperties.interval.value()
};
D7.prototype.addSymbol = function (n, t) {
    var i = this.model(), r = i.studiesMetaData(), u = i.mainSeries().properties().style.value() == TradingView.Series.STYLE_CANDLES ? TradingView.Series.STYLE_BARS : TradingView.Series.STYLE_CANDLES;
    props = {inputs: {symbol: n}, style: u};
    study = r.find(function (n) {
        return"Overlay@tv-basicstudies" == n.id
    });
    i.insertStudy(study, props, t)
};
D7.prototype.addSymbolDialog = function () {
    D83.showAddSymbolDialog(this, {overlayOption: !0, callback: this.addSymbol.bind(this)})
};
D7.prototype.updateActions = function () {
    function f(t) {
        function f() {
            TradingView.showChartNameDialog(function (n) {
                if (n) {
                    var t = {name: n, content: JSON.stringify(i.Q0.model().theme())};
                    $.post("/save-theme/", t).error(function (n) {
                        console.error(n.responseText)
                    });
                    TradingView.getThemesList.Q20();
                    i.Q0._lastLoadedTheme = n
                }
            }, "Save theme as...", "Theme name", 128)
        }

        var r, u;
        n.applyColorTheme.subActions || (n.applyColorTheme.subActions = []);
        r = n.applyColorTheme.subActions;
        r.splice(0, r.length);
        is_authenticated && (u = new Action({text: $.t("Save As...")}), u.callbacks().subscribe(null, f), r.push(u), r.push(new ActionSeparator));
        t && t.length ? $.each(t, function (n, t) {
            function f(n) {
                return function () {
                    return D83.showConfirm("Theme", "Do you realy want to delete " + (n ? '"' + n + '"' : "") + " theme?", function () {
                        $.post("/remove-theme/", {name: n}).error(function (n) {
                            console.error(n.responseText)
                        });
                        TradingView.getThemesList.Q20()
                    }), this._parentMenu._parentMenuItem._parentMenu.destroy(), !1
                }
            }

            var u = new Action({text: t});
            u.callbacks().subscribe(null, function () {
                $.getJSON("/theme/?themeName=" + encodeURIComponent(t), function (n) {
                    i.model().model().restoreTheme(JSON.parse(n.content))
                })
            });
            is_authenticated && (u.deleteButton = {action: f(u.text)});
            r.push(u)
        }) : r.push(new Action({text: "No color themes saved", enabled: !1}))
    }

    function e() {
        var i = studyTemplates.plainList("custom"), u = studyTemplates.plainList("default"), t, r;
        n.applyStudyTemplate.subActions || (n.applyStudyTemplate.subActions = []);
        t = n.applyStudyTemplate.subActions;
        t.splice(0, t.length);
        r = new Action({text: studyTemplates._SAVE_AS_TITLE});
        r.callbacks().subscribe(studyTemplates, studyTemplates.showSaveAsDiaolg);
        t.push(r);
        t.push(new ActionSeparator);
        i.length || u.length ? (i.length && ($.each(i, function (n, i) {
            var r = new Action({text: i});
            r.callbacks().subscribe(studyTemplates, function () {
                this.applyStudyTemplate(i)
            });
            r.deleteButton = {action: function (n) {
                return function () {
                    return studyTemplates.deleteStudyTemplate(n), this._parentMenu._parentMenuItem._parentMenu.destroy(), !1
                }
            }(r.text)};
            t.push(r)
        }), t.push(new ActionSeparator)), $.each(u, function (n, i) {
            var r = new Action({text: i});
            r.callbacks().subscribe(studyTemplates, function () {
                this.applyStudyTemplate(i)
            });
            t.push(r)
        })) : t.push(new Action({text: "No study templates saved", enabled: !1}))
    }

    for (var t, u, i = this, n = this.actions(), o = this.Q0.Q19(), s = !1, h = !1, r = 0, c = o.size(); r < c; r++)t = o.item(r), isInherited(t.constructor, J47) && t.isUserDeletable() && (s = !0), isInherited(t.constructor, TradingView.Study) && t.removeByRemoveAllStudies() && (h = !0);
    this._readOnly || (n.paneRemoveAllStudies && n.paneRemoveAllStudies.setEnabled(h), n.paneRemoveAllDrawingTools && n.paneRemoveAllDrawingTools.setEnabled(s));
    f(TradingView.getThemesList(f));
    window.studyTemplates && (e(), studyTemplates.refreshStudyTemplateList(e));
    u = [];
    TradingView.availableTimezones.forEach(function (n) {
        var t = this, r = function () {
            return n.id === t.model().model().properties().timezone.value()
        }, i;
        n.separator ? indicatorSubActions.push(new ActionSeparator) : (i = new Action({text: n.title, checkable: !0, checked: r()}), i.callbacks().subscribe(this, function () {
            var i;
            i || (i = setTimeout(function () {
                t.model().setProperty(t.model().model().properties().timezone, n.id, "Changed Time Zone");
                i = !1
            }, 300))
        }), t.model().model().properties().timezone.subscribe(null, function () {
            i.setChecked(r())
        }), u.push(i))
    }, this);
    n.applyTimeZone.subActions = u;
    n.addToWatchlist.text = $.t("Add {0} To Watchlist").format(this.getSymbol(!0));
    this.updateActionForIntradayOnly(n.sessionBreaks);
    this.updateActionForIntradayOnly(n.extendedHours)
};
D7.prototype.actions = function () {
    return this._actions || this._setActions(), this._actions
};
D7.prototype._setActions = function () {
    var nt = this, e, o, p, w, it, b, f, k, d, s, h, c, g, l, a, t, i, r, v, y;
    if (!this._readOnly)for (var u = [new Action({text: $.t("Eraser"), callbackContext: "eraser"}), new ActionSeparator, new Action({text: $.t("Trend Line"), callbackContext: "LineToolTrendLine"}), new Action({text: $.t("Horizontal Line"), callbackContext: "LineToolHorzLine"}), new Action({text: $.t("Vertical Line"), callbackContext: "LineToolVertLine"}), new Action({text: $.t("Arrow"), callbackContext: "LineToolArrow"}), new Action({text: $.t("Ray"), callbackContext: "LineToolRay"}), new Action({text: $.t("Extended"), callbackContext: "LineToolExtended"}), new Action({text: $.t("Parallel Channel"), callbackContext: "LineToolParallelChannel"}), new ActionSeparator, new Action({text: $.t("Pitchfork"), callbackContext: "LineToolPitchfork"}), new Action({text: $.t("Schiff Pitchfork"), callbackContext: "LineToolSchiffPitchfork"}), new Action({text: $.t("Pitchfan"), callbackContext: "LineToolPitchfan"}), new Action({text: $.t("Gann Square"), callbackContext: "LineToolGannSquare"}), new Action({text: $.t("Gann Fan"), callbackContext: "LineToolGannFan"}), new Action({text: $.t("Fib Retracement"), callbackContext: "LineToolFibRetracement"}), new Action({text: $.t("Trend-Based Fib Extension"), callbackContext: "LineToolTrendBasedFibExtension"}), new Action({text: $.t("Fib Speed Resistance Fan"), callbackContext: "LineToolFibSpeedResistanceFan"}), new Action({text: $.t("Fib Time Zone"), callbackContext: "LineToolFibTimeZone"}), new Action({text: $.t("Circle Lines"), callbackContext: "LineToolCircleLines"}), new Action({text: $.t("Fib Circles"), callbackContext: "LineToolFibCircles"}), new Action({text: $.t("Fib Speed Resistance Arcs"), callbackContext: "LineToolFibSpeedResistanceArcs"}), new ActionSeparator, new Action({text: $.t("Rectangle"), callbackContext: "LineToolRectangle"}), new Action({text: $.t("Ellipse"), callbackContext: "LineToolEllipse"}), new Action({text: $.t("Triangle"), callbackContext: "LineToolTriangle"}), new Action({text: $.t("Polyline"), callbackContext: "LineToolPolyline"}), new Action({text: $.t("Arc"), callbackContext: "LineToolArc"}), new ActionSeparator, new Action({text: $.t("Text"), callbackContext: "LineToolText"}), new Action({text: $.t("Anchored Text"), callbackContext: "LineToolTextAbsolute"}), new Action({text: $.t("Balloon"), callbackContext: "LineToolBalloon"}), new Action({text: $.t("Price Label"), callbackContext: "LineToolPriceLabel"}), new ActionSeparator, new Action({text: $.t("Elliott Wave Subminuette"), callbackContext: "LineToolElliottSubminuette"}), new Action({text: $.t("Elliott Wave Minor"), callbackContext: "LineToolElliottMinor"}), new Action({text: $.t("Elliott Wave Circle"), callbackContext: "LineToolElliottCircle"}), new Action({text: $.t("Elliott Minor Retracement"), callbackContext: "LineToolElliottMinorRetr"}), new Action({text: $.t("Elliott Major Retracement"), callbackContext: "LineToolElliottMajorRetr"}), new ActionSeparator, new Action({text: $.t("Brush"), callbackContext: "LineToolBrush"}), new ActionSeparator, new Action({text: $.t("Forecast"), callbackContext: "LineToolPrediction"})], nt = this, n = 0; n < u.length; n++)u[n].callbacks().subscribe(null, function (n) {
        TradingView.drawingState.tool.setValue(n.callbackContext())
    });
    n = new Action({text: $.t("Reset Chart")});
    n.callbacks().subscribe(this, this.GUIResetScales);
    e = new Action({text: $.t("Undo"), shortcut: "ctrl+z"});
    e.callbacks().subscribe(null, function () {
        TradingView.trackEvent("GUI", "Undo");
        D77.undo()
    });
    e.disable();
    o = new Action({text: $.t("Redo"), shortcut: "ctrl+y"});
    o.callbacks().subscribe(null, function () {
        TradingView.trackEvent("GUI", "Redo");
        D77.redo()
    });
    o.disable();
    D77.undoStack().onChange().subscribe(this, this.updateUndoRedo);
    D77.redoStack().onChange().subscribe(this, this.updateUndoRedo);
    var ut = new Action({text: $.t("Color Theme")}), ft = new Action({text: $.t("TimeZone")}), tt = new Action({text: $.t("Change Symbol...")});
    TVSettings.setValue("symboledit.dialog_last_entry", "");
    tt.callbacks().subscribe(this, function () {
        D69.showDialog({callback: this.setSymbol.bind(this)})
    });
    p = new Action({text: $.t("Change Interval...")});
    p.callbacks().subscribe(this, function () {
        new ChangeIntervalDialog({callback: function (n) {
            D45.interval.setValue(n)
        }}).show()
    });
    w = new Action({text: $.t("Add To Watchlist")});
    w.callbacks().subscribe(this, function () {
        for (var t = widgetbar.setPage("Watchlist, details and news"), i, n = 0; n < t.widgets.length; n++)if ("watchlist" == t.widgets[n].type) {
            i = t.widgets[n].widgetObject;
            break
        }
        i && i.addHighlight(this.getSymbol())
    });
    it = new Action({text: $.t("Study Template")});
    b = new Action({shortcut: "ctrl+alt+q", text: $.t("Reset Scale")});
    b.callbacks().subscribe(null, function () {
        nt.model().resetTimeScale()
    });
    var u = new Action({text: $.t("Insert Drawing Tool"), subActions: u}), et = new Action({text: $.t("Remove All Indicators")}), ot = new Action({text: $.t("Remove All Drawing Tools")}), st = new Action({text: $.t("Insert Indicator...")}), ht = new Action({text: $.t("Script Editor...")}), ct = new Action({text: $.t("Compare or Add Symbol...")}), lt = new Action({text: $.t("Compare...")}), at = new Action({text: $.t("Objects Tree...")}), vt = new Action({text: $.t("Properties..."), callback: function () {
        nt.showChartProperties()
    }}), yt = new Action({text: $.t("Scales Properties...")}), pt = new Action({text: $.t("Timezone/Sessions Properties...")}), rt = new Action({text: $.t("Lock/Unlock")});
    rt.callbacks().subscribe(this, D7.prototype.toggleLockSelectedObject);
    f = new Action({text: $.t("Hide")});
    f.callbacks().subscribe(this, D7.prototype.hideSelectedObject);
    k = new Action({text: $.t("Format...")});
    k.callbacks().subscribe(this, D7.prototype.editSelectedObject);
    d = new Action({text: $.t("Source Code...")});
    d.callbacks().subscribe(this, this.openSelectedObjectSource);
    s = new Action({text: $.t("Show Left Axis"), checkable: !0});
    s.binder = new Q14(s, this.Q2.scalesProperties.showLeftScale, this.model(), "Show Left Scale");
    h = new Action({text: $.t("Show Right Axis"), checkable: !0});
    h.binder = new Q14(h, this.Q2.scalesProperties.showRightScale, this.model(), "Show Right Scale");
    this.Q2.scalesProperties.showLeftScale.listeners().subscribe(this, D7.prototype._updateScalesActions);
    this.Q2.scalesProperties.showRightScale.listeners().subscribe(this, D7.prototype._updateScalesActions);
    c = new Action({text: $.t("Scale Price Chart Only"), checkable: !0});
    c.binder = new Q14(c, this.Q2.scalesProperties.scaleSeriesOnly, this.model(), $.t("Scale Price Chart Only"));
    g = this.model().model();
    this.Q2.scalesProperties.scaleSeriesOnly.listeners().subscribe(null, function () {
        g.recalculateAllPanes();
        g.Q20(new D22(D22.FULL_UPDATE))
    });
    l = new Action({text: $.t("Magnet Mode"), checkable: !0});
    l.binder = new Q14(l, TradingView.drawingState.properties().magnet, this.model(), "Magnet");
    a = new Action({text: $.t("Stay In Drawing Mode"), checkable: !0});
    a.binder = new Q14(a, TradingView.drawingState.properties().stayInDrawingMode, this.model(), "Stay In Drawing Mode");
    t = new Action({text: $.t("Lock All Drawing Tools"), checkable: !0});
    t.binder = new Q14(t, TradingView.drawingState.lockDrawings(), this.model(), "Lock drawings", function (n) {
        n || this.binder.setValue(!this.binder.value());
        TradingView.drawingState.lockDrawings().setValue(this.binder.value())
    }.bind(t));
    i = new Action({text: $.t("Hide All Drawing Tools"), checkable: !0});
    i.binder = new Q14(i, TradingView.drawingState.hideAllDrawings(), this.model(), "Hide All Drawing Tools", function (n) {
        n || this.binder.setValue(!this.binder.value());
        TradingView.drawingState.hideAllDrawings().setValue(this.binder.value())
    }.bind(i));
    r = new Action({text: $.t("Hide Marks On Bars"), checkable: !0});
    r.binder = new Q14(r, TradingView.drawingState.hideMarksOnBars(), this.model(), "Hide Marks On Bars", function (n) {
        n || this.binder.setValue(!this.binder.value());
        TradingView.drawingState.hideMarksOnBars().setValue(this.binder.value())
    }.bind(r));
    v = new Action({text: $.t("Extended Hours"), checkable: !0});
    v.binder = new Q14(v, this.model().mainSeries().properties().extendedHours, this.model(), "Change Extended Hours");
    y = new Action({text: $.t("Show Countdown"), checkable: !0, checked: !1});
    y.binder = new Q14(y, this.model().mainSeries().properties().showCountdown, this.model(), "Show Countdown");
    this._actions = {chartProperties: vt, timeScaleReset: b, chartReset: n, compareOrAdd: ct, compare: lt, scalesProperties: yt, tmzProperties: pt, paneObjectTree: at, insertIndicator: st, insertDrawingTool: u, applyColorTheme: ut, applyStudyTemplate: it, symbolSearch: tt, changeInterval: p, addToWatchlist: w, seriesHide: f, studyHide: f, lineToggleLock: rt, lineHide: f, showLeftAxis: s, showRightAxis: h, scaleSeriesOnly: c, magnetAction: l, stayInDrawingModeAction: a, lockDrawingsAction: t, hideAllDrawingsAction: i, hideAllMarks: r, applyTimeZone: ft, extendedHours: v, showCountdown: y, undo: e, redo: o, viewSourceCode: d};
    J77.enabled("charting_library") || (this._actions.scriptEditor = ht);
    this.createSessionBreaksActions();
    this.readOnly() ? (this._actions.paneResetAction = new Action({text: $.t("Reset")}), this._actions.paneLoadNewBarsAction = new Action({text: $.t("Load New Bars")}), this._actions.paneMakeItMineAction = new Action({text: this._containsData ? $.t("Make It Mine") : $.t("Copy")}), this._actions.paneFullScreenAction = new Action({text: $.t("Full Screen")}), this._actions.paneResetAction.callbacks().subscribe(this, function () {
        resetScales()
    }), this._actions.paneLoadNewBarsAction.callbacks().subscribe(this, function () {
        requestData()
    }), this._actions.paneMakeItMineAction.callbacks().subscribe(this, function (n) {
        return n._containsData ? function () {
            submitChartGoToRealTimeForm()
        } : function () {
            open("/e/?clone=" + n.metaInfo().uid, "_blank")
        }
    }(this)), this._actions.paneFullScreenAction.callbacks().subscribe(this, function (n) {
        if (n._containsData)return function () {
            toggleFullscreen()
        };
        var t = new TradingView.FullscreenWidget;
        return function () {
            t.startFullscreen()
        }
    }(this))) : (n = new Action({text: $.t("Remove"), shortcut: "del"}), n.callbacks().subscribe(this, function () {
        var n;
        this.Q5 && (n = this.Q5.activeChartWidget.value());
        n || (n = this);
        n.removeSelectedSource()
    }), this._actions.insertDrawingTool = u, this._actions.paneRemoveAllStudies = et, this._actions.paneRemoveAllDrawingTools = ot, this._actions.seriesRemove = n, this._actions.studyRemove = n, this._actions.lineRemove = n, this._actions.format = k, this._actions.lockDrawingsAction = t, this._actions.hideAllDrawingsAction = i, this._actions.hideAllMarks = r, this._actions.paneRemoveAllStudies.callbacks().subscribe(this, D7.prototype.removeAllStudies), this._actions.paneRemoveAllDrawingTools.callbacks().subscribe(this, D7.prototype.removeAllDrawingTools));
    this._actions.paneObjectTree.callbacks().subscribe(this, D7.prototype.showSourceProperties);
    this._actions.chartProperties.callbacks().subscribe(this, D7.prototype.showChartProperties);
    this._actions.insertIndicator.callbacks().subscribe(this, D7.prototype.showIndicators);
    this._actions.scriptEditor && this._actions.scriptEditor.callbacks().subscribe(this, D7.prototype.showScriptEditor);
    this._actions.compareOrAdd.callbacks().subscribe(this, D7.prototype.showCompareOrAdd);
    this._actions.compare.callbacks().subscribe(this, D7.prototype.showCompareOrAdd);
    this._actions.scalesProperties.callbacks().subscribe(this, D7.prototype.showScalesProperties);
    this._actions.tmzProperties.callbacks().subscribe(this, D7.prototype.showTimezoneProperties);
    this._updateScalesActions()
};
D7.prototype.executeActionByName = function (n) {
    var t, i;
    n:{
        for (t in this._actions)if (i = this._actions[t], i.text.toLowerCase() === n.toLowerCase()) {
            t = i;
            break n
        }
        t = null
    }
    t ? t.callbacks().fire() : console.warn("Unknown action: " + n)
};
D7.prototype._updateScalesActions = function () {
    if (this._actions) {
        this._actions.showRightAxis.setEnabled(this.Q2.scalesProperties.showLeftScale.value());
        this._actions.showLeftAxis.setEnabled(this.Q2.scalesProperties.showRightScale.value());
        for (var n = 0; n < this._paneWidgets.length; n++)this._paneWidgets[n].updateScalesVisibility();
        this._timeAxisWidget.updatePriceScalesVisibility();
        this._update(new D22(D22.FULL_UPDATE))
    }
};
D7.prototype.removeAllStudies = function () {
    this.Q0.removeAllStudies()
};
D7.prototype.removeAllDrawingTools = function () {
    this.Q0.removeAllDrawingTools()
};
D7.prototype.model = function () {
    return this.Q0
};
D7.prototype.connect = function () {
    this._handler = function (n) {
        this._onData(n)
    }.bind(this);
    this._chartSession.connect(this._handler)
};
D7.prototype.finishInitWithoutConnect = function () {
    this._chartSession.disable();
    this._init();
    this.chartWidgetInitialized.fire()
};
D7.prototype.update = function () {
    if (this.Q0) {
        for (var n = 0; n < this._paneWidgets.length; n++)this._paneWidgets[n].update();
        this._timeAxisWidget.update()
    }
};
D7.prototype.paint = function (n) {
    n || (n = new D22(D22.FULL_UPDATE));
    for (var t = 0; t < this._paneWidgets.length; t++)this._paneWidgets[t].paint(n.invalidateForPane(t), !1);
    this._timeAxisWidget && this._timeAxisWidget.paint(n.fullInvalidation());
    this._redrawPanes.fire()
};
D7.prototype._makeDefaultGui = function () {
    this._makeChartWidget();
    this._makeLoadingScreen();
    this._makeMasterTable();
    this._makeTimeAxisWidget();
    this._adjustSize();
    this._updateScalesActions();
    $("*", this._jqMainTable).selectable(!1);
    this.update();
    this.paint()
};
D7.prototype.widget = function () {
    return this._jqMainDiv
};
D7.prototype.restoreState = function (n, t) {
    this._adjustSize();
    this.Q0.restoreState(this._content, t);
    this._setActions()
};
D7.prototype.redrawPanes = function () {
    $.each(this._paneWidgets, function () {
        this.paint()
    });
    this._redrawPanes.fire()
};
D7.prototype.adaptOnChartLogo = function (n) {
    J77.enabled("adapt_onchart_logo_background") && ($(".onchart-custom-logo .wrapper .inner").css("background-color", generateColor(n, 50)), $(".onchart-tv-logo .wrapper .inner").css("background-color", generateColor(n, 20)))
};
D7.prototype.setBackgroundColor = function (n) {
    this.adaptOnChartLogo(n.value());
    this.scaleBackgroundColor = n.value();
    $.each(this._paneWidgets, function () {
        this.paint();
        this.setCursorForTool()
    });
    this.update();
    this.paint()
};
D7.prototype.setScaleLineColor = function (n) {
    this.scaleLineColor = n.value();
    $.each(this._paneSeparators, function () {
        this.update()
    });
    this.update();
    this.paint()
};
D7.prototype.setScaleTextColor = function (n) {
    this.scaleTextColor = n.value();
    this.update();
    this.paint()
};
D7.prototype._update = function (n) {
    if (n && n.fullInvalidation() !== D22.FULL_UPDATE) {
        if (n.fullInvalidation() === D22.LIGHT_UPDATE) {
            for (this._timeAxisWidget.update(), this.paint(new D22(D22.UPDATE_CURSOR_ONLY)), t = 0; t < this._paneWidgets.length; t++)this._paneWidgets[t].statusWidget().update();
            this._dataWindowWidget && this._dataWindowWidget.update()
        } else if (n.fullInvalidation() === D22.UPDATE_CURSOR_ONLY) {
            for (t = 0; t < this._paneWidgets.length; t++)this._paneWidgets[t].statusWidget().update();
            this._dataWindowWidget && this._dataWindowWidget.update()
        }
    } else {
        this.Q0 && this._updateGui();
        this._adjustSize();
        this._timeAxisWidget.update();
        for (var t = 0; t < this._paneWidgets.length; t++)this._paneWidgets[t]._state = this.Q0.panes().item(t), this._paneWidgets[t].statusWidget().updateLayout();
        this._dataWindowWidget && this._dataWindowWidget.updateAll()
    }
    this.paint(n)
};
D7.prototype._createVolumeIfNeeded = function () {
    J77.enabled("create_volume_indicator_by_default") && this._options.addVolume && !this._content && (J77.enabled("charting_library") ? this.Q0.mainSeries().onCompleted() : this.Q0.mainSeries().onSymbolResolved()).subscribe(this, function () {
        var n = this.Q0.model().mainSeries().symbolInfo();
        n && (n = !n.has_no_volume, !this.containsVolume() && n ? (n = factoryDefaults("chartproperties.volumePaneSize"), this.insertStudy("Volume@tv-basicstudies", !1, J77.enabled("volume_force_overlay"), void 0, {paneSize: n})) : !n && this.containsVolume() && (n = this.model().Q19().find(function (n) {
            return n instanceof TradingView.Study && "Volume" == n.metaInfo().shortId
        }), this.Q0.model().removeSource(n)))
    }, !J77.enabled("charting_library"))
};
D7.prototype._makeDefaultModel = function () {
    function i() {
        return makeDefaultChartModel(n._chartSession, function (t) {
            if (!(t instanceof D22))throw Error("Invalid mask");
            n._invalidateMask ? n._invalidateMask.merge(t) : n._invalidateMask = t;
            n._draw_planned || (n._draw_planned = !0, requestAnimationFrame(u))
        }, n.Q2, n.readOnly(), r, n._studiesMetaData, n._studiesMigrations, n)
    }

    function u() {
        n._draw_planned = !1;
        !n._inLoadingState && n._invalidateMask && (n._invalidateMask = n._update(n._invalidateMask))
    }

    var n = this, r, t;
    if (this._content && this._content.timeScale.points && (r = {startDate: this._content.timeScale.points.items[0]}), !this._studiesMetaData)throw Error("Cannot create chart model: studies metainfo is absent");
    this.Q0 = J77.enabled("lean_chart_load") ? this.Q0 || i() : i();
    this._createVolumeIfNeeded();
    this._content ? (this.restoreState(this._content, this._containsData), J77.enabled("chart_content_overrides_by_deafults") && (this._defSymbol && this.setSymbol(this._defSymbol), this._defInterval && this.setResolution(this._defInterval), this._defStyle && this.setSeriesStyle(this.Q0.mainSeries(), this._defStyle))) : this._setActions();
    this.Q0.onTagsChanged().subscribe(this, D7.prototype.onModelTagsChanged);
    this._updateGui();
    this._modelCreated.fire(this.Q0);
    this._tagsChanged.fire();
    n = this;
    t = this.Q0.mainSeries();
    this.Q0.lineCancelled().subscribe(this, this.onLineCancelled);
    t.onSymbolNotPermitted().subscribe(null, function (n) {
        t.properties().symbol.setValue(n)
    });
    this._options.handleSessionErrors && (t.chartTypeNotPermitted.subscribe(null, function () {
        t.properties().interval.setValue("D");
        n._options.muteSessionErrors || D83.showGoProDialog({feature: "kagiRenko"})
    }), t.intradaySpreadNotPermitted.subscribe(null, function () {
        t.properties().interval.setValue("D");
        n._options.muteSessionErrors || D83.showGoProDialog({feature: "intradaySpread"})
    }), t.customIntervalNotPermitted.subscribe(null, function () {
        t.properties().interval.setValue("D");
        n._options.muteSessionErrors || D83.showGoProDialog({feature: "customIntervals"})
    }), t.intradayExchangeNotPermitted.subscribe(null, function () {
        if (t.properties().interval.setValue("D"), !n._options.muteSessionErrors) {
            var i = t.symbolInfo().listed_exchange;
            TVChartApi.prototype.supportedExchangesList().forEach(function (n) {
                n.value == i && (i = n.name)
            });
            D83.showGoProDialog({feature: "intradayExchange", exchangesButton: window.user.is_pro && "pro_realtime_trial" != window.user.pro_plan, exchange: i})
        }
    }), t.requestingIntradayWhenNotSupported.subscribe(null, function () {
        t.properties().interval.setValue("D");
        n._options.muteSessionErrors || D83.showIntervalMismatchDialog()
    }), t.requestingResolutionWhenNotSupported.subscribe(null, function (n) {
        t.properties().interval.setValue(n)
    }), n._options.muteSessionErrors || t.onExtendedHoursChanged().subscribe(null, function () {
        t.onExtendedHoursNotPermitted().subscribe(null, function () {
            D83.showGoProDialog({feature: "extendedHours"})
        })
    }, !0));
    !this._readOnly && TradingView.Q18("paper_trading") && TradingView.Trading.model().registerChartWidget(this)
};
D7.prototype._updateGui = function () {
    this.Q0 && (this._makePaneWidgetsAndSeparators(), this._makeTimeAxisWidget(), $("*", this._jqMainTable).selectable(!1), this._adjustSize())
};
D7.prototype.setVisibleTimeRange = function (n, t, i) {
    this._chartSession.setVisibleTimeRange(n, t, i)
};
D7.prototype._dateRangeResolutions = function () {
    return Q16.availableTimeFrames(this.Q0.mainSeries().symbolInfo(), this.Q0.mainSeries().status()) || []
};
D7.prototype._makeChartWidget = function () {
    this._jqMainDiv = $(document.createElement("div"));
    this._jqMainDiv.addClass("chart-widget");
    TradingView.setAbsoluteRect(this._jqMainDiv, this._rect);
    this._withDateRanges && (J77.enabled("lean_chart_load") ? !this._chartControlsBar : 1) && (this._chartControlsBar = $(document.createElement("div")).attr("class", "chart-controls-bar").appendTo(this._jqParent), this._seriesControlWidget = new TradingView.SeriesControlWidget({parent: this._chartControlsBar, Q3: this}));
    (this._options.controlBar || J77.enabled("control_bar")) && (this._controlBarNavigation = new D9(this, this._jqMainDiv, !0));
    this._containsData || this.createIndicatorImage()
};
D7.prototype._makeLoadingScreen = function () {
    J77.enabled("lean_chart_load") ? this.screen || (this.screen = new D7.LoadingScreen(this, this._jqParent)) : this.screen = new D7.LoadingScreen(this, this._jqMainDiv)
};
D7.prototype.setSymbol = function (n, t) {
    if (this.Q0) {
        var i = this.Q0.mainSeries();
        (t || !i.symbolSameAsCurrent(n) || J77.enabled("same_data_requery")) && (this.Q0.setSelectedSource(null), this.Q0.setScreenChartProperty(i.properties().symbol, n, this, "Change Symbol", J77.enabled("same_data_requery")))
    } else this.Q2.mainSeriesProperties.merge({symbol: n})
};
D7.prototype.getSymbol = function (n) {
    var t;
    return(t = this.Q0 ? this.Q0.mainSeries().properties() : this.Q2.mainSeriesProperties) ? n && t.shortName && t.shortName.value() ? t.shortName.value() : t.symbol.value() : ""
};
D7.LoadingScreen = function (n, t) {
    this._cw = n;
    this.$element = $('<div class="chart-loading-screen">');
    this.$shield = $('<div class="chart-loading-screen-shield">').appendTo(this.$element);
    this.$element.appendTo(t);
    this._showed = !1;
    this._cw.withModel(this, this._connectToModel)
};
D7.LoadingScreen.prototype._connectToModel = function () {
    this._cw.model().mainSeries().onDataLoaded().subscribe(this, function (n) {
        switch (n.method) {
            case"symbol_error":
                "permission denied" !== n.params[1] && this.hide();
                break;
            case"series_completed":
                this.hide()
        }
    })
};
D7.LoadingScreen.prototype.show = function () {
    return this._cw._inLoadingState = !0, this._showed || this._cw.isDetached || (this._showed = !0, this._show()), $.Deferred().resolve()
};
D7.LoadingScreen.prototype._show = function () {
    var n = this._cw.properties().paneProperties.background.value();
    this.$shield.css("background", n);
    this.$element.addClass("fade")
};
D7.LoadingScreen.prototype.hide = function () {
    delete this._cw._inLoadingState;
    this._showed && this._hide()
};
D7.LoadingScreen.prototype._hide = function () {
    this._showed = !1;
    this.$element.removeClass("fade")
};
D7.LoadingScreen.prototype.$canvas = null;
D7.LoadingScreen.prototype.context = null;
D7.prototype._makeMasterTable = function () {
    this._jqMainTable = $(document.createElement("table"));
    this._jqMainTable.appendTo(this._jqMainDiv);
    this._jqMainTable.addClass("chart-markup-table");
    this._jqMainTable.attr("cellpading", "0");
    this._jqMainTable.attr("cellspacing", "0")
};
D7.prototype._makePaneWidgetsAndSeparators = function () {
    for (var t, i, f = this.Q0.panes().toArray(), u = f.length, r = this._paneWidgets.length, n = u; n < r; n++)t = this._paneWidgets.pop(), t.jqRow.remove(), t.jqRow.find("*").remove(), t.destroy(), i = this._paneSeparators.pop(), i && i.jqRow.remove();
    for (n = r; n < u; n++)t = new D53(this, f[n], this._onWidget), this._paneWidgets.push(t), 0 < n && (i = new D52(this, n - 1, n), this._paneSeparators.push(i), this._timeAxisWidget ? i.jqRow.insertBefore(this._timeAxisWidget.jqRow) : i.jqRow.appendTo(this._jqMainTable)), this._timeAxisWidget ? t.jqRow.insertBefore(this._timeAxisWidget.jqRow) : t.jqRow.appendTo(this._jqMainTable);
    for (n = 0; n < u; n++)r = f[n], t = this._paneWidgets[n], t.state() !== r && t.setState(r);
    for (n = u; n--;)this._paneWidgets[n].updateControls()
};
D7.prototype._makeTimeAxisWidget = function () {
    this._timeAxisWidget || (this._timeAxisWidget = new D73(this, this._onWidget), this._timeAxisWidget.jqRow.appendTo(this._jqMainTable))
};
D7.prototype.insertStudyOrShowDialog = function (n) {
    if (this.isSymbolicStudy(n)) {
        var t = defaults("study_" + n.id).description;
        D83.showAddSymbolDialog(this, {title: t, okButtonTitle: $.t("Apply"), callback: function (t, i) {
            var r = {inputs: {symbol: t}};
            TradingView.trackEvent("GUI", "Add Study");
            this.model().insertStudy(n, r, i)
        }.bind(this)})
    } else this.hasConfirmInputs(n) ? (t = defaults("study_" + n.id).description, D83.showConfirmInputsDialog(this, n, {title: t, okButtonTitle: $.t("Apply"), callback: function (t) {
        TradingView.trackEvent("GUI", "Add Study");
        this.model().insertStudy(n, t, !1)
    }.bind(this)})) : TradingView.Study.isPointsBasedStudy(n.id) ? (t = TradingView.Study.lineToolNameForPointsBasedStudy(n.id), TradingView.drawingState.tool.setValue(t)) : (TradingView.trackEvent("GUI", "Add Study"), this.insertStudy(n.id, !0))
};
D7.prototype.hasConfirmInputs = function (n) {
    var t, i;
    if (n = n.inputs, void 0 == n)return!1;
    for (t = 0; t < n.length; ++t)if (i = n[t], void 0 != i.confirm && i.confirm)return!0;
    return!1
};
D7.prototype.isSymbolicStudy = function (n) {
    switch (n.id) {
        case"Overlay@tv-basicstudies":
        case"CorrelationCoefficient@tv-basicstudies":
            return!0;
        default:
            return!1
    }
};
D7.prototype.isPointsBasedStudy = function (n) {
    return TradingView.Study.isPointsBasedStudy(n.id)
};
D7.prototype.insertStudy = function (n, t, i, r, u) {
    n = StudyMetaInfo.findStudyMetaInfo(this._studiesMetaData, n);
    n = StudyMetaInfo.replaceWithFullStudyMetaInfo(this._studiesMetaData, n);
    r = r ? {inputs: r} : {};
    u && (r = $.extend(r, u));
    t ? this.Q0.insertStudy(n, r, i) : this.Q0.model().insertStudy(n, r, i)
};
D7.prototype._adjustSize = function () {
    var n = 0, t = 0, e = 0, i;
    $.each(this._paneWidgets, function () {
        n = Math.max(this.lhsPriceAxisWidget.optimalWidth(), n);
        t = Math.max(this.rhsPriceAxisWidget.optimalWidth(), t);
        e += this.stretchFactor()
    });
    var r = this._rect, f = r.w - n - t, o = this._paneSeparators.length, s = D52.HEIGHT, u = this._timeAxisWidget.optimalHeight(), h = (r.h - s * o - u) / e;
    this._jqMainTable.width(r.w);
    this._jqMainTable.height(r.h);
    i = this;
    $.each(this._paneWidgets, function (r) {
        i.Q0 && (this._state = i.Q0.panes().item(r));
        r = Math.max(Math.round(this.stretchFactor() * h), 2);
        this.setPriceAxisSize(D54.LHS, new D61(n, r));
        this.setPriceAxisSize(D54.RHS, new D61(t, r));
        this.setSize(new D61(f, r));
        i.Q0 && this.state() && i.Q0.setPaneHeight(this.state(), r)
    });
    this._timeAxisWidget.setSize(new D61(f, u), new D61(n, u), new D61(t, u));
    this.Q0 && this.Q0.setWidth(f);
    this.maxLhsPriceAxisWidth !== n && (this.maxLhsPriceAxisWidth = n, this.lhsPriceAxisWidthChanged.fire(n));
    this.maxRhsPriceAxisWidth !== t && (this.maxRhsPriceAxisWidth = t, this.rhsPriceAxisWidthChanged.fire(t))
};
D7.prototype._onData = function (n) {
    switch (n.method) {
        case"connected":
            this._onConnection();
            break;
        case"disconnected":
            this._onDisconnect();
            break;
        case"reconnect_bailout":
            this._reconnectBailout.fire();
            break;
        case"connection_error":
            this._onConnectionError(n.params[0]);
            break;
        case"critical_error":
            this._disconnected.fire(!0);
            break;
        default:
            this.Q0.onData(n)
    }
};
D7.prototype._nextMetadataId = 1;
D7.prototype._onConnection = function () {
    this._online = !0;
    this.Q0 ? (this.Q0.restart(), this._updateGui(), this.update(), this.paint(), this._connected.fire()) : (J77.enabled("charting_library") ? this._chartSession.requestMetadata("metadata_" + D7._nextMetadataId, function (n) {
        n = n.params[1];
        for (var t = 0; t < n.length; ++t)StudyMetaInfo.addStudyMetaInfo(this._studiesMetaData, _applyLocalizationToMetadata(n[t]));
        this._init();
        this.chartWidgetInitialized.fire()
    }.bind(this)) : (this._chartSession.requestMetadata("metadata_" + D7._nextMetadataId, function (n) {
        this._onStudiesMetadata(n)
    }.bind(this)), "undefined" != typeof scriptLib && (this._tvScriptsRequestDfd = scriptLib.requestBuiltinAndUserScripts())), D7._nextMetadataId++)
};
D7.prototype._onDisconnect = function () {
    this.Q0 && this.Q0.disconnect();
    this._online = !1;
    this.update();
    this.paint();
    this._disconnected.fire()
};
D7.prototype.studiesMetaData = function () {
    return this.Q0.studiesMetaData()
};
D7.prototype._onConnectionError = function () {
    this._disconnected.fire()
};
D7.prototype.getTimeScale = function () {
    return this._timeAxisWidget
};
D7.prototype.setSeriesStyle = function (n, t) {
    this.Q0.setProperty(n.properties().style, t)
};
D7.prototype.showSourceProperties = function () {
    new ObjectTreeDialog({Q3: this}, this.Q0).show()
};
D7.prototype.showChartProperties = function () {
    return new EditObjectDialog(this.Q0.mainSeries(), this.Q0).show()
};
D7.prototype.showScriptEditor = function () {
    window.scriptEditor.show()
};
D7.prototype.showCompareOrAdd = function () {
    new CompareDialog(this.Q5).show()
};
D7.prototype.showIndicators = function () {
    studyMarket.isVisible() ? studyMarket.hide() : studyMarket.show()
};
D7.prototype.showScalesProperties = function () {
    return new EditObjectDialog(this.Q0.mainSeries(), this.Q0).show({selectScales: !0})
};
D7.prototype.showTimezoneProperties = function () {
    return new EditObjectDialog(this.Q0.mainSeries(), this.Q0).show({selectTmz: !0})
};
D7.prototype.removeSelectedSource = function () {
    var n = this.Q0.selectedSource();
    !n || n === this.Q0.mainSeries() || n === this.Q0.lineBeingCreated() || n instanceof J96 || n instanceof TradingView.ESDStudyBase || this.Q0.removeSelectedSource()
};
D7.prototype.hideSelectedObject = function () {
    var n = this.Q0.selectedSource();
    n && this.Q0.setProperty(n.properties().visible, !1, "Hide " + n.title())
};
D7.prototype.toggleLockSelectedObject = function () {
    var n = this.Q0.selectedSource(), t;
    n && (t = n.properties().frozen.value(), this.Q0.setProperty(n.properties().frozen, !t, (t ? "Unlock" : "Lock") + " " + n.title()))
};
D7.prototype.editSelectedObject = function (n) {
    if (n = this.Q0.selectedSource())return new EditObjectDialog(n, this.Q0).show()
};
D7.prototype.openSelectedObjectSource = function (n) {
    (n = this.Q0.selectedSource()) && n.metaInfo && (n = n.metaInfo()) && n.TVScriptSourceCode && n.scriptIdPart && "undefined" != typeof scriptEditor && scriptEditor.show({scriptSource: n.TVScriptSourceCode, scriptIdPart: n.scriptIdPart})
};
D7.prototype.resetPriceAxisOptimalWidth = function (n) {
    $.each(this._paneWidgets, function () {
        this.resetPriceAxisOptimalWidth(n)
    });
    this._redrawPanes.fire()
};
D7.prototype.adjustPriceAxisWidth = function (n) {
    this.resetPriceAxisOptimalWidth(n);
    this._adjustSize()
};
D7.prototype.setPriceAxisVisible = function (n, t) {
    $.each(this._paneWidgets, function () {
        this.setPriceAxisVisible(n, t)
    });
    this._timeAxisWidget.setStubVisible(n, t);
    this._adjustSize();
    this._redrawPanes.fire()
};
D7.prototype.setTimeAxisVisible = function (n) {
    this._timeAxisWidget.setVisible(n);
    this._adjustSize()
};
D7.prototype.isTextTool = function (n) {
    switch (n) {
        case"LineToolBalloon":
        case"LineToolText":
        case"LineToolTextAbsolute":
        case"LineToolCallout":
        case"LineToolNote":
        case"LineToolNoteAbsolute":
            return!0
    }
    return!1
};
D7.prototype.tags = function () {
    return this.Q0 ? this.Q0.calculateDefaultTags() : []
};
D7.prototype.state = function (n) {
    return this.Q0.state(n)
};
D7.prototype.asyncState = function (n) {
    return this.Q0.asyncState(n)
};
D7.prototype.metaInfo = function () {
    var n = this._metaInfo;
    return this.Q0 && (n.systemTags = this.Q0.calculateDefaultTags()), n
};
D7.prototype.image = function () {
    for (var r, u = document.createElement("canvas"), i = u.getContext("2d"), f = 0, e = this._timeAxisWidget.size.h, n, o = this.properties().scalesProperties.lineColor.value(), t = 0; t < this._paneWidgets.length; t++)(n = this._paneWidgets[t]) && n.state() && (n.state().recalculate(!0), 0 === t && (f = n.lhsPriceAxisWidget.size.w + n.size.w + n.rhsPriceAxisWidget.size.w), e += n.size.h);
    for (e += this._paneWidgets.length - 1, this._update(), u.width = f + 10, u.height = e + 25 + 10, i.fillStyle = "#F2F5F8", i.fillRect(0, 0, u.width, u.height), r = 30, t = this.mainSeriesQuotesAndMetainfo(), t.ohlc && (t = "{0} O:{1} H:{2} L:{3} C:{4}".format(t.meta.symbol, t.ohlc[0], t.ohlc[1], t.ohlc[2], t.ohlc[3]), i.fillStyle = "#000", i.font = "12px Verdana, Arial", i.fillText(t, 5, 20)), t = 0; t < this._paneWidgets.length; t++)n = this._paneWidgets[t], i.drawImage(n.lhsPriceAxisWidget.canvas, 5, r), i.drawImage(n.canvas, 5 + n.lhsPriceAxisWidget.size.w, r), n.statusWidget().renderTo(i, 10, r + 5), i.drawImage(n.rhsPriceAxisWidget.canvas, 5 + n.lhsPriceAxisWidget.size.w + n.size.w, r), r += n.size.h, t < this._paneWidgets.length - 1 && (i.fillStyle = o, i.fillRect(5, r, f, 1), r++);
    return i.drawImage(this._timeAxisWidget.lhsCanvas, 5, r), i.drawImage(this._timeAxisWidget.canvas, 5 + n.lhsPriceAxisWidget.size.w, r), i.drawImage(this._timeAxisWidget.rhsCanvas, 5 + n.lhsPriceAxisWidget.size.w + n.size.w, r), i.lineWidth = 1, i.strokeStyle = "#000", i.strokeRect(5.5, 30.5, f - 1, e - 1), u
};
D7.prototype.images = function () {
    var r, f, n, u, t, e, i;
    for (TradingView.printing = !0, r = this.Q0.selectedSource(), this.Q0.setSelectedSource(null), f = [], n = 0; n < this._paneWidgets.length; n++) {
        for (t = this._paneWidgets[n], t.paint(D22.LIGHT_UPDATE, this._onWidget), u = t.image(this._onWidget), u.containsMainSeries = this._paneWidgets[n].containsMainSeries(), u.studies = [], t = t.state().Q19(), e = 0; e < t.size(); e++)i = t.item(e), i instanceof TradingView.Study ? i.properties().visible.value() && i.statusView() && u.studies.push(i.statusView().text()) : i instanceof TradingView.Series && (u.mainSeriesText = i.statusView().text());
        f.push(u);
        n < this._paneWidgets.length - 1 && f.push(this._paneSeparators[n].image())
    }
    return this._timeAxisWidget.paint(D22.LIGHT_UPDATE), n = this._timeAxisWidget.image(), TradingView.printing = !1, this.Q0.setSelectedSource(r), this.Q0.Q20(new D22(D22.LIGHT_UPDATE)), r = this.mainSeriesQuotesAndMetainfo(), {panes: f, timeAxis: n, colors: {text: this.properties().scalesProperties.textColor.value(), bg: this.properties().paneProperties.background.value(), scales: this.properties().scalesProperties.lineColor.value()}, meta: r.meta, ohlc: r.ohlc, quotes: r.quotes}
};
D7.prototype.mainSeriesQuotesAndMetainfo = function () {
    var i, u, f, n = this.Q0.mainSeries(), r, e, t;
    return n && (r = function (t) {
        return null == t ? "" : n.formatter().format(t) + ""
    }, e = function (n) {
        return null == n ? "" : n + ""
    }, i = {resoluton: n.interval(), symbol: n.symbol()}, t = n.symbolInfo(), t && (i.symbol = t.full_name, i.description = t.description, i.exchange = t.exchange), (t = n.bars().last()) && (u = t.value.slice(1, 5).map(r)), n.quoteData && (f = {change: r(n.quoteData.change), changePercent: e(n.quoteData.change_percent), last: r(n.quoteData.last_price)})), {meta: i, ohlc: u, quotes: f}
};
D7.prototype.onTagsChanged = function () {
    return this._tagsChanged
};
D7.prototype.onModelTagsChanged = function () {
    this._tagsChanged.fire()
};
D7.prototype.destroy = function () {
    $(window).unbind("resize", this._resizeHandler);
    this.Q0.model().destroy()
};
D7.prototype.title = function () {
    return $.t("Chart Properties")
};
D7.prototype.symbolProperty = function () {
    return this.Q0.mainSeries().properties().shortName ? this.Q0.mainSeries().properties().shortName : this.Q0.mainSeries().properties().symbol
};
D7.prototype.loadContent = function (n, t) {
    var r, f, u, i;
    for (this.screen.show(), r = this.Q0.model().Q19(), i = 0; i < r.size(); i++)f = r.item(i), f != this.Q0.mainSeries() && this.Q0.model().removeSource(f, !0);
    for (this._jqMainDiv && (this._jqMainDiv.remove(), this._jqMainDiv = null), this._timeAxisWidget = null, this._paneWidgets = [], Q16.purgeCache(), this.Q0.mainSeries().purgeSymbolInfo(), this._setContent(n), t && (Q6.metaInfo.id.setValue(t.uid), Q6.metaInfo.uid.setValue(t.uid), Q6.metaInfo.name.setValue(t.name)), i = 0; i < n.panes.length; ++i)for (r = 0; r < n.panes[i].sources.length; ++r)if (n.panes[i].sources[r].state.symbol) {
        u = n.panes[i].sources[r].state;
        break
    }
    if (!u)throw"An error occured while determining main series ion the chart";
    this.Q2.mainSeriesProperties.merge({visible: !0, symbol: u.symbol, timeframe: "", onWidget: this._onWidget, interval: u.interval || "D", style: u.style});
    this._init();
    D45.interval.setValue(u.interval);
    D77.clearStack();
    this._seriesControlWidget.updateUI();
    this.createLogo && !J77.enabled("move_logo_to_main_pane") && this.createLogo(void 0, this._jqMainDiv)
};
D7.prototype._setContent = function (n) {
    n && n.panes.forEach(function (n) {
        n.sources = n.sources.filter(function (n) {
            return n ? "MainSeries" == n.type ? !0 : n.points && n.points.some(function (n) {
                return null === n.time_t || !isFinite(n.time_t)
            }) ? (TradingView.logNormal("Dropped invalid " + n.type + ". Reason: non-numeric point time"), !1) : !0 : !1
        });
        var t = function (t) {
            return n.sources && n.sources.some(function (n) {
                return n.id == t
            })
        };
        n.leftAxisSources && (n.leftAxisSources = n.leftAxisSources.filter(t));
        n.rightAxisSources && (n.rightAxisSources = n.rightAxisSources.filter(t))
    });
    this._content = n
};
D7.prototype._contentSeriesProperties = function () {
    var i, n, t;
    if (this._content)for (i = this._content.panes.length; 0 < i--;)for (n = this._content.panes[i].sources, t = n.length; 0 < t--;)if ("MainSeries" === n[t].type)return n[t].state
};
D7.prototype.updateUndoRedo = function () {
    D77.undoStack().isEmpty() ? this.actions().undo.setEnabled(!1) : this.actions().undo.setEnabled(!0);
    D77.redoStack().isEmpty() ? this.actions().redo.setEnabled(!1) : this.actions().redo.setEnabled(!0)
};
D7.prototype.createSessionBreaksActions = function () {
    var t, n = this, i = function () {
        t = new Action({text: $.t("Session Breaks"), checkable: !0});
        t.binder = new Q14(t, n.model().mainSeries().sessionsStudy().properties().graphics.vertlines.sessBreaks.visible, n.model(), "Session Breaks");
        n._actions.sessionBreaks = t
    };
    n.model().mainSeries().sessionsStudy() ? i() : n.model().mainSeries().onSessionsStudyCreated().subscribe(n, function () {
        i()
    })
};
D7.prototype.updateActionForIntradayOnly = function (n) {
    !n || !n instanceof Action || n.setEnabled(!!this.model().mainSeries().isIntradayInterval())
};
D7.prototype.withModel = function (n, t) {
    this.model() ? t.call(n) : this.modelCreated().subscribe(n, t, !0)
};
D7.prototype.containsVolume = function () {
    return!!this.model().Q19().find(function (n) {
        return n instanceof TradingView.Study && "Volume" == n.metaInfo().shortId
    })
};
D7.prototype.containsStudy = function (n) {
    return this.Q0 ? !!this.Q0.Q19().find(function (t) {
        return(t instanceof TradingView.Study) ? (t = t.metaInfo(), t.id === n || t.fullId === n) : !1
    }) : !1
};
D7.prototype.containsSessions = function () {
    return!!this.model().Q19().find(function (n) {
        return n instanceof TradingView.Study && "Sessions" == n.metaInfo().shortId
    })
};
D7.prototype.isSmall = function () {
    return this.constructor.isSmall(this._jqParent)
};
D7.isSmall = function (n) {
    return 550 > n.width() || 300 > n.height()
};
D7.prototype.onWidget = function () {
    return this._onWidget
};
D7.prototype.onCmeWidget = function () {
    return this._onCmeWidget
};
D7.prototype.resize = function () {
    this._resizeHandler && this._resizeHandler()
};
D7.prototype.chartSession = function () {
    return this._chartSession
};
D7.prototype.maxLhsPriceAxisWidth = 0;
D7.prototype.maxRhsPriceAxisWidth = 0;
D7.prototype.GUIResetScales = function () {
    TradingView.trackEvent("GUI", "Reset Scales");
    this.model() && (this._containsData ? this.model().chartModel().restoreAxisState(this._content) : this._controlBarNavigation && this._controlBarNavigation.resetButtons(), this.model().resetScales())
};
D7.prototype.onLineCancelled = function () {
    TradingView.drawingState.resetToCursor()
};
D7.prototype.createIndicatorImage = function () {
    var n = this;
    this.indicatorImage = $('<span class="chart-status-picture"><\/span>').appendTo(this._jqMainDiv);
    n.onWidget() || $('<span class="bats-warning"><\/span>').appendTo(this.indicatorImage).on("click", function () {
        TradingView.isProRealtime() || (location.href = "/gopro/")
    }).blueTooltip("<p><b>Warning:<\/b> This symbol is provided by BATS electronic exchange.<\/p><p>BATS real-time data is different from the &ldquo;official&rdquo; data and offers approximate volumes with fewer price updates.<\/p><p>If those differences are important to your analysis then you'll want to use our PRO service which allows you to subscribe to real-time data from the exchanges.<\/p>", "bottom", "double-width");
    this.indicatorText = $('<span class="series-status-text"><span class="dot"><\/span>&nbsp;<span class="text"><\/span>&nbsp;<span class="market-status"><\/span><\/span>').appendTo(this.indicatorImage);
    n.withModel(null, function () {
        var t = n.Q0.mainSeries();
        t.onStatusChanged().subscribe(null, n.updateIndicatorImage.bind(n));
        t.marketStatus.subscribe(n.updateIndicatorImage.bind(n));
        n.updateIndicatorImage()
    });
    n.rhsPriceAxisWidthChanged.subscribe(n, n.updateIndicatorImagePosition);
    n.updateIndicatorImagePosition()
};
D7.prototype.updateIndicatorImage = function () {
    function r(n, t) {
        return f.hasOwnProperty(n) ? f[n] : t
    }

    var u = this.indicatorImage, n;
    if (this.indicatorImage && (n = this.Q0, n)) {
        var n = n.mainSeries(), i = n.status(), t = this._statusDetails(), f = null, f = t.hasOwnProperty(i) ? t[i] : t.defaults, i = r("showBatsWarn", !0), t = (t = n.symbolInfo()) && t.full_name, i = !!(i && t && D68.hasBatsSymbols(t));
        u.find(".bats-warning").toggleClass("warn-bats", i);
        u.attr("title", r("title", ""));
        this._updateDataAndMarketStatus(n.marketStatus.value(), n.status())
    }
};
D7.prototype._statusDetails = function () {
    return this.__statusDetails || (this.__statusDetails = {}, this.__statusDetails[TradingView.Series.STATUS_SNAPSHOT] = {className: "snapshot", text: $.t(""), showBatsWarn: !1, priority: 1}, this.__statusDetails[TradingView.Series.STATUS_LOADING] = this.__statusDetails[TradingView.Series.STATUS_RESOLVING] = {className: "loading", text: $.t("loading data"), priority: 1}, this.__statusDetails[TradingView.Series.STATUS_INVALID_SYMBOL] = {className: "invalid", text: $.t("invalid symbol"), showBatsWarn: !1, priority: 1}, this.__statusDetails[TradingView.Series.STATUS_OFFLINE] = {className: "connecting", text: $.t("retrying"), priority: 1}, this.__statusDetails[TradingView.Series.STATUS_EOD] = this.__statusDetails[TradingView.Series.STATUS_PULSE] = {className: "eod", text: $.t("eod data"), priority: 1}, this.__statusDetails[TradingView.Series.STATUS_DELAYED] = {className: "delayed", title: $.t("Quotes are delayed by 10 min and updated every 30 seconds"), text: $.t("eod delayed"), priority: 1}, this.__statusDetails[TradingView.Series.STATUS_DELAYED_STREAMING] = {className: "delayed-streaming", text: $.t("delayed"), priority: 1}, this.__statusDetails[TradingView.Series.STATUS_READY] = this.__statusDetails.defaults = {className: "realtime", text: $.t("realtime"), priority: -1}, this.__statusDetails.pre_market = {text: $.t("pre-market"), className: "pre-market", priority: 0}, this.__statusDetails.post_market = {text: $.t("post-market"), className: "post-market", priority: 0}, this.__statusDetails.out_of_session = {text: $.t("closed"), className: "out-of-session", priority: 0}, this.__statusDetails.market = this.__statusDetails.defaults), this.__statusDetails
};
D7.prototype._updateDataAndMarketStatus = function (n, t) {
    var i = this._resultingStatusRecord(n, t);
    this.indicatorText.removeClass().addClass("series-status-text " + i.className);
    this.indicatorText.find(".text").html(i.text)
};
D7.prototype._resultingStatusRecord = function (n, t) {
    if (n) {
        var r = this._statusDetails()[n], i = this._statusDetails()[t];
        return i || (i = this._statusDetails().defaults), i.priority > r.priority ? i : r
    }
    return this._statusDetails()[t]
};
D7.prototype.updateIndicatorImagePosition = function () {
    var n = this.indicatorImage;
    this.indicatorImage && n.css("marginRight", this.maxRhsPriceAxisWidth)
};
D7.prototype._startSpinner = function (n) {
    "function" == typeof Spinner && !this._spinner && (n = $(n).get(0)) && (this._spinner = new Spinner({lines: 15, length: 0, width: 6, radius: 20, corners: 1, rotate: 0, direction: 1, color: "#333", speed: .75, trail: 74, shadow: !1, hwaccel: !1, className: "spinner", top: "50%", left: "50%"}).spin(n))
};
D8 = function (n) {
    function nt() {
        var n, t;
        if (wt && wt(s), n = e || {}, e = {width: s.width(), height: s.height()}, t = !1, n.height === e.height && n.width === e.width && f || (t = !0), t)if (u)p(c); else for (n = 0; n < f.count; n++)p(n)
    }

    function p(n) {
        var r = t[n], i;
        r && (i = u ? D8.LayoutTemplates.s.sizer(0, e, et, ot) : f.sizer(n, e, et, ot), t[n].wrap.css({width: i.width || 0, height: i.height || 0, top: i.top || 0, left: i.left || 0}), r.metrics && r.metrics.width === i.width && r.metrics.height === i.height || (r.metrics = i, r.Q3 && r.Q3.resize()))
    }

    function ct(n) {
        var r, u, e, f;
        n = $.extend({Q6: ft}, n || {});
        u = $(document.createElement("div")).addClass("chart-container").appendTo(s).css("position", "absolute");
        u.on("mousedown touchstart", function () {
            i.setValue(r)
        });
        return e = t.length, f = {wrap: u}, t.push(f), p(e), n.jqParent = u, f.Q3 = r = new D7(n), ft.firstWidgetInitialized || r.chartWidgetInitialized.subscribe(null, function () {
            try {
                JsBridge.sendEvent("chart_widget_initialized")
            } catch (n) {
            }
            ft.firstWidgetInitialized = !0
        }, !0), n.containsData ? r.finishInitWithoutConnect() : r.connect(), lt(), at(), r
    }

    function tt(n, o) {
        var l, h;
        for (r = n, u = o, st.setValue(u), f = D8.LayoutTemplates[n], l = f.count, e = {width: s.width(), height: s.height()}, h = 0; h < l || h < t.length; h++)(o ? c === h : h < l) ? (t[h] ? (s.append(t[h].wrap), t[h].Q3.isDetached = !1) : ct($.extend({}, k, b.shift() || (i.value() ? {content: i.value().state()} : null) || {})), t[h].wrap.toggleClass("multiple", 1 < l), p(h)) : t[h] && (t[h].Q3.isDetached = !0, t[h].wrap.detach());
        lt()
    }

    function lt() {
        var r = Math.min(f.count, t.length) - 1, n;
        0 > r ? i.deleteValue() : (n = c, 0 > n && (n = 0), n > r && (n = r), i.setValue(t[n].Q3))
    }

    function at() {
        for (var i, n = t.length; n--;)i = n === c, t[n].wrap.toggleClass("active", i).toggleClass("inactive", !i)
    }

    function it(n) {
        var t = n.mainSeries().properties();
        t.style.subscribe(null, rt);
        rt(t.style);
        n.model().onSelectedSourceChanged().subscribe(null, ut);
        ut(n.selectedSource())
    }

    function rt(n) {
        g.setValue(n.value())
    }

    function ut(n) {
        ht.setValue(n)
    }

    function vt(n) {
        for (var u, i = !1, r = 0; r < t.length; r++)u = t[r].Q3, (u.model().mainSeries().properties().symbol.value() !== n || J77.enabled("same_data_requery")) && (i || (D77.beginUndoMacro("Change Symbol"), i = !0), u.setSymbol(n));
        i && D77.endUndoMacro()
    }

    function yt(n) {
        return"s" === n || window.user && user.is_pro || k.containsData || w ? n : (D83.showGoProDialog({feature: "multipleCharts"}), "s")
    }

    var ft = this, et = 2, ot = 0, i = new WatchedValue, w = !1, t = [], c = 0, e = null, f = null, r = "s", b = [], l = new WatchedValue(!1), a = new WatchedValue(!1), o = new WatchedValue(TVSettings.getBool("chart.syncCrosshair", !0)), pt = o.value(), k, g, ht, h;
    o.subscribe(function (n) {
        pt = n = !!n;
        TVSettings.setValue("chart.syncCrosshair", n)
    });
    var v = new WatchedValue(r), u = !1, st = new WatchedValue(u);
    n = n || {};
    "padding"in n && (et = n.padding);
    "edge"in n && (ot = n.edge);
    k = n.widgetOptions || {};
    k.readOnly && (w = !0);
    var y = n.metaInfo || {}, d = {id: new WatchedValue(y.id), name: new WatchedValue(y.name), description: new WatchedValue(y.description), username: new WatchedValue(y.username), uid: new WatchedValue(y.uid)}, s = $(n.jqParent).eq(0), wt = n.onResize;
    if (this.updateLayout = nt, g = new WatchedValue, ht = new WatchedValue, g.subscribe(function (n) {
        var t = i.value(), r;
        t && (t = t.model()) && (r = t.mainSeries().properties().style, r.value() !== n && t.setChartStyleProperty(r, n, "Change Series Style"))
    }), h = null, i.subscribe(function (n) {
        if (n) {
            for (var i, r = t.length; r--;)if (t[r].Q3 === n) {
                i = r;
                break
            }
            if (!isFinite(i))throw Error("Cannot make detached ChartWidget active");
            c !== i && (c = i, at());
            h !== n && (h && (h.modelCreated().unsubscribe(null, it), i = h.model()) && (i.mainSeries().properties().style.unsubscribe(null, rt), i.model().onSelectedSourceChanged().unsubscribe(null, ut), h = null), n && ((i = n.model()) ? it(i) : n.modelCreated().subscribe(null, it), h = n))
        }
    }, {callWithLast: !0}), $.extend(this, {createChartWidget: ct, getAll: function () {
        return t.map(function (n) {
            return n.Q3
        })
    }, destroy: function () {
        return t.forEach(function (n) {
            n.Q3.destroy()
        })
    }, layout: v, maximizeCurrentChart: st, activeChartWidget: i, activeChartStyle: g, selectedSource: ht.readonly(), metaInfo: d, state: function (n) {
        for (var u = [], f = D8.LayoutTemplates[r].count, i = 0; i < f; i++)u.push(t[i].Q3.state(n));
        return n = {layout: r, charts: u}, l.value() && (n.symbolLock = 1), a.value() && (n.intervalLock = 1), n
    }, asyncState: function (n) {
        for (var u = $.Deferred(), f = [], e = D8.LayoutTemplates[r].count, i = 0; i < e; i++)f.push(t[i].Q3.asyncState(n));
        return $.when.apply($, f).then(function () {
            for (var t = {charts: []}, n = 0; n < arguments.length; n++)t.charts.push(arguments[n]);
            u.resolve(t)
        }), u
    }, readOnly: function () {
        return w
    }, lock: {symbol: l, setSymbolLockWithUndo: function (n) {
        var r;
        if (n !== l.value()) {
            if (D77.beginUndoMacro("Symbol Lock"), n)for (var f = i.value(), e = f.getSymbol(), u = 0; u < t.length; u++)r = t[u].Q3, r !== f && r.getSymbol() !== e && r.setSymbol(e);
            D77.setWatchedValue(l, n, "Symbol Lock");
            D77.endUndoMacro()
        }
    }, interval: a, setIntervalLockWithUndo: function (n) {
        var r;
        if (n !== a.value()) {
            if (D77.beginUndoMacro("Interval Lock"), n)for (var f = i.value(), e = f.getResolution(), u = 0; u < t.length; u++)r = t[u].Q3, r !== f && r.getResolution() !== e && r.setResolution(e);
            D77.setWatchedValue(a, n, "Resolution Lock");
            D77.endUndoMacro()
        }
    }, crosshair: o}, setSymbol: function (n) {
        l.value() ? vt(n) : i.value().setSymbol(n)
    }, setResolution: function (n) {
        var r, u, f;
        if (a.value()) {
            for (r = !1, u = 0; u < t.length; u++)f = t[u].Q3, f.model().mainSeries().properties().interval.value() !== n && (r || (D77.beginUndoMacro("Change Resolution"), r = !0), f.setResolution(n));
            r && D77.endUndoMacro()
        } else i.value().setResolution(n)
    }, updateLayout: nt, images: function (n) {
        if (n && n.onlyActiveChart || u)return{layout: "s", hidpiRatio: window.hidpiCanvasRatio || 1, charts: [i.value().images()]};
        n = [];
        for (var o = f.count, e = 0; e < t.length && e < o; e++)n.push(t[e].Q3.images());
        return{layout: r, hidpiRatio: window.hidpiCanvasRatio || 1, charts: n}
    }, syncCrosshair: function (n, i) {
        var o, r, e;
        if (pt && !u)for (o = f.count, r = 0; r < t.length && r < o; r++)e = t[r].Q3, e !== i && (e = e.model()) && e.model().setExternalPosition(n)
    }, setSymbolAll: vt, clearChartMetaInfo: function () {
        d.id.setValue(void 0);
        d.uid.setValue(void 0);
        d.name.setValue(void 0)
    }}), n = n.content) {
        for (n.charts || (n = {layout: "s", charts: [n]}), r = yt(n.layout || "s"), o = 0; o < n.charts.length; o++)b.push({content: n.charts[o]});
        n.symbolLock && l.setValue(!0);
        n.intervalLock && a.setValue(!0);
        n = null
    }
    v.setValue(r);
    tt(r, u);
    b.splice(0, b.length);
    v.subscribe(function (n) {
        tt(n, !1)
    });
    v.hook = function (n) {
        return n === this.value() ? n : yt(n)
    };
    w && (v.writeLock = !0);
    st.subscribe(function (n) {
        n !== u && tt(r, n)
    });
    $(window).on("resize", nt)
};
D8.LayoutTemplates = {s: {title: "1 chart", count: 1, sizer: function (n, t, i, r) {
    return{width: t.width - r - r, height: t.height - r - r, top: r, left: r}
}}, "2h": {title: "2-up Horizontal", count: 2, sizer: function (n, t, i, r) {
    var f = t.width - r - r, u;
    t = t.height - r - r;
    u = f - i >> 1;
    switch (n) {
        case 0:
            return{width: u, height: t, top: r, left: r};
        case 1:
            return n = i + u, {width: f - n, height: t, top: r, left: r + n}
    }
}}, "2v": {title: "2-up Vertical", count: 2, sizer: function (n, t, i, r) {
    var f = t.width - r - r, u;
    t = t.height - r - r;
    u = t - i >> 1;
    switch (n) {
        case 0:
            return{width: f, height: u, top: r, left: r};
        case 1:
            return n = i + u, {width: f, height: t - n, top: n + r, left: r}
    }
}}, "3h": {title: "3-up Horizontal", count: 3, sizer: function (n, t, i, r) {
    var f = t.width - r - r, u;
    t = t.height - r - r;
    u = (f - i - i) / 3 | 0;
    switch (n) {
        case 0:
            return{width: u, height: t, top: r, left: r};
        case 1:
            return{width: u, height: t, top: r, left: i + u + r};
        case 2:
            return n = 2 * (i + u), {width: f - n, height: t, top: r, left: n + r}
    }
}}, "3v": {title: "3-up Vertical", count: 3, sizer: function (n, t, i, r) {
    var f = t.width - r - r, u;
    t = t.height - r - r;
    u = (t - i - i) / 3 | 0;
    switch (n) {
        case 0:
            return{width: f, height: u, top: r, left: r};
        case 1:
            return{width: f, height: u, top: i + u + r, left: r};
        case 2:
            return n = 2 * (i + u), {width: f, height: t - n, top: n + r, left: r}
    }
}}, "3s": {title: "3-up Stacked", count: 3, sizer: function (n, t, i, r) {
    var u = t.height - r - r, f = u - i >> 1;
    t = t.width - r - r - i >> 1;
    switch (n) {
        case 0:
            return{width: t, height: u, left: r, top: r};
        case 1:
            return{width: t, height: f, left: t + i + r, top: r};
        case 2:
            return n = i + f, {width: t, height: u - n, left: t + i + r, top: n + r}
    }
}}, 4: {title: "4-up", count: 4, sizer: function (n, t, i, r) {
    var e = t.width - r - r, u, f;
    t = t.height - r - r;
    u = t - i >> 1;
    f = e - i >> 1;
    switch (n) {
        case 0:
            return{width: f, height: u, left: r, top: r};
        case 1:
            return n = u + i, {width: f, height: t - n, left: r, top: n + r};
        case 2:
            return i = f + i, {width: e - i, height: u, left: i + r, top: r};
        case 3:
            return n = u + i, i = f + i, {width: e - i, height: t - n, left: i + r, top: n + r}
    }
}}, 6: {title: "6-up", count: 6, sizer: function (n, t, i, r) {
    var e = t.width - r - r, f, u;
    t = t.height - r - r;
    f = t - i >> 1;
    u = (e - i - i) / 3 | 0;
    switch (n) {
        case 0:
            return{width: u, height: f, left: r, top: r};
        case 1:
            return n = f + i, {width: u, height: t - n, left: r, top: n + r};
        case 2:
            return{width: u, height: f, left: u + i + r, top: r};
        case 3:
            return n = f + i, {width: u, height: t - n, left: u + i + r, top: n + r};
        case 4:
            return u = u + i + u + i, {width: e - u, height: f, left: u + r, top: r};
        case 5:
            return u = u + i + u + i, n = f + i, {width: e - u, height: t - n, left: u + r, top: n + r}
    }
}}, 8: {title: "8-up", count: 8, sizer: function (n, t, i, r) {
    var e = t.width - r - r, f, u;
    t = t.height - r - r;
    f = t - i >> 1;
    u = e - 3 * i >> 2;
    switch (n) {
        case 0:
            return{width: u, height: f, left: r, top: r};
        case 1:
            return n = f + i, {width: u, height: t - n, left: r, top: n + r};
        case 2:
            return{width: u, height: f, left: u + i + r, top: r};
        case 3:
            return n = f + i, {width: u, height: t - n, left: u + i + r, top: n + r};
        case 4:
            return{width: u, height: f, left: u + i + u + i + r, top: r};
        case 5:
            return n = f + i, {width: u, height: t - n, left: u + i + u + i + r, top: n + r};
        case 6:
            return u = 3 * (u + i), {width: e - u, height: f, left: u + r, top: r};
        case 7:
            return u = 3 * (u + i), n = f + i, {width: e - u, height: t - n, left: u + r, top: n + r}
    }
}}};
CompareWidget.prototype.addCompareSymbol = function (n, t, i) {
    if ((t = this.Q5.activeChartWidget.value()) && (t = t.model())) {
        for (var e = t.mainSeries().interval(), u = t.studiesMetaData(), f, r = 0; r < u.size(); r++)"Compare@tv-basicstudies" === u.item(r).id && (f = u.item(r));
        n = {exchange: i, inputs: {symbol: n, resolution: e}};
        TradingView.trackEvent("GUI", "Add Compare");
        t.insertStudy(f, n)
    }
};
CompareWidget.prototype.removeCompareSymbol = function (n) {
    var t = this.Q5.activeChartWidget.value(), f, r, i, u;
    if (t && (t = t.model()))for (f = t.Q19(), r = 0; r < f.size(); r++)i = f.item(r), i._metaInfo && "Compare@tv-basicstudies" === i._metaInfo.id && (u = i.properties().inputs.symbol.value(), (u === n || this.symbolAlias[u] && this.symbolAlias[u] === n) && t.removeSource(i))
};
CompareWidget.prototype._createPredefinesList_normal = function () {
    var n = this;
    for (p in this.predefines)for (i in predefine = $('<div class="predefine-section">').appendTo(this._widget), this.predefines[p])line = $('<div class="predefine-line"><\/div>').appendTo(predefine), checkbox = $('<input type="checkbox" id="predefine-checkbox-' + this.symbolToId(this.predefines[p][i]) + '"/>').appendTo(line), checkbox.change({symbol: this.predefines[p][i]}, function (t) {
        $(this).is(":checked") ? n.addCompareSymbol(t.data.symbol) : n.removeCompareSymbol(t.data.symbol)
    }), $('<label for="predefine-checkbox-' + this.symbolToId(this.predefines[p][i]) + '">' + i + "<\/label>").appendTo(line);
    $('<div class="clear"><\/div>').appendTo(this._widget)
};
CompareWidget.prototype.init = function () {
    var r = this, n, t, i;
    this._widget = $('<div class="compare-widget"><\/div>');
    n = $('<div class="symbol-edit-widget">');
    this.input = $('<input type="text" class="symbol-edit with-plus single" placeholder="' + $.t("Company Comparison") + '" autocomplete="off">').appendTo(n);
    t = $('<a class="symbol-edit-plus" title="' + $.t("Company Comparison") + '"><span><\/span><\/a>').appendTo(n);
    i = D69.bindToInput(this.input, {callback: function (n) {
        r.addCompareSymbol(n)
    }, keepFocus: !0, clearAfterAccept: !0});
    t.click(function () {
        i.acceptTypeIn()
    });
    n.appendTo(this._widget);
    J77.enabled("charting_library") || this._createPredefinesList_normal()
};
CompareWidget.prototype.show = function () {
    var t = this.Q5.activeChartWidget.value(), f, r, u, n;
    if (t && (t = t.model()))for (p in t = t.Q19(), this.init(), this._widget.find('input[id^="predefine-checkbox"]').attr("checked", !1), this.predefines)for (i in this.predefines[p])for (f = this._widget.find("#predefine-checkbox-" + this.symbolToId(this.predefines[p][i])), r = 0; r < t.size(); r++)n = t.item(r), n._metaInfo && "Compare@tv-basicstudies" === n._metaInfo.id && (u = this.predefines[p][i], n = n.properties().inputs.symbol.value(), (n === u || this.symbolAlias[n] && this.symbolAlias[n] === u) && f.attr("checked", !0))
};
CompareWidget.prototype.symbolToId = function (n) {
    return n.replace(/[^a-z0-9]/gi, "_")
};
CompareWidget.prototype.focus = function () {
    Modernizr.touch || this.input.focus()
};
CompareDialog.prototype.tabChanged = function (n) {
    0 === n ? this.compareTab.focus() : this.addSymbolTab.focus()
};
CompareDialog.prototype.show = function () {
    var t, n, i;
    TradingView.trackEvent("GUI", "Compare Add");
    t = D83.createDialog("Compare Add", {hideTitle: !0, dragHandle: ".properties-tabs"});
    n = t.find(".tv-dialog-content");
    t.css("min-width", 0);
    n.css("min-width", 0);
    i = $('<div class="properties-tabs"><\/div>').appendTo(n);
    $('<a href="#" class="properties-tabs-label"><\/a>').text($.t("Compare")).appendTo(i);
    $('<a href="#" class="properties-tabs-label"><\/a>').text($.t("Add Symbol")).appendTo(i);
    var n = $("<div>").appendTo(n), r = $('<div class="main-tree-page compare active">').appendTo(n), u = $('<div class="main-tree-page compare">').appendTo(n);
    return this.compareTab = new CompareWidget(this.Q6), this.addSymbolTab = new AddSymbolWidget(this.Q6), this.compareTab.show(), r.append(this.compareTab._widget), this.addSymbolTab.show(), u.append(this.addSymbolTab._widget), this.tabs = new D71(i, n, {saveTab: "CompareAddDialog.tab"}), this.tabs.tabChanged.subscribe(this, this.tabChanged), D83.applyHandlers(t), D83.positionDialog(t, this.position), t
};
AddSymbolWidget.prototype.init = function () {
    var i = this, n, t, r, u;
    this._widget = $('<div class="addsymbol-widget"><\/div>');
    n = $('<div class="symbol-edit-widget">');
    t = $('<input type="text" class="symbol-edit with-plus single" placeholder="' + $.t("Symbol") + '" autocomplete="off">').appendTo(n);
    this._input = t;
    r = $('<a class="symbol-edit-plus"><span><\/span><\/a>').appendTo(n);
    u = D69.bindToInput(t, {callback: function (n) {
        var t = i.Q5.activeChartWidget.value();
        t && t.addSymbol(n, i._checkbox.is(":checked"))
    }, keepFocus: !0, clearAfterAccept: !0});
    r.on("click", function () {
        u.acceptTypeIn()
    });
    n.appendTo(this._widget);
    n = $('<div class="opts-line">').appendTo(this._widget);
    t = "addsymbol-widget-overlay-" + TradingView.guid();
    this._checkbox = $('<input type="checkbox" id="' + t + '">').appendTo(n);
    this._checkbox.on("click", function () {
        TVSettings.setValue("showAddSymbolDialog.checkboxState", $(this).is(":checked"))
    });
    $('<label for="' + t + '">' + $.t("Overlay the main chart") + "<\/label>").appendTo(n)
};
AddSymbolWidget.prototype.show = function () {
    this.focus();
    this._checkbox.attr("checked", TVSettings.getBool("showAddSymbolDialog.checkboxState", !0))
};
AddSymbolWidget.prototype.focus = function () {
    Modernizr.touch || this._input.focus()
};
TradingView.SYMBOL_SEARCH_MAX_LENGTH = 100;
D4 = function () {
};
D4.prototype._createBackButton = function (n) {
    var t = n.createGroup().appendTo(n._$left);
    n._backButton = $('<div class="mobile-back-button"><i><\/i><\/div>').click(function () {
        1 < window.history.length && window.history.back();
        window.location.pathname = "/"
    }).appendTo(t)
};
D4.prototype._createBarsGroup = function (n) {
    var t = this.createGroup({single: !0});
    return n._style_list.element().appendTo(t), t
};
D4.prototype._createPropertiesGroup = function (n, t) {
    var r = this.createGroup({single: !0}), i;
    if (!this._onWidget) {
        i = $("<span>").addClass("button iconed properties apply-common-tooltip").append($("<i>")).appendTo(r);
        i.on(n, function (n) {
            n.pageX = i.offset().left;
            n.pageY = i.offset().top + i.height() + 15;
            n = t.activeChartWidget.value().showChartProperties({_lastEvent: n});
            i.addClass("active");
            n.on("destroy", function () {
                i.removeClass("active")
            })
        });
        i.attr("title", $.t("Chart Properties"))
    }
    return r
};
D4.prototype._createCompareGroup = function (n, t, i) {
    n = this.createGroup({single: !0});
    var r = $('<a class="button iconed toggle-caption compare apply-common-tooltip">').append($("<i>")).append($('<span class="caption">Compare<\/span>')).appendTo(n);
    this._compareButton = r;
    this._compareButton.on(i, function (n) {
        n.preventDefault();
        n = new CompareDialog(t).show();
        r.addClass("active");
        n.on("destroy", function () {
            r.removeClass("active")
        })
    });
    return this._compareButton.attr("title", $.t("Compare or Add Symbol")), n
};
D4.prototype._createIndicatorsGroup = function (n) {
    var t = this.createGroup({single: !0});
    this._indicatorsButton = $('<a class="button iconed toggle-caption indicators' + (this._onWidget ? " no-last" : "") + ' apply-common-tooltip">').append($("<i>")).append($('<span class="caption">Indicators<\/span>')).appendTo(t);
    this._indicatorsButton.attr("title", $.t("Indicators, Fundamentals, Economy and Add-ons"));
    this._indicatorsButton.on(n, function (n) {
        n.stopPropagation();
        n.preventDefault();
        studyMarket.isVisible() ? studyMarket.hide() : studyMarket.show()
    });
    return TradingView.keyboardBinder.registerListener("IndicatorsHotkey", function (n) {
        if ("47" == n.which && $(n.target).is("body") && !studyMarket.isVisible())return studyMarket.show(), studyMarket.selectSearchPage(), n.preventDefault(), n.stopPropagation(), !0
    }), studyMarket.visibilityChanged.subscribe(this, function (n) {
        this._indicatorsButton.toggleClass("active", n)
    }), t
};
D4.prototype.createGroup = function (n) {
    n || (n = {});
    var t = $("<div>").addClass("group");
    return n.right && t.addClass("right"), n.single ? t.addClass("space-single") : null, t
};
D4.prototype.bindToModel = function () {
    var n = this.Q4.model();
    n.mainSeries().properties();
    this.Q0 = n
};
D4.prototype.backButton = function () {
    return this._backButton
};
D4.prototype.saveLoadWidget = function () {
    return this._saveLoad || console.warn("No save-load widget created in footer")
};
D4.prototype.styleIconPosition = function (n) {
    return"-%1px 0".replace("%1", 19 * ~~n)
};
D4.styleIconPosition = D4.prototype.styleIconPosition;
D5 = function (n) {
    var r, o;
    n = n || {};
    var i = this.Q5 = n.Q6, s = this.Q4 = i.activeChartWidget.value(), f = this._onWidget = s.onWidget(), u = this, h = Modernizr.touch ? "touchstart" : "click", t = $(".header-chart-panel").eq(0);
    if (this._$right = t.find(".right"), this._$left = t.find(".left"), this._itemsVisibility = n.itemsVisibility, TradingView.isMobileView && !TradingView.winMobileMode && this._createBackButton(this), !i.readOnly()) {
        if (J77.enabled("header_symbol_search")) {
            var t = this.createGroup().appendTo(this._$left), t = $('<div class="symbol-edit-widget no-last"><\/div>').appendTo(t), e = $('<div class="symbol-edit-wrap">').appendTo(t), t = null;
            J77.enabled("charting_library") || (t = $('<div class="symbol-edit-buttonswrap">').appendTo(e), t = $('<div class="spread-actions">').appendTo(t).on("mousedown", function (n) {
                n.preventDefault()
            }));
            r = $('<div class="symbol-edit-inputspacer">').appendTo(e);
            o = $('<input type="text" class="symbol-edit" maxlenght="' + TradingView.SYMBOL_SEARCH_MAX_LENGTH + '">').appendTo(r);
            D69.bindToInput(o, {syncWithChartWidget: !0, spreadActions: t}), function () {
                var n = !1;
                o.on("focus", function () {
                    n = !0;
                    e.addClass("expanded")
                });
                o.on("blur", function () {
                    n = !1;
                    setTimeout(function () {
                        n || e.removeClass("expanded")
                    }, 40)
                })
            }()
        }
        if (J77.enabled("header_resolutions")) {
            if (t = this.createGroup({single: !0}).appendTo(this._$left), r = {onWidget: f, submenuBtnAddClass: "apply-common-tooltip"}, n.interval_options && $.extend(r, n.interval_options), !TradingView.isMobileView && J77.enabled("items_favoriting") || $.extend(r, {notShowQuicks: !0, popupSpacing: 1}), TradingView.isOnFeaturePage && $.extend(r, {notShowQuicks: !0}), this._interval = new D21(r), J77.enabled("charting_library"))Q16.on("configuration_received", function () {
                u._interval.forceUpdate()
            });
            this._interval.element().addClass("no-first").appendTo(t);
            this._interval.onResize.subscribe(i, i.updateLayout);
            n.favoriteIntervals && this._interval.setUpStarredItemsList(n.favoriteIntervals)
        }
        J77.enabled("header_chart_type") && (t = J77.enabled("charting_library") ? [
            {id: TradingView.Series.STYLE_BARS, title: $.t("Bars")},
            {id: TradingView.Series.STYLE_CANDLES, title: $.t("Candles")},
            {id: TradingView.Series.STYLE_HOLLOW_CANDLES, title: $.t("Hollow Candles")},
            {id: TradingView.Series.STYLE_LINE, title: $.t("Line")},
            {id: TradingView.Series.STYLE_AREA, title: $.t("Area")},
            {id: TradingView.Series.STYLE_HEIKEN_ASHI, title: $.t("Heiken Ashi")}
        ] : [
            {id: TradingView.Series.STYLE_BARS, title: $.t("Bars")},
            {id: TradingView.Series.STYLE_CANDLES, title: $.t("Candles")},
            {id: TradingView.Series.STYLE_HOLLOW_CANDLES, title: $.t("Hollow Candles")},
            {id: TradingView.Series.STYLE_HEIKEN_ASHI, title: $.t("Heiken Ashi")},
            {id: TradingView.Series.STYLE_LINE, title: $.t("Line")},
            {id: TradingView.Series.STYLE_AREA, title: $.t("Area")},
            {id: TradingView.Series.STYLE_RENKO, title: $.t("Renko")},
            {id: TradingView.Series.STYLE_PB, title: $.t("Line Break")},
            {id: TradingView.Series.STYLE_KAGI, title: $.t("Kagi")},
            {id: TradingView.Series.STYLE_PNF, title: $.t("Point & Figure")}
        ], r = function () {
            if (!n.favoriteChartTypes)return[];
            var t = {Bars: TradingView.Series.STYLE_BARS, Candles: TradingView.Series.STYLE_CANDLES, Line: TradingView.Series.STYLE_LINE, Area: TradingView.Series.STYLE_AREA, "Heiken Ashi": TradingView.Series.STYLE_HEIKEN_ASHI, "Hollow Candles": TradingView.Series.STYLE_HOLLOW_CANDLES};
            return n.favoriteChartTypes.map(function (n) {
                return t[n]
            })
        }() || [1, 4, 5, 6], !TradingView.isMobileView && !TradingView.isOnFeaturePage || J77.enabled("charting_library") || (r = []), f && (r = [1, 3]), this._style_list = new D14("StyleWidget", $.map(t, function (n) {
            var t = n.id, i = {image: TradingView.wrapUrl("url('/static/chart-client/css/images/bartype-icons.png')"), offset: u.styleIconPosition(t), quickOffset: TradingView.isMobileView ? "-%1px -38px".replace("%1", 19 * ~~t) : u.styleIconPosition(t), offsetActive: "-%1px -19px".replace("%1", 19 * ~~t)};
            return{id: t, title: n.title, icon: i, favoriteButton: {icon: i, title: n.title, addClass: "apply-common-tooltip"}}
        }), {defaultFavorites: r, addClass: "chart-style-widget", popupAddClass: "chart-style-popup", notShowQuicks: !!TradingView.isMobileView || !J77.enabled("items_favoriting"), showJustDefaultQuicks: J77.enabled("predefined_items_only_may_be_starred"), tooltip: $.t("Bar's Style"), addTooltipClass: "apply-common-tooltip"}), i.activeChartStyle.subscribe(function (n) {
            u._style_list.setValue(n)
        }, {callWithLast: !0}), u._style_list.onChange().subscribe(this, function (n) {
            i.activeChartStyle.setValue(n)
        }), u._style_list.onResize().subscribe(i, i.updateLayout));
        studyMarket = new D1(i, window.user, {onWidget: f});
        this._createLayout(n, u, h)
    }
    J77.enabled("header_saveload") && (t = this.createGroup({single: !0}).appendTo(this._$left), f = $("<div>").addClass("save-load-buttons in-header").appendTo(t), this._saveLoad = new TradingView.SaveLoadWidget(f, i, {popupDirection: "down", popupReverse: !0}), this._saveLoad.onTitleSizeChanged.subscribe(i, i.updateLayout));
    this.Q4.readOnly() || TradingView.isMobileView || !J77.enabled("header_undo_redo") || (this._undoRedo = new D78(this._$right, this.Q4), this._undoRedo.undoElement().addClass("apply-common-tooltip"), this._undoRedo.redoElement().addClass("apply-common-tooltip"));
    J77.enabled("header_screenshot") && $('<span class="button screenshot iconed"><i><\/i><\/span>').click(function (t) {
        getImage(i, {snapshotUrl: n.snapshotUrl}, u._onScreenshotReady);
        t.preventDefault()
    }).appendTo(this._$right);
    !TradingView.isMobileView && J77.enabled("header_fullscreen_button") && (this._fullscreen = new TradingView.FullscreenWidget, this._fullscreen.element().addClass("apply-common-tooltip").appendTo(this._$right));
    J77.enabled("header_widget_dom_node") || $(".header-chart-panel").css("display", "none");
    s.withModel(this, D4.prototype.bindToModel)
};
inherit(D5, D4);
D5.prototype.onScreenshotReady = function (n) {
    this._onScreenshotReady = n
};
D5.prototype._createLayout = function (n, t, i) {
    var r = [];
    J77.enabled("header_chart_type") && r.push(this._createBarsGroup(t));
    J77.enabled("header_settings") && r.push(this._createPropertiesGroup(i, n.Q6));
    J77.enabled("header_indicators") && r.push(this._createIndicatorsGroup(i));
    J77.enabled("header_compare") && r.push(this._createCompareGroup(t, n.Q6, i));
    r.forEach(function (n) {
        n.appendTo(this._$left)
    }, this)
};
TradingView.LineToolPropertiesWidget = function (n) {
    this.Q5 = n;
    this._bindings = new List;
    this.init();
    this.attachHandlers()
};
TradingView.LineToolPropertiesWidget.prototype._POSITION_KEY = "properties_toolbar.position";
TradingView.LineToolPropertiesWidget.prototype.activeChartWidget = function () {
    return this.Q5.activeChartWidget.value()
};
TradingView.LineToolPropertiesWidget.prototype.selectedSource = function () {
    return this.Q5.selectedSource.value()
};
TradingView.LineToolPropertiesWidget.prototype.init = function () {
    var t = this, n = $('<div class="properties-toolbar"><div class="drag-handler"><i><\/i><\/div><\/div>').css("position", "absolute").hide().draggable({handle: ".drag-handler", stop: function () {
        TVSettings.setJSON(t._POSITION_KEY, n.offset())
    }});
    $(window).resize(function () {
        t._visible && t._updatePositoin()
    });
    this._$widget = n;
    this._$templates = $('<div class="tools-group">').hide().appendTo(n);
    this._$properties = $('<div class="tools-group properties-tools-group">').hide().appendTo(n);
    this._$sourceActions = $('<div class="tools-group">').hide().appendTo(n);
    this.createSourceActions();
    this._$widget.appendTo(document.body)
};
TradingView.LineToolPropertiesWidget.prototype.attachHandlers = function () {
    TradingView.drawingState.tool.subscribe(function (n) {
        this.onToolChanged(n)
    }.bind(this), {callWithLast: !0});
    this.Q5.selectedSource.subscribe(function (n) {
        this.onSourceChanged(n)
    }.bind(this))
};
TradingView.LineToolPropertiesWidget.prototype.onToolChanged = function (n, t) {
    if (n && -1 != n.toLowerCase().indexOf("linetool"))t = t instanceof _52 ? t : new _52(n.toLowerCase()), this.hideSourceActions(), this.showPropertiesOf(n, t), this.showTemplatesOf({tool: n, properties: t}), this.updateVisibility(); else if (this.selectedSource())this.onSourceChanged(this.selectedSource()); else this.hide()
};
TradingView.LineToolPropertiesWidget.prototype.findSourceOnWidget = function (n) {
    for (var r, t, i = 0; i < this.activeChartWidget().model().panes().size(); i++)for (r = this.activeChartWidget().model().panes().item(i).orderedSources(), t = 0; t < r.length; t++)if (r[t] === n)return r[t]
};
TradingView.LineToolPropertiesWidget.prototype.onSourceChanged = function (n) {
    n ? (n instanceof J47 && !(n instanceof J96) && this.findSourceOnWidget(n) ? (!n.userEditEnabled() || "LineToolBrush" !== n.toolname && this.activeChartWidget().model().lineBeingCreated() ? this.hideSourceActions() : this.showSourceActions(), this.showPropertiesOf(n.getConstructor(), n.properties()), this.showTemplatesOf({source: n}), this.updateVisibility()) : this.hide(), this._setupToggleLockButton(n)) : this.hide()
};
TradingView.LineToolPropertiesWidget.prototype.showTemplatesOf = function (n) {
    var t = n.source, r, i, u, f;
    t ? (r = t.getConstructor(), i = t.properties()) : (r = n.tool, i = n.properties);
    this._$templates.hide().empty();
    u = this;
    n = new TradingView.LinetoolTemplatesList(r, function (n) {
        t ? (t.restoreTemplate(n), u.activeChartWidget().model().model().updateSource(this._linetool), u.onSourceChanged(t)) : (i.merge(n), i.listeners().fire(this), i.saveDefaults(), u.onToolChanged(r, i))
    }, {buttonInner: " ", buttonClass: "button icon-list with-arrow apply-common-tooltip", defaultsCallback: function () {
        i.restoreFactoryDefaults();
        u.showPropertiesOf(r, i)
    }, saveAsText: "Save Drawing Template As...", applyDefaultText: "Apply Default Drawing Template", getDataForSaveAs: t ? function () {
        return t.template()
    } : null});
    f = n.createButton().attr("title", "Templates");
    this.templatesList = n;
    this._$templates.append(f);
    J77.enabled("charting_library") || this._$templates.show();
    this._templatesVisible = !0
};
TradingView.LineToolPropertiesWidget.prototype.createSourceActions = function () {
    function t(n, t, i) {
        return $(document.createElement("div")).addClass("button apply-common-tooltip").addClass("icon-" + n.toLowerCase()).attr("title", t).on("click", function (n) {
            n.stopPropagation();
            i(n)
        })
    }

    var n = this, u = t("Settings", $.t("Settings"), function () {
        new EditObjectDialog(n.selectedSource(), n.activeChartWidget().model()).show()
    }), i, r;
    this.$zOrder = t("ZOrder", $.t("Visual Order"), function () {
        n.zOrderButtonHandler()
    });
    this.$zOrder.addClass("with-arrow");
    TradingView.bindPopupMenu(this.$zOrder, null, {direction: "down", event: "button-popup", reverse: !1, notCloseOnButtons: !0});
    this.$clone = t("Clone", $.t("Clone"), function () {
        n.activeChartWidget().paneWidgets().item(0).cloneLineTool(n.selectedSource())
    });
    this.$lock = t("Lock", $.t("Lock"), function () {
        n.activeChartWidget().toggleLockSelectedObject()
    });
    this._lockChangeListener = function (t) {
        n.$lock.toggleClass("active", t.value())
    };
    i = t("Hide", $.t("Hide"), function () {
        n.activeChartWidget().hideSelectedObject()
    });
    r = t("Remove", $.t("Remove"), function () {
        n.activeChartWidget().model().removeSelectedSource()
    });
    this._$sourceActions.append(u, this.$zOrder, this.$clone, this.$lock, i, r)
};
TradingView.LineToolPropertiesWidget.prototype.zOrderButtonHandler = function () {
    this.$zOrder.hasClass("active") || this.$zOrder.trigger("button-popup", [this._getZOrderActions()])
};
TradingView.LineToolPropertiesWidget.prototype._getZOrderActions = function () {
    var i = [], n = this.selectedSource(), t = this.activeChartWidget().model(), r = {title: $.t("Bring to Front"), action: function () {
        t.bringToFront(n)
    }}, u = {title: $.t("Send to Back"), action: function () {
        t.sendToBack(n)
    }}, f = {title: $.t("Bring Forward"), action: function () {
        t.changeZOrder(n, 1)
    }}, e = {title: $.t("Send Backward"), action: function () {
        t.changeZOrder(n, -1)
    }}, o = t.paneForSource(this.selectedSource()).getZOrderMinMax();
    return n.zorder() === o.minZOrder && (u.disabled = !0, e.disabled = !0), n.zorder() === o.maxZOrder && (f.disabled = !0, r.disabled = !0), i.push(r, u, f, e), i
};
TradingView.LineToolPropertiesWidget.prototype._getPossibleProperty = function (n) {
    for (var i, t = [], u = this._defaultToolProperties(), f = !0, e = !1, r = 0; r < u.length; r++)i = u[r], i.name in n ? (f = !1, t.push(i)) : i.divider && (t.push(i), e = !0);
    return 2 === t.length && e && (t = $.grep(t, function (n) {
        return!n.divider
    })), f ? [] : t
};
TradingView.LineToolPropertiesWidget.prototype.showPropertiesOf = function (n, t) {
    var r, u, i, f;
    if (this._toolExceptionCases || (this._toolExceptionCases = this._createToolExceptionCases()), r = this._toolExceptionCases[n] || this._getPossibleProperty(t), this._$properties.empty(), this._propertiesVisible = !1, r.length) {
        for (u = 0; u < r.length; u++)i = r[u], i.divider ? this._$properties.append('<div class="divider"><\/div>') : (f = t[i.name], ("function" != typeof i.showIf || i.showIf(f, t)) && (i = new this.propertyControl(this, f, i, t), this._$properties.append(i.el), this._propertiesVisible = !0));
        this._$properties.toggle(this._propertiesVisible)
    } else this._$properties.hide()
};
TradingView.LineToolPropertiesWidget.prototype.showSourceActions = function () {
    var n = TradingView.className(this.selectedSource().constructor);
    this.activeChartWidget().model().model().isSingleInstanceLineTool(n) ? this.$clone.hide() : this.$clone.show();
    this._$sourceActions.show();
    this._sourceActionsVisible = !0
};
TradingView.LineToolPropertiesWidget.prototype.hideSourceActions = function () {
    this._$sourceActions.hide();
    this._sourceActionsVisible = !1
};
TradingView.LineToolPropertiesWidget.prototype.updateVisibility = function () {
    this._propertiesVisible || this._sourceActionsVisible || this._templatesVisible ? this.show() : this.hide()
};
TradingView.LineToolPropertiesWidget.prototype.hide = function () {
    this._$widget.hide();
    this._setupToggleLockButton();
    this._visible = !1
};
TradingView.LineToolPropertiesWidget.prototype.show = function () {
    this._$widget.show();
    this._updatePositoin();
    this._visible = !0
};
TradingView.LineToolPropertiesWidget.prototype._setupToggleLockButton = function (n) {
    n != this._selectedSourceBk && (this._selectedSourceBk && this._selectedSourceBk.properties().frozen && this._selectedSourceBk.properties().frozen.unsubscribe(this, this._lockChangeListener), n && n.properties().frozen && (n.properties().frozen.subscribe(this, this._lockChangeListener), this.$lock.toggleClass("active", n.properties().frozen.value())), this._selectedSourceBk = n)
};
TradingView.LineToolPropertiesWidget.prototype._updatePositoin = function () {
    var t = this._$widget, n = $(window), r = n.height() - t.outerHeight(), n = n.width() - t.outerWidth(), i = TVSettings.getJSON(this._POSITION_KEY, {left: n / 2, top: headerChartPanel.outerHeight() + 15}), i = {top: Math.min(r, Math.max(i.top, 0)), left: Math.min(n, Math.max(i.left, 0))};
    t.css(i);
    t.draggable("option", "containment", [0, 0, n, r])
};
TradingView.LineToolPropertiesWidget.prototype.bindControl = function (n) {
    this._bindings.append(n)
};
TradingView.LineToolPropertiesWidget.prototype.clearBindings = function (n) {
    for (n = this._bindings.size(); n--;)this._bindings.item(n).destroy();
    this._bindings.clear()
};
TradingView.LineToolPropertiesWidget.prototype.propertyControl = function (n, t, i, r) {
    var f, u, e;
    t && i && n && i.inputType && ("combobox" !== i.inputType || i.comboboxOptions || console.warn('inputType combobox, needs "comboboxOptions" option'), this._toolbarWidget = n, f = i.inputType, "colorPicker" === f ? (u = Q7.prototype.createColorPicker(), i.icon && u.addClass("icon-" + i.icon), n.bindControl(new ColorBinding(u, t, !0, n.activeChartWidget().model()))) : "combobox" === f && (f = !0, !0 === i.simple ? (u = $.map(i.comboboxOptions, function (n) {
        return{value: n, html: '<div class="combobox-simple">' + n + "<\/div>"}
    }), f = !1) : u = $.map(i.comboboxOptions, function (n) {
        return{value: n.value, html: '<div class="combobox-icon icon-' + n.icon + '"><\/div>'}
    }), e = new HTMLHelper.Combobox(u, {horizontal: f}), u = e.render(), f && u.find(".items").width(32 * i.comboboxOptions.length + 14), i.propertyProxy && (t = i.propertyProxy(r, n.activeChartWidget().model())), n.bindControl(new Q11(e, t, null, !0, n.activeChartWidget().model()))), i.title && u.attr("title", i.title), "string" == typeof i.addClass && u.addClass(i.addClass), u.addClass("apply-common-tooltip"), this.el = u)
};
TradingView.LineToolPropertiesWidget.prototype.createLineEndPropertyProxy = function (n, t) {
    return function (i, r) {
        var u;
        return u = i[t].value() ? TradingView.LineToolPropertiesWidget.LINE_EXTEND : i[n].value(), u = new Property(u), u.subscribe(this, function (u) {
            u = u.value();
            2 > u ? (r.beginUndoMacro(""), i[n].setValue(u), i[t].setValue(!1)) : (r.beginUndoMacro(""), i[n].setValue(J47.LINEEND_NORMAL), i[t].setValue(!0));
            r.endUndoMacro()
        }), u
    }
};
TradingView.LineToolPropertiesWidget.LINE_EXTEND = 42;
TradingView.LineToolPropertiesWidget.prototype._defaultToolProperties = function () {
    return[
        {name: "color", inputType: "colorPicker", icon: "pencil", title: $.t("Color")},
        {name: "linecolor", inputType: "colorPicker", icon: "pencil", title: $.t("Color")},
        {name: "backgroundColor", inputType: "colorPicker", icon: "bucket", title: $.t("Background Color")},
        {divider: !0},
        {name: "linewidth", inputType: "combobox", comboboxOptions: [
            {value: 1, icon: "line-width-1"},
            {value: 2, icon: "line-width-2"},
            {value: 3, icon: "line-width-3"},
            {value: 4, icon: "line-width-4"}
        ], title: $.t("Width")},
        {name: "linestyle", title: $.t("Style"), inputType: "combobox", comboboxOptions: [
            {value: 0, icon: "line"},
            {value: 1, icon: "line-dotted"},
            {value: 2, icon: "line-dashed"}
        ]},
        {name: "leftEnd", title: $.t("Left End"), inputType: "combobox", comboboxOptions: [
            {value: J47.LINEEND_NORMAL, icon: "line-left-normal"},
            {value: J47.LINEEND_ARROW, icon: "line-left-arrow"},
            {value: TradingView.LineToolPropertiesWidget.LINE_EXTEND, icon: "line-left-extend"}
        ], propertyProxy: this.createLineEndPropertyProxy("leftEnd", "extendLeft")},
        {name: "rightEnd", title: $.t("Right End"), inputType: "combobox", comboboxOptions: [
            {value: J47.LINEEND_NORMAL, icon: "line-right-normal"},
            {value: J47.LINEEND_ARROW, icon: "line-right-arrow"},
            {value: TradingView.LineToolPropertiesWidget.LINE_EXTEND, icon: "line-right-extend"}
        ], propertyProxy: this.createLineEndPropertyProxy("rightEnd", "extendRight")}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases = function () {
    return[
        {name: "textcolor", title: $.t("Text color"), inputType: "colorPicker", icon: "font"},
        {name: "profitBackground", title: $.t("Profit Background Color"), inputType: "colorPicker", icon: "bucket"},
        {name: "stopBackground", title: $.t("Stop Background Color"), inputType: "colorPicker", icon: "bucket"},
        {name: "linecolor", title: $.t("Border color"), inputType: "colorPicker", icon: "pencil"}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases = function () {
    return[
        {name: "color", inputType: "colorPicker", icon: "pencil"}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases = function () {
    return[
        {name: "color", title: $.t("Text color"), inputType: "colorPicker", icon: "font"},
        {name: "backgroundColor", title: $.t("Background Color"), inputType: "colorPicker", icon: "bucket", showIf: function (n, t) {
            return t && t.fillBackground ? !!t.fillBackground.value() : !0
        }},
        {name: "borderColor", title: $.t("Border Color"), inputType: "colorPicker", icon: "pencil"},
        {name: "bordercolor", title: $.t("Border Color"), inputType: "colorPicker", icon: "pencil"},
        {divider: !0},
        {name: "fontsize", title: $.t("Font Size"), inputType: "combobox", simple: !0, addClass: "simple", comboboxOptions: [10, 11, 12, 14, 16, 20, 24, 28, 32, 40]}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases = function () {
    return[
        {name: "markerColor", title: $.t("Marker Color"), inputType: "colorPicker", icon: "pencil"},
        {name: "textColor", title: $.t("Text color"), inputType: "colorPicker", icon: "font"},
        {divider: !0},
        {name: "fontSize", title: $.t("Font Size"), inputType: "combobox", simple: !0, addClass: "simple", comboboxOptions: [10, 11, 12, 14, 16, 20, 24, 28, 32, 40]}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases = function () {
    return[
        {name: "linecolor", inputType: "colorPicker", icon: "pencil", title: $.t("Color")},
        {name: "backgroundColor", inputType: "colorPicker", icon: "bucket", showIf: function (n, t) {
            return t.fillBackground.value()
        }, title: $.t("Background Color")},
        {divider: !0},
        {name: "linewidth", inputType: "combobox", comboboxOptions: [
            {value: 1, icon: "line-width-1"},
            {value: 2, icon: "line-width-2"},
            {value: 3, icon: "line-width-3"},
            {value: 4, icon: "line-width-4"}
        ], title: $.t("Line Width")}
    ]
};
TradingView.LineToolPropertiesWidget.prototype._createToolExceptionCases = function () {
    return{LineToolRegressionTrend: [], LineToolGannSquare: [], LineToolFibTimeZone: [], LineToolBrush: TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases(), LineToolPolyline: TradingView.LineToolPropertiesWidget.prototype._brushPropertiesExceptionCases(), LineToolText: TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(), LineToolTextAbsolute: TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(), LineToolBalloon: TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(), LineToolCallout: TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(), LineToolPriceLabel: TradingView.LineToolPropertiesWidget.prototype._textPropertiesExceptionCases(), LineToolArrowMarkLeft: [], LineToolArrowMarkRight: [], LineToolArrowMarkUp: [], LineToolArrowMarkDown: [], LineToolFlagMark: [], LineToolThumbUp: [], LineToolThumbDown: [], LineToolElliottCircle: TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(), LineToolElliottSubminuette: TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(), LineToolElliottMinor: TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(), LineToolElliottMinorRetr: TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(), LineToolElliottMajorRetr: TradingView.LineToolPropertiesWidget.prototype._elliottPropertiesExceptionCases(), LineToolIcon: [
        {name: "color", title: $.t("Color"), inputType: "colorPicker", icon: "bucket"}
    ], LineToolNote: TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases(), LineToolNoteAbsolute: TradingView.LineToolPropertiesWidget.prototype._notePropertiesExceptionCases(), LineToolThreeDrivers: [
        {name: "color", title: $.t("Text color"), inputType: "colorPicker", icon: "pencil"}
    ], LineToolRiskRewardLong: TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases(), LineToolRiskRewardShort: TradingView.LineToolPropertiesWidget.prototype._riskPropertiesExceptionCases(), LineToolBarsPattern: [
        {name: "color", title: $.t("Color"), inputType: "colorPicker", icon: "bucket"}
    ], LineToolProjection: [
        {name: "color1", title: $.t("Background color 1"), inputType: "colorPicker", icon: "bucket"},
        {name: "color2", title: $.t("Background color 2"), inputType: "colorPicker", icon: "bucket"},
        {divider: !0},
        {name: "linewidth", inputType: "combobox", comboboxOptions: [
            {value: 1, icon: "line-width-1"},
            {value: 2, icon: "line-width-2"},
            {value: 3, icon: "line-width-3"},
            {value: 4, icon: "line-width-4"}
        ]}
    ]}
};
D6 = function (n) {
    var e = this, r, i, s, u, t, f, h, c;
    n = n || {};
    TradingView.drawingState.init();
    r = this._container = n.container;
    this.Q5 = n.Q6;
    this._container.on("contextmenu", function (n) {
        n.preventDefault()
    });
    if (n.onWidget || TradingView.isMobileView || (i = $("<span>").addClass("main-menu apply-common-tooltip common-tooltip-vertical"), r.append($("<div>").addClass("tools-group").append(i)), this._mainMenuWidget = new TradingView.MainMenuWidget(i)), this._allToolGroups = [], this._toolsFilter = n.drawingsAccess ? new D6.ModernToolsFilter(n.drawingsAccess) : new D6.ObsoleteToolsFilter(n.enabledDrawings, n.disabledDrawings), !n.readOnly) {
        this._main = i = $("<div>").addClass("tools-group no-delimiter").appendTo(r);
        this.appendToolsGroup([
            {tool: "cursor", name: "Cross"},
            {tool: "dot", name: "Dot"},
            {tool: "arrow", name: "Arrow"},
            {tool: "eraser", name: "Eraser"}
        ]);
        this.appendToolsGroup([
            {tool: "LineToolTrendLine", name: "Trend Line"},
            {tool: "LineToolTrendAngle", name: "Trend Angle"},
            {tool: "LineToolHorzLine", name: "Horizontal Line"},
            {tool: "LineToolHorzRay", name: "Horizontal Ray"},
            {tool: "LineToolVertLine", name: "Vertical Line"},
            {tool: "LineToolArrow", name: "Arrow"},
            {tool: "LineToolRay", name: "Ray"},
            {tool: "LineToolExtended", name: "Extended"},
            {tool: "LineToolParallelChannel", name: "Parallel Channel"},
            {tool: "LineToolDisjointAngle", name: "Disjoint Angle"},
            {tool: "LineToolFlatBottom", name: "Flat Top/Bottom"},
            {tool: "LineToolRegressionTrend", name: "Regression Trend"}
        ]);
        this.appendToolsGroup([
            {tool: "LineToolPitchfork", name: "Pitchfork"},
            {tool: "LineToolSchiffPitchfork2", name: "Schiff Pitchfork"},
            {tool: "LineToolSchiffPitchfork", name: "Modified Schiff Pitchfork"},
            {tool: "LineToolInsidePitchfork", name: "Inside Pitchfork"},
            {tool: "LineToolPitchfan", name: "Pitchfan"},
            {tool: "LineToolGannSquare", name: "Gann Box"},
            {tool: "LineToolGannComplex", name: "Gann Square"},
            {tool: "LineToolGannFan", name: "Gann Fan"},
            {tool: "LineToolFibRetracement", name: "Fib Retracement"},
            {tool: "LineToolTrendBasedFibExtension", name: "Trend-Based Fib Extension"},
            {tool: "LineToolFibSpeedResistanceFan", name: "Fib Speed Resistance Fan"},
            {tool: "LineToolFibTimeZone", name: "Fib Time Zone"},
            {tool: "LineToolTrendBasedFibTime", name: "Trend-Based Fib Time"},
            {tool: "LineToolCircleLines", name: "Cyclic Lines"},
            {tool: "LineToolFibCircles", name: "Fib Circles"},
            {tool: "LineToolFibSpiral", name: "Fib Spiral"},
            {tool: "LineToolFibSpeedResistanceArcs", name: "Fib Speed Resistance Arcs"},
            {tool: "LineToolFibWedge", name: "Fib Wedge"},
            {tool: "LineToolFibChannel", name: "Fib Channel"}
        ]);
        this.appendToolsGroup([
            {tool: "LineToolBrush", name: "Brush"},
            {tool: "LineToolRectangle", name: "Rectangle"},
            {tool: "LineToolRotatedRectangle", name: "Rotated Rectangle"},
            {tool: "LineToolEllipse", name: "Ellipse"},
            {tool: "LineToolTriangle", name: "Triangle"},
            {tool: "LineToolPolyline", name: "Polyline"},
            {tool: "LineToolArc", name: "Arc"}
        ]);
        this.appendToolsGroup([
            {tool: "LineToolText", name: "Text"},
            {tool: "LineToolTextAbsolute", name: "Anchored Text"},
            {tool: "LineToolNote", name: "Note"},
            {tool: "LineToolNoteAbsolute", name: "Anchored Note"},
            {tool: "LineToolCallout", name: "Callout"},
            {tool: "LineToolBalloon", name: "Balloon"},
            {tool: "LineToolPriceLabel", name: "Price Label"},
            {tool: "LineToolArrowMarkLeft", name: "Arrow Mark Left"},
            {tool: "LineToolArrowMarkRight", name: "Arrow Mark Right"},
            {tool: "LineToolArrowMarkUp", name: "Arrow Mark Up"},
            {tool: "LineToolArrowMarkDown", name: "Arrow Mark Down"},
            {tool: "LineToolFlagMark", name: "Flag Mark"}
        ]);
        this.appendToolsGroup([
            {tool: "LineTool5PointsPattern", name: "XABCD Pattern"},
            {tool: "LineToolABCD", name: "ABCD Pattern"},
            {tool: "LineToolTrianglePattern", name: "Triangle Pattern"},
            {tool: "LineToolThreeDrivers", name: "Three Drivers Pattern"},
            {tool: "LineToolHeadAndShoulders", name: "Head & Shoulders"},
            {tool: "LineToolElliottSubminuette", name: "Elliott Wave Subminuette"},
            {tool: "LineToolElliottMinor", name: "Elliott Wave Minor"},
            {tool: "LineToolElliottCircle", name: "Elliott Wave Cycle"},
            {tool: "LineToolElliottMinorRetr", name: "Elliott Minor Retracement"},
            {tool: "LineToolElliottMajorRetr", name: "Elliott Major Retracement"}
        ]);
        this.appendToolsGroup([
            {tool: "LineToolRiskRewardLong", name: "Long Position"},
            {tool: "LineToolRiskRewardShort", name: "Short Position"},
            {tool: "LineToolPrediction", name: "Forecast"},
            {tool: "LineToolDateRange", name: "Date Range"},
            {tool: "LineToolPriceRange", name: "Price Range"},
            {tool: "LineToolBarsPattern", name: "Bars Pattern"},
            {tool: "LineToolProjection", name: "Projection"}
        ]);
        this._toolsFilter.isToolEnabled("Font Icons") && (t = new this.Button(this.createIconActions(), {addClass: "font-awesome line-tool-icons-popup", buttonClass: "font-awesome"}, !0), this._icons = t, i.append(t.element()), this._allToolGroups.push(t));
        TradingView.isMobileView || (i = $("<div>").addClass("tools-group").appendTo(r), t = new this.Button({tool: "zoom", name: "Zoom In", action: function () {
            TradingView.drawingState.tool.setValue("zoom")
        }}), i.append(t.element()), this._allToolGroups.push(t), e.Q5 && (s = new this.Button({tool: "zoom-out", name: "Zoom Out", action: function () {
            var n = e.Q5;
            n && (n = n.activeChartWidget.value().model()) && n.zoomFromViewport()
        }}), i.append(s.element()), s.element().addClass("hidden"), function () {
            function n() {
                var r = e.Q5.activeChartWidget.value(), i = r.model(), u = !1;
                i ? (t !== i && (t && t.zoomStack().onChange().unsubscribe(null, n), i.zoomStack().onChange().subscribe(null, n), t = i), u = !i.zoomStack().isEmpty()) : r.withModel(null, n);
                s.element().toggleClass("hidden", !u)
            }

            var t = null;
            e.Q5.activeChartWidget.subscribe(n, {callWithLast: !0})
        }()), t = new this.Button({tool: "measure", name: "Measure (Shift + Click on the chart)", action: function () {
            TradingView.drawingState.tool.setValue("measure")
        }}), i.append(t.element()), this._allToolGroups.push(t));
        var i = $("<div>").addClass("tools-group").appendTo(r), t = !!TradingView.drawingState.properties().magnet.value(), o = new this.Button({tool: "magnet", name: "Magnet Mode", action: function () {
            o.activate(!o.activated);
            TradingView.saveDefaultProperties(!0);
            TradingView.drawingState.properties().magnet.setValue(o.activated);
            TradingView.saveDefaultProperties(!1)
        }.bind(this)});
        if (i.append(o.element()), o.activate(t), TradingView.drawingState.properties().magnet.subscribe(this, function (n) {
            o.activate(n.value())
        }), !n.onWidget && !TradingView.isMobileView || J77.enabled("charting_library")) {
            t = !!TradingView.drawingState.properties().stayInDrawingMode.value();
            drawingmode = new this.Button({tool: "drawginmode", name: "Stay in Drawing Mode", action: function () {
                drawingmode.activate(!drawingmode.activated);
                TradingView.saveDefaultProperties(!0);
                TradingView.drawingState.properties().stayInDrawingMode.setValue(drawingmode.activated);
                TradingView.saveDefaultProperties(!1)
            }.bind(this)});
            i.append(drawingmode.element());
            drawingmode.activate(t);
            TradingView.drawingState.properties().stayInDrawingMode.subscribe(this, function (n) {
                drawingmode.activate(n.value())
            });
            t = !!TradingView.drawingState.lockDrawings().value();
            u = new this.Button({tool: "lockAllDrawings", name: "Lock All Drawing Tools", action: function () {
                u.activate(!u.activated);
                TradingView.drawingState.lockDrawings().setValue(u.activated)
            }.bind(this)});
            i.append(u.element());
            u.activate(t);
            TradingView.drawingState.lockDrawings().subscribe(this, function (n) {
                u.activate(n.value())
            });
            t = !!TradingView.drawingState.hideAllDrawings().value();
            f = new this.Button({tool: "hideAllDrawings", name: "Hide All Drawing Tools", action: function () {
                f.activate(!f.activated);
                TradingView.drawingState.hideAllDrawings().setValue(f.activated)
            }.bind(this)});
            i.append(f.element());
            f.activate(t);
            TradingView.drawingState.hideAllDrawings().subscribe(this, function (n) {
                f.activate(n.value())
            });
            i = $("<div>").addClass("tools-group").appendTo(r);
            t = $("<span>").addClass("button objects-tree apply-common-tooltip common-tooltip-vertical").attr("title", $.t("Show Objects Tree")).append($("<i>"));
            t.on("click", function (n) {
                this.Q5.activeChartWidget.value().showSourceProperties();
                n.preventDefault()
            }.bind(this));
            i.append(t)
        }
        TVSettings.getValue("chart.cursorPreference", "cursor")
    }
    n.onWidget || TradingView.isMobileView || $(window).load(function () {
        if (window.widgetbar) {
            var t = widgetbar.layout.setHelpButton();
            n.withWizard && n.Q6 && (Q3 = n.Q6.activeChartWidget.value());
            new TradingView.ChartHelpMenu(t, !!n.withWizard, Q3)
        }
    });
    n.readOnly || TradingView.drawingState.tool.subscribe(function (n) {
        this._syncView(n)
    }.bind(this), {callWithLast: !0});
    $(document).bind("keydown", "esc", function () {
        TradingView.drawingState.resetToCursor(!0)
    });
    this._twoColumnLayout = !1;
    (n.onWidget || TradingView.isMobileView) && !J77.enabled("charting_library") || (h = r.find(".tools-group"), $(window).load(function () {
        var n = h.last();
        c = n.offset().top + n.outerHeight();
        $(window).resize()
    }), $(window).resize(function () {
        var n = $(window).height() < c + 10;
        n != e._twoColumnLayout && (r.toggleClass("two-column", n), e._twoColumnLayout = n, $(window).resize())
    }));
    this.visible = new Property;
    this.visible.subscribe(this, function (n) {
        this._fold(!n.value());
        TVSettings.setValue("ChartSideToolbarWidget.visible", n.value())
    });
    this.visible.setValue("boolean" == typeof n.forceVisible ? n.forceVisible : TVSettings.getBool("ChartSideToolbarWidget.visible", !0));
    n.onResize && (this.onResize = n.onResize);
    $(window).on("resize", this.updateLayout.bind(this))
};
D6.prototype.updateLayout = function () {
    if (this.onResize)this.onResize(this._container)
};
D6.prototype.appendToolsGroup = function (n) {
    n = this.filterEnabledTools(this.applyActions(n));
    0 < n.length && (n = new this.Button(n), this._main.append(n.element()), this._allToolGroups.push(n))
};
D6.prototype.filterEnabledTools = function (n) {
    return n.filter(function (n) {
        return this._toolsFilter.isToolEnabled(n.name)
    }, this)
};
D6.prototype.element = function () {
    return this._container
};
D6.prototype._syncView = function (n) {
    var r, t, u, i;
    if (this._allToolGroups)for (r = this._allToolGroups.length; r--;)if (t = this._allToolGroups[r], t.textAsIcon)t.activate("LineToolIcon" == n); else {
        for (u = !1, i = t.tools.length; i--;)t.tools[i].tool === n && (t.setCurrent(i), u = !0);
        t.activate(u)
    }
};
D6.prototype.applyActions = function (n) {
    var t = this;
    return $.map(n, function (n) {
        return{tool: n.tool, name: n.name, addClass: t._toolsFilter.isToolGrayed(n.name) && " grayed", action: function () {
            TradingView.drawingState.tool.value() !== n.tool && (TradingView.supportTouch() && t.Q5.selectedSource.value() && t.Q5.activeChartWidget.value().model().lineBeingCreated() && t.Q5.activeChartWidget.value().model().cancelCreatingLine(), TradingView.drawingState.tool.setValue(n.tool))
        }}
    })
};
D6.prototype.createIconActions = function (n) {
    var t = this, i;
    return n = TradingView.LineToolIcon.availIcons, i = TVSettings.getJSON("linetoolicon.recenticons"), i && (n = i.concat(["separator"]).concat(n)), $.map(n, function (n) {
        return"separator" === n ? {separator: !0} : {tool: "LineToolIcon", name: String.fromCharCode(n), addClass: t._toolsFilter.isToolGrayed("Font Icons") && " grayed", action: function () {
            var i = defaults("linetoolicon");
            i.icon = n;
            saveDefaults("linetoolicon", i);
            TradingView.drawingState.tool.setValue("LineToolIcon");
            t._icons.setTools(t.createIconActions());
            i = TVSettings.getJSON("linetoolicon.recenticons") || [];
            i = $.grep(i, function (t) {
                return t != n
            });
            i.unshift(n);
            10 < i.length && (i = i.slice(0, 10));
            TVSettings.setJSON("linetoolicon.recenticons", i)
        }}
    })
};
D6.prototype.changeTool = function (n) {
    n ? this.Q4.setCurrentTool(n) : this.Q4.setCurrentTool(this.Q4.currentCursorTool())
};
D6.prototype._fold = function (n) {
    this._container.toggleClass("hidden", !!n);
    $(window).resize()
};
D6.prototype.Button = function (n, t, i) {
    n = isArray(n) ? n : [n];
    this.isGroup = 1 < n.length;
    this.textAsIcon = i;
    this.setTools(n);
    this._e = $("<span>").addClass("button").addClass("apply-common-tooltip common-tooltip-vertical");
    this.isGroup ? (this._main = $("<span>").addClass("main"), i ? this._main.text(this._firstNonGrayedTool().localizedName).addClass("text-as-icon") : this._main.append("<i>"), this._side = $("<span>").addClass("side"), this._e.append(this._main).append(this._side), this._e.addClass("subgroup")) : this._e.append($("<i>")).attr("title", this.tools[0].localizedName);
    i || this._e.hover($.proxy(this, "_hover"), $.proxy(this, "_unhover"));
    t = $.extend({direction: TradingView.isMobileView ? "up" : "right", event: "button-popup", addClass: "", reverse: !1, popupSpacing: TradingView.isMobileView ? 15 : 4, upAction: !0}, t || {});
    i || (t.addClass += " iconed");
    this.isGroup && TradingView.bindPopupMenu(this._e, null, t);
    this.activated = n.activated || !1;
    this.setCurrent(this.tools.indexOf(this._firstNonGrayedTool()));
    this.isGroup ? (Modernizr.touch ? (this._main.bind("touchstart", $.proxy(this, "_startclick")), this._main.bind("touchend", $.proxy(this, "_stopclick"))) : (this._main.mousedown($.proxy(this, "_startclick")), this._main.mouseup($.proxy(this, "_stopclick"))), this._side.click($.proxy(this, "_submenu")), this._e.click(function () {
        return!1
    })) : this._e.click($.proxy(this, "action"))
};
D6.prototype.Button.prototype._isToolGrayed = function (n) {
    return n.addClass && -1 < n.addClass.indexOf("grayed")
};
D6.prototype.Button.prototype._firstNonGrayedTool = function () {
    for (var t, n = 0; n < this.tools.length; ++n)if (t = this.tools[n], !this._isToolGrayed(t) && !t.separator)return t;
    return this.tools[0]
};
D6.prototype.Button.prototype.element = function () {
    return this._e
};
D6.prototype.Button.prototype.setTools = function (n) {
    if (isArray(n)) {
        var t = this;
        this.tools = $.map(n, $.proxy(function (n) {
            return n.separator ? {separator: !0} : {icon: t.textAsIcon ? n.name : n.tool, name: n.name, localizedName: $.t(n.name), tool: n.tool, addClass: n.addClass, action: "function" == typeof n.action ? n.action : t._defaultAction}
        }, this))
    }
};
D6.prototype.Button.prototype._getBackgroundByTile = function (n, t) {
    return[t ? 33 : 1, 32 * n + 2]
};
D6.prototype.Button.prototype._getBackgroundPosition = function (n) {
    return"-" + n[0] + "px -" + n[1] + "px"
};
D6.prototype.Button.iconIndices = {LineToolTextAbsolute: 0, LineToolArc: 1, LineToolArrowMarkDown: 2, LineToolArrowMarkUp: 3, LineToolCircleLines: 4, LineToolArrowMarkLeft: 5, LineToolArrowMarkRight: 6, LineToolFibSpeedResistanceArcs: 7, arrow: 8, LineToolBalloon: 9, LineToolBrush: 10, LineToolFibSpeedResistanceFan: 11, LineToolArrow: 12, cursor: 13, LineToolHorzLine: 14, LineToolFibRetracement: 15, LineToolPitchfork: 16, LineToolText: 17, LineToolTrendLine: 18, LineToolTrendAngle: 82, LineToolFibTimeZone: 19, LineToolVertLine: 20, dot: 21, LineToolEllipse: 22, LineToolFlagMark: 23, eraser: 24, LineToolExtended: 25, LineToolFibCircles: 26, LineToolFibSpiral: 74, LineToolGannFan: 27, LineToolGannSquare: 28, LineToolGannComplex: 67, LineToolParallelChannel: 29, LineToolDisjointAngle: 75, LineToolFlatBottom: 76, LineToolPolyline: 30, LineToolRectangle: 31, LineToolRotatedRectangle: 81, LineToolCallout: 32, LineToolPriceLabel: 77, LineToolRay: 33, LineToolSchiffPitchfork: 72, LineToolSchiffPitchfork2: 34, LineToolTrendBasedFibExtension: 37, LineToolTrendBasedFibTime: 66, LineToolTriangle: 38, modes: 39, LineToolElliottSubminuette: 40, LineToolElliottMinor: 41, LineToolElliottCircle: 42, LineToolElliottMajorRetr: 43, LineToolElliottMinorRetr: 44, LineToolRegressionTrend: 45, LineToolFibWedge: 46, zoom: 47, LineToolPitchfan: 48, LineToolHorzRay: 49, LineToolPrediction: 50, "zoom-out": 51, LineToolPriceRange: 52, LineToolDateRange: 53, LineToolRiskRewardLong: 54, LineToolRiskRewardShort: 55, "": 56, "": 57, "": 58, LineToolBarsPattern: 59, LineToolProjection: 60, LineTool5PointsPattern: 61, LineToolABCD: 62, LineToolTrianglePattern: 63, LineToolThreeDrivers: 64, LineToolHeadAndShoulders: 65, LineToolInsidePitchfork: 68, measure: 69, magnet: 70, drawginmode: 71, LineToolFibChannel: 73, lockAllDrawings: 78, hideAllDrawings: 79, LineToolNote: 83, LineToolNoteAbsolute: 84};
D6.prototype.Button.prototype._setIcon = function (n, t, i) {
    n = this._getBackgroundByTile(D6.prototype.Button.iconIndices[n], t);
    i || this._e.find("i").css("background-position", this._getBackgroundPosition(n))
};
D6.prototype.Button.prototype._setTextAsIcon = function (n) {
    this._e.find(".main").text(n)
};
D6.prototype.Button.prototype.setIcon = function (n) {
    this.icon = n;
    this.textAsIcon ? this._setTextAsIcon(n) : this._setIcon(n, this.activated)
};
D6.prototype.Button.prototype._hover = function () {
    this._setIcon(this.icon, !0, !0)
};
D6.prototype.Button.prototype._unhover = function () {
    this._setIcon(this.icon, this.activated || !1)
};
D6.prototype.Button.prototype._getPopupIcon = function (n) {
    return n = D6.prototype.Button.iconIndices[n], offset = {image: TradingView.wrapUrl("url('/static/images/sidetoolbar/instruments.png')"), offset: {x: -64, y: 32 * -n}}
};
D6.prototype.Button.prototype._getPopupMenuItems = function () {
    var n = this;
    return $.map(this.tools, function (t, i) {
        return t.separator ? t : {title: "" + t.localizedName, action: function () {
            n._isToolGrayed(t) ? Q17.emit("onGrayedObjectClicked", {type: "drawing", name: t.name}) : (n.setCurrent(i), t.action.call(n, t), $(document).trigger("click"), $(document).trigger("touch"))
        }, active: i == n.current, icon: n.textAsIcon ? null : n._getPopupIcon(t.icon), addClass: t.addClass}
    })
};
D6.prototype.Button.prototype._defaultAction = function () {
    this.activate()
};
D6.prototype.Button.prototype._startclick = function () {
    this._e.hasClass("active") ? ($(document).trigger("click"), this.action()) : this._delay = setTimeout($.proxy(function () {
        this._delay = null;
        this.openSubmenu()
    }, this), 200)
};
D6.prototype.Button.prototype._stopclick = function () {
    this._delay && (clearTimeout(this._delay), this._delay = null, this.action())
};
D6.prototype.Button.prototype._submenu = function () {
    this._e.hasClass("active") ? $(document).trigger("click") : this.openSubmenu()
};
D6.prototype.Button.prototype.activate = function (n) {
    (this.activated = n = void 0 !== n ? !!n : !0) ? this._e.addClass("selected") : this._e.removeClass("selected");
    this._setIcon(this.icon, n)
};
D6.prototype.Button.prototype.action = function () {
    var n = this.getCurrent();
    this._isToolGrayed(n) ? Q17.emit("onGrayedObjectClicked", {type: "drawing", name: n.name}) : n.action.call(this, n)
};
D6.prototype.Button.prototype.openSubmenu = function () {
    this._e.trigger("button-popup", [this._getPopupMenuItems()])
};
D6.prototype.Button.prototype.setCurrent = function (n) {
    if (0 <= n && n < this.tools.length) {
        var t = this.tools[n];
        this.setIcon(t.icon);
        this._isToolGrayed(t) ? this._e.find(".main").addClass(" grayed") : this._e.find(".main").removeClass(" grayed");
        this.current = n
    }
};
D6.prototype.Button.prototype.getCurrent = function () {
    return this.tools[this.current]
};
D6.prototype.Button.prototype.setCurrentTool = function (n) {
    var t = this, i;
    "LineToolIcon" === n ? (i = String.fromCharCode(defaults("linetoolicon").icon), $.each(this.tools, function (n, r) {
        if (r.icon == i)return t.setCurrent(n), t.activate(), !1
    })) : $.each(this.tools, function (i, r) {
        if (r.tool == n)return t.setCurrent(i), t.activate(), !1
    })
};
D6.ObsoleteToolsFilter = function (n, t) {
    this._enabledTools = n;
    this._disabledTools = t
};
D6.ObsoleteToolsFilter.prototype.isToolEnabled = function (n) {
    var t = !!this._enabledTools && 0 < this._enabledTools.length, i = !!this._disabledTools && 0 < this._disabledTools.length;
    if (t && i)throw"Unable to use enabled drawings list and disabled drawings one together. Please use just one of them.";
    return!i && !t || t && 0 <= this._enabledTools.indexOf(n) || i && 0 > this._disabledTools.indexOf(n)
};
D6.ObsoleteToolsFilter.prototype.isToolGrayed = function () {
    return!1
};
D6.ModernToolsFilter = function (n) {
    this._toolsAccess = n
};
D6.ModernToolsFilter.prototype._findTool = function (n) {
    for (var r, i = null, t = 0; t < this._toolsAccess.tools.length; ++t)if (r = this._toolsAccess.tools[t], r.name == n) {
        i = r;
        break
    }
    return i
};
D6.ModernToolsFilter.prototype.isToolEnabled = function (n) {
    return(n = this._findTool(n)) && n.grayed ? !0 : "black" == this._toolsAccess.type ? !n : !!n
};
D6.ModernToolsFilter.prototype.isToolGrayed = function (n) {
    return(n = this._findTool(n)) && n.grayed
};
D78 = function (n, t) {
    n = $(n);
    this.Q4 = t;
    this._undo = $("<span>").addClass("button undo iconed disabled").attr("title", "").append("<i>").appendTo(n);
    this._redo = $("<span>").addClass("button redo iconed disabled").attr("title", "").append("<i>").appendTo(n);
    var i = this;
    this._undo.click(function () {
        i.undo()
    });
    this._redo.click(function () {
        i.redo()
    });
    D77.undoStack().onChange().subscribe(this, this.update);
    D77.redoStack().onChange().subscribe(this, this.update)
};
D78.prototype.update = function () {
    var n = D77.undoStack(), t = D77.redoStack();
    n.isEmpty() ? (this._undo.addClass("disabled"), this._undo.attr("title", null)) : (this._undo.removeClass("disabled"), this._undo.attr("title", $.t("Undo {0}").format(n.head().text() || "")));
    t.isEmpty() ? (this._redo.addClass("disabled"), this._redo.attr("title", null)) : (this._redo.removeClass("disabled"), this._redo.attr("title", $.t("Redo {0}").format(t.head().text() || "")))
};
D78.prototype.undo = function () {
    this._undo.hasClass("disabled") || (TradingView.trackEvent("GUI", "Undo"), D77.undo())
};
D78.prototype.redo = function () {
    this._redo.hasClass("disabled") || (TradingView.trackEvent("GUI", "Redo"), D77.redo())
};
D78.prototype.undoElement = function () {
    return this._undo
};
D78.prototype.redoElement = function () {
    return this._redo
};
TradingView.FullscreenWidget = function () {
    this.isFullscreen = !1;
    this._e = $("<span>").addClass("button fullscreen iconed").attr("title", $.t("Fullscreen mode")).append("<i>");
    var n = this;
    this._e.click(function () {
        n.startFullscreen()
    });
    $(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange", function () {
        var t;
        ["fullscreenElement", "webkitFullscreenElement", "mozFullscreenElement", "mozFullScreenElement", "msFullscreenElement"].some(function (n) {
            if (!(n in document))return!1;
            t = !!document[n]
        });
        null != t && (t ? n._onStartFullscreen() : n._onExitFullscreen())
    })
};
TradingView.FullscreenWidget.prototype.element = function () {
    return this._e
};
TradingView.FullscreenWidget.prototype.startFullscreen = function () {
    ["requestFullscreen", "mozRequestFullScreen", "webkitRequestFullscreen", "msRequestFullscreen"].some(function (n) {
        if ("function" == typeof document.documentElement[n])return document.documentElement[n](), !0
    });
    this._onStartFullscreen()
};
TradingView.FullscreenWidget.prototype._onStartFullscreen = function () {
    var n = this;
    $("#chart-area").addClass("fullscreen");
    this._$exitButton || (this._$exitButton = $('<div class="exit-fullscreen">Exit Full Screen (ESC)<\/div>').on("click", this.exitFullscreen.bind(this)).appendTo(document.body));
    $(window).resize();
    $(document).off("keyup.toggleFullscreen").on("keyup.toggleFullscreen", function (t) {
        27 == t.keyCode && n.exitFullscreen()
    })
};
TradingView.FullscreenWidget.prototype.exitFullscreen = function () {
    ["exitFullscreen", "mozCancelFullScreen", "mozExitFullscreen", "webkitExitFullscreen", "msExitFullscreen"].some(function (n) {
        if ("function" == typeof document[n])return document[n](), !0
    });
    this._onExitFullscreen()
};
TradingView.FullscreenWidget.prototype._onExitFullscreen = function () {
    var n = $("#chart-area");
    this._$exitButton && ($(".exit-fullscreen").remove(), delete this._$exitButton);
    n.removeClass("fullscreen");
    $(window).resize();
    $(document).off("keyup.toggleFullscreen")
};
D53 = function (n, t, i) {
    this._chart = n;
    this.dialog = n.dialog;
    this._state = t;
    this._disableContextMenu = !!i;
    this.lhsPriceAxisWidget = new D54(this, D54.LHS);
    this.rhsPriceAxisWidget = new D54(this, D54.RHS);
    this.jqPane = $(document.createElement("td"));
    this.jqPane.addClass("chart-markup-table");
    this.jqPane.addClass("pane");
    this._dv = $("<div>");
    this._dv.css("width", "100%");
    this._dv.css("height", "100%");
    this._dv.css("position", "relative");
    this._dv.css("overflow", "hidden");
    this._dv.appendTo(this.jqPane);
    this.canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.canvas).css("position", "absolute");
    $(this.canvas).css("z-order", "2");
    $(this.canvas).css("left", 0);
    $(this.canvas).css("top", 0);
    this.ctx = this.canvas.getContext("2d");
    this.top_canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.top_canvas).css("position", "absolute");
    $(this.top_canvas).css("z-order", "1");
    $(this.top_canvas).css("left", 0);
    $(this.top_canvas).css("top", 0);
    this.top_ctx = this.top_canvas.getContext("2d");
    this._zoomSelector = $("<div>");
    this._zoomSelector.addClass("zoom-selector");
    this._zoomSelector.css("display", "none");
    this._zoomSelector.appendTo(this._dv);
    this._tooltipSelector = $("<div>");
    this._tooltipSelector.addClass("tooltip tooltip-selector tooltip-selector-hidden");
    this._tooltipSelector.appendTo(this._dv);
    this.legendWidget = new D23(this, this._chart.model(), this._chart._jqMainDiv);
    this.jqRow = $(document.createElement("tr"));
    this.lhsPriceAxisWidget.jqCell.appendTo(this.jqRow);
    this.jqPane.appendTo(this.jqRow);
    this.legendWidget.jqTable.appendTo(this._dv);
    this.rhsPriceAxisWidget.jqCell.appendTo(this.jqRow);
    this.setCursorForTool();
    TradingView.setMouseEventHandler($(this.top_canvas), this, !0);
    t && t !== this._chart.model().panes().item(0) && !this._chart.readOnly() && (this.paneControls = new D51(this, this._chart.model(), this._dv));
    this.updateScalesVisibility();
    this.actions = [];
    this.readonlyActions = [];
    this._onKeyUpListener = this._onKeyUpListener.bind(this);
    this._lineCancelledCallback = this._lineCancelledCallback.bind(this);
    $(window).on("keyup.panewidget", this._onKeyUpListener);
    this._chart.withModel(this, this._lineCancelledCallback);
    this._overlays = {};
    this._contextMenuY = this._contextMenuX = 0;
    this._lockDrawingsProperty = TradingView.drawingState.lockDrawings();
    t && J77.enabled("move_logo_to_main_pane") && t._isMainPane && n.createLogo && n.createLogo(null, this._dv, !0)
};
D53.prototype.destroy = function () {
    $(window).off("keyup.panewidget", this._onKeyUpListener);
    this.legendWidget && (this.legendWidget.jqTable.remove(), delete this.legendWidget);
    this.paneControls && (this.paneControls.jqDiv.remove(), delete this.paneControls);
    this._chart.withModel({chart: this._chart, instance: this, callback: this._hideTooltip}, function () {
        this.chart.model().lineCancelled().unsubscribe(this.instance, this.callback)
    });
    for (var n in this)delete this[n]
};
D53.prototype._onKeyUpListener = function (n) {
    27 == n.keyCode && (this._chart.model().lineBeingCreated() && this._chart.model().cancelCreatingLine(), this._chart.model().model().crossHairSource().clearMeasure(), this.setCursorForTool(), this._hideTooltip())
};
D53.prototype._lineCancelledCallback = function () {
    try {
        this._chart.model().lineCancelled().subscribe(this, this._hideTooltip)
    } catch (n) {
    }
};
D53.prototype.backgroundColor = function () {
    return this._chart.properties().paneProperties.background.value()
};
D53.prototype.priceAxisByCanvas = function (n) {
    return n === this.lhsPriceAxisWidget.canvas || n === this.lhsPriceAxisWidget.top_canvas ? this.lhsPriceAxisWidget : n === this.rhsPriceAxisWidget.canvas || n === this.rhsPriceAxisWidget.canvas ? this.rhsPriceAxisWidget : null
};
D53.prototype.updateScalesVisibility = function () {
    this.lhsPriceAxisWidget.setVisible(this._chart.properties().scalesProperties.showLeftScale.value());
    this.rhsPriceAxisWidget.setVisible(this._chart.properties().scalesProperties.showRightScale.value())
};
D53.prototype.chart = function () {
    return this._chart
};
D53.prototype.state = function () {
    return this._state
};
D53.prototype.setState = function (n) {
    this._state = n
};
D53.prototype.stretchFactor = function () {
    return this._state ? this._state._stretchFactor : J75.DEFAULT_STRETCH_FACTOR
};
D53.prototype.setStretchFactor = function (n) {
    this._state && (this._state._stretchFactor = n)
};
D53.prototype.mouseEnterEvent = function (n) {
    (n = this._chart.model()) && (n.crossHairSource().visible = !0)
};
D53.prototype.isLineTool = function (n) {
    return n = TradingView[n], "function" == typeof n && n.prototype instanceof J47
};
D53.prototype.hideInplaceEditor = function () {
    return this._inplaceEditor ? (this._inplaceEditor.remove(), this._inplaceEditor = void 0, !0) : !1
};
D53.prototype._processMouseMoveWhileZoom = function (n) {
    this._state.defaultPriceScale().coordinateToPrice(n.localY);
    var t = Math.floor(this._chart.model().timeScale().coordinateToIndex(n.localX)), t = this._chart.model().timeScale().indexToCoordinate(t) - .5 * this._chart.model().timeScale().barSpacing(), i = n.localY, r = Math.abs(t - this._firstZoomPoint.x), i = Math.abs(i - this._firstZoomPoint.y);
    t < this._firstZoomPoint.x ? this._zoomSelector.css("left", t) : this._zoomSelector.css("left", this._firstZoomPoint.x);
    n.localY < this._firstZoomPoint.y ? this._zoomSelector.css("top", n.localY) : this._zoomSelector.css("top", this._firstZoomPoint.y);
    this._zoomSelector.width(r);
    this._zoomSelector.height(i)
};
D53.prototype._finishZoom = function (n) {
    var t = this._state.defaultPriceScale().coordinateToPrice(n.localY);
    n = Math.round(this._chart.model().timeScale().coordinateToIndex(n.localX));
    n !== this._firstZoomPoint.index && this._chart.model().zoomToViewport(this._firstZoomPoint.index, n, this._firstZoomPoint.price, t, this.state());
    this._zoomSelector.css("display", "none");
    this._firstZoomPoint = null;
    TradingView.drawingState.resetToCursor()
};
D53.EvironmentState = function (n) {
    n.shiftKey && (this.shift = !0);
    n.ctrlKey && (this.control = !0)
};
D53.prototype.mouseDownEvent = function (n) {
    var r, f, t, i, u, e;
    if ($("input").blur(), $(window).focus(), this._updateCommonTooltip(null), r = this._chart.model(), f = new D53.EvironmentState(n), this.hideInplaceEditor(), TradingView.supportTouch() && (this._skipFirstMove = !0), i = this._state.defaultPriceScale(), !i.isEmpty() && !r.timeScale().isEmpty())if (t = r.crossHairSource(), TradingView.supportTouch() && "LineToolBrush" != TradingView.drawingState.tool.value() || r.setCurrentPosition(n.localX, n.localY, this._state), i = t.price, u = t.index, t.startMeasurePoint() && t.endMeasurePoint() && t.clearMeasure(), f.shift && TradingView.drawingState.toolIsCursor(TradingView.drawingState.tool.value()) && TradingView.drawingState.tool.setValue("measure"), "measure" !== TradingView.drawingState.tool.value() || t.startMeasurePoint())if (t.startMeasurePoint() && !t.endMeasurePoint())t.finishMeasure({price: i, index: u, x: n.localX, y: n.localY}), TradingView.drawingState.resetToCursor(); else if (this._firstZoomPoint)this._finishZoom(n); else if ("zoom" === TradingView.drawingState.tool.value())r = r.timeScale().indexToCoordinate(u) - .5 * r.timeScale().barSpacing(), this._firstZoomPoint = {price: i, index: u, x: r, y: n.localY}, this._zoomSelector.css("display", "block"), this._zoomSelector.css("left", r), this._zoomSelector.css("top", n.localY), this._zoomSelector.width(0), this._zoomSelector.height(0); else if (r.createUndoCheckpoint(), this.isLineTool(TradingView.drawingState.tool.value()) || r.lineBeingCreated())this._mouseDownEventForLineTool(n, f, u, i); else {
        if (i = (t = this.dataSourceAtPoint(n.localX, n.localY)) && t.source && t.source.customization ? t.source.customization : {}, t.hittest && t.hittest.result() == HitTestResult.CUSTOM && (e = t.hittest.data().mouseDownHandler, e && e()), !this._chart.readOnly()) {
            if (t && !i.disableSelection && r.setSelectedSource(t.source, t.hittest && t.hittest.data()), t.source && "eraser" === TradingView.drawingState.tool.value() && !i.disableErasing && (isInherited(t.source.constructor, J47) || isInherited(t.source.constructor, TradingView.Study))) {
                u = t.hittest.eraseMarker();
                n.ctrlKey && void 0 !== u && t.source.processErase ? t.source.processErase(r, u) : r.removeSource(t.source);
                return
            }
            if (i = t.source && isInherited(t.source.constructor, J47) && t.source.isLocked(), !this._lockDrawingsProperty.value() && !i) {
                if (t.source && t.source.userEditEnabled && !t.source.userEditEnabled())return;
                if (t.hittest && t.hittest.result() === HitTestResult.CHANGEPOINT) {
                    i = t.source.priceScale();
                    i = i.coordinateToPrice(n.localY);
                    r.startChangingLinetool(t.source, {index: u, price: i}, t.hittest.data(), f);
                    this._updateTooltip(n.localX, n.localY);
                    return
                }
                if (t.hittest && t.hittest.result() == HitTestResult.MOVEPOINT) {
                    t.source.isFixed && t.source.isFixed() ? r.startMovingSource(t.source, new MathEx.Point(n.localX, n.localY), t.hittest.data()) : (i = t.source.priceScale(), i = i.coordinateToPrice(n.localY), r.startMovingSource(t.source, {index: u, price: i}, t.hittest.data()));
                    return
                }
            }
            if (t.source && isInherited(t.source.constructor, PriceDataSource)) {
                this._chart.draggingSource = t.source;
                return
            }
        }
        t.hittest && t.hittest.result() == HitTestResult.REGULAR || (this._processing = !0)
    } else t.startMeasuring({price: i, index: u, x: n.localX, y: n.localY}, this._state)
};
D53.prototype._finishTool = function (n) {
    var t = this._chart.model(), i = TradingView.drawingState.tool.value();
    TradingView.drawingState.resetToCursor();
    this._hideTooltip();
    t.setSelectedSource(n);
    this._chart.isTextTool(i) && (i = t.createUndoCheckpoint(), n = new EditObjectDialog(n, t, i), n.show(), n.focusOnText())
};
D53.prototype._mouseDownEventForLineTool = function (n, t, i, r) {
    var u = this._chart.model(), f = !1, e = null, o = n.localX, s = n.localY, c = this._chart.model().model().crossHairSource(), h = TradingView.drawingState.tool.value();
    if (TradingView.drawingState.hideAllDrawings().setValue(!1), TradingView.drawingState.lockDrawings().setValue(!1), TradingView.supportTouch() && this.isLineTool(h) && "LineToolBrush" !== h && !u.lineBeingCreated() && (this._startTouchPoint = new MathEx.Point(o, s), this._initCrossHairPosition = c.currentPoint(), this._skipFirstMove = !0), !u.lineBeingCreated() || u.lineBeingCreated()instanceof TradingView.LineToolBrush)TradingView.supportTouch() && "LineToolBrush" != h || (e = u.createLineTool(this._state, {index: i, price: r}, h), u.lineBeingCreated() || (f = !0)); else if (TradingView.supportTouch()) {
        if (this._skipFirstMove = !0, !this._startTouchPoint) {
            this._startTouchPoint = new MathEx.Point(o, s);
            r = u.lineBeingCreated().points();
            r = r.item(r.size() - 1);
            n = u.timeScale().indexToCoordinate(r.index);
            r = r.price;
            t = u.lineBeingCreated().priceScale();
            t.isPercent() && (u = u.lineBeingCreated().ownerSource().firstValue(), r = t.priceRange().convertToPercent(r, u));
            u = t.priceToCoordinate(r);
            this._lastDrawingPoint = new MathEx.Point(n, u);
            return
        }
    } else e = u.lineBeingCreated(), f = u.paneForSource(e), f !== this._state && (r = this._dv.offset(), o = n.localX + r.left, s = n.localY + r.top, r = this._chart.paneByState(f)._dv.offset(), o -= r.left, s -= r.top, r = e.priceScale().coordinateToPrice(s), i = Math.round(u.timeScale().coordinateToIndex(o))), f = u.coninueCreatingLine({index: i, price: r}, t);
    u.setSelectedSource(e);
    f ? this._finishTool(e) : TradingView.supportTouch() && "LineToolBrush" != h || this._updateTooltip(n.localX, n.localY)
};
D53.prototype._equalsCursorCache = function (n, t) {
    return TradingView.drawingState.toolIsCursor(n.tool) ? n.tool === t.tool && n.theme === t.theme && n.crosshair === t.crosshair : n.tool === t.tool && n.theme === t.theme
};
D53.prototype._setCursor = function (n) {
    this._cursorCache && this._equalsCursorCache(this._cursorCache, n) || (this._cursorCache = n, TradingView.drawingState.toolIsCursor(n.tool) ? this.jqPane.css("cursor", n.crosshair) : this.jqPane.css("cursor", cursorCss(n.state.name, n.state.hotspot, n.theme)))
};
D53.prototype.setCursorForTool = function (n, t) {
    var r = {_default: {name: "cursor_cross", hotspot: "11 11"}, zoom: {name: "zoom", hotspot: "5 5"}, pointer: {name: "cursor_pointinghand", hotspot: "13 7"}, dragger: {name: "cursor_closed_hand", hotspot: "8 8"}}, i = TradingView.drawingState.tool.value(), u;
    TradingView.drawingState.toolIsCursor(i) && (this._chart.draggingSource || this._isScrolling || this._chart.model() && this._chart.model().sourceBeingMoved() ? i = "dragger" : n && (i = "pointer"));
    this._chart.model() && this._chart.model().lineBeingEdited() ? i = this._chart.model().lineBeingEdited()._constructor : t == HitTestResult.CHANGEPOINT && (i = n._constructor);
    u = r._default;
    i in r && (u = r[i]);
    this._setCursor({tool: i, theme: "light", state: u, crosshair: this.defaultPaneCursor("light")})
};
D53.prototype.setDragToAnotherPaneCursor = function () {
    this._setCursor({tool: "dragger", theme: "light", state: {name: "cursor_closed_hand_move", hotspot: "8 8"}, crosshair: this.defaultPaneCursor("light")})
};
D53.prototype.defaultPaneCursor = function (n) {
    var i = {cursor: {name: "cursor_cross", hotspot: "11 11"}, dot: {name: "cursor_dot", hotspot: "11 11"}, crosshair: {name: "cursor_cross", hotspot: "11 11"}, eraser: {name: "cursor_eraser", hotspot: "5 5"}}, t = i[TradingView.drawingState.tool.value()];
    return t || (t = i[TradingView.drawingState.cursorTool.value()]), t ? cursorCss(t.name, t.hotspot, n) : "default"
};
D53.prototype.gestureStartEvent = function () {
    this._prev_pinch_scale = 1;
    this._pinching = !0
};
D53.prototype.gestureChangeEvent = function (n) {
    var t = (n.originalEvent.pageX || n.originalEvent.offsetX) - 5, i = this._chart._paneWidgets[0].lhsPriceAxisWidget.size.w, r = this._chart.model().timeScale().width();
    i && (t = Math.max(0, t - i));
    t = Math.min(t, r);
    t = 2 * (t / r - .5);
    i = 5 * (n.scale - this._prev_pinch_scale);
    0 < i ? this._chart.model().zoomIn(t, i) : this._chart.model().zoomOut(t, -i);
    this._prev_pinch_scale = n.scale
};
D53.prototype.gestureEndEvent = function () {
    this._pinching = !1
};
D53.prototype._updateCommonTooltip = function (n) {
    var i = this._lastCommonTooltipData, t = null;
    n && n.hittest && n.hittest.result() === HitTestResult.CUSTOM && (n = n.hittest.data()) && (t = n.tooltip || null);
    (null != i || null != t) && (null == t ? (this._lastCommonTooltipData = null, TradingView.Tooltip.hide()) : i && t.text === i.text && t.rect.x === i.rect.x && t.rect.y === i.rect.y && t.rect.w === i.rect.w && t.rect.h === i.rect.h || (this._lastCommonTooltipData = t, i = TradingView.clone(t), t = this.jqPane.offset(), i.rect.x += t.left, i.rect.y += t.top, TradingView.Tooltip.show(i)))
};
D53.prototype.mouseMoveEvent = function (n) {
    var i = this._chart.model(), u, t;
    if (i) {
        var f = n.localX, e = n.localY, r = new D53.EvironmentState(n);
        if (this._firstZoomPoint)this._processMouseMoveWhileZoom(n); else {
            if (this._chart.readOnly() || this._editDialog && this._editDialog.isVisible() || (this.setCursorForTool(), u = TradingView.drawingState.tool.value(), t = null, this._processing || !TradingView.drawingState.toolIsCursor(u) && "eraser" !== u || (t = this.dataSourceAtPoint(n.localX, n.localY), this.setCursorForTool(t.source, t.hittest ? t.hittest.result() : null), t ? !t.source || "eraser" === u && t.source.constructor === TradingView.Series ? i.setHoveredSource(null) : i.setHoveredSource(t.source, t.hittest.data()) : i.setHoveredSource(null)), this._updateCommonTooltip(t)), this._chart.readOnly() && (t = this.dataSourceAtPoint(n.localX, n.localY), i.hoveredSource(), null !== t.source ? i.setHoveredSource(t.source, t.hittest.data()) : i.setHoveredSource(null, null)), this._chart.model().lineBeingCreated() && (n = this._chart.model().lineBeingCreated(), n = this._chart.model().paneForSource(n), n !== this._state)) {
                r = this._dv.offset();
                f += r.left;
                e += r.top;
                r = this._chart.paneByState(n)._dv.offset();
                f -= r.left;
                e -= r.top;
                i.setCurrentPosition(f, e, n);
                return
            }
            u = TradingView.drawingState.tool.value();
            TradingView.supportTouch() && this.isLineTool(u) || (i.setCurrentPosition(f, e, this._state, r), this._updateTooltip(f, e))
        }
    }
};
D53.prototype.pressedMouseMoveEvent = function (n) {
    var r, i;
    if (!this._pinching) {
        this._skipFirstMove ? (delete this._skipFirstMove, delete this._touchMove) : this._touchMove = !0;
        var e = new D53.EvironmentState(n), t = this._chart.model(), f = n.localX, u = n.localY;
        this._firstZoomPoint ? (this._processMouseMoveWhileZoom(n), this._firstZoomPoint.draggingMode = !0) : (r = TradingView.drawingState.tool.value(), TradingView.supportTouch() && this._startTouchPoint && this.isLineTool(r) && "LineToolBrush" !== r && !t.lineBeingCreated() ? (this._chart.model().model().crossHairSource(), t = this._initCrossHairPosition, n = new MathEx.Point(f, u).substract(this._startTouchPoint), t = t.add(n), this._chart.model().setCurrentPosition(t.x, t.y, this._state), this._updateTooltip(t.x, t.y)) : !TradingView.supportTouch() || !t.lineBeingCreated() || t.lineBeingCreated()instanceof TradingView.LineToolBrush ? (t.setCurrentPosition(f, u, this._state, e), this._updateTooltip(f, u), currentTool = TradingView.drawingState.tool.value(), this.isLineTool(currentTool) && "LineToolBrush" !== r) || (0 === n.button || Modernizr.touch) && ("LineToolBrush" === currentTool ? (i = this._state.defaultPriceScale(), i.isEmpty() || (i = i.coordinateToPrice(n.localY), r = Math.round(this._chart.model().timeScale().coordinateToIndex(n.localX)), this._chart.model().coninueCreatingLine({index: r, price: i}))) : (this._chart.draggingSource && (r = n.target, (i = this._chart.paneByCanvas(r)) && (i !== this ? i.setDragToAnotherPaneCursor() : i.setCursorForTool()), (i = this._chart.priceAxisByCanvas(r)) && i.jqCell.css("cursor", cursorCss("cursor_closed_hand", "8 8")), (r = this._chart.timeAxisByCanvas(r)) && r.jqCell.css("cursor", cursorCss("cursor_closed_hand_move", "8 8"))), t.timeScale().isEmpty() || (t.lineBeingEdited() ? (t.changeLinePoint({x: f, y: u}, e), this._updateTooltip(f, u), this.setCursorForTool()) : t.sourceBeingMoved() ? (i = t.sourceBeingMoved().priceScale(), i.isEmpty() || (r = this._chart.model().timeScale().coordinateToIndex(n.localX), i = i.coordinateToPrice(n.localY), n = t.sourceBeingMoved(), this.setCursorForTool(), isInherited(n.constructor, J47) && n.isFixed() ? t.moveSource(new MathEx.Point(f, u)) : t.moveSource({index: r, price: i}, e))) : (i = this._state.defaultPriceScale(), this._startScrollingPos || (this._startScrollingPos = {x: n.clientX, y: n.clientY}), !this._startScrollingPos || this._startScrollingPos.x === n.clientX && this._startScrollingPos.y === n.clientY || this._isScrolling || (t.beginUndoMacro("scroll"), i.isEmpty() || t.startScrollPrice(this._state, i, n.localY), t.startScrollTime(n.localX), this._isScrolling = !0, this.setCursorForTool(), TradingView.trackEvent("GUI", "Scrolling by pane content dragging")), this._isScrolling && (i.isEmpty() || t.scrollPriceTo(this._state, i, n.localY), t.scrollTimeTo(n.localX)))))) : this._startTouchPoint && (u = t.lineBeingCreated(), f = this._lastDrawingPoint.x + (n.localX - this._startTouchPoint.x), n = this._lastDrawingPoint.y + (n.localY - this._startTouchPoint.y), u = this._chart.model().paneForSource(u), t.setCurrentPosition(f, n, u), this._updateTooltip(f, n)))
    }
};
D53.prototype._processMouseUpForCustomHandler = function (n) {
    n = this.dataSourceAtPoint(n.localX, n.localY);
    n.hittest && n.hittest.result() == HitTestResult.CUSTOM && (n = n.hittest.data().mouseUpHandler) && n()
};
D53.prototype.mouseUpEvent = function (n) {
    var i, u, e, o, c, t;
    if (this._processMouseUpForCustomHandler(n), i = this._chart.model(), t = this._touchMove, delete this._touchMove, u = TradingView.drawingState.tool.value(), TradingView.supportTouch() && !t && "LineToolBrush" !== u && this.isLineTool(u) && !i.lineBeingCreated()) {
        var f = i.crossHairSource().currentPoint(), t = this._state.defaultPriceScale(), t = t.coordinateToPrice(f.y), r = Math.round(i.timeScale().coordinateToIndex(f.x)), r = i.createLineTool(this._state, {index: r, price: t}, u);
        i.setSelectedSource(r);
        i.lineBeingCreated() || this._finishTool(r);
        this._updateTooltip(f.x, f.y);
        delete this._startTouchPoint
    } else if (!i.lineBeingCreated() || i.lineBeingCreated()instanceof TradingView.LineToolBrush || !this._startTouchPoint)if (this._firstZoomPoint && this._firstZoomPoint.draggingMode)this._finishZoom(n); else {
        if (0 === n.button || TradingView.supportTouch()) {
            if (this._processing = !1, i = this._chart.model(), i.lineBeingEdited()) {
                i.endChangingLinetool();
                this._hideTooltip();
                return
            }
            if ("LineToolBrush" === u) {
                if (i.lineBeingCreated().finish(), t = this._state.defaultPriceScale(), t.isEmpty())return;
                t = t.coordinateToPrice(n.localY);
                r = Math.round(this._chart.model().timeScale().coordinateToIndex(n.localX));
                this._chart.model().coninueCreatingLine({index: r, price: t});
                return
            }
            if (i.sourceBeingMoved()) {
                i.endMovingSource();
                this._hideTooltip();
                return
            }
            if (r = this._isScrolling && D77.undoStack().head()instanceof UndoMacroCommand, this._isScrolling)if (t = this._state.defaultPriceScale(), i.endScrollPrice(this._state, t), e = this, o = function () {
                i.endScrollTime();
                i.endUndoMacro();
                e._startScrollingPos = void 0;
                e._isScrolling = !1;
                e.setCursorForTool()
            }, TradingView.supportTouch()) {
                var t = i.timeScale().m_scrollStartPoint, l = .05 * (n.localX - t), s = null, h = function (t) {
                    null === s && (s = t);
                    t = .01 * Math.min(100, 3 * (t - s));
                    t = Math.sqrt(t);
                    i.scrollTimeTo(n.localX + l * t);
                    1 <= t ? o() : requestAnimationFrame(h)
                };
                requestAnimationFrame(h)
            } else o();
            this._chart.draggingSource && (u = n.target, (f = this._chart.paneByCanvas(u)) && f != this && (t = f._state.findSuitableScale(this._chart.draggingSource), r && (r = !1, D77.undo()), this._chart.model().move(this._chart.draggingSource, f._state, t)), (t = this._chart.priceAxisByCanvas(u)) && (f = t.pane, t = t._isLeft ? f._state.leftPriceScale() : f._state.rightPriceScale(), r && (r = !1, D77.undo()), this._chart.model().move(this._chart.draggingSource, f._state, t)), (t = this._chart.timeAxisByCanvas(u)) && (r && (r = !1, D77.undo()), this._chart.model().move(this._chart.draggingSource, null, null), t.jqCell.css("cursor", "")), this._chart.draggingSource = null, r = this.dataSourceAtPoint(n.localX, n.localY), this.setCursorForTool(r.source, r.hittest || null))
        }
        delete this._touchMove
    } else u = !1, delete this._startTouchPoint, t || (r = i.lineBeingCreated(), u = r.points().last(), t = u.price, f = r.priceScale(), f.isPercent() && (c = i.lineBeingCreated().ownerSource().firstValue(), t = f.priceRange().convertToPercent(t, c)), u = i.coninueCreatingLine({index: u.index, price: t}, {}), delete this._lastDrawingPoint), u && this._finishTool(r)
};
D53.prototype.mouseLeaveEvent = function (n) {
    (n = this._chart.model()) && (TradingView.isMobile.any() || n.model().clearCurrentPosition(), this._updateCommonTooltip(null))
};
D53.prototype.mouseClickEvent = function () {
    this._chart.model().hoveredSource()instanceof J96 && this._chart.model().hoveredSource().onClicked()
};
D53.prototype.showEditDialogForSource = function (n) {
    this.chart().onWidget() || n.userEditEnabled && !n.userEditEnabled() || (this._editDialog = new EditObjectDialog(n, this._chart.model()), this._editDialog.show())
};
D53.prototype.mouseDoubleClickEvent = function (n) {
    if (n = this.dataSourceAtPoint(n.localX, n.localY), !(this._chart.readOnly() || !n || !n.source || n.source instanceof J96 || this.isLineTool(TradingView.drawingState.tool.value()))) {
        var t = n.source;
        t && t.customization && t.customization.disableSelection || (t._metaInfo && "Sessions@tv-basicstudies" == t._metaInfo.id && (t = this._chart.model().mainSeries()), n.source instanceof TradingView.AlertLabel ? editAlert(n.source.alert(), this._chart) : this.showEditDialogForSource(t))
    }
};
D53.prototype.showContextMenuForSource = function (n, t) {
    n.hasContextMenu() && (this._chart.model().setSelectedSource(n), n.constructor === TradingView.Series ? this._seriesContextMenu(n).show(t) : isInherited(n.constructor, TradingView.ESDStudyBase) ? this._studyEsdContextMenu(n).show(t) : isInherited(n.constructor, TradingView.Study) ? this._studyContextMenu(n).show(t) : isInherited(n.constructor, PublishedChartsTimeline) ? this._publishedChartsContextMenu(n).show(t) : isInherited(n.constructor, TradingView.LineToolOrder) || isInherited(n.constructor, TradingView.LineToolPosition) ? this._tradingDrawingsContextMenu(n).show(t) : isInherited(n.constructor, J47) ? this._lineContextMenu(n).show(t) : isInherited(n.constructor, TradingView.AlertLabel) && !n.fake && this._alertLabelContextMenu(n).show(t))
};
D53.prototype.contextMenuEvent = function (n) {
    if (J77.enabled("pane_context_menu"))if (this._chart.model().crossHairSource().startMeasurePoint())this._chart.model().crossHairSource().clearMeasure(); else if (!(this._pinching || this._disableContextMenu || this.chart().readOnly() || (this._firstZoomPoint && (this._zoomSelector.css("display", "none"), delete this._firstZoomPoint), this._chart.model().mainSeries().createSessStudy(), this._chart.updateActions(), this.hideInplaceEditor())))if (TradingView.drawingState.toolIsCursor(TradingView.drawingState.tool.value())) {
        this._contextMenuX = n.localX;
        this._contextMenuY = n.localY;
        var t = this.dataSourceAtPoint(n.localX, n.localY), t = t ? t.source : null;
        null === t ? (this._contextMenu(n).show(n), this._chart.model().setSelectedSource(null)) : this.showContextMenuForSource(t, n);
        this.paint()
    } else TradingView.isMobile.any() || (TradingView.drawingState.resetToCursor(!0), this.setCursorForTool(), this._hideTooltip(), this._chart.model().lineBeingCreated() && this._chart.model().cancelCreatingLine())
};
D53.prototype._contextMenu = function (n) {
    n = this._initActions(n);
    var t = this._customActions();
    return ContextMenu.createMenu(t.top.concat(n).concat(t.bottom))
};
D53.prototype._initActions = function (n) {
    var i = this._chart.actions(), t = [];
    return TradingView.Q18("alerts") && !this.chart().onWidget() && t.unshift(this.createActionAddAlert({e: n})), this.chart().onWidget() || (n = this.createActionTrade(n)) && t.push(n), t.length && t.push(new ActionSeparator), t.push(i.chartReset), t.push(i.symbolSearch), J77.enabled("charting_library") || t.push(i.addToWatchlist), t.push(new ActionSeparator), t.push(i.paneObjectTree), t.push(i.insertIndicator), TradingView.isMobile.any() || J77.enabled("charting_library") || t.push(i.scriptEditor), t.push(i.compareOrAdd), J77.enabled("charting_library") || t.push(i.applyStudyTemplate), t.push(i.paneRemoveAllStudies), t.push(i.paneRemoveAllDrawingTools), t.push(i.lockDrawingsAction), t.push(i.hideAllDrawingsAction), J77.enabled("charting_library") && t.push(i.hideAllMarks), t.push(new ActionSeparator), J77.enabled("charting_library") || (t.push(i.sessionBreaks), t.push(i.extendedHours)), t.push(new ActionSeparator), J77.enabled("charting_library") || t.push(i.applyColorTheme), t.push(i.chartProperties), pro.hasPackage("mtp-mtpredictor") && this.state().containsMainSeries() && (t.push(new ActionSeparator), t.push(this._createMTPredictorActions())), t
};
D53.prototype._customActions = function () {
    var t = {top: [], bottom: []}, n = this._chart.model().timeScale(), i = this._state.defaultPriceScale();
    return n.isEmpty() || i.isEmpty() ? t : (J77.enabled("custom_items_in_context_menu") && (n = n.indexToUserTime(n.coordinateToIndex(this._contextMenuX)), Q17.emit("onContextMenu", {unixtime: n ? n / 1e3 : void 0, price: i.coordinateToPrice(this._contextMenuY), callback: function (n) {
        [].concat(n).forEach(function (n) {
            if (n.text) {
                var i = new Action({text: n.text});
                i.callbacks().subscribe(null, n.click);
                n.position && "top" == n.position ? t.top.push(i) : t.bottom.push(i)
            }
        })
    }})), t)
};
D53.prototype._seriesContextMenu = function (n) {
    var i = this._chart.actions(), t = n.properties().visible.value(), r = null;
    if (this._chart.readOnly())n = [t ? i.seriesHide : this.createActionShow(n), new ActionSeparator, this.createActionShowLastValueLabels(n), this.createActionShowCountdown(n), new ActionSeparator, this.createActionScaleLeft(n), this.createActionScaleRight(n), this.createActionNoScale(n)], J77.enabled("countdown") || n.splice(3, 1), r = ContextMenu.createMenu(n); else {
        if (r = this._mergeContentMenuItems(n), t = [i.compare, t ? i.seriesHide : this.createActionShow(n), this.createVisualOrderAction(n), new ActionSeparator, this.createActionShowLastValueLabels(n), this.createActionShowCountdown(n), new ActionSeparator], J77.enabled("countdown") || t.splice(5, 1), this.chart().onWidget() || t.unshift(i.format), this.chart().canCreateAlertForDataSource(n) && t.unshift(this.createActionAddAlert({datasource: n})), (i = this.createActionLockScale(n)) && (t.push(i), t.push(new ActionSeparator)), 0 < r.length) {
            for (i = 0; i < r.length; i++)t.push(r[i]);
            t.push(new ActionSeparator)
        }
        t.push(this.createActionScaleLeft(n));
        t.push(this.createActionScaleRight(n));
        t.push(this.createActionNoScale(n));
        pro.hasPackage("mtp-mtpredictor") && (t.push(new ActionSeparator), t.push(this._createMTPredictorActions()));
        r = ContextMenu.createMenu(t)
    }
    return r
};
D53.prototype._createMTPredictorActions = function () {
    var t = this, n = function (n, i, r) {
        return n = new Action({text: n}), n.callbacks().subscribe(t, function () {
            var u = this._chart.model(), n = u.timeScale(), t = this._state.defaultPriceScale();
            n.isEmpty() || t.isEmpty() || (r ? (t = t.coordinateToPrice(this._contextMenuY), n = Math.round(n.coordinateToIndex(this._contextMenuX)), u.createLineTool(this._state, {index: n, price: t}, i)) : TradingView.drawingState.tool.setValue(i))
        }), n
    };
    return new Action({text: "MTPredictor", subActions: [n("Apply Manual Risk/Reward", "LineStudyMtpRiskReward", !1), n("Apply Manual Decision Point", "LineStudyMtpDecisionPoint", !0), n("Analyze Trade Setup", "LineStudyMtpAnalysis", !0), new Action({text: "Apply Elliot Wave", subActions: [n("Apply Elliot Wave Intermediate", "LineStudyMtpElliotWaveMain", !0), n("Apply Elliot Wave Major", "LineStudyMtpElliotWaveMajor", !0), n("Apply Elliot Wave Minor", "LineStudyMtpElliotWaveMinor", !0)]}), new Action({text: "Apply WPT Up Wave", subActions: [n("Up Wave 1 or A", "LineStudyMtpUpWave1OrA", !1), n("Up Wave 2 or B", "LineStudyMtpUpWave2OrB", !1), n("Up Wave C", "LineStudyMtpUpWaveC", !1), n("Up Wave 3", "LineStudyMtpUpWave3", !1), n("Up Wave 4", "LineStudyMtpUpWave4", !1), n("Up Wave 5", "LineStudyMtpUpWave5", !1)]}), new Action({text: "Apply WPT Down Wave", subActions: [n("Down Wave 1 or A", "LineStudyMtpDownWave1OrA", !1), n("Down Wave 2 or B", "LineStudyMtpDownWave2OrB", !1), n("Down Wave C", "LineStudyMtpDownWaveC", !1), n("Down Wave 3", "LineStudyMtpDownWave3", !1), n("Down Wave 4", "LineStudyMtpDownWave4", !1), n("Down Wave 5", "LineStudyMtpDownWave5", !1)]})]})
};
D53.prototype.createEarningsShow = function (n) {
    var t = this._chart.model().mainSeries().properties().esdShowEarnings;
    return n = new Action({checkable: !0, text: "Show Earnings", enabled: !0, checked: t.value()}), n.callbacks().subscribe(this, function (n) {
        this._chart.model().beginUndoMacro("Show Earnings");
        this._chart.model().setProperty(t, n.checked, "Show Earnings");
        this._chart.model().endUndoMacro()
    }), n
};
D53.prototype.createDividendsShow = function (n) {
    var t = this._chart.model().mainSeries().properties().esdShowDividends;
    return n = new Action({checkable: !0, text: "Show Dividends", enabled: !0, checked: t.value()}), n.callbacks().subscribe(this, function (n) {
        this._chart.model().beginUndoMacro("Show Dividends");
        this._chart.model().setProperty(t, n.checked, "Show Dividends");
        this._chart.model().endUndoMacro()
    }), n
};
D53.prototype.createSplitsShow = function (n) {
    var t = this._chart.model().mainSeries().properties().esdShowSplits;
    return n = new Action({checkable: !0, text: "Show Splits", enabled: !0, checked: t.value()}), n.callbacks().subscribe(this, function (n) {
        this._chart.model().beginUndoMacro("Show Splits");
        this._chart.model().setProperty(t, n.checked, "Show Splits");
        this._chart.model().endUndoMacro()
    }), n
};
D53.prototype._studyEsdContextMenu = function (n) {
    var t = [];
    return this._chart.readOnly() || (t.push(this.createDividendsShow(n)), t.push(this.createSplitsShow(n)), t.push(this.createEarningsShow(n))), ContextMenu.createMenu(t)
};
D53.prototype._studyContextMenu = function (n) {
    var r = this._chart.actions(), i = n.properties().visible.value(), t = [], u = null;
    return n.userEditEnabled() ? (n.properties().linkedToSeries && n.properties().linkedToSeries.value() ? this._chart.readOnly() ? t.push(i ? r.studyHide : this.createActionShow(n)) : (this._chart.canCreateAlertForDataSource(n) && t.push(this.createActionAddAlert({datasource: n})), t.push(r.format), t.push(i ? r.studyHide : this.createActionShow(n)), t.push(this.createVisualOrderAction(n)), i = n instanceof TradingView.study_PivotPointsStandard || n instanceof TradingView.study_VbPVisible, (0 < n.properties().inputs.childCount() || i) && (t.push(new ActionSeparator), 0 < n.properties().inputs.childCount() && t.push(this.createActionShowStudyArguments(n)), i && t.push(this.createActionShowLastValueLabels(n))), t.push(new ActionSeparator), t.push(r.studyRemove)) : this._chart.readOnly() ? t = [i ? r.studyHide : this.createActionShow(n), new ActionSeparator, this.createActionShowLastValueLabels(n), this.createActionShowStudyArguments(n), new ActionSeparator, this.createActionScaleLeft(n), this.createActionScaleRight(n), this.createActionNoScale(n)] : (u = [], t = n.metaInfo(), t.TVScriptSourceCode && t.scriptIdPart && (u = [r.viewSourceCode]), t = [], t = t.concat([r.format]), t = t.concat(u), t = t.concat([i ? r.studyHide : this.createActionShow(n), this.createVisualOrderAction(n), new ActionSeparator, this.createActionShowLastValueLabels(n), this.createActionShowStudyArguments(n), new ActionSeparator]), i = this._mergeContentMenuItems(n), i.length && i.push(new ActionSeparator), t = t.concat(i), t.push(this.createActionScaleLeft(n)), t.push(this.createActionScaleRight(n)), t.push(this.createActionNoScale(n)), t.push(new ActionSeparator), t.push(r.studyRemove), this._chart.canCreateAlertForDataSource(n) && t.unshift(this.createActionAddAlert({datasource: n}))), ContextMenu.createMenu(t)) : ContextMenu.createMenu(t)
};
D53.prototype.createLineToolTemplateAction = function (n) {
    var e = n.properties(), i = window.lineToolPropertiesToolbar.templatesList, r = new Action({text: $.t("Templates")}), u, t, f;
    return r.subActions || (r.subActions = []), u = r.subActions, t = new Action({text: $.t("Save As...")}), t.callbacks().subscribe(this, function () {
        i.showSaveDialog(n)
    }), u.push(t), t = new Action({text: $.t("Apply Default")}), t.callbacks().subscribe(this, function () {
        e.restoreFactoryDefaults();
        window.lineToolPropertiesToolbar.onSourceChanged(n)
    }), u.push(t), f = $.Deferred(), i.templatesLoaded().then(function () {
        var t = i.getData(), n = [];
        0 != t.length && n.push(new ActionSeparator);
        $.each(t, function (t, r) {
            var u = new Action({text: r});
            u.callbacks().subscribe(this, function () {
                i.loadTemplate(r)
            });
            u.deleteButton = {action: function (n) {
                return function () {
                    var t = this.getTopLevelMenu();
                    return t && t.hide(), i.deleteAction(n), !0
                }
            }(u.text)};
            n.push(u)
        });
        f.resolve(n)
    }), t = new ActionPlaceholder(f), u.push(t), r
};
D53.prototype._publishedChartsContextMenu = function (n) {
    var i = this._chart.actions(), t = [], u, r;
    return t.push(i.lineHide), is_authenticated && (i = new Action({checked: n.properties().filter.value() == PublishedChartsTimeline.FILTER_NONE, checkable: !0, text: $.t("Suggested ideas & my ideas"), callbackContext: {target: n, value: PublishedChartsTimeline.FILTER_NONE}}), u = new Action({checked: n.properties().filter.value() == PublishedChartsTimeline.FILTER_FOLLOWING, checkable: !0, text: $.t("Ideas of the people I follow & my ideas"), callbackContext: {target: n, value: PublishedChartsTimeline.FILTER_FOLLOWING}}), n = new Action({checked: n.properties().filter.value() == PublishedChartsTimeline.FILTER_PRIVATE, checkable: !0, text: $.t("My ideas only"), callbackContext: {target: n, value: PublishedChartsTimeline.FILTER_PRIVATE}}), r = function (n) {
        var t = n.callbackContext();
        n = t.target;
        t = t.value;
        console.log(t);
        n.properties().filter.setValue(t);
        n.updateAllViews();
        n.Q0.updateSource(n)
    }, i.callbacks().subscribe(null, r), u.callbacks().subscribe(null, r), n.callbacks().subscribe(null, r), t.push(new ActionSeparator), t.push(i), t.push(u), t.push(n)), ContextMenu.createMenu(t)
};
D53.prototype._publishedChartsContextMenu = function (n) {
    return n = this._chart.actions(), ContextMenu.createMenu([n.lineHide])
};
D53.prototype._lineContextMenu = function (n) {
    var i = this._chart.actions(), t = [], f, r, u;
    if (this._chart.readOnly())t.push(i.lineHide); else if (n.userEditEnabled() && (PropertyPagesFactory.hasStylesPropertyPage(n, this._chart.model()) && t.push(i.format), t.push(i.lineHide), J77.enabled("charting_library") || t.push(this.createLineToolTemplateAction(n)), t.push(this.createVisualOrderAction(n)), t.push(new ActionSeparator), t.push(i.lineRemove), n.properties().clonable && (t.push(new ActionSeparator), r = new Action({text: $.t("Clone"), callbackContext: {target: n}}), r.callbacks().subscribe(this, D53.prototype.cloneLineTool.bind(this, n)), t.push(r)), n.additionalActions))for (t.push(new ActionSeparator), i = n.additionalActions(this._chart.model()), r = 0; r < i.length; r++)t.push(i[r]);
    if (this._state.Q19(), i = new List, 1 < i.size()) {
        for (f = [], r = 0; r < i.size(); r++)u = i.item(r), u = new Action({checked: u === n.ownerSource(), checkable: !0, text: u.title(), callbackContext: {target: n, owner: u}}), u.callbacks().subscribe(null, this._lineContextMenu._actionCallback), f.push(u);
        n = new Action({subActions: f, text: $.t("Link To")});
        t.push(new ActionSeparator);
        t.push(n)
    }
    return ContextMenu.createMenu(t)
};
D53.prototype._alertLabelContextMenu = function (n) {
    return n = [this._createEditAlertAction(n), this._createStopAlertAction(n), this._createDeleteAlertAction(n), new ActionSeparator, this._createAlertToggleHorzLineAction(n), new ActionSeparator, this._createShowGlobalAlertPropertiesAction(n)], ContextMenu.createMenu(n)
};
D53.prototype._tradingDrawingsContextMenu = function (n) {
    return ContextMenu.createMenu(n.contextMenuItems())
};
D53.prototype._createAlertToggleHorzLineAction = function (n) {
    var i = n.properties().line.visible, t = new Action({checkable: !0, text: "Extend Alert Line", enabled: !0, checked: i.value()});
    return t.callbacks().subscribe(this, function (n) {
        n = n.checked;
        var t = (n ? "Show" : "Hide") + " alert label line";
        this._chart.model().setProperty(i, n, t)
    }), t.setEnabled(n.globalProperties().line.visible.value()), t
};
D53.prototype._createShowGlobalAlertPropertiesAction = function (n) {
    var t = this.chart();
    return n = new Action({text: "Visual settings..."}), n.callbacks().subscribe(this, function (n) {
        n = t.showChartProperties().find(".properties-tabs-label").filter(function () {
            return"Events" === $(this).text()
        });
        n.length && n.trigger("click")
    }), n
};
D53.prototype._createEditAlertAction = function (n) {
    var i = this.chart(), t = new Action({text: "Edit Alert..."});
    return t.callbacks().subscribe(this, function () {
        editAlert(n.alert(), i)
    }), t
};
D53.prototype._createDeleteAlertAction = function (n) {
    var t = new Action({text: "Delete Alert"});
    return t.callbacks().subscribe(this, function () {
        deleteAlert(n.alert())
    }), t
};
D53.prototype._createStopAlertAction = function (n) {
    var t = new Action({text: "Stop Alert"});
    return t.callbacks().subscribe(this, function () {
        stopAlert(n.alert())
    }), t
};
D53.prototype._lineContextMenu._actionCallback = function (n) {
    var f, i, u, r;
    n = n.callbackContext();
    f = [];
    i = n.target.priceScale();
    i.isPercent() && (u = n.target.ownerSource().firstValue());
    for (var e = n.target.points().toArray(), o = this._chart, t = 0; t < e.length; t++)r = e[t].price, i.isPercent() && (r = i.priceRange().convertToPercent(r, u)), r = i.priceToCoordinate(r), f.push(r);
    for (n.target.setOwnerSource(n.owner), i = n.owner.priceScale(), o.model().move(n.target, that._state, i), t = 0; t < f.length; t++)r = i.coordinateToPrice(f[t]), u = e[t], u.price = r, n.target.setPoint(t, u);
    o.model().model().recalculateAllPanes()
};
D53.prototype.cloneLineTool = function (n) {
    this._chart.model().cloneLineTool(n)
};
D53.prototype.setPriceAxisSize = function (n, t) {
    this._priceAxisWidget(n).setSize(t)
};
D53.prototype.setPriceAxisVisible = function (n, t) {
    this._priceAxisWidget(n).setVisible(t);
    this._cachedStatus = null
};
D53.prototype.resetPriceAxisOptimalWidth = function (n) {
    this._priceAxisWidget(n).resetOptimalWidth();
    this._cachedStatus = null
};
D53.prototype.setSize = function (n) {
    this.size && this.size.equals(n) || (this.size = n, TradingView.setCanvasSize(this.canvas, n), TradingView.setCanvasSize(this.top_canvas, n), this.ctx = this.canvas.getContext("2d"), this.jqPane.width(n.w), this.jqPane.height(n.h), this._cachedStatus = null)
};
D53.prototype.dataSourceAtPoint = function (n, t) {
    var f = null, h = null, e, i, o, u, s, r;
    if (!this._state)return null;
    for (e = new List(this._state.hitTestSources()), i = e.size(); 0 < i--;)if (o = e.item(i), u = o.paneViews(this._state), u) {
        for (s = u.size(); 0 < s--;)if (r = u.item(s).renderer(), r && r.hitTest && (r = r.hitTest(new MathEx.Point(n, t)))) {
            h = r;
            f = o;
            break
        }
        if (f)break
    }
    if (this.containsMainSeries())for (e = this._chart.model().barsMarksSources(), i = 0; i < e.length; ++i)for (o = e[i], u = o.paneViews(), i = 0; i < u.size(); i++)if (r = u.item(i).renderer(), s = r.hitTest(new MathEx.Point(n, t))) {
        h = s;
        f = o;
        break
    }
    return null === f && (f = this.legendWidget.dataSourceAtPoint(n, t)), {source: f, hittest: h}
};
D53.prototype.update = function () {
    this.lhsPriceAxisWidget.update();
    this.rhsPriceAxisWidget.update();
    this.legendWidget.update();
    this.paneControls && this.paneControls.update()
};
D53.prototype.updateControls = function () {
    this.paneControls && this.paneControls.update()
};
D53.prototype.drawBackground = function (n, t) {
    clearRect(n, 0, 0, this.size.w, this.size.h, t)
};
D53.prototype.drawGrid = function (n) {
    for (var r, i = this._chart.model().gridSource().paneViews(this._state), t = 0; t < i.size(); t++)n.save(), r = i.item(t).renderer(), r && r.draw(n), n.restore()
};
D53.prototype.drawWatermark = function (n) {
    for (var r, i = this._chart.model().watermarkSource().paneViews(this._state), t = 0; t < i.size(); t++)n.save(), r = i.item(t).renderer(), r && r.draw(n), n.restore()
};
D53.prototype.drawCrossHair = function (n) {
    var t = this._chart.model().crossHairSource();
    this._drawSource(t, n)
};
D53.prototype._drawSource = function (n, t) {
    var r = n.paneViews(this._state), i, u;
    if (r)for (i = 0; i < r.size(); i++)u = r.item(i).renderer(), u && (t.save(), u.draw(t), t.restore())
};
D53.prototype._drawSourceBackground = function (n, t) {
    var u = n.paneViews(this._state), i, r;
    if (u)for (i = 0; i < u.size(); i++)r = u.item(i).renderer(), r && r.drawBackground && (t.save(), r.drawBackground(t), t.restore())
};
D53.prototype.drawActiveLineTool = function (n) {
    for (var i, r = [this._chart.model().lineBeingCreated(), this._chart.model().sourceBeingMoved(), this._chart.model().lineBeingEdited()], t = 0; t < r.length; t++)i = r[t], i && this._chart.model().paneForSource(i) === this._state && this._drawSource(i, n)
};
D53.prototype.disableDrawOnTop = function (n) {
    return n && n.hasOwnProperty("_metaInfo") && "Volume@tv-basicstudies" === n._metaInfo.id
};
D53.prototype.drawSources = function (n) {
    var r = this._state.orderedSources(), f = this._state.model(), i = this._chart.model().hoveredSource(), f = f.crossHairSource(), e = [this._chart.model().lineBeingCreated(), this._chart.model().sourceBeingMoved(), this._chart.model().lineBeingEdited()], t, u;
    for (this.disableDrawOnTop(i) && (i = void 0), t = 0; t < r.length; t++)this._drawSourceBackground(r[t], n);
    for (t = 0; t < r.length; t++)u = r[t], u !== f && u !== i && -1 === e.indexOf(u) && this._drawSource(u, n);
    i && -1 === e.indexOf(i) && -1 !== r.indexOf(i) && this._drawSource(i, n)
};
D53.prototype.recalculatePriceScale = function () {
    var n = this._state, t, i;
    for (n.recalculatePriceScale(n.m_rightPriceScale), n.recalculatePriceScale(n.m_leftPriceScale), t = 0; t < n.Q19().size(); ++t)i = n.Q19().item(t), n.isOverlay(i) && (n.recalculatePriceScale(i.priceScale()), i.updateAllViews())
};
D53.prototype.containsMainSeries = function () {
    return this._state.containsMainSeries()
};
D53.prototype.drawBarsMarks = function (n, t) {
    if (this.containsMainSeries() && !t) {
        var i = this;
        this._chart.model().barsMarksSources().map(function (t) {
            i._drawSource(t, n)
        })
    }
};
D53.prototype._syncOverlays = function () {
    var t = this._state.orderedSources(), i = {}, r = this, n;
    $.each(t, function () {
        var u = this.paneViews(r._state), n, t;
        if (u)for (n = 0; n < u.size(); n++)t = u.item(n), t.uid && (i[t.uid()] = t)
    });
    for (n in this._overlays)i[n] || (this._dv.remove(this._overlays[n]), this._overlays[n] = void 0);
    for (n in i)this._overlays[n] || (t = i[n].overlay(), this._dv.append(t), this._overlays[n] = t)
};
D53.prototype.paint = function (n, t) {
    if (n && this._chart.model())if (this.lhsPriceAxisWidget.paint(n), this.rhsPriceAxisWidget.paint(n), n === D22.FULL_UPDATE && (this._cachedStatus = null), n === D22.UPDATE_CURSOR_ONLY)this.top_ctx.clearRect(0, 0, this.size.w, this.size.h), this.drawCrossHair(this.top_ctx), this.drawActiveLineTool(this.top_ctx); else {
        var i = this.ctx;
        this.top_ctx.clearRect(0, 0, this.size.w, this.size.h);
        this.drawBackground(i, this.backgroundColor());
        this._state && (this.recalculatePriceScale(), this.drawGrid(i), this.drawWatermark(i), this.drawSources(i), this.drawBarsMarks(i, t), this.drawCrossHair(this.top_ctx), this.drawActiveLineTool(this.top_ctx))
    }
};
D53.prototype.leftPriceAxisWidget = function () {
    return this.lhsPriceAxisWidget
};
D53.prototype.rightPriceAxisWidget = function () {
    return this.rhsPriceAxisWidget
};
D53.prototype._priceAxisWidget = function (n) {
    return D54.isLeft(n) ? this.lhsPriceAxisWidget : this.rhsPriceAxisWidget
};
D53.prototype.statusWidget = function () {
    return this.legendWidget
};
D53.prototype.onScaleLeft = function (n) {
    n = n.callbackContext();
    this._state.leftPriceScale().Q19().contains(n) || this.chart().model().move(n, this._state, this._state.leftPriceScale())
};
D53.prototype.onScaleRight = function (n) {
    n = n.callbackContext();
    this._state.rightPriceScale().Q19().contains(n) || this.chart().model().move(n, this._state, this._state.rightPriceScale())
};
D53.prototype.onNoScale = function (n) {
    n = n.callbackContext();
    this._state.isOverlay(n) || this.chart().model().move(n, this._state, null)
};
D53.prototype.onRiskReward = function (n) {
    n.callbackContext()
};
D53.prototype.createActionTrade = function (n) {
    if (!TradingView.Trading || !TradingView.Q18("paper_trading"))return null;
    var e = this._state.Q19().find(function (n) {
        return n instanceof TradingView.Series
    }), r = NaN, t = NaN, u = 1, f = "", o = "", s = "", i = !1;
    return e && (o = e.actualSymbol(), s = (e.symbolInfo() || {}).name || o, i = e.priceScale(), n && (r = i.coordinateToPrice(n.localY), i.isPercentage() && (n = this._state.mainDataSource().firstValue(), r = "undefined" != typeof n ? i.priceRange().convertFromPercent(r, n) : null), f = e.formatter().format(r)), (i = e.bars().last()) && (t = i.value[CLOSE_PLOT]), i = !!(e.symbolInfo() || {}).is_tradable, i = !0, n = e.symbolInfo(), u = TradingView.Trading.suggestedQty.value(o, {symbolType: n && n.type})), n = [], r < t ? (t = new Action({text: "Buy " + s + " Limit " + abbreviatedNumber(u) + " @ " + f, enabled: i}), i && t.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            TradingView.OrderDialog.get().open({symbol: o, price: +f || r, side: "buy", type: "limit", qty: u, noConfirm: !0})
        })
    }), n.push(t), t = new Action({text: "Sell " + s + " Stop " + abbreviatedNumber(u) + " @ " + f, enabled: i}), i && t.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            TradingView.OrderDialog.get().open({symbol: o, price: +f || r, side: "sell", type: "stop", qty: u, noConfirm: !0})
        })
    }), n.push(t)) : r > t && (t = new Action({text: "Sell " + s + " Limit " + abbreviatedNumber(u) + " @ " + f, enabled: i}), i && t.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            TradingView.OrderDialog.get().open({symbol: o, price: +f || r, side: "sell", type: "limit", qty: u, noConfirm: !0})
        })
    }), n.push(t), t = new Action({text: "Buy " + s + " Stop " + abbreviatedNumber(u) + " @ " + f, enabled: i}), i && t.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            TradingView.OrderDialog.get().open({symbol: o, price: +f || r, side: "buy", type: "stop", qty: u, noConfirm: !0})
        })
    }), n.push(t)), t = new Action({text: "Create New Order...", enabled: i}), i && t.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            TradingView.OrderDialog.get().open({qty: u, symbol: e.actualSymbol(), price: +f || r})
        })
    }), n.push(t), n.push(new ActionSeparator), t = new Action({text: "Trading Properties..."}), t.callbacks().subscribe(null, function () {
        TradingView.bottomWidgetBar.showTradingProperties()
    }), n.push(t), new Action({text: "Trading", subActions: n})
};
D53.prototype.createActionRiskReward = function (n) {
    var t = new Action({checkable: !1, text: "Risk/Reward", enabled: !0});
    return t.setCallbackContext(n), t.callbacks().subscribe(this, D53.prototype.onRiskReward), t
};
D53.prototype.createActionScaleLeft = function (n) {
    var t = new Action({checkable: !0, text: $.t("Scale Left"), enabled: !0});
    return t.setCallbackContext(n), t.setChecked(this._state.leftPriceScale().Q19().contains(n)), t.callbacks().subscribe(this, D53.prototype.onScaleLeft), t
};
D53.prototype.createActionScaleRight = function (n) {
    var t = new Action({checkable: !0, text: $.t("Scale Right"), enabled: !0});
    return t.setCallbackContext(n), t.setChecked(this._state.rightPriceScale().Q19().contains(n)), t.callbacks().subscribe(this, D53.prototype.onScaleRight), t
};
D53.prototype.createActionNoScale = function (n) {
    var t = this._chart.model().paneForSource(n).actionNoScaleIsEnabled(n), t = new Action({checkable: !0, text: $.t("Screen (No Scale)"), enabled: t});
    return t.setCallbackContext(n), t.setChecked(this._state.isOverlay(n)), t.callbacks().subscribe(this, D53.prototype.onNoScale), t
};
D53.prototype.createActionShowStudyArguments = function (n) {
    var t = new Action({checkable: !0, text: $.t("Show Arguments in Header"), enabled: !0});
    return t._binding = new Q14(t, n.properties().showStudyArguments, this._chart.model(), t.text), t._binding.setValue(n.properties().showStudyArguments.value()), t
};
D53.prototype.createActionShowLastValueLabels = function (n) {
    var t = new Action({checkable: !0, text: $.t("Last Value on Price Scale"), enabled: !0});
    return t._binding = new Q14(t, n.properties().showLastValue, this._chart.model(), t.text), t._binding.setValue(n.properties().showLastValue.value()), t
};
D53.prototype.createActionShowCountdown = function (n) {
    n = new Action({checkable: !0, text: "Show Countdown", enabled: !0});
    var t = this._chart.model().mainSeries().properties();
    return n._binding = new Q14(n, t.showCountdown, this._chart.model(), n.text), n._binding.setValue(t.showCountdown.value()), n
};
D53.prototype.createActionLockScale = function (n) {
    if (!(n instanceof TradingView.Series))return null;
    var t = new Action({checkable: n.properties().lockScale.value(), text: $.t("Lock Scale"), enabled: !0});
    return t._binding = new Q14(t, n.properties().lockScale, this._chart.model(), t.text, function (t) {
        this._undoModel.setLockScaleProperty(this._property, t.checked, n, this._undoText)
    }), t
};
D53.prototype.createActionMergeUp = function (n) {
    if (this._chart.model().paneForSource(n) === this._chart.model().panes().item(0))return null;
    var t = new Action({checkable: !1, text: $.t("Merge Up"), enabled: !0});
    return t.setCallbackContext(n), t.callbacks().subscribe(this, D53.prototype.onMergeUp), t
};
D53.prototype.onMergeUp = function (n) {
    n = n.callbackContext();
    var t = this._chart.model().paneForSource(n), t = this._chart.model().panes().indexOf(t), t = this._chart.model().panes().item(t - 1), i = t.findSuitableScale(n);
    this._chart.model().move(n, t, i)
};
D53.prototype.createActionUnmergeUp = function (n) {
    if (!(1 < this._chart.model().paneForSource(n).Q19().count(function (n) {
        return isInherited(n.constructor, PriceDataSource) && n.showInObjectTree()
    })))return null;
    var t = new Action({checkable: !1, text: $.t("Unmerge Up"), enabled: !0});
    return t.setCallbackContext(n), t.callbacks().subscribe(this, D53.prototype.onUnmergeUp), t
};
D53.prototype.onUnmergeUp = function (n) {
    n = n.callbackContext();
    var t = this._chart.model().paneForSource(n), t = this._chart.model().panes().indexOf(t), t = this._chart.model().createPane(t), i = t.findSuitableScale(n);
    this._chart.model().move(n, t, i)
};
D53.prototype.createActionMergeDown = function (n) {
    var t = this._chart.model().paneForSource(n), i = this._chart.model().panes();
    return t === i.item(i.size() - 1) ? null : (t = new Action({checkable: !1, text: $.t("Merge Down"), enabled: !0}), t.setCallbackContext(n), t.callbacks().subscribe(this, D53.prototype.onMergeDown), t)
};
D53.prototype.onMergeDown = function (n) {
    n = n.callbackContext();
    var t = this._chart.model().paneForSource(n), t = this._chart.model().panes().indexOf(t), t = this._chart.model().panes().item(t + 1), i = t.findSuitableScale(n);
    this._chart.model().move(n, t, i)
};
D53.prototype.createActionUnmergeDown = function (n) {
    if (!(1 < this._chart.model().paneForSource(n).Q19().count(function (n) {
        return isInherited(n.constructor, PriceDataSource) && n.showInObjectTree()
    })))return null;
    var t = new Action({checkable: !1, text: $.t("Unmerge Down"), enabled: !0});
    return t.setCallbackContext(n), t.callbacks().subscribe(this, D53.prototype.onUnmergeDown), t
};
D53.prototype.onUnmergeDown = function (n) {
    n = n.callbackContext();
    var t = this._chart.model().paneForSource(n), t = this._chart.model().panes().indexOf(t), t = this._chart.model().createPane(t + 1), i = t.findSuitableScale(n);
    this._chart.model().move(n, t, i)
};
D53.prototype._mergeContentMenuItems = function (n) {
    var i = [], t = this.createActionMergeUp(n);
    return t && i.push(t), (t = this.createActionUnmergeUp(n)) && i.push(t), (t = this.createActionMergeDown(n)) && i.push(t), (t = this.createActionUnmergeDown(n)) && i.push(t), i
};
D53.prototype.createActionShow = function (n) {
    var t = new Action({checkable: !0, text: $.t("Show"), enabled: !0});
    return t._binding = new Q14(t, n.properties().visible, this._chart.model(), t.text), t._binding.setValue(n.properties().visible.value()), t
};
D53.prototype.bringObjectForward = function (n) {
    (n = this._chart.model().selectedSource()) && this._chart.model().changeZOrder(n, 1)
};
D53.prototype.sendObjectToBack = function (n) {
    (n = this._chart.model().selectedSource()) && this._chart.model().sendToBack(n)
};
D53.prototype.bringObjectToFront = function (n) {
    (n = this._chart.model().selectedSource()) && this._chart.model().bringToFront(n)
};
D53.prototype.sendObjectBackward = function (n) {
    (n = this._chart.model().selectedSource()) && this._chart.model().changeZOrder(n, -1)
};
D53.prototype.createVisualOrderAction = function (n) {
    var t = new Action({text: $.t("Visual Order")}), i, r, u, f, e;
    return t.subActions || (t.subActions = []), i = new Action({text: $.t("Bring to Front")}), i.callbacks().subscribe(this, D53.prototype.bringObjectToFront), t.subActions.push(i), r = new Action({text: $.t("Send to Back")}), r.callbacks().subscribe(this, D53.prototype.sendObjectToBack), t.subActions.push(r), u = new Action({text: $.t("Bring Forward")}), u.callbacks().subscribe(this, D53.prototype.bringObjectForward), t.subActions.push(u), f = new Action({text: $.t("Send Backward")}), f.callbacks().subscribe(this, D53.prototype.sendObjectBackward), t.subActions.push(f), e = this._chart.model().paneForSource(n).getZOrderMinMax(), r.setEnabled(!0), u.setEnabled(!0), f.setEnabled(!0), i.setEnabled(!0), n.zorder() === e.minZOrder && (r.setEnabled(!1), f.setEnabled(!1)), n.zorder() === e.maxZOrder && (u.setEnabled(!1), i.setEnabled(!1)), t
};
D53.prototype.createActionAddAlert = function (n) {
    function e(n) {
        void 0 === n || null === n || isNaN(n) || (f += " (" + n + ") ", u.value = n)
    }

    var o = this._chart, u = {}, f = "Add Alert", i = this._state, t, r;
    return n.datasource ? (n.datasource instanceof TradingView.Series ? r = n.datasource.lastValueData(null, !0, !0) : n.datasource instanceof TradingView.Study && (i = n.datasource.metaInfo().plots[0].id, r = n.datasource.lastValueData(i, !0, !0)), r && (t = r.price), t && (i = (n.datasource.priceScale() || this._state.mainDataSource().priceScale() || o.model().mainSeries().priceScale()).formatter(), i.formatAsDecimal && (t = i.formatAsDecimal(t)), e(t)), u.series = n.datasource) : n.e && (t = i.defaultPriceScale(), n = t.coordinateToPrice(n.e.localY), t.isPercentage() && (r = this._state.mainDataSource().firstValue(), n = "undefined" != typeof r ? t.priceRange().convertFromPercent(n, r) : null), e(this._state.mainDataSource().formatter().formatAsDecimal(n)), n = i.mainDataSource(), u.series = n), f += "...", n = new Action({text: f}), n.callbacks().subscribe(null, function () {
        runOrSignIn(function () {
            new TradingView.MakeAlertDialog(o, u)
        })
    }), n
};
D53.prototype.image = function () {
    var n = {};
    return n.leftAxis = this.leftPriceAxisWidget().image(), n.rightAxis = this.rightPriceAxisWidget().image(), n.content = this.canvas.toDataURL(), n.contentWidth = this.size.w, n.contentHeight = this.size.h, n
};
D53.prototype._updateTooltip = function (n, t) {
    if (!this._rafSet) {
        var i = this;
        requestAnimationFrame(function () {
            i._updateTooltipImpl(n, t);
            i._rafSet = !1
        });
        this._rafSet = !0
    }
};
D53.prototype._updateTooltipImpl = function (n, t) {
    function u(u) {
        TradingView[i].getTooltipText && (u = TradingView[i].getTooltipText(o) || u);
        r._tooltipSelector.html(u).removeClass("tooltip-selector-hidden").css(TradingView.isMobile.any() ? {left: n - r._tooltipSelector.outerWidth() - 16, top: t - r._tooltipSelector.outerHeight() - 16} : {left: n + 16, top: t + 16})
    }

    if (this._chart) {
        for (var r = this, e = this._chart._paneWidgets, i = TradingView.drawingState.tool.value(), o = this._state.model().lineBeingCreated(), f = e.length - 1; 0 <= f; f--)e[f]._hideTooltip();
        TradingView.Study.isStudyLineTool(i) && !TradingView.isMobile.any() ? u($.t("Click to set a point")) : TradingView.isMobile.any() && "LineToolBrush" != i && r.isLineTool(i) && !r._chart.model().lineBeingCreated() ? u($.t("1. Slide your finger to select location for first anchor<br>2. Tap anywhere to place the first anchor")) : TradingView.isMobile.any() && "LineToolBrush" != i && r.isLineTool(i) && u($.t("1. Slide your finger to select location for next anchor<br>2. Tap anywhere to place the next anchor"))
    }
};
D53.prototype._hideTooltip = function () {
    this._tooltipSelector.addClass("tooltip-selector-hidden")
};
$.extend(EditObjectDialog, {TAB_PRIORITY_COORDINATES: 100, TAB_PRIORITY_DISPLAY: 100, TAB_PRIORITY_STYLE: 200, TAB_PRIORITY_INPUTS: 300, TAB_NAME_COORDINATES: "Coordinates", TAB_NAME_DISPLAY: "Properties", TAB_NAME_STYLE: "Style", TAB_NAME_INPUTS: "Inputs", TAB_NAME_GRAPHICS: "Graphics", TAB_OPEN_DEFAULT: 100, TAB_OPEN_USERSAVE: 200, TAB_OPEN_OVERRIDE: 300});
EditObjectDialog.prototype.hide = function () {
    if (D83.destroy(this._dialogTitle), $(window).unbind("keyup.hidePropertyDialog"), window.lineToolPropertiesToolbar)window.lineToolPropertiesToolbar.onSourceChanged(this.J99)
};
EditObjectDialog.prototype.isVisible = function () {
    return this._dialog && this._dialog.is(":visible")
};
EditObjectDialog.prototype.focusOnText = function () {
    this._dialog.find('input[type="text"]').focus().select()
};
EditObjectDialog.prototype.switchTab = function (n, t) {
    var i, r;
    if (this._tabs)return(i = null, n ? n = n.valueOf() : null === n && (n = void 0), "string" == typeof n && $.each(this._tabs, function (t, r) {
        if (r.name == n)return i = r, !1
    }), "object" == typeof n && $.each(this._tabs, function (t, r) {
        if (n == r || $(r.labelObject).is(n) || $(r.wrapperObject).is(n))return i = r, !1
    }), i || (i = this._tabs[~~n]), !i) ? !1 : ($.each(this._tabs, function (n, t) {
        var r = t == i;
        $(t.wrapperObject)[r ? "show" : "hide"]();
        $(t.labelObject)[r ? "addClass" : "removeClass"]("active")
    }), t && (r = this.activeTabSettingsName(), r && TVSettings.setValue(r, i.name)), !0)
};
EditObjectDialog.prototype.appendToTab = function (n, t, i, r) {
    var f, u;
    (!$(n).is("table") || $(n).find("tr").size()) && (this._tabs || (this._tabs = []), $.each(this._tabs, function (n, i) {
        if (i.name == t)return f = n, !1
    }), void 0 === f && (this._tabs.push({name: t, localizedName: $.t(t), objects: $(), displayPriority: 0, defaultOpen: 0}), f = this._tabs.length - 1), u = this._tabs[f], u.objects = u.objects.add(n), u.displayPriority = Math.max(u.displayPriority || 0, i || 0), u.defaultOpen = Math.max(u.defaultOpen || 0, r || 0))
};
EditObjectDialog.prototype.insertTabs = function () {
    var i;
    if (this._tabs) {
        this._tabs.sort(function (n, t) {
            return(t.displayPriority || 0) - (n.displayPriority || 0)
        });
        var t = this, n = null, r = this.activeTabSettingsName();
        r && (i = TVSettings.getValue(r));
        $.each(this._tabs, function (r, u) {
            i && i === u.name && (u.defaultOpen = Math.max(~~u.defaultOpen, EditObjectDialog.TAB_OPEN_USERSAVE));
            (!n || ~~n.defaultOpen < ~~u.defaultOpen) && (n = u);
            u.labelObject = $('<a href="#" class="properties-tabs-label"><\/a>').text(u.localizedName).appendTo(t._tabContainer);
            u.labelObject.bind("click", function () {
                t.switchTab(this, !0)
            });
            var f = $('<div class="main-properties"><\/div>');
            u.wrapperObject = $().add(f);
            u.objects.each(function (n, t) {
                var i = $(t);
                i.is("table") ? (i.data("layout-separated") && (u.wrapperObject = u.wrapperObject.add('<div class="properties-separator"><\/div>').add(f = $('<div class="main-properties"><\/div>')), i.removeData("layout-separated")), f.append(i), i.children("tbody").each(function (n, i) {
                    if (0 !== n && $(i).data("layout-separated")) {
                        u.wrapperObject = u.wrapperObject.add('<div class="properties-separator"><\/div>').add(f = $('<div class="main-properties"><\/div>'));
                        var r = $(t).clone(!0, !1).appendTo(f);
                        r.children().remove();
                        r.append(i);
                        $(i).removeData("layout-separated")
                    }
                })) : f.append(i)
            });
            u.wrapperObject.appendTo(t._container)
        });
        2 > this._tabs.length ? (this._tabContainer.remove(), $(".main-properties .property-page:first-child tbody:first-child tr:first-child td:last-child").css("padding-right", "30px"), $(".main-properties").addClass("main-properties-tabless")) : this.switchTab(n)
    }
};
EditObjectDialog.prototype.activeTabSettingsName = function () {
    var n = this.J99;
    if (n) {
        if (n instanceof TradingView.Series || n instanceof D7)return"properties_dialog.active_tab.chart";
        if (n instanceof J47)return"properties_dialog.active_tab.drawing";
        if (n instanceof TradingView.Study)return"properties_dialog.active_tab.study"
    }
};
EditObjectDialog.prototype.show = function (n) {
    function s() {
        i.Q0.undoToCheckpoint(i._undoCheckpoint ? i._undoCheckpoint : l);
        i.hide()
    }

    n = n || {};
    isInherited(this.J99.constructor, D7) && TradingView.trackEvent("GUI", "Chart Properties");
    isInherited(this.J99.constructor, TradingView.Study) && TradingView.trackEvent("GUI", "Study Properties");
    isInherited(this.J99.constructor, DataSource) && this.Q0.setSelectedSource(this.J99);
    var r = PropertyPagesFactory.createInputsPropertyPage(this.J99, this.Q0), t = PropertyPagesFactory.createStylesPropertyPage(this.J99, this.Q0), e = PropertyPagesFactory.createDisplayPropertyPage(this.J99, this.Q0);
    if (r || t) {
        var i = this, o = null !== r, h = this.J99.title(), u = D83.createDialog(h, {hideTitle: !0, dragHandle: ".properties-tabs"}), f = u.find(".tv-dialog-content"), c = $('<div class="properties-tabs"><\/div>').appendTo(f), l = this.Q0.createUndoCheckpoint();
        this._tabs = [];
        this._dialog = u;
        this._dialogTitle = h;
        this._dialog = u;
        this._container = f;
        this._tabContainer = c;
        u.on("destroy", function () {
            r && r.destroy();
            t && t.destroy();
            e && e.destroy()
        });
        n.selectScales && t.setScalesOpenTab && t.setScalesOpenTab();
        n.selectTmz && t.setTmzOpenTab && t.setTmzOpenTab();
        this.Q0.readOnly() || !o || r.widget().is(":empty") || r.widget().each(function (n, t) {
            var e = r instanceof _14, f = +$(t).data("layout-tab-priority"), o, u;
            isNaN(f) && (f = e ? EditObjectDialog.TAB_PRIORITY_COORDINATES : EditObjectDialog.TAB_PRIORITY_INPUTS);
            o = ~~$(t).data("layout-tab-open");
            u = $(t).data("layout-tab");
            void 0 === u && (u = e ? EditObjectDialog.TAB_NAME_COORDINATES : EditObjectDialog.TAB_NAME_INPUTS);
            i.appendToTab(t, u, f, o)
        });
        t && t.widget().each(function (n, r) {
            var e = +$(r).data("layout-tab-priority"), u, f;
            isNaN(e) && (e = EditObjectDialog.TAB_PRIORITY_STYLE);
            u = ~~$(r).data("layout-tab-open");
            !u && t instanceof _49 && (u = EditObjectDialog.TAB_OPEN_DEFAULT);
            f = $(r).data("layout-tab");
            void 0 === f && (f = EditObjectDialog.TAB_NAME_STYLE);
            i.appendToTab(r, f, e, u)
        });
        e && e.widget().each(function (n, t) {
            var u = +$(t).data("layout-tab-priority"), f, r;
            isNaN(u) && (u = EditObjectDialog.TAB_PRIORITY_DISPLAY);
            f = ~~$(t).data("layout-tab-open");
            r = $(t).data("layout-tab");
            void 0 === r && (r = EditObjectDialog.TAB_NAME_DISPLAY);
            i.appendToTab(t, r, u, f)
        });
        this.insertTabs();
        this.J99 instanceof TradingView.Study && this.J99.metaInfo().isTVScript && this.J99.metaInfo().TVScriptSourceCode && !TradingView.isMobileView && this._createOpenTVScriptEditor();
        this._helpItemRequired() && this._createHelp();
        n = $('<div class="main-properties main-properties-aftertabs"><\/div>').appendTo(f);
        n = $('<div class="dialog-buttons">').appendTo(n);
        o = function () {
            var n = [], u;
            t && "function" == typeof t.defaultProperties && (n = n.concat(t.defaultProperties()));
            r && "function" == typeof r.defaultProperties && (n = n.concat(r.defaultProperties()));
            0 === n.length && i.J99.properties ? n = [i.J99.properties()] : i.J99._sessionsStudy && (n = n.concat(i.J99._sessionsStudy.properties()));
            n.length && (u = function (n) {
                n._childs && n._childs.length && $.each(n._childs, function (t, i) {
                    "percentage" == i ? n.percentage.listeners().fire(n.percentage) : u(n[i])
                })
            }, $.each(n, function (n, t) {
                i.Q0.restoreFactoryDefaults(t);
                u(t)
            }), i.J99.properties().minTick && i.J99.properties().minTick.listeners().fire(i.J99.properties().minTick), i.J99.properties().precision && i.J99.properties().precision.listeners().fire(i.J99.properties().precision), r && r.loadData(), t.onResoreDefaults && t.onResoreDefaults(), t && t.loadData())
        };
        t && "function" == typeof t.createTemplateButton && !J77.enabled("charting_library") ? t.createTemplateButton({defaultsCallback: o}).addClass("tv-left").appendTo(n) : $('<a class="tv-button tv-left">' + $.t("Defaults") + "<\/a>").appendTo(n).click(o);
        $('<a class="tv-button ok">' + $.t("OK") + "<\/a>").appendTo(n).click(function () {
            i.hide()
        });
        $('<a class="tv-button cancel">' + $.t("Cancel") + "<\/a>").appendTo(n).on("click", s);
        u.find(".tv-dialog-title a").on("click", s);
        return $(window).bind("keyup.hidePropertyDialog", function (n) {
            "13" == n.keyCode && "textarea" !== n.target.tagName.toLowerCase() && (i.hide(), $(window).unbind("keyup.hidePropertyDialog"))
        }), $("select", f).each(function () {
            var n = $(this), t = "tv-select-container dialog";
            n.hasClass("tv-select-container-fontsize") && (t += " tv-select-container-fontsize");
            n.selectbox({speed: 100, classHolder: t})
        }), $('input[type="text"]', f).addClass("tv-text-input inset dialog"), $("input.ticker", f).TVTicker(), u.css("min-width", "400px"), D83.applyHandlers(u), f = {top: ($(window).height() - u.height()) / 2, left: ($(window).width() - u.width()) / 2}, t && "function" == typeof t.dialogPosition && (f = t.dialogPosition(f, u) || f), D83.positionDialog(u, f), window.lineToolPropertiesToolbar && window.lineToolPropertiesToolbar.hide(), u
    }
};
EditObjectDialog.prototype._helpItemRequired = function () {
    return this.J99._metaInfo && !!this.J99._metaInfo.helpURL
};
EditObjectDialog.prototype._createHelp = function () {
    var n = $('<a class="help" href="#" target="_blank" title="' + $.t("Help") + '"><\/a>');
    n.attr("href", this.J99._metaInfo.helpURL);
    this._tabContainer.prepend(n)
};
EditObjectDialog.prototype._createOpenTVScriptEditor = function () {
    var n = this;
    $('<a href="#" class="properties-tabs-label"><\/a>').text("Source Code").appendTo(this._tabContainer).bind("click", function () {
        n.hide();
        var t = this.J99.metaInfo();
        window.scriptEditor.show({scriptSource: t.TVScriptSourceCode, scriptIdPart: t.scriptIdPart})
    }.bind(this))
};
ObjectTreeDialog.prototype.getSourceProperties = function () {
    for (var n, r = {groups: [], model: this.Q0, drawings: []}, u = 0; u < this.Q0.panes().size(); u++) {
        for (var i = this.Q0.panes().item(u), f = [], e = i.orderedSources(), t = 0; t < e.length; t++)n = e[t], n.showInObjectTree() && f.push({datasource: n, name: n.title()});
        for (i = i.Q19(), t = 0; t < i.size(); t++)n = i.item(t), n instanceof J47 && n.showInObjectTree() && r.drawings.push({datasource: n, name: n.title(), symbol: D68.shortName(n.symbol())});
        f.length && r.groups.push({children: f})
    }
    return r
};
ObjectTreeDialog.prototype.calcHeight = function (n, t) {
    for (var r = 0, i = 0; i < n.length; i++)if (n[i] > t) {
        r = 0 === i ? n[0] : n[i - 1];
        break
    } else r = n[i];
    return r < this.options.minHeight && (r = this.options.minHeight), r
};
ObjectTreeDialog.prototype.tabChanged = function (n) {
    0 === n ? this.objectsTreeTab.tabChanged() : this.manageDrawingsTab.tabChanged()
};
ObjectTreeDialog.prototype.onDestroy = function () {
    this.objectsTreeTab.unsubscribeListeners();
    this.manageDrawingsTab && this.manageDrawingsTab.unsubscribeListeners()
};
ObjectTreeDialog.prototype.show = function () {
    var n, f, u, o, t, e, s, h;
    this.title = $.t("Objects Tree");
    TradingView.trackEvent("GUI", "Objects Tree");
    n = window.user && !0 === user.is_staff && !0 !== user.is_moderator;
    f = {};
    n && $.extend(f, {hideTitle: !0, dragHandle: ".properties-tabs"});
    var i = D83.createDialog(this.title, f), r = i.find(".tv-dialog-content"), f = i.find(".tv-dialog-title");
    n && (u = $('<div class="properties-tabs"><\/div>').appendTo(r), o = $('<a href="#" class="properties-tabs-label with-filter"><\/a>').text($.t("Objects Tree")).appendTo(u), $('<a href="#" class="properties-tabs-label"><\/a>').text($.t("Manage Drawings")).appendTo(u));
    r = $("<div>").appendTo(r);
    n && r.addClass("with-drawings");
    t = $(window).height();
    t = t > this.options.maxHeight ? this.options.maxHeight : t;
    n && (t -= u.height());
    t = t - this.options.padding;
    e = $('<div class="main-tree-page active">').appendTo(r);
    n && (e.addClass("no-top-border"), s = $('<div class="main-tree-page active">').appendTo(r));
    this.objectsTreeTab = new ObjectsTreeTab(this, this.options, this.Q0);
    n && (this.manageDrawingsTab = new ManageDrawingsTab(this, this.options, this.Q0));
    this.objectsTreeTab.createView(e, n ? o : f, t);
    n && this.manageDrawingsTab.createView(s, t);
    n && (this.tabs = new D71(u, r, {saveTab: "ObjectsTreeDialog.tab"}));
    n && this.tabs.tabChanged.subscribe(this, this.tabChanged);
    D83.applyHandlers(i);
    D83.positionDialog(i);
    h = this;
    i.on("destroy", this.onDestroy.bind(this));
    setTimeout(function () {
        i.unbind("mousedownoutside");
        i.on("mousedownoutside", function (n) {
            $(n.target).parents().andSelf().is(".tv-dialog, .properties-toolbar, .colorpicker, .charts-popup-list, .tv-dialog, .tvcolorpicker-popup, .symbol-edit-popup, .context-menu") || (D83.destroy(h.title), i.unbind("mousedownoutside"))
        })
    })
};
ObjectTreeDialog._getBackgroundByTile = function (n) {
    return n = D6.prototype.Button.iconIndices[n], void 0 !== n ? [1, 32 * n + 1] : null
};
ObjectTreeDialog._getBackgroundPosition = function (n) {
    return"-" + n[0] + "px -" + n[1] + "px"
};
ObjectTreeDialog.List = function (n, t, i, r) {
    this.model = n;
    this.datasources = {};
    this.contentHeights = [];
    this.content = t;
    this.dialog = i;
    this.options = r
};
ObjectTreeDialog.List.prototype.setDefaultItemClass = function (n) {
    this.defaultItemClass = n
};
ObjectTreeDialog.List.prototype.setActiveListener = function (n) {
    this.activeListener = n
};
ObjectTreeDialog.List.prototype.setActive = function (n) {
    this.content.find(".tv-dialog-tree-item").removeClass("active");
    n.addClass("active");
    this.activeListener && this.activeListener(n);
    n = this.datasources[n.attr("id")];
    this.model.setSelectedSource(n.datasource);
    this.model.Q20(new D22(D22.LIGHT_UPDATE))
};
ObjectTreeDialog.List.prototype.createItem = function (n, t, i) {
    var e = this, r = $('<a class="tv-dialog-tree-item"><\/a>').appendTo(t), o, f, u;
    return t = $('<span class="tree-icon-container">').appendTo(r), n.skipped && r.addClass("skipped"), r.attr("id", n.datasource.id()), this.defaultItemClass && r.addClass(this.defaultItemClass), this.datasources[n.datasource.id()] = n, this.contentHeights.push(this.content.height()), o = $('<div class="name-column"><\/div>').appendTo(r), $('<span class="name">' + $.t(n.name) + "<\/span>").appendTo(o), this.setIcon(r, n), this.setVisible(r, n), r.mousedown(function () {
        e.setActive(r)
    }), n.datasource.userEditEnabled() && (isInherited(n.datasource.constructor, J47) ? (f = $('<a class="button icon-lock" title="' + $.t("Lock/Unlock") + '">'), f.click(function (t) {
        t = n.datasource.properties().frozen.value();
        e.model.setProperty(n.datasource.properties().frozen, !t, "Lock/Unlock " + n.datasource.title())
    }), f.appendTo(t), $('<span class="icon">').appendTo(f), n.datasource.properties().frozen.value() && (r.addClass("locked"), f.addClass("active")), n.datasource.properties().frozen.subscribe(this, function (n) {
        n = n.value();
        r.toggleClass("locked", n);
        f.toggleClass("active", n)
    })) : i && $('<div class="button hidden">&nbsp;<\/div>').appendTo(t), u = $('<a class="button icon-hide" title="' + $.t("Show/Hide") + '">'), u.click(function (t) {
        t = n.datasource.properties().visible.value();
        r.toggleClass("hidden", t);
        u.toggleClass("active", t);
        e.model.setProperty(n.datasource.properties().visible, !t, "Show/Hide " + n.datasource.title())
    }), u.appendTo(t), $('<span class="icon">').appendTo(u), n.datasource.properties().visible.value() || (r.addClass("hidden"), u.addClass("active")), n.datasource.properties().visible.subscribe(this, function (n) {
        n = n.value();
        r.toggleClass("hidden", !n);
        u.toggleClass("active", !n)
    }), this.createPropertyIcon(n, t, r)), r
};
ObjectTreeDialog.List.prototype.contextMenuEvent = function (n, t) {
    this.options.Q3.paneByState(this.model.paneForSource(t)).showContextMenuForSource(t, n)
};
ObjectTreeDialog.List.prototype.createPropertyIcon = function (n, t, i) {
    var r = this;
    n.datasource instanceof J47 && !n.datasource.isActualSymbol() ? $('<div class="button hidden">&nbsp;<\/div>').appendTo(t) : n.datasource === this.model.mainSeries() && this.options.Q3 && this.options.Q3.onWidget() ? $('<div class="button hidden">&nbsp;<\/div>').appendTo(t) : (PropertyPagesFactory.hasStylesPropertyPage(n.datasource) || PropertyPagesFactory.hasInputsPropertyPage(n.datasource)) && (t = $('<a class="button format" title="' + $.t("Format") + '">').click(function () {
        new EditObjectDialog(n.datasource, r.model).show()
    }).appendTo(t), $('<span class="icon">').appendTo(t), i.dblclick(function () {
        new EditObjectDialog(n.datasource, r.model).show()
    }), i.on("contextmenu", function (t) {
        r.contextMenuEvent(t, n.datasource);
        t.preventDefault();
        t.stopPropagation()
    }))
};
ObjectTreeDialog.List.prototype.updateItem = function (n) {
    var t = this.content.find("#" + n.datasource.id());
    t.find(".name").text($.t(n.name));
    this.setIcon(t, n);
    this.setVisible(t, n)
};
ObjectTreeDialog.List.prototype.findItem = function (n) {
    return this.content.find("#" + n.id())
};
ObjectTreeDialog.List.prototype.removeItem = function (n) {
    this.findItem(n).remove()
};
ObjectTreeDialog.List.prototype.setIcon = function (n, t) {
    var r = n.find(".name-column"), u, i;
    r.find(".instrument").remove();
    t.datasource.getType && (u = ObjectTreeDialog._getBackgroundByTile(t.datasource.getType()), u && (i = $('<span class="instrument linetool">').appendTo(r), i.css("background-position", ObjectTreeDialog._getBackgroundPosition(u))));
    t.datasource instanceof TradingView.LineToolIcon && (i = t.datasource.properties().icon.value(), i = String.fromCharCode(i), $('<span class="instrument lineicon">' + i + "<\/span>").appendTo(r));
    t.datasource === this.model.mainSeries() && (i = $('<span class="instrument series">').appendTo(r), r = this.model.mainSeries().properties().style.value(), u = D4.styleIconPosition(r), i.css("background-position", u))
};
ObjectTreeDialog.List.prototype.setVisible = function (n, t) {
    t.datasource.properties().visible.value() ? n.removeClass("hidden") : n.addClass("hidden")
};
ManageDrawingsTab.prototype.toolCompare = function (n, t) {
    var i = $(n).find(".name").text(), r = $(t).find(".name").text();
    return i.localeCompare(r)
};
ManageDrawingsTab.prototype.symbolCompare = function (n, t) {
    var i = $(n).find(".symbol").text(), r = $(t).find(".symbol").text();
    return i.localeCompare(r)
};
ManageDrawingsTab.prototype.activeListener = function (n) {
    this.selectedId = n.attr("id")
};
ManageDrawingsTab.prototype.addItemControls = function (n, t) {
    var i = this, r = t.find(".tree-icon-container");
    $('<span class="symbol">' + n.symbol + "<\/span>").appendTo(t);
    n.datasource.userEditEnabled() && (r = $('<a class="button delete" title="' + $.t("Delete") + '">').click(function (r) {
        r.stopPropagation();
        r = i.itemList.find(".tv-dialog-tree-item");
        var u = r.index(t), f = r.length;
        0 < f && (u !== f - 1 ? i.selectedId = $(r[u + 1]).attr("id") : 0 !== u && (i.selectedId = $(r[u - 1]).attr("id")));
        i.items.model.removeSource(n.datasource)
    }).appendTo(r), $('<span class="icon">').appendTo(r))
};
ManageDrawingsTab.prototype.setActiveHeader = function (n) {
    this.itemHeader.find(".item .label").removeClass("active");
    $.each(this.itemHeader.find(".item .label"), function () {
        $(this).data("sort") === n && $(this).addClass("active")
    })
};
ManageDrawingsTab.prototype.sortList = function () {
    var t = TVSettings.getValue("manageDrawingsDialog.sort.field") || "symbol", i = TVSettings.getBool("manageDrawingsDialog.sort.asc") || !1, n;
    n = "tool" === t ? this.toolSort : this.symbolSort;
    n.setIsAscending(i);
    this.itemList.find(".tv-dialog-tree-item").sort(n.getPredicate()).appendTo(this.itemList);
    this.setActiveHeader(t)
};
ManageDrawingsTab.prototype.sortClick = function (n) {
    n = $(n.target).data("sort");
    var t;
    t = "tool" === n ? this.toolSort : this.symbolSort;
    t.inverse();
    TVSettings.setValue("manageDrawingsDialog.sort.field", n);
    TVSettings.setValue("manageDrawingsDialog.sort.asc", t.isAscending);
    this.sortList()
};
ManageDrawingsTab.prototype.createView = function (n, t) {
    var i, u, r;
    this.items = this.dialog.getSourceProperties();
    this.maxHeight = t;
    i = $("<div>").appendTo(n);
    this.itemHeader = $('<div class="tv-dialog-tree-item-list-header">').appendTo(i);
    this.contentContainer = $('<div class="main-tree-container">').appendTo(i);
    this.noDrawings = $('<div class="no-drawings">' + $.t("No drawings yet") + "<\/div>").appendTo(i);
    this.contentWrap = $('<div class="main-tree-wrap"><\/div>').appendTo(this.contentContainer);
    this.content = $('<div class="main-tree"><\/div>').appendTo(this.contentWrap);
    i = $('<div class="item tool">').appendTo(this.itemHeader);
    u = $('<div class="item symbol">').appendTo(this.itemHeader);
    this.itemList = $('<div class="tv-dialog-tree-item-list">').appendTo(this.content);
    this.symbolSort = new LoadChartDialog.SortObject(this.symbolCompare);
    this.toolSort = new LoadChartDialog.SortObject(this.toolCompare);
    this.list = new ObjectTreeDialog.List(this.items.model, this.content, this.dialog, this.options);
    this.list.setActiveListener(this.activeListener.bind(this));
    this.items.model.selectedSource() && (this.selectedId = this.items.model.selectedSource().id());
    $('<span class="label">' + $.t("TOOL") + "<\/span>").data("sort", "tool").appendTo(i).click($.proxy(this, "sortClick"));
    $('<span class="label">' + $.t("SYMBOL") + "<\/span>").data("sort", "symbol").appendTo(u).click($.proxy(this, "sortClick"));
    this.fillList();
    i = this.dialog.calcHeight(this.list.contentHeights, this.maxHeight - this.itemHeader.height());
    this.contentContainer.height(i);
    this.noDrawings.height(i);
    this.addScroll();
    r = this;
    this.updateListListener = function () {
        r.updateList()
    };
    this.fillListListener = function () {
        r.fillList()
    };
    this.removeSourceListener = function (n) {
        r.list.removeItem(n);
        r.updateList()
    };
    this.model.on("setProperty", this.updateListListener);
    this.model.on("removeSource", this.removeSourceListener);
    this.model.on("cloneLineTool", this.fillListListener);
    return this.contentContainer
};
ManageDrawingsTab.prototype.unsubscribeListeners = function () {
    this.model.removeListener("setProperty", this.updateListListener);
    this.model.removeListener("removeSource", this.removeSourceListener);
    this.model.removeListener("cloneLineTool", this.fillListListener)
};
ManageDrawingsTab.prototype.updateList = function () {
    for (var t = this.dialog.getSourceProperties(), n = 0; n < t.drawings.length; n++)this.list.updateItem(t.drawings[n])
};
ManageDrawingsTab.prototype.updateList = function () {
    0 === this.itemList.children().length ? (this.noDrawings.show(), this.contentContainer.hide(), this.itemHeader.hide()) : (this.noDrawings.hide(), this.contentContainer.show(), this.itemHeader.show())
};
ManageDrawingsTab.prototype.fillList = function () {
    var r, t, i, n;
    for (this.itemList.empty(), r = this.dialog.getSourceProperties(), t = 0; t < r.drawings.length; t++)i = r.drawings[t], n = this.list.createItem(i, this.itemList), n.unbind("contextmenu"), n.unbind("dblclick"), i.datasource.id() === this.selectedId && this.list.setActive(n), this.addItemControls(i, n);
    this.sortList();
    this.updateList()
};
ManageDrawingsTab.prototype.addScroll = function () {
    this._scroll = new D59(this.contentContainer, this.contentWrap, {showBottomShadow: !1})
};
ManageDrawingsTab.prototype.tabChanged = function () {
};
ObjectsTreeTab.prototype.activeListener = function (n) {
    this.selectedId = n.attr("id")
};
ObjectsTreeTab.prototype.changeZOrder = function (n) {
    this.model.removeListener("changeZOrder", this.changeZorderListener);
    n();
    this.model.on("changeZOrder", this.changeZorderListener)
};
ObjectsTreeTab.prototype.addSortable = function (n) {
    var i = 0, t = this;
    n.sortable({scroll: !0, scrollSensitivity: 100, scrollSpeed: 100, axis: "y", helper: "clone", start: function (n, t) {
        i = t.item.index()
    }, stop: function (n, r) {
        var u = r.item.index(), f, e;
        0 != i - u && (f = t.list.datasources[r.item.attr("id")], e = 0 < i - u ? 1 : -1, t.changeZOrder(function () {
            t.items.model.beginUndoMacro("Change " + f.datasource.title() + " Z order");
            for (var n = 0; n < Math.abs(i - u); n++)t.items.model.changeZOrder(f.datasource, e);
            t.items.model.endUndoMacro()
        }));
        t.setFirstLastItems(r.item.parent())
    }})
};
ObjectsTreeTab.prototype.addItemControls = function (n, t, i, r) {
    var u = this;
    i = t.find(".tree-icon-container");
    r = $('<div class="button up" title="' + $.t("Move Up") + '">').click(function (i) {
        if (i.stopPropagation(), i.preventDefault(), i = t.prev(":visible"), i.length) {
            var r = t.prev(":hidden").length;
            t.insertBefore(i.last());
            u.changeZOrder(function () {
                for (var t = 0; t < 1 + r; t++)u.items.model.changeZOrder(n.datasource, 1)
            });
            u.setFirstLastItems(t.parent());
            u._scroll.scrollTo(t)
        }
    }).prependTo(i);
    $('<span class="icon">').appendTo(r);
    r = $('<a class="button down" title="' + $.t("Move Down") + '">').click(function (i) {
        if (i.stopPropagation(), i.preventDefault(), i = t.next(":visible"), i.length) {
            var r = t.next(":hidden").length;
            t.insertAfter(i.first());
            u.changeZOrder(function () {
                for (var t = 0; t < 1 + r; t++)u.items.model.changeZOrder(n.datasource, -1)
            });
            u.setFirstLastItems(t.parent());
            u._scroll.scrollTo(t)
        }
    }).prependTo(i);
    $('<span class="icon">').appendTo(r);
    n.datasource !== u.items.model.mainSeries() && n.datasource.isUserDeletable() ? (i = $('<a class="button delete" title="' + $.t("Delete") + '">').click(function (i) {
        i.stopPropagation();
        i = u.content.find(".tv-dialog-tree-item");
        var r = i.index(t), f = i.length;
        0 < f && (r !== f - 1 ? u.selectedId = $(i[r + 1]).attr("id") : 0 !== r && (u.selectedId = $(i[r - 1]).attr("id")));
        u.items.model.removeSource(n.datasource)
    }).appendTo(i), $('<span class="icon">').appendTo(i)) : $('<div class="button hidden">&nbsp;<\/div>').appendTo(i)
};
ObjectsTreeTab.prototype.createView = function (n, t, i) {
    this.items = this.dialog.getSourceProperties();
    this.maxHeight = i;
    this.contentContainer = $('<div class="main-tree-container">').appendTo(n);
    this.contentWrap = $('<div class="main-tree-wrap"><\/div>').appendTo(this.contentContainer);
    this.content = $('<div class="main-tree"><\/div>').appendTo(this.contentWrap);
    this.list = new ObjectTreeDialog.List(this.items.model, this.content, this.dialog, this.options);
    this.list.setDefaultItemClass("objects");
    this.list.setActiveListener(this.activeListener.bind(this));
    this.items.model.selectedSource() && (this.selectedId = this.items.model.selectedSource().id());
    this.updateListListener = this.updateList.bind(this);
    this.fillListListener = this.fillList.bind(this);
    this.changeZorderListener = function (n) {
        this.fillList();
        this._scroll.scrollTo(this.list.findItem(n))
    }.bind(this);
    this.model.on("setProperty", this.updateListListener);
    this.model.on("removeSource", this.fillListListener);
    this.model.on("cloneLineTool", this.fillListListener);
    this.model.on("setChartStyleProperty", this.updateListListener);
    this.model.on("changeZOrder", this.changeZorderListener);
    this.model.on("moveSource", this.fillListListener);
    return this.filter = new ObjectsTreeTabFilter(t), this.filter.onChange.subscribe(this, this.fillListListener), this.filter.setValue("all"), n = this.dialog.calcHeight(this.list.contentHeights, this.maxHeight), this.contentContainer.height(n), this.addScroll(), this.contentContainer
};
ObjectsTreeTab.prototype.unsubscribeListeners = function () {
    this.model.removeListener("setProperty", this.updateListListener);
    this.model.removeListener("removeSource", this.fillListListener);
    this.model.removeListener("cloneLineTool", this.fillListListener);
    this.model.removeListener("setChartStyleProperty", this.updateListListener);
    this.model.removeListener("changeZOrder", this.changeZorderListener);
    this.model.removeListener("moveSource", this.fillListListener)
};
ObjectsTreeTab.prototype.updateList = function () {
    var n, t, i;
    for (this.items = this.dialog.getSourceProperties(), n = 0; n < this.items.groups.length; n++)if (t = this.items.groups[n], t.children.length)for (i = t.children.length - 1; 0 <= i; i--)this.list.updateItem(t.children[i])
};
ObjectsTreeTab.prototype.setFirstLastItems = function (n) {
    n = n.find(".tv-dialog-tree-item:visible");
    n.length && (n.removeClass("first last"), n.first().addClass("first"), n.last().addClass("last"))
};
ObjectsTreeTab.prototype.fillList = function () {
    var s, n, t, i, f, e, r, u, o;
    for (this.content.empty(), this.items = this.dialog.getSourceProperties(), s = "studies" != this.filter.value() && this.items.drawings.length, n = 0; n < this.items.groups.length; n++)if (t = this.filter.applyToGroup(this.items.groups[n]), t.children.length) {
        for (i = $('<div class="tv-dialog-tree-group">').appendTo(this.content), 0 < n && i.append('<div class="tv-dialog-tree-head">'), f = $('<div class="tv-dialog-tree-item-list">').appendTo(i), Modernizr.touch || this.addSortable(f), e = !0, r = t.children.length - 1; 0 <= r; r--)u = t.children[r], o = this.list.createItem(u, f, s), e && !u.skipped && (e = !1), u.datasource.id() === this.selectedId && this.list.setActive(o), this.addItemControls(u, o, i, r, t);
        e && i.addClass("empty");
        this.setFirstLastItems(f)
    }
};
ObjectsTreeTab.prototype.addScroll = function () {
    this._scroll = new D59(this.contentContainer, this.contentWrap, {showBottomShadow: !1})
};
ObjectsTreeTab.prototype.tabChanged = function () {
};
ObjectsTreeTabFilter.prototype._getActions = function () {
    return[
        {name: "all", title: $.t("Show All")},
        {name: "drawings", title: $.t("Show Only Drawings")},
        {name: "studies", title: $.t("Show Only Studies")}
    ].map(function (n) {
        return n.name == this._value ? n.active = !0 : n.action = this.setValue.bind(this, n.name), n
    }.bind(this))
};
ObjectsTreeTabFilter.prototype.value = function () {
    return this._value
};
ObjectsTreeTabFilter.prototype.setValue = function (n) {
    n != this._value && (this._value = n, this.onChange.fire(n))
};
ObjectsTreeTabFilter.prototype.applyToGroup = function (n) {
    if ("all" == this._value)return n;
    for (var i = 0, t; i < n.children.length; i++)t = n.children[i], t.skipped = !isInherited(t.datasource.constructor, TradingView.Series) && !isInherited(t.datasource.constructor, "drawings" == this._value ? J47 : TradingView.Study);
    return n
};
D23 = function (n, t, i) {
    this.Q0 = t;
    this._paneWidget = n;
    this._chart = n._chart;
    this._mainDiv = i;
    this.jqTable = $(document.createElement("table"));
    this.jqTable.addClass("pane-legend");
    this._itemsBinding = new List;
    this.updateLayout()
};
D23.prototype.contextMenuEvent = function (n, t) {
    !this.Q0.chartModel().readOnly() && J77.enabled("legend_context_menu") && this._paneWidget.showContextMenuForSource(t.source, n)
};
D23.prototype.updateLayout = function () {
    var n, r, f;
    if (this._itemsBinding.clear(), this.jqTable.empty(), n = this._paneWidget.state(), n && this.Q0) {
        var u = new List, i = n.orderedSources().slice(), n = i.indexOf(this.Q0.mainSeries());
        for (-1 < n && (i.splice(n, 1), i.push(this.Q0.mainSeries())), n = i.length - 1; 0 <= n; n--)r = i[n], f = r.statusView(), f && u.append({view: f, source: r});
        for (n = 0; n < u.size(); ++n) {
            var f = u.item(n).view, r = u.item(n).source, i = $("<tr>"), t = $("<td>");
            i.appendTo(this.jqTable);
            t.addClass("pane-legend-line");
            r == this.Q0.mainSeries() ? t.addClass("main") : t.addClass("study");
            r.properties().visible.value() || t.addClass("disabled");
            t.appendTo(i);
            t.source = r;
            this._generateItemsForRow(t, f);
            TradingView.setMouseEventHandler(t, this, !0)
        }
        this.update()
    }
};
D23.prototype._updateFollowSymbol = function (n, t) {
    if (!this._chart.onWidget() && !J77.enabled("charting_library")) {
        var i = $(document.createElement("span")).data("alive", !0).appendTo(n);
        D16.makeButton(t.properties().symbol.value(), "iconed").done(function (n) {
            if (i.data("alive")) {
                n.removeAttr("title");
                var t = D68.ticker(n.data("symbol") || "");
                n.blueTooltip("<strong>Follow " + t + ".<\/strong> If you follow a symbol you will receive notifications when new ideas about that symbol are published.", "bottom");
                i.replaceWith(n)
            }
        })
    }
};
D23.prototype._generateItemsForRow = function (n, t) {
    var i = $("<span>"), h, u, f, s, c;
    i.addClass("pane-legend-line");
    J77.enabled("legend_context_menu") || i.addClass("no-context-menu");
    var r = n.source, l = this, e = r == this.Q0.mainSeries();
    if (e && i.addClass("main"), r.properties().visible.value() || i.addClass("disabled"), i.css({"font-weight": t.bold() ? "bold" : "normal", "font-size": t.size()}), i.click(function (t) {
        l.contextMenuEvent(t, n)
    }), i.appendTo(n), this._itemsBinding.append({value: t, cell: i, source: n.source}), !this._chart.readOnly() && r.userEditEnabled() && J77.enabled("edit_buttons_in_legend")) {
        i = $('<span class="pane-legend-icon-container">').appendTo(n);
        $('<a class="pane-legend-icon apply-common-tooltip icon-hide" title="' + $.t("Show/Hide") + '">').appendTo(i).on("click touchend", this._generateItemsForRow._onShowhideClick.bind(this, r));
        $('<a class="pane-legend-icon apply-common-tooltip format" title="' + $.t("Format") + '">').appendTo(i).on("click touchend", this._generateItemsForRow._onFormatClick.bind(this, r));
        if (r instanceof TradingView.Study && r.metaInfo().isTVScript && r.metaInfo().TVScriptSourceCode && !TradingView.isMobileView && (h = $('<a class="pane-legend-icon apply-common-tooltip source" title="Show Source Code">').appendTo(i).on("click touchend", this._generateItemsForRow._onViewSorceClick.bind(this, r)), window.scriptEditor && (u = window.scriptEditor.loadedScriptIdPart(), u && r.metaInfo().scriptIdPart === u && h.addClass("active"))), !e)$('<a class="pane-legend-icon apply-common-tooltip delete" title="' + $.t("Delete") + '">').appendTo(i).on("click touchend", this._generateItemsForRow._onDeleteClick.bind(this, r))
    } else $("<span>&nbsp;<\/span>").appendTo(n);
    if (i = r.dataWindowView(), i = r.dataWindowView(), this.isDataWindowValuesVisible(i)) {
        var h = [], u = [], o = $("<div>");
        for (o.addClass("pane-legend-item-value-container"), f = 0; f < i.items().size(); f++)i.items().item(f), s = e ? $("<span class='pane-legend-item-value-title pane-legend-line'>").appendTo(o) : null, c = $("<span class='pane-legend-item-value pane-legend-line'>").appendTo(o), e && c.addClass("main"), r.properties().visible.value() || (c.addClass("disabled"), s && s.addClass("disabled")), h.push(c), s && u.push(s);
        f = $("<span class='pane-legend-item-additional pane-legend-line'>").appendTo(o);
        o.appendTo(n);
        this._itemsBinding.append({value: i, cell: h, titleCells: u.length ? u : null, source: r, additional: f})
    }
    TradingView.Q18("alerts") && !this._chart.onWidget() && TradingView.alertsDispatcher && e && (r = $('<span class="pane-legend-icon-container">').appendTo(n), this.alertWidget && this.alertWidget.destroy(), this.alertWidget = new TradingView.AlertsLegendWidget(r, this.Q0), window._exposed_AlertsLegendWidget = this.alertWidget)
};
D23.prototype.isDataWindowValuesVisible = function (n) {
    return this._chart.onWidget() ? !!n && !this._chart.isSmall() : !!n
};
D23.prototype._generateItemsForRow._onShowhideClick = function (n) {
    this.Q0.setProperty(n.properties().visible, !n.properties().visible.value(), "Show/Hide " + n.title())
};
D23.prototype._generateItemsForRow._onFormatClick = function (n) {
    n.userEditEnabled() && new EditObjectDialog(n, this.Q0).show()
};
D23.prototype._generateItemsForRow._onDeleteClick = function (n) {
    n.isUserDeletable() && this.Q0.removeSource(n)
};
D23.prototype._generateItemsForRow._onViewSorceClick = function (n) {
    var t = n.metaInfo();
    n = {scriptSource: n.metaInfo().TVScriptSourceCode, scriptIdPart: t.scriptIdPart};
    window.scriptEditor && window.scriptEditor.show(n)
};
D23.prototype.setItemEnabled = function (n, t) {
    var i = !n.hasClass("disabled"), r = n.closest("td.pane-legend-line");
    t && !i ? (n.removeClass("disabled"), r.removeClass("disabled")) : !t && i && (n.addClass("disabled"), r.addClass("disabled"))
};
D23.prototype.updateTitle = function () {
    var r = this._chart.properties().scalesProperties.textColor.value(), i, n, t;
    for (this.jqTable.css("color", r), r = this._itemsBinding.size(); r--;)n = this._itemsBinding.item(r), t = n.source, isArray(n.cell) || (i = t.properties().visible.value(), this.setItemEnabled(n.cell, i), i = n.value.color(), t = t != this.Q0.mainSeries() && t === this.Q0.selectedSource() ? "bold" : "normal", n.cell.text(clean(n.value.text(), !0)).css({color: i, "border-color": i, "font-weight": t}))
};
D23.prototype.update = function () {
    this.updateTitle();
    for (var i, u, f, n, e, t, r, o = this._itemsBinding.size(); o--;)if (n = this._itemsBinding.item(o), i = n.cell, u = n.titleCells, f = n.source.properties().visible.value(), isArray(i)) {
        for (e = n.value.items(), t = 0; t < i.length; t++)r = e.item(t), this.setItemEnabled(i[t], f), i[t][0].textContent = r.text(), r.color() && i[t].css("color", r.color()), u && (this.setItemEnabled(u[t], f), u[t][0].textContent = r.title());
        n.additional && n.value.additional && n.additional.text(n.value.additional() || "")
    }
};
D23.prototype.dataSourceAtPoint = function () {
    return null
};
D23.prototype.renderTo = function (n, t, i) {
    var u, r;
    for (n.save(), n.fillStyle = this._chart.properties().scalesProperties.textColor.value(), n.textBaseline = "middle", u = 0, r = 0; r < this._itemsBinding.size(); ++r) {
        var f = this._itemsBinding.item(r), o = f.value, e = f.source == this.Q0.mainSeries(), s = e ? 12 : 8, e = e ? 25 : 17;
        isArray(f.cell) || (n.font = o.size() + " Verdana, Arial", n.fillText(o.text(), t, i + u + s), u += e)
    }
    n.restore()
};
D52 = function (n, t, i) {
    this.chart = n;
    this.paneA = n._paneWidgets[t];
    this.paneB = n._paneWidgets[i];
    this.jqRow = $(document.createElement("tr"));
    this.jqRow.height(D52.HEIGHT);
    this.jqCell = $(document.createElement("td"));
    this.jqCell.appendTo(this.jqRow);
    this.jqCell.addClass("pane-separator");
    this.jqCell.attr("colspan", "3");
    this.jqCell.css("background", this.chart.properties().scalesProperties.lineColor.value());
    this.jqCell.click(function () {
    });
    this.handle = $('<div class="handle">').appendTo(this.jqCell);
    $(this.handle).css("cursor", cursorCss("cursor_size_vertical", "16 15"));
    TradingView.setMouseEventHandler(this.handle, this)
};
D52.HEIGHT = 1;
D52.prototype.mouseDownEvent = function (n) {
    (0 === n.button || Modernizr.touch) && (this.startY = n.pageY, this.deltaY = 0, this.totalHeight = this.paneA.size.h + this.paneB.size.h, this.totalStretch = this.paneA.stretchFactor() + this.paneB.stretchFactor(), this.prevStretchA = this.paneA.stretchFactor(), this.minPaneHeight = 30, this.maxPaneHeight = this.totalHeight - this.minPaneHeight, this.pixelStretchFactor = this.totalStretch / this.totalHeight)
};
D52.prototype.pressedMouseMoveEvent = function (n) {
    if (0 === n.button || Modernizr.touch) {
        n.preventDefault();
        this.deltaY = n.pageY - this.startY;
        var t = this.paneA.size.h, i = MathEx.clamp(t + this.deltaY, this.minPaneHeight, this.maxPaneHeight) * this.pixelStretchFactor, r = this.totalStretch - i;
        this.paneA.setStretchFactor(i);
        this.paneB.setStretchFactor(r);
        this.chart._adjustSize();
        this.paneA.size.h !== t && (this.startY = n.pageY);
        this.chart.paint()
    }
};
D52.prototype.mouseUpEvent = function (n) {
    (0 === n.button || Modernizr.touch) && (this.chart.Q0.addPaneStretchFactorUndoCommand(this.paneA._state, this.paneB._state, this.prevStretchA, this.paneA.stretchFactor()), this.pixelStretchFactor = this.maxPaneHeight = this.minPaneHeight = this.totalStretch = this.totalHeight = this.deltaY = this.startY = 0)
};
D52.prototype.update = function () {
    this.jqCell.css("background", this.chart.properties().scalesProperties.lineColor.value())
};
D52.prototype.paint = function () {
};
D52.prototype.image = function () {
    var r = {}, n = D52.HEIGHT, u = this.paneA.lhsPriceAxisWidget.size.w, f = this.paneA.size.w, e = this.paneA.rhsPriceAxisWidget.size.w, t, i;
    return t = $('<canvas width="' + u + '" height="' + n + '">')[0], i = t.getContext("2d"), i.fillStyle = this.chart.properties().scalesProperties.lineColor.value(), i.fillRect(0, 0, u, n), r.leftAxis = {content: t.toDataURL(), contentWidth: u, contentHeight: n}, t = $('<canvas width="' + f + '" height="' + n + '">')[0], i = t.getContext("2d"), i.fillStyle = this.chart.properties().scalesProperties.lineColor.value(), i.fillRect(0, 0, f, n), r.content = t.toDataURL(), r.contentWidth = f, r.contentHeight = n, t = $('<canvas width="' + e + '" height="' + n + '">')[0], i = t.getContext("2d"), i.fillStyle = this.chart.properties().scalesProperties.lineColor.value(), i.fillRect(0, 0, e, n), r.rightAxis = {content: t.toDataURL(), contentWidth: e, contentHeight: n}, r
};
D51 = function (n, t, i) {
    this.Q0 = t;
    this._paneWidget = n;
    this._chart = n._chart;
    this._mainDiv = i;
    this.jqDiv = $('<div class="pane-controls">').appendTo(i);
    this.update()
};
D51.prototype.update = function () {
    var n = this, i = n.Q0, t = n._paneWidget.state(), i = i.panes().indexOf(t), r = !1;
    if (!t.containsMainSeries()) {
        for (var u = 0, t = t.Q19(), f = t.size(); f--;)if (t.item(f)instanceof TradingView.Study && (u++, 1 < u)) {
            r = !0;
            break
        }
        t = null
    }
    0 < i ? (this._$upButton || (this._$upButton = $(document.createElement("a")).addClass("pane-legend-icon up").attr("title", $.t("Move Up")).on("click", function () {
        n.Q0.rearrangePanes(n._chart, n.Q0.panes().indexOf(n._paneWidget.state()), "up")
    })), this._$upButton.appendTo(this.jqDiv)) : this._$upButton && this._$upButton.detach();
    i < this.Q0.panes().size() - 1 ? (this._$downButton || (this._$downButton = $(document.createElement("a")).addClass("pane-legend-icon down").attr("title", $.t("Move Down")).on("click", function () {
        n.Q0.rearrangePanes(n._chart, n.Q0.panes().indexOf(n._paneWidget.state()), "down")
    })), this._$downButton.appendTo(this.jqDiv)) : this._$downButton && this._$downButton.detach();
    r ? (this._$closeButton || (this._$closeButton = $(document.createElement("a")).addClass("pane-legend-icon delete").attr("title", $.t("Delete")).on("click", function () {
        n.Q0.removePane(n._chart, n.Q0.panes().indexOf(n._paneWidget.state()))
    })), this._$closeButton.appendTo(this.jqDiv)) : this._$closeButton && this._$closeButton.detach()
};
D54 = function (n, t, i) {
    this.pane = n;
    this._isLeft = D54.isLeft(t);
    this._disableContextMenu = !!i;
    this.jqCell = $(document.createElement("td"));
    this.jqCell.addClass("chart-markup-table");
    this.jqCell.addClass("price-axis");
    this.jqCell.width(25);
    this._dv = $("<div>");
    this._dv.css("width", "100%");
    this._dv.css("height", "100%");
    this._dv.css("position", "relative");
    this._dv.css("overflow", "hidden");
    this._dv.appendTo(this.jqCell);
    this.canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.canvas).css("position", "absolute");
    $(this.canvas).css("z-order", "2");
    $(this.canvas).css("left", 0);
    $(this.canvas).css("top", 0);
    this.ctx = this.canvas.getContext("2d");
    this.top_canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.top_canvas).css("position", "absolute");
    $(this.top_canvas).css("z-order", "1");
    $(this.top_canvas).css("left", 0);
    $(this.top_canvas).css("top", 0);
    this.top_ctx = this.top_canvas.getContext("2d");
    this._optimalWidth = 40;
    this.setFont(11, "Arial", "");
    this.restoreDefaultCursor();
    this.update();
    TradingView.setMouseEventHandler(this.jqCell, this, !0);
    this.dialog = this.pane.chart().dialog;
    this.contextMenu = null;
    this.actions = {};
    this._isVisible = !0
};
D54.prototype._BORDER_SIZE = 1;
D54.prototype._MAJOR_TICK_LENGTH = 4;
D54.prototype._MINOR_TICK_LENGTH = 2;
D54.LHS = 1;
D54.RHS = 2;
D54.isLeft = function (n) {
    return n === D54.LHS ? !0 : (n !== D54.RHS && TradingView.logDebug("PriceAxisWidget.isLeft: wrong side"), !1)
};
D54.prototype.backgroundColor = function () {
    return this.pane.chart().model().model().properties().paneProperties.background.value()
};
D54.prototype.lineColor = function () {
    return this.pane.chart().model().model().properties().scalesProperties.lineColor.value()
};
D54.prototype.textColor = function () {
    return this.pane.chart().model().model().properties().scalesProperties.textColor.value()
};
D54.prototype.mouseDownEvent = function (n) {
    if (!this.priceScale().isEmpty()) {
        var t = this.pane.chart().model(), i = this.pane.state();
        this._mousedown = !0;
        this.jqCell.css("cursor", cursorCss("cursor_size_vertical", "15 15"));
        t.startScalePrice(i, this.priceScale(), n.localY);
        TradingView.trackEvent("GUI", "Scaling price scale")
    }
};
D54.prototype.pressedMouseMoveEvent = function (n) {
    var t = this.pane.chart().model(), i = this.pane.state(), r = this.priceScale();
    t.scalePriceTo(i, r, n.localY)
};
D54.prototype.mouseDownOutsideEvent = function (n) {
    n = this.pane.chart().model();
    var t = this.pane.state(), i = this.priceScale();
    this._mousedown && (this._mousedown = !1, n.endScalePrice(t, i), this.restoreDefaultCursor())
};
D54.prototype.mouseUpEvent = function (n) {
    n = this.pane.chart().model();
    var t = this.pane.state(), i = this.priceScale();
    this._mousedown = !1;
    n.endScalePrice(t, i);
    this.restoreDefaultCursor()
};
D54.prototype._initActions = function (n) {
    if (this.pane.state()) {
        var t = this;
        this.actions.reset = new Action({text: $.t("Reset Scale")});
        this.actions.reset.callbacks().subscribe(this, D54.prototype.reset);
        n = function (n) {
            this._undoModel.setLockScaleProperty(this._property, n.checked, t.priceScale().mainSource(), this._undoText)
        };
        delete this.actions.setLockScale;
        this.priceScale().mainSource()instanceof TradingView.Series && (this.actions.setLockScale = new Action({text: $.t("Lock Scale"), checkable: !0, checked: this.priceScale().mainSource().properties().lockScale.value()}), this._lockScaleBinding = new Q14(this.actions.setLockScale, this.priceScale().mainSource().properties().lockScale, this.pane.chart().model(), "Undo LockScale", n), this._lockScaleBinding.setValue(this.priceScale().mainSource().properties().lockScale.value()));
        this.actions.setAutoScale = new Action({text: $.t("Auto Scale"), checkable: !0, checked: !0});
        this._autoScaleBinding = new Q14(this.actions.setAutoScale, this.priceScale().properties().autoScale, this.pane.chart().model(), "Undo AutoScale", function () {
            this._undoModel.setAutoScaleProperty(this._property, this.value(), t.priceScale(), this._undoText)
        });
        this._autoScaleBinding.setValue(this._autoScaleBinding.property().value());
        this.actions.setPercentage = new Action({text: $.t("Percentage", {context: "scale_menu"}), checkable: !0, checked: !1});
        this.actions.setPercentage.binding = new Q14(this.actions.setPercentage, this.priceScale().properties().percentage, this.pane.chart().model(), "Undo Percentage", function () {
            this._undoModel.setPercentProperty(this._property, this.value(), t.priceScale(), this._undoText)
        });
        this.actions.setLog = new Action({text: $.t("Log Scale", {context: "scale_menu"}), checkable: !0, checked: !1});
        this.actions.setLog.binding = new Q14(this.actions.setLog, this.priceScale().properties().log, this.pane.chart().model(), "Undo Log Scale");
        this.actions.showSymbolNames = new Action({text: $.t("Show Symbol Labels", {context: "scale_menu"}), checkable: !0, checked: !1});
        this.actions.showSymbolNames.binding = new Q14(this.actions.showSymbolNames, this.priceScale().properties().showSymbolLabels, this.pane.chart().model(), "Undo Show Symbol Labels");
        this.actions.alignLabels = new Action({text: $.t("Precise Labels", {context: "scale_menu"}), checkable: !0, checked: !1});
        this.actions.alignLabels.binding = new Q14(this.actions.alignLabels, this.priceScale().properties().alignLabels, this.pane.chart().model(), "Precise Labels");
        this._updateScalesActions()
    }
};
D54.prototype._updateScalesActions = function () {
    var n = this.priceScale(), t = n.mainSource()instanceof TradingView.Series, i = n.mainSource().properties();
    this.actions.setPercentage.setEnabled(!n.isLog() && !(t && i.lockScale.value()) && !(t && i.style.value() === TradingView.Series.STYLE_PNF));
    this.actions.setLog.setEnabled(!n.isPercent() && !(t && i.lockScale.value()) && !(t && i.style.value() === TradingView.Series.STYLE_PNF));
    this.actions.setAutoScale.setChecked(n.Q2.autoScale.value());
    this.actions.setAutoScale.setEnabled(!n.properties().autoScaleDisabled.value())
};
D54.prototype.mouseClickEvent = function () {
};
D54.prototype.mouseDoubleClickEvent = function () {
    this.reset();
    TradingView.trackEvent("GUI", "Double click price scale")
};
D54.prototype.contextMenuEvent = function (n) {
    !this._disableContextMenu && J77.enabled("scales_context_menu") && this._createContextMenu().show(n)
};
D54.prototype._createContextMenu = function () {
    this._initActions();
    var t = this.pane.chart().actions(), n = [this.actions.reset, new ActionSeparator, t.showLeftAxis, t.showRightAxis, new ActionSeparator, this.actions.setAutoScale, t.scaleSeriesOnly, new ActionSeparator, this.actions.setPercentage, this.actions.setLog, new ActionSeparator, this.actions.showSymbolNames];
    return J77.enabled("countdown") && n.push(t.showCountdown), n.push(this.actions.alignLabels), TradingView.onWidget() || (n.push(new ActionSeparator), n.push(t.scalesProperties)), this.actions.setLockScale && n.splice(6, 0, this.actions.setLockScale), ContextMenu.createMenu(n)
};
D54.prototype.backLabels = function (n) {
    var e = new List, f = this.priceScale().orderedSources().clone().toArray(), r = this.pane, t = r.chart().model(), r = r.state(), u = [], i = t.sourceBeingMoved() || t.lineBeingEdited() || t.lineBeingCreated();
    if (i && u.push(i), t.selectedSource() && u.push(t.selectedSource()), t.hoveredSource() && u.push(t.hoveredSource()), this.priceScale() === r.defaultPriceScale())for (i = this.pane.state().Q19(), t = 0; t < i.size(); t++)r.isOverlay(i.item(t)) && f.push(i.item(t));
    for (t = 0; t < f.length; ++t)i = f[t], (n || -1 === u.indexOf(i)) && (i = i.priceAxisViews(r, i.priceScale())) && e.appendAll(i);
    return e
};
D54.prototype.optimalWidth = function () {
    var r, n, t, i, f, u;
    if (!this.isVisible())return 0;
    if (r = 0, this.pane.state())for (n = this.ctx, t = this.priceScale().marks(), n.textBaseline = "middle", n.textAlign = this._isLeft ? "right" : "left", n.font = this.baseFont, $.each(t, function () {
        var t = Math.round(n.measureText(this.label).width + 10);
        t > r && (r = t)
    }), n.font = this.labelFont, t = this.backLabels(!0), i = 0; i < t.size(); i++)t.item(i).font && (f = n.font, n.font = t.item(i).font()), u = Math.round(n.measureText(t.item(i).text()).width + 10), u > r && (r = u), t.item(i).font && (n.font = f);
    return this._optimalWidth = this._BORDER_SIZE + this._MAJOR_TICK_LENGTH + r + -1
};
D54.prototype.resetOptimalWidth = function () {
    this._optimalWidth = 0
};
D54.prototype.setFont = function (n, t, i) {
    this.labelFont = this.baseFont = makeFont(n, t, i);
    this.fontSize = n
};
D54.prototype.setSize = function (n) {
    this.size && this.size.equals(n) || (this.size = n, TradingView.setCanvasSize(this.canvas, n), TradingView.setCanvasSize(this.top_canvas, n), this.ctx = this.canvas.getContext("2d"), this.top_ctx = this.top_canvas.getContext("2d"), this.jqCell.css({width: n.w, "min-width": n.w, height: n.h}))
};
D54.prototype.update = function () {
};
D54.prototype._hightlightBackground = function (n, t, i) {
    for (var r = t.item(0).price, u = t.item(0).price, f = 1; f < t.size(); f++)r = Math.min(r, t.item(f).price), u = Math.max(u, t.item(f).price);
    t = this.priceScale();
    t.isPercent() && i && (i = i.firstValue(), r = t.priceRange().convertToPercent(r, i), u = t.priceRange().convertToPercent(u, i));
    r = this.priceScale().priceToCoordinate(r);
    u = this.priceScale().priceToCoordinate(u);
    clearRect(n, 1, r, this.size.w - 1, u - r, "rgba(109, 158, 235, 0.3)")
};
D54.prototype.drawBackground = function (n) {
    var t, i, r;
    if (clearRect(n, 0, 0, this.size.w, this.size.h, this.backgroundColor()), t = this.pane.chart().model(), i = t.model().selectedSource(), i && i.priceScale() == this.priceScale() && i instanceof J47) {
        if (r = i.points(), 0 == r.size())return;
        this._hightlightBackground(n, r, i.ownerSource())
    }
    t = t.model().crossHairSource();
    t.startMeasurePoint() && this._hightlightBackground(n, t.measurePoints(), this.pane.state().mainDataSource())
};
D54.prototype.drawBorder = function (n) {
    var r, t, i;
    n.save();
    n.fillStyle = this.lineColor();
    r = this.size.h;
    this._isLeft ? (n.translate(-.5, -.5), t = this.size.w - this._BORDER_SIZE - 1, i = this.size.w - 1) : (n.translate(.5, -.5), t = 0, i = t + this._BORDER_SIZE);
    n.fillRect(t, 0, i - t, r);
    n.restore()
};
D54.prototype.drawTickMarks = function (n) {
    var i, r, t, u;
    if (n.save(), n.strokeStyle = this.lineColor(), i = this.priceScale().marks(), n.textBaseline = "middle", n.textAlign = this._isLeft ? "right" : "left", n.fillStyle = this.textColor(), n.font = this.baseFont, r = this.size.w - 1, n.translate(-.5, -.5), t = i.length, this._isLeft) {
        for (u = r - this._BORDER_SIZE, n.fillStyle = this.lineColor(); t--;)r = i[t].major ? this._MAJOR_TICK_LENGTH : this._MINOR_TICK_LENGTH, n.fillRect(u - r, i[t].coord, r, 1);
        for (n.fillStyle = this.textColor(), t = i.length; t--;)n.fillText(i[t].label, u - this._MAJOR_TICK_LENGTH, i[t].coord)
    } else {
        for (u = this._BORDER_SIZE + 1, n.fillStyle = this.lineColor(); t--;)r = i[t].major ? this._MAJOR_TICK_LENGTH : this._MINOR_TICK_LENGTH, n.fillRect(u, i[t].coord, r + 1, 1);
        for (n.fillStyle = this.textColor(), t = i.length; t--;)n.fillText(i[t].label, u + this._MAJOR_TICK_LENGTH + 1, i[t].coord)
    }
    n.restore()
};
D54.prototype._alignLabels = function () {
    var o = this.size.h / 2, u = new List, r = this.priceScale().orderedSources().clone().toArray(), n = this.pane, i, t, f, e;
    if (n.chart().model(), i = n.state(), this.priceScale() === i.defaultPriceScale())for (t = this.pane.state().Q19(), n = 0; n < t.size(); n++)i.isOverlay(t.item(n)) && r.push(t.item(n));
    for (f = this.priceScale().mainSource(), n = 0; n < r.length; ++n)e = r[n], (t = e.priceAxisViews(i, e.priceScale())) && (u.appendAll(t), f == e && 0 < t.size() && (o = t.item(0)._floatCoordinate));
    if (t = u.toArray(), r = t.filter(function (n) {
        return n._floatCoordinate <= o
    }), u = t.filter(function (n) {
        return n._floatCoordinate > o
    }), r.sort(function (n, t) {
        return(t._floatCoordinate || t.coordinate()) - (n._floatCoordinate || n.coordinate())
    }), r.length && u.length && u.push(r[0]), u.sort(function (n, t) {
        return(n._floatCoordinate || n.coordinate()) - (t._floatCoordinate || t.coordinate())
    }), t.forEach(function (n) {
        n._fixedCoordinate = n.coordinate()
    }), n = this.priceScale().properties(), n.alignLabels && n.alignLabels.value()) {
        for (n = 1; n < r.length; n++)t = r[n], i = r[n - 1], f = i.renderer().height(!1), t.coordinate() > i._fixedCoordinate - f && (i = i._fixedCoordinate - f, t._fixedCoordinate = i);
        for (n = 1; n < u.length; n++)t = u[n], i = u[n - 1], f = i.renderer().height(!0), t.coordinate() < i._fixedCoordinate + f && (i = i._fixedCoordinate + f, t._fixedCoordinate = i)
    }
};
D54.prototype.drawBackLabels = function (n) {
    var r, t, i, u;
    for (n.save(), n.font = this.labelFont, r = this.backLabels(), t = 0; t < r.size(); t++)i = r.item(t), u = i.renderer(), i._fixedCoordinate && (u._data.coordinate = i._fixedCoordinate), u.draw(n, this._isLeft, this.size.w, this.size.h);
    n.restore()
};
D54.prototype.drawCrossHairLabel = function (n) {
    var t = this.pane.chart().model().model(), i = [], u = t.sourceBeingMoved() || t.lineBeingEdited() || t.lineBeingCreated(), f, r;
    u && i.push({source: u, scale: u.priceScale()});
    t.selectedSource() && i.push({source: t.selectedSource(), scale: t.selectedSource().priceScale()});
    t.hoveredSource() && i.push({source: t.hoveredSource(), scale: t.hoveredSource().priceScale()});
    f = this.pane.state();
    i = i.reduce(function (n, t) {
        var i = t.source.priceAxisViews(f, t.scale);
        return i ? n.concat(i.toArray()) : n
    }, []);
    (t = t.crossHairSource().priceAxisViews(f, this.priceScale())) && (i = i.concat(t.toArray()));
    r = this;
    i.filter(function (n) {
        return null != n
    }).forEach(function (t) {
        n.save();
        n.font = r.labelFont;
        var i = t.renderer();
        t._fixedCoordinate && (i._data.coordinate = t._fixedCoordinate);
        i.draw(n, r._isLeft, r.size.w, r.size.h);
        n.restore()
    })
};
D54.prototype.priceScale = function () {
    var t = this.pane.state(), n = [], n = this._isLeft ? [t.leftPriceScale(), t.rightPriceScale()] : [t.rightPriceScale(), t.leftPriceScale()];
    return null === n[0].mainSource() ? null === n[1].mainSource() ? n[0] : n[1] : n[0]
};
D54.prototype.isVisible = function () {
    return this._isVisible
};
D54.prototype.setVisible = function (n) {
    (this._visible = n) ? this.jqCell.show() : this.jqCell.hide();
    this._isVisible = !!n
};
D54.prototype.setAutoScale = function (n) {
    var t = this.pane.state, i = this.priceScale();
    this.pane.chart().model().setPriceAutoScale(t, i, n)
};
D54.prototype.reset = function () {
    var n = this.pane.state(), t = this.priceScale();
    this.pane.chart().model().resetPriceScale(n, t)
};
D54.prototype.paint = function (n) {
    this._isVisible && n && (this._alignLabels(), n === D22.UPDATE_CURSOR_ONLY ? (this.top_ctx.clearRect(0, 0, this.size.w, this.size.h), this.drawCrossHairLabel(this.top_ctx)) : (this.drawBackground(this.ctx), this.drawBorder(this.ctx), this.pane.state() && (this.drawTickMarks(this.ctx), this.drawBackLabels(this.ctx), this.top_ctx.clearRect(0, 0, this.size.w, this.size.h), this.drawCrossHairLabel(this.top_ctx))))
};
D54.prototype.restoreDefaultCursor = function () {
    this.jqCell.css("cursor", "default")
};
D54.prototype.image = function () {
    var n = {};
    return n.content = this.canvas.toDataURL(), n.contentWidth = this.size.w, n.contentHeight = this.size.h, n
};
D73 = function (n, t) {
    this.chart = n;
    this.contextMenu = null;
    this._disableContextMenu = !!t;
    this.jqRow = $(document.createElement("tr"));
    this.jqLhsTimeAxisStub = $(document.createElement("td"));
    this.jqLhsTimeAxisStub.addClass("chart-markup-table");
    this.jqLhsTimeAxisStub.appendTo(this.jqRow);
    this.jqLhsStub = $("<div>");
    this.jqLhsStub.css("width", "100%");
    this.jqLhsStub.css("height", "100%");
    this.jqLhsStub.css("position", "relative");
    this.jqLhsStub.css("overflow", "hidden");
    this.jqLhsStub.appendTo(this.jqLhsTimeAxisStub);
    this.lhsCanvas = TradingView.addCanvasTo(this.jqLhsStub, new D61(16, 16));
    $(this.lhsCanvas).css("position", "absolute");
    $(this.lhsCanvas).css("z-order", "2");
    $(this.lhsCanvas).css("left", 0);
    $(this.lhsCanvas).css("top", 0);
    this.lhsCtx = this.lhsCanvas.getContext("2d");
    this.jqCell = $(document.createElement("td"));
    this.jqCell.appendTo(this.jqRow);
    this.jqCell.addClass("chart-markup-table");
    this.jqCell.addClass("time-axis");
    this.jqCell.height(25);
    this._dv = $("<div>");
    this._dv.css("width", "100%");
    this._dv.css("height", "100%");
    this._dv.css("position", "relative");
    this._dv.css("overflow", "hidden");
    this._dv.appendTo(this.jqCell);
    this.canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.canvas).css("position", "absolute");
    $(this.canvas).css("z-order", "2");
    $(this.canvas).css("left", 0);
    $(this.canvas).css("top", 0);
    this.ctx = this.canvas.getContext("2d");
    this.top_canvas = TradingView.addCanvasTo(this._dv, new D61(16, 16));
    $(this.top_canvas).css("position", "absolute");
    $(this.top_canvas).css("z-order", "1");
    $(this.top_canvas).css("left", 0);
    $(this.top_canvas).css("top", 0);
    this.top_ctx = this.top_canvas.getContext("2d");
    this.jqRhsTimeAxisStub = $(document.createElement("td"));
    this.jqRhsTimeAxisStub.addClass("chart-markup-table");
    this.jqRhsTimeAxisStub.appendTo(this.jqRow);
    this.jqRhsStub = $("<div>");
    this.jqRhsStub.css("width", "100%");
    this.jqRhsStub.css("height", "100%");
    this.jqRhsStub.css("position", "relative");
    this.jqRhsStub.css("overflow", "hidden");
    this.jqRhsStub.appendTo(this.jqRhsTimeAxisStub);
    this.rhsCanvas = TradingView.addCanvasTo(this.jqRhsStub, new D61(16, 16));
    $(this.rhsCanvas).css("position", "absolute");
    $(this.rhsCanvas).css("z-order", "2");
    $(this.rhsCanvas).css("left", 0);
    $(this.rhsCanvas).css("top", 0);
    this.rhsCtx = this.rhsCanvas.getContext("2d");
    this.setFont(11, "Tahoma, Arial", "");
    this.restoreDefaultCursor();
    this.update();
    this._minVisibleSpan = MINUTE_SPAN;
    TradingView.setMouseEventHandler(this.jqCell, this, !0);
    this.updatePriceScalesVisibility()
};
D73.prototype.BORDER_SIZE = 1;
D73.prototype.MAJOR_TICK_LENGTH = 4;
D73.prototype.MINOR_TICK_LENGTH = 2;
D73.prototype.backgroundColor = function () {
    var n = this.chart.model();
    return n ? n.model().properties().paneProperties.background.value() : "#ffffff"
};
D73.prototype.lineColor = function () {
    var n = this.chart.model();
    return n ? n.model().properties().scalesProperties.lineColor.value() : "#ffffff"
};
D73.prototype.textColor = function () {
    var n = this.chart.model();
    return n ? n.model().properties().scalesProperties.textColor.value() : "#ffffff"
};
D73.prototype.updatePriceScalesVisibility = function () {
    this.chart.properties().scalesProperties.showLeftScale.value() ? this.jqLhsTimeAxisStub.show() : this.jqLhsTimeAxisStub.hide();
    this.chart.properties().scalesProperties.showRightScale.value() ? this.jqRhsTimeAxisStub.show() : this.jqRhsTimeAxisStub.hide()
};
D73.prototype.mouseDownEvent = function (n) {
    if (this._mousedown)return!0;
    this._mousedown = !0;
    var t = this.chart.model();
    t.timeScale().isEmpty() || ($(this.jqCell).css("cursor", cursorCss("cursor_size_horizontal", "15 15")), t.startScaleTime(n.localX))
};
D73.prototype.mouseDownOutsideEvent = function (n) {
    n = this.chart.model();
    !n.timeScale().isEmpty() && this._mousedown && (this._mousedown = !1, n.endScaleTime(), this.restoreDefaultCursor())
};
D73.prototype.pressedMouseMoveEvent = function (n) {
    var r = this.chart.model(), t, i;
    r.timeScale().isEmpty() || (t = !1, i = (new Date).valueOf(), this._lastScrollScaleTime && 100 > i - this._lastScrollScaleTime && (t = !0), t || (TradingView.trackEvent("GUI", "Scaling time scale"), r.scaleTimeTo(n.localX), this._lastScrollScaleTime = i))
};
D73.prototype.mouseUpEvent = function (n) {
    this._mousedown = !1;
    n = this.chart.model();
    n.timeScale().isEmpty() || (n.endScaleTime(), this.restoreDefaultCursor())
};
D73.prototype.contextMenuEvent = function (n) {
    !this._disableContextMenu && J77.enabled("scales_context_menu") && this._createContextMenu().show(n)
};
D73.prototype._createContextMenu = function () {
    var n = this.chart, t;
    return n.model().mainSeries().createSessStudy(), n.updateActions(), n = n.actions(), t = J77.enabled("charting_library") ? [n.timeScaleReset, new ActionSeparator, n.extendedHours] : [n.timeScaleReset, new ActionSeparator, n.sessionBreaks, n.extendedHours], t = J77.enabled("charting_library") ? [n.timeScaleReset, new ActionSeparator, n.applyTimeZone, n.extendedHours] : [n.timeScaleReset, new ActionSeparator, n.applyTimeZone, n.sessionBreaks, n.extendedHours], t.push(new ActionSeparator, n.tmzProperties), ContextMenu.createMenu(t)
};
D73.prototype.mouseClickEvent = function () {
};
D73.prototype.mouseDoubleClickEvent = function () {
    TradingView.trackEvent("GUI", "Double click time scale");
    this.chart.model().resetTimeScale()
};
D73.prototype.optimalHeight = function () {
    return this.BORDER_SIZE + this.MAJOR_TICK_LENGTH + this.maxFontSize + 6
};
D73.prototype.setFont = function (n, t, i) {
    this.baseFont = makeFont(n, t, i);
    this.baseBoldFont = makeFont(n, t, i + " bold ");
    this.labelFont = this.baseFont;
    this.maxFontSize = n
};
D73.prototype.setSize = function (n, t, i) {
    this.size && this.size.equals(n) || (this.lhsStubSize = t, TradingView.setCanvasSize(this.lhsCanvas, t), this.lhsCtx = this.lhsCanvas.getContext("2d"), this.jqLhsTimeAxisStub.width(t.w), this.jqLhsTimeAxisStub.height(t.h), this.rhsStubSize = i, TradingView.setCanvasSize(this.rhsCanvas, i), this.rhsCtx = this.rhsCanvas.getContext("2d"), this.jqRhsTimeAxisStub.width(i.w), this.jqRhsTimeAxisStub.height(i.h), this.size = n, TradingView.setCanvasSize(this.canvas, n), TradingView.setCanvasSize(this.top_canvas, n), this.ctx = this.canvas.getContext("2d"), this.jqCell.width(n.w), this.jqCell.height(n.h))
};
D73.prototype._spanIndex = function (n) {
    for (var i = [MINUTE_SPAN, HOUR_SPAN, DAY_SPAN, MONTH_SPAN, YEAR_SPAN], t = i.length - 1; 0 < t && !(i[t] <= n);)t--;
    return t
};
D73.prototype._spanOffset = function (n, t) {
    if (t < n)throw new Exception("actual span cuold not be less then base");
    return this._spanIndex(t) - this._spanIndex(n)
};
D73.prototype.update = function () {
    var n, t;
    this.chart.model() && (n = this.chart.model().timeScale().marks(), n && (t = this, this._minVisibleSpan = YEAR_SPAN, $.each(n, function () {
        t._minVisibleSpan = Math.min(this.span, t._minVisibleSpan)
    })))
};
D73.prototype._hightlightBackground = function (n, t) {
    for (var r = this.chart.model().timeScale(), i = t.item(0).index, f = t.item(0).index, u = 1; u < t.size(); u++)i = Math.min(i, t.item(u).index), f = Math.max(f, t.item(u).index);
    i = r.indexToCoordinate(i);
    r = r.indexToCoordinate(f);
    clearRect(n, i, 1, r - i, this.size.h - 1, "rgba(109, 158, 235, 0.3)")
};
D73.prototype.drawBackground = function (n) {
    var t, i, r;
    if (clearRect(n, 0, 0, this.size.w, this.size.h, this.backgroundColor()), t = this.chart.model(), t) {
        if (i = t.timeScale(), r = t.model().selectedSource(), r && r instanceof J47 && !i.isEmpty()) {
            if (i = r.points(), 0 == i.size())return;
            this._hightlightBackground(n, i)
        }
        t = t.model().crossHairSource();
        t.startMeasurePoint() && this._hightlightBackground(n, t.measurePoints())
    }
};
D73.prototype.drawBorder = function (n) {
    n.save();
    n.fillStyle = this.lineColor();
    n.fillRect(-.5, .5, this.size.w + .5, this.BORDER_SIZE);
    n.restore()
};
D73.prototype.drawStubs = function () {
    var t = this.BORDER_SIZE, i = 2 * this.BORDER_SIZE, n = this.lhsCtx;
    clearRect(n, 0, 0, this.lhsStubSize.w, this.lhsStubSize.h, this.backgroundColor());
    n.fillStyle = this.lineColor();
    n.fillRect(this.lhsStubSize.w - i - .5, .5, i, t);
    n.fillRect(this.lhsStubSize.w - i - .5, -.5, t, t);
    n = this.rhsCtx;
    clearRect(n, 0, 0, this.rhsStubSize.w, this.rhsStubSize.h, this.backgroundColor());
    n.fillStyle = this.lineColor();
    n.fillRect(-.5, .5, i, t);
    n.fillRect(.5, -.5, t, t)
};
D73.prototype.drawTickMarks = function (n) {
    var t = this.chart.model().timeScale().marks(), r, i;
    if (t && 0 != t.length) {
        for (r = t.reduce(function (n, t) {
            return n.span > t.span ? n : t
        }).span, 30 < r && 40 > r && (r = 30), n.save(), n.strokeStyle = this.lineColor(), n.textBaseline = "top", n.textAlign = "center", n.translate(.5, .5), n.fillStyle = this.lineColor(), i = t.length; i--;)n.fillRect(t[i].coord, this.BORDER_SIZE, 1, t[i].major ? this.MAJOR_TICK_LENGTH : this.MINOR_TICK_LENGTH);
        for (n.fillStyle = this.textColor(), i = t.length; i--;)n.font = t[i].span >= r ? this.baseBoldFont : this.baseFont, n.fillText(t[i].label, t[i].coord, this.BORDER_SIZE + this.MAJOR_TICK_LENGTH - 1);
        n.restore()
    }
};
D73.prototype.drawBackLabels = function (n) {
    var t, r;
    n.save();
    n.font = this.labelFont;
    for (var f = this.chart.model().Q19(), i = this.chart.model(), i = i.sourceBeingMoved() || i.lineBeingEdited() || i.lineBeingCreated(), u = 0; u < f.size(); u++)if (t = f.item(u), t !== this.chart.model().crossHairSource() && t !== i && t.timeAxisViews && (t = t.timeAxisViews()))for (r = 0; r < t.size(); r++)t.item(r).renderer().draw(n, this.size.w, this.size.h);
    n.restore()
};
D73.prototype.drawCrossHairLabel = function (n) {
    var t = this.chart.model(), i;
    if (t = t.sourceBeingMoved() || t.lineBeingEdited() || t.lineBeingCreated()) {
        if (n.save(), t.timeAxisViews && (t = t.timeAxisViews()))for (i = 0; i < t.size(); i++)t.item(i).renderer().draw(n, this.size.w, this.size.h)
    } else if (n.save(), n.font = this.labelFont, t = this.chart.model().crossHairSource().timeAxisView())for (i = 0; i < t.size(); i++)t.item(i).renderer().draw(n, this.size.w, this.size.h);
    n.restore()
};
D73.prototype.paint = function (n) {
    this.top_ctx.font = this.labelFont;
    0 !== n && (n === D22.UPDATE_CURSOR_ONLY ? (this.top_ctx.clearRect(-.5, -.5, this.size.w, this.size.h), this.drawCrossHairLabel(this.top_ctx)) : (n = this.ctx, this.drawBackground(n), this.drawBorder(n), this.drawStubs(), this.chart.model() && (this.drawTickMarks(n), this.drawBackLabels(n), this.drawCrossHairLabel(this.top_ctx))))
};
D73.prototype.setStubVisible = function (n, t) {
    var i = D54.isLeft(n) ? this.jqLhsTimeAxisStub : this.jqRhsTimeAxisStub;
    t ? i.show() : i.hide()
};
D73.prototype.restoreDefaultCursor = function () {
    this.jqCell.css("cursor", "default")
};
D73.prototype.image = function () {
    var n = {};
    return n.content = this.canvas.toDataURL(), n.contentWidth = this.size.w, n.contentHeight = this.size.h, n.lhsStub = {}, n.lhsStub.content = this.lhsCanvas.toDataURL(), n.lhsStub.contentWidth = this.lhsStubSize.w, n.lhsStub.contentHeight = this.lhsStubSize.h, n.rhsStub = {}, n.rhsStub.content = this.rhsCanvas.toDataURL(), n.rhsStub.contentWidth = this.rhsStubSize.w, n.rhsStub.contentHeight = this.rhsStubSize.h, n
};
inherit(_41, Q7);
_41.prototype._addSessionEditor = function (n, t, i, r) {
    if ("session" !== i.type)TradingView.logError("Session editor adding FAILED: wrong input type."); else {
        i = function (n, t) {
            var r = $("<td/>"), i;
            r.appendTo(n);
            r.css("padding-left", "0px");
            r.css("padding-right", "0px");
            i = $("<input>");
            i.attr("type", "text");
            i.addClass("ticker");
            i.css("width", "40px");
            i.attr("id", t);
            i.appendTo(r)
        };
        var u = function (n, t, i) {
            var r = $("<td/>");
            r.css("padding-left", i);
            r.css("padding-right", i);
            r.appendTo(n);
            n = $("<div/>");
            n.appendTo(r);
            n.append(t);
            n.css("font-size", "150%")
        }, f = $("<table/>");
        f.appendTo(n);
        n = $("<tr/>");
        n.appendTo(f);
        editorIds = ["start_hours", "start_minutes", "end_hours", "end_minutes"];
        i.call(this, n, editorIds[0]);
        u.call(this, n, ":", 0);
        i.call(this, n, editorIds[1]);
        u.call(this, n, "-", 4);
        i.call(this, n, editorIds[2]);
        u.call(this, n, ":", 0);
        i.call(this, n, editorIds[3]);
        this.bindControl(new Q8(n, editorIds, t, !1, this.model(), r))
    }
};
_41.prototype.prepareLayoutImpl = function (n, t) {
    for (var i, f, u, h, s = 0; s < n.inputs.length; s++)if (i = n.inputs[s], f = i.id, "first_visible_bar_time" != f && "last_visible_bar_time" != f && "time" != i.type && !i.isHidden && (!this._showOnlyConfirmInputs || i.confirm)) {
        var e = i.name || f.toLowerCase().replace(/\b\w/g, function (n) {
            return n.toUpperCase()
        }), o = "Change " + e, r = $("<tr/>");
        if (r.appendTo(t), u = $("<td/>"), u.appendTo(r), u.addClass($.t("propertypage-name-label", {context: "css_class"})), u.text($.t(e, {context: "input"})), e = $("<td/>"), e.appendTo(r), r = null, "resolution" === i.type)r = $('<select><option value="1">1<\/option><option value="3">3<\/option><option value="5">5<\/option><option value="15">15<\/option><option value="30">30<\/option><option value="45">45<\/option><option value="60">1h<\/option><option value="120">2h<\/option><option value="180">3h<\/option><option value="D">1d<\/option><option value="W">1w<\/option><\/select>'); else if ("symbol" === i.type)r = $('<input class="symbol-edit single">'), D69.bindToInput(r); else if ("session" === i.type)this._addSessionEditor(e, this._property.inputs[f], i, o); else if (i.options)for (r = $("<select/>"), u = 0; u < i.options.length; u++)h = i.options[u], $("<option value='" + h + "'>" + h + "<\/option>").appendTo(r); else r = $("<input/>"), "bool" === i.type ? r.attr("type", "checkbox") : r.attr("type", "text");
        r && (r.appendTo(e), r.is(":checkbox") || r.css("width", "100px"));
        i.options ? this.bindControl(new Q11(r, this._property.inputs[f], null, !0, this.model(), o)) : "bar_time" === i.type ? (this.bindControl(new Q9(r, this._property.inputs[f], !0, this.model(), o, this.model().mainSeries(), 10)), r.addClass("ticker")) : "integer" === i.type ? (u = [ToIntTransformer(i.defval)], (0 === i.min || i.min) && u.push(GreateTransformer(i.min)), (0 === i.max || i.max) && u.push(LessTransformer(i.max)), this.bindControl(new SimpleStringBinder(r, this._property.inputs[f], u, !1, this.model(), o)), r.addClass("ticker")) : "float" === i.type ? (u = [ToFloatTransformer(i.defval)], (0 === i.min || i.min) && u.push(GreateTransformer(i.min)), (0 === i.max || i.max) && u.push(LessTransformer(i.max)), this.bindControl(new SimpleStringBinder(r, this._property.inputs[f], u, !1, this.model(), o)), r.addClass("ticker")) : "text" === i.type ? this.bindControl(new SimpleStringBinder(r, this._property.inputs[f], null, !1, this.model(), o)) : "bool" === i.type ? this.bindControl(new Q12(r, this._property.inputs[f], !0, this.model(), o)) : "resolution" === i.type ? this.bindControl(new Q11(r, this._property.inputs[f], UppercaseTransformer, !0, this.model(), "Change Interval")) : "symbol" === i.type && this.bindControl(new Q10(r, this._property.inputs[f], !0, this.model(), "Change Symbol"))
    }
    this._property.offset && (e = this._property.offset.title ? this._property.offset.title.value() : "Offset", r = this.addOffsetEditorRow(t, e), u = [ToIntTransformer(this._property.offset.val)], u.push(GreateTransformer(this._property.offset.min)), u.push(LessTransformer(this._property.offset.max)), this.bindControl(new SimpleStringBinder(r, this._property.offset.val, u, !1, this.model(), "Undo " + e)));
    this._property.offsets && $.each(n.plots, function (n, i) {
        var r;
        if (this._property.offsets[i.id] && (r = this._property.offsets[i.id], void 0 == r.isHidden || !r.isHidden.value())) {
            var f = r.title.value(), e = this.addOffsetEditorRow(t, f), u = [ToIntTransformer(r.val)];
            u.push(GreateTransformer(r.min));
            u.push(LessTransformer(r.max));
            this.bindControl(new SimpleStringBinder(e, r.val, u, !1, this.model(), "Undo " + f))
        }
    }.bind(this))
};
_41.prototype.prepareLayout = function () {
    this._table = $("<table/>");
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var n = this.Q1.metaInfo();
    this.prepareLayoutImpl(n, this._table);
    this.loadData()
};
_41.prototype.widget = function () {
    return this._table
};
inherit(_47, Q7);
_47.prototype.prepareLayout = function () {
    var n, t, f, u, r, e, h, o, c, s, i, l;
    for (this._table = $("<table/>"), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), i = 0; i < this.Q1.metaInfo().plots.length; ++i)this.Q1.isSelfColorerPlot(i) || this.Q1.isDataOffsetPlot(i) || (n = this.Q1.metaInfo().plots[i], this.Q1.isLinePlot(i) || this.Q1.isBarColorerPlot(i) || this.Q1.isBgColorerPlot(i) ? this._prepareLayoutForPlot(i, n) : this.Q1.isPlotArrowsPlot(i) ? this._prepareLayoutForArrowsPlot(i, n) : this.Q1.isPlotCharsPlot(i) ? this._prepareLayoutForCharsPlot(i, n) : this.Q1.isPlotShapesPlot(i) ? this._prepareLayoutForShapesPlot(i, n) : console.error("Unknown plot type: " + n.type));
    if ((i = this.Q1.properties().transparency) && (t = $('<tr class="line"/>'), t.appendTo(this._table), $("<td/>").appendTo(t), n = $("<td/>"), n.appendTo(t), n.addClass("propertypage-name-label"), n.html($.t("Transparency")), n = $("<td/>"), n.attr("colspan", "3"), n.appendTo(t), t = TradingView.createTransparencyEditor().width(270), t.appendTo(n), this.bindControl(new SliderBinder(t, i, !0, this.model(), "Change Study Transparency"))), f = this.Q1.properties().bands, f && 0 < f.childCount())for (i = 0; i < f.childCount(); i++)n = f[i], t = $('<tr class="line"/>'), t.appendTo(this._table), r = $("<td/>"), r.appendTo(t), u = $("<input type='checkbox' class='visibility-switch'/>"), u.appendTo(r), r = n.name.value(), this.createLabeledCell(r, u).appendTo(t).addClass($.t("propertypage-name-label", {context: "css_class"})), r = $("<td/>"), r.appendTo(t), r.addClass("colorpicker-cell"), r = TradingView.addColorPicker(r), e = $("<td/>"), e.appendTo(t), h = TradingView.createLineWidthEditor(), h.appendTo(e), o = $('<td colspan="4">').css({whiteSpace: "nowrap"}), o.appendTo(t), e = TradingView.createLineStyleEditor(), e.render().appendTo(o), c = $("<input class='property-page-bandwidth' type='text'/>"), c.appendTo(o), o = [ToFloatTransformer(n.value.value())], t = "Change band", this.bindControl(new SimpleStringBinder(c, n.value, o, !1, this.model(), t)), this.bindControl(new Q12(u, n.visible, !0, this.model(), t)), this.bindControl(new ColorBinding(r, n.color, !0, this.model(), t)), this.bindControl(new Q11(e, n.linestyle, parseInt, !0, this.model(), t)), this.bindControl(new SliderBinder(h, n.linewidth, !0, this.model(), t));
    if (this.Q1.properties().bandsBackground && (n = this.Q1.properties().bandsBackground, u = $.t("Background"), t = this._prepareFilledAreaBackground(n.fillBackground, n.backgroundColor, n.transparency, u, "Change band background"), t.appendTo(this._table)), this.Q1.properties().areaBackground && (n = this.Q1.properties().areaBackground, u = $.t("Background"), t = this._prepareFilledAreaBackground(n.fillBackground, n.backgroundColor, n.transparency, u, "Change area background"), t.appendTo(this._table)), f = this.Q1.metaInfo().filledAreas, void 0 != f)for (i = 0; i < f.length; ++i)t = f[i], n = this.Q1.properties().filledAreasStyle[t.id], u = t.title || $.t("Background"), t = "Change " + u, t = this._prepareFilledAreaBackground(n.visible, n.color, n.transparency, u, t), t.appendTo(this._table);
    for (s in this.Q1.metaInfo().graphics) {
        i = this.Q1.metaInfo().graphics[s];
        for (l in i)n = this._property.graphics[s][l], _47["_createRow_" + s].call(this, this._table, n)
    }
    1 == this._table.find("tr").length && (r = this._table.find(".visibility-cell"), r.css("display", "none"), n = this._table.find(".propertypage-name-label"), n.css("padding-left", 0));
    s = this._prepareStudyPropertiesLayout();
    this._table = this._table.add(s);
    this.loadData()
};
_47.prototype._prepareLayoutForPlot = function (n, t) {
    var i = t.id, f = this.Q1.properties().styles[i], u = this._findPlotPalette(n, t), r = u.palette, h = u.paletteProps, u = "Change " + i, o, s, e, c, l, a;
    r ? this._prepareLayoutForPalette(n, t, r, h, u) : (r = $('<tr class="line"/>'), r.appendTo(this._table), o = $("<td/>"), o.appendTo(r), o.addClass("visibility-cell"), h = $("<input type='checkbox' class='visibility-switch'/>"), h.appendTo(o), i = this.Q1.properties().styles[i].title.value(), this.createLabeledCell(i, h).appendTo(r).addClass($.t("propertypage-name-label", {context: "css_class"})), i = $("<td/>"), i.appendTo(r), i.addClass("colorpicker-cell"), i = TradingView.addColorPicker(i), s = $("<td/>"), s.appendTo(r), o = TradingView.createLineWidthEditor(), o.appendTo(s), e = $("<td>"), e.appendTo(r), s = TradingView.createPlotEditor(), s.appendTo(e), c = $("<td>"), c.appendTo(r), l = TradingView.createTransparencyEditor(i), l.appendTo(c), e = f.plottype.value(), c.css("display", this._isStyleNeedsTransparency(e) ? "block" : "none"), e = $("<td>"), e.appendTo(r), a = $("<input type='checkbox'>"), a.appendTo(e), this.createLabeledCell("Price Line", a).appendTo(r), this.bindControl(new Q12(h, f.visible, !0, this.model(), u)), this.bindControl(new ColorBinding(i, f.color, !0, this.model(), u)), this.bindControl(new SliderBinder(o, f.linewidth, !0, this.model(), u)), this.bindControl(new Q11(s, f.plottype, parseInt, !0, this.model(), u)), this.bindControl(new SliderBinder(l, f.transparency, !0, this.model(), u)), this.bindControl(new Q12(a, f.trackPrice, !0, this.model(), "Change Price Line")), u = function () {
        var n = f.plottype.value();
        c.css("display", this._isStyleNeedsTransparency(n) ? "table-cell" : "none");
        l.css("display", this._isStyleNeedsTransparency(n) ? "inline-block" : "none")
    }.bind(this), u(), f.plottype.listeners().subscribe(null, u))
};
_47.prototype._prepareLayoutForShapesPlot = function (n, t) {
    var r = t.id, o = this.Q1.properties().styles[r], f = this._findPlotPalette(n, t), u = f.palette, s = f.paletteProps, f = "Change " + r, i = $('<tr class="line"/>'), h, e;
    i.appendTo(this._table);
    h = $("<td/>");
    h.appendTo(i);
    h.addClass("visibility-cell");
    e = $("<input type='checkbox' class='visibility-switch'/>");
    e.appendTo(h);
    this.bindControl(new Q12(e, o.visible, !0, this.model(), f));
    r = this.Q1.properties().styles[r].title.value();
    this.createLabeledCell(r, e).appendTo(i).addClass($.t("propertypage-name-label", {context: "css_class"}));
    r = $("<td/>");
    r.appendTo(i);
    e = TradingView.createShapeStyleEditor();
    e.appendTo(r);
    this.bindControl(new Q11(e, o.plottype, null, !0, this.model(), f));
    r = $("<td/>");
    r.appendTo(i);
    i = TradingView.createShapeLocationEditor();
    i.appendTo(r);
    this.bindControl(new Q11(i, o.location, null, !0, this.model(), f));
    u ? this._prepareLayoutForPalette(n, t, u, s, f) : (i = $('<tr class="line"/>'), i.appendTo(this._table), $("<td/>").appendTo(i), $("<td/>").appendTo(i), u = $("<td/>"), u.appendTo(i), u.addClass("colorpicker-cell"), s = TradingView.addColorPicker(u), this.bindControl(new ColorBinding(s, o.color, !0, this.model(), f)), u = $("<td>"), u.appendTo(i), i = TradingView.createTransparencyEditor(s), i.appendTo(u), this.bindControl(new SliderBinder(i, o.transparency, !0, this.model(), f)))
};
_47.prototype._prepareLayoutForCharsPlot = function (n, t) {
    var r = t.id, o = this.Q1.properties().styles[r], f = this._findPlotPalette(n, t), u = f.palette, s = f.paletteProps, f = "Change " + r, i = $('<tr class="line"/>'), h, e;
    i.appendTo(this._table);
    h = $("<td/>");
    h.appendTo(i);
    h.addClass("visibility-cell");
    e = $("<input type='checkbox' class='visibility-switch'/>");
    e.appendTo(h);
    this.bindControl(new Q12(e, o.visible, !0, this.model(), f));
    r = this.Q1.properties().styles[r].title.value();
    this.createLabeledCell(r, e).appendTo(i).addClass($.t("propertypage-name-label", {context: "css_class"}));
    r = $("<td/>");
    r.appendTo(i);
    e = TradingView.createTextEditor();
    e.appendTo(r);
    e.keyup(function () {
        var n = $(this), t = n.val();
        t && (n.val(t.split("")[t.length - 1]), n.change())
    });
    this.bindControl(new SimpleStringBinder(e, o.char, null, !1, this.model(), f));
    r = $("<td/>");
    r.appendTo(i);
    i = TradingView.createShapeLocationEditor();
    i.appendTo(r);
    this.bindControl(new Q11(i, o.location, null, !0, this.model(), f));
    u ? this._prepareLayoutForPalette(n, t, u, s, f) : (i = $('<tr class="line"/>'), i.appendTo(this._table), $("<td/>").appendTo(i), $("<td/>").appendTo(i), u = $("<td/>"), u.appendTo(i), u.addClass("colorpicker-cell"), s = TradingView.addColorPicker(u), this.bindControl(new ColorBinding(s, o.color, !0, this.model(), f)), u = $("<td>"), u.appendTo(i), i = TradingView.createTransparencyEditor(s), i.appendTo(u), this.bindControl(new SliderBinder(i, o.transparency, !0, this.model(), f)))
};
_47.prototype._isStyleNeedsTransparency = function (n) {
    return 0 <= [TradingView.Study.PLOT_AREA, TradingView.Study.PLOT_AREA_WITH_BREAKS, TradingView.Study.PLOT_COLUMNS].indexOf(n)
};
_47.prototype._isStyleNeedsConnectPoints = function (n) {
    return 0 <= [TradingView.Study.PLOT_CROSS, TradingView.Study.PLOT_CIRCLES].indexOf(n)
};
_47.prototype._prepareLayoutForPalette = function (n, t, i, r, u) {
    var s, l, o, f, e, h, c;
    t = t.id;
    s = this.Q1.properties().styles[t];
    t = 0;
    for (l in i.colors)o = r.colors[l], i = $('<tr class="line"/>'), i.appendTo(this._table), $("<td/>").appendTo(i), f = $("<td/>"), f.appendTo(i), f.addClass($.t("propertypage-name-label", {context: "css_class"})), f.html($.t(o.name.value())), f = $("<td/>"), f.appendTo(i), f.addClass("colorpicker-cell"), f = TradingView.addColorPicker(f), this.bindControl(new ColorBinding(f, o.color, !0, this.model(), u)), 0 === t && (this.Q1.isBgColorerPlot(n) || this.Q1.isPlotCharsPlot(n) || this.Q1.isPlotShapesPlot(n)) && (e = $("<td>"), e.appendTo(i), h = TradingView.createTransparencyEditor(f), h.appendTo(e), this.bindControl(new SliderBinder(h, s.transparency, !0, this.model(), u))), this.Q1.isLinePlot(n) && (e = $("<td/>"), e.appendTo(i), c = TradingView.createLineWidthEditor(), c.appendTo(e), this.bindControl(new SliderBinder(c, o.width, !0, this.model(), u)), o = $("<td>"), o.appendTo(i), 0 === t && (e = TradingView.createPlotEditor(), e.appendTo(o), this.bindControl(new Q11(e, s.plottype, parseInt, !0, this.model(), u)), e = $("<td>"), e.appendTo(i), h = TradingView.createTransparencyEditor(f), h.appendTo(e), this.bindControl(new SliderBinder(h, s.transparency, !0, this.model(), u)), o = function () {
        var n = s.plottype.value();
        h.css("display", this._isStyleNeedsTransparency(n) ? "block" : "none")
    }.bind(this), o(), s.plottype.listeners().subscribe(null, o), o = $("<input type='checkbox'>"), f = $('<td colspan="4">').css({whiteSpace: "nowrap"}), e = $("<span>").html($.t("Price Line")), c = $("<span>"), c.append(o), f.append(c).append(e).appendTo(i), this.bindControl(new Q12(o, s.trackPrice, !0, this.model(), "Change Price Line")))), t++
};
_47.prototype._prepareLayoutForArrowsPlot = function (n, t) {
    var i = t.id, f = this.Q1.properties().styles[i], e = "Change " + i, u = $('<tr class="line"/>'), o, r, s;
    u.appendTo(this._table);
    r = $("<td/>");
    r.appendTo(u);
    r.addClass("visibility-cell");
    o = $("<input type='checkbox' class='visibility-switch'/>");
    o.appendTo(r);
    i = this.Q1.properties().styles[i].title.value();
    this.createLabeledCell(i, o).appendTo(u).addClass($.t("propertypage-name-label", {context: "css_class"}));
    i = $("<td/>");
    i.appendTo(u);
    i.addClass("colorpicker-cell");
    i = TradingView.addColorPicker(i);
    r = $("<td/>");
    r.appendTo(u);
    r.addClass("colorpicker-cell");
    r = TradingView.addColorPicker(r);
    s = $("<td>");
    s.appendTo(u);
    u = TradingView.createTransparencyEditor();
    u.appendTo(s);
    this.bindControl(new Q12(o, f.visible, !0, this.model(), e));
    this.bindControl(new ColorBinding(i, f.colorup, !0, this.model(), e));
    this.bindControl(new ColorBinding(r, f.colordown, !0, this.model(), e));
    this.bindControl(new SliderBinder(u, f.transparency, !0, this.model(), e))
};
_47.prototype._findPlotPalette = function (n, t) {
    var e = t.id, u = null, f = null, r = this.Q1.metaInfo().plots, i;
    if (this.Q1.isBarColorerPlot(n) || this.Q1.isBgColorerPlot(n))u = this.Q1.metaInfo().palettes[t.palette], f = this.Q1.properties().palettes[t.palette]; else for (i = 0; i < r.length; i++)if (this.Q1.isSelfColorerPlot(i) && r[i].target === e) {
        u = this.Q1.metaInfo().palettes[r[i].palette];
        f = this.Q1.properties().palettes[r[i].palette];
        break
    }
    return{palette: u, paletteProps: f}
};
_47.prototype._prepareStudyPropertiesLayout = function () {
    var i = $('<table class="property-page study-properties" cellspacing="0" cellpadding="2">'), t, n;
    return this.Q1.metaInfo().is_price_study || (t = this.createPrecisionEditor(), n = $("<tr>"), n.appendTo(i), $("<td>" + $.t("Precision") + "<\/td>").appendTo(n), $("<td>").append(t).appendTo(n), this.bindControl(new Q11(t, this.Q1.properties().precision, null, !0, this.model(), "Change Precision"))), "Compare@tv-basicstudies" == this.Q1.metaInfo().id && (t = this.createSeriesMinTickEditor(), n = $("<tr>"), n.appendTo(i), $("<td>" + $.t("Override Min Tick") + "<\/td>").appendTo(n), $("<td>").append(t).appendTo(n), this.bindControl(new Q11(t, this.Q1.properties().minTick, null, !0, this.model(), "Change MinTick"))), i
};
_47.prototype.widget = function () {
    return this._table
};
_47.prototype._prepareFilledAreaBackground = function (n, t, i, r, u) {
    var e = $('<tr class="line"/>'), f = $("<td/>"), o, s;
    return f.appendTo(e), o = $("<input type='checkbox' class='visibility-switch'/>"), o.appendTo(f), this.createLabeledCell(r, o).appendTo(e).addClass($.t("propertypage-name-label", {context: "css_class"})), r = $("<td/>"), r.appendTo(e), r.addClass("colorpicker-cell"), r = TradingView.addColorPicker(r), f = $("<td/>"), f.attr("colspan", "3"), f.appendTo(e), s = TradingView.createTransparencyEditor(r).width(230), s.appendTo(f), this.bindControl(new Q12(o, n, !0, this.model(), u + " visibility")), this.bindControl(new ColorBinding(r, t, !0, this.model(), u + " color")), this.bindControl(new SliderBinder(s, i, !0, this.model(), u + " transparency")), e
};
inherit(_39, Q7);
_39.prototype.prepareLayout = function () {
    if (this.Q1.properties().linkedToSeries && this.Q1.properties().linkedToSeries.value())this._table = $(); else {
        var i = $('<table class="property-page" cellspacing="0" cellpadding="2">'), n = $('<input type="checkbox" class="visibility-switch">'), t = this.addLabeledRow(i, "Last Value on Price Scale", n);
        $("<td>").prependTo(t).append(n);
        this.bindControl(new Q12(n, this._property.showLastValue, !0, this.model(), "Change Last Value on Price Scale Visibility"));
        "undefined" != typeof this._property.showStudyArguments && (n = $('<input type="checkbox" class="visibility-switch">'), t = this.addLabeledRow(i, "Arguments in Header", n), $("<td>").prependTo(t).append(n), this.bindControl(new Q12(n, this._property.showStudyArguments, !0, this.model(), "Change Arguments in Header Visibility")));
        t = this._prepareStudyAttachmentLayout();
        this._table = i = i.add(t)
    }
};
_39.prototype._prepareStudyAttachmentLayout = function () {
    var i = $('<table class="property-page" cellspacing="0" cellpadding="2">'), t, n, r;
    return this._pane && (this._pane.leftPriceScale().Q19().contains(this.Q1) ? t = "left" : this._pane.rightPriceScale().Q19().contains(this.Q1) ? t = "right" : this._pane.isOverlay(this.Q1) && (t = "none")), t && (n = this, t = this.createKeyCombo({left: $.t("Scale Left"), right: $.t("Scale Right"), none: $.t("Screen (No Scale)")}).val(t).change(function () {
        switch (this.value) {
            case"left":
                n.Q0.move(n.Q1, n._pane, n._pane.leftPriceScale());
                break;
            case"right":
                n.Q0.move(n.Q1, n._pane, n._pane.rightPriceScale());
                break;
            case"none":
                n.Q0.move(n.Q1, n._pane, null)
        }
    }), r = this.addRow(i), $("<td>").appendTo(r).append(t)), i
};
_39.prototype.widget = function () {
    return this._table
};
_47._createRow_horizlines = function (n, t) {
    var i = this.addRow(n), r = t.name.value(), u = $("<input type='checkbox' class='visibility-switch'/>"), f = this.createColorPicker(), e = TradingView.createLineWidthEditor(), o = TradingView.createLineStyleEditor();
    $("<td>").append(u).appendTo(i);
    this.createLabeledCell(r, u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o.render()).appendTo(i);
    this.bindControl(new Q12(u, t.visible, !0, this.model(), "Change " + r + " visibility"));
    this.bindControl(new ColorBinding(f, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new Q11(o, t.style, parseInt, !0, this.model(), "Change " + r + " style"));
    this.bindControl(new SliderBinder(e, t.width, !0, this.model(), "Change " + r + " width"))
};
_47._createRow_vertlines = function (n, t) {
    var i = this.addRow(n), r = t.name.value(), u = $("<input type='checkbox' class='visibility-switch'/>"), f = this.createColorPicker(), e = TradingView.createLineWidthEditor(), o = TradingView.createLineStyleEditor();
    $("<td>").append(u).appendTo(i);
    this.createLabeledCell(r, u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o.render()).appendTo(i);
    this.bindControl(new Q12(u, t.visible, !0, this.model(), "Change " + r + " visibility"));
    this.bindControl(new ColorBinding(f, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new Q11(o, t.style, parseInt, !0, this.model(), "Change " + r + " style"));
    this.bindControl(new SliderBinder(e, t.width, !0, this.model(), "Change " + r + " width"))
};
_47._createRow_lines = function (n, t) {
    var i = this.addRow(n), r = t.title.value(), u = $("<input type='checkbox' class='visibility-switch'/>"), f = this.createColorPicker(), e = TradingView.createLineWidthEditor(), o = TradingView.createLineStyleEditor();
    $("<td>").append(u).appendTo(i);
    this.createLabeledCell(r, u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o.render()).appendTo(i);
    this.bindControl(new Q12(u, t.visible, !0, this.model(), "Change " + r + " visibility"));
    this.bindControl(new ColorBinding(f, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new Q11(o, t.style, parseInt, !0, this.model(), "Change " + r + " style"));
    this.bindControl(new SliderBinder(e, t.width, !0, this.model(), "Change " + r + " width"))
};
_47._createRow_hlines = function (n, t) {
    var i = this.addRow(n), u = t.name.value(), r = $("<input type='checkbox' class='visibility-switch'/>"), e = this.createColorPicker(), o = TradingView.createLineWidthEditor(), s = TradingView.createLineStyleEditor(), f = $("<input type='checkbox'>");
    $("<td>").append(r).appendTo(i);
    this.createLabeledCell(u, r).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o).appendTo(i);
    $("<td>").append(s.render()).appendTo(i);
    $("<td>").appendTo(i);
    $("<td>").append(f).appendTo(i);
    this.createLabeledCell("Show Price", f).appendTo(i);
    this.bindControl(new Q12(r, t.visible, !0, this.model(), "Change " + u + " visibility"));
    this.bindControl(new ColorBinding(e, t.color, !0, this.model(), "Change " + u + " color"));
    this.bindControl(new Q11(s, t.style, parseInt, !0, this.model(), "Change " + u + " style"));
    this.bindControl(new SliderBinder(o, t.width, !0, this.model(), "Change " + u + " width"));
    this.bindControl(new Q12(f, t.showPrice, !0, this.model(), "Change " + u + " show price"));
    t.enableText.value() && (i = this.addRow(n), $('<td colspan="2">').appendTo(i), r = $("<input type='checkbox'>"), $('<td class="text-center">').append(r).appendTo(i), this.createLabeledCell("Show Text", r).appendTo(i), this.bindControl(new Q12(r, t.showText, !0, this.model(), "Change " + u + " show text")), r = TradingView.createTextPosEditor(), $("<td>").append(r.render()).appendTo(i), this.bindControl(new Q11(r, t.textPos, parseInt, !0, this.model(), "Change " + u + " text position")), r = this.createFontSizeEditor(), $('<td colspan="2">').append(r).appendTo(i), this.bindControl(new Q11(r, t.fontSize, parseInt, !0, this.model(), "Change " + u + " font size")))
};
_47._createRow_hhists = function (n, t) {
    var f = t.title.value(), e = [], o = [], s = [], i = this.addRow(n), r = TradingView.createVisibilityEditor(), u;
    $("<td>").append(r).appendTo(i);
    this.createLabeledCell(f, r).appendTo(i);
    this.bindControl(new Q12(r, t.visible, !0, this.model(), "Change " + f + " Visibility"));
    i = this.addRow(n);
    r = $("<input/>");
    r.attr("type", "text");
    r.addClass("ticker");
    this.createLabeledCell("Width (% of the Box)", r).appendTo(i);
    $("<td>").append(r).appendTo(i);
    i = [ToIntTransformer(40)];
    i.push(GreateTransformer(0));
    i.push(LessTransformer(100));
    this.bindControl(new SimpleStringBinder(r, t.percentWidth, i, !1, this.model(), "Change Percent Width"));
    i = this.addLabeledRow(n, "Placement");
    r = TradingView.createHHistDirectionEditor();
    $("<td>").append(r).appendTo(i);
    this.bindControl(new Q11(r, t.direction, null, !0, this.model(), "Change " + f + " Placement"));
    i = this.addRow(n);
    r = $("<input type='checkbox'>");
    $("<td>").append(r).appendTo(i);
    this.createLabeledCell("Show Values", r).appendTo(i);
    this.bindControl(new Q12(r, t.showValues, !0, this.model(), "Change " + f + " Show Values"));
    i = this.addRow(n);
    r = this.createColorPicker();
    this.createLabeledCell("Text Color", r).appendTo(i);
    $("<td>").append(r).appendTo(i);
    this.bindControl(new ColorBinding(r, t.valuesColor, !0, this.model(), "Change " + f + " Text Color"));
    for (u in t.colors)isNumber(parseInt(u, 10)) && (i = this.addRow(n), e[u] = t.titles[u].value(), o[u] = this.createColorPicker(), s[u] = TradingView.createTransparencyEditor(o[u]), $("<td>").append(e[u]).appendTo(i), $("<td>").append(o[u]).appendTo(i), $("<td>").append(s[u]).appendTo(i), this.bindControl(new ColorBinding(o[u], t.colors[u], !0, this.model(), "Change " + e[u] + " color")), this.bindControl(new SliderBinder(s[u], t.transparencies[u], !0, this.model(), "Change " + e[u] + " transparency")))
};
_47._createRow_backgrounds = function (n, t) {
    var i = this.addRow(n), u = $("<input type='checkbox' class='visibility-switch'/>"), r = t.name.value(), f = this.createColorPicker(), e = TradingView.createTransparencyEditor(f);
    $("<td>").append(u).appendTo(i);
    this.createLabeledCell(r, u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    this.bindControl(new Q12(u, t.visible, !0, this.model(), "Change " + r + " visibility"));
    this.bindControl(new ColorBinding(f, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new SliderBinder(e, t.transparency, !0, this.model(), "Change " + r + " transparency"))
};
_47._createRow_polygons = function (n, t) {
    var i = this.addRow(n), r = t.name.value(), u = this.createColorPicker(), f = TradingView.createTransparencyEditor(u);
    $("<td>").append(r).appendTo(i);
    $("<td>").append(u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    this.bindControl(new ColorBinding(u, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new SliderBinder(f, t.transparency, !0, this.model(), "Change " + r + " transparency"))
};
_47._createRow_trendchannels = function (n, t) {
    var i = this.addRow(n), r = t.name.value(), u = this.createColorPicker(), f = TradingView.createTransparencyEditor(u);
    $("<td>").append(r).appendTo(i);
    $("<td>").append(u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    this.bindControl(new ColorBinding(u, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new SliderBinder(f, t.transparency, !0, this.model(), "Change " + r + " transparency"))
};
_47._createRow_textmarks = function (n, t) {
    var i = this.addLabeledRow(n), r = t.name.value(), u = this.createColorPicker(), f = this.createColorPicker(), e = this.createFontEditor(), o = this.createFontSizeEditor(), s = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), h = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>'), c = TradingView.createTransparencyEditor(u);
    $("<td>").append(r).appendTo(i);
    "rectangle" !== t.shape.value() && $("<td>").append(u).appendTo(i);
    $("<td>").append(f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o).appendTo(i);
    $("<td>").append(s).appendTo(i);
    $("<td>").append(h).appendTo(i);
    $("<td>").append(c).appendTo(i);
    this.bindControl(new ColorBinding(u, t.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new ColorBinding(f, t.fontColor, !0, this.model(), "Change " + r + " text color"));
    this.bindControl(new Q11(o, t.fontSize, parseInt, !0, this.model(), "Change " + r + " font size"));
    this.bindControl(new Q11(e, t.fontFamily, null, !0, this.model(), "Change " + r + " font"));
    this.bindControl(new Q12(s, t.fontBold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(h, t.fontItalic, !0, this.model(), "Change Text Font Italic"));
    this.bindControl(new SliderBinder(c, t.transparency, !0, this.model(), "Change " + r + " transparency"))
};
_47._createRow_shapemarks = function (n, t) {
    var i = this.addRow(n), f = $("<input type='checkbox' class='visibility-switch'/>"), u = t.name.value(), e = this.createColorPicker(), o = TradingView.createTransparencyEditor(e), r = $("<input/>");
    r.attr("type", "text");
    r.addClass("ticker");
    $("<td>").append(f).appendTo(i);
    this.createLabeledCell(u, f).appendTo(i);
    $("<td>").append(e).appendTo(i);
    $("<td>").append(o).appendTo(i);
    this.createLabeledCell("Size", r).appendTo(i);
    $("<td>").append(r).appendTo(i);
    this.bindControl(new Q12(f, t.visible, !0, this.model(), "Change " + u + " visibility"));
    this.bindControl(new ColorBinding(e, t.color, !0, this.model(), "Change " + u + " back color"));
    this.bindControl(new SliderBinder(o, t.transparency, !0, this.model(), "Change " + u + " transparency"));
    this.bindControl(new SimpleStringBinder(r, t.size, null, !1, this.model(), "Change size"))
};
inherit(D85, Q7);
inherit(D85, SeriesStylePropertyPageMixin);
D85.prototype.setScalesOpenTab = function () {
    this.scalesColumnLeft.data("layout-tab-open", EditObjectDialog.TAB_OPEN_OVERRIDE)
};
D85.prototype.setTmzOpenTab = function () {
    this.tmzSessTable.data("layout-tab-open", EditObjectDialog.TAB_OPEN_OVERRIDE)
};
D85.prototype.prepareLayout = function () {
    var t = this, tt = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Style")), it = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Style")), rt = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Style")), st = $('<table class="property-page" cellspacing="0" cellpadding="2">'), ht = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}).data("layout-separated", !0), b = $('<div class="property-page-column-2">').data("layout-tab", $.t("Scales")), k, d, v, u, n, e, r, f, p, nt;
    this.scalesColumnLeft = b;
    k = $('<div class="property-page-column-2">').data("layout-tab", $.t("Scales"));
    d = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Timezone/Sessions"));
    this.tmzSessTable = d;
    v = t._alertSettingsIsVisible() ? "Events & Alerts" : $.t("Events");
    v = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", v);
    this.J99 instanceof TradingView.ESDStudyBase && v.data("layout-tab-open", EditObjectDialog.TAB_OPEN_OVERRIDE);
    var a = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Scales")), y = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Scales")), ut = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Scales")), ft = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Background")), ct = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Drawings")), et = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Style")), ot = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Style")), g = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Scales"));
    this._prepareSeriesStyleLayout(tt, it, rt, this._seriesProperty);
    u = $('<input type="checkbox">');
    n = this.addLabeledRow(et, "Price Line", u);
    $("<td>").append(u).prependTo(n);
    e = TradingView.createLineWidthEditor();
    $("<td>").append(e).appendTo(n);
    r = this.createSeriesMinTickEditor();
    f = $("<tr>");
    f.appendTo(ot);
    $("<td>" + $.t("Override Min Tick") + "<\/td>").appendTo(f);
    $("<td>").append(r).appendTo(f);
    this.bindControl(new Q11(r, this._seriesProperty.minTick, null, !0, this.model(), "Change MinTick"));
    (this._alertSettingsIsVisible() || TradingView.Q18("esdindicatorfeature")) && !J77.enabled("charting_library") && this.createEventsTable(v);
    this.bindControl(new Q12(u, this._seriesProperty.showPriceLine, !0, this.model(), "Change Price Price Line"));
    this.bindControl(new SliderBinder(e, this._seriesProperty.priceLineWidth, !0, this.model(), "Change Price Line Width"));
    var u = $("<tr>").appendTo(ft), r = $('<table class="property-page" cellspacing="0" cellpadding="2">').appendTo($("<td>").appendTo(u)), i = this.createColorPicker(), s = this.createColorPicker(), n = TradingView.createLineStyleEditor(), h = TradingView.createTransparencyEditor(s), p = TradingView.createLineWidthEditor(), c = this.createColorPicker(), w = TradingView.createLineStyleEditor(), l = this.createColorPicker(), f = this.createColorPicker(), u = this.createColorPicker(), e = TradingView.createTransparencyEditor(u), lt = this.addLabeledRow(r, "Background");
    $('<td colspan="4">').append(i).appendTo(lt);
    this.bindControl(new ColorBinding(i, this._property.paneProperties.background, !0, this.model(), "Change Chart Background Color"));
    i = this.addLabeledRow(r, "Crosshair");
    $("<td>").append(s).appendTo(i);
    $("<td>").append(n.render()).appendTo(i);
    $("<td>").append(p).appendTo(i);
    $("<td>").append(h).appendTo(i);
    this.bindControl(new ColorBinding(s, this._property.paneProperties.crossHairProperties.color, !0, this.model(), "Change Crosshair Color"));
    this.bindControl(new Q11(n, this._property.paneProperties.crossHairProperties.style, parseInt, !0, this.model(), "Change Crosshair Style"));
    this.bindControl(new SliderBinder(p, this._property.paneProperties.crossHairProperties.width, !0, this.model(), "Change Crosshair Width"));
    this.bindControl(new SliderBinder(h, this._property.paneProperties.crossHairProperties.transparency, !0, this.model(), "Change Crosshair Transparency"));
    s = this.addLabeledRow(r, "Grid Lines");
    $("<td>").append(c).appendTo(s);
    $('<td colspan="3">').append(w.render()).appendTo(s);
    this.bindControl(new ColorBinding(c, this._property.paneProperties.gridProperties.color, !0, this.model(), "Change Grid Lines Color"));
    this.bindControl(new Q11(w, this._property.paneProperties.gridProperties.style, parseInt, !0, this.model(), "Change Grid Lines Style"));
    c = this.addLabeledRow(r, "Scales Text");
    $('<td colspan="4">').append(l).appendTo(c);
    this.bindControl(new ColorBinding(l, this._property.scalesProperties.textColor, !0, this.model(), "Change Scales Text Color"));
    l = this.addLabeledRow(r, "Scales Lines");
    $('<td colspan="4">').append(f).appendTo(l);
    this.bindControl(new ColorBinding(f, this._property.scalesProperties.lineColor, !0, this.model(), "Change Scales Lines Color"));
    r = this.addLabeledRow(r, "Watermark");
    $("<td>").append(u).appendTo(r);
    $('<td colspan="3">').append(e).appendTo(r);
    this.bindControl(new ColorBinding(u, this._property.symbolWatermarkProperties.color, !0, this.model(), "Change Symbol Watermark Color"));
    this.bindControl(new SliderBinder(e, this._property.symbolWatermarkProperties.transparency, !0, this.model(), "Change Symbol Watermark Transparency"));
    u = $('<input type="checkbox">');
    e = $('<input type="checkbox">');
    r = $('<input type="checkbox">');
    r.change(function () {
        this.checked && setTimeout(function () {
            t.Q0.m_model.Q20(new D22(D22.LIGHT_UPDATE))
        }, 0)
    });
    f = $('<input type="checkbox">');
    f.change(function () {
        this.checked && setTimeout(function () {
            t.Q0.m_model.Q20(new D22(D22.LIGHT_UPDATE))
        }, 0)
    });
    var h = $("<input type='checkbox'>"), l = $("<input type='checkbox' />"), c = $("<input type='checkbox' />"), at = $(l).add(c).change(function (n) {
        at.filter(":checked").size() || ($(this).attr("checked", !0), n.stopImmediatePropagation())
    }), w = $("<input type='checkbox' />"), s = $("<input type='checkbox' />"), o;
    this._pane && (this._pane.leftPriceScale().Q19().contains(this._series) ? o = "left" : this._pane.rightPriceScale().Q19().contains(this._series) ? o = "right" : this._pane.isOverlay(this._series) && (o = "none"));
    o && (n = {left: $.t("Scale Left"), right: $.t("Scale Right")}, t._pane.actionNoScaleIsEnabled(t._series) && (n.none = $.t("Screen (No Scale)")), o = this.createKeyCombo(n).val(o).change(function () {
        switch (this.value) {
            case"left":
                t.Q0.move(t._series, t._pane, t._pane.leftPriceScale());
                break;
            case"right":
                t.Q0.move(t._series, t._pane, t._pane.rightPriceScale());
                break;
            case"none":
                t.Q0.move(t._series, t._pane, null)
        }
    }), n = this.addRow(ut), $("<td>").appendTo(n).append(o));
    this.bindControl(new Q12(h, this._seriesProperty.showCountdown, !0, this.model(), "Change Show Countdown"));
    n = this.addLabeledRow(a, "Auto Scale", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(a, "Scale Series Only", f);
    $("<td>").append(f).prependTo(n);
    n = this.addLabeledRow(y, "Percentage", u);
    $("<td>").append(u).prependTo(n);
    n = this.addLabeledRow(y, "Log Scale", e);
    $("<td>").append(e).prependTo(n);
    n = this.addLabeledRow(a, "Show Left Axis", l);
    $("<td>").append(l).prependTo(n);
    n = this.addLabeledRow(a, "Show Right Axis", c);
    $("<td>").append(c).prependTo(n);
    n = this.addLabeledRow(a, "Show Symbol Labels", w);
    $("<td>").append(w).prependTo(n);
    n = this.addLabeledRow(a, "Precise Labels", s);
    $("<td>").append(s).prependTo(n);
    J77.enabled("countdown") && (n = this.addLabeledRow(y, "Show Countdown", h), $("<td>").append(h).prependTo(n));
    this.bindControl(new Q11(n, this._property.timezone, null, !0, this.model(), "Change Timezone"));
    J77.enabled("charting_library") || (this._series.createSessStudy(), this.createSessTable(d));
    o = null;
    J77.enabled("trading_options") && TradingView.Q18("paper_trading") && (o = this.createTradingTable());
    h = $('<input type="checkbox">');
    n = this.addLabeledRow(y, "Last Value on Price Scale", h);
    $("<td>").append(h).prependTo(n);
    p = $("<input type='checkbox'/>");
    nt = this.addLabeledRow(y, "Lock scale", p);
    $("<td>").append(p).prependTo(nt);
    this._seriesProperty.style.listeners().subscribe(this, function (n) {
        nt.toggle(n.value() == TradingView.Series.STYLE_PNF)
    });
    i = $('<input type="text" class="ticker">');
    n = this.addLabeledRow(g, "Top Margin", i);
    $("<td>").appendTo(n).append(i);
    $("<td>%<\/td>").appendTo(n);
    n = [ToIntTransformer(this._property.paneProperties.topMargin.value())];
    n.push(LessTransformer(25));
    n.push(GreateTransformer(0));
    this.bindControl(new SimpleStringBinder(i, this._property.paneProperties.topMargin, n, !0, this.model(), "Top Margin"));
    i = $('<input type="text" class="ticker">');
    n = this.addLabeledRow(g, "Bottom Margin", i);
    $("<td>").appendTo(n).append(i);
    $("<td>%<\/td>").appendTo(n);
    n = [ToIntTransformer(this._property.paneProperties.bottomMargin.value())];
    n.push(LessTransformer(25));
    n.push(GreateTransformer(0));
    this.bindControl(new SimpleStringBinder(i, this._property.paneProperties.bottomMargin, n, !0, this.model(), "Bottom Margin"));
    i = $('<input type="text" class="ticker">');
    n = this.addLabeledRow(g, "Right Margin", i);
    $("<td>").appendTo(n).append(i);
    $("<td>" + $.t("bars", {context: "margin"}) + "<\/td>").appendTo(n);
    n = [ToIntTransformer(this._property.timeScale.rightOffset.value())];
    n.push(LessTransformer(~~this._chart.m_timeScale.maxOffset()));
    n.push(GreateTransformer(-200));
    this.bindControl(new SimpleStringBinder(i, this._property.timeScale.rightOffset, n, !0, this.model(), "Right Margin"));
    this.bindControl(new Q12(l, this._property.scalesProperties.showLeftScale, !0, this.model(), "Show Left Axis"));
    this.bindControl(new Q12(c, this._property.scalesProperties.showRightScale, !0, this.model(), "Show Right Axis"));
    this.bindControl(new Q12(w, this._scaleProperty.showSymbolLabels, !0, this.model(), "Show Symbol Labels"));
    this.bindControl(new Q12(s, this._scaleProperty.alignLabels, !0, this.model(), "Precise Labels"));
    this.bindControl(new Q12(r, this._scaleProperty.autoScale, !0, this.model(), "Auto Scale", function (n) {
        this._undoModel.setAutoScaleProperty(this._property, n, t._series.priceScale(), this._undoText)
    }));
    this.bindControl(new DisabledBinder(r, this._scaleProperty.autoScaleDisabled, !0, this.model(), "Auto Scale"));
    this.bindControl(new Q12(f, this._property.scalesProperties.scaleSeriesOnly, !0, this.model(), "Scale Series Only"));
    this.bindControl(new Q12(u, this._mainAxisProperty.percentage, !0, this.model(), "Scale Percentage", function (n) {
        this._undoModel.setPercentProperty(this._property, n, t._series.priceScale(), this._undoText)
    }));
    this.bindControl(new DisabledBinder(u, this._mainAxisProperty.percentageDisabled, !0, this.model(), "Scale Percentage"));
    this.bindControl(new Q12(e, this._mainAxisProperty.log, !0, this.model(), "Log Scale", function (n) {
        this._undoModel.setLogProperty(this._property, n, t._series.priceScale(), this._undoText)
    }));
    this.bindControl(new DisabledBinder(e, this._mainAxisProperty.logDisabled, !0, this.model(), "Log Scale"));
    this.bindControl(new Q12(h, this._seriesProperty.showLastValue, !0, this.model(), "Change Last Value on Price Scale Visibility"));
    this.bindControl(new Q12(p, this._seriesProperty.lockScale, !0, this.model(), "Change lock scale", function (n) {
        this._undoModel.setLockScaleProperty(this._property, n, t._series, this._undoText)
    }));
    this._table = this._table = tt.add(it).add(rt).add(st).add(ht).add(et).add(ot).add(ft).add(b).add(k).add(ct).add(d).add(o).add(v);
    k.append(ut);
    k.append(a);
    b.append(y);
    b.append(g);
    this.loadData()
};
D85.prototype.widget = function () {
    return this._table
};
D85.prototype.loadData = function () {
    this.superclass.prototype.loadData.call(this);
    this.switchStyle()
};
D85.prototype.loadTheme = function (n) {
    var t = this;
    $.get("/theme/?themeName=" + encodeURIComponent(n), function (i) {
        t.Q0._lastLoadedTheme = n;
        t.applyTheme(JSON.parse(i.content))
    })
};
D85.prototype.applyTheme = function (n) {
    var t = this._seriesProperty.extendedHours.value();
    this.Q0.model().restoreTheme(n);
    this._seriesProperty.extendedHours.value() !== t && this._seriesProperty.extendedHours.listeners().fire(this._seriesProperty.extendedHours);
    this.loadData()
};
D85.prototype.createTemplateButton = function (n) {
    var t, r, i;
    return J77.enabled("charting_library") ? $("<span />") : (t = this, n || (n = {}), r = function () {
        var i = [], r;
        return i.push({title: "Save As...", action: function () {
            runOrSignIn(function () {
                TradingView.showChartNameDialog(function (n) {
                    if (n) {
                        var i = {name: n, content: JSON.stringify(t.Q0.model().theme())};
                        $.post("/save-theme/", i).error(function (n) {
                            document.write(n.responseText)
                        });
                        t._themes.push(n);
                        t.Q0._lastLoadedTheme = n
                    }
                }, "Save theme as...", "Theme name")
            }, !0)
        }, addClass: "special"}), "function" == typeof n.defaultsCallback && i.push({title: "Apply Defaults", action: n.defaultsCallback, addClass: "special"}), r = [], $.each(t._themes, function (n, i) {
            r.push({title: i, action: function () {
                t.loadTheme(i)
            }, deleteAction: is_authenticated ? function () {
                var n = this;
                D83.showConfirm("Theme", "Do you realy want to delete " + (i ? '"' + i + '"' : "") + " theme?", function () {
                    n instanceof $ && n.remove();
                    $.post("/remove-theme/", {name: i}).error(function (n) {
                        document.write(n.responseText)
                    });
                    for (var r = t._themes.length; r--;)t._themes[r] == i && t._themes.splice(r, 1)
                })
            } : void 0})
        }), r.length && (r.sort(function (n, t) {
            return n = n.title.toUpperCase(), t = t.title.toUpperCase(), n == t ? 0 : n > t ? 1 : -1
        }), i.push({separator: !0}), i = i.concat(r)), i
    }, i = $('<a href="#" class="tv-button">Themes<span class="icon-dropdown"><\/span><\/a>'), TradingView.bindPopupMenu(i, null, {direction: "up", event: "button-popup", notCloseOnButtons: !0}), i.bind("click", function () {
        var n = $(this);
        n.is(".active") || (n.trigger("button-popup", [r()]), TradingView.getThemesList(function (i) {
            t._themes = i;
            n.is(".active") && n.trigger("button-popup", [r(), !0])
        }))
    }), i)
};
D85.prototype.switchStyle = function () {
    toggledTbodies = $(this._barsTbody).add(this._barsColorerTbody).add(this._renkoTbody).add(this._pbTbody).add(this._kagiTbody).add(this._pnfTbody).add(this._candlesTbody).add(this._candlesColorerTbody).add(this._hollowCandlesTbody).add(this._lineTbody).add(this._areaTbody).add(this._haTbody).add(this._haColorerTbody).css("display", "none");
    switch (this._seriesProperty.style.value()) {
        case TradingView.Series.STYLE_BARS:
            this._barsTbody.css("display", "table-row-group");
            this._barsColorerTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_CANDLES:
            this._candlesTbody.css("display", "table-row-group");
            this._candlesColorerTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            this._hollowCandlesTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_LINE:
            this._lineTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_AREA:
            this._areaTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_RENKO:
            this._renkoTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_PB:
            this._pbTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_KAGI:
            this._kagiTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_PNF:
            this._pnfTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_HEIKEN_ASHI:
            this._haTbody.css("display", "table-row-group");
            this._haColorerTbody.css("display", "table-row-group")
    }
};
D85.prototype.onResoreDefaults = function () {
    var n = this.Q0.model().properties().paneProperties.topMargin, t = this.Q0.model().properties().paneProperties.bottomMargin;
    n.listeners().fire(n);
    t.listeners().fire(t);
    TradingView.bottomWidgetBar && (D77.setWatchedValue(TradingView.bottomWidgetBar.hideFloatingPanel, !1, "Restore Defaults"), D77.setWatchedValue(TradingView.bottomWidgetBar.hideCompletedOrders, !1, "Restore Defaults"), D77.setWatchedValue(TradingView.bottomWidgetBar.noConfirmEnabled, !1, "Restore Defaults"))
};
D85.prototype.defaultProperties = function () {
    var n = this, t = [n._seriesProperty.extendedHours, n._property.scalesProperties.showLeftScale, n._property.scalesProperties.showRightScale, n._property.timeScale.rightOffset].map(function (n) {
        return{property: n, previousValue: n.value()}
    });
    return setTimeout(function () {
        t.forEach(function (n) {
            n.property.value() !== n.previousValue && n.property.listeners().fire(n.property)
        });
        var i = new _52("chartproperties.paneProperties.rightAxisProperties");
        $.each(["autoScale", "percentage", "log"], function (t, r) {
            var u = n._scaleProperty[r], f = i[r].value();
            f !== u.value() && u.setValue(f)
        })
    }, 0), [this._property, this._seriesProperty]
};
D85.prototype._alertSettingsIsVisible = function () {
    return TradingView.Q18("alerts") && !TradingView.onWidget() && !TradingView.isRunningChartingLibrary
};
D85.prototype.createEventsTable = function (n) {
    var s, h, c, e, t, u;
    if (TradingView.Q18("esdindicatorfeature")) {
        var r = $("<tr>").appendTo(n), i = $('<input type="checkbox" />'), t = this.addLabeledRow(r, "Show Dividends on Chart", i);
        $("<td>").append(i).prependTo(t);
        t.append("<td>");
        s = this._seriesProperty.esdShowDividends;
        this.bindControl(new Q12(i, this._seriesProperty.esdShowDividends, !0, this.model(), "Change Show or Hide Dividends", function (n) {
            this.Q0.beginUndoMacro("Show Dividends");
            this.Q0.setProperty(s, n, "Show Dividends");
            this.Q0.endUndoMacro()
        }.bind(this)));
        i = $('<input type="checkbox" />');
        t = this.addLabeledRow(r, "Show Splits on Chart", i);
        $("<td>").append(i).prependTo(t);
        t.append("<td>");
        h = this._seriesProperty.esdShowSplits;
        this.bindControl(new Q12(i, this._seriesProperty.esdShowSplits, !0, this.model(), "Change Show or Hide Splits", function (n) {
            this.Q0.beginUndoMacro("Show Splits");
            this.Q0.setProperty(h, n, "Show Splits");
            this.Q0.endUndoMacro()
        }.bind(this)));
        i = $('<input type="checkbox" />');
        t = this.addLabeledRow(r, "Show Earnings on Chart", i);
        $("<td>").append(i).prependTo(t);
        t.append("<td>");
        c = this._seriesProperty.esdShowEarnings;
        this.bindControl(new Q12(i, this._seriesProperty.esdShowEarnings, !0, this.model(), "Change Show or Hide Earnings", function (n) {
            this.Q0.beginUndoMacro("Show Earnings");
            this.Q0.setProperty(c, n, "Show Earnings");
            this.Q0.endUndoMacro()
        }.bind(this)));
        var t = this.createTableInTable(n), f = $('<input type="checkbox" />'), r = TradingView.createLineStyleEditor(), i = TradingView.addColorPicker(), l = TradingView.createLineWidthEditor(), t = this.addLabeledRow(t, "Earnings breaks", f);
        $("<td>").append(f).prependTo(t);
        $("<td>").append(i).appendTo(t);
        $("<td>").append(r.render()).appendTo(t);
        $("<td>").append(l).appendTo(t);
        t.addClass("offset-row");
        t.append("<td>");
        this.bindControl(new Q12(f, this._seriesProperty.esdShowBreaks, !0, this.model(), "Change Show or Hide Earnings"));
        this.bindControl(new ColorBinding(i, this._seriesProperty.esdBreaksStyle.color, !0, this.model(), "Change earnings color"));
        this.bindControl(new Q11(r, this._seriesProperty.esdBreaksStyle.style, parseInt, !0, this.model(), "Change style"));
        this.bindControl(new SliderBinder(l, this._seriesProperty.esdBreaksStyle.width, !0, this.model(), "Change width"));
        this._seriesProperty.esdShowEarnings.listeners().subscribe(this, function (n) {
            f.prop("disabled", !n.value())
        })
    }
    if (this._alertSettingsIsVisible()) {
        t = $("<tr>").appendTo(n);
        r = $('<input type="checkbox" />');
        t = this.addLabeledRow(t, "Show Alert Labels", r);
        $("<td>").append(r).prependTo(t);
        t.append("<td>");
        e = this._property.alertsProperties.labels.visible;
        this.bindControl(new Q12(r, e, !0, this.model(), "Change Show or Hide Alert Labels", function (n) {
            this.Q0.beginUndoMacro("Show Alert Labels");
            this.Q0.setProperty(e, n, "Show  Alert Labels");
            this.Q0.endUndoMacro()
        }.bind(this)));
        t = this.createTableInTable(n);
        u = $('<input type="checkbox">');
        n = TradingView.addColorPicker();
        var o = TradingView.createLineWidthEditor(), r = TradingView.createLineStyleEditor(), a = r.render(), t = this.addLabeledRow(t, "Extended Alert Line", u);
        $("<td>").append(u).prependTo(t);
        $("<td>").append(n).appendTo(t);
        $("<td>").append(a).appendTo(t);
        $("<td>").append(o).appendTo(t);
        t.addClass("offset-row");
        t.append("<td>");
        this.bindControl(new Q12(u, this._property.alertsProperties.labels.line.visible, !0, this.model(), "Change Show or Hide Alert Labels Lines"));
        this.bindControl(new ColorBinding(n, this._property.alertsProperties.labels.color, !0, this.model(), "Change Alerts Labels color"));
        this.bindControl(new Q11(r, this._property.alertsProperties.labels.line.style, parseInt, !0, this.model(), "Change style"));
        this.bindControl(new SliderBinder(o, this._property.alertsProperties.labels.line.width, !0, this.model(), "Change width"));
        e.listeners().subscribe(this, function (n) {
            u.prop("disabled", !n.value());
            a.prop("disabled", !n.value());
            o.prop("disabled", !n.value())
        })
    }
};
D85.prototype.createSessTable = function (n) {
    var i = this._series.sessionsStudy().properties(), t = this.createTableInTable(n), r = i.name.value(), u = $("<input type='checkbox' />"), t = this.addLabeledRow(t, "Session Breaks", u), f = TradingView.createLineStyleEditor(), e = TradingView.addColorPicker(), o = TradingView.createLineWidthEditor();
    $("<td>").append(u).prependTo(t);
    $("<td>").append(e).appendTo(t);
    $("<td>").append(f.render()).appendTo(t);
    $("<td>").append(o).appendTo(t);
    this.bindControl(new Q12(u, i.graphics.vertlines.sessBreaks.visible, !0, this.model(), "Change " + r + " visibility"));
    this.bindControl(new ColorBinding(e, i.graphics.vertlines.sessBreaks.color, !0, this.model(), "Change " + r + " color"));
    this.bindControl(new Q11(f, i.graphics.vertlines.sessBreaks.style, parseInt, !0, this.model(), "Change " + r + " style"));
    this.bindControl(new SliderBinder(o, i.graphics.vertlines.sessBreaks.width, !0, this.model(), "Change " + r + " width"));
    t = this.createTableInTable(n);
    r = this._extendedHoursEditor = $('<input type="checkbox" />');
    t = this.addLabeledRow(t, "Extended Hours (Intraday Only)", r);
    $("<td>").append(r).prependTo(t);
    this.bindControl(new Q15(r, this._seriesProperty.extendedHours, this._seriesProperty.interval, !0, this.model(), "Change Extended Hours"));
    this._seriesProperty.sessVis = i.graphics.vertlines.sessBreaks.visible;
    var t = this.createTableInTable(n), s = this._createStudySessRow(t, "Extended Hours", i.graphics.backgrounds.outOfSession), h = this._createStudySessRow(t, "In Session", i.graphics.backgrounds.inSession);
    return this._seriesProperty.extendedHours.listeners().subscribe(this, function (n) {
        s.prop("disabled", !n.value());
        h.prop("disabled", !n.value())
    }), n = this._series.isIntradayInterval(), i = !n || !this._seriesProperty.extendedHours.value(), u.prop("disabled", !n), r.prop("disabled", !n), s.prop("disabled", i), h.prop("disabled", i), t
};
D85.prototype._createStudySessRow = function (n, t, i) {
    var r = $("<input type='checkbox' />"), u, f;
    return n = this.addLabeledRow(n, t, r), u = TradingView.addColorPicker($("<td>").appendTo(n)), f = TradingView.createTransparencyEditor(u), this.bindControl(new Q12(r, i.visible, !0, this.model(), "Change " + t + " visibility")), this.bindControl(new ColorBinding(u, i.color, !0, this.model(), t + " color")), this.bindControl(new SliderBinder(f, i.transparency, !0, this.model(), t + " transparency")), $("<td>").append(r).prependTo(n), n.addClass("offset-row"), $("<td>").append(f).appendTo(n), r
};
D85.prototype.createTradingTable = function () {
    var f = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab", $.t("Trading")), n = $("<tr>").appendTo(f), i = $("<td>").appendTo(n), i = $('<table cellspacing="0" cellpadding="0">').appendTo(i), t = $('<input type="checkbox">'), n = this.addLabeledRow(i, $.t("Show Positions"), t), u, r;
    return $("<td>").append(t).prependTo(n), this.bindControl(new Q12(t, this._property.tradingProperties.showPositions, !0, this.model(), "Change Positions Visibility")), t = $('<input type="checkbox">'), n = this.addLabeledRow(i, $.t("Show Orders"), t), $("<td>").append(t).prependTo(n), this.bindControl(new Q12(t, this._property.tradingProperties.showOrders, !0, this.model(), "Change Orders Visibility")), n = $('<input type="checkbox">'), t = this.addLabeledRow(i, $.t("Extend Lines Left"), n), $("<td>").append(n).prependTo(t), this.bindControl(new Q12(n, this._property.tradingProperties.extendLeft, !0, this.model(), "Extend Lines Left")), n = TradingView.createLineWidthEditor(), this.bindControl(new SliderBinder(n, this._property.tradingProperties.lineWidth, !0, this.model(), "Change Connecting Line Width")), t = TradingView.createLineStyleEditor(), this.bindControl(new Q11(t, this._property.tradingProperties.lineStyle, parseInt, !0, this.model(), "Change Connecting Line Style")), u = $('<input type="text" class="ticker">'), r = [ToIntTransformer(this._property.tradingProperties.lineLength.value()), LessTransformer(100), GreateTransformer(0)], this.bindControl(new SimpleStringBinder(u, this._property.tradingProperties.lineLength, r, !0, this.model(), "Change Connecting Line Length")), r = $("<tbody>"), r = this.addLabeledRow(i, $.t("Connecting Line"), r), $("<td>").prependTo(r), $("<td>").append(n).appendTo(r), $('<td colspan="3">').append(t.render()).appendTo(r), $('<td colspan="3">').append(u).appendTo(r), $("<td>%<\/td>").appendTo(r), n = $('<input type="checkbox">'), t = this.addLabeledRow(i, $.t("Show Executions"), n), $("<td>").append(n).prependTo(t), this.bindControl(new Q12(n, this._property.tradingProperties.showExecutions, !0, this.model(), "Change Executions Visibility")), TradingView.bottomWidgetBar && (n = $('<input type="checkbox">'), t = this.addLabeledRow(i, $.t("Show Buy/Sell Panel"), n), $("<td>").append(n).prependTo(t), this.bindControl(new CheckboxWVBinding(n, TradingView.bottomWidgetBar.hideFloatingPanel, null, "Change buy/sell panel visibility", !0)), n = $('<input type="checkbox">'), t = this.addLabeledRow(i, $.t("Show Active Orders Only"), n), $("<td>").append(n).prependTo(t), this.bindControl(new CheckboxWVBinding(n, TradingView.bottomWidgetBar.hideCompletedOrders, null, "Change completed orders visibility")), n = $('<input type="checkbox">'), i = this.addLabeledRow(i, $.t("Require Order Confirmation"), n), $("<td>").append(n).prependTo(i), this.bindControl(new CheckboxWVBinding(n, TradingView.bottomWidgetBar.noConfirmEnabled, null, "Change order confirmation state", !0))), f
};
inherit(_38, Q7);
_38.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var n = this.createKeyCombo({open: $.t("Open"), high: $.t("High"), low: $.t("Low"), close: $.t("Close")}), t = this.addLabeledRow(this._table, $.t("Source", {context: "compare"}));
    $("<td>").appendTo(t).append(n);
    this.bindControl(new Q11(n, this._property.inputs.source, null, !0, this.model(), "Change Price Source"));
    this.loadData()
};
_38.prototype.widget = function () {
    return this._table
};
TradingView.SoundSelector = function (n) {
    n.container || console.error("[SoundSelector] options.container is required");
    n = $.extend(this.defaultOptions(), n);
    this.fileName = new WatchedValue(n.fileName);
    this.duration = new WatchedValue(n.duration);
    this._$container = n.container;
    this._$durationContainer = n.durationContainer;
    this._onChange = n.onChange || function () {
        console.warn("[SoundSelector] 'onChange' callback is not defined")
    };
    this._options = n;
    this._nowPlaying = null;
    this._attachHandlers();
    this._render()
};
TradingView.SoundSelector.prototype.soundList = function () {
    return this._soundListArray || (this._soundListArray = $.map(TradingView.Sound.alertSounds(), function (n) {
        return{fileName: n.path, title: n.title}
    })), this._soundListArray
};
TradingView.SoundSelector.prototype.defaultOptions = function () {
    return{fileName: this.soundList()[0].fileName, duration: ""}
};
TradingView.SoundSelector.prototype._attachHandlers = function () {
    var n = this;
    n.fileName.subscribe(function (t) {
        n._onChange(t, n.duration.value());
        n._$button.find(".title").text(n._fileName2title(t))
    });
    n.duration.subscribe(function (t) {
        n._onChange(n.fileName.value(), t)
    })
};
TradingView.SoundSelector.prototype._render = function () {
    var n = this, t;
    n._$container.empty();
    n._$button = $('<a class="tv-button with-arrow"><span class="title">' + n._fileName2title(n.fileName.value()) + '<\/span><span class="icon-dropdown"><\/span><\/a>');
    n._$button.appendTo(n._$container);
    TradingView.bindPopupMenu(n._$button, function () {
        return $.map(n.soundList(), function (t) {
            var i = $('<span class="manage-sound-button"><\/span>'), r = function () {
                var r = !!TradingView.Sound.isPlaying(t.fileName);
                i.toggleClass("stop", r);
                i.toggleClass("play", !r);
                n._nowPlaying = r ? t.fileName : null
            };
            if (r(), TradingView.Sound.isPlaying(t.fileName))TradingView.Sound.onStopped(t.fileName, r);
            return{title: t.title, action: function () {
                n.fileName.setValue(t.fileName)
            }, active: t.fileName === n.fileName.value(), buttons: [
                {el: i, handler: function (u) {
                    u.stopPropagation();
                    i.hasClass("play") ? (TradingView.Sound.stop(), TradingView.Sound.play(t.fileName, !1, n.duration.value()), TradingView.Sound.onStopped(t.fileName, r)) : i.hasClass("stop") && TradingView.Sound.stop(t.fileName);
                    r()
                }}
            ]}
        })
    }, {direction: "down", addClass: "sound-selector"});
    n._$durationContainer && (n._$durationContainer.empty(), t = $('<select><option value="0">Once<\/option><option value="5">5 seconds<\/option><option value="10">10 seconds<\/option><option value="30">30 seconds<\/option><option value="60">1 minute<\/option><\/select>'), t.change(function () {
        var i = parseInt(t.val());
        n.duration.setValue(i)
    }), t.appendTo(n._$durationContainer), t.val(n.duration.value() || 0))
};
TradingView.SoundSelector.prototype._fileName2title = function (n) {
    for (var i = this.soundList(), t = 0; t < i.length; t++)if (i[t].fileName === n)return i[t].title
};
TradingView.SoundSelector.prototype.destroy = function () {
    var n = this;
    n.fileName.unsubscribe(function (t) {
        n._onChange({fileName: t})
    });
    n.duration.unsubscribe(function (t) {
        n._onChange({duration: t})
    });
    TradingView.unbindPopupMenu(n._$button);
    n._nowPlaying && TradingView.Sound.stop(n._nowPlaying)
};
inherit(_14, Q7);
_14.prototype._createPointRow = function (n, t, i) {
    var r, u;
    return n = $("<tr>"), r = $("<td>"), r.html($.t("Price") + i), r.appendTo(n), r = $("<td>"), r.appendTo(n), i = $("<input type='text'>"), i.appendTo(r), r = $("<td>"), r.html($.t("Bar #")), r.appendTo(n), barEditCell = $("<td>"), barEditCell.appendTo(n), r = $("<input type='text'>"), r.appendTo(barEditCell), r.addClass("ticker"), u = [ToFloatTransformer(t.price.value())], this.bindControl(new SimpleStringBinder(i, t.price, u, !1, this.model(), "Change " + this._linetool + " point price")), u = [ToIntTransformer(t.bar.value()), GreateTransformer(-5e4), LessTransformer(15e3)], this.bindControl(new SimpleStringBinder(r, t.bar, u, !1, this.model(), "Change " + this._linetool + " point bar index")), n
};
_14.prototype.prepareLayout = function () {
    var r, i;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    for (var t = this._linetool.points(), u = t.size(), n = 0; n < t.size(); n++)r = t.item(n), i = this._linetool.properties().points[n], i && this._createPointRow(r, i, (n || 1 < u ? " " + (n + 1) : "") + "").appendTo(this._table);
    this.loadData()
};
_14.prototype.widget = function () {
    return this._table
};
inherit(D91, _49);
D91.prototype.prepareLayout = function () {
    var i, n, r;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = $("<tbody>").appendTo(this._table), u = this.createColorPicker(), n = this.addLabeledRow(t, "Color");
    $("<td>").append(u).appendTo(n);
    i = $('<select><option value="0">' + $.t("Bars") + '<\/option><option value="1">' + $.t("Line") + "<\/option><\/select>");
    n = this.addLabeledRow(t, "Mode");
    $("<td>").append(i).appendTo(n);
    n = $("<tr>").appendTo(t);
    $("<td>" + $.t("Mirrored") + "<\/td>").appendTo(n);
    r = $("<input type='checkbox'>");
    $("<td>").append(r).appendTo(n);
    n = $("<tr>").appendTo(t);
    $("<td>" + $.t("Flipped") + "<\/td>").appendTo(n);
    t = $("<input type='checkbox'>");
    $("<td>").append(t).appendTo(n);
    this.bindControl(new Q12(r, this._linetool.properties().mirrored, !0, this.model(), "Change Bars Pattern Mirroring"));
    this.bindControl(new Q12(t, this._linetool.properties().flipped, !0, this.model(), "Change Bars Pattern Flipping"));
    this.bindControl(new ColorBinding(u, this._linetool.properties().color, !0, this.model(), "Change Bars Pattern Color"));
    this.bindControl(new Q11(i, this._linetool.properties().mode, null, !0, this.model(), "Change Bars Pattern Mode"));
    this.loadData()
};
D91.prototype.widget = function () {
    return this._table
};
inherit(D90, _14);
D90.prototype.prepareLayout = function () {
    var t, i, n, r;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    this._linetool.points().item(0);
    t = $("<tr>");
    t.appendTo(this._table);
    i = $("<td>");
    i.html($.t("Price"));
    i.appendTo(t);
    n = $("<td>");
    n.appendTo(t);
    i = $("<input type='text'>");
    i.appendTo(n);
    n = $("<td>");
    n.html($.t("Bar #"));
    n.appendTo(t);
    barEditCell = $("<td>");
    barEditCell.appendTo(t);
    t = $("<input type='text'>");
    t.appendTo(barEditCell);
    t.addClass("ticker");
    n = this._linetool.properties().points[0];
    r = [ToFloatTransformer(n.price.value())];
    this.bindControl(new SimpleStringBinder(i, n.price, r, !1, this.model(), "Change " + this._linetool + " point price"));
    r = [ToIntTransformer(n.bar.value()), GreateTransformer(-5e3), LessTransformer(15e3)];
    this.bindControl(new SimpleStringBinder(t, n.bar, r, !1, this.model(), "Change " + this._linetool + " point bar index"));
    this.loadData()
};
inherit(D93, _49);
D93.prototype.prepareLayout = function () {
    var n = this.createColorPicker(), e = this.createFontSizeEditor(), o = this.createFontEditor(), t = this.createTextEditor(350, 200), i = this.createColorPicker(), s = TradingView.createTransparencyEditor(i), h = TradingView.createLineWidthEditor(), c = this.createColorPicker(), r = $('<input type="checkbox">'), l = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), a = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    this.bindControl(new ColorBinding(n, this._linetool.properties().color, !0, this.model(), "Change Text Color"));
    this.bindControl(new Q11(e, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(o, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().text, null, !0, this.model(), "Change Text"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Text Background"));
    this.bindControl(new SliderBinder(s, this._linetool.properties().transparency, !0, this.model(), "Change Text Background Transparency"));
    this.bindControl(new ColorBinding(c, this._linetool.properties().bordercolor, !0, this.model(), "Change Text Color"));
    this.bindControl(new SliderBinder(h, this._linetool.properties().linewidth, !0, this.model(), "Change Border Width"));
    this.bindControl(new Q12(r, this._linetool.properties().wordWrap, !0, this.model(), "Change Text Wrap"));
    this.bindControl(new Q12(l, this._linetool.properties().bold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(a, this._linetool.properties().italic, !0, this.model(), "Change Text Font Italic"));
    var u = $('<table class="property-page" cellspacing="0" cellpadding="2">').data("layout-tab-open", EditObjectDialog.TAB_OPEN_OVERRIDE), v = $('<table class="property-page" cellspacing="0" cellpadding="2">'), f = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._table = u.add(f).add(v);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({width: 1}).append(n)).append($(document.createElement("td")).attr({width: 1}).append(o)).append($(document.createElement("td")).attr({width: 1}).append(e)).append($(document.createElement("td")).attr({width: 1}).append(l)).append($(document.createElement("td")).append(a)).appendTo(u);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({colspan: 5}).append(t)).appendTo(u);
    n = this.addLabeledRow(v, "Text Wrap", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(f, "Background");
    $("<td>").append(i).appendTo(n);
    $("<td>").append(s).appendTo(n);
    n = this.addLabeledRow(f, "Border");
    $("<td>").append(c).appendTo(n);
    $("<td>").append(h).appendTo(n);
    this.loadData();
    setTimeout(function () {
        t.select();
        t.focus()
    }, 20)
};
D93.prototype.widget = function () {
    return this._table
};
inherit(_32, _49);
_32.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var n = $("<tbody>").appendTo(this._table), u = TradingView.createLineWidthEditor(), f = TradingView.createLineStyleEditor(), e = this.createColorPicker(), n = this.addLabeledRow(n, $.t("Line"));
    $("<td>").append(e).appendTo(n);
    $("<td>").append(u).appendTo(n);
    $('<td colspan="3">').append(f.render()).appendTo(n);
    var t = $("<tbody>").appendTo(this._table), i = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), v = $('<input type="checkbox">').appendTo(i), r = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), y = $('<input type="checkbox">').appendTo(r), o = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), s = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), n = this.addLabeledRow(t, $.t("Left End"));
    $('<td colspan="3">').appendTo(n).append(o).append(i);
    n = this.addLabeledRow(t, $.t("Right End"));
    $('<td colspan="3">').appendTo(n).append(s).append(r);
    n = this.addLabeledRow(t, $.t("Stats Text Color"));
    i = this.createColorPicker();
    $("<td>").append(i).appendTo(n);
    this.bindControl(new ColorBinding(i, this._linetool.properties().textcolor, !0, this.model(), $.t("Change Text Color")));
    i = $('<input type="checkbox">');
    $('<input type="checkbox">');
    var r = $('<input type="checkbox">'), h = $('<input type="checkbox">'), c = $('<input type="checkbox">'), l = $('<input type="checkbox">'), a = $('<input type="checkbox">'), n = this.addLabeledRow(t, $.t("Show Price Range"));
    $('<td colspan="3">').appendTo(n).append(i);
    n = this.addLabeledRow(t, $.t("Show Bars Range"));
    $('<td colspan="3">').appendTo(n).append(r);
    n = this.addLabeledRow(t, $.t("Show Date/Time Range"));
    $('<td colspan="3">').appendTo(n).append(h);
    n = this.addLabeledRow(t, $.t("Show Distance"));
    $('<td colspan="3">').appendTo(n).append(c);
    n = this.addLabeledRow(t, $.t("Show Angle"));
    $('<td colspan="3">').appendTo(n).append(l);
    n = this.addLabeledRow(t, $.t("Always Show Stats"));
    $('<td colspan="3">').appendTo(n).append(a);
    this.bindControl(new Q12(v, this._linetool.properties().extendLeft, !0, this.model(), $.t("Change Trend Line Extending Left")));
    this.bindControl(new Q12(y, this._linetool.properties().extendRight, !0, this.model(), $.t("Change Trend Line Extending Right")));
    this.bindControl(new ColorBinding(e, this._linetool.properties().linecolor, !0, this.model(), $.t("Change Trend Line Color")));
    this.bindControl(new Q11(f, this._linetool.properties().linestyle, parseInt, !0, this.model(), $.t("Change Trend Line Style")));
    this.bindControl(new SliderBinder(u, this._linetool.properties().linewidth, !0, this.model(), $.t("Change Trend Line Width")));
    this.bindControl(new Q11(o, this._linetool.properties().leftEnd, parseInt, !0, this.model(), $.t("Change Trend Line Left End")));
    this.bindControl(new Q11(s, this._linetool.properties().rightEnd, parseInt, !0, this.model(), $.t("Change Trend Line Right End")));
    this.bindControl(new Q12(i, this._linetool.properties().showPriceRange, !0, this.model(), $.t("Change Trend Line Show Price Range")));
    this.bindControl(new Q12(r, this._linetool.properties().showBarsRange, !0, this.model(), $.t("Change Trend Line Show Bars Range")));
    this.bindControl(new Q12(h, this._linetool.properties().showDateTimeRange, !0, this.model(), $.t("Change Trend Line Show Date/Time Range")));
    this.bindControl(new Q12(c, this._linetool.properties().showDistance, !0, this.model(), "Change Trend Line Show Distance"));
    this.bindControl(new Q12(l, this._linetool.properties().showAngle, !0, this.model(), $.t("Change Trend Line Show Angle")));
    this.bindControl(new Q12(a, this._linetool.properties().alwaysShowStats, !0, this.model(), $.t("Change Trend Line Always Show Stats")));
    this.loadData()
};
_32.prototype.widget = function () {
    return this._table
};
inherit(_12, _49);
_12.prototype.prepareLayout = function () {
    var t, i, r, u, f, n;
    this._res = $("<div>");
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2" style="width:100%"><\/table>').appendTo(this._res);
    var e = TradingView.createLineWidthEditor(), o = TradingView.createLineStyleEditor(), s = this.createColorPicker(), n = this.addLabeledRow(this._table, "Line");
    $("<td>").append(s).appendTo(n);
    $("<td>").append(e).appendTo(n);
    $('<td colspan="3">').append(o.render().css("display", "block")).appendTo(n);
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = $("<tr>").appendTo(this._table);
    $('<td colspan="3">').append($("<label>").append(t).append($.t("Show Price"))).prependTo(n);
    i = $("<input type='checkbox'>");
    n = $("<tr>").appendTo(this._table);
    $('<td colspan="3">').append($("<label>").append(i).append($.t("Show Text"))).prependTo(n);
    var n = this.addLabeledRow(this._table, "Text:"), h = this.createColorPicker(), c = this.createFontSizeEditor(), l = this.createFontEditor(), a = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), v = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    $("<td>").append(h).appendTo(n);
    $("<td>").append(l).appendTo(n);
    $("<td>").append(c).appendTo(n);
    $("<td>").append(a).appendTo(n);
    $("<td>").append(v).appendTo(n);
    n = $("<tr>").appendTo(this._table);
    $("<td colspan='2'>").append($.t("Text Alignment:")).appendTo(n);
    r = $("<select><option value='left'>" + $.t("left") + "<\/option><option value='center'>" + $.t("center") + "<\/option><option value='right'>" + $.t("right") + "<\/option><\/select>");
    u = $("<select><option value='bottom'>" + $.t("top") + "<\/option><option value='middle'>" + $.t("middle") + "<\/option><option value='top'>" + $.t("bottom") + "<\/option><\/select>").data("selectbox-css", {display: "block"});
    $("<td>").append(r).appendTo(n);
    $("<td colspan='3'>").append(u).appendTo(n);
    f = $("<textarea rows='7' cols='60'>").css("width", "100%");
    n = $("<tr>").appendTo(this._table);
    $("<td colspan='7'>").append(f).appendTo(n);
    this.bindControl(new Q12(i, this._linetool.properties().showLabel, !0, this.model(), "Change Horz Line Text Visibility"));
    this.bindControl(new Q11(r, this._linetool.properties().horzLabelsAlign, null, !0, this.model(), "Change Horz Line Labels Alignment"));
    this.bindControl(new Q11(u, this._linetool.properties().vertLabelsAlign, null, !0, this.model(), "Change Horz Line Labels Alignment"));
    this.bindControl(new SimpleStringBinder(f, this._linetool.properties().text, null, !0, this.model(), "Change Text"));
    this.bindControl(new Q12(t, this._linetool.properties().showPrice, !0, this.model(), "Change Horz Line Price Visibility"));
    this.bindControl(new ColorBinding(s, this._linetool.properties().linecolor, !0, this.model(), "Change Horz Line Color"));
    this.bindControl(new Q11(o, this._linetool.properties().linestyle, parseInt, !0, this.model(), "Change Horz Line Style"));
    this.bindControl(new SliderBinder(e, this._linetool.properties().linewidth, !0, this.model(), "Change Horz Line Width"));
    this.bindControl(new Q11(c, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(l, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new ColorBinding(h, this._linetool.properties().textcolor, !0, this.model(), "Change Text Color"));
    this.bindControl(new Q12(a, this._linetool.properties().bold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(v, this._linetool.properties().italic, !0, this.model(), "Change Text Font Italic"));
    this.loadData()
};
_12.prototype.widget = function () {
    return this._res
};
inherit(_11, _14);
_11.prototype.prepareLayout = function () {
    var t, n, i;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._linetool.points().item(0) && (t = $('<input type="text">'), n = $("<tr>").appendTo(this._table), $("<td>" + $.t("Price") + "<\/td>").appendTo(n), $("<td>").append(t).appendTo(n), n = this._linetool.properties().points[0], i = [ToFloatTransformer(n.price.value())], this.bindControl(new SimpleStringBinder(t, n.price, i, !1, this.model(), "Change " + this._linetool + " point price")), this.loadData())
};
inherit(_36, _49);
_36.prototype.prepareLayout = function () {
    var t, n;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var i = TradingView.createLineWidthEditor(), r = TradingView.createLineStyleEditor(), u = this.createColorPicker(), n = this.addLabeledRow(this._table, "Line");
    $("<td>").prependTo(n);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r.render()).appendTo(n);
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = $("<tr>").appendTo(this._table);
    $("<td>").append(t).prependTo(n);
    this.createLabeledCell(2, "Show Time", t).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showTime, !0, this.model(), "Change Vert Line Time Visibility"));
    this.bindControl(new ColorBinding(u, this._linetool.properties().linecolor, !0, this.model(), "Change Vert Line Color"));
    this.bindControl(new Q11(r, this._linetool.properties().linestyle, parseInt, !0, this.model(), "Change Vert Line Style"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().linewidth, !0, this.model(), "Change Vert Line Width"));
    this.loadData()
};
_36.prototype.widget = function () {
    return this._table
};
inherit(_35, _14);
_35.prototype.prepareLayout = function () {
    var t, n, i;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._linetool.points().item(0) && (t = $('<input type="text" class="ticker">'), n = $("<tr>").appendTo(this._table), $("<td>" + $.t("Bar #") + "<\/td>").appendTo(n), $("<td>").append(t).appendTo(n), n = this._linetool.properties().points[0], i = [ToIntTransformer(n.bar.value()), GreateTransformer(-5e3), LessTransformer(15e3)], this.bindControl(new SimpleStringBinder(t, n.bar, i, !1, this.model(), "Change " + this._linetool + " point bar index")), this.loadData())
};
inherit(_18, _49);
_18.prototype.onResoreDefaults = function () {
    this._linetool.properties().style.listeners().fire(this._linetool.properties().style)
};
_18.prototype.addLevelEditor = function (n, t, i) {
    var u, r;
    i = $("<tr>");
    i.appendTo(this._table);
    n ? (u = $("<td>"), u.appendTo(i), n = $("<input type='checkbox' class='visibility-switch'>"), n.appendTo(u), u = $("<td>"), u.appendTo(i), r = $("<input type='text'>"), r.appendTo(u), r.css("width", "70px"), this.bindControl(new Q12(n, t.visible, !0, this.model(), "Change Pitchfork Line Visibility")), this.bindControl(new SimpleStringBinder(r, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : ($("<td><\/td>").appendTo(i), $("<td>" + $.t("Median") + "<\/td>").appendTo(i));
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(i);
    n = TradingView.addColorPicker(n);
    r = $("<td>");
    r.appendTo(i);
    u = TradingView.createLineWidthEditor();
    u.appendTo(r);
    r = $("<td>");
    r.appendTo(i);
    i = TradingView.createLineStyleEditor();
    i.render().appendTo(r);
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(i, t.linestyle, parseInt, !0, this.model(), "Change Pitchfork Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, !0, this.model(), "Change Pitchfork Line Width"))
};
_18.prototype.prepareLayout = function () {
    var t, i, r, n;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().median, !1), n = 0; 8 >= n; n++)t = "level" + n, this.addLevelEditor($.t("Level {0}").format(n + 1), this._linetool.properties()[t], !1);
    n = $("<tr>");
    n.appendTo(this._table);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    this.createLabeledCell("Background", t).appendTo(n);
    i = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(i).appendTo(n);
    r = $("<select><option value='0'>" + $.t("Original") + "<\/option><option value='3'>" + $.t("Schiff") + "<\/option><option value='1'>" + $.t("Modified Schiff") + "<\/option><option value='2'>" + $.t("Inside") + "<\/option><\/select>");
    n = $("<tr>");
    n.appendTo(this._table);
    $("<td>" + $.t("Style") + "<\/td>").appendTo(n);
    $("<td>").append(r).appendTo(n);
    this.bindControl(new Q11(r, this._linetool.properties().style, parseInt, !0, this.model(), "Change Pitchfork Style"));
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Pitchfork Background Visibility"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().transparency, !0, this.model(), "Change Pitchfork Background Transparency"));
    this.loadData()
};
_18.prototype.widget = function () {
    return this._table
};
inherit(_17, _49);
_17.prototype.addLevelEditor = function (n, t, i) {
    var u, r;
    i = $("<tr>");
    i.appendTo(this._table);
    n ? (u = $("<td>"), u.appendTo(i), n = $("<input type='checkbox' class='visibility-switch'>"), n.appendTo(u), u = $("<td>"), u.appendTo(i), r = $("<input type='text'>"), r.appendTo(u), r.css("width", "70px"), this.bindControl(new Q12(n, t.visible, !0, this.model(), "Change Pitchfork Line Visibility")), this.bindControl(new SimpleStringBinder(r, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : $("<td colspan='2'>" + $.t("Median") + "<\/td>").appendTo(i);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(i);
    n = TradingView.addColorPicker(n);
    r = $("<td>");
    r.appendTo(i);
    u = TradingView.createLineWidthEditor();
    u.appendTo(r);
    r = $("<td>");
    r.appendTo(i);
    i = TradingView.createLineStyleEditor();
    i.render().appendTo(r);
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(i, t.linestyle, parseInt, !0, this.model(), "Change Pitchfan Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, !0, this.model(), "Change Pitchfan Line Width"))
};
_17.prototype.prepareLayout = function () {
    var n, t, i;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().median, !1), n = 0; 8 >= n; n++)t = "level" + n, this.addLevelEditor("Level " + (n + 1), this._linetool.properties()[t], !1);
    n = $("<tr>");
    n.appendTo(this._table);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    this.createLabeledCell("Background", t).appendTo(n);
    i = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(i).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Pitchfan Background Visibility"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().transparency, !0, this.model(), "Change Pitchfan Background Transparency"));
    this.loadData()
};
_17.prototype.widget = function () {
    return this._table
};
LineToolTextInplaceEditor.prototype.attachSource = function (n, t) {
    this.J99 = n;
    this._edit = $("<textarea>");
    this._edit.css("width", "300");
    this._edit.css("height", "150");
    this._edit.appendTo(this.Q4._jqMainDiv);
    TradingView.setAbsolutePos(this._edit, t);
    this._edit.val(n.properties().text.value());
    this._edit.focus();
    var i = this._edit;
    return i.select(), this._binding = new SimpleStringBinder(i, n.properties().text, null, !0, this._undoModel, "change line tool text"), this._edit.focusout(function () {
        n.properties().text.setValue(i.val())
    }), this._edit.mousedown(function () {
        return!0
    }), i
};
inherit(_27, _49);
_27.prototype.prepareLayout = function () {
    var n = this.createColorPicker(), s = this.createColorPicker(), h = this.createFontSizeEditor(), c = this.createFontEditor(), t = this.createTextEditor(350, 200), i = this.createColorPicker(), l = TradingView.createTransparencyEditor(i), r = $('<input type="checkbox" class="visibility-switch">'), u = $('<input type="checkbox" class="visibility-switch">'), f = $('<input type="checkbox">'), a = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), v = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    this.bindControl(new ColorBinding(n, this._linetool.properties().color, !0, this.model(), $.t("Change Text Color")));
    this.bindControl(new Q11(h, this._linetool.properties().fontsize, parseInt, !0, this.model(), $.t("Change Text Font Size")));
    this.bindControl(new Q11(c, this._linetool.properties().font, null, !0, this.model(), $.t("Change Text Font")));
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().text, null, !0, this.model(), $.t("Change Text")));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), $.t("Change Text Background")));
    this.bindControl(new SliderBinder(l, this._linetool.properties().backgroundTransparency, !0, this.model(), $.t("Change Text Background Transparency")));
    this.bindControl(new Q12(r, this._linetool.properties().fillBackground, !0, this.model(), $.t("Change Text Background Fill")));
    this.bindControl(new Q12(u, this._linetool.properties().drawBorder, !0, this.model(), $.t("Change Text Border")));
    this.bindControl(new ColorBinding(s, this._linetool.properties().borderColor, !0, this.model(), $.t("Change Text Border Color")));
    this.bindControl(new Q12(f, this._linetool.properties().wordWrap, !0, this.model(), $.t("Change Text Wrap")));
    this.bindControl(new Q12(a, this._linetool.properties().bold, !0, this.model(), $.t("Change Text Font Bold")));
    this.bindControl(new Q12(v, this._linetool.properties().italic, !0, this.model(), $.t("Change Text Font Italic")));
    var e = $('<table class="property-page" cellspacing="0" cellpadding="2">'), y = $('<table class="property-page" cellspacing="0" cellpadding="2">'), o = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._table = e.add(o).add(y);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({width: 1}).append(n)).append($(document.createElement("td")).attr({width: 1}).append(c)).append($(document.createElement("td")).attr({width: 1}).append(h)).append($(document.createElement("td")).attr({width: 1}).append(a)).append($(document.createElement("td")).append(v)).appendTo(e);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({colspan: 5}).append(t)).appendTo(e);
    n = this.addLabeledRow(y, $.t("Text Wrap"), f);
    $("<td>").append(f).prependTo(n);
    n = this.addLabeledRow(o, $.t("Background"), r);
    $("<td>").append(r).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(l).appendTo(n);
    n = this.addLabeledRow(o, $.t("Border"), u);
    $("<td>").append(u).prependTo(n);
    $("<td>").append(s).appendTo(n);
    this.loadData();
    setTimeout(function () {
        t.select();
        t.focus()
    }, 20)
};
_27.prototype.widget = function () {
    return this._table
};
_27.prototype.dialogPosition = function (n, t) {
    var e = 0, i = this._linetool, s = i.Q0.paneForSource(i), r;
    $.each(this.Q0.Q4._paneWidgets, function (n, t) {
        if (t._state == s)return e = $(t.canvas).offset().top, !1
    });
    n || (n = {});
    var o = n.left, f = n.top, u = this._linetool.paneViews().item(0);
    return u && (r = u._floatPoints.item(0)), r && (o = r.x, f = r.y + e), u = $(t).outerHeight(), r = $(window).height(), i = i.properties().fontsize.value(), {top: f + u + i + 5 <= r ? f + i + 5 : f - u - 5, left: o}
};
inherit(_23, _49);
_23.prototype.prepareLayout = function () {
    function u() {
        r.slider("option", "disabled", !o.value())
    }

    var o;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var f = TradingView.createLineWidthEditor(), e = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(f).appendTo(n);
    var t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    o = this._linetool.properties().fillBackground;
    u();
    this._linetool.properties().fillBackground.subscribe(null, u);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Rectangle Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Rectangle Line Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Rectangle Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().linewidth, !0, this.model(), "Change Rectangle Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Rectangle Background Transparency"));
    this.loadData()
};
_23.prototype.widget = function () {
    return this._table
};
inherit(D98, _49);
D98.prototype.prepareLayout = function () {
    function u() {
        r.slider("option", "disabled", !o.value())
    }

    var o;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var f = TradingView.createLineWidthEditor(), e = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(f).appendTo(n);
    var t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    o = this._linetool.properties().fillBackground;
    u();
    this._linetool.properties().fillBackground.subscribe(null, u);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Ellipse Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Ellipse Line Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Ellipse Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().linewidth, !0, this.model(), "Change Ellipse Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Ellipse Background Transparency"));
    this.loadData()
};
D98.prototype.widget = function () {
    return this._table
};
inherit(D87, _49);
D87.prototype.prepareLayout = function () {
    function u() {
        r.slider("option", "disabled", !o.value())
    }

    var o;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var f = TradingView.createLineWidthEditor(), e = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(f).appendTo(n);
    var t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    o = this._linetool.properties().fillBackground;
    u();
    this._linetool.properties().fillBackground.subscribe(null, u);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Arc Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Arc Line Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Arc Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().linewidth, !0, this.model(), "Change Arc Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Arc Background Transparency"));
    this.loadData()
};
D87.prototype.widget = function () {
    return this._table
};
inherit(_34, _49);
_34.prototype.prepareLayout = function () {
    function u() {
        r.slider("option", "disabled", !o.value())
    }

    var o;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var f = TradingView.createLineWidthEditor(), e = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(f).appendTo(n);
    var t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    o = this._linetool.properties().fillBackground;
    u();
    this._linetool.properties().fillBackground.subscribe(null, u);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Triangle Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Triangle Line Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Triangle Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().linewidth, !0, this.model(), "Change Triangle Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Triangle Background Transparency"));
    this.loadData()
};
_34.prototype.widget = function () {
    return this._table
};
inherit(_16, _49);
_16.prototype.prepareLayout = function () {
    var e;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var i = $("<tbody>").appendTo(this._table), s = TradingView.createLineWidthEditor(), h = TradingView.createLineStyleEditor(), c = this.createColorPicker(), n = $("<tr>").appendTo(i);
    $("<td><\/td><td>" + $.t("Channel") + "<\/td>").appendTo(n);
    $("<td>").append(c).appendTo(n);
    $("<td>").append(s).appendTo(n);
    $("<td>").append(h.render()).appendTo(n);
    var n = $("<tr>").appendTo(i), u = $("<td>").appendTo(n), f = $("<input type='checkbox' class='visibility-switch'>");
    f.appendTo(u);
    this.createLabeledCell("Middle", f).appendTo(n);
    var u = TradingView.createLineWidthEditor(), l = TradingView.createLineStyleEditor(), a = this.createColorPicker();
    $("<td>").append(a).appendTo(n);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(l.render()).appendTo(n);
    var n = $("<tr>").appendTo(i), r = $("<td>").appendTo(n), i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(r);
    this.createLabeledCell("Background", i).appendTo(n);
    r = this.createColorPicker();
    $("<td>").append(r).appendTo(n);
    e = TradingView.createTransparencyEditor(r);
    $('<td colspan="2">').append(e).appendTo(n);
    var o = $("<tbody>").appendTo(this._table), n = this.addEditorRow(o, "Extend Left", $("<input type='checkbox'>"), 2), o = this.addEditorRow(o, "Extend Right", $("<input type='checkbox'>"), 2), t = this._linetool.properties();
    this.bindControl(new Q12(i, t.fillBackground, !0, this.model(), "Change Parallel Channel Fill Background"));
    this.bindControl(new Q12(f, t.showMidline, !0, this.model(), "Change Parallel Channel Show Center Line"));
    this.bindControl(new Q12(n, t.extendLeft, !0, this.model(), "Change Parallel Channel Extending Left"));
    this.bindControl(new Q12(o, t.extendRight, !0, this.model(), "Change Parallel Channel Extending Right"));
    this.bindControl(new ColorBinding(c, t.linecolor, !0, this.model(), "Change Parallel Channel Color"));
    this.bindControl(new Q11(h, t.linestyle, parseInt, !0, this.model(), "Change Parallel Channel Style"));
    this.bindControl(new SliderBinder(s, t.linewidth, !0, this.model(), "Change Parallel Channel Width"));
    this.bindControl(new ColorBinding(a, t.midlinecolor, !0, this.model(), "Change Parallel Channel Middle Color"));
    this.bindControl(new Q11(l, t.midlinestyle, parseInt, !0, this.model(), "Change Parallel Channel Middle Style"));
    this.bindControl(new SliderBinder(u, t.midlinewidth, !0, this.model(), "Change Parallel Channel Middle Width"));
    this.bindControl(new ColorBinding(r, t.backgroundColor, !0, this.model(), "Change Parallel Channel Back Color"));
    this.bindControl(new SliderBinder(e, t.transparency, !0, this.model(), "Change Parallel Channel Background Transparency"));
    this.loadData()
};
_16.prototype.widget = function () {
    return this._table
};
inherit(D88, _49);
D88.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">').css({width: "100%"});
    var t = $("<input type='text'>").css({width: "100%"}), u = $('<div class="property-page-fullwidth-wrapper">').append(t), i = this.createColorPicker(), r = this.createFontEditor(), n = $("<tr>").appendTo(this._table);
    $("<td>").css({width: "0"}).html($.t("Text")).appendTo(n);
    $('<td colspan="2">').append(u).appendTo(n);
    n = this.addLabeledRow(this._table, "Text Font");
    n.children().css({whiteSpace: "nowrap"});
    $("<td>").append(i).appendTo(n).css({width: "0"});
    $("<td>").append(r).appendTo(n);
    this.bindControl(new ColorBinding(i, this._linetool.properties().color, !0, this.model(), "Change Arrow Mark Text Color"));
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().text, null, !0, this.model(), "Change Arrow Mark Text"));
    this.bindControl(new Q11(r, this._linetool.properties().font, null, !0, this.model(), "Change Arrow Mark Font"));
    this.loadData();
    setTimeout(function () {
        t.select();
        t.focus()
    }, 20)
};
D88.prototype.widget = function () {
    return this._table
};
inherit(_21, _49);
_21.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var i = this.createColorPicker(), r = this.createColorPicker(), t = this.createColorPicker(), u = TradingView.createTransparencyEditor(t), n = this.addLabeledRow(this._table, "Text Color");
    $("<td>").append(i).appendTo(n);
    n = this.addLabeledRow(this._table, "Border Color");
    $("<td>").append(r).appendTo(n);
    n = this.addLabeledRow(this._table, "Background");
    $("<td>").append(t).appendTo(n);
    $("<td>").append(u).appendTo(n);
    this.bindControl(new ColorBinding(i, this._linetool.properties().color, !0, this.model(), "Change Price Text Color"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().borderColor, !0, this.model(), "Change Border Color"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().backgroundColor, !0, this.model(), "Change Background Color"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().transparency, !0, this.model(), "Change Background Transparency"));
    this.loadData()
};
_21.prototype.widget = function () {
    return this._table
};
inherit(D89, _49);
D89.prototype.prepareLayout = function () {
    var n = $('<table class="property-page" cellspacing="0" cellpadding="0">').css({width: "100%"}).data("layout-tab-open", EditObjectDialog.TAB_OPEN_OVERRIDE), i = $('<table class="property-page" cellspacing="0" cellpadding="0">');
    this._table = n.add(i);
    var u = this.createColorPicker(), f = this.createColorPicker(), r = this.createColorPicker(), e = TradingView.createTransparencyEditor(r), t = $("<input type='text'>").css({width: "100%"}), n = $("<tr>").appendTo(n), o = $('<div class="property-page-fullwidth-wrapper">').append(t);
    $("<td>").css({width: "0"}).append(u).appendTo(n);
    $("<td>").append(o).appendTo(n);
    n = this.addLabeledRow(i, "Background");
    $("<td>").appendTo(n).append(r);
    $("<td>").appendTo(n).append(e);
    n = this.addLabeledRow(i, "Border Color");
    $("<td>").appendTo(n).append(f);
    $("<td>");
    this.bindControl(new ColorBinding(u, this._linetool.properties().color, !0, this.model(), "Change Balooon Text Color"));
    this.bindControl(new ColorBinding(f, this._linetool.properties().borderColor, !0, this.model(), "Change Balloon Border Color"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().backgroundColor, !0, this.model(), "Change Balloon Background Color"));
    this.bindControl(new SliderBinder(e, this._linetool.properties().transparency, !0, this.model(), "Change Balloon Background Transparency"));
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().text, null, !0, this.model(), "Change Balloon Text"));
    this.loadData();
    setTimeout(function () {
        t.select();
        t.focus()
    }, 0)
};
D89.prototype.widget = function () {
    return this._table
};
inherit(D92, _49);
D92.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var r = TradingView.createLineWidthEditor(), u = this.createColorPicker(), t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), f = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Line");
    $("<td>").prependTo(n);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(r).appendTo(n);
    n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(f).appendTo(n);
    this.bindControl(new ColorBinding(u, this._linetool.properties().linecolor, !0, this.model(), "Change Brush Color"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().linewidth, !0, this.model(), "Change Brush Line Width"));
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Brush Filling"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Brush Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().transparency, !0, this.model(), "Change Brush Background Transparency"));
    this.loadData()
};
D92.prototype.widget = function () {
    return this._table
};
inherit(_20, _49);
_20.prototype.prepareLayout = function () {
    var n = $('<table class="property-page" cellspacing="0" cellpadding="2">'), r = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}), u = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._table = n.add(r).add(u);
    var f = this.createColorPicker(), e = TradingView.createLineWidthEditor(), n = this.addLabeledRow(n, "Line");
    $("<td>").append(f).appendTo(n);
    $("<td>").append(e).appendTo(n);
    var n = $("<tr>").appendTo(r), r = $("<td>").appendTo(n).css({"vertical-align": "top", width: "50%"}), n = $("<td>").appendTo(n).css({"vertical-align": "top", width: "50%"}), t = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo(r), i = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo(n), r = this.addColorPickerRow(t, "Source back color"), n = this.addColorPickerRow(t, "Source text color"), h = this.addColorPickerRow(t, "Source border color"), c = this.addColorPickerRow(t, "Success back color"), t = this.addColorPickerRow(t, "Success text color"), o = this.addColorPickerRow(i, "Target back color"), l = this.addColorPickerRow(i, "Target text color"), a = this.addColorPickerRow(i, "Target border color"), v = this.addColorPickerRow(i, "Failure back color"), i = this.addColorPickerRow(i, "Failure text color"), s = TradingView.createTransparencyEditor(o);
    this.addEditorRow(u, "Transparency", s);
    this.bindControl(new ColorBinding(f, this._linetool.properties().linecolor, !0, this.model(), "Forecast Line Color"));
    this.bindControl(new SliderBinder(e, this._linetool.properties().linewidth, !0, this.model(), "Forecast Line Width"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().sourceBackColor, !0, this.model(), "Forecast Source Background Color"));
    this.bindControl(new ColorBinding(h, this._linetool.properties().sourceStrokeColor, !0, this.model(), "Forecast Source Border Color"));
    this.bindControl(new ColorBinding(n, this._linetool.properties().sourceTextColor, !0, this.model(), "Forecast Source Text Color"));
    this.bindControl(new ColorBinding(o, this._linetool.properties().targetBackColor, !0, this.model(), "Forecast Target Background Color"));
    this.bindControl(new ColorBinding(a, this._linetool.properties().targetStrokeColor, !0, this.model(), "Forecast Target Border Color"));
    this.bindControl(new ColorBinding(l, this._linetool.properties().targetTextColor, !0, this.model(), "Forecast Target Text Color"));
    this.bindControl(new ColorBinding(c, this._linetool.properties().successBackground, !0, this.model(), "Forecast Success Back Color"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().successTextColor, !0, this.model(), "Forecast Success Text Color"));
    this.bindControl(new ColorBinding(v, this._linetool.properties().failureBackground, !0, this.model(), "Forecast Failure Back Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().failureTextColor, !0, this.model(), "Forecast Failure Text Color"));
    this.bindControl(new SliderBinder(s, this._linetool.properties().transparency, !0, this.model(), "Change Forecast Background Transparency"));
    this.loadData()
};
_20.prototype.widget = function () {
    return this._table
};
inherit(_19, _49);
_19.prototype.prepareLayout = function () {
    function u() {
        r.slider("option", "disabled", !o.value())
    }

    var o;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var f = TradingView.createLineWidthEditor(), e = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(f).appendTo(n);
    var t = $('<input type="checkbox" class="visibility-switch">'), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(i), n = this.addLabeledRow(this._table, "Background", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    o = this._linetool.properties().fillBackground;
    u();
    this._linetool.properties().fillBackground.subscribe(null, u);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Polyline Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().linecolor, !0, this.model(), "Change Polyline Line Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), "Change Polyline Background Color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().linewidth, !0, this.model(), "Change Polyline Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Polyline Background Transparency"));
    this.loadData()
};
_19.prototype.widget = function () {
    return this._table
};
inherit(_10, _49);
_10.prototype.addLevelEditor = function (n, t, i) {
    var r, u;
    t = $("<tr>");
    t.appendTo(n);
    r = $("<td>");
    r.appendTo(t);
    n = $("<input type='checkbox' class='visibility-switch'>");
    n.appendTo(r);
    r = $("<td>");
    r.appendTo(t);
    u = $("<input type='text'>");
    u.appendTo(r);
    u.css("width", "70px");
    this.bindControl(new Q12(n, i.visible, !0, this.model(), "Change Gann Square Line Visibility"));
    this.bindControl(new SimpleStringBinder(u, i.coeff, ToFloatTransformer(i.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"));
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(t);
    t = TradingView.addColorPicker(n);
    this.bindControl(new ColorBinding(t, i.color, !0, this.model(), "Change Gann Square Line Color"))
};
_10.prototype.prepareLayout = function () {
    var n, i, t, r;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page property-page-unpadded"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this._table.css({width: "100%"}), n = $("<tbody>").appendTo(this._table), i = $("<tr>"), i.appendTo(n), t = $('<td width="50%">'), t.appendTo(i), n = $('<td width="50%">'), n.appendTo(i), i = $('<table cellspacing="0" cellpadding="2">'), i.appendTo(t), i.addClass("property-page"), t = $('<table cellspacing="0" cellpadding="2">'), t.appendTo(n), t.addClass("property-page"), $("<tr><td align='center' colspan='4'>" + $.t("Price Levels") + "<\/td><\/tr>").appendTo(i), $("<tr><td align='center' colspan='4'>" + $.t("Time Levels") + "<\/td><\/tr>").appendTo(t), n = 1; 7 >= n; n++)r = "hlevel" + n, this.addLevelEditor(i, "Level " + n, this._linetool.properties()[r]);
    for (n = 1; 7 >= n; n++)r = "vlevel" + n, this.addLevelEditor(t, "Level " + n, this._linetool.properties()[r]);
    var t = $("<input type='checkbox' class='visibility-switch'>"), r = $("<input type='checkbox' class='visibility-switch'>"), u = $("<input type='checkbox' class='visibility-switch'>"), f = $("<input type='checkbox' class='visibility-switch'>"), o = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}), i = $("<tr>").appendTo(o), e = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(i)), i = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(i)), n = this.addLabeledRow(e, "Left Labels", t);
    $("<td>").append(t).prependTo(n);
    n = this.addLabeledRow(i, "Right Labels", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(e, "Top Labels", u);
    $("<td>").append(u).prependTo(n);
    n = this.addLabeledRow(i, "Bottom Labels", f);
    $("<td>").append(f).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showLeftLabels, !0, this.model(), "Change Gann Square Left Labels Visibility"));
    this.bindControl(new Q12(r, this._linetool.properties().showRightLabels, !0, this.model(), "Change Gann Square Right Labels Visibility"));
    this.bindControl(new Q12(u, this._linetool.properties().showTopLabels, !0, this.model(), "Change Gann Square Top Labels Visibility"));
    this.bindControl(new Q12(f, this._linetool.properties().showBottomLabels, !0, this.model(), "Change Gann Square Bottom Labels Visibility"));
    this._table = this._table.add(o);
    n = $("<tr>");
    n.appendTo(e);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    r = TradingView.createTransparencyEditor();
    $("<td>").append(r).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillHorzBackground, !0, this.model(), "Change Gann Square Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().horzTransparency, !0, this.model(), "Change Gann Square Background Transparency"));
    n = $("<tr>");
    n.appendTo(i);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    r = TradingView.createTransparencyEditor();
    $("<td>").append(r).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillVertBackground, !0, this.model(), "Change Gann Square Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().vertTransparency, !0, this.model(), "Change Gann Square Background Transparency"));
    this.loadData()
};
_10.prototype.widget = function () {
    return this._table
};
inherit(_8, _49);
_8.prototype.prepareLayout = function () {
    var t, f, u, r, e, o, n, i, s;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page property-page-unpadded");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    this._table.css({width: "100%"});
    t = $("<tr>");
    t.appendTo(this._table);
    f = this._linetool.properties();
    u = $("<table>");
    $("<td valign='top'>").append(u).appendTo(t);
    r = $("<tr>");
    $("<td colspan='3'>" + $.t("Levels") + "<\/td>").appendTo(r);
    r.appendTo(u);
    for (e in f.levels._childs)o = f.levels[e], n = $("<tr>"), n.appendTo(u), $("<td>" + e + "<\/td>").appendTo(n), r = $("<input type='checkbox' class='visibility-switch'>"), $("<td>").append(r).appendTo(n), i = $("<td class='colorpicker-cell'>"), i.appendTo(n), i = TradingView.addColorPicker(i), s = $("<td>"), s.appendTo(n), n = TradingView.createLineWidthEditor(), n.appendTo(s), this.bindControl(new Q12(r, o.visible, !0, this.model(), "Change Gann Line Visibility")), this.bindControl(new ColorBinding(i, o.color, !0, this.model(), "Change Gann Line Color")), this.bindControl(new SliderBinder(n, o.width, !0, this.model(), "Change Gann Line Width"));
    u = $("<table>");
    $("<td valign='top'>").append(u).appendTo(t);
    r = $("<tr>");
    $("<td colspan='4'>" + $.t("Fans") + "<\/td>").appendTo(r);
    r.appendTo(u);
    for (e in f.fanlines._childs)o = f.fanlines[e], n = $("<tr>"), n.appendTo(u), r = $("<input type='checkbox' class='visibility-switch'>"), $("<td>").append(r).appendTo(n), i = o.x.value() + "x" + o.y.value(), $("<td>" + i + "<\/td>").appendTo(n), i = $("<td class='colorpicker-cell'>"), i.appendTo(n), i = TradingView.addColorPicker(i), s = $("<td>"), s.appendTo(n), n = TradingView.createLineWidthEditor(), n.appendTo(s), this.bindControl(new Q12(r, o.visible, !0, this.model(), "Change Gann Line Visibility")), this.bindControl(new ColorBinding(i, o.color, !0, this.model(), "Change Gann Fan Color")), this.bindControl(new SliderBinder(n, o.width, !0, this.model(), "Change Gann Line Width"));
    u = $("<table>");
    $("<td valign='top'>").append(u).appendTo(t);
    t = $("<tr>");
    $("<td colspan='4'>" + $.t("Arcs") + "<\/td>").appendTo(t);
    t.appendTo(u);
    for (e in f.arcs._childs)t = f.arcs[e], n = $("<tr>"), n.appendTo(u), r = $("<input type='checkbox' class='visibility-switch'>"), $("<td>").append(r).appendTo(n), i = t.x.value() + "x" + t.y.value(), $("<td>" + i + "<\/td>").appendTo(n), i = $("<td class='colorpicker-cell'>"), i.appendTo(n), i = TradingView.addColorPicker(i), s = $("<td>"), s.appendTo(n), n = TradingView.createLineWidthEditor(), n.appendTo(s), this.bindControl(new Q12(r, t.visible, !0, this.model(), "Change Gann Line Visibility")), this.bindControl(new ColorBinding(i, t.color, !0, this.model(), "Change Gann Arc Color")), this.bindControl(new SliderBinder(n, t.width, !0, this.model(), "Change Gann Line Width"));
    t = $("<tbody>").appendTo(this._table);
    f = $('<input type="checkbox" class="visibility-switch">');
    e = TradingView.createTransparencyEditor();
    t = $("<tr>").appendTo(t);
    r = $("<table>");
    $('<td colspan="3">').append(r).appendTo(t);
    t = $("<tr>").appendTo(r);
    $("<td>" + $.t("Background") + "<\/td>").appendTo(t);
    $("<td>").append(f).appendTo(t);
    $("<td>").append(e).appendTo(t);
    this.bindControl(new Q12(f, this._linetool.properties().arcsBackground.fillBackground, !0, this.model(), "Change Gann Square Filling"));
    this.bindControl(new SliderBinder(e, this._linetool.properties().arcsBackground.transparency, !0, this.model(), "Change Gann Square Background Transparency"))
};
_8.prototype.widget = function () {
    return this._table
};
inherit(_9, _49);
_9.prototype.addLevelEditor = function (n, t, i, r) {
    var u = $("<tr>"), f;
    u.appendTo(this._tbody);
    r = "control-level-" + i + "-" + r;
    f = $("<td>");
    f.appendTo(u);
    i = $("<input type='checkbox' class='visibility-switch' id='" + r + "'>");
    i.appendTo(f);
    this.createLabeledCell(n).appendTo(u).find("label").attr("for", r);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(u);
    n = TradingView.addColorPicker(n);
    f = $("<td>");
    f.appendTo(u);
    r = TradingView.createLineWidthEditor();
    r.appendTo(f);
    f = $("<td>");
    f.appendTo(u);
    u = TradingView.createLineStyleEditor();
    u.render().appendTo(f);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Gann Fan Line Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Gann Fan Line Color"));
    this.bindControl(new Q11(u, t.linestyle, parseInt, !0, this.model(), "Change Gann Fan Line Style"));
    this.bindControl(new SliderBinder(r, t.linewidth, !0, this.model(), "Change Gann Fan Line Width"))
};
_9.prototype.prepareLayout = function () {
    var i = $('<table class="property-page" cellspacing="0" cellpadding="2">'), r = $('<table class="property-page" cellspacing="0" cellpadding="2">'), n;
    for (this._tbody = $("<tbody>").appendTo(i), n = 1; 9 >= n; n++) {
        var t = "level" + n, t = this._linetool.properties()[t], u = t.coeff1.value(), f = t.coeff2.value();
        this.addLevelEditor("<sup>" + u + "<\/sup>&frasl;<sub>" + f + "<\/sub>", t, u, f)
    }
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(r, "Labels", t);
    $("<td>").append(t).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showLabels, !0, this.model(), "Change Gann Fan Labels Visibility"));
    this._table = i.add(r);
    n = $("<tr>");
    n.appendTo(this._table);
    i = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(i).appendTo(n);
    this.createLabeledCell("Background", i).appendTo(n);
    r = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(r).appendTo(n);
    this.bindControl(new Q12(i, this._linetool.properties().fillBackground, !0, this.model(), "Change Pitchfan Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Pitchfan Background Transparency"));
    this.loadData()
};
_9.prototype.widget = function () {
    return this._table
};
inherit(D84, _49);
D84.prototype.addLevelEditor = function (n, t, i) {
    var u = $("<tr>"), f, r, e;
    u.appendTo(this._table);
    r = $("<td>");
    r.appendTo(u);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(r);
    n ? (r = $("<td>"), r.appendTo(u), f = $("<input type='text'>"), f.appendTo(r), f.css("width", "70px"), this.bindControl(new SimpleStringBinder(f, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(u);
    r = $("<td class='colorpicker-cell'>");
    r.appendTo(u);
    r = TradingView.addColorPicker(r);
    e = $("<td>");
    e.appendTo(u);
    f = TradingView.createLineWidthEditor();
    f.appendTo(e);
    n || (n = $("<td>"), n.appendTo(u), u = TradingView.createLineStyleEditor(), u.render().appendTo(n), this.bindControl(new Q11(u, t.linestyle, parseInt, !0, this.model(), "Change Fib Circle Style")));
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Fib Circle Visibility"));
    this.bindControl(new ColorBinding(r, t.color, !0, this.model(), "Change Fib Circle Line Color"));
    this.bindControl(new SliderBinder(f, t.linewidth, !0, this.model(), "Change Fib Circle Width"))
};
D84.prototype.prepareLayout = function () {
    var i, t, n, r;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().trendline, !1), n = 1; 11 >= n; n++)i = "level" + n, this.addLevelEditor("Level " + n, this._linetool.properties()[i], !1);
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(this._table, "Levels", t);
    $("<td>").append(t).prependTo(n);
    i = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(this._table, "Coeffs As Percents", i);
    $("<td>").append(i).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showCoeffs, !0, this.model(), "Change Fib Circle Levels Visibility"));
    n = $("<tr>");
    n.appendTo(this._table);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    this.createLabeledCell("Background", t).appendTo(n);
    r = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(r).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Pitchfork Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Pitchfork Background Transparency"));
    this.bindControl(new Q12(i, this._linetool.properties().coeffsAsPercents, !0, this.model(), "Change Fib Retracement Coeffs As Percents"));
    this.loadData()
};
D84.prototype.widget = function () {
    return this._table
};
inherit(_1, _49);
_1.prototype.addLevelEditor = function (n, t, i) {
    var r = $("<tr>"), u, f;
    r.appendTo(this._table);
    u = $("<td>");
    u.appendTo(r);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(u);
    n ? (n = $("<td>"), n.appendTo(r), u = $("<input type='text'>"), u.appendTo(n), u.css("width", "70px"), this.bindControl(new SimpleStringBinder(u, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(r);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(r);
    n = TradingView.addColorPicker(n);
    f = $("<td>");
    f.appendTo(r);
    u = TradingView.createLineWidthEditor();
    u.appendTo(f);
    f = $("<td>");
    f.appendTo(r);
    r = TradingView.createLineStyleEditor();
    r.render().appendTo(f);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Pitchfork Line Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(r, t.linestyle, parseInt, !0, this.model(), "Change Pitchfork Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, parseInt, this.model(), "Change Pitchfork Line Width"))
};
_1.prototype.prepareLayout = function () {
    var i, e;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().trendline, !1), i = 1; 11 >= i; i++)e = "level" + i, this.addLevelEditor("Level " + i, this._linetool.properties()[e], !1);
    var t = $("<input type='checkbox' class='visibility-switch'>"), r = $("<input type='checkbox' class='visibility-switch'>"), i = $("<input type='checkbox' class='visibility-switch'>"), e = $("<input type='checkbox' class='visibility-switch'>"), o = $("<input type='checkbox' class='visibility-switch'>"), u = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}), f = $("<tr>").appendTo(u), n = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(f)), f = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(f)), n = this.addLabeledRow(n, "Levels", t);
    $("<td>").append(t).prependTo(n);
    n = this.addLabeledRow(f, "Prices", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(this._table, "Extend Lines", i);
    $("<td>").append(i).prependTo(n);
    n = this.addLabeledRow(this._table, "Reverse", e);
    $("<td>").append(e).prependTo(n);
    n = this.addLabeledRow(this._table, "Coeffs As Percents", o);
    $("<td>").append(o).prependTo(n);
    this.bindControl(new Q12(r, this._linetool.properties().showPrices, !0, this.model(), "Change Gann Fan Prices Visibility"));
    this.bindControl(new Q12(t, this._linetool.properties().showCoeffs, !0, this.model(), "Change Gann Fan Levels Visibility"));
    t = $("<table cellspacing='0' cellpadding='0'>");
    r = $("<select><option value='left'>" + $.t("left") + "<\/option><option value='center'>" + $.t("center") + "<\/option><option value='right'>" + $.t("right") + "<\/option><\/select>");
    f = $("<select><option value='bottom'>" + $.t("top") + "<\/option><option value='middle'>" + $.t("middle") + "<\/option><option value='top'>" + $.t("bottom") + "<\/option><\/select>");
    n = $("<tr>");
    n.append("<td>" + $.t("Labels") + "<\/td>").append(r).append("<td>&nbsp<\/td>").append(f);
    n.appendTo(t);
    n = $("<tr>");
    $("<td colspan='5'>").append(t).appendTo(n);
    n.appendTo(this._table);
    this.bindControl(new Q11(r, this._linetool.properties().horzLabelsAlign, null, !0, this.model(), "Change Fib Retracement Labels Alignment"));
    this.bindControl(new Q11(f, this._linetool.properties().vertLabelsAlign, null, !0, this.model(), "Change Fib Retracement Labels Alignment"));
    this._table = this._table.add(u);
    n = $("<tr>");
    n.appendTo(this._table);
    u = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(u).appendTo(n);
    this.createLabeledCell("Background", u).appendTo(n);
    t = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(t).appendTo(n);
    this.bindControl(new Q12(u, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Retracement Background Visibility"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().transparency, !0, this.model(), "Change Fib Retracement Background Transparency"));
    this.bindControl(new Q12(i, this._linetool.properties().extendLines, !0, this.model(), "Change Fib Retracement Extend Lines"));
    this.bindControl(new Q12(e, this._linetool.properties().reverse, !0, this.model(), "Change Fib Retracement Reverse"));
    this.bindControl(new Q12(o, this._linetool.properties().coeffsAsPercents, !0, this.model(), "Change Fib Retracement Coeffs As Percents"));
    this.loadData()
};
_1.prototype.widget = function () {
    return this._table
};
inherit(D99, _49);
D99.prototype.addLevelEditor = function (n, t, i) {
    var r = $("<tr>"), u, f;
    r.appendTo(this._table);
    u = $("<td>");
    u.appendTo(r);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(u);
    n ? (n = $("<td>"), n.appendTo(r), u = $("<input type='text'>"), u.appendTo(n), u.css("width", "70px"), this.bindControl(new SimpleStringBinder(u, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(r);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(r);
    n = TradingView.addColorPicker(n);
    f = $("<td>");
    f.appendTo(r);
    u = TradingView.createLineWidthEditor();
    u.appendTo(f);
    f = $("<td>");
    f.appendTo(r);
    r = TradingView.createLineStyleEditor();
    r.render().appendTo(f);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Pitchfork Line Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(r, t.linestyle, parseInt, !0, this.model(), "Change Pitchfork Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, parseInt, this.model(), "Change Pitchfork Line Width"))
};
D99.prototype.prepareLayout = function () {
    var i, e;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), i = 1; 11 >= i; i++)e = "level" + i, this.addLevelEditor("Level " + i, this._linetool.properties()[e], !1);
    var t = $("<input type='checkbox' class='visibility-switch'>"), r = $("<input type='checkbox' class='visibility-switch'>"), i = $("<input type='checkbox' class='visibility-switch'>"), e = $("<input type='checkbox' class='visibility-switch'>"), o = $("<input type='checkbox' class='visibility-switch'>"), u = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}), f = $("<tr>").appendTo(u), n = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(f)), f = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(f)), n = this.addLabeledRow(n, "Levels", t);
    $("<td>").append(t).prependTo(n);
    n = this.addLabeledRow(f, "Prices", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(this._table, "Extend Left", i);
    $("<td>").append(i).prependTo(n);
    n = this.addLabeledRow(this._table, "Extend Right", e);
    $("<td>").append(e).prependTo(n);
    n = this.addLabeledRow(this._table, "Coeffs As Percents", o);
    $("<td>").append(o).prependTo(n);
    this.bindControl(new Q12(r, this._linetool.properties().showPrices, !0, this.model(), "Change Gann Fan Prices Visibility"));
    this.bindControl(new Q12(t, this._linetool.properties().showCoeffs, !0, this.model(), "Change Gann Fan Levels Visibility"));
    t = $("<table cellspacing='0' cellpadding='0'>");
    r = $("<select><option value='left'>" + $.t("left") + "<\/option><option value='center'>" + $.t("center") + "<\/option><option value='right'>" + $.t("right") + "<\/option><\/select>");
    f = $("<select><option value='bottom'>" + $.t("top") + "<\/option><option value='middle'>" + $.t("middle") + "<\/option><option value='top'>" + $.t("bottom") + "<\/option><\/select>");
    n = $("<tr>");
    n.append("<td>" + $.t("Labels") + "<\/td>").append(r).append("<td>&nbsp<\/td>").append(f);
    n.appendTo(t);
    n = $("<tr>");
    $("<td colspan='5'>").append(t).appendTo(n);
    n.appendTo(this._table);
    this.bindControl(new Q11(r, this._linetool.properties().horzLabelsAlign, null, !0, this.model(), "Change Fib Retracement Labels Alignment"));
    this.bindControl(new Q11(f, this._linetool.properties().vertLabelsAlign, null, !0, this.model(), "Change Fib Retracement Labels Alignment"));
    this._table = this._table.add(u);
    n = $("<tr>");
    n.appendTo(this._table);
    u = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(u).appendTo(n);
    this.createLabeledCell("Background", u).appendTo(n);
    t = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(t).appendTo(n);
    this.bindControl(new Q12(u, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Retracement Background Visibility"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().transparency, !0, this.model(), "Change Fib Retracement Background Transparency"));
    this.bindControl(new Q12(i, this._linetool.properties().extendLeft, !0, this.model(), "Change Fib Retracement Extend Lines"));
    this.bindControl(new Q12(e, this._linetool.properties().extendRight, !0, this.model(), "Change Fib Retracement Extend Lines"));
    this.bindControl(new Q12(o, this._linetool.properties().coeffsAsPercents, !0, this.model(), "Change Fib Retracement Coeffs As Percents"));
    this.loadData()
};
D99.prototype.widget = function () {
    return this._table
};
inherit(_30, _1);
inherit(_31, _49);
_31.prototype.addLevelEditor = function (n, t, i) {
    var r = $("<tr>"), u, f;
    r.appendTo(this._table);
    u = $("<td>");
    u.appendTo(r);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(u);
    n ? (n = $("<td>"), n.appendTo(r), u = $("<input type='text'>"), u.appendTo(n), u.css("width", "70px"), this.bindControl(new SimpleStringBinder(u, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(r);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(r);
    n = TradingView.addColorPicker(n);
    f = $("<td>");
    f.appendTo(r);
    u = TradingView.createLineWidthEditor();
    u.appendTo(f);
    f = $("<td>");
    f.appendTo(r);
    r = TradingView.createLineStyleEditor();
    r.render().appendTo(f);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Pitchfork Line Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(r, t.linestyle, parseInt, !0, this.model(), "Change Pitchfork Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, parseInt, this.model(), "Change Pitchfork Line Width"))
};
_31.prototype.prepareLayout = function () {
    var n, t;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().trendline, !1), n = 1; 11 >= n; n++)t = "level" + n, this.addLevelEditor("Level " + n, this._linetool.properties()[t], !1);
    n = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"});
    n = $("<tr>").appendTo(n);
    $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(n));
    $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(n));
    n = $("<input type='checkbox' class='visibility-switch'>");
    t = this.addLabeledRow(this._table, "Show Labels", n);
    $("<td>").append(n).prependTo(t);
    var i = $("<table cellspacing='0' cellpadding='0'>"), r = $("<select><option value='left'>" + $.t("left") + "<\/option><option value='center'>" + $.t("center") + "<\/option><option value='right'>" + $.t("right") + "<\/option><\/select>"), u = $("<select><option value='top'>" + $.t("top") + "<\/option><option value='middle'>" + $.t("middle") + "<\/option><option value='bottom'>" + $.t("bottom") + "<\/option><\/select>"), t = $("<tr>");
    t.append("<td>" + $.t("Labels") + "<\/td>").append(r).append("<td>&nbsp<\/td>").append(u);
    t.appendTo(i);
    t = $("<tr>");
    $("<td colspan='5'>").append(i).appendTo(t);
    t.appendTo(this._table);
    this.bindControl(new Q11(r, this._linetool.properties().horzLabelsAlign, null, !0, this.model(), "Change Trend-Based Fib Time Labels Alignment"));
    this.bindControl(new Q11(u, this._linetool.properties().vertLabelsAlign, null, !0, this.model(), "Change Trend-Based Fib Time Labels Alignment"));
    t = $("<tr>");
    t.appendTo(this._table);
    i = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(i).appendTo(t);
    this.createLabeledCell("Background", i).appendTo(t);
    r = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(r).appendTo(t);
    this.bindControl(new Q12(i, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Retracement Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Fib Retracement Background Transparency"));
    this.bindControl(new Q12(n, this._linetool.properties().showCoeffs, !0, this.model(), "Change Fib Retracement Extend Lines"));
    this.loadData()
};
_31.prototype.widget = function () {
    return this._table
};
inherit(_3, _49);
_3.prototype.addLevelEditor = function (n, t, i) {
    var r, u;
    t = $("<tr>");
    t.appendTo(n);
    r = $("<td>");
    r.appendTo(t);
    n = $("<input type='checkbox' class='visibility-switch'>");
    n.appendTo(r);
    r = $("<td>");
    r.appendTo(t);
    u = $("<input type='text'>");
    u.appendTo(r);
    u.css("width", "70px");
    this.bindControl(new Q12(n, i.visible, !0, this.model(), "Change Gann Square Line Visibility"));
    this.bindControl(new SimpleStringBinder(u, i.coeff, ToFloatTransformer(i.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"));
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(t);
    t = TradingView.addColorPicker(n);
    this.bindControl(new ColorBinding(t, i.color, !0, this.model(), "Change Gann Square Line Color"))
};
_3.prototype.prepareLayout = function () {
    var n, i, t, r;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page property-page-unpadded"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this._table.css({width: "100%"}), n = $("<tbody>").appendTo(this._table), i = $("<tr>"), i.appendTo(n), t = $('<td width="50%">'), t.appendTo(i), n = $('<td width="50%">'), n.appendTo(i), i = $('<table cellspacing="0" cellpadding="2">'), i.appendTo(t), i.addClass("property-page"), t = $('<table cellspacing="0" cellpadding="2">'), t.appendTo(n), t.addClass("property-page"), $("<tr><td align='center' colspan='4'>" + $.t("Price Levels") + "<\/td><\/tr>").appendTo(i), $("<tr><td align='center' colspan='4'>" + $.t("Time Levels") + "<\/td><\/tr>").appendTo(t), n = 1; 7 >= n; n++)r = "hlevel" + n, this.addLevelEditor(i, "Level " + n, this._linetool.properties()[r]);
    for (n = 1; 7 >= n; n++)r = "vlevel" + n, this.addLevelEditor(t, "Level " + n, this._linetool.properties()[r]);
    var t = $("<input type='checkbox' class='visibility-switch'>"), r = $("<input type='checkbox' class='visibility-switch'>"), u = $("<input type='checkbox' class='visibility-switch'>"), f = $("<input type='checkbox' class='visibility-switch'>"), i = $('<table class="property-page property-page-unpadded" cellspacing="0" cellpadding="0">').css({width: "100%"}), n = $("<tr>").appendTo(i), e = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(n)), o = $('<table class="property-page" cellspacing="0" cellpadding="0">').appendTo($("<td>").css({width: "50%"}).appendTo(n)), n = this.addLabeledRow(e, "Left Labels", t);
    $("<td>").append(t).prependTo(n);
    n = this.addLabeledRow(o, "Right Labels", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(e, "Top Labels", u);
    $("<td>").append(u).prependTo(n);
    n = this.addLabeledRow(o, "Bottom Labels", f);
    $("<td>").append(f).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showLeftLabels, !0, this.model(), "Change Gann Square Left Labels Visibility"));
    this.bindControl(new Q12(r, this._linetool.properties().showRightLabels, !0, this.model(), "Change Gann Square Right Labels Visibility"));
    this.bindControl(new Q12(u, this._linetool.properties().showTopLabels, !0, this.model(), "Change Gann Square Top Labels Visibility"));
    this.bindControl(new Q12(f, this._linetool.properties().showBottomLabels, !0, this.model(), "Change Gann Square Bottom Labels Visibility"));
    r = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    u = TradingView.createLineWidthEditor();
    f = TradingView.createLineStyleEditor();
    e = this.createColorPicker();
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(r, "Grid", t);
    $("<td>").append(t).prependTo(n);
    $("<td>").append(e).appendTo(n);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(f.render()).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().grid.visible, !0, this.model(), "Change Fib Speed Resistance Fan Grid Visibility"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().grid.color, !0, this.model(), "Change Fib Speed Resistance Fan Grid Line Color"));
    this.bindControl(new Q11(f, this._linetool.properties().grid.linestyle, parseInt, !0, this.model(), "Change Fib Speed Resistance Fan Grid Line Style"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().grid.linewidth, !0, this.model(), "Change Fib Speed Resistance Fan Grid Line Width"));
    this._table = this._table.add(i).add(r);
    n = $("<tr>");
    n.appendTo(r);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    this.createLabeledCell("Background", t).appendTo(n);
    i = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(i).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Speed/Resistance Fan Background Visibility"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().transparency, !0, this.model(), "Change Fib Speed/Resistance Fan Background Transparency"));
    this.loadData()
};
_3.prototype.widget = function () {
    return this._table
};
inherit(_2, _49);
_2.prototype.addLevelEditor = function (n, t, i) {
    var u = $("<tr>"), f, r, e;
    u.appendTo(this._table);
    r = $("<td>");
    r.appendTo(u);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(r);
    n ? (r = $("<td>"), r.appendTo(u), f = $("<input type='text'>"), f.appendTo(r), f.css("width", "70px"), this.bindControl(new SimpleStringBinder(f, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : $("<td>" + $.t("Trend Line") + "<\/td>").appendTo(u);
    r = $("<td class='colorpicker-cell'>");
    r.appendTo(u);
    r = TradingView.addColorPicker(r);
    e = $("<td>");
    e.appendTo(u);
    f = TradingView.createLineWidthEditor();
    f.appendTo(e);
    n || (n = $("<td>"), n.appendTo(u), u = TradingView.createLineStyleEditor(), u.render().appendTo(n), this.bindControl(new Q11(u, t.linestyle, parseInt, !0, this.model(), "Change Fib Speed Resistance Arcs Style")));
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Fib Speed Resistance Arcs Visibility"));
    this.bindControl(new ColorBinding(r, t.color, !0, this.model(), "Change Fib Speed Resistance Arcs Line Color"));
    this.bindControl(new SliderBinder(f, t.linewidth, !0, this.model(), "Change Fib Speed Resistance Arcs Width"))
};
_2.prototype.prepareLayout = function () {
    var n, t, i;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().trendline, !1), n = 1; 11 >= n; n++)t = "level" + n, this.addLevelEditor("Level " + n, this._linetool.properties()[t], !1);
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(this._table, "Levels");
    $("<td>").append(t).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showCoeffs, !0, this.model(), "Change Fib Speed Resistance Arcs Levels Visibility"));
    n = $("<tr>");
    n.appendTo(this._table);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    $("<td>" + $.t("Background") + "<\/td>").appendTo(n);
    i = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(i).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Arcs Background Visibility"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().transparency, !0, this.model(), "Change Fib Arcs Background Transparency"));
    this.loadData()
};
_2.prototype.widget = function () {
    return this._table
};
inherit(_4, _49);
_4.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var n = $("<tbody>").appendTo(this._table), t = TradingView.createLineWidthEditor(), i = TradingView.createLineStyleEditor(), r = this.createColorPicker(), n = this.addLabeledRow(n, "Line");
    $("<td>").append(r).appendTo(n);
    $("<td>").append(t).appendTo(n);
    $('<td colspan="3">').append(i.render()).appendTo(n);
    this.bindControl(new ColorBinding(r, this._linetool.properties().linecolor, !0, this.model(), "Change Fib Spiral Line Color"));
    this.bindControl(new Q11(i, this._linetool.properties().linestyle, parseInt, !0, this.model(), "Change Fib Spiral Line Style"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Fib Spiral Line Width"));
    this.loadData()
};
_4.prototype.widget = function () {
    return this._table
};
inherit(_5, _49);
_5.prototype.addLevelEditor = function (n, t, i) {
    var r = $("<tr>"), u, f;
    r.appendTo(this._table);
    u = $("<td>");
    u.appendTo(r);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(u);
    n ? (n = $("<td>"), n.appendTo(r), u = $("<input type='text'>"), u.appendTo(n), u.css("width", "70px"), this.bindControl(new SimpleStringBinder(u, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(r);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(r);
    n = TradingView.addColorPicker(n);
    f = $("<td>");
    f.appendTo(r);
    u = TradingView.createLineWidthEditor();
    u.appendTo(f);
    f = $("<td>");
    f.appendTo(r);
    r = TradingView.createLineStyleEditor();
    r.render().appendTo(f);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Pitchfork Line Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Pitchfork Line Color"));
    this.bindControl(new Q11(r, t.linestyle, parseInt, !0, this.model(), "Change Pitchfork Line Style"));
    this.bindControl(new SliderBinder(u, t.linewidth, parseInt, this.model(), "Change Pitchfork Line Width"))
};
_5.prototype.prepareLayout = function () {
    var t, u;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), t = 1; 11 >= t; t++)u = "level" + t, this.addLevelEditor("Level " + t, this._linetool.properties()[u], !1);
    var t = TradingView.createLineWidthEditor(), u = TradingView.createLineStyleEditor(), o = this.createColorPicker(), f = $("<input type='checkbox' class='visibility-switch'>"), n = this.addLabeledRow(this._table, "Show Labels", f);
    $("<td>").append(f).prependTo(n);
    var i = $("<table cellspacing='0' cellpadding='0'>"), r = $("<select><option value='left'>" + $.t("left") + "<\/option><option value='center'>" + $.t("center") + "<\/option><option value='right'>" + $.t("right") + "<\/option><\/select>"), e = $("<select><option value='top'>" + $.t("top") + "<\/option><option value='middle'>" + $.t("middle") + "<\/option><option value='bottom'>" + $.t("bottom") + "<\/option><\/select>"), n = $("<tr>");
    n.append("<td>" + $.t("Labels") + "<\/td>").append(r).append("<td>&nbsp<\/td>").append(e);
    n.appendTo(i);
    n = $("<tr>");
    $("<td colspan='5'>").append(i).appendTo(n);
    n.appendTo(this._table);
    this.bindControl(new Q11(r, this._linetool.properties().horzLabelsAlign, null, !0, this.model(), "Change Fib Time Zone Labels Alignment"));
    this.bindControl(new Q11(e, this._linetool.properties().vertLabelsAlign, null, !0, this.model(), "Change Fib Time Zone Labels Alignment"));
    n = $("<tr>");
    n.appendTo(this._table);
    i = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(i).appendTo(n);
    this.createLabeledCell("Background", i).appendTo(n);
    r = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(r).appendTo(n);
    this.bindControl(new Q12(f, this._linetool.properties().showLabels, !0, this.model(), "Change Fib Time Zone Labels Visibility"));
    this.bindControl(new ColorBinding(o, this._linetool.properties().linecolor, !0, this.model(), "Change Fib Time Zone Color"));
    this.bindControl(new Q11(u, this._linetool.properties().linestyle, parseInt, !0, this.model(), "Change Fib Time Zone Style"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Fib Time Zone Width"));
    this.bindControl(new Q12(i, this._linetool.properties().fillBackground, !0, this.model(), "Change Fib Retracement Background Visibility"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Fib Retracement Background Transparency"));
    this.loadData()
};
_5.prototype.widget = function () {
    return this._table
};
inherit(_6, _49);
_6.prototype.addLevelEditor = function (n, t, i) {
    var u = $("<tr>"), r;
    u.appendTo(this._table);
    r = $("<td>");
    r.appendTo(u);
    i = $("<input type='checkbox' class='visibility-switch'>");
    i.appendTo(r);
    n ? (n = $("<td>"), n.appendTo(u), r = $("<input type='text'>"), r.appendTo(n), r.css("width", "70px"), this.bindControl(new SimpleStringBinder(r, t.coeff, ToFloatTransformer(t.coeff.value()), !1, this.model(), "Change Pitchfork Line Coeff"))) : this.createLabeledCell("Trend Line", i).appendTo(u);
    n = $("<td class='colorpicker-cell'>");
    n.appendTo(u);
    n = TradingView.addColorPicker(n);
    r = $("<td>");
    r.appendTo(u);
    u = TradingView.createLineWidthEditor();
    u.appendTo(r);
    this.bindControl(new Q12(i, t.visible, !0, this.model(), "Change Fib Wedge Visibility"));
    this.bindControl(new ColorBinding(n, t.color, !0, this.model(), "Change Fib Wedge Line Color"));
    this.bindControl(new SliderBinder(u, t.linewidth, !0, this.model(), "Change Fib Wedge Width"))
};
_6.prototype.prepareLayout = function () {
    var n, t, i;
    for (this._table = $(document.createElement("table")), this._table.addClass("property-page"), this._table.attr("cellspacing", "0"), this._table.attr("cellpadding", "2"), this.addLevelEditor(null, this._linetool.properties().trendline, !1), n = 1; 11 >= n; n++)t = "level" + n, this.addLevelEditor("Level " + n, this._linetool.properties()[t], !1);
    t = $("<input type='checkbox' class='visibility-switch'>");
    n = this.addLabeledRow(this._table, "Levels", t);
    $("<td>").append(t).prependTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().showCoeffs, !0, this.model(), "Change Fib Wedge Levels Visibility"));
    n = $("<tr>");
    n.appendTo(this._table);
    t = $("<input type='checkbox' class='visibility-switch'>");
    $("<td>").append(t).appendTo(n);
    this.createLabeledCell("Background", t).appendTo(n);
    i = TradingView.createTransparencyEditor();
    $('<td colspan="3">').append(i).appendTo(n);
    this.bindControl(new Q12(t, this._linetool.properties().fillBackground, !0, this.model(), "Change Wedge Background Visibility"));
    this.bindControl(new SliderBinder(i, this._linetool.properties().transparency, !0, this.model(), "Change Wedge Background Transparency"));
    this.loadData()
};
_6.prototype.widget = function () {
    return this._table
};
inherit(D94, _49);
D94.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = TradingView.createLineWidthEditor(), i = TradingView.createLineStyleEditor(), r = this.createColorPicker(), n = this.addLabeledRow(this._table, "Lines");
    $("<td>").append(r).appendTo(n);
    $("<td>").append(t).appendTo(n);
    $("<td>").append(i.render()).appendTo(n);
    this.bindControl(new ColorBinding(r, this._linetool.properties().linecolor, !0, this.model(), "Change Circle Lines Color"));
    this.bindControl(new Q11(i, this._linetool.properties().linestyle, parseInt, !0, this.model(), "Change Circle Lines Style"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Circle Lines Width"));
    this.loadData()
};
D94.prototype.widget = function () {
    return this._table
};
inherit(_24, _14);
_24.prototype.prepareLayout = function () {
    var r = $('<table class="property-page" cellspacing="0" cellpadding="0">'), f = $('<table class="property-page" cellspacing="0" cellpadding="0">').data({"layout-tab": EditObjectDialog.TAB_NAME_INPUTS, "layout-tab-priority": EditObjectDialog.TAB_PRIORITY_INPUTS}), u, t, n, i, e;
    for (this._table = r.add(f), u = this._linetool.points(), t = 0; t < u.size(); t++)u.item(t), n = $("<tr>"), n.appendTo(r), i = $("<td>"), i.html("Point " + (t + 1) + " Bar #"), i.appendTo(n), barEditCell = $("<td>"), barEditCell.appendTo(n), n = $("<input type='text'>"), n.appendTo(barEditCell), n.addClass("ticker"), i = this._linetool.properties().points[t], e = [ToIntTransformer(i.bar.value()), GreateTransformer(-5e3), LessTransformer(15e3)], this.bindControl(new SimpleStringBinder(n, i.bar, e, !1, this.model(), "Change " + this._linetool + " point bar index"));
    r = StudyMetaInfo.findStudyMetaInfo(this.Q0.studiesMetaData(), "RegressionTrend@tv-basicstudies");
    _41.prototype.prepareLayoutImpl.call(this, r, f)
};
_24.prototype.widget = function () {
    return this._table
};
inherit(D95, _49);
D95.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var r = $("<tbody>").appendTo(this._table), o = TradingView.createLineWidthEditor(), s = this.createColorPicker(), i = this.addLabeledRow(r, "Line");
    $("<td>").prependTo(i);
    $("<td>").append(s).appendTo(i);
    $("<td>").append(o).appendTo(i);
    var i = this.createColorPicker(), n = this.createColorPicker(), h = this.createFontSizeEditor(), c = this.createFontEditor();
    this.createTextEditor(350, 200);
    var u = this.createColorPicker(), l = TradingView.createTransparencyEditor(u), f = $('<input type="checkbox" class="visibility-switch">'), t = this.createColorPicker(), a = TradingView.createTransparencyEditor(t), e = $('<input type="checkbox" class="visibility-switch">');
    this.bindControl(new ColorBinding(i, this._linetool.properties().textcolor, !0, this.model(), "Change Text Color"));
    this.bindControl(new Q11(h, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(c, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new ColorBinding(u, this._linetool.properties().labelBackgroundColor, !0, this.model(), "Change Text Background"));
    this.bindControl(new SliderBinder(l, this._linetool.properties().labelBackgroundTransparency, !0, this.model(), "Change Text Background Transparency"));
    this.bindControl(new Q12(f, this._linetool.properties().fillLabelBackground, !0, this.model(), "Change Text Background Fill"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().backgroundColor, !0, this.model(), "Change Text Background"));
    this.bindControl(new SliderBinder(a, this._linetool.properties().backgroundTransparency, !0, this.model(), "Change Text Background Transparency"));
    this.bindControl(new Q12(e, this._linetool.properties().fillBackground, !0, this.model(), "Change Text Background Fill"));
    this.bindControl(new ColorBinding(n, this._linetool.properties().borderColor, !0, this.model(), "Change Text Border Color"));
    n = this.addLabeledRow(r, "Background", e);
    $("<td>").append(e).prependTo(n);
    $("<td>").append(t).appendTo(n);
    $('<td colspan="2">').append(a).appendTo(n);
    t = this.addLabeledRow(r, "Label");
    $("<td>").prependTo(t);
    $("<td>").append(i).appendTo(t);
    $("<td>").append(c).appendTo(t);
    $("<td>").append(h).appendTo(t);
    n = this.addLabeledRow(r, "Label Background", f);
    $("<td>").append(f).prependTo(n);
    $("<td>").append(u).appendTo(n);
    $('<td colspan="2">').append(l).appendTo(n);
    this.bindControl(new ColorBinding(s, this._linetool.properties().linecolor, !0, this.model(), "Change Date Range Color"));
    this.bindControl(new SliderBinder(o, this._linetool.properties().linewidth, !0, this.model(), "Change Date Range Line Width"));
    this.loadData()
};
D95.prototype.widget = function () {
    return this._table
};
inherit(_22, _49);
_22.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = this.createColorPicker(), i = this.createColorPicker(), r = TradingView.createTransparencyEditor(t), n = this.addLabeledRow(this._table, "Background");
    $("<td>").append(t).appendTo(n);
    $("<td>").append(i).appendTo(n);
    $("<td>").append(r).appendTo(n);
    var u = TradingView.createLineWidthEditor(), f = this.createColorPicker(), n = this.addLabeledRow(this._table, "Border");
    $("<td>").append(f).appendTo(n);
    $("<td>").appendTo(n);
    $("<td>").append(u).appendTo(n);
    this.bindControl(new ColorBinding(f, this._linetool.properties().trendline.color, !0, this.model(), "Change Projection Line Color"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().color1, !0, this.model(), "Change Projection Background Color"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().color2, !0, this.model(), "Change Projection Background Color"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().linewidth, !0, this.model(), "Change Projection Border Width"));
    this.bindControl(new SliderBinder(r, this._linetool.properties().transparency, !0, this.model(), "Change Projection Background Transparency"));
    this.loadData()
};
_22.prototype.widget = function () {
    return this._table
};
inherit(_15, _49);
_15.prototype.prepareLayout = function () {
    function f() {
        u.slider("option", "disabled", !a.value())
    }

    var a;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = TradingView.createLineWidthEditor(), e = this.createColorPicker(), o = this.createColorPicker(), s = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), h = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>'), c = this.createFontSizeEditor(), l = this.createFontEditor(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(t).appendTo(n);
    var i = $('<input type="checkbox" class="visibility-switch">'), r = this.createColorPicker(), u = TradingView.createTransparencyEditor(r), l = this.createFontEditor(), n = this.addLabeledRow(this._table, "Background", i);
    $("<td>").append(i).prependTo(n);
    $("<td>").append(r).appendTo(n);
    $("<td>").append(u).appendTo(n);
    a = this._linetool.properties().fillBackground;
    f();
    this._linetool.properties().fillBackground.subscribe(null, f);
    this.bindControl(new Q12(i, this._linetool.properties().fillBackground, !0, this.model(), "Change Pattern Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Pattern Line Color"));
    this.bindControl(new ColorBinding(o, this._linetool.properties().textcolor, !0, this.model(), "Change Pattern Text Color"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().backgroundColor, !0, this.model(), "Change Pattern Background Color"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Pattern Border Width"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().transparency, !0, this.model(), "Change Pattern Background Transparency"));
    this.bindControl(new Q11(c, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(l, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new Q12(s, this._linetool.properties().bold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(h, this._linetool.properties().italic, !0, this.model(), "Change Text Font Italic"));
    t = $('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width: 1}).append(o)).append($(document.createElement("td")).attr({width: 1}).append(l)).append($(document.createElement("td")).attr({width: 1}).append(c)).append($(document.createElement("td")).css("vertical-align", "top").attr({width: 1}).append(s)).append($(document.createElement("td")).css("vertical-align", "top").append(h)).append($("<\/tr><\/table>"));
    n = this.addLabeledRow(this._table, "");
    $('<td colspan="5">').append(t).appendTo(n);
    this.loadData()
};
_15.prototype.widget = function () {
    return this._table
};
inherit(D86, _49);
D86.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = TradingView.createLineWidthEditor(), i = this.createColorPicker(), r = this.createColorPicker(), u = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), f = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>'), e = this.createFontSizeEditor(), n = this.createFontEditor(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(i).appendTo(n);
    $("<td>").append(t).appendTo(n);
    n = this.createFontEditor();
    this.bindControl(new ColorBinding(i, this._linetool.properties().color, !0, this.model(), "Change Pattern Line Color"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().textcolor, !0, this.model(), "Change Pattern Text Color"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Pattern Border Width"));
    this.bindControl(new Q11(e, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(n, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new Q12(u, this._linetool.properties().bold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(f, this._linetool.properties().italic, !0, this.model(), "Change Text Font Italic"));
    t = $('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width: 1}).append(r)).append($(document.createElement("td")).attr({width: 1}).append(n)).append($(document.createElement("td")).attr({width: 1}).append(e)).append($(document.createElement("td")).css("vertical-align", "top").attr({width: 1}).append(u)).append($(document.createElement("td")).css("vertical-align", "top").append(f)).append($("<\/tr><\/table>"));
    n = this.addLabeledRow(this._table, "");
    $('<td colspan="5">').append(t).appendTo(n);
    this.loadData()
};
D86.prototype.widget = function () {
    return this._table
};
inherit(LineToolNotePropertyPage, _49);
LineToolNotePropertyPage.prototype.prepareLayout = function () {
    var n = this.createColorPicker(), f = this.createFontSizeEditor(), e = this.createFontEditor(), t = this.createTextEditor(350, 200), o = this.createColorPicker(), i = this.createColorPicker(), s = TradingView.createTransparencyEditor(i), h = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), c = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    this.bindControl(new ColorBinding(n, this._linetool.properties().textColor, !0, this.model(), $.t("Change Text Color")));
    this.bindControl(new Q11(f, this._linetool.properties().fontSize, parseInt, !0, this.model(), $.t("Change Text Font Size")));
    this.bindControl(new Q11(e, this._linetool.properties().font, null, !0, this.model(), $.t("Change Text Font")));
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().text, null, !0, this.model(), $.t("Change Text")));
    this.bindControl(new ColorBinding(o, this._linetool.properties().markerColor, !0, this.model(), $.t("Change Marker and Border Color")));
    this.bindControl(new ColorBinding(i, this._linetool.properties().backgroundColor, !0, this.model(), $.t("Change Background Color")));
    this.bindControl(new SliderBinder(s, this._linetool.properties().backgroundTransparency, !0, this.model(), "Change Background Transparency"));
    this.bindControl(new Q12(h, this._linetool.properties().bold, !0, this.model(), $.t("Change Text Font Bold")));
    this.bindControl(new Q12(c, this._linetool.properties().italic, !0, this.model(), $.t("Change Text Font Italic")));
    var r = $('<table class="property-page" cellspacing="0" cellpadding="2">'), l = $('<table class="property-page" cellspacing="0" cellpadding="2">'), u = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._table = r.add(u).add(l);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({width: 1}).append(n)).append($(document.createElement("td")).attr({width: 1}).append(e)).append($(document.createElement("td")).attr({width: 1}).append(f)).append($(document.createElement("td")).attr({width: 1}).append(h)).append($(document.createElement("td")).append(c)).appendTo(r);
    $(document.createElement("tr")).append($(document.createElement("td")).attr({colspan: 5}).append(t)).appendTo(r);
    n = this.addLabeledRow(u, $.t("Label"));
    $("<td>").attr("colspan", 2).append(o).appendTo(n);
    n = this.addLabeledRow(u, $.t("Background"));
    $("<td>").append(i).appendTo(n);
    $("<td>").append(s).appendTo(n);
    this.loadData();
    setTimeout(function () {
        t.select();
        t.focus()
    }, 20)
};
LineToolNotePropertyPage.prototype.widget = function () {
    return this._table
};
LineToolNotePropertyPage.prototype.dialogPosition = function (n, t) {
    if (n && t) {
        for (var i = 0, u = this._linetool.Q0.paneForSource(this._linetool), f = D45.getChartWidget(), r; i < f._paneWidgets.length; i++)if (f._paneWidgets[i]._state == u) {
            r = $(f._paneWidgets[i].canvas).offset().left;
            break
        }
        if (i = this._linetool.paneViews().item(0), u = new MathEx.Point(0, 0), i && (u = i._floatPoints.item(0) || this._linetool._fixedPoints.item(0)), i = TradingView.LineToolNote.TOOLTIP_WIDTH, r = (r || 0) + u.x - i / 2, u = t.outerWidth(), n.left < r && n.left + u + 10 > r)return n.left -= n.left + u + 10 - r, n;
        if (n.left > r && n.left < r + i + 10)return n.left += r + i + 10 - n.left, n
    }
};
inherit(_43, _14);
_43.prototype.prepareLayout = function () {
    var r = $('<table class="property-page" cellspacing="0" cellpadding="0">'), f = $('<table class="property-page" cellspacing="0" cellpadding="0">').data({"layout-tab": EditObjectDialog.TAB_NAME_INPUTS, "layout-tab-priority": EditObjectDialog.TAB_PRIORITY_INPUTS}), u, t, n, i, e;
    for (this._table = r.add(f), u = this._linetool.points(), t = 0; t < u.size(); t++)u.item(t), n = $("<tr>"), n.appendTo(r), i = $("<td>"), i.html("Point " + (t + 1) + " Bar #"), i.appendTo(n), barEditCell = $("<td>"), barEditCell.appendTo(n), n = $("<input type='text'>"), n.appendTo(barEditCell), n.addClass("ticker"), i = this._linetool.properties().points[t], e = [ToIntTransformer(i.bar.value()), GreateTransformer(-5e3), LessTransformer(15e3)], this.bindControl(new SimpleStringBinder(n, i.bar, e, !1, this.model(), "Change " + this._linetool + " point bar index"));
    r = StudyMetaInfo.findStudyMetaInfo(this.Q0.studiesMetaData(), this._linetool.studyId());
    _41.prototype.prepareLayoutImpl.call(this, r, f)
};
_43.prototype.widget = function () {
    return this._table
};
inherit(_44, Q7);
inherit(_44, SeriesStylePropertyPageMixin);
_44.prototype.prepareLayout = function () {
    var n = $('<table class="property-page" cellspacing="0" cellpadding="2">'), r = $('<table class="property-page" cellspacing="0" cellpadding="2">'), u = $('<table class="property-page" cellspacing="0" cellpadding="2">'), t = $('<table class="property-page" cellspacing="0" cellpadding="2">'), f = $('<table class="property-page" cellspacing="0" cellpadding="2">'), i = this.Q1.properties();
    this._prepareSeriesStyleLayout(n, r, u, i);
    this._table = n.add(r).add(u).add(t).add(f);
    n = $('<input type="checkbox">');
    t = this.addLabeledRow(t, "Price Line", n);
    $("<td>").append(n).prependTo(t);
    this.bindControl(new Q12(n, i.showPriceLine, !0, this.model(), "Change Price Price Line"));
    t = this.createSeriesMinTickEditor();
    n = $("<tr>");
    n.appendTo(f);
    $("<td>" + $.t("Override Min Tick") + "<\/td>").appendTo(n);
    $("<td>").append(t).appendTo(n);
    this.bindControl(new Q11(t, i.minTick, null, !0, this.model(), "Change MinTick"))
};
_44.prototype.loadData = function () {
    this.superclass.prototype.loadData.call(this);
    this.switchStyle()
};
_44.prototype.switchStyle = function () {
    $(this._barsTbody).add(this._barsColorerTbody).add(this._candlesTbody).add(this._candlesColorerTbody).add(this._hollowCandlesTbody).add(this._lineTbody).add(this._areaTbody).css("display", "none");
    switch (this.Q1.properties().style.value()) {
        case TradingView.Series.STYLE_BARS:
            this._barsTbody.css("display", "table-row-group");
            this._barsColorerTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_CANDLES:
            this._candlesTbody.css("display", "table-row-group");
            this._candlesColorerTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_HOLLOW_CANDLES:
            this._hollowCandlesTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_LINE:
            this._lineTbody.css("display", "table-row-group");
            break;
        case TradingView.Series.STYLE_AREA:
            this._areaTbody.css("display", "table-row-group")
    }
};
_44.prototype.widget = function () {
    return this._table
};
inherit(D97, _49);
D97.prototype.prepareLayout = function () {
    var t;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    t = [];
    t = 6 === this._linetool.pointsCount() ? "Subminuette Minuette Minute Minor Intermediate Primary Cycle SuperCycle GrandSuperCycle".split(" ").map(function (n) {
        return $.t(n)
    }) : ["Minor", "Major"].map(function (n) {
        return $.t(n)
    });
    waveTypeEditor = this.createKeyCombo(t);
    waveTypeEditor.width(300);
    this.createFontEditor();
    t = this.createFontSizeEditor();
    $('<span class="property-page-small-select">').append(t);
    var t = this.createColorPicker(), i = $('<input type="checkbox" class="visibility-switch">'), r = $('<input type="checkbox" class="visibility-switch">'), n = this.addLabeledRow(this._table, "Wave Size");
    $("<td>").prependTo(n);
    $("<td>").append(waveTypeEditor).appendTo(n);
    n = this.addLabeledRow(this._table, "Color");
    $("<td>").prependTo(n);
    $("<td>").append(t).appendTo(n);
    n = this.addLabeledRow(this._table, "Show Wave", r);
    $("<td>").append(r).prependTo(n);
    n = this.addLabeledRow(this._table, "Show Background", i);
    $("<td>").append(i).prependTo(n);
    this.bindControl(new Q12(i, this._linetool.properties().showBackground, !0, this.model(), "Change Elliott Labels Background"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().color, !0, this.model(), "Change Elliott Label Color"));
    this.bindControl(new Q11(waveTypeEditor, this._linetool.properties().wavesize, parseInt, !0, this.model(), "Change Elliott Wave Size"));
    this.bindControl(new Q12(r, this._linetool.properties().showWave, !0, this.model(), "Change Elliott Labels Background"));
    this.loadData()
};
D97.prototype.widget = function () {
    return this._table
};
inherit(_25, _14);
_25.prototype.prepareLayout = function () {
    var f, e, i, t, o, s, n;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var n = $("<tbody>").appendTo(this._table), r = this.addLabeledRow(n, "Stop Level. Ticks:"), u = $("<input type='text'>");
    $("<td>").append(u).appendTo(r);
    u.addClass("ticker");
    f = $("<input type='text'>");
    $("<td>" + $.t("Price:") + "<\/td>").appendTo(r);
    $("<td>").append(f).appendTo(r);
    t = this.addLabeledRow(n, "Entry price:");
    e = $("<input type='text'>");
    $('<td colspan="2">').append(e).appendTo(t);
    i = this.addLabeledRow(n, "Profit Level. Ticks:");
    t = $("<input type='text'>");
    $("<td>").append(t).appendTo(i);
    t.addClass("ticker");
    o = $("<input type='text'>");
    $("<td>" + $.t("Price:") + "<\/td>").appendTo(i);
    $("<td>").append(o).appendTo(i);
    "LineToolRiskRewardLong" == this._linetool.getConstructor() && (r.detach().appendTo(n), i.detach().prependTo(n));
    n = [ToIntTransformer(this._linetool.properties().stopLevel.value()), GreateTransformer(0), LessTransformer(1e9)];
    this.bindControl(new SimpleStringBinder(u, this._linetool.properties().stopLevel, n, !1, this.model(), "Change " + this._linetool + " stop level"));
    n = [ToIntTransformer(this._linetool.properties().profitLevel.value()), GreateTransformer(0), LessTransformer(1e9)];
    this.bindControl(new SimpleStringBinder(t, this._linetool.properties().profitLevel, n, !1, this.model(), "Change " + this._linetool + " profit level"));
    n = [ToFloatTransformer(this._linetool.properties().entryPrice.value())];
    this.bindControl(new SimpleStringBinder(e, this._linetool.properties().entryPrice, n, !1, this.model(), "Change " + this._linetool + " entry price"));
    s = this;
    n = [ToFloatTransformer(this._linetool.properties().stopPrice.value()), function (n) {
        return s._linetool.preparseStopPrice(n)
    }];
    this.bindControl(new SimpleStringBinder(f, this._linetool.properties().stopPrice, n, !1, this.model(), "Change " + this._linetool + " stop price"));
    n = [ToFloatTransformer(this._linetool.properties().targetPrice.value()), function (n) {
        return s._linetool.preparseProfitPrice(n)
    }];
    this.bindControl(new SimpleStringBinder(o, this._linetool.properties().targetPrice, n, !1, this.model(), "Change " + this._linetool + " stop price"))
};
_25.prototype.widget = function () {
    return this._table
};
inherit(_26, _49);
_26.prototype.prepareLayout = function () {
    var i, u, n, r, f;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var t = $("<tbody>").appendTo(this._table), e = TradingView.createLineWidthEditor(), o = this.createColorPicker(), n = this.addLabeledRow(t, "Lines");
    $("<td>").append(o).appendTo(n);
    $("<td>").append(e).appendTo(n);
    n = this.addLabeledRow(t, "Stop Color:");
    i = this.createColorPicker();
    $("<td>").append(i).appendTo(n);
    u = TradingView.createTransparencyEditor(i);
    $('<td colspan="2">').append(u).appendTo(n);
    n = this.addLabeledRow(t, "Target Color:");
    r = this.createColorPicker();
    $("<td>").append(r).appendTo(n);
    f = TradingView.createTransparencyEditor(r);
    $('<td colspan="2">').append(f).appendTo(n);
    var n = this.addLabeledRow(t, "Text:"), t = this.createColorPicker(), s = this.createFontSizeEditor(), h = this.createFontEditor();
    $("<td>").append(t).appendTo(n);
    $("<td>").append(h).appendTo(n);
    $("<td>").append(s).appendTo(n);
    this.bindControl(new ColorBinding(o, this._linetool.properties().linecolor, !0, this.model(), "Change Risk/Reward line Color"));
    this.bindControl(new SliderBinder(e, this._linetool.properties().linewidth, !0, this.model(), "Change Risk/Reward line width"));
    this.bindControl(new ColorBinding(i, this._linetool.properties().stopBackground, !0, this.model(), "Change stop color"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().stopBackgroundTransparency, !0, this.model(), "Change Stop Background Transparency"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().profitBackground, !0, this.model(), "Change target color"));
    this.bindControl(new SliderBinder(f, this._linetool.properties().profitBackgroundTransparency, !0, this.model(), "Change Profit Background Transparency"));
    this.bindControl(new Q11(s, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(h, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new ColorBinding(t, this._linetool.properties().textcolor, !0, this.model(), "Change Text Color"));
    this.loadData()
};
_26.prototype.widget = function () {
    return this._table
};
inherit(_33, _49);
_33.prototype.prepareLayout = function () {
    function f() {
        u.slider("option", "disabled", !a.value())
    }

    var a;
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = TradingView.createLineWidthEditor(), e = this.createColorPicker(), o = this.createColorPicker(), s = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), h = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>'), c = this.createFontSizeEditor(), l = this.createFontEditor(), n = this.addLabeledRow(this._table, "Border");
    n.prepend("<td>");
    $("<td>").append(e).appendTo(n);
    $("<td>").append(t).appendTo(n);
    var i = $('<input type="checkbox" class="visibility-switch">'), r = this.createColorPicker(), u = TradingView.createTransparencyEditor(r), l = this.createFontEditor(), n = this.addLabeledRow(this._table, "Background", i);
    $("<td>").append(i).prependTo(n);
    $("<td>").append(r).appendTo(n);
    $("<td>").append(u).appendTo(n);
    a = this._linetool.properties().fillBackground;
    f();
    this._linetool.properties().fillBackground.subscribe(null, f);
    this.bindControl(new Q12(i, this._linetool.properties().fillBackground, !0, this.model(), "Change Pattern Filling"));
    this.bindControl(new ColorBinding(e, this._linetool.properties().color, !0, this.model(), "Change Pattern Line Color"));
    this.bindControl(new ColorBinding(o, this._linetool.properties().textcolor, !0, this.model(), "Change Pattern Text Color"));
    this.bindControl(new ColorBinding(r, this._linetool.properties().backgroundColor, !0, this.model(), "Change Pattern Background Color"));
    this.bindControl(new SliderBinder(t, this._linetool.properties().linewidth, !0, this.model(), "Change Pattern Border Width"));
    this.bindControl(new SliderBinder(u, this._linetool.properties().transparency, !0, this.model(), "Change Pattern Background Transparency"));
    this.bindControl(new Q11(c, this._linetool.properties().fontsize, parseInt, !0, this.model(), "Change Text Font Size"));
    this.bindControl(new Q11(l, this._linetool.properties().font, null, !0, this.model(), "Change Text Font"));
    this.bindControl(new Q12(s, this._linetool.properties().bold, !0, this.model(), "Change Text Font Bold"));
    this.bindControl(new Q12(h, this._linetool.properties().italic, !0, this.model(), "Change Text Font Italic"));
    t = $('<table class="property-page" cellspacing="0" cellpadding="2"><tr>').append($(document.createElement("td")).attr({width: 1}).append(o)).append($(document.createElement("td")).attr({width: 1}).append(l)).append($(document.createElement("td")).attr({width: 1}).append(c)).append($(document.createElement("td")).css("vertical-align", "top").attr({width: 1}).append(s)).append($(document.createElement("td")).css("vertical-align", "top").append(h)).append($("<\/tr><\/table>"));
    n = this.addLabeledRow(this._table, "");
    $('<td colspan="5">').append(t).appendTo(n);
    this.loadData()
};
_33.prototype.widget = function () {
    return this._table
};
inherit(D96, _49);
D96.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var i = $("<tbody>").appendTo(this._table), o = TradingView.createLineWidthEditor(), s = TradingView.createLineStyleEditor(), h = this.createColorPicker(), n = this.addLabeledRow(i, $.t("Line"));
    $("<td>").append(h).appendTo(n);
    $("<td>").append(o).appendTo(n);
    $('<td colspan="3">').append(s.render()).appendTo(n);
    var n = this.addLabeledRow(i, $.t("Text")), i = this.createColorPicker(), c = this.createFontSizeEditor(), l = this.createFontEditor(), a = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), v = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    $("<td>").append(i).appendTo(n);
    $("<td>").append(l).appendTo(n);
    $("<td>").append(c).appendTo(n);
    $("<td>").append(a).appendTo(n);
    $("<td>").append(v).appendTo(n);
    var n = $("<tbody>").appendTo(this._table), u = $('<input type="checkbox" class="visibility-switch">'), f = this.createColorPicker(), y = TradingView.createTransparencyEditor(f), n = this.addLabeledRow(n, $.t("Background"), u), e = $("<table>");
    $('<td colspan="5">').append(e).appendTo(n);
    n = $("<tr>").appendTo(e);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(f).appendTo(n);
    $("<td>").append(y).appendTo(n);
    var t = $("<tbody>").appendTo(this._table), r = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), e = $('<input type="checkbox">').appendTo(r), p = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), k = $('<input type="checkbox">').appendTo(p), w = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), b = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), n = this.addLabeledRow(t, $.t("Left End"));
    $('<td colspan="3">').appendTo(n).append(w).append(r);
    n = this.addLabeledRow(t, $.t("Right End"));
    $('<td colspan="3">').appendTo(n).append(b).append(p);
    n = $("<tbody>").appendTo(this._table);
    n = $("<tr>").appendTo(n);
    t = $("<input type='checkbox'>");
    r = $("<label style='display:block'>").append(t).append($.t("Show Prices"));
    $("<td colspan='2'>").append(r).appendTo(n);
    this.bindControl(new Q11(c, this._linetool.properties().fontsize, parseInt, !0, this.model(), $.t("Change Text Font Size")));
    this.bindControl(new Q11(l, this._linetool.properties().font, null, !0, this.model(), $.t("Change Text Font")));
    this.bindControl(new ColorBinding(i, this._linetool.properties().textcolor, !0, this.model(), $.t("Change Text Color")));
    this.bindControl(new Q12(a, this._linetool.properties().bold, !0, this.model(), $.t("Change Text Font Bold")));
    this.bindControl(new Q12(v, this._linetool.properties().italic, !0, this.model(), $.t("Change Text Font Italic")));
    this.bindControl(new Q12(t, this._linetool.properties().showPrices, !0, this.model(), $.t("Change Disjoint Angle Show Prices")));
    this.bindControl(new Q12(e, this._linetool.properties().extendLeft, !0, this.model(), $.t("Change Disjoint Angle Extending Left")));
    this.bindControl(new Q12(k, this._linetool.properties().extendRight, !0, this.model(), $.t("Change Disjoint Angle Extending Right")));
    this.bindControl(new ColorBinding(h, this._linetool.properties().linecolor, !0, this.model(), $.t("Change Disjoint Angle Color")));
    this.bindControl(new Q11(s, this._linetool.properties().linestyle, parseInt, !0, this.model(), $.t("Change Disjoint Angle Style")));
    this.bindControl(new SliderBinder(o, this._linetool.properties().linewidth, !0, this.model(), $.t("Change Disjoint Angle Width")));
    this.bindControl(new Q11(w, this._linetool.properties().leftEnd, parseInt, !0, this.model(), $.t("Change Disjoint Angle Left End")));
    this.bindControl(new Q11(b, this._linetool.properties().rightEnd, parseInt, !0, this.model(), $.t("Change Disjoint Angle Right End")));
    this.bindControl(new Q12(u, this._linetool.properties().fillBackground, !0, this.model(), $.t("Change Disjoint Angle Filling")));
    this.bindControl(new ColorBinding(f, this._linetool.properties().backgroundColor, !0, this.model(), $.t("Change Disjoint Angle Background Color")));
    this.bindControl(new SliderBinder(y, this._linetool.properties().transparency, !0, this.model(), $.t("Change Disjoint Angle Background Transparency")));
    this.loadData()
};
D96.prototype.widget = function () {
    return this._table
};
inherit(_7, _49);
_7.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var i = $("<tbody>").appendTo(this._table), o = TradingView.createLineWidthEditor(), s = TradingView.createLineStyleEditor(), h = this.createColorPicker(), n = this.addLabeledRow(i, $.t("Line"));
    $("<td>").append(h).appendTo(n);
    $("<td>").append(o).appendTo(n);
    $('<td colspan="3">').append(s.render()).appendTo(n);
    var n = this.addLabeledRow(i, $.t("Text")), i = this.createColorPicker(), c = this.createFontSizeEditor(), l = this.createFontEditor(), a = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), v = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    $("<td>").append(i).appendTo(n);
    $("<td>").append(l).appendTo(n);
    $("<td>").append(c).appendTo(n);
    $("<td>").append(a).appendTo(n);
    $("<td>").append(v).appendTo(n);
    var n = $("<tbody>").appendTo(this._table), u = $('<input type="checkbox" class="visibility-switch">'), f = this.createColorPicker(), y = TradingView.createTransparencyEditor(f), n = this.addLabeledRow(n, $.t("Background"), u), e = $("<table>");
    $('<td colspan="5">').append(e).appendTo(n);
    n = $("<tr>").appendTo(e);
    $("<td>").append(u).appendTo(n);
    $("<td>").append(f).appendTo(n);
    $("<td>").append(y).appendTo(n);
    var t = $("<tbody>").appendTo(this._table), r = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), e = $('<input type="checkbox">').appendTo(r), p = $("<label>" + $.t("Extend") + " <\/label>").css({"margin-left": "8px"}), k = $('<input type="checkbox">').appendTo(p), w = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), b = $("<select><option value='0'>" + $.t("Normal") + "<\/option><option value='1'>" + $.t("Arrow") + "<\/option><\/select>"), n = this.addLabeledRow(t, $.t("Left End"));
    $('<td colspan="3">').appendTo(n).append(w).append(r);
    n = this.addLabeledRow(t, $.t("Right End"));
    $('<td colspan="3">').appendTo(n).append(b).append(p);
    n = $("<tbody>").appendTo(this._table);
    n = $("<tr>").appendTo(n);
    t = $("<input type='checkbox'>");
    r = $("<label style='display:block'>").append(t).append($.t("Show Prices"));
    $("<td colspan='2'>").append(r).appendTo(n);
    this.bindControl(new Q11(c, this._linetool.properties().fontsize, parseInt, !0, this.model(), $.t("Change Text Font Size")));
    this.bindControl(new Q11(l, this._linetool.properties().font, null, !0, this.model(), $.t("Change Text Font")));
    this.bindControl(new ColorBinding(i, this._linetool.properties().textcolor, !0, this.model(), $.t("Change Text Color")));
    this.bindControl(new Q12(a, this._linetool.properties().bold, !0, this.model(), $.t("Change Text Font Bold")));
    this.bindControl(new Q12(v, this._linetool.properties().italic, !0, this.model(), $.t("Change Text Font Italic")));
    this.bindControl(new Q12(t, this._linetool.properties().showPrices, !0, this.model(), $.t("Change Disjoint Angle Show Prices")));
    this.bindControl(new Q12(e, this._linetool.properties().extendLeft, !0, this.model(), $.t("Change Disjoint Angle Extending Left")));
    this.bindControl(new Q12(k, this._linetool.properties().extendRight, !0, this.model(), $.t("Change Disjoint Angle Extending Right")));
    this.bindControl(new ColorBinding(h, this._linetool.properties().linecolor, !0, this.model(), $.t("Change Disjoint Angle Color")));
    this.bindControl(new Q11(s, this._linetool.properties().linestyle, parseInt, !0, this.model(), $.t("Change Disjoint Angle Style")));
    this.bindControl(new SliderBinder(o, this._linetool.properties().linewidth, !0, this.model(), $.t("Change Disjoint Angle Width")));
    this.bindControl(new Q11(w, this._linetool.properties().leftEnd, parseInt, !0, this.model(), $.t("Change Disjoint Angle Left End")));
    this.bindControl(new Q11(b, this._linetool.properties().rightEnd, parseInt, !0, this.model(), $.t("Change Disjoint Angle Right End")));
    this.bindControl(new Q12(u, this._linetool.properties().fillBackground, !0, this.model(), $.t("Change Disjoint Angle Filling")));
    this.bindControl(new ColorBinding(f, this._linetool.properties().backgroundColor, !0, this.model(), $.t("Change Disjoint Angle Background Color")));
    this.bindControl(new SliderBinder(y, this._linetool.properties().transparency, !0, this.model(), $.t("Change Disjoint Angle Background Transparency")));
    this.loadData()
};
_7.prototype.widget = function () {
    return this._table
};
inherit(_13, _49);
_13.prototype.prepareLayout = function () {
    this._table = $(document.createElement("table"));
    this._table.addClass("property-page");
    this._table.attr("cellspacing", "0");
    this._table.attr("cellpadding", "2");
    var t = this.createColorPicker(), n = this.addLabeledRow(this._table, "Color:");
    $("<td>").append(t).appendTo(n);
    n = this._linetool.properties();
    this._div = $("<div>").append(this._table);
    this.bindControl(new ColorBinding(t, n.color, !0, this.model(), "Change Icon Color"));
    this.loadData()
};
_13.prototype.widget = function () {
    return this._div
};
inherit(_29, _49);
_29.prototype.prepareLayout = function () {
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    var n = $("<tbody>").appendTo(this._table), i = TradingView.createLineWidthEditor(), r = TradingView.createLineStyleEditor(), u = this.createColorPicker(), n = this.addLabeledRow(n, $.t("Line"));
    $("<td>").append(u).appendTo(n);
    $("<td>").append(i).appendTo(n);
    $('<td colspan="3">').append(r.render()).appendTo(n);
    var t = $("<tbody>").appendTo(this._table), n = this.addLabeledRow(t, $.t("Text")), f = this.createColorPicker(), e = this.createFontSizeEditor(), o = this.createFontEditor(), s = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-bold"><\/span><\/span>'), h = $('<span class="tv-button tv-button-fontstyle"><span class="icon-fontstyle-italic"><\/span><\/span>');
    $("<td>").append(f).appendTo(n);
    $("<td>").append(o).appendTo(n);
    $("<td>").append(e).appendTo(n);
    $("<td>").append(s).appendTo(n);
    $("<td>").append(h).appendTo(n);
    var c = $('<input type="checkbox">'), l = $('<input type="checkbox">'), n = this.addLabeledRow(t, $.t("Extend Right End"));
    $('<td colspan="3">').appendTo(n).append(c);
    n = this.addLabeledRow(t, $.t("Extend Left End"));
    $('<td colspan="3">').appendTo(n).append(l);
    var a = $('<input type="checkbox">'), v = $('<input type="checkbox">'), y = $('<input type="checkbox">'), n = this.addLabeledRow(t, $.t("Show Price Range"));
    $('<td colspan="3">').appendTo(n).append(a);
    n = this.addLabeledRow(t, $.t("Show Bars Range"));
    $('<td colspan="3">').appendTo(n).append(v);
    n = this.addLabeledRow(t, $.t("Always Show Stats"));
    $('<td colspan="3">').appendTo(n).append(y);
    this.bindControl(new Q12(a, this._linetool.properties().showPriceRange, !0, this.model(), $.t("Change Trend Line Show Price Range")));
    this.bindControl(new Q12(v, this._linetool.properties().showBarsRange, !0, this.model(), $.t("Change Trend Line Show Bars Range")));
    this.bindControl(new Q11(e, this._linetool.properties().fontsize, parseInt, !0, this.model(), $.t("Change Text Font Size")));
    this.bindControl(new Q11(o, this._linetool.properties().font, null, !0, this.model(), $.t("Change Text Font")));
    this.bindControl(new ColorBinding(f, this._linetool.properties().textcolor, !0, this.model(), $.t("Change Text Color")));
    this.bindControl(new Q12(s, this._linetool.properties().bold, !0, this.model(), $.t("Change Text Font Bold")));
    this.bindControl(new Q12(h, this._linetool.properties().italic, !0, this.model(), $.t("Change Text Font Italic")));
    this.bindControl(new ColorBinding(u, this._linetool.properties().linecolor, !0, this.model(), $.t("Change Trend Line Color")));
    this.bindControl(new Q11(r, this._linetool.properties().linestyle, parseInt, !0, this.model(), $.t("Change Trend Line Style")));
    this.bindControl(new SliderBinder(i, this._linetool.properties().linewidth, !0, this.model(), $.t("Change Trend Line Width")));
    this.bindControl(new Q12(c, this._linetool.properties().extendRight, !0, this.model(), $.t("Change Trend Angle Extending Right")));
    this.bindControl(new Q12(l, this._linetool.properties().extendLeft, !0, this.model(), $.t("Change Trend Angle Extending Left")));
    this.bindControl(new Q12(y, this._linetool.properties().alwaysShowStats, !0, this.model(), $.t("Change Trend Line Always Show Stats")));
    this.loadData()
};
_29.prototype.widget = function () {
    return this._table
};
inherit(_28, _14);
_28.prototype.prepareLayout = function () {
    var n, t, i;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    n = this._linetool.points().item(0);
    t = this._linetool.properties().points[0];
    n && t && (i = this._createPointRow(n, t, ""), this._table.append(i), i = $("<tr>").appendTo(this._table), $("<td>").append($.t("Angle")).appendTo(i), n = $("<input type='text'>"), $("<td>").append(n).appendTo(i), t = [ToFloatTransformer(t.price.value()), GreateTransformer(-360), LessTransformer(360)], this.bindControl(new SimpleStringBinder(n, this._linetool.properties().angle, t, !1, this.model(), $.t("Change angle"))), this.loadData())
};
_28.prototype.widget = function () {
    return this._table
};
inherit(_42, Q7);
_42.prototype.prepareLayout = function () {
    var i = $('<table class="property-page" cellspacing="0" cellpadding="2">'), t = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    this._table = i.add(t);
    for (var r = this.Q1.properties(), u = [
        ["Base", r.styles.baseLine],
        ["Up", r.styles.upLine],
        ["Down", r.styles.downLine]
    ], h, e = 0; e < u.length; e++) {
        var f = u[e], o = $("<input type='checkbox' class='visibility-switch'/>"), s = this.createColorPicker(), c = TradingView.createLineWidthEditor(), l = TradingView.createLineStyleEditor(), n = this.addLabeledRow(i, f[0], o);
        e || (h = s);
        $("<td>").append(o).prependTo(n);
        $("<td>").append(s).appendTo(n);
        $("<td>").append(c).appendTo(n);
        $("<td>").append(l.render()).appendTo(n);
        n = "Change " + f[0];
        this.bindControl(new Q12(o, f[1].visible, !0, this.model(), n));
        this.bindControl(new ColorBinding(s, f[1].color, !0, this.model(), n));
        this.bindControl(new SliderBinder(c, f[1].linewidth, !0, this.model(), n));
        this.bindControl(new Q11(l, f[1].linestyle, parseInt, !0, this.model(), n))
    }
    i = $("<input type='checkbox' class='visibility-switch'/>");
    u = $("<input type='checkbox'/>");
    n = $("<tr>").appendTo(t);
    $("<td>").append(i).appendTo(n);
    this.createLabeledCell("Pearson's R", i).appendTo(n);
    n = $("<tr>").appendTo(t);
    $("<td>").append(u).appendTo(n);
    this.createLabeledCell("Extend Lines", u).appendTo(n);
    n = $("<tr>").appendTo(t);
    $("<td>").appendTo(n);
    $("<td>Background<\/td>").appendTo(n);
    t = TradingView.createTransparencyEditor(h);
    $("<td>").append(t).appendTo(n);
    this.bindControl(new Q12(i, r.styles.showPearsons, !0, this.model(), "Change show Pearson's R"));
    this.bindControl(new Q12(u, r.styles.extendLines, !0, this.model(), "Change Extend Lines"));
    this.bindControl(new SliderBinder(t, r.styles.transparency, !0, this.model(), "Change Background Transparency"))
};
_42.prototype.widget = function () {
    return this._table
};
inherit(_50, Q7);
_50.prototype.prepareLayout = function () {
    var i = this.Q1.properties(), t, n;
    this._table = $('<table class="property-page" cellspacing="0" cellpadding="2">');
    t = this.addLabeledRow(this._table, "Volume");
    n = TradingView.createPlotEditor();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new Q11(n, i.styles.vol.plottype, parseInt, !0, this.model(), "Change Volume Plot Style"));
    n = this.createColorPicker();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new ColorBinding(n, i.palettes.volumePalette.colors[0].color, !0, this.model(), "Change Up Volume color"));
    n = this.createColorPicker();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new ColorBinding(n, i.palettes.volumePalette.colors[1].color, !0, this.model(), "Change Down Volume color"));
    n = TradingView.createTransparencyEditor();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new SliderBinder(n, i.transparency, !0, this.model(), "Change Volume Transparency"));
    n = $("<input type='checkbox'>");
    $("<td>").appendTo(t);
    $("<td>").append(n).appendTo(t);
    $("<td>" + $.t("Price Line") + "<\/td>").appendTo(t);
    this.bindControl(new Q12(n, i.styles.vol.trackPrice, !0, this.model(), "Change Price Line"));
    i = i.styles.vol_ma;
    t = this.addLabeledRow(this._table, "Volume MA");
    n = TradingView.createPlotEditor();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new Q11(n, i.plottype, parseInt, !0, this.model(), "Change Volume MA Plot Style"));
    $("<td>").html("&nbsp;").appendTo(t);
    n = this.createColorPicker();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new ColorBinding(n, i.color, !0, this.model(), "Change Volume MA color"));
    n = TradingView.createTransparencyEditor(n);
    $("<td>").append(n).appendTo(t);
    this.bindControl(new SliderBinder(n, i.transparency, !0, this.model(), "Change Volume MA Transparency"));
    n = TradingView.createLineWidthEditor();
    $("<td>").append(n).appendTo(t);
    this.bindControl(new SliderBinder(n, i.linewidth, !0, this.model(), "Change Volume MA Line Width"));
    n = $("<input type='checkbox'>");
    $("<td>").append(n).appendTo(t);
    $("<td>" + $.t("Price Line") + "<\/td>").appendTo(t);
    this.bindControl(new Q12(n, i.trackPrice, !0, this.model(), "Change Price Line"))
};
_50.prototype.widget = function () {
    return this._table
};
D3 = function (n) {
    this._$container = $(n);
    this._$header = this._$container.parent().find(".header").eq(0)
};
D3.prototype.setSelectableHeader = function (n) {
    var t = this._$container.parent().find(".header");
    t.addClass("selectable").append($("<span>").addClass("dropdown"));
    this._title = t.find(".title");
    t = t.find(".title, .dropdown");
    t.on("click", n);
    TradingView.bindPopupMenu(t, null, {event: "show-popup", addClass: "narrow", careBottomBorder: !0})
};
D3.prototype.updateTitleFull = function (n, t) {
    this._notification_count || (this._notification_count = 0);
    t && (this._notification_count += t);
    0 <= this._notification_count || (this._notification_count = 0);
    var i = this._$container.parent().find(".header .title");
    i.text(n);
    this._notification_count && i.prepend($("<span>").addClass("ch-new-counter").text(this._notification_count))
};
D3.prototype.clearNotifications = function () {
    this._notification_count = 0;
    this.updateTitle()
};
D3.prototype.HIGHLIGHT_NUM_FLICKS = 5;
D3.prototype.resize = $.noop;
counter = 0;
D12 = function (n) {
    this._charWidgetCollection = n.getChartWidgetCollection();
    this.Q4 = null;
    this._views = [];
    this._itemsBinding = [];
    this._headerBinding = [];
    this._boxBinding = [];
    this.$container = $('<div class="chart-data-window"><\/div>').appendTo(n.$body);
    this._scroll = new D59(n.$body, this.$container);
    this.visible = n.visible.value();
    this._updateSource();
    this._upadateLayout();
    this._charWidgetCollection.activeChartWidget.subscribe(this.updateAll.bind(this));
    n.visible.subscribe(this._onVisibilityChange.bind(this));
    this._charWidgetCollection.selectedSource.subscribe(function (n) {
        this.updateHighlight({source: n, updateScroll: !0})
    }.bind(this));
    n.setTitle("Data Window")
};
D12.prototype._updateSource = function () {
    var n, t, i;
    if (this.visible && (this._views = [], this.Q4 && (this.Q4._dataWindowWidget = null), this.Q4 = this._charWidgetCollection.activeChartWidget.value(), this.Q4._dataWindowWidget = this, n = this.Q4.model(), n))for (n = n.model().Q19(), t = 0; t < n.size(); t++)i = n.item(t).dataWindowView(), i && this._views.push(i)
};
D12.prototype._upadateLayout = function () {
    var n, t, i;
    if (this.visible) {
        for (n = this, this.$container.empty(), this._itemsBinding = [], this._headerBinding = [], t = this._boxBinding.length - 1; 0 <= t; t--)i = this._boxBinding[t], i.src.properties().visible.unsubscribe(n, i.visibilityHandler);
        for (this._boxBinding = [], t = 0; t < this._views.length; ++t)i = this._views[t], i.items().size() && function (t) {
            var i = null, f, r, o, u, e;
            if (t instanceof SeriesDataWindowView ? i = t._series : (t instanceof StudyDataWindowView || t instanceof D49) && (i = t.Q1), f = $('<div class="box"><\/div>').appendTo(n.$container), r = t.header() ? $('<div class="chart-data-window-header"><span class="text">' + t.header() + '<\/span><div class="hover-source-icon"><\/div><\/div>').appendTo(f) : null, r && n._headerBinding.push({value: t, $el: r.find(".text")}), i && r) {
                u = function (n) {
                    f.toggleClass("hidden", !n.value()).find(".toggle-source-icon").attr("title", o(n))
                };
                o = function (n) {
                    return(n ? "Hide" : "Show") + " data"
                };
                f.addClass("with-actions").toggleClass("hidden", !i.properties().visible.value()).on("click", function (t) {
                    t.preventDefault();
                    n.setSelectedSource(i)
                }).on("contextmenu", function (t) {
                    t.preventDefault();
                    n.Q4.readOnly() || n.showContextMenuForSource(i, t)
                });
                r.on("dblclick", function () {
                    new EditObjectDialog(i, n.Q4.model()).show()
                }).append($('<div class="toggle-source-icon" title="' + o(i.properties().visible.value()) + '"><\/div>').on("click", function (t) {
                    t.stopPropagation();
                    t = i.properties().visible.value();
                    n.Q4.model().setProperty(i.properties().visible, !t, (t ? "Hide " : "Show ") + i.title())
                }));
                i.properties().visible.subscribe(n, u);
                n._boxBinding.push({src: i, $el: f, visibilityHandler: u})
            }
            for (r = 0; r < t.items().size(); ++r)u = t.items().item(r), e = $('<div class="chart-data-window-item"><\/div>').appendTo(f), $('<div class="chart-data-window-item-title">' + u.title() + "<\/div>").appendTo(e), e = $('<div class="chart-data-window-item-value">' + u.value() + "<\/div>").appendTo(e), n._setValueHtml(e, u), n._itemsBinding.push({value: u, $el: e})
        }(i);
        this.updateHighlight();
        this._scroll.resize()
    }
};
D12.prototype.update = function () {
    this.visible && (this.updateHighlight(), this.updateValues())
};
D12.prototype.updateHighlight = function (n) {
    var r = (n || {}).source, i, o, f;
    if (n = !!(n || {}).updateScroll, this.visible && this.Q4 && this.Q4.model()) {
        for (var e = this.Q4.model().hoveredSource(), r = r || this._charWidgetCollection.selectedSource.value(), u, t = 0; t < this._boxBinding.length; ++t)i = this._boxBinding[t].src, o = this._boxBinding[t].$el, i && (f = !(!r || i !== r), this._boxBinding[t].$el.toggleClass("hover", !(!e || i !== e)).toggleClass("active", f), f && (u = o));
        u && n && this._scroll.scrollTo(u)
    }
};
D12.prototype.updateValues = function () {
    if (this.visible) {
        for (var n = 0; n < this._itemsBinding.length; ++n)this._setValueHtml(this._itemsBinding[n].$el, this._itemsBinding[n].value);
        for (n = 0; n < this._headerBinding.length; n++)this._headerBinding[n].$el.html(this._headerBinding[n].value.header()).attr("title", this._headerBinding[n].value.title())
    }
};
D12.prototype.updateAll = function () {
    this._updateSource();
    this._upadateLayout()
};
D12.prototype._onVisibilityChange = function (n) {
    this.visible = !!n;
    n && this.updateAll()
};
D12.prototype._setValueHtml = function (n, t) {
    var i = t.color(), r = this.prepareColor(i), i = i && i != r ? '<div class="real-color" title="Сolor line" style="background-color:' + i + '"><\/div>' + t.value() : t.value();
    n.html(i).css({color: r || ""})
};
D12.prototype.prepareColor = function (n, t) {
    if (n) {
        var i = new RGBColor(t || "#FFFFFF");
        return 20 > Math.abs(i.grayChannel() - new RGBColor(n).grayChannel()) && (n = i.blackWhiteContrast()), n
    }
};
D12.prototype.setSelectedSource = function (n) {
    this.Q4.model().setSelectedSource(n)
};
D12.prototype.showContextMenuForSource = function (n, t) {
    n.hasContextMenu() && (this.setSelectedSource(n), n.constructor === TradingView.Series ? this._seriesContextMenu(n).show(t) : isInherited(n.constructor, TradingView.Study) && this._studyContextMenu(n).show(t))
};
D12.prototype._seriesContextMenu = function (n) {
    var t = this.Q4.actions(), i = n.properties().visible.value(), i = [t.format, i ? t.seriesHide : this.createActionShow(n)];
    return n != this.Q4.model().mainSeries() && i.push(t.seriesRemove), ContextMenu.createMenu(i)
};
D12.prototype._studyContextMenu = function (n) {
    var t = this.Q4.actions(), i = n.properties().visible.value();
    return ContextMenu.createMenu([t.format, i ? t.studyHide : this.createActionShow(n), t.studyRemove])
};
D12.prototype.createActionShow = function (n) {
    var t = new Action({checkable: !0, text: "Show", enabled: !0});
    return t._binding = new Q14(t, n.properties().visible, this.Q4.model(), t.text), t._binding.setValue(n.properties().visible.value()), t
};
$(function () {
    var n = new function () {
        function f() {
            e && (clearTimeout(e), e = null)
        }

        function o(t) {
            if (!n)return 0;
            var i = !!n && jQuery.contains(document.body, n[0]);
            return i || n.css("position", "fixed").appendTo(document.body), t = n[t](), i || n.css("position", "").detach(), t
        }

        var r, t, i, n, u, e, s;
        this.sendMessage = function () {
            var i = n.find('[name="message-text"]');
            (message = String(i.val()).replace(/^\s+|\s+$/g, "")) ? (widgetbar.setPage("Recent Chats"), TradingView.messagesWidget.sendMessageToUser(message, t.id), this.close()) : i.css("border-color", "#E0735E").focus()
        };
        this.isActiveTarget = function (t) {
            return n && i && i.is(t)
        };
        this.isSameUser = function (n) {
            return(n = n.data()) && t && n.id == t.id
        };
        this.update = function (e, o) {
            var h;
            if (this.isActiveTarget(e) || this.isSameUser(e))return f(), this;
            if (u && this.close(), t = o || e.data(), t.large_badge = !0, t.is_self = t.username == window.user.username, t.current_user_is_staff = window.user.is_staff, t.show_add_status_btn = !window.user.status && is_authenticated, t.is_realtime = t.is_pro && "pro_realtime" == t.pro_plan, t.is_premium = t.is_pro && "pro_premium" == t.pro_plan, t.is_trial = t.is_pro && "pro_realtime_trial" == t.pro_plan, i = e, h = Mustache.render(TradingView.templates.userlinkPopup, t, TradingView.templates), n = $(h).on("mouseenter", function () {
                f()
            }).on("mouseleave", function (n) {
                r || $(n.target).is(".content") || this.close(s || 500)
            }.bind(this)), n.find(".userlink").removeClass("userlink"), !t.is_self && (i.hasClass("ch-userlink") || i.hasClass("ch-item-userpic")) && (h = i.closest(".ch-item"), h.length && !h.data("ch-is-standalone"))) {
                var c = i, h = $('<div class="ignore-ban-wrapper"><\/div>').appendTo(n.find(".content .username")), l = !!user.ignore_list[t.id], v = t.is_staff ? null : $('<a href="#" class="ch-ignore-lnk' + (l ? " active" : "") + '">').text(l ? "Unignore" : "Ignore").click(t, function (t) {
                    t.preventDefault();
                    l ? $.post("/conversation-ignore/", {user_id: t.data.id, action: "remove"}, function (i) {
                        i.error ? D83.showNotice("Error", i.error) : (delete user.ignore_list[t.data.id], n && (n.find(".ch-ignore-lnk").removeClass("active").text("Ignore"), l = !1), c.trigger("userignorechange", !1))
                    }) : D83.showConfirm("Confirm", "Are you sure you want to ignore messages from " + t.data.username + "?", function () {
                        $.post("/conversation-ignore/", {user_id: t.data.id, username: t.data.username}, function (n) {
                            n.error ? D83.showNotice("Error", n.error) : (user.ignore_list[t.data.id] = t.data.username, c.trigger("userignorechange", !0))
                        })
                    })
                }), a = !!t.is_banned, y = user.is_staff && !t.is_staff ? $('<a href="#" class="ch-ban-lnk' + (a ? " active" : "") + '">').text(a ? "Unban" : "Ban").click(t, function (t) {
                    t.preventDefault();
                    a ? $.post("/conversation-ban/", {user_id: t.data.id, action: "unban"}, function (t) {
                        t.error ? D83.showNotice("Error", t.error) : (n && (n.find(".ch-ban-lnk").removeClass("active").text("Ban"), a = !1), c.trigger("userbanchange", !1))
                    }) : TradingView.messagesWidget.banUser(t.data.username, t.data.id, null, function () {
                        c.trigger("userbanchange", !0)
                    })
                }) : null;
                v && v.appendTo(h);
                v && y && $("<span>&thinsp;|&thinsp;<\/span>").appendTo(h);
                y && y.appendTo(h)
            }
            return this
        };
        this.setForm = function () {
            n.on("keyup", function (n) {
                27 == n.which && this.close()
            }.bind(this)).addClass("form-layout");
            n.find('[name="message-text"]').focus();
            n.find("textarea").on("keyup", function (n) {
                13 == n.which && n.ctrlKey && this.sendMessage()
            }.bind(this));
            n.find(".message-user.send").on("click", this.sendMessage.bind(this));
            n.find(".message-user.cancel").on("click", this.close.bind(this));
            return r = !0, this
        };
        this.open = function () {
            if (f(), u || !n)return r && n.css({top: .45 * $(window).height() + $(document).scrollTop(), left: ""}), this;
            n && jQuery.contains(document.body, n[0]) || n.css("position", "fixed").appendTo(document.body);
            var e = left = 0, s = o("width"), e = o("height");
            return r ? (e = .45 * $(window).height() + $(document).scrollTop(), left = "") : (e = i.offset().top - e, 0 > e - $(document).scrollTop() && (e = i.offset().top + i.height()), left = i.offset().left - 20, left + s > $(window).width() && (left = $(window).width() - s)), n.css({position: "", top: e, left: left}).hide().fadeIn("fast", function () {
                r && n.find('[name="message-text"]').focus();
                t.btc_address && new TradingView.CoinWidget(t.btc_address, n.find(".btc-tip"), "br")
            }), u = !0, this
        };
        this.close = function (o) {
            return o && "number" == typeof o ? (e = setTimeout(this.close, o), s = o, this) : (f(), !u) ? this : (n.remove(), n = i = t = null, u = r = !1, this)
        };
        this.isForm = function () {
            return r
        }
    }, t;
    $(document).on("mouseenter", ".userlink, .ch-userlink, .ch-item-userpic", function () {
        var i = $(this), u, r;
        n.isActiveTarget(i) ? n.open() : (u = "/u/" + (i.data("username") || i.text()) + "/info/", r = {type: "POST", success: function (t) {
            t && !t.error && n.update(i, t).open()
        }}, ($.browser.msie || /\btrident\b/i.test(navigator.userAgent)) && (r.cache = !1), t = $.ajax(u, r))
    }).on("mouseleave", ".userlink, .ch-userlink, .ch-item-userpic", function () {
        n.isForm() || (t && t.abort(), n.close(500))
    }).on("click", "button.message-user.message, button.profile-action.profile-message, a.ch-item-message, .ch-private-message-popup-item", function () {
        var t = $(this);
        runOrSignIn(function () {
            n.update(t).setForm().open()
        })
    })
});
D60 = function (n, t, i, r) {
    var u = this;
    this._options = r || {};
    this._readonly = !!this._options.readonly;
    this._container = n;
    this._chart = t;
    this._panes = i;
    this._pane_header_height = 34;
    this._hidden_panes_count = 0;
    this.prepareLayout();
    setInterval(function () {
        u.paint()
    }, 66)
};
D60.prototype.prepareLayout = function () {
    var n = this;
    this._widget = $('<div class="chart-sidebar">').appendTo(this._container);
    this._widget.toggleClass("hidden", void 0 != this._options.hidden ? this._options.hidden : TVSettings.getBool("sidebar.hidden", !1));
    this._separator = $('<div class="separator"><div class="separator-bar"><div class="separator-icon"><\/div><\/div><\/div>').appendTo(this._widget);
    this._separator.click(function () {
        n._widget.toggleClass("hidden");
        n._readonly || TVSettings.setValue("sidebar.hidden", n._widget.is(".hidden"));
        $(window).resize()
    });
    this._panes.forEach(function (t, i) {
        void 0 === t.ratio && (t.ratio = TVSettings.getFloat("sidebar.pane." + t.id + ".ratio", 1));
        void 0 === t.state && (t.state = TVSettings.getBool("sidebar.pane." + t.id + ".state", !0), this._hidden_panes_count += t.state ? 0 : 1);
        t.$pane = $('<div class="chart-sidebar-pane">').addClass("tv-" + t.id).appendTo(this._widget);
        t.$header = $('<div class="header"><span class="icon"><\/span><span class="title">' + t.title + "<\/span><\/div>").click(function () {
            t.state = !t.state;
            n._readonly || TVSettings.setValue("sidebar.pane." + t.id + ".state", t.state);
            n._hidden_panes_count += t.state ? -1 : 1;
            n.resize()
        }).appendTo(t.$pane);
        t.index = i;
        t.$container = $('<div class="container">').appendTo(t.$pane);
        t.widgetObject = new t.widget(t.$container, this._chart, t.options);
        i < this._panes.length - 1 && $('<div class="chart-sidebar-vseparator"><div class="handle"><\/div><\/div>').on("mousedown touchstart", function (t) {
            var i = $(this), r = i.prevAll(".chart-sidebar-pane:not(.minimized)").first(), u = i.nextAll(".chart-sidebar-pane:not(.minimized)").first();
            if (!r.length || !u.length)return!1;
            n._drag_start = t.pageY || t.originalEvent.pageY || t.originalEvent.touches && t.originalEvent.touches[0].pageY || 0;
            n._drag_prev_h = r.height();
            n._drag_next_h = u.height();
            $(window).on("mousemove.sidebarDrag touchmove.sidebarDrag", function (t) {
                t = (t.pageY || t.originalEvent.pageY || t.originalEvent.touches && t.originalEvent.touches[0].pageY || 0) - n._drag_start;
                r.height(n._drag_prev_h + t).data("paneObj").widgetObject.resize();
                u.height(n._drag_next_h - t).data("paneObj").widgetObject.resize()
            });
            $(window).one("mouseup touchend", function (t) {
                var r;
                $(window).unbind("mousemove.sidebarDrag touchmove.sidebarDrag");
                r = i.prevAll(".chart-sidebar-pane:not(.minimized)").first();
                t = i.nextAll(".chart-sidebar-pane:not(.minimized)").first();
                var u = (n._widget.height() - n._hidden_panes_count * n._pane_header_height - (n._panes.length - 1)) / (n._panes.length - n._hidden_panes_count), f = (r.height() + n._pane_header_height) / u, r = r.data("paneObj");
                r.ratio = f;
                u = (t.height() + n._pane_header_height) / u;
                r = t.data("paneObj");
                r.ratio = u;
                n.resize()
            });
            t.preventDefault()
        }).appendTo(this._widget);
        t.$pane.data("paneObj", t)
    }, this);
    $(window).resize(function () {
        n.resize()
    });
    this.resize()
};
D60.prototype.normalizeRatios = function () {
    var r = this, n = this._panes.length - this._hidden_panes_count, t = 0, i = 0;
    this._panes.forEach(function (n) {
        n.state && (t += n.ratio)
    });
    i = (t - n) / n;
    this._panes.forEach(function (n) {
        n.state && (n.ratio -= i, r._readonly || TVSettings.setValue("sidebar.pane." + n.id + ".ratio", n.ratio.toFixed(2)))
    })
};
D60.prototype.resize = function () {
    this.normalizeRatios();
    var n = (this._widget.height() - this._hidden_panes_count * this._pane_header_height - (this._panes.length - 1)) / (this._panes.length - this._hidden_panes_count);
    this._panes.forEach(function (t) {
        t.state ? t.$pane.height(n * t.ratio - this._pane_header_height) : t.$pane.height(0);
        t.widgetObject.resize(!0);
        t.$pane.toggleClass("minimized", !t.state);
        t.$container.trigger("paneStateChange", [t.state])
    }, this)
};
D60.prototype.getPaneIndexById = function (n) {
    for (var t = 0; t < this._panes.length; t++)if (this._panes[t].id === n)return t;
    return null
};
D60.prototype.getPaneById = function (n) {
    return n = this.getPaneIndexById(n), null === n ? null : this._panes[n]
};
D60.prototype.highlightPane = function (n, t, i) {
    this._panes[n].$header.highlight(t, i)
};
D60.prototype.highlightWidget = function (n, t, i) {
    this.highlightPane(this.getPaneIndexById(n), t, i)
};
D60.prototype.paint = function () {
    this._panes.forEach(function (n) {
        n.widgetObject.paint && n.widgetObject.paint()
    }, this)
};
D60.prototype.setPaneState = function (n, t, i) {
    n && (n.state = !!t, t = i && i.doNotSave, this._readonly || t || TVSettings.setValue("sidebar.pane." + n.id + ".state", n.state), this._hidden_panes_count = this._panes.filter(function (n) {
        return!n.state
    }).length, this.resize())
};
D59 = function (n, t, i) {
    var r = this;
    this._options = $.extend({}, this._defaultOptions, i || {});
    this._$wrapper = n;
    this._$content = t;
    this._scroll_speed = 40;
    this._shadow_offset = 10;
    this._header_height = this._options.headerHeight;
    this.scrolled = new Delegate;
    this.scrolltoend = new Delegate;
    this.scrolltostart = new Delegate;
    (this._touch = Modernizr.touch || navigator.msMaxTouchPoints) ? (this._$content.css("position", "relative"), this._$wrapper.css({"overflow-y": "scroll", "-webkit-overflow-scrolling": "touch", "-ms-overflow-style": "-ms-autohiding-scrollbar"}).scroll(this._onScroll.bind(this))) : (this._$wrapper.css("overflow", "hidden"), this._$wrapper.mouseenter(function () {
        r._bottomFixed || r._dragging || (r._options.alwaysVisible || r._$scrollBar.addClass("active"), r._onScroll())
    }).mouseleave(function () {
        r._bottomFixed || r._dragging || (r._options.alwaysVisible || r._$scrollBar.removeClass("active"), r._onScroll())
    }).mousewheel(function (n, t) {
        if (!n.isDefaultPrevented())return r.scroll(t)
    }), this._$shadowTop = $('<div class="sb-inner-shadow top">').appendTo(this._$wrapper), this._$shadowTop.hide(), this._$shadowBottom = $('<div class="sb-inner-shadow">').appendTo(this._$wrapper), this._header_height && this._$shadowTop.css("top", this._header_height - this._shadow_offset), n = this._options.additionalClass ? " " + this._options.additionalClass : "", t = this._options.alwaysVisible ? " active-always" : "", this._$scrollBarWrapper = $('<div class="sb-scrollbar-wrap">').appendTo(this._$wrapper), this._$scrollBar = $('<div class="sb-scrollbar sb-scrollbar-body' + n + t + '"><\/div>').appendTo(this._$scrollBarWrapper), this._onScroll())
};
D59.prototype._defaultOptions = {headerHeight: 0, additionalClass: "", alwaysVisible: !1, showBottomShadow: !0};
D59.prototype.initDraggable = function () {
    if (this._dragInitialized)return this;
    var n = this;
    return this._$wrapper.offset(), this._$scrollBar.draggable({axis: "y", containment: this._$scrollBarWrapper, start: function () {
        n._dragging = !0
    }, stop: function () {
        n._dragging = !1
    }, drag: function () {
        n.updateScroll()
    }}), this._dragInitialized = !0, this
};
D59.prototype.updateScroll = function () {
    if (this._touch)return this;
    var t = Math.ceil(this._$scrollBar.position().top - 1 - this._header_height), n = this._$wrapper.height() - this._header_height, i = this._$content.height();
    return 0 >= n ? this : (this._scroll_target_top = 0 >= i - n - 1 ? this._header_height : -t * i / n + this._header_height, t + this._$scrollBar.height() + 2 >= n ? this.scrollToEnd() : (this._$content.css("top", this._scroll_target_top + "px"), this._onScroll()), this)
};
D59.prototype.updateScrollBar = function () {
    if (this._touch)return this;
    var i = this._$content.position().top, t = this._$content.height(), n = this._$wrapper.height(), r = n - this._header_height, u = 1 + this._header_height, f = r - 2, i = (Math.abs(i) - this._header_height) * f / t, n = n * n / t;
    return t < r ? (this._$scrollBar.hide(), this._$wrapper.removeClass("sb-scroll-active")) : (this._$scrollBar.show().height(n).css("top", u + i), this._$wrapper.addClass("sb-scroll-active"), this.initDraggable()), this
};
D59.prototype.scroll = function (n, t) {
    if (this._touch)return this;
    var r = this._$content.position().top, i = this._$content.height(), u = this._$wrapper.height() - this._header_height, i = i - u - 1;
    return 0 >= i ? !0 : (this._scroll_target_top = Math.max(-i + this._header_height, Math.min(this._header_height, r + n * (t || this._scroll_speed))), this.setContentTop(this._scroll_target_top), this._onScroll(), !1)
};
D59.prototype.animateTo = function (n) {
    if (this._touch)return this;
    this._$content.position();
    var t = this._$content.height(), i = this._$wrapper.height() - this._header_height, t = t - i - 1;
    if (0 >= t)return!0;
    this._scroll_target_top = Math.max(-t + this._header_height, Math.min(this._header_height, -n));
    this._$content.animate({top: this._scroll_target_top}, 500, function () {
        this._onScroll()
    }.bind(this))
};
D59.prototype.resize = function () {
    if (!this._bottomFixed) {
        this._$content.position();
        var n = this._$content.height(), t = this._$wrapper.height();
        !this._options.vAlignBottom && n < t ? this.atStart() || this.scrollToStart() : this.atEnd() ? this.scrollToEnd() : "number" == typeof this._stickyBottom && this.setContentTop(Math.min(0, this._stickyBottom + this._$wrapper.height() - this._$content.height()))
    }
};
D59.prototype.resizeHeader = function (n) {
    var t = n - this._header_height;
    this._header_height = n;
    this._scroll_target_top += t;
    this._$shadowTop && this._$shadowTop.css("top", this._header_height - this._shadow_offset);
    this.resize()
};
D59.prototype.scrollTo = function (n, t) {
    t = $.extend({position: "visible", areaHeight: n instanceof $ ? n.height() : 0}, t);
    n instanceof $ && (n = n.position().top);
    var i = this._$content.position().top, u = this._$content.height(), r = this._$wrapper.height() - this._header_height;
    if (0 >= u - r - 1)return!0;
    if (i = -1 * (i - this._header_height), r = i + r, u = 0, "visible" == t.position) {
        if (n > i && n + t.areaHeight < r)return!1;
        u = n + t.areaHeight > r ? r - n - t.areaHeight : i - n
    } else"top" == t.position && (u = i - n);
    return this.scroll(u, 1), this._onScroll(), !1
};
D59.prototype.scrollToEnd = function () {
    var n = this._$content.position().top, t = this._$content.height(), i = this._$wrapper.height();
    return this.setContentTop(n + (i - (t + n)) + 1), this._onScroll(), this
};
D59.prototype.scrollToStart = function () {
    return this.setContentTop(this._header_height), this._onScroll(), this
};
D59.prototype.atStart = function () {
    return Math.round(this._$content.position().top) >= this._header_height
};
D59.prototype.atEnd = function (n) {
    "number" == typeof n && isFinite(n) || (n = 0);
    var t = this._$content.position().top, i = this._$content.height(), r = this._$wrapper.height();
    return i - Math.abs(t) - 1 <= r + n
};
D59.prototype._onScroll = function (n) {
    this._touch || this._$content.css("bottom", "auto");
    this.scrolled.fire();
    this._dragging && !0 !== n || this.updateScrollBar();
    n = this.atStart();
    var t = this.atEnd();
    this._$shadowTop && this._$shadowTop.toggle(!n);
    this._$shadowBottom && this._$shadowBottom.toggle(!t);
    !this._atStart && n ? (this._atStart = !0, this.scrolltostart.fire()) : this._atStart && !n && delete this._atStart;
    !this._atEnd && t ? (this._atEnd = !0, this.scrolltoend.fire()) : this._atEnd && !t && delete this._atEnd;
    this._options.vAlignBottom && (this._stickyBottom = this._$content.height() - Math.abs(this._$content.position().top) - this._$wrapper.height())
};
D59.prototype.save = function () {
    return this._saved = {top: this._$content.position().top, height: this._$content.height()}, this
};
D59.prototype.restore = function () {
    if (this._saved) {
        if (this._saved.top == this._$content.position().top && this._saved.height == this._$content.height())return delete this._saved, this;
        this._options.vAlignBottom && (this._saved.top -= this._$content.height() - this._saved.height, this._saved.top > this._header_height && (this._saved.top = this._header_height));
        this.setContentTop(this._saved.top);
        delete this._saved;
        this._onScroll(!0)
    }
    return this
};
D59.prototype.fixBottom = function () {
    if (this._bottomFixed)return this;
    if (this._touch) {
        var n = this._$content.height(), t = this._$wrapper.scrollTop();
        this._tempIntervalID = setInterval(function () {
            this._$wrapper.scrollTop(t + (this._$content.height() - n))
        }.bind(this), 0)
    } else this._$content.css({top: "auto", bottom: this._$wrapper.height() - this._$content.position().top - this._$content.height()});
    return this._bottomFixed = !0, this
};
D59.prototype.releaseBottom = function () {
    return this._bottomFixed ? (this._touch ? clearInterval(this._tempIntervalID) : this._$content.css({top: this._$content.position().top, bottom: "auto"}), delete this._bottomFixed, this._onScroll(), this) : this
};
D59.prototype.setContentTop = function (n) {
    return this._touch ? this._options.vAlignBottom && this._$content.height() < this._$wrapper.height() ? (this._$wrapper.css("overflow-y", "visible"), this._$content.css({position: "absolute", bottom: 0})) : (this._$content.css({position: "relative", bottom: "auto"}), this._$wrapper.css("overflow-y", "scroll"), this._$wrapper.scrollTop(-n)) : this._$content.css("top", n), this
};
TradingView.SaveLoadWidget = function (n, t, i) {
    function u() {
        t.metaInfo.name.value() || r._readOnly ? r.setTitle(t.metaInfo.name.value()) : r.hideTitle()
    }

    this._options = i = $.extend({popupDirection: "up", popupReverse: !1}, i || {});
    this.onTitleSizeChanged = new Delegate;
    this._container = n = $(n);
    this.Q5 = t;
    this._readOnly = t.readOnly();
    this._savedCharts = [];
    this._editEnabled = !0;
    this.loadChartDialog = new LoadChartDialog;
    this.renameChartDialog = new RenameChartDialog;
    TradingView.Q18("open_last_chart") && (this._new = $('<span class="first button load">' + $.t("New") + "<\/span>").click(this.loadChartDialog.openNewChart).appendTo(n));
    this._load = $('<span class="button load">' + $.t("Load") + "<\/span>").click($.proxy(this, "loadMenu")).appendTo(n);
    TradingView.Q18("open_last_chart") || this._load.addClass("first");
    this._title = $('<span class="title apply-common-tooltip"><\/span>');
    i.hideChartTitle && this._title.hide();
    this._sep = $("<i>").addClass("separator");
    this._optionsMenu = $('<span class="button with-arrow options last">').append($("<span>").addClass("arrow-icon")).click($.proxy(this, "otherActionsMenu"));
    TradingView.bindPopupMenu(this._optionsMenu, null, {direction: i.popupDirection, event: "button-popup", reverse: i.popupReverse, notCloseOnButtons: !0, popupSpacing: i.popupSpacing});
    this._readOnly ? (this._save = $(), this._copy = $('<span class="copy">' + $.t("Copy") + "<\/span>").appendTo(n).click($.proxy(this, "cloneChart")), this._title.addClass("read-only"), this._titleReadOnly = $("<span>").addClass("read-only").appendTo(this._title), this._sep.appendTo(this._copy), this._optionsMenu.hide()) : (i = $.t("Save Chart Layout saves not just some particular chart,\nit saves all charts for all symbols and intervals\nwhich you are modifying while working with this Layout"), this._save = $('<span class="save button apply-common-tooltip" title="' + i + '">' + $.t("Save") + "<\/span>").appendTo(n).click($.proxy(this, "signInOrSaveChart")), this._copy = $(), this._titleInput = $('<span type="text" maxlength="80">').appendTo(this._title), this._title.bind("click", $.proxy(this, "_renameChart")), this._title.attr("title", $.t("Rename Chart Layout")), this._titleSize = $('<span class="sizer">').appendTo(this._title), this._sep.appendTo(this._save));
    this._title.appendTo(n);
    this._optionsMenu.appendTo(n);
    this._savecopy = $().add(this._save).add(this._copy).mousedown(function (n) {
        if (n.button)return!1;
        this._save.addClass("active")
    }.bind(this)).mouseup(function () {
        this._save.removeClass("active")
    }.bind(this));
    var r = this;
    t.metaInfo.name.subscribe(function () {
        u()
    });
    u();
    loginStateChange.subscribe(this, this._refreshSavedChartsList);
    TVXWindowEvents.on("saved-charts-change", $.proxy(this._otherTabUpdated, this));
    TVXWindowEvents.on("saved-charts-change-favorites", $.proxy(this._favoritesUpdated, this));
    D77.undoStack().onChange().subscribe(this, function () {
        if (!D77.undoStack().isEmpty()) {
            var n = D77.undoStack().head().text();
            if ("scroll" == n || "scale time" == n)return
        }
        this._setChanges(!0);
        this.autosave()
    });
    TradingView.keyboardBinder.registerListener("LoadChartDialogHotkey", function (n) {
        return n.ctrlKey ? !1 : "46" == n.which && $(n.target).is("body") ? (this._load.click(), n.preventDefault(), n.stopPropagation(), !0) : !1
    }.bind(this));
    this.favorites = TVSettings.getJSON(TradingView.SaveLoadWidget.FAVORITES_KEY, {})
};
TradingView.SaveLoadWidget.FAVORITES_KEY = "loadChartDialog.favorites";
TradingView.SaveLoadWidget.prototype._favoritesUpdated = function (n) {
    this.favorites = JSON.parse(n);
    this.loadChartDialog.updateFavoritesData(this.favorites)
};
TradingView.SaveLoadWidget.prototype._otherTabUpdated = function (n) {
    this._savedCharts = JSON.parse(n);
    this.loadChartDialog.updateChartsData(this._getLoadMenuCharts())
};
TradingView.SaveLoadWidget.prototype._renameChart = function () {
    var n = this;
    n._editEnabled && this.renameChartDialog.show(this.getTitle()).then(function (t) {
        n.setTitle(t);
        n.saveChart()
    })
};
TradingView.SaveLoadWidget.prototype._setTitle = function (n) {
    this._titleInput.text(n);
    this._titleValue = n;
    this._savecopy.removeClass("last").addClass("titled");
    n ? this._options.hideChartTitle || (this._optionsMenu.show(), this._title.show()) : (this._optionsMenu.hide(), this._title.hide(), this._savecopy.addClass("last").removeClass("titled"));
    this._setInputSuze();
    this._setChanges(!0)
};
TradingView.SaveLoadWidget.prototype._setReadOnlyTitle = function (n) {
    this._titleReadOnly.html(n).attr("title", n.replace(/<[^>]+>/g, ""));
    this._savecopy.removeClass("last").addClass("titled");
    this._title.addClass("last");
    this._options.hideChartTitle || this._title.show()
};
TradingView.SaveLoadWidget.prototype.setTitle = function (n) {
    if (this._readOnly) {
        var t = clean(this.Q5.metaInfo.username.value());
        n = (n ? n + ": " : "") + "view-only chart by " + '<a href="/u/%1">%1<\/a>'.replace(/%1/g, t);
        this._setReadOnlyTitle(n)
    } else this._setTitle(n)
};
TradingView.SaveLoadWidget.prototype.hideTitle = function () {
    this._title.hide();
    this._optionsMenu.hide();
    this._titleInput.text("");
    this._savecopy.removeClass("titled").addClass("last")
};
TradingView.SaveLoadWidget.prototype.getTitle = function () {
    return this._titleValue
};
TradingView.SaveLoadWidget.prototype._setInputSuze = function () {
    this._titleSize.text(this._titleInput.text());
    this._titleInput.width(this._titleSize.width());
    this.onTitleSizeChanged.fire()
};
TradingView.SaveLoadWidget.prototype.cloneChart = function () {
    var n = this;
    J77.enabled("save_old_chart_before_save_as") && this.Q5.metaInfo.id.value() && this._saveChart();
    new RenameChartDialog($.t("Copy Chart Layout")).show($.t("{0} copy").format(n.Q5.metaInfo.name.value())).then(function (t) {
        J77.enabled("saved_charts_count_restriction") && !user.is_pro && 5 <= n._savedCharts.length ? D83.showGoProDialog({feature: "savedChartsLimit"}) : J77.enabled("saveload_storage_customization") ? (n.Q5.metaInfo.uid.setValue(void 0), n.Q5.metaInfo.id.setValue(void 0), n.setTitle(t), n.saveChart()) : window.open("/e/?clone=" + n.Q5.metaInfo.uid.value() + "&name=" + encodeURIComponent(t), "_blank")
    }.bind(this))
};
TradingView.SaveLoadWidget.prototype._setChanges = function (n) {
    this._haveChanges = n = !!n;
    !n && this.getTitle() ? this._save.addClass("no-change") : this._save.removeClass("no-change")
};
TradingView.SaveLoadWidget.prototype._process = function (n) {
    n ? this._save.addClass("process") : this._save.removeClass("process")
};
TradingView.SaveLoadWidget.prototype._saveChart = function (n, t) {
    if (!this._readOnly && !this._saving && this._haveChanges) {
        var i = function () {
            this._saving = !1;
            this._process(!1);
            this._editEnabled = !0;
            clearTimeout(this._saveTimeout)
        }.bind(this);
        this._saving = !0;
        this._process(!0);
        this._editEnabled = !1;
        this._saveTimeout = setTimeout(i, 7e3);
        try {
            saver.saveChartSilently(function () {
                i();
                this._setChanges(!1);
                "function" == typeof n && n.call(this)
            }.bind(this), null, function () {
                i();
                "function" == typeof t && t.call(this)
            })
        } catch (r) {
            i();
            "undefined" != typeof console && console.log && console.log("Error while saving", r)
        }
    }
};
TradingView.SaveLoadWidget.prototype._autosaveInterval = 6e4;
TradingView.SaveLoadWidget.prototype.autosave = function () {
    J77.enabled("charts_auto_save") && (this._autosaveTimer && (clearTimeout(this._autosaveTimer), this._autosaveTimer = 0), this._autosaveTimer = setTimeout(function () {
        this.Q5.metaInfo.id.value() && this._saveChart()
    }.bind(this), this._autosaveInterval))
};
TradingView.SaveLoadWidget.prototype._goChartPage = function (n) {
    "/e/" == location.pathname && (location = "/e/" + n + (TradingView.isMobileView ? "?mobile=1" : ""))
};
TradingView.SaveLoadWidget.prototype.saveChart = function () {
    var n = this.getTitle();
    n ? (this.Q5.metaInfo.name.setValue(n), this._saveChart(function () {
        TradingView.trackEvent("GUI", "Save Chart Layout");
        this._goChartPage(this.Q5.metaInfo.uid.value());
        "undefined" != typeof TradingView.UaTitleManager && TradingView.UaTitleManager.instance && TradingView.UaTitleManager.instance.updateView();
        this._refreshSavedChartsList()
    }.bind(this), function () {
        this.Q5.metaInfo.name.setValue("");
        this.setTitle("")
    }.bind(this))) : TradingView.showChartNameDialog(function (n) {
        this.setTitle(n);
        this.saveChart()
    }.bind(this), void 0, $.t("Chart layout name"), 64)
};
TradingView.SaveLoadWidget.prototype.signInOrSaveChart = function () {
    J77.enabled("saveload_requires_authentication") ? runOrSignIn($.proxy(this, "saveChart")) : this.saveChart()
};
TradingView.SaveLoadWidget.prototype.saveChartByEnter = function (n) {
    "13" == n.keyCode && (this._titleInput.blur(), this.signInOrSaveChart())
};
TradingView.SaveLoadWidget.prototype._refreshSavedChartsList = function (n) {
    J77.enabled("saveload_requires_authentication") && !is_authenticated ? this._savedCharts = [] : getSavedChartsList(function (n) {
        this._savedCharts = n;
        TVXWindowEvents.emit("saved-charts-change", JSON.stringify(n))
    }.bind(this)).then(function () {
        TVSettings.getJSON(this._FAV_KEY, []);
        n && n()
    })
};
TradingView.SaveLoadWidget.prototype._getSavedChartsList = function () {
    return this._savedCharts
};
TradingView.SaveLoadWidget.prototype._fastDelete = function (n, t) {
    this._savedCharts.splice(t, 1);
    n == this.Q5.metaInfo.id.value() && (J77.enabled("saveload_storage_customization") ? (this.Q5.clearChartMetaInfo(), this.setTitle(void 0)) : location.href = "/e/")
};
TradingView.SaveLoadWidget.prototype._getSavedCharts = function () {
    var n = [];
    return!this._readOnly && this.isSaved() && (n.push({title: $.t("Rename..."), action: this._renameChart.bind(this)}), n.push({title: $.t("Save As..."), action: this.cloneChart.bind(this)})), n
};
TradingView.SaveLoadWidget.prototype.isSaved = function () {
    return!!this.getTitle()
};
TradingView.SaveLoadWidget.prototype._getLoadMenuCharts = function () {
    var t = [], n = this, i = this._getSavedChartsList();
    return i.length && $.each(i, function (i, r) {
        t.push({id: r.id, title: r.name, symbol: r.short_symbol, interval: r.interval, toolsCount: 0, modified: r.modified_iso, active: function () {
            return r.id == n.Q5.metaInfo.id.value()
        }, openAction: function () {
            openSavedChart(r)
        }, deleteAction: function (t) {
            deleteChart(r.image_url, function () {
                n._fastDelete(r.id, i);
                TVXWindowEvents.emit("saved-charts-change", JSON.stringify(n._savedCharts));
                t.resolve()
            })
        }, favoriteAction: function (t) {
            n.favorites = t;
            TVSettings.setJSON(TradingView.SaveLoadWidget.FAVORITES_KEY, t);
            TVXWindowEvents.emit("saved-charts-change-favorites", JSON.stringify(t))
        }})
    }), t
};
TradingView.SaveLoadWidget.prototype.otherActionsMenu = function () {
    this._optionsMenu.hasClass("active") || this._optionsMenu.trigger("button-popup", [this._getSavedCharts()])
};
TradingView.SaveLoadWidget.prototype.loadMenu = function () {
    var n = this;
    this._load.addClass("process");
    this._refreshSavedChartsList(function () {
        n._load.removeClass("process");
        n.loadChartDialog.show(n._getLoadMenuCharts(), n.favorites)
    })
};
D9 = function (n, t, i) {
    this._chart = n;
    this._parent = t;
    this.zoom_active = !1;
    this._real = i;
    this._state = "stop";
    this.init();
    i && this.initToRealChart();
    this.initHandlers()
};
D9.prototype.init = function () {
    this._widget = $('<div class="control-bar-wrapper">').appendTo(this._parent);
    $('<div class="control-bar"><span class="move-left-button-control-bar"><\/span><span class="zoom-out-right-button-control-bar"><\/span><span class="turn-button-control-bar"><\/span><span class="zoom-in-button-control-bar"><\/span><span class="move-right-button-control-bar"><\/span><\/div>').appendTo(this._widget);
    this._buttons = {zoomIn: this._widget.find(".zoom-in-button-control-bar"), zoomOut: this._widget.find(".zoom-out-right-button-control-bar"), moveLeft: this._widget.find(".move-left-button-control-bar"), moveRight: this._widget.find(".move-right-button-control-bar"), turn: this._widget.find(".turn-button-control-bar")}
};
D9.prototype.initToRealChart = function () {
    var n = this, t;
    this._back = $('<span class="back-to-present"><\/span>').appendTo(this._parent).addClass("hidden");
    this._back.on("click", function () {
        n._chart.model().timeScale().scrollToRealtime(!0);
        n._chart.model().model()._invalidateHandler(new D22(D22.FULL_UPDATE));
        n._back.addClass("hidden")
    });
    t = function () {
        var t = n._chart.maxRhsPriceAxisWidth + 4;
        t && n._back.css("marginRight", t)
    };
    this._chart.rhsPriceAxisWidthChanged.subscribe(this, t);
    t();
    this._chart.withModel(this, function () {
        this._chart.model().model().setInterval(function () {
            n.check()
        }, 1e3)
    })
};
D9.prototype.check = function () {
    this._chart.model() && 0 > this._chart.model().timeScale().rightOffset() ? this._back.removeClass("hidden") : this._back.addClass("hidden")
};
D9.prototype._move = function (n) {
    if ("stop" == this._state && this._chart.model().beginUndoMacro(1 == n ? "Move Left" : "Move Right"), this._state = "moving", this._deferredFinishTimeout && (clearTimeout(this._deferredFinishTimeout), this._deferredFinishTimeout = 0), this._finishingTimeout && (clearTimeout(this._finishingTimeout), this._finishingTimeout = 0), this._startTime = +new Date, !this._movingTimeout) {
        var t = this._startTime;
        this._movingTimeout = setTimeout(function i() {
            this._moveStep.call(this, t, 0, 50 * n, 1e3);
            this._movingTimeout = setTimeout(i.bind(this), 10)
        }.bind(this), 10)
    }
};
D9.prototype._moveStep = function (n, t, i, r) {
    if (!this._chart.model().timeScale().isEmpty())return n = 1 - (Math.max(0, n + r - +new Date) / r || 0), 1 > n && (r = jQuery.easing.easeOutCubic(null, r * n, 0, 1, r), this.currentDistance = (i - t) * r + t), this._chart.model().scrollChart(this.currentDistance), n
};
D9.prototype._finishMove = function () {
    clearTimeout(this._movingTimeout);
    this._deferredFinishTimeout = this._movingTimeout = 0;
    var n = this.currentDistance, t = +new Date;
    this._finishingTimeout = setTimeout(function i() {
        1 > this._moveStep.call(this, t, n, 0, 700) ? this._finishingTimeout = setTimeout(i.bind(this), 10) : (this._state = "stop", this.currentDistance = this._movingTimeout = 0, this._chart.model().endUndoMacro())
    }.bind(this), 10);
    this._incrementInterval = 0
};
D9.prototype._stopMove = function () {
    "moving" == this._state && (this._state = "wait_finishing", 200 > (new Date).getTime() - this._startTime ? this._deferredFinishTimeout = setTimeout(this._finishMove.bind(this), 200 - ((new Date).getTime() - this._startTime)) : this._finishMove())
};
D9.prototype.initHandlers = function () {
    var n = this._chart, i, r, t;
    $(".control-bar span");
    i = Modernizr.touch ? "touchstart" : "mousedown";
    r = Modernizr.touch ? "touchend" : "mouseup mouseout";
    this._buttons.moveLeft.on(i, this._move.bind(this, 1));
    this._buttons.moveLeft.on(r, this._stopMove.bind(this, 1));
    this._buttons.moveRight.on(i, this._move.bind(this, -1));
    this._buttons.moveRight.on(r, this._stopMove.bind(this, -1));
    this._buttons.turn.on("click", function () {
        n.GUIResetScales()
    });
    this._buttons.zoomOut.on("click", function () {
        n.model() && n.model().zoomOut()
    });
    this._buttons.zoomIn.on("click", function () {
        n.model() && n.model().zoomIn()
    });
    n.withModel(this, function () {
        var t = function () {
            var t = !n.model().canZoomIn(), i = !n.model().canZoomOut();
            this.makeBtnDisabled(this._buttons.zoomIn, t);
            this.makeBtnDisabled(this._buttons.zoomOut, i)
        };
        n.model().onSimpleZoomIn().subscribe(this, function () {
            t.call(this)
        });
        n.model().onSimpleZoomOut().subscribe(this, function () {
            t.call(this)
        })
    });
    t = {};
    $("body").on("keydown", function (n) {
        if (!($(n.target).closest("input, textarea").length || n.which in t))switch (t[n.which] = !0, n.which) {
            case 37:
                this._move.call(this, 1);
                break;
            case 39:
                this._move.call(this, -1)
        }
    }.bind(this)).on("keyup", function (n) {
        if (!$(n.target).closest("input, textarea").length)switch (delete t[n.which], n.which) {
            case 37:
            case 39:
                this._stopMove.call(this)
        }
    }.bind(this))
};
D9.prototype.makeBtnDisabled = function (n, t) {
    n instanceof $ ? n.toggleClass("disabled", !!t) : "string" == typeof n && (this._buttons[n] ? this._buttons[n].toggleClass("disabled", !!t) : console.warn("No btn " + n + " in ControlBarNavigation"))
};
D9.prototype.resetButtons = function () {
    if (this._buttons)for (btnName in this._buttons)this._buttons[btnName].removeClass("disabled")
};
TradingView.SeriesControlWidget = function () {
    function n(n) {
        var t = this, r = this.Q4 = n.Q3, f, i, u;
        this._$seriesControls = $(document.createElement("div")).attr("class", "chart-controls-bar-buttons chart-series-controls").appendTo(n.parent);
        this._$percButton = $(document.createElement("a")).text("%").attr("title", $.t("Toggle Percentage")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);
        this._$logButton = $(document.createElement("a")).text($.t("log")).attr("title", $.t("Toggle Log Scale")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);
        this._$autoScaleButton = $(document.createElement("a")).text($.t("auto", {context: "scale"})).attr("title", $.t("Toggle Auto Scale")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);
        f = $(document.createElement("a")).attr("title", $.t("Scales Properties")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);
        this._$fullscreenChartButton = $(document.createElement("a")).attr("title", $.t("Toggle Maximize Chart")).addClass("apply-common-tooltip").appendTo(this._$seriesControls);
        this._$extendedHoursButton = null;
        i = $(document.createElementNS("http://www.w3.org/2000/svg", "svg")).attr({width: 12, height: 12}).css({fill: "currentColor", stroke: "none", margin: "1px"});
        $(document.createElementNS("http://www.w3.org/2000/svg", "desc")).text("SP").appendTo(i);
        $(document.createElementNS("http://www.w3.org/2000/svg", "path")).attr({d: "M 11.896733,5.4401 C 11.201602,5.2497118 10.287185,5.3844905 9.8529668,4.6739798 9.3680407,3.9899631 9.7713075,3.1150758 10.335646,2.6255445 10.81759,2.1397596 10.086625,1.2464141 9.5348331,1.5679918 9.0096065,2.0197899 8.3586515,2.5915907 7.6081884,2.2860159 6.8487054,2.0572252 6.6657258,1.2214292 6.6611579,0.52971682 6.6904416,-0.14270317 5.5547878,-0.19920111 5.3509206,0.33932112 5.3495604,1.0614071 5.216111,1.980668 4.4411277,2.2733721 3.718985,2.58432 3.0421913,2.0835985 2.5447076,1.6132218 2.019086,1.2075468 1.1733117,2.0525503 1.6258135,2.5522279 2.1291674,3.0522349 2.6067846,3.7947509 2.23627,4.5142319 1.9382627,5.2487851 1.0997484,5.3013165 0.42629601,5.3591295 -0.18586111,5.4121559 -0.1726988,6.614951 0.4382476,6.6606553 1.1701866,6.6354301 2.0901088,6.8653212 2.3114865,7.6677973 2.5690397,8.4182506 1.9757702,9.0009969 1.5707544,9.5375753 1.260194,10.111116 2.1887088,10.863746 2.6392394,10.30714 3.1282414,9.7691412 3.9518015,9.3917137 4.6315605,9.8249999 5.3287279,10.186762 5.2619381,11.018963 5.3869987,11.672161 5.5440075,12.215504 6.7794125,12.12358 6.6535582,11.446999 6.6654072,10.746236 6.9028479,9.8947057 7.6677558,9.6885901 8.4182253,9.4312024 9.000933,10.024446 9.5375381,10.429439 10.111007,10.739871 10.863873,9.8114259 10.307197,9.360908 9.7691358,8.8719351 9.3913098,8.0483184 9.8250144,7.3685614 10.18688,6.6714752 11.018948,6.7380091 11.672226,6.6131264 12.162952,6.4957229 11.998177,5.7860369 11.896733,5.4401 z M 5.999918,8.8061 C 4.4052236,8.8574703 3.0094365,7.3092614 3.2012542,5.7303585 3.3197775,4.2414555 4.7798203,3.0282413 6.2655218,3.2004993 7.7296227,3.3187202 8.9364572,4.7279379 8.805387,6.1941362 8.7186344,7.6148699 7.4347334,8.84471 5.999918,8.8061 z"}).appendTo(i);
        f.append(i);
        i = $(document.createElementNS("http://www.w3.org/2000/svg", "svg")).attr({width: 12, height: 12}).css({fill: "currentColor", stroke: "none", margin: "1px"});
        i.get(0).setAttribute("viewBox", "0 0 24 24");
        $(document.createElementNS("http://www.w3.org/2000/svg", "desc")).text("FS").appendTo(i);
        $(document.createElementNS("http://www.w3.org/2000/svg", "path")).attr({d: "M0 0v9l3.5-3.5 4.5 4.5h2v-2l-4.5-4.5 3.5-3.5h-9zm15 0l3.5 3.5-4.5 4.5v2h2l4.5-4.5 3.5 3.5v-9h-9zm-7 14l-4.5 4.5-3.5-3.5v9h9l-3.5-3.5 4.5-4.5v-2h-2zm6 0v2l4.5 4.5-3.5 3.5h9v-9l-3.5 3.5-4.5-4.5h-2z"}).appendTo(i);
        this._$fullscreenChartButton.append(i);
        this._$percButton.on("click", function (n) {
            n.preventDefault();
            n = r.model();
            var u = n.mainSeries(), i = u.priceScale(), t = i.properties();
            u.properties().lockScale.value() || (n.beginUndoMacro($.t("Toggle Percentage")), t.log.value() && n.setLogProperty(t.log, !1, i, $.t("Toggle Log Scale")), n.setPercentProperty(t.percentage, !t.percentage.value(), i, $.t("Toggle Percentage")), n.endUndoMacro())
        });
        this._$logButton.on("click", function (n) {
            n.preventDefault();
            n = r.model();
            var u = n.mainSeries(), i = u.priceScale(), t = i.properties();
            u.properties().lockScale.value() || (n.beginUndoMacro($.t("Toggle Log Scale")), t.percentage.value() && n.setPercentProperty(t.percentage, !1, i, $.t("Toggle Percentage")), n.setLogProperty(t.log, !t.log.value(), i, $.t("Toggle Log Scale")), n.endUndoMacro())
        });
        this._$autoScaleButton.on("click", function (n) {
            n.preventDefault();
            n = r.model();
            var i = n.mainSeries().priceScale(), t = i.properties();
            n.beginUndoMacro($.t("Toggle Auto Scale"));
            t.autoScale.value() && t.percentage.value() && n.setPercentProperty(t.percentage, !1, i, $.t("Toggle Percentage"));
            n.setAutoScaleProperty(t.autoScale, !t.autoScale.value(), i, $.t("Toggle Auto Scale"));
            n.endUndoMacro()
        });
        f.on("click", function (n) {
            n.preventDefault();
            f.addClass("active");
            r.showScalesProperties().on("remove", function () {
                f.removeClass("active")
            })
        });
        this._$dateRanges = $(document.createElement("div")).attr("class", "chart-controls-bar-buttons date-range-wrapper").appendTo(n.parent);
        r.withModel(null, function () {
            var n = r.model().mainSeries(), i = n.priceScale();
            t.updateScaleButtons();
            n.priceScaleChanged.subscribe(t, t.updateScaleButtons);
            i.properties().autoScale.subscribe(t, t.updateScaleButtons);
            t.updateDateRangeButtons();
            n.onStatusChanged().subscribe(t, t.updateDateRangeButtons);
            J77.enabled("update_timeframes_set_on_symbol_resolve") && n.onSymbolResolved().subscribe(t, t.updateDateRangeButtons);
            n.properties().lockScale.subscribe(t, t.updateDateRangeButtons);
            t.updateExtendedHoursButton();
            n.properties().extendedHours.subscribe(t, t.updateExtendedHoursButton);
            n.properties().interval.subscribe(t, t.updateExtendedHoursButton)
        });
        t.updateFullscreenChartButton();
        u = this.Q4.Q5;
        u && (u.layout.subscribe(this.updateFullscreenChartButton.bind(this)), u.maximizeCurrentChart.subscribe(this.updateFullscreenChartButton.bind(this)), this._$fullscreenChartButton.on("click", function () {
            u.activeChartWidget.setValue(r);
            u.maximizeCurrentChart.setValue(!u.maximizeCurrentChart.value())
        }))
    }

    return n.prototype.updateScaleButtons = function () {
        var n = this.Q4.model().mainSeries().priceScale().properties(), t = n.log.value(), i = n.percentage.value(), n = n.autoScale.value();
        this._$logButton.toggleClass("active", t);
        this._$percButton.toggleClass("active", i);
        this._$autoScaleButton.toggleClass("active", n)
    }, n.prototype.updateDateRangeButtons = function () {
        var r = this.Q4, n, t, i, u;
        if (r.model().mainSeries().status() != TradingView.Series.STATUS_LOADING && (n = r._dateRangeResolutions(), n.length))for (this._$dateRanges.empty(), t = 0; t < n.length; t++)i = n[t], u = $(document.createElement("a")).text(i.text), u.appendTo(this._$dateRanges), u.click({val: i.value, res: i.targetResolution}, function (n) {
            r.model().loadRange(n.data)
        })
    }, n.prototype.updateExtendedHoursButton = function () {
        this._$extendedHoursButton && (1440 > this.Q4.model().mainSeries().properties().interval.value() ? this._$extendedHoursButton.removeClass("disabled").toggleClass("active", !!this.Q4.model().mainSeries().extendedHours.value()).attr("title", "Extended Hours") : this._$extendedHoursButton.removeClass("active").addClass("disabled").attr("title", "Extended Hours are available for intraday only"))
    }, n.prototype.updateFullscreenChartButton = function () {
        var n = this.Q4.Q5;
        n && "s" !== n.layout.value() ? (this._$fullscreenChartButton.show(), this._$fullscreenChartButton.toggleClass("active", n.maximizeCurrentChart.value())) : this._$fullscreenChartButton.hide()
    }, n.prototype.updateUI = function () {
        this.updateScaleButtons()
    }, n
}();
D69 = function () {
    function n(i) {
        if (!(this instanceof n))throw new TypeError("SymbolSearch is a constructor");
        if (this._inputParserMixin = J77.enabled("symbol_search_parser_mixin") ? new D70(this) : void 0, i = i || {}, this._inputElement = $(i.input).get(0), !this._inputElement)throw new TypeError("options.input must be a DOM element, jQuery object or selector");
        if (this.$list = $(i.list).eq(0), 0 === this.$list.size() && delete this.$list, void 0 !== i.callback) {
            if ("function" != typeof i.callback)throw new TypeError("options.callback must be function");
            this._callback = i.callback
        }
        if (void 0 !== i.onValueChanged) {
            if ("function" != typeof i.onValueChanged)throw new TypeError("options.onValueChanged must be function");
            this._onValueChanged = i.onValueChanged
        }
        if (void 0 !== i.onEmptyApply) {
            if ("function" != typeof i.onEmptyApply)throw new TypeError("options.onEmptyApply must be function");
            this._onEmptyApply = i.onEmptyApply
        }
        if (i.ignoreInterval && (this._ignoreInterval = !0), n.resetStoredInterval(), i.hidePro && (this._hidePro = !0), i.allowMultipleSymbols && (this._allowMultipleSymbols = !0), void 0 !== i.onParse) {
            if ("function" != typeof i.onParse)throw new TypeError("options.onParse must be function");
            this._onParse = i.onParse
        }
        this._state = {};
        $(this._inputElement).data("symbol-search-instance", this);
        for (var u = this._boundListener = this._eventListener.bind(this), f = this.boundTimeoutListener = function (n) {
            setTimeout(function () {
                u(n)
            }, 0)
        }, r = 0; r < t.length; r++)if (t[r].immediate)$(this._inputElement).on(t[r].name, u); else $(this._inputElement).on(t[r].name, f);
        this._boundOnKeyDown = this._onKeyDown.bind(this);
        this._boundOnKeyPress = this._onKeyPress.bind(this);
        $(this._inputElement).on("keydown", this._boundOnKeyDown).on("keypress", this._boundOnKeyPress);
        this._eventListener();
        i.autoFocus && n.registerAutoFocus(this)
    }

    function i(n, t) {
        var i = Q16.supportedSymbolsTypes(), r = TVSettings.getValue("symboledit.filter");
        !i.some(function (n) {
            return n.value === r
        }) && 0 < i.length && (r = i[0].value);
        0 != i.length && (i.forEach(function (i) {
            var u = i.value;
            i = $('<a class="type-filter">').attr("href", "#" + u).text($.t(i.name));
            u === r && i.addClass("active");
            i.on("click", function (i) {
                i.preventDefault();
                t.find(".type-filter").removeClass("active");
                $(this).addClass("active");
                n.typeFilter(u);
                TVSettings.setValue("symboledit.filter", u)
            });
            i.appendTo(t)
        }), n.typeFilter(r))
    }

    function r(n, t) {
        var i = Q16.supportedExchangesList(), r = TVSettings.getValue("symboledit.exchangefilter"), u;
        !i.some(function (n) {
            return n.value === r
        }) && 0 < i.length && (r = i[0].value);
        0 != i.length && (u = $("<select>").appendTo(t), i.forEach(function (n) {
            var t = n.value, i = n.name || t, f = n.desc || i, t = $("<option>").attr("value", t).text($.t(i)).data("custom-option-text", $.t(f)).appendTo(u);
            n.value === r && t.attr("selected", !0)
        }), u.change(function () {
            var t = $(this).val() || "";
            TVSettings.setValue("symboledit.exchangefilter", t);
            n.exchangeFilter(t)
        }), u.selectbox({speed: 0, classHolder: "tv-unstyled-select-container tv-symbol-select"}), n.exchangeFilter(r))
    }

    function u(n) {
        return n.ctrlKey || n.metaKey || !n.charCode || !n.which || 32 >= n.which || /^(input|textarea)$/i.test(n.target.tagName) || D83.modalDialog ? !1 : !0
    }

    var t = [
        {name: "input", immediate: !0},
        {name: "sync", immediate: !0},
        {name: "keypress"},
        {name: "keydown"},
        {name: "keyup"},
        {name: "mousedown"},
        {name: "mouseup"},
        {name: "cut"},
        {name: "paste"}
    ];
    return n.registerAutoFocus = function (t) {
        if (t instanceof jQuery && (t = t.data("symbol-search-instance")), !(t instanceof n))throw new TypeError("arg must be an SymbolSearch instance of jQuery input with bound SymbolSearch object");
        TradingView.keyboardBinder.registerListener("symbolEdit", function (n) {
            u(n) && (n.preventDefault(), this.resetState(), this._skipAutoFocus = !0, this._inputElement.focus(), n = String.fromCharCode(n.charCode), "function" == typeof this._setInputValue ? this._setInputValue(n) : this._inputElement.value = n, this._eventListener())
        }.bind(t))
    }, n.prototype.resetState = function () {
        this._state = {}
    }, n.prototype.typeFilter = function (n) {
        if (0 < arguments.length)n !== this._state.typeFilter && (null == n ? delete this._state.typeFilter : this._state.typeFilter = n + "", delete this._state.keepListFor, this._onSelectionChanged()); else return this._state.typeFilter
    }, n.prototype.exchangeFilter = function (n) {
        if (0 < arguments.length)n !== this._state.exchangeFilter && (null == n ? delete this._state.exchangeFilter : this._state.exchangeFilter = n + "", delete this._state.keepListFor, this._onSelectionChanged()); else return this._state.exchangeFilter
    }, n.prototype._moveSelection = function (n) {
        if (this._state.suggestOptions && 0 !== this._state.suggestOptions.length) {
            var t = this.$list.find("tbody tr:not(.group-close):not(.hidden)"), i = this.$list.find("tr.symbol-edit-popup-active"), r = -1;
            i.length ? (r = t.index(i), n = Math.max(0, Math.min(r + n, t.length - 1))) : n = 0;
            r != n && (t = t.eq(n), r = t.data("item"), i.length && i.removeClass("symbol-edit-popup-active"), r.groupTitle ? (t.addClass("symbol-edit-popup-active"), this._$selectedGroupTitleRow = t, delete this._state.highlightIndex, this._scrollHighlightIntoView()) : (this._$selectedGroupTitleRow && (this._$selectedGroupTitleRow = null), i = this._state.suggestOptions.indexOf(r), this._highlightOption(~i && i || 0, !0)))
        }
    }, n.prototype._groupSetColapsed = function (n, t) {
        item = n.data("item") || {};
        item.groupTitle && this._groupListHandler && this._groupListHandler.setCollapsed(item.root, t)
    }, n.prototype._onKeyDown = function (n) {
        (40 === n.keyCode || 38 === n.keyCode) && (this._moveSelection(40 === n.keyCode ? 1 : -1), n.preventDefault());
        this._$selectedGroupTitleRow && (37 === n.keyCode || 39 === n.keyCode) && (this._groupSetColapsed(this._$selectedGroupTitleRow, 37 === n.keyCode), n.preventDefault())
    }, n.prototype._onKeyPress = function (n) {
        if (40 === n.keyCode || 38 === n.keyCode) {
            if (n.charCode)return;
            if (this._boundOnKeyDown) {
                $(this._inputElement).off("keydown", this._boundOnKeyDown);
                delete this._boundOnKeyDown;
                n.preventDefault();
                return
            }
            this._moveSelection(40 === n.keyCode ? 1 : -1);
            n.preventDefault()
        }
        13 === n.keyCode && (this._$selectedGroupTitleRow ? (this._groupSetColapsed(this._$selectedGroupTitleRow, !1), n.preventDefault()) : this.acceptTypeIn())
    }, n.prototype._eventListener = function (n) {
        n = this._inputElement;
        var t = this._getInputValue().toUpperCase(), i = !1;
        this._state.value !== t && (this._state.hasOwnProperty("value") && this._onValueChanged && this._onValueChanged(t), this._state.value = t, i = !0, this._inputParserMixin && this._inputParserMixin.parse());
        this._fixIntervalCase();
        t = this._limitInputSelectionValue("selectionStart");
        this._state.selectionStart !== t && (this._state.selectionStart = t, i = !0);
        t = this._limitInputSelectionValue("selectionEnd");
        this._state.selectionEnd !== t && (this._state.selectionEnd = t, i = !0);
        this._state.selectionDirection !== n.selectionDirection && (this._state.selectionDirection = n.selectionDirection, i = !0);
        i && (this._onSelectionChanged(), i = !1, this._getInputValue() !== this._state.value && (this._setInputValue(this._state.value), i = !0), (i || this._state.selectionStart !== this._limitInputSelectionValue("selectionStart") || this._state.selectionEnd !== this._limitInputSelectionValue("selectionEnd")) && n.setSelectionRange(this._state.selectionStart, this._state.selectionEnd, this._state.selectionDirection))
    }, n.prototype._fixIntervalCase = function () {
        if (this._selectionInsideInterval()) {
            var t = n.detachInterval(this._inputElement.value);
            /[a-z]/.test(t.detached) && (this._inputElement.value = t.rest + t.detached.toUpperCase())
        }
    }, n.prototype._selectionInsideInterval = function (t) {
        if (this._ignoreInterval)return!1;
        var i = n.detachInterval(this._inputElement.value);
        return i ? "string" == typeof t ? this._inputElement[t] > i.rest.length : this._inputElement.selectionStart > i.rest.length && this._inputElement.selectionEnd > i.rest.length : !1
    }, n.prototype._limitInputSelectionValue = function (t) {
        return this._selectionInsideInterval(t) ? n.detachInterval(this._inputElement.value).rest.length : this._inputElement[t]
    }, n.prototype._getInputValue = function () {
        if (this._ignoreInterval)return this._inputElement.value;
        var t = n.detachStoreInterval(this._inputElement.value);
        return $(this._inputElement).toggleClass("interval-error", n.intervalError()), t
    }, n.prototype._setInputValue = function (t) {
        this._inputElement.value = this._ignoreInterval ? t : n.recallAttachInterval(t)
    }, n.prototype._onSelectionChanged = function () {
        function i(t, i, r, u) {
            n._state.contextTicker = t;
            n._state.contextExchange = i;
            n._state.contextType = r;
            n._state.keepListFor && n._state.keepListFor === u || (n._getSuggestList(), delete n._state.keepListFor)
        }

        var n = this, t;
        if (this._inputParserMixin)this._inputParserMixin.onSelectionChanged(i); else t = this._state.value, i(t, this._state.exchangeFilter, this._state.typeFilter, this._state._selectedTicker || t)
    }, n.prototype._clearSelectionState = function () {
        delete this._state.contextTicker;
        delete this._state.contextExchange;
        delete this._state.contextType;
        delete this._state.contextToken;
        delete this._state.keepListFor
    }, n.prototype._getSuggestList = function () {
        var n = this, t = this._state.contextTicker || "", i = this._state.contextExchange || this._state.exchangeFilter || "", r = this._state.typeFilter || "";
        this._showLoading();
        Q16.searchSymbolsByName(t, i, r, "undefined" != typeof Q3 ? Q3 : void 0, function (u) {
            t === (n._state.contextTicker || "") && i === (n._state.contextExchange || n._state.exchangeFilter || "") && r === (n._state.typeFilter || "") && n._renderSuggestList(u)
        })
    }, n.prototype._showLoading = function () {
        this.$list && (this._clearSuggestList(), $('<div class="symbol-search-loading">').appendTo(this.$list))
    }, n.prototype._renderSuggestList = function (t) {
        var o, i, r, f, e;
        if (this.$list) {
            o = this;
            i = this._state;
            this._clearSuggestList();
            var h = i.suggestOptions = [], s = RegExpEscape(i.contextTicker).trim(), u = new RegExp(s.replace(" ", "|"), "i" + (1 < s.length ? "g" : ""));
            if (delete i.highlightIndex, this._hidePro && (t = t.filter(function (n) {
                return!n.params || -1 === n.params.indexOf("pro")
            })), 0 === t.length)this.$list.html('<div style="text-align: center; padding: 7px 0; font-style: italic;">' + $.t("No symbols matched your criteria") + "<\/div>"); else {
                r = $('<table class="symbol-edit-popup">').appendTo(this.$list);
                f = new n.GroupListHandler(r, u);
                t.forEach(function (n) {
                    n.ticker || (n.ticker = n.full_name);
                    var t = $('<tr class="symbol-edit-popup">'), i = $('<td class="symbol-edit-popup-td name apply-overflow-title">');
                    i.html(n.symbol.replace(u, "<strong>$&<\/strong>"));
                    i.appendTo(t);
                    $('<td class="symbol-edit-popup-td desc apply-overflow-title">').html(u.test(n.symbol) ? n.description : n.description.replace(u, "<strong>$&<\/strong>")).appendTo(t);
                    i = $('<td class="symbol-edit-popup-td type apply-overflow-title">').appendTo(t);
                    "undefined" != typeof n.params && ~n.params.indexOf("eod") && ($("<i>").text("eod").addClass("eod").prependTo(i), i.append("&nbsp;"));
                    switch (n.type) {
                        case"index":
                            i.append($.t(n.type));
                            break;
                        default:
                            i.append($.t(n.type) + " - " + n.exchange)
                    }
                    i.appendTo(t);
                    "futures" == n.type ? f.append(n, t) : t.appendTo(r);
                    t.data("item", n);
                    n._$tr = t
                });
                f.collapse();
                this._groupListHandler = f;
                r.find("tbody > tr:not(.group-close)").each(function (n, t) {
                    $tr = $(t);
                    item = $tr.data("item");
                    h.push(item);
                    item.ticker === i.contextTicker && item.exchange === i.contextExchange && void 0 === e && (e = n)
                });
                void 0 !== e && this._highlightOption(e);
                r.on("click", "tr", function (n) {
                    n.isDefaultPrevented() || (n.preventDefault(), o._state.suggestOptions && (n = $(this).data("item")) && n.full_name && o.accept(n.full_name, n.ticker))
                })
            }
        }
    }, n.prototype._highlightOption = function (n, t) {
        var i = this._state;
        i.highlightIndex !== n && (void 0 !== i.highlightIndex && i.suggestOptions[this._state.highlightIndex]._$tr.removeClass("symbol-edit-popup-active"), i.highlightIndex = n, i.suggestOptions[n]._$tr.addClass("symbol-edit-popup-active"), this._scrollHighlightIntoView(), t && this._replaceCurrentSymbol())
    }, n.prototype._scrollHighlightIntoView = function () {
        $tr = this.$list.find("tr.symbol-edit-popup-active");
        $tr.length && ($tr.offset().top < this.$list.offset().top ? this.$list.scrollTop(this.$list.scrollTop() - (this.$list.offset().top - $tr.offset().top)) : $tr.offset().top + $tr.outerHeight() > this.$list.offset().top + this.$list.outerHeight() && this.$list.scrollTop(this.$list.scrollTop() + ($tr.offset().top + $tr.outerHeight() - (this.$list.offset().top + this.$list.outerHeight()))))
    }, n.prototype._clearSuggestList = function () {
        delete this._state.suggestOptions;
        this.$list && this.$list.empty()
    }, n.prototype._showErrorNotice = function () {
        this.$list && (this._clearSuggestList(), this.$list.text("Invalid expression"))
    }, n.prototype._replaceCurrentSymbol = function () {
        var t = this._state;
        if (t.suggestOptions && void 0 !== t.highlightIndex) {
            var n = t.suggestOptions[t.highlightIndex], i = "", r = 0;
            if (this._inputParserMixin) {
                if (n = this._inputParserMixin.replaceCurrentSymbol(n), !n.ok)return;
                i = n.newValue;
                r = n.newCaretPos;
                t.keepListFor = n.keepListFor
            } else i = n.symbol, r = i.length, this._state._selectedTicker = t.keepListFor = n.ticker || n.symbol;
            this._setInputValue(i);
            this._inputElement.setSelectionRange(r, r);
            this._eventListener()
        }
    }, n.prototype.splitAndAcceptUserInput = function () {
        for (var t = this._getInputValue().split(","), n = 0; n < t.length; n++)this.acceptSymbolIn(t[n])
    }, n.prototype.acceptSymbolIn = function (n) {
        var t, i;
        this._inputParserMixin ? t = this._inputParserMixin.parseSymbol(n) : (t = n, i = this._state._selectedTicker || n);
        this.accept(t, i)
    }, n.prototype.acceptTypeIn = function () {
        this._allowMultipleSymbols ? this.splitAndAcceptUserInput() : this.acceptSymbolIn(this._getInputValue())
    }, n.prototype.accept = function (t, i) {
        if (i = i || t) {
            delete this._state.keepListFor;
            var r = this._ignoreInterval ? void 0 : n.getInterval(!0);
            this._inputElement.value = t;
            this._eventListener();
            this._callback && this._callback(i, r);
            $(this._inputElement).trigger("accept-symbol", [i])
        }
    }, n.prototype.bindListWrapper = function (n) {
        if (n = $(n).eq(0), 0 === n.size())throw new TypeError("element must be a DOM element, jQuery object or selector");
        this.$list = n;
        this._clearSelectionState();
        this._eventListener()
    }, n.prototype.removeListWrapper = function () {
        delete this.$list;
        this._clearSuggestList();
        this._clearSelectionState();
        this._eventListener()
    }, n.showDialog = function (t) {
        var e, u, s, f, o, h, c;
        if (t = t || {}, !D83.get("Symbol Search")) {
            e = D83.createDialog("Symbol Search", {hideTitle: !0, hideCloseCross: !0, dragHandle: ".filter", width: "650px", content: TradingView.templates.dialogs.symbolSearch});
            D83.positionDialog(e);
            u = e.find(".tv-dialog-content").addClass("symbol-search-dialog");
            s = u.find(".results");
            s.mousewheel(function (n, t) {
                var i = $(this);
                0 < t ? i.scrollTop(i.scrollTop() - 15) : i.scrollTop(i.scrollTop() + 15)
            });
            f = u.find("input").get(0);
            t.initialValue && (f.value = t.initialValue);
            f.selectionStart = f.selectionEnd = f.value.length;
            f.focus();
            "undefined" != typeof D70 && (t.ignoreInterval || (h = n.getInputValueGetter(f), c = n.getInputValueSetter(f)), o = D70.addSpreadActions(u.find(".spread-actions"), f, h, c));
            o = new n({input: f, list: u.find(".results").get(0), callback: function (n, i) {
                t.callback && t.callback(n, i);
                D83.destroy("Symbol Search")
            }, onParse: o, ignoreInterval: t.ignoreInterval});
            u = u.find(".filter");
            i(o, u);
            u = $('<div class="exchange-filter">').appendTo(u);
            r(o, u);
            D83.resizeContent(e.height(), s);
            D83.applyHandlers(e);
            D83.positionDialog(e);
            e.on("destroy", function () {
                TVSettings.setValue("symboledit.dialog_last_entry", f.value)
            });
            return e
        }
    }, n.bindToInput = function (t, u) {
        function v() {
            f && (e.removeListWrapper(), f.off(), f.remove(), f = null)
        }

        function h(n) {
            n.preventDefault()
        }

        var w, b, e, o, s;
        u = u || {};
        t = $(t).eq(0);
        var y = u.callback, c = null, l = null, f = null, p = void 0, a = u.spreadActions && $(u.spreadActions).eq(0);
        a && a.size() && "undefined" != typeof D70 && (u.ignoreInterval || (w = n.getInputValueGetter(t.get(0)), b = n.getInputValueSetter(t.get(0))), p = D70.addSpreadActions(a, t.get(0), w, b));
        e = new n({input: t, onValueChanged: function () {
            var s;
            if (!f) {
                var n = e, t = $('<div class="symbol-edit-popup">').appendTo(document.body), o = $('<div class="filter">').appendTo(t);
                i(n, o);
                s = $('<div class="exchange-filter">').appendTo(o);
                r(n, s);
                var s = $('<div class="table-wrapper">').appendTo(t), u = $(n._inputElement), n = u.offset();
                leftOffset = Math.max(0, Math.min(n.left + 0, $(window).width() - t.outerWidth()));
                t.css("right", leftOffset + 3 + "px");
                t.css("top", n.top + u.outerHeight() + 1);
                var c = parseInt($(window).height(), 10), o = o.outerHeight(), l = $(window).scrollTop(), u = u.height();
                s.css("maxHeight", c - (n.top - l) - u / 2 - u - o + "px");
                f = t;
                e.bindListWrapper(s);
                f.on("focus", "*", h);
                f.on("click", "*", h);
                f.on("mousedown", "*", h)
            }
        }, callback: function (n, i) {
            v();
            "function" == typeof l && l(n, i) || ("function" == typeof y && y(n, i), "function" == typeof c && c(n, i));
            u.clearAfterAccept && t.val("");
            u.keepFocus ? t.get(0).focus() : t.get(0).blur();
            e.resetState()
        }, hidePro: u.hidePro, autoFocus: u.autoFocus, onEmptyApply: u.onEmptyApply, onParse: p, allowMultipleSymbols: u.allowMultipleSymbols, ignoreInterval: u.ignoreInterval});
        o = !1;
        t.on("focus", function () {
            o = !0;
            e._skipAutoFocus ? delete e._skipAutoFocus : setTimeout(function () {
                o && t.get(0).select()
            }, 0)
        });
        t.on("blur", function () {
            o = !1;
            setTimeout(function () {
                o || v()
            }, 0)
        });
        if (u.syncWithChartWidget) {
            s = function (n) {
                n = n && D45.seriesShortSymbol.value() || D45.symbol.value() || "";
                t.val(n);
                e.resetState()
            };
            s(!0);
            D45.seriesShortSymbol.subscribe(function () {
                s(!0)
            });
            c = function (n, t) {
                n && D45.symbol.setValue(n);
                t && D45.interval.setValue(t)
            };
            l = function (n, t) {
                return t ? !1 : n === D45.symbol.value() || n === D45.seriesShortSymbol.value() ? !0 : void 0
            };
            t.on("keypress", function (n) {
                27 === n.keyCode && (t.get(0).blur(), s(!1))
            });
            t.on("keydown", function (n) {
                27 === n.keyCode && (t.get(0).blur(), s(!1))
            })
        }
        return e
    }, n.GroupListHandler = function (n, t) {
        this._$container = n;
        this._tickerRegExp = t;
        this._roots = {}
    }, n.GroupListHandler.prototype.addRoot = function (n, t, i) {
        var u = this, r = i.clone().addClass("group-title").click(function (t) {
            t.preventDefault();
            u[r.hasClass("collapsed") ? "expand" : "collapse"](n)
        });
        r.find("td.name").html("<div>" + n.replace(this._tickerRegExp, "<strong>$&<\/strong>") + "<\/div>");
        r.find("td.type").html(t.type);
        r.appendTo(this._$container);
        r.data("item", {groupTitle: !0, root: n});
        t = $('<tr class="group-close"><td colspan="3"><\/td><\/tr>').appendTo(this._$container);
        this._roots[n] = {titleRow: r, closeRow: t}
    }, n.GroupListHandler.prototype.append = function (n, t) {
        var i = /^(.+)([12]!|\w\d{4})$/.exec(String(n.symbol));
        i ? (i = i[1], this._roots[i] || this.addRoot(i, n, t), t.addClass("root-" + i).insertBefore(this._roots[i].closeRow)) : t.appendTo(this._$container)
    }, n.GroupListHandler.prototype.setCollapsed = function (n, t) {
        if (n) {
            if (this._roots[n]) {
                var i = !0 === t ? "addClass" : "removeClass";
                this._roots[n].titleRow[i]("collapsed");
                this._$container.find("tr.root-" + n)[i]("hidden")
            }
        } else for (n in this._roots)this.setCollapsed(n, t)
    }, n.GroupListHandler.prototype.collapse = function (n) {
        this.setCollapsed(n, !0)
    }, n.GroupListHandler.prototype.expand = function (n) {
        this.setCollapsed(n, !1)
    }, n.isIntervalInit = function (n) {
        return/[\d,]/.test(n) && J77.enabled("show_interval_dialog_on_key_press")
    }, n.isIntervalChar = function (n) {
        return/[\dhdwm]/i.test(n)
    }, n.parseIntervalValue = function (n) {
        var t = /^[,\s]*(\d*)\s*([hdwm]?)\s*$/i.exec(n) || [], i;
        return n = ~~t[1], t = t[2] && t[2].toUpperCase(), i = {qty: !n && t ? 1 : n, unit: t || null}, i.error = !n && !t, i.intraday = !i.error && (!i.unit || "H" == i.unit), i
    }, n.sanitizeIntervalValue = function (t) {
        t = n.parseIntervalValue(t);
        var i = t.qty, r = t.unit;
        return t.error ? null : ("H" == r && (i *= 60, r = null), i && !r ? String(i) : !r || i && 1 != i ? i + r : r)
    }, n.detachInterval = function (n) {
        var t = /,[^,]*$/i.exec(n) || [];
        if (t[0])return{rest: n.substr(0, n.length - t[0].length), detached: t[0]}
    }, n.intervalIsSupported = function (t) {
        if (t = n.parseIntervalValue(t), t.error)return!1;
        if (t.intraday)return D45.intraday.value();
        var i = D45.supportedResolutions.value();
        return i ? !!~i.indexOf(t.unit) : !0
    }, function () {
        var t = "", i = null;
        n.resetStoredInterval = function () {
            t = "";
            i = null
        };
        n.detachStoreInterval = function (r) {
            var u = n.detachInterval(r);
            return u ? (t = u.detached, i = n.sanitizeIntervalValue(t), u.rest) : (n.resetStoredInterval(), r)
        };
        n.recallAttachInterval = function (n) {
            return n + t
        };
        n.getInterval = function (t) {
            var r = i;
            return!0 === t && n.resetStoredInterval(), r
        };
        n.getInputValueGetter = function (t) {
            return function () {
                return n.detachStoreInterval(t.value)
            }
        };
        n.getInputValueSetter = function (t) {
            return function (i) {
                t.value = n.recallAttachInterval(i)
            }
        };
        n.intervalError = function () {
            return!t || /^,\s*$/.test(t) ? !1 : !i
        }
    }(), n.registerDialogKeypressHandler = function (t) {
        if (!t)throw new TypeError("Q3 is required");
        TradingView.keyboardBinder.pushBackListener("symbolEdit", function (t) {
            u(t) && (t.preventDefault(), t = String.fromCharCode(t.charCode), n.isIntervalInit(t) ? new ChangeIntervalDialog({callback: function (n) {
                D45.interval.setValue(n)
            }}).show(t) : n.showDialog({initialValue: t, callback: function (n, t) {
                D45.symbol.setValue(n);
                t && D45.interval.setValue(t)
            }}))
        })
    }, n
}();
TradingView.MiniChartWidget = function (n, t, i) {
    this._plots = $.map(n || [], function (n) {
        return new TradingView.MiniChartPlot(n.data, n.options)
    });
    this.$container = t;
    this._options = TradingView.merge(this.defaults(), i || {});
    this._ctx = this._canvas = null;
    this._initCanvas();
    n = function () {
        return this._plots
    }.bind(this);
    this._xScale = new TradingView.MiniChartXScale(n, this._ctx, this._options.xScale);
    this._yScale = new TradingView.MiniChartYScale(n, this._ctx, this._options.yScale);
    this._plotArea = new TradingView.MiniChartPlotArea(n, this._ctx, this._xScale, this._yScale, {grid: this._options.grid, plot: this._options.plot});
    this.height = new WatchedValue(0);
    this.width = new WatchedValue(0);
    this._initSizeHandling();
    this.resetSize();
    this.bindOnResize()
};
TradingView.MiniChartWidget.prototype.defaults = function () {
    return{minWidth: 100, minHeight: 75, bgColor: null, grid: {xIsVisible: !0, yIsVisible: !0, line: {width: 1, style: CanvasEx.LINESTYLE_DASHED, color: "#e9e9ea"}}, xScale: {visible: !0, position: "bottom", isTimeScale: !0, paddingTop: 4, paddingBottom: 4, font: {size: 10, family: "Helvetica", color: "#83888d"}, drawOverPlotArea: !0, bgColor: "transparent", borderColor: "#83888d", drawTickMarkLine: !1, maxTickMarkAmount: 10}, yScale: {visible: !0, position: "right", isPercentage: !1, paddingLeft: 4, paddingRight: 4, marginInPercents: 10, font: {size: 10, family: "Helvetica", color: "#83888d"}, drawOverPlotArea: !0, bgColor: "transparent", borderColor: "#83888d", drawTickMarkLine: !1, maxTickMarkAmount: 10}, plot: {line: {width: 2, color: "#ff7965"}, belowLineFillStyle: "rgba(180, 180, 180, 0.2)", aboveLineFillStyle: null}}
};
TradingView.MiniChartWidget.prototype._initCanvas = function () {
    this._canvas = TradingView.addCanvasTo(this.$container, {w: this._options.minWidth, h: this._options.minHeight});
    $(this._canvas).css("display", "block");
    this._ctx = this._canvas.getContext("2d");
    this._ctx._fillText = function (n, t, i) {
        t = Math.round(t);
        i = Math.round(i);
        this._ctx.fillText(n, t, i)
    }.bind(this)
};
TradingView.MiniChartWidget.prototype._initSizeHandling = function () {
    function u() {
        var n = t._options.drawOverPlotArea || !t._options.visible ? r.height.value() : r.height.value() - t.height.value();
        i.height.setValue(n)
    }

    function f() {
        var t = n._options.drawOverPlotArea || !n._options.visible ? r.width.value() : r.width.value() - n.width.value();
        i.width.setValue(t)
    }

    function e() {
        var t = 0;
        "right" === n._options.position && (t = n._options.drawOverPlotArea || !n._options.visible ? i.width.value() - n.width.value() : i.width.value());
        n.originX.setValue(t)
    }

    var r = this, t = this._xScale, n = this._yScale, i = this._plotArea;
    r.height.subscribe(u);
    t.height.subscribe(u);
    i.height.subscribe(function (r) {
        n.height.setValue(r);
        r = 0;
        "bottom" === t._options.position && (r = t._options.drawOverPlotArea || !t._options.visible ? i.height.value() - t.height.value() : i.height.value());
        t.originY.setValue(r)
    });
    r.width.subscribe(f);
    n.width.subscribe(f);
    n.width.subscribe(e);
    i.width.subscribe(function (n) {
        t.width.setValue(n);
        e()
    })
};
TradingView.MiniChartWidget.prototype.resetSize = function () {
    var n = this.$container.height() || this._options.minHeight, t = this.$container.width() || this._options.minWidth;
    this._xScale.originX.setValue("left" === this._yScale._options.position ? this._yScale.width() : 0);
    this._yScale.originY.setValue("top" === this._xScale._options.position ? this._xScale.height() : 0);
    TradingView.setCanvasSize(this._canvas, {h: n, w: t});
    this.height.setValue(n);
    this.width.setValue(t)
};
TradingView.MiniChartWidget.prototype.onResize = function () {
    this.resetSize();
    this.draw()
};
TradingView.MiniChartWidget.prototype.bindOnResize = function () {
    this._onResize || (this._onResize = this.onResize.bind(this));
    this.$container.resize(this._onResize)
};
TradingView.MiniChartWidget.prototype.unbindOnResize = function () {
    this._onResize && (this.$container.off("resize", this._onResize), delete this._onResize)
};
TradingView.MiniChartWidget.prototype.addPlot = function (n) {
    var t = n, i = this, r, u;
    if (!(t instanceof TradingView.MiniChartPlot)) {
        if (!t.data) {
            console.error("[MiniChartWidget] wrong plot format");
            return
        }
        t = new TradingView.MiniChartPlot(t.data, $.extend(!0, {}, this._options.plot, t.options))
    }
    if (!$.grep(i._plots, function (n) {
        return n.id === t.id
    }).length)return i._plots.push(t), r = i._yScale, u = i._xScale, t.dataChanged.subscribe(null, function () {
        r.onPlotsChanged.call(r);
        u.onPlotsChanged.call(u);
        i.draw()
    }), r.onPlotsChanged.call(r), u.onPlotsChanged.call(u), i.draw(), t
};
TradingView.MiniChartWidget.prototype.removePlot = function (n) {
    this._plots = $.grep(this._plots, function (t) {
        return t.id !== n.id
    });
    this._yScale.onPlotsChanged.call(this._yScale);
    this._xScale.onPlotsChanged.call(this._xScale);
    this.draw()
};
TradingView.MiniChartWidget.prototype.removeAllPlots = function () {
    this._plots = [];
    this._yScale.onPlotsChanged.call(this._yScale);
    this._xScale.onPlotsChanged.call(this._xScale);
    this.draw()
};
TradingView.MiniChartWidget.prototype.draw = function () {
    this._plotArea.draw();
    this._yScale.draw();
    this._xScale.draw()
};
TradingView.MiniChartWidget.prototype.showMessage = function (n) {
    this._options.showMessage && this._writeMessage(n)
};
TradingView.MiniChartWidget.prototype.writeText = function (n) {
    console.info("[MiniChartWidget] " + n)
};
TradingView.MiniChartPlot = function (n, t) {
    this.id = TradingView.guid();
    this._options = $.extend(!0, {}, t);
    this._y = this._x = null;
    this.setData(n, !0);
    this.dataChanged = new Delegate
};
TradingView.MiniChartPlot.prototype.setData = function (n, t) {
    n.x && n.y || console.error("[MiniChartPlot] wrong data format");
    this._x = n.x;
    this._y = n.y;
    t || this.dataChanged.fire()
};
TradingView.MiniChartPlot.prototype.x = function () {
    return this._x
};
TradingView.MiniChartPlot.prototype.y = function (n) {
    var t = this._y, i;
    return n ? (i = t[0] / 100, $.map(t, function (n) {
        return n / i - 100
    })) : t
};
TradingView.MiniChartWidgetRectangle = function (n, t, i, r) {
    this.originX = new WatchedValue(n || 0);
    this.originY = new WatchedValue(t || 0);
    this.width = new WatchedValue(i || 0);
    this.height = new WatchedValue(r || 0)
};
TradingView.MiniChartWidgetRectangle.prototype.left = function () {
    return this.originX.value()
};
TradingView.MiniChartWidgetRectangle.prototype.right = function () {
    return this.originX.value() + this.width.value()
};
TradingView.MiniChartWidgetRectangle.prototype.top = function () {
    return this.originY.value()
};
TradingView.MiniChartWidgetRectangle.prototype.bottom = function () {
    return this.originY.value() + this.height.value()
};
TradingView.MiniChartWidgetRectangle.prototype.clearBack = function () {
    var n = this._ctx;
    this._options.bgColor && "transparent" !== this._options.bgColor ? (n.fillStyle = this._options.bgColor, n.fillRect(this.left(), this.top(), this.right(), this.bottom())) : n.clearRect(this.left(), this.top(), this.right(), this.bottom())
};
TradingView.MiniChartPlotArea = function (n, t, i, r, u) {
    TradingView.MiniChartWidgetRectangle.call(this);
    this.getWidgetPlots = n;
    this._ctx = t;
    this._xScale = i;
    this._yScale = r;
    this._options = u;
    this.originY.setValue("bottom" === this._xScale._options.position ? 0 : this._xScale.height.value());
    this.originY.setValue = function () {
        console.warn("[MiniChartPlotArea] updating originY forbidden")
    }
};
inherit(TradingView.MiniChartPlotArea, TradingView.MiniChartWidgetRectangle);
TradingView.MiniChartPlotArea.prototype.draw = function () {
    this.clearBack();
    this._drawGrid();
    this._drawPlots()
};
TradingView.MiniChartPlotArea.prototype._drawGrid = function (n) {
    var r, t;
    n = this._ctx;
    var s = this.left(), h = this.right(), i = this.top(), c = this.bottom(), u, f, e, o;
    if (n.lineWidth = this._options.grid.line.width, n.strokeStyle = this._options.grid.line.color, n.lineStyle = this._options.grid.line.style, r = this._xScale.tickMarks(), r.length && this._options.grid.xIsVisible)for (t = 0; t < r.length; t++)u = r[t].coordinate, f = i, e = r[t].coordinate, o = c, CanvasEx.drawLine(n, u, f, e, o);
    if (i = this._yScale.tickMarks(), i.length && this._options.grid.yIsVisible)for (t = 0; t < i.length; t++)u = s, f = i[t].coordinate, e = h, o = i[t].coordinate, CanvasEx.drawLine(n, u, f, e, o)
};
TradingView.MiniChartPlotArea.prototype._drawPlots = function (n) {
    var r = this.getWidgetPlots(), t = this._ctx;
    this._xScale.valueToCoord.bind(this._xScale);
    this._yScale.valueToCoord.bind(this._yScale);
    for (var e = this.left(), o = this.right(), s = this.top(), h = this.bottom(), u, f, i = 0; i < r.length; i++)n = r[i], u = n.x(), f = n.y(this._yScale._options.isPercentage), n._options.belowLineFillStyle && "transparent" !== n._options.belowLineFillStyle && (t.beginPath(), t.fillStyle = n._options.belowLineFillStyle, t.moveTo(e, h), this._walkNearLine(u, f), t.lineTo(o, h), t.closePath(), t.fill()), n._options.aboveLineFillStyle && "transparent" !== n._options.aboveLineFillStyle && (t.beginPath(), t.fillStyle = n._options.belowLineFillStyle, t.moveTo(e, s), this._walkNearLine(u, f), t.lineTo(o, s), t.closePath(), t.fill()), t.lineWidth = r[i]._options.line.width, t.strokeStyle = r[i]._options.line.color, t.beginPath(), this._walkNearLine(u, f), t.stroke()
};
TradingView.MiniChartPlotArea.prototype._walkNearLine = function (n, t) {
    for (var r = this._xScale.valueToCoord.bind(this._xScale), u = this._yScale.valueToCoord.bind(this._yScale), i = 0, f = n.length; i < f; i++)this._ctx.lineTo(r(n[i]) + .5, u(t[i]) + .5)
};
TradingView.MiniChartAbstractScale = function (n, t, i) {
    TradingView.MiniChartWidgetRectangle.call(this);
    this._ctx = t;
    this._options = i;
    this._max = this._min = null;
    this._tickMarks = [];
    this.getWidgetPlots = n
};
inherit(TradingView.MiniChartAbstractScale, TradingView.MiniChartWidgetRectangle);
TradingView.MiniChartAbstractScale.prototype._calculateTickMarks = function (n, t, i) {
    function h(n) {
        return Math.round(1e6 * n) / 1e6 + (u._options.isPercentage ? "%" : "")
    }

    function v(n) {
        var r = h(n);
        return(n = u.valueToCoord(n), "vertical" === i && !f) ? n : "vertical" === i && f ? n + .5 * t(r) : "horizontal" === i && !f ? n : "horizontal" === i && f ? n - .5 * t(r) : void 0
    }

    function y(n) {
        var r = h(n);
        return(n = u.valueToCoord(n), "vertical" === i && !f) ? n - u._GREED_MARGIN - t(r) : "vertical" === i && f ? n - .5 * t(r) : "horizontal" === i && !f ? n + u._GREED_MARGIN + t(r) : "horizontal" === i && f ? n + .5 * t(r) : void 0
    }

    function w(n, t) {
        return"vertical" === i ? y(n) - p > v(t) : y(n) + p < v(t)
    }

    var u = this, o = u._min, c = u._max, r, e, a, s;
    if (!n || null === o || null === c || "function" != typeof t)return[];
    i = i || "vertical";
    for (var l = u._options.maxTickMarkAmount || 10, p = u._options.maxTickMarkAmount || n / 20, f = !u._options.drawOverPlotArea; 0 < l;) {
        for (r = (c - o) / l, n = Math.pow(10, Math.ceil(Math.log(r) / Math.LN10)), n / 5 >= r && (n /= 5), n / 2 >= r && (n /= 2), e = Math.floor(o / n) * n, e < o && (e = Math.ceil(o / n) * n), r = [e]; r[r.length - 1] + n <= c;)r.push(r[r.length - 1] + n);
        for (n = !1, s = 1; s < r.length; s++)if (a = r[s], w(e, a))e = a; else {
            n = !0;
            break
        }
        if (n)l--; else break
    }
    return $.map(r, function (n) {
        return{text: h(n), coordinate: Math.round(u.valueToCoord(n))}
    })
};
TradingView.MiniChartAbstractScale.prototype.tickMarks = function () {
    return this._tickMarks
};
TradingView.MiniChartAbstractScale.prototype.draw = function () {
    var i, n, t;
    if (this._options.visible) {
        if (i = this._tickMarks, n = this._ctx, this._options.drawOverPlotArea || this.clearBack(), !this._options.drawOverPlotArea && this._options.borderColor && "transparent" !== this._options.bgColor) {
            n.strokeStyle = this._options.borderColor;
            n.lineWidth = 1;
            n.beginPath();
            switch (this._options.position) {
                case"left":
                    n.moveTo(this.right(), this.top());
                    n.lineTo(this.right(), this.bottom());
                    break;
                case"right":
                    n.moveTo(this.left(), this.top());
                    n.lineTo(this.left(), this.bottom());
                    break;
                case"top":
                    n.moveTo(this.left(), this.bottom());
                    n.lineTo(this.right(), this.bottom());
                    break;
                case"bottom":
                    n.moveTo(this.left(), this.top());
                    n.lineTo(this.right(), this.top())
            }
            n.stroke()
        }
        for (n.fillStyle = this._options.font.color, n.font = this._options.font.size + "px " + this._options.font.family, t = 0; t < i.length; t++)n = i[t], this._drawLabel(n.coordinate, n.text)
    }
};
TradingView.MiniChartXScale = function () {
    TradingView.MiniChartAbstractScale.apply(this, arguments);
    this._series = [];
    this.height.setValue(this._options.paddingBottom + this._options.font.size + this._options.paddingTop);
    this.height.setValue = function () {
        console.warn("[MiniChartXScale] updating height forbidden")
    };
    this.width.subscribe(this._updateSize.bind(this));
    this._GREED_MARGIN = 2
};
inherit(TradingView.MiniChartXScale, TradingView.MiniChartAbstractScale);
TradingView.MiniChartXScale.prototype.valueToCoord = function (n) {
    return this._pixelsPerValue * (n - this._min)
};
TradingView.MiniChartXScale.prototype.onPlotsChanged = function () {
    this._updateSeries();
    this._updateMinMax();
    this._updateSize()
};
TradingView.MiniChartXScale.prototype._updateSize = function () {
    this._updatePixelsPerValue();
    this._updateTickMarks()
};
TradingView.MiniChartXScale.prototype._updateSeries = function () {
    this._series = this.getWidgetPlots().length ? this.getWidgetPlots()[0].x() : []
};
TradingView.MiniChartXScale.prototype._updateMinMax = function () {
    this._min = this._series.length ? this._series[0] : null;
    this._max = this._series.length ? this._series[this._series.length - 1] : null
};
TradingView.MiniChartXScale.prototype._updatePixelsPerValue = function () {
    this._pixelsPerValue = this.width.value() / (this._max - this._min)
};
TradingView.MiniChartXScale.prototype._updateTickMarks = function () {
    var n = this.width.value(), t = function (n) {
        return this._ctx.measureText(n).width
    }.bind(this);
    this._tickMarks = this._options.isTimeScale ? this._calculateTimeTickMarks(n, t) : this._calculateTickMarks(n, t, "horizontal")
};
TradingView.MiniChartXScale.prototype._calculateTimeTickMarks = function (n, t) {
    var r, e, o;
    if (!n || null === this._min || null === this._max || "function" != typeof t)return[];
    var r = this._max - this._min, i = [], f = [], u = this._ctx;
    for (u.font = this._options.fontSize + "px " + this._options.fontFamily, u.fillStyle = this._options.fontColor, u.textBaseline = "bottom", 6 > r / 86400 ? i = this._timeSplit(n, t, this._trimToDay, this._formatDay) : 6 > r / 604800 ? i = this._timeSplit(n, t, this._trimToWeek, this._formatDay) : 15 > r / 2592e3 ? i = this._timeSplit(n, t, this._trimToMonth, this._formatMonthOnly) : (i = r / 31104e3, i = 6 > i ? this._timeSplit(n, t, this._trimToYear, this._formatYear) : 30 > i ? this._timeSplit(n, t, this._trimTo5Years, this._formatYear) : 50 > i ? this._timeSplit(n, t, this._trimTo10Years, this._formatYear) : this._timeSplit(n, t, this._trimTo25Years, this._formatYear)), r = 0, e = i.length; r < e; r++)o = this.valueToCoord(this._series[i[r].index]), i[r + 1] && this.valueToCoord(this._series[i[r + 1].index]), u.measureText(i[r].text), f.push({text: "" + i[r].text, coordinate: o});
    return f
};
TradingView.MiniChartXScale.prototype._timeSplit = function (n, t, i, r) {
    for (var e, c, s, l, a, u = [], o = null, h = n / 20, f = 0, v = this._series.length; f < v; f++)if (e = i.call(this, new Date(1e3 * this._series[f])), c = r.call(this, e), null === o)o = e; else {
        if (s = this.valueToCoord(this._series[f]), u.length && (l = this.valueToCoord(this._series[u[u.length - 1].index]), a = t(u[u.length - 1].d), !(l + a + h <= s)))continue;
        o.valueOf() !== e.valueOf() && s > h && s < n - h && (u.push({index: f, text: c}), o = e)
    }
    return u
};
TradingView.MiniChartXScale.prototype._trimToDay = function (n) {
    return new Date(n.getFullYear(), n.getMonth(), n.getDate())
};
TradingView.MiniChartXScale.prototype._trimToMonth = function (n) {
    return new Date(n.getFullYear(), n.getMonth(), 1)
};
TradingView.MiniChartXScale.prototype._trimToYear = function (n) {
    return new Date(n.getFullYear(), 1, 1)
};
TradingView.MiniChartXScale.prototype._trimToWeek = function (n) {
    return n = this._trimToDay(n), new Date(n.valueOf() - 864e5 * n.getDay())
};
TradingView.MiniChartXScale.prototype._trimTo5Years = function (n) {
    return n = n.getFullYear(), new Date(n - n % 5, 1, 1)
};
TradingView.MiniChartXScale.prototype._trimTo10Years = function (n) {
    return n = n.getFullYear(), new Date(n - n % 10, 1, 1)
};
TradingView.MiniChartXScale.prototype._trimTo25Years = function (n) {
    return n = n.getFullYear(), new Date(n - n % 25, 1, 1)
};
TradingView.MiniChartXScale.prototype._monthNames = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");
TradingView.MiniChartXScale.prototype._formatDay = function (n) {
    return this._monthNames[n.getMonth()] + "," + n.getDate()
};
TradingView.MiniChartXScale.prototype._formatMonthOnly = function (n) {
    return this._monthNames[n.getMonth()]
};
TradingView.MiniChartXScale.prototype._formatYear = function (n) {
    return n.getFullYear()
};
TradingView.MiniChartXScale.prototype._drawLabel = function (n, t) {
    var i = this._ctx, r = i.measureText(t).width;
    n = this._options.drawOverPlotArea ? n + this._GREED_MARGIN : n - r / 2;
    r = "bottom" === this._options.position ? this.bottom() - this._options.paddingBottom : this.top() + this._options.paddingTop + this._options.font.size;
    i.textBaseline = "bottom";
    i._fillText(t, n, r)
};
TradingView.MiniChartYScale = function () {
    TradingView.MiniChartAbstractScale.apply(this, arguments);
    this._max = this._min = null;
    this.height.subscribe(this._updateSize.bind(this));
    this._GREED_MARGIN = 1
};
inherit(TradingView.MiniChartYScale, TradingView.MiniChartAbstractScale);
TradingView.MiniChartYScale.prototype.onPlotsChanged = function () {
    this._updateMinMax();
    this._updateSize()
};
TradingView.MiniChartYScale.prototype._updateMinMax = function () {
    for (var r = this.getWidgetPlots(), n = null, t = null, u, f, i = 0; i < r.length; i++)u = MathEx.min(r[i].y(this._options.isPercentage)), f = MathEx.max(r[i].y(this._options.isPercentage)), (null === n || u < n) && (n = u), (null === t || t < f) && (t = f);
    this._min = n;
    this._max = t
};
TradingView.MiniChartYScale.prototype._updatePixelsPerValue = function () {
    this._pixelsPerValue = (this.height.value() - 2 * this._margin()) / (this._max - this._min)
};
TradingView.MiniChartYScale.prototype._updateTickMarks = function () {
    var n = this.height.value(), t = function () {
        return this._options.font.size
    }.bind(this);
    this._tickMarks = this._calculateTickMarks(n, t, "vertical")
};
TradingView.MiniChartYScale.prototype._updateSize = function () {
    this._updatePixelsPerValue();
    this._updateTickMarks();
    this.width.setValue(this._options.paddingLeft + this._maxLabelWidth() + this._options.paddingRight)
};
TradingView.MiniChartYScale.prototype._maxLabelWidth = function () {
    for (var n = 0, t = 0; t < this._tickMarks.length; t++)n = Math.max(n, this._ctx.measureText(this._tickMarks[t].text).width);
    return n
};
TradingView.MiniChartYScale.prototype._margin = function () {
    return this.height.value() * this._options.marginInPercents / 100
};
TradingView.MiniChartYScale.prototype.valueToCoord = function (n) {
    return this.height.value() - this._margin() - this._pixelsPerValue * (n - this._min)
};
TradingView.MiniChartYScale.prototype._drawLabel = function (n, t) {
    n = this._options.drawOverPlotArea ? n - this._GREED_MARGIN : n + this._options.font.size / 2;
    var i = "left" === this._options.position ? this.left() + this._options.paddingLeft : this.right() - this._options.paddingRight - this._maxLabelWidth();
    this._ctx.textBaseline = "bottom";
    this._ctx._fillText(t, i, n)
};
RenameChartDialog.prototype.show = function (n) {
    var i = $.Deferred(), t = D83.createDialog(this.title), r = function () {
        var n = t.find('input[name="name"]'), r = n.val();
        return r ? (i.resolve(r), D83.destroy(this.title)) : (D83.showError($.t("Please enter chart layout name"), D83.get(this.title)), n.focus()), !1
    }.bind(this);
    return t.css("width", "400px"), t.find(".tv-dialog-content").html('<div class="main"><form><p>' + this.label + ':<\/p><p class="tv-dialogs-name"><input type="text" name="name" maxlength="' + this.maxlength + '"/><\/p><p class="tv-dialog-right"><\/p><\/form><\/div>'), t.find("form").submit(r), $('<a class="tv-button wide ok">' + $.t("OK") + "<\/a>").click(r).css({"margin-right": "5px"}).appendTo(t.find(".tv-dialog-right")), $('<a class="tv-button wide cancel">' + $.t("Cancel") + "<\/a>").click(function () {
        D83.destroy(this.title)
    }.bind(this)).appendTo(t.find(".tv-dialog-right")), D83.positionDialog(t, {left: $(window).width() / 2 - t.width() / 2, top: $(window).height() / 2 - t.height() / 2}), D83.applyHandlers(t), t.find('input[name="name"]').val(n).focus().select(), i
};
LoadChartDialog.onChartLoaded = function () {
    this.itemsData && 0 < this.itemsData.length && this._refreshChartsList()
};
LoadChartDialog.QuickSearch = function (n, t, i) {
    this.fieldsExtractor = t;
    this.callback = i;
    this.regExps = [];
    n.subscribe(this, this.onInput)
};
LoadChartDialog.QuickSearch.prototype.onInput = function (n) {
    this.query = n;
    this.createRegexps(n);
    this.search()
};
LoadChartDialog.QuickSearch.prototype.createRegexps = function (n) {
    this.regExps = [];
    this.regExps.push(new RegExp("(" + n.split("").map(function (n) {
        return RegExpEscape(n)
    }).join(")(.*?)(") + ")", "i"))
};
LoadChartDialog.QuickSearch.prototype.match = function (n) {
    for (var r, u, i, t = 0; t < this.regExps.length; t++)for (r = this.regExps[t], r.lastIndex = 0, u = this.fieldsExtractor(n), i = 0; i < u.length; i++)if (r.test(u[i]))return!0;
    return!1
};
LoadChartDialog.QuickSearch.prototype.search = function () {
    for (var i, t = [], n = 0; n < this.items.length; n++)i = this.items[n], this.match(i) && t.push(i);
    this.callback(t, this.regExps)
};
LoadChartDialog.QuickSearch.prototype.setItems = function (n) {
    this.items = n
};
LoadChartDialog.SortObject = function (n) {
    this.isAscending = !1;
    this.sortingFunc = n;
    this.getPredicate = function () {
        return function (n, t) {
            var i = this.sortingFunc(n, t);
            return this.isAscending && (i *= -1), i
        }.bind(this)
    };
    this.inverse = function () {
        this.isAscending = !this.isAscending
    };
    this.setIsAscending = function (n) {
        return"boolean" == typeof n && (this.isAscending = n), this.isAscending
    };
    this.reset = function () {
        this.isAscending = !1
    }
};
LoadChartDialog.prototype.fieldsExtractor = function (n) {
    var t = LoadChartDialog.symbolWrap(n);
    return[n.title, t]
};
LoadChartDialog.prototype.saveFavorite = function (n, t) {
    t ? this.favorites[n] = t : delete this.favorites[n]
};
LoadChartDialog.prototype.filterFavorites = function () {
    var n = {};
    this.itemsData.map(function (t) {
        this.favorites.hasOwnProperty(t.id) && (n[t.id] = !0)
    }.bind(this));
    this.favorites = n
};
LoadChartDialog.prototype.getFavorite = function (n) {
    return this.favorites.hasOwnProperty(n)
};
LoadChartDialog.prototype._appendListItem = function (n) {
    var t = $('<div class="item">').appendTo(this.itemsList), r, i, u;
    n.active() && t.addClass("active");
    r = moment.unix(n.modified);
    i = $('<div class="value name first">').appendTo(t);
    J77.enabled("items_favoriting") && (u = $('<div class="icon-favorite">').appendTo(i).click(function (t) {
        this.saveFavorite(n.id, !this.getFavorite(n.id));
        this.filterFavorites();
        this.fillList();
        n.favoriteAction(this.favorites);
        t.stopPropagation()
    }.bind(this)), this.getFavorite(n.id) && u.addClass("active"));
    $('<span class="text">').text(n.title).appendTo(i);
    i = $('<div class="actions">').appendTo(t);
    $('<div class="icon-delete">').appendTo(i).click(function (t) {
        var r = this, i = $.Deferred();
        n.deleteAction(i);
        i.then(function () {
            r.removeItem(n)
        });
        t.stopPropagation()
    }.bind(this));
    $('<div class="value modified">').text(r.format("L LT")).appendTo(t);
    r = "" === n.symbol ? "multiple charts" : n.symbol + ", " + n.interval;
    $('<div class="value symbol last">').text(r).appendTo(t);
    t.click(function () {
        n.openAction()
    }.bind(this))
};
LoadChartDialog.prototype.removeItem = function (n) {
    n = this.itemsData.indexOf(n);
    -1 < n && this.itemsData.splice(n, 1);
    this.setChartsData(this.itemsData)
};
LoadChartDialog.prototype.modifiedCompare = function (n, t) {
    var i = n.modified;
    return moment(t.modified).diff(moment(i))
};
LoadChartDialog.prototype.nameCompare = function (n, t) {
    return n.title.localeCompare(t.title)
};
LoadChartDialog.symbolWrap = function (n) {
    return"" === n.symbol ? "multiple charts" : n.symbol + " " + n.interval
};
LoadChartDialog.prototype.symbolCompare = function (n, t) {
    return LoadChartDialog.symbolWrap(n).localeCompare(LoadChartDialog.symbolWrap(t))
};
LoadChartDialog.prototype.toolsCompare = function (n, t) {
    var i = n.toolsCount, r = t.toolsCount;
    return i < r ? -1 : i == r ? 0 : 1
};
LoadChartDialog.prototype.sortClick = function (n) {
    this.setSort($(n.target).data("sort"), !0);
    this.fillList()
};
LoadChartDialog.prototype.setSort = function (n, t) {
    var f = TVSettings.getValue("loadChartDialog.sort.field") || "modified", r = TVSettings.getValue("loadChartDialog.sort.asc") || "0", i = n || f, u = t ? "0" == r ? "1" : "0" : r, e;
    (!this.currentSortObj || (e = i != f)) && (this.currentSortObj = "name" == i ? this.nameSort : "symbol" == i ? this.symbolSort : "tools" == i ? this.toolsSort : this.sortObj, e && TVSettings.setValue("loadChartDialog.sort.field", i));
    this.currentSortObj.setIsAscending("1" == u);
    u != r && TVSettings.setValue("loadChartDialog.sort.asc", u);
    $.each(this.header.children(".item"), function () {
        $(this).data("sort");
        $(this)[$(this).data("sort") == i ? "addClass" : "removeClass"]("active")
    })
};
LoadChartDialog.prototype.sortList = function () {
    var n = [], t = [], i;
    this.matchedItems.map(function (i) {
        this.favorites.hasOwnProperty(i.id) ? n.push(i) : t.push(i)
    }.bind(this));
    void 0 !== this.currentSortObj && (i = this.currentSortObj.getPredicate(), t.sort(i), n.sort(i));
    this.matchedItems = n.concat(t)
};
LoadChartDialog.prototype.fillList = function () {
    var n = this;
    this.sortList();
    this.itemsList.children(".item").remove();
    $.each(this.matchedItems, function () {
        n._appendListItem(this)
    });
    this.highlightOccurrences(this.qs.regExps)
};
LoadChartDialog.prototype.searchResult = function (n) {
    this.matchedItems = n;
    this.fillList()
};
LoadChartDialog.prototype.updateChartsData = function (n) {
    this.setChartsData(n)
};
LoadChartDialog.prototype.updateFavoritesData = function (n) {
    this.favorites = n;
    this.itemsList && this.inputDelegate.fire(this.input.val())
};
LoadChartDialog.prototype._refreshChartsList = function () {
    this.qs.setItems(this.itemsData);
    this.inputDelegate.fire(this.input.val())
};
LoadChartDialog.prototype.setChartsData = function (n) {
    this.itemsList && (this.itemsData = n, this.qs.setItems(n), this.inputDelegate.fire(this.input.val()))
};
LoadChartDialog.prototype.layoutHeader = function () {
    var n = $('<div class="list-header">').appendTo(this.content);
    return $('<div class="item name first">').text($.t("Chart Layout Name")).data("sort", "name").appendTo(n), $('<div class="item modified">').text($.t("Last Modified")).data("sort", "modified").appendTo(n), $('<div class="item symbol last">').text($.t("Active Symbol")).data("sort", "symbol").appendTo(n), n
};
LoadChartDialog.prototype.resetSort = function () {
    this.sortObj.reset();
    this.nameSort.reset();
    this.symbolSort.reset();
    this.toolsSort.reset();
    this.currentSortObj = this.sortObj
};
LoadChartDialog.prototype.resetSearchClick = function () {
    this.input.val("").trigger("input").focus()
};
LoadChartDialog.prototype.show = function (n, t) {
    var i, r, f, u;
    this.options.width = "654px";
    this.options.content = '<div class="load-chart">' + (J77.enabled("new_chart_creation_available") ? '<a class="button new-chart">' + $.t("NEW CHART LAYOUT") + "<\/a>" : "") + '<div class="chart-search"><input type="text" name="q" value="" autocomplete="off" placeholder="' + $.t("Search") + '"><a class="input-reset"><\/a><div class="search-icon"><\/div><\/div><\/div>';
    i = D83.createDialog(this.title, this.options);
    D83.positionDialog(i);
    this.input = i.find(".chart-search input");
    this.inputReset = i.find(".chart-search .input-reset");
    this.content = $('<div class="list-content"><\/div>').appendTo(i.find(".load-chart"));
    this.header = this.layoutHeader();
    this.setSort();
    this.itemsListContainer = $('<div class="charts-list-container">').appendTo(this.content);
    this.itemsList = $('<div class="charts-list">').appendTo(this.itemsListContainer);
    this._scroll = new D59(this.itemsListContainer, this.itemsList, {showBottomShadow: !1});
    i.find(".new-chart").click(this.openNewChart);
    this.header.children(".item").click($.proxy(this, "sortClick"));
    this.inputReset.click($.proxy(this, "resetSearchClick"));
    this.input.on("input propertychange", function () {
        this._scroll.scrollTo(0);
        this.inputDelegate.fire(this.input.val());
        "" !== this.input.val() ? this.inputReset.show() : this.inputReset.hide()
    }.bind(this));
    J77.enabled("saveload_requires_authentication") && !is_authenticated && (this.content.hide(), r = $('<div class="please-log-in"><\/div>').appendTo(i.find(".load-chart")), $('<a href="#" class="link">You are not logged in. Please sign in.<\/a>').appendTo(r).click(function (n) {
        n.preventDefault();
        D83.destroy(this.title);
        D83.showSignInDialog(null, {mode: "signin"})
    }.bind(this)));
    this.favorites = t;
    this.setChartsData(n);
    f = this;
    D83.applyHandlers(i, {doNotCloseOnBgClickIfShadowbox: !0, beforeDestroy: function () {
        Q17.on("chart_loaded", LoadChartDialog.onChartLoaded, f)
    }});
    u = this.itemsListContainer;
    r && (u = r);
    D83.resizeContent(i.height(), u);
    D83.positionDialog(i)
};
LoadChartDialog.prototype.openNewChart = function () {
    window.open("/e/" + (is_authenticated ? "new/" : ""), "_blank")
};
LoadChartDialog.prototype.highlightOccurrences = function (n) {
    this.itemsList.children(".item").each(function () {
        var i = $(this).find(".value.name").find("span"), t = i.text(), t = LoadChartDialog.highlightText(t, n);
        i.html(t);
        i = $(this).find(".value.symbol");
        t = i.text();
        t = LoadChartDialog.highlightText(t, n);
        i.html(t)
    })
};
LoadChartDialog.highlightText = function (n, t) {
    var f, e, u, i, r;
    if (n = $("<div>").text(n).html(), 0 === t.length)return n;
    for (f = 0; f < t.length; f++) {
        if (e = t[f], e.lastIndex = 0, u = "", i = "", (i = e.exec(n)) && i.length)for (r = 1; r < i.length; r++)u = r % 2 ? u + ('<span class="match">$' + r + "<\/span>") : u + ("$" + r);
        if ((i = n.replace(e, u)) && i !== n)return i
    }
};
ChangeIntervalDialog.prototype._setInput = function () {
    this._input = $('<input type="text" class="change-interval-input" autocomplete="off" maxlength="4">');
    this._input.on("keypress", this._handleInput.bind(this)).on("input", function () {
        this._validate();
        this._updateCaption()
    }.bind(this)).on("blur", function () {
        setTimeout(this._submit.bind(this), 0)
    }.bind(this))
};
ChangeIntervalDialog.prototype._validate = function () {
    var n = this._input.val();
    this._parsed = D69.parseIntervalValue(n);
    this._valid = !this._parsed.error;
    (this._supported = !this._parsed.error && D69.intervalIsSupported(n)) && (!this._parsed.unit || "H" == this._parsed.unit) && 1440 < this._parsed.qty * ("H" == this._parsed.unit ? 60 : 1) && (this._supported = !1)
};
ChangeIntervalDialog.prototype._updateCaption = function () {
    var n;
    this._valid && this._supported ? (n = this._parsed.qty || 1, n = n + " " + $.t(this._parsed.unit ? {H: "hour", D: "day", W: "week", M: "month"}[this._parsed.unit] : "minute", {count: n}), this._input.add(this._caption).removeClass("error")) : (n = this._parsed.error ? "&nbsp;" : $.t("Not applicable"), this._input.add(this._caption).addClass("error"));
    this._caption.html(n)
};
ChangeIntervalDialog.prototype._handleInput = function (n) {
    13 === n.which ? this._submit() : n.ctrlKey || n.metaKey || !n.charCode || !n.which || 32 >= n.which || D69.isIntervalChar(String.fromCharCode(n.charCode)) || n.preventDefault()
};
ChangeIntervalDialog.prototype._submit = function () {
    if (D83.isOpen(this._dialogTitle)) {
        if (this._valid && this._supported) {
            var n = D69.sanitizeIntervalValue(this._input.val()), t = D45.interval.value();
            n && t != n && "function" == typeof this._options.callback && this._options.callback(n)
        }
        this._helpTooltipTrigger.trigger("mouseleave");
        D83.destroy(this._dialogTitle)
    }
};
ChangeIntervalDialog.prototype._setInitialValue = function (n) {
    n = n || this._options.initialValue;
    var t = "", i = !1;
    n && "," != n ? t = D69.sanitizeIntervalValue(n) || "" : (t = n = D45.interval.value(), i = !0);
    this._input.val(t);
    i && this._input.select()
};
ChangeIntervalDialog.prototype.isValid = function () {
    return Boolean(this._valid)
};
ChangeIntervalDialog.prototype.show = function (n) {
    var t = D83.createDialog(this._dialogTitle, {hideCloseCross: !0, addClass: "change-interval-dialog"}), i = t.find(".tv-dialog-content");
    return t.css("min-width", 0), i.css("min-width", 0).mousedown(function (n) {
        this._input.is(n.target) || n.preventDefault()
    }.bind(this)).append(this._input.add(this._caption).add(this._helpTooltipTrigger)), D83.applyHandlers(t), D83.positionDialog(t), this._setInitialValue(n), this._validate(), this._updateCaption(), t
};
TVXWindowEvents = function () {
    var n = {};
    $(window).on("storage", function (t) {
        if (null !== t.originalEvent.newValue) {
            var i = t.originalEvent.key;
            i.startsWith("tvxwevents.") && (i = i.substr(11), $.browser.msie && TVXWindowEvents._emitting ? TVXWindowEvents._emitting = !1 : n[i] && n[i].forEach(function (n) {
                n.call(t.originalEvent.newValue, t.originalEvent.newValue)
            }))
        }
    });
    return{on: function (t, i) {
        n[t] || (n[t] = []);
        n[t].push(i)
    }, off: function (t, i) {
        if (n[t]) {
            var r = n[t].indexOf(i);
            -1 !== r && (1 === n[t].length ? delete n[t] : n[t].splice(r, 1))
        }
    }, emit: function (n, t) {
        void 0 === t && (t = +new Date);
        t != localStorage.getItem("tvxwevents." + n) && ($.browser.msie && (TVXWindowEvents._emitting = !0), localStorage.setItem("tvxwevents." + n, t))
    }}
}(), function (n) {
    var t = [
        ["&", "&amp;"],
        ["<", "&lt;"],
        [">", "&gt;"],
        ['"', "&quot;"],
        ["'", "&#039;"]
    ];
    n.clean = function (n, i, r) {
        var u = n, f, e;
        if (!n || !n.replace)return u;
        for (n = 0; n < t.length; n++)f = t[n][0], e = t[n][1], r && r.indexOf && -1 !== r.indexOf(i ? e : f) || (u = i ? u.replace(new RegExp(e, "g"), f) : u.replace(new RegExp(f, "g"), e));
        return u
    };
    n.cleanButAmpersand = function (t, i) {
        return n.clean(t, i, i ? ["&amp;"] : ["&"])
    }
}(this);
"undefined" != typeof module && module && module.exports && (module.exports = {clean: clean, cleanButAmpersand: cleanButAmpersand});
$(document).ajaxSend(function (n, t, i) {
    "POST" == i.type && (t.setRequestHeader("X-CSRFToken", $.cookie("csrftoken")), t.setRequestHeader("sessionid", $.cookie("sessionid")))
});
String.prototype.format || (String.prototype.format = function () {
    var n = arguments;
    return this.replace(/{(\d+)}/g, function (t, i) {
        return"undefined" != typeof n[i] ? n[i] : t
    })
});
"string" == typeof $.cookie("csrftoken") && "" != $.cookie("csrftoken") ? $("#update-status-li").append('<a href="#" onclick="TradingView.showChangeUserStatusDialog(); return false;">Update Status<\/a>') : $("#update-status-li").empty();
$(document).ready(function () {
    $(".tv-select").selectbox({speed: 100, classHolder: "tv-select-container"});
    Modernizr.canvas && Modernizr.canvastext || "undefined" != typeof FlashCanvas || D83.showNotice("Oops, your browser can't display our charts!", {html: 'It appears that your browser does not support <strong>Canvas<\/strong> technology, which is needed for TradingView to work.<br/>Please use one of the following browsers:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome<\/a><\/li><li><a href="http://www.mozilla.com" target="_blank">Firefox<\/a><\/li><li><a href="http://www.apple.com/safari/" target="_blank">Safari<\/a><\/li><li><a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home" target="_blank">Internet Explorer 9+<\/a><\/li><\/ul>', classSuffix: "slim", doNotCloseOnBgClick: !0});
    !J77.enabled("websocket_connection") || "WebSocket"in window || swfobject.hasFlashPlayerVersion("9.0.0") || D83.showNotice("TradingView Notice", {html: 'It appears that your browser does not support <strong>WebSocket<\/strong> technology and does not have <strong>Adobe Flash<\/strong> plugin installed, one of which is essential for our portal.<br/>Please, <a href="http://get.adobe.com/flashplayer/" target="_blank">install Flash plugin<\/a> or consider updating to one of these modern browsers with WebSocket support:<ul><li><a href="http://www.google.com/chrome/" target="_blank">Chrome<\/a><\/li><li><a href="http://www.apple.com/safari/" target="_blank">Safari<\/a><\/li><\/ul>', classSuffix: "slim", doNotCloseOnBgClick: !0})
});
loginStateChange = new Delegate;
loginStateChange.subscribe(this, onLoginStateChange);
TVXWindowEvents.on("loginStateChange", function () {
    var n = JSON.parse(this);
    user = n.user;
    is_authenticated = !!n.is_authenticated;
    loginStateChange.fire()
});
TradingView.trackEvent = function (n, t) {
    window._UNIT_TESTS || "undefined" == typeof _gaq || _gaq.push(["_trackEvent", n, t])
};
assert = function (n, t) {
    if (!n)throw Error("Assertion failed" + (t ? ": " + t : ""));
};
bindProfileTabsFilter = bindIdeasStreamFilter;
D18 = function (n, t) {
    function r(n, t) {
        var r = {}, u;
        (n || i.options && i.options.defaultSymbol) && (r.symbol = String(n || i.options.defaultSymbol).toUpperCase());
        t && (r.interval = t);
        u = "/e/";
        Object.keys(r).length && (u += "?" + $.param(r));
        location.href = u
    }

    this.$element = n;
    this.$field = this.$element.find("input");
    this.$button = this.$element.find("span");
    this.options = t;
    this.$button.on("click", function () {
        if (!this.$field.val()) {
            var n = (i.options || {}).defaultSymbol || (TradingView.Q18("open_last_chart") ? "" : this.$field.data("default-symbol"));
            n && this.$field.val(String(n).toUpperCase())
        }
        this.symbolSearch.acceptTypeIn()
    }.bind(this));
    this.$element.on("keyup", function () {
        this.$element.toggleClass("not-empty", !!this.$field.val().length)
    }.bind(this));
    this.symbolSearch = D69.bindToInput(this.$field, $.extend((this.options || {}).symbolSearch, {callback: r, onEmptyApply: r}));
    var i = this
};
D18.prototype.updateOptions = function (n) {
    $.extend(this.options, n)
};
TradingView.SearchChartField = function (n) {
    this.$element = n;
    this.$field = this.$element.find("input");
    this.$button = this.$element.find(".button");
    this.symbolSearch = D69.bindToInput(this.$field, {callback: function (n) {
        n && (n = n.toUpperCase(), location.href = "/s/?q=" + encodeSpread(n))
    }});
    this.$field.placeholder();
    this.$field.on("focus", function () {
        this.$element.addClass("active")
    }.bind(this)).on("blur", function () {
        this.$element.removeClass("active")
    }.bind(this)).on("keyup", function () {
        this.$element.toggleClass("not-empty", !!this.$field.val().length)
    }.bind(this));
    this.$button.on("click", function () {
        this.symbolSearch.acceptTypeIn()
    }.bind(this))
};
TradingView.applyReadMoreToChart = function (n) {
    var t = n.find(".desc");
    t.html(t.html().replace(/<br>/g, " ")).ellipsis(111, !1, function (t) {
        t = n.find(".chart-read-more-container");
        t.css("display", "block");
        t.is(t.parent().children(":visible").last()) && n.css("padding-bottom", "0px")
    })
};
$.fn.TVTicker = function (n) {
    function u(n) {
        n = Math.abs(n);
        var t = 1;
        return!isInteger(n) && 1 < n && (n = parseFloat(n.toString().replace(/^.+\./, "0."))), 0 < n && 1 > n && (t = Math.pow(10, n.toString().length - 2)), t
    }

    var f = $('<div class="tv-ticker">').appendTo(this.parent());
    $('<div class="icon up">').appendTo(f);
    $('<div class="icon down">').appendTo(f);
    n = n || {};
    var t = +n.step || 1, i = n.min, r = n.max, e = u(t);
    return this.each(function () {
        function f(i) {
            var r, f;
            n.trigger("tvticker-beforechange");
            r = isInteger(t) ? parseInt(n.val(), 10) : parseFloat(n.val());
            isNaN(r) && (r = 0);
            f = u(r);
            f = Math.max(e, f);
            n.val(i(r, f));
            n.change()
        }

        function o() {
            f(function (n, i) {
                var u = (Math.round(n * i) + Math.round(t * i)) / i;
                return void 0 !== r && null !== r && r < u && (u = n), u
            })
        }

        function s() {
            f(function (n, r) {
                var u = (Math.round(n * r) - Math.round(t * r)) / r;
                return void 0 !== i && null !== i && u < i && (u = n), u
            })
        }

        var n = $(this);
        n.next().find(".up, .down").on("mousedown", function (t) {
            t.preventDefault();
            n.focus()
        });
        n.next().find(".up").click(function () {
            n.is(":disabled") || o()
        });
        n.next().find(".down").click(function () {
            n.is(":disabled") || s()
        });
        n.keydown(function (t) {
            n.is(":disabled") || (38 == t.keyCode ? n.next().find(".up").addClass("active") : 40 == t.keyCode && n.next().find(".down").addClass("active"))
        });
        n.keyup(function (t) {
            n.is(":disabled") || (38 == t.keyCode ? (o(), n.next().find(".up").removeClass("active")) : 40 == t.keyCode && (s(), n.next().find(".down").removeClass("active")))
        });
        n.mousewheel(function (t, i) {
            0 < i ? n.next().find(".up").click() : n.next().find(".down").click()
        })
    }), this
};
$.fn.ellipsis = function () {
    return this.each(function (n, t, i) {
        var r = $(this), o = r.text(), f = o, u = $(this.cloneNode(!0)).hide().css({position: "absolute", overflow: "visible", height: "auto", width: r.width()}), e, s, h;
        for (n = n || r.height(), r.after(u), e = u.height() - n, h = 0; 0 < e;)if (f = f.substr(0, f.length - e / 2), u.text(f + "…"), e = u.height() - n, s = !0, 500 < h++) {
            console.warn("Error: too long text");
            break
        }
        r.html(u.text());
        s && "function" == typeof i && i(r);
        t && o != u.text() && r.attr("title", o);
        u.remove()
    }, arguments)
}, function (n) {
    var i = n('<div class="blue-tooltip-icon icon" />'), r = n('<div class="blue-tooltip-text" />'), t = n('<div class="blue-tooltip blue-tooltip-hidden" />').append(i).append(r);
    n.fn.blueTooltip = function (u, f, e) {
        return t.parent().length || t.appendTo(document.body), this.each(function () {
            var o = n(this);
            o.data("tooltip", u);
            o.off("mouseenter.tooltip").on("mouseenter.tooltip", function () {
                if (!Modernizr.touch) {
                    e = e || "";
                    r.html(o.data("tooltip"));
                    t.attr("class", "blue-tooltip");
                    t.addClass("blue-tooltip-" + f).addClass(e);
                    var s = (o.outerWidth() - t.outerWidth()) / 2, h = 0, n = s + o.offset().left + t.outerWidth(), u = s + o.offset().left, c = document.body.clientWidth - 5;
                    5 > u ? h = 5 - u : n > c && (h = c - n);
                    s = o.offset().left + s + h;
                    n = 0;
                    u = "";
                    "top" === f ? (n = o.offset().top - t.outerHeight() - 10, u = "-=10") : "bottom" == f && (n = o.offset().top + o.outerHeight() + 10, u = "+=10");
                    t.css({left: s, top: n, opacity: 0});
                    i.css({left: Math.round(t.width() / 2) - h});
                    t.stop().animate({top: u, opacity: 1}, 200)
                }
            }).off("mouseleave.tooltip").on("mouseleave.tooltip", function () {
                t.addClass("blue-tooltip-hidden").removeClass(e)
            })
        })
    }
}(jQuery);
TradingView.Tooltip = function () {
    function f() {
        clearTimeout(r);
        clearTimeout(u);
        jQuery.contains(document.body, n[0]) && (n.css("opacity", "0"), u = setTimeout(n.detach.bind(n), 250))
    }

    function e(n) {
        if (n = $(n), 0 === n.size())return!1;
        n:{
            var t = n.data("commonTooltipText"), r = n.attr("title");
            if (t)r && (t = r, n.data("commonTooltipText", t), n.removeAttr("title")); else {
                if (!r) {
                    n = void 0;
                    break n
                }
                t = r;
                n.data("commonTooltipText", t);
                n.removeAttr("title")
            }
            r = {y: n.offset().top - $(window).scrollTop(), x: n.offset().left - $(window).scrollLeft(), w: n.outerWidth(), h: n.outerHeight()};
            n = {text: t, rect: r, vertical: n.hasClass("common-tooltip-vertical")}
        }
        n && i(n)
    }

    function i(f) {
        var e = jQuery.contains(document.body, n[0]);
        clearTimeout(r);
        clearTimeout(u);
        e ? (t.text(f.text), o(f), n.css("opacity", "1")) : r = setTimeout(function () {
            n.appendTo(document.body);
            i(f)
        }, 500)
    }

    function o(i) {
        var r = i.rect, u, f;
        n.attr("class", "common-tooltip-wrapper").css({top: "auto", right: "auto", bottom: "auto", left: "auto"});
        Modernizr.pointerevents || n.addClass("no-pointer-events");
        t.css({top: "auto", right: "auto", bottom: "auto", left: "auto"});
        u = $(window).width();
        f = $(window).height();
        ((i = i.vertical) && 20 > r.w || !i && 20 > r.h) && n.addClass("farther");
        i ? (n.addClass("vertical").css({left: r.x + r.w, top: r.y - (n.outerHeight() - r.h) / 2}), t.offset().left + t.outerWidth() + 10 > u ? n.addClass("otl").css({left: "auto", right: u - r.x}) : n.addClass("otr")) : (n.css({bottom: f - r.y, left: r.x - (n.outerWidth() - r.w) / 2}), 10 > t.offset().top ? n.addClass("below").css({bottom: "auto", top: r.y + r.h}) : n.addClass("above"), 0 > t.offset().left - 10 ? t.css("left", Math.abs(t.offset().left) + 10) : t.offset().left + t.outerWidth() + 10 > u && t.css("left", u - (t.offset().left + t.outerWidth() + 10)))
    }

    var n = $("<div />").css("opacity", "0"), t = $('<div class="common-tooltip-body" />').appendTo(n), r, u;
    if (!Modernizr.touch)$(document).on("mouseenter", ".apply-common-tooltip", function () {
        var n = $(this);
        e(n);
        n.on("mouseleave mousedown", f)
    });
    return{show: i, showOnElement: e, hide: f}
}();
$(function () {
    $(document).on("mouseenter", ".apply-overflow-title", function () {
        $(this).attr("title") || this.offsetWidth >= this.scrollWidth || $(this).attr("title", $(this).text())
    })
});
D17 = function (n, t) {
    var i, r;
    if (this._options = t || {}, i = this, this.id = n.id, r = this._lastId(), r) {
        if (!(this.id <= r || (i = this, this.container = $(Mustache.render(TradingView.templates.globalNotification, n)).prependTo($("body")), i.container.show(), this._options.addClass && this.container.addClass(this._options.addClass), i.container.css("top", 0), this._options.notShiftBody || $("body").addClass("padding-animate").css({paddingTop: i.container.outerHeight()}), this.container.find(".global-notification-close").on("click", function () {
            i.close()
        }), $.browser.msie)))TVXWindowEvents.on(this.KEY + "-close", this._onCloseInAnotherTab.bind(this))
    } else this._setLastId(this.id)
};
D17.prototype.KEY = "globalNotification";
D17.prototype._lastId = function () {
    var t = TVSettings.getInt(this.KEY, 0, !0), i = TVSettings.getInt(this.KEY, 0), n = Math.max(i, t);
    return t != i && TVSettings.setValue(this.KEY, n), !n && $.cookie("notification_id") && (n = ~~$.cookie("notification_id"), TVSettings.setValue(this.KEY, n), $.cookie("notification_id", 0, {expires: -1, path: "/"})), n
};
D17.prototype._setLastId = function (n) {
    TVSettings.setValue(this.KEY, n)
};
D17.prototype.close = function (n) {
    var t = this;
    this.container && (n ? (this.container.remove(), this.container = null) : (t.container.css("top", -1 * this.container.outerHeight() + "px"), setTimeout(function () {
        t.container.remove();
        t.container = null;
        $(window).resize();
        t._options.notShiftBody || $("body").removeClass("padding-animate")
    }, 1500), TVXWindowEvents.emit(t.KEY + "-close", JSON.stringify([t.id, +new Date])), this._setLastId(t.id)), this._options.notShiftBody || $("body").css({paddingTop: 0}))
};
D17.prototype._onCloseInAnotherTab = function (n) {
    n = JSON.parse(n);
    this.id <= n[0] && this.close(!0)
};
TradingView.RequestCache = function (n) {
    function t(t) {
        return r || u || (u = !0, $.getJSON(n, function (n) {
            u = !1;
            r = !0;
            i = n;
            "function" == typeof t && t(n)
        })), i && "function" == typeof t && t(i), i
    }

    if (J77.enabled("charting_library"))return t = function (n) {
        return"function" == typeof n && n([]), n
    }, t.Q20 = function () {
    }, t;
    var i, r = !1, u = !1;
    return t.Q20 = function () {
        i = null;
        r = !1
    }, t
};
J77.enabled("charting_library") || (TradingView.getStudyTemplatesList = new TradingView.RequestCache("/study-templates-ext/"), TradingView.getThemesList = new TradingView.RequestCache("/themes/")), function (n) {
    jQuery.fn.putCursorAtEnd = function () {
        return this.each(function () {
            if (n(this).focus(), this.setSelectionRange) {
                var t = 2 * n(this).val().length;
                this.setSelectionRange(t, t)
            } else n(this).val(n(this).val());
            this.scrollTop = 999999
        })
    }
}(jQuery);
ShareTwitterSnapshot.getStatus = function (n, t) {
    return TradingView.isCmeWidget ? t + " from cmegroup.com via @tradingview $" + n : "$" + n + " chart " + t + " via http://www.tradingview.com"
};
ShareStocktwitsSnapshot.getStatus = function (n, t) {
    return"$" + n + " chart " + t + " via http://www.tradingview.com"
};
TradingView.agoDateFormatter = function (n, t, i) {
    i || (i = TradingView.agoDateFormatter.fullFormat);
    var r = i(new Date - t), u = r.text, r = r.timeout;
    n.attr("title", t.toLocaleString()).text(u);
    u = null;
    r && (n.attr("data-ago-date-timer") && clearTimeout(+n.attr("data-ago-date-timer")), u = setTimeout(function () {
        TradingView.agoDateFormatter(n, t, i)
    }, r));
    n.attr("data-ago-date-timer", u)
};
TradingView.agoDateFormatter.destroy = function (n) {
    $(n).find("*").andSelf().filter("[data-ago-date-timer]").each(function () {
        clearTimeout(+$(this).attr("data-ago-date-timer"))
    })
};
TradingView.agoDateFormatter.nextMinuteThrough = function (n) {
    return 6e4 - n % 6e4
};
TradingView.agoDateFormatter.nextHourThrough = function (n) {
    return 36e5 - n % 36e5
};
TradingView.agoDateFormatter.nextDayThrough = function (n) {
    return 864e5 - n % 864e5
};
TradingView.agoDateFormatter.fullFormat = function (n) {
    var t = Math.floor(n / 6e4), i = "", r = !1;
    return 60 > t ? (i = 1 > t ? "less than a minute" : t + " minute" + (1 < t ? "s" : ""), r = TradingView.agoDateFormatter.nextMinuteThrough(n)) : 1440 > t ? (t = Math.floor(t / 60), i = t + " hour" + (1 < t ? "s" : ""), r = TradingView.agoDateFormatter.nextHourThrough(n)) : 43200 > t ? (t = Math.floor(t / 1440), i = t + " day" + (1 < t ? "s" : ""), r = TradingView.agoDateFormatter.nextDayThrough(n)) : 15768e3 > t ? (t = Math.floor(t / 43200), i = t + " month" + (1 < t ? "s" : "")) : (t = Math.floor(t / 15768e3), i = t + " year" + (1 < t ? "s" : "")), r && (r += 200), {text: i + " ago", timeout: r}
};
TradingView.agoDateFormatter.shortFormat = function (n) {
    var t = Math.floor(n / 6e4), i = "", r = !1;
    return 60 > t ? (i = (1 > t ? 0 : t) + "m", r = TradingView.agoDateFormatter.nextMinuteThrough(n)) : 1440 > t ? (t = Math.floor(t / 60), i = t + "h", r = TradingView.agoDateFormatter.nextHourThrough(n)) : 43200 > t ? (t = Math.floor(t / 1440), i = t + "d", r = TradingView.agoDateFormatter.nextDayThrough(n)) : 15768e3 > t ? (t = Math.floor(t / 43200), i = t + "mn") : (t = Math.floor(t / 15768e3), i = t + "y"), r && (r += 200), {text: i, timeout: r}
};
TradingView.Common = {publishChartWidget: function (n) {
    runOrSignIn(function () {
        saver.publishChart(n)
    })
}, publishChart: function (n) {
    runOrSignIn(function () {
        D83.showPublishIntroDialog().done(function () {
            saver.publishChart(n)
        })
    })
}, createTrendingSymbols: function () {
    function r(r) {
        function c(n, t) {
            i[t] = n;
            quoteSessionMultiplexerInstance.simple.subscribe("trending_symbols_retry", [n], function (n) {
                n.symbolname = t;
                h(n)
            })
        }

        function h(n) {
            var i, r, u;
            t[n.symbolname] || (t[n.symbolname] = {});
            $.extend(t[n.symbolname], n.values);
            i = t[n.symbolname];
            r = $("#trending-symbols-item-" + TradingView.symbol2id(n.symbolname) + " .change");
            n = $("#trending-symbols-item-" + TradingView.symbol2id(n.symbolname) + " .last");
            u = new PriceFormatter(i.pricescale || 100, i.minmov || 1, i.fractional, i.minmove2);
            n.text(u.format(i.last_price || ""));
            0 < i.change_percent ? r.removeClass("minus").addClass("plus").text("+" + i.change_percent + "%") : 0 > i.change_percent ? r.removeClass("plus").addClass("minus").text(i.change_percent + "%") : 0 == i.change_percent && r.removeClass("plus minus").text(i.change_percent + "%")
        }

        var o = n.splice(0, n.length), f, e, s;
        for (r.forEach(function (t) {
            var i = $("#trending-symbols-item-" + TradingView.symbol2id(t.name));
            i.length ? (i.attr("title", t.sessions + " watching " + t.short_name), i.find(".sessions-count").text(t.sessions)) : i = $('<a class="trending-symbols-item clearfix" id="trending-symbols-item-' + TradingView.symbol2id(t.name) + '" title="' + t.sessions + " watching " + t.short_name + '" href="/chart/' + t.short_name + "/" + (t.full_name_required ? "?exg=" + t.exchange : "") + '" target="_blank"><div class="sessions"><span class="sessions-count">' + t.sessions + '<\/span> <span class="icon icon-people-watching"><\/span><\/div><div class="symbol">' + t.short_name + '<\/div><div class="last"><\/div><div class="change"><\/div><\/a>').data("symbol", t.name);
            i.appendTo(u);
            n.push(t.name)
        }), u.find(".trending-symbols-item").each(function () {
            -1 == n.indexOf($(this).data("symbol")) && $(this).remove()
        }), r = [], f = 0; f < n.length; f++)e = n[f], s = o.indexOf(e), -1 === s ? r.push(e) : o.splice(s, 1);
        for (f = 0; f < o.length; f++)e = o[f], quoteSessionMultiplexerInstance.simple.unsubscribe("trending_symbols", e), i[e] && (quoteSessionMultiplexerInstance.simple.unsubscribe("trending_symbols_retry", i[e]), delete i[e]);
        r.length && quoteSessionMultiplexerInstance.simple.subscribe("trending_symbols", r, function (n) {
            "permission_denied" == n.status ? c(n.values.alternative, n.symbolname) : h(n)
        });
        o = r = null
    }

    var u = $(".trending-symbols-table"), t = {}, n = [], i = {};
    r(initialData.trendingSymbols);
    setInterval(function () {
        $.getJSON("/index/popular/", function (n) {
            r(n)
        })
    }, 3e4)
}};
TradingView.symbol2id = function (n) {
    return n.replace(/[^a-z0-9]/gi, "_")
};
TradingView.tokenInitialized = $.Deferred();
TradingView.tokenExpiration = 6e5;
TradingView.registerAuthToken = function (n) {
    var t = this.tokenInitialized, i = new Date(1e3 * user.auth_token_timestamp), r = new Date;
    loginStateChange.subscribe(TradingView, function (u) {
        u && user ? user.auth_token && (r - i < this.tokenExpiration ? (n.setAuthToken(user.auth_token), t.resolve()) : this.requestAndSetAuthToken(n).done(function () {
            t.resolve();
            console.info("Token expired and recreated.")
        })) : this.isProRealtime() && this.requestAndSetAuthToken(n).done(function () {
            t.resolve()
        })
    }.bind(this));
    setTimeout(t.resolve.bind(t), 5e3)
};
TradingView.requestAndSetAuthToken = function (n, t) {
    var i = $.Deferred();
    return this.requestAuthToken().done(function (r) {
        n.setAuthToken(r, t);
        i.resolve()
    }), i
};
TradingView.requestAuthToken = function () {
    function i() {
        t = $.post("/quote_token/", null, "json").done(function (t) {
            n.resolve(t)
        }).fail(function () {
            if (!n.isRejected() && !n.isResolved()) {
                var t = Math.min(1e3 * r, 3e4);
                r++;
                setTimeout(i, t)
            }
        })
    }

    var n = $.Deferred(), r = 0, t;
    return i(), n.always(function () {
        t && t.abort()
    }), n
};
TradingView.isPro = function () {
    return is_authenticated && user.is_pro
};
TradingView.isProRealtime = function () {
    return this.isPro() && ("pro_realtime" == user.pro_plan || "pro_realtime_trial" == user.pro_plan)
};
TradingView.centerBlock = function (n) {
    var t = $(window), i = n.width(), r = n.height(), u = t.width(), t = t.height();
    n.css({left: Math.round((u - i) / 2) + "px", top: Math.round((t - r) / 2) + "px"})
};
TradingView.visitPaymentPageSwreg = function (n, t) {
    if (!n.product_ids.hasOwnProperty(t))throw new TypeError("Unknown product");
    runOrSignIn(function () {
        if (!(t in{pro: 1, pro_yearly: 1, pro_realtime: 1, pro_realtime_yearly: 1} && user.is_pro && user.pro_plan == t)) {
            var i = {s: n.shop_id, q: 1, d: 0, v: 0, bb: 1, clr: 1, clro: 1, a: user.id, fn: user.first_name, sn: user.last_name, em: user.email, p: n.product_ids[t]}, r = Object.keys(i).map(function (n) {
                return encodeURIComponent(n) + "=" + encodeURIComponent(i[n])
            });
            location.href = n.shop_url.replace(/(\?.*|$)/, "?" + r.join("&"))
        }
    }, !0)
};
TradingView.visitPaymentPage = function (n, t, i) {
    t = t || "y";
    i = i || {};
    var r = "/order/";
    "bitcoin" == i.paymentMethod && (r = "/coinbase/begin/");
    runOrSignIn(function () {
        $('<form action="' + r + '" method="post"' + (i.newWindow ? ' target="_blank"' : "") + '><input type="hidden" name="product" value="' + n + '"/><input type="hidden" name="billing_cycle" value="' + t + '"/><input type="hidden" name="fixed_billing_cycle" value="' + (i.fixedCycle ? "true" : "") + '"/><input type="hidden" name="exchanges_only" value="' + (i.exchangesOnly ? "true" : "") + '"/><\/form>').appendTo(document.body).submit()
    }, !0)
};
$("body").on("click", "button.follow-user", follow);
if (TradingView.keyboardBinder = function () {
    function i(t) {
        n.forEach(function (i, r) {
            i.name === t && n.splice(r, 1)
        })
    }

    function t(t) {
        for (var i = 0; i < n.length; i++)if (n[i].name === t)return i
    }

    var n = [];
    $(window).on("keypress", function (t) {
        for (var i = n.length - 1; 0 <= i && !0 !== n[i].func(t); i--);
    });
    return{registerListener: function (i, r) {
        var u = {name: i, func: r}, f = t(u.name);
        f ? n[f] = u : n.push(u)
    }, removeListener: function (n) {
        i(n)
    }, pushBackListener: function (i, r) {
        var u = {name: i, func: r}, f = t(u.name);
        f && n.splice(f, 1);
        n.unshift(u)
    }}
}(), TradingView.inputOnTyping = function (n, t, i) {
    function r() {
        var n = $(this), r = n.val(), u = t(r);
        n.removeClass("tv-dialog-text-input-error");
        "function" == typeof i && i(r);
        r !== u && n.val(u)
    }

    function u(n) {
        return n.ctrlKey || n.metaKey || !n.charCode ? !1 : (n = n.keyCode || n.which, 9 == n || 13 == n || 16 == n || 17 == n || 18 == n || 19 == n || 20 == n || 27 == n || 33 <= n && 40 >= n ? !1 : !0)
    }

    n instanceof $ ? ("function" != typeof t && (t = function (n) {
        return n
    }), n.each(function (n, t) {
        var i = $(t);
        i.on("keypress", function (n) {
            if (u(n)) {
                var t = function () {
                    r.call(this);
                    $(this).off("keyup", t)
                }.bind(this);
                $(this).on("keyup", t)
            }
        });
        i.change(r)
    })) : console.warn("'$inputs' should be instance of jQuery")
}, TradingView.makeInputNumberOnly = function (n, t) {
    t = t || {};
    var i = t.integerOnly, r = t.positiveOnly;
    TradingView.inputOnTyping(n, function (n) {
        return n = n.replace(/\,/g, ".").replace(/[^0-9\.-]/g, "").replace(/^-/, r ? "" : "__minus__").replace(/\./, "__point__").replace(/^__point__/, "0__point__").replace(/[\.-]/g, "").replace("__minus__", "-").replace("__point__", ".").replace(/^0+/, "0"), i && /\d+/.test(n) && (n = parseInt(n), isInteger(t.minValue) && (n = Math.max(t.minValue, n)), isInteger(t.maxValue) && (n = Math.min(t.maxValue, n))), !i && /^0\d/.test(n) && (n = n.toString(), n = n.substring(0, 1) + "." + n.substring(1, n.length)), n
    }, t.inputOnTypingCallback)
}, TradingView.makeInputDateOnly = function (n, t) {
    t = t || {};
    TradingView.inputOnTyping(n, function (n) {
        return(4 == n.length || 7 == n.length) && (n += "-"), n.substr(0, 10)
    }, t.inputOnTypingCallback)
}, TradingView.makeInputTimeOnly = function (n, t) {
    t = t || {};
    TradingView.inputOnTyping(n, function (n) {
        return 2 == n.length && (n += ":"), n.substr(0, 5)
    }, t.inputOnTypingCallback)
}, TradingView.timezoneIsAvailable = function (n) {
    for (var t = 0; t < TradingView.availableTimezones.length; t++)if (n === TradingView.availableTimezones[t].id)return!0;
    return!1
}, TradingView.showChangeUserStatusDialog = function () {
    return runOrSignIn(function () {
        D83.showChangeUserStatusDialog()
    }), !1
}, TradingView.getUrlParams = function () {
    for (var n, t = /\+/g, r = /([^&=]+)=?([^&]*)/g, u = window.location.search.substring(1), i = {}; n = r.exec(u);)i[decodeURIComponent(n[1].replace(t, " "))] = decodeURIComponent(n[2].replace(t, " "));
    return i
}, $.fn.filterByData = function (n, t) {
    return this.filter(function () {
        return $(this).data(n) == t
    })
}, window.adPack = function () {
    function i(n) {
        return("object" != typeof n || null === n) && (n = user), "Exante" === n.username
    }

    function r(n) {
        var t, i;
        return n.removeClass("settings").addClass("ad-pack"), t = n.find(".form-section.tv-profile-area").eq(0), $('<div class="left-column">').appendTo(n.html("")), i = $('<div class="right-column">').appendTo(n), [
            {name: "ad-pack-change-messages", title: "Chart Pop-up Messages", action: "/ad_pack/change_messages/", fields: "default index stock futures forex bitcoin".split(" "), parent: n},
            {name: "ad-pack-pm-message", title: "Private Messages", action: "/ad_pack/pm_message/", fields: ["message"], sbmText: "Send PM to All Non-Pro Users", parent: i, skip: !0}
        ].forEach(function (n) {
            if (!n.skip) {
                var i = t.clone();
                i.find("h3").text(n.title);
                i.find("form").attr({id: n.name, action: n.action, target: n.name + "-target"});
                i.find("iframe").replaceWith($(document.createElement("iframe")).attr({src: n.action, name: n.name + "-target"}).css({position: "absolute", left: -9999, width: 10, height: 10}));
                i.find("tr").each(function () {
                    if (row = $(this), !row.hasClass("error-row"))if (row.hasClass("caption") || !n.fields.length)row.remove(); else {
                        var t = n.fields.shift(), i = row.find("td");
                        i.eq(0).text(t.charAt(0).toUpperCase() + t.substr(1));
                        $(document.createElement("textarea")).attr({name: t, maxLength: Math.pow(2, 8), rows: 10, cols: 40}).appendTo(i.eq(1).html(""))
                    }
                });
                n.sbmText && i.find("input[type=submit]").attr("value", n.sbmText);
                i.appendTo(n.parent)
            }
        }), n
    }

    var t = customChatMessageActive = chartPopUpActive = profileTabActive = sendMassPMActive = !1, n;
    return $(function () {
        t = TradingView.Q18("adPackActive");
        customChatMessageActive = TradingView.Q18("adPackCustomChatMsgActive");
        chartPopUpActive = TradingView.Q18("adPackChartPopUpActive");
        sendMassPMActive = TradingView.Q18("adPackMassPMActive");
        profileTabActive = TradingView.Q18("adPackProfileTabActive");
        t && $(document.documentElement).addClass("sp-active")
    }), {isAdvertiser: i, customChatMessage: function (n, r) {
        t && customChatMessageActive && i(n) && r("exante")
    }, chartPopUp: function (i) {
        var u, e, f, r;
        t && chartPopUpActive && !user.is_pro && (u = ~~localStorage.getItem("chart-ads-popup-counter-Exante"), e = ~~localStorage.getItem("chart-ads-popup-disabled-Exante"), 3 <= u || e || i.model().mainSeries().onSymbolResolved().subscribe(null, function () {
            n || f || (f = setTimeout(function t() {
                if (f = null, r) {
                    var e = i.model().mainSeries().quoteData;
                    e && (e = r[e.type] || r["default"], String(e).replace(/^\s+|\s+$/g, "") && (n = D83.createDialog("adPackExante", {addClass: "popup-exante", content: '<div class="message">' + e.replace(/</g, "&lt;").replace(/>/g, "&gt;") + '<\/div><div class="actions-block"><a class="no-button">No, thank you<\/a><a href="https://exante.eu/?utm_source=tradingview" class="yes-button" target="_blank">Read more<\/a><\/div>', hideTitle: !0}), n.on("click", ".no-button, .yes-button, .tv-dialog-title-close", function (t) {
                        t = $(t.target);
                        t.hasClass("no-button") || t.hasClass("tv-dialog-title-close") ? (TradingView.trackEvent("AdPack", "Exante-Popup-Decline"), localStorage.setItem("chart-ads-popup-counter-Exante", u + 1)) : t.hasClass("yes-button") && (TradingView.trackEvent("AdPack", "Exante-Popup-Accept"), localStorage.setItem("chart-ads-popup-disabled-Exante", 1));
                        D83.destroy("adPackExante");
                        n = null
                    }), D83.positionDialog(n), TradingView.trackEvent("AdPack", "Exante-Popup-Show")))
                } else $.ajax("/ad_pack/get_messages/").done(function (n) {
                    !n || n.constructor !== Object || n.error ? n.error && window.console && console.error("AdPack Error: " + n.error) : (r = n, t())
                })
            }, 9e5))
        }, !0))
    }, setTab: function (n) {
        if (i() && profileTabActive && n) {
            var u = n.$decks.filter(".settings"), t = n.$tabs.filter("a[href=#settings]");
            u && t && (u = r(u.clone()).insertAfter(u), t = t.closest(".filter-tabbed"), t = t.clone().insertAfter(t).find(".profile-tab"), t.text("Ad Pack").attr("href", "#ad-pack").attr("data-value", "ad-pack"), n._tabsList["ad-pack"] = {showForNotAuth: !1}, n.$tabs = n.$tabs.add(t.get(0)), n.$decks = n.$decks.add(u.get(0)))
        }
    }}
}(), $.fn.reverse = [].reverse, Q17 = function () {
    function t(n) {
        return i.hasOwnProperty(n) || (i[n] = new Delegate), i[n]
    }

    var n = {}, i = {};
    return n.unsubscribe = function (n, i, r) {
        t(n).unsubscribe(r, i)
    }, n.on = function (t, i, r) {
        return n.subscribe(t, i, r)
    }, n.subscribe = function (n, i, r) {
        t(n).subscribe(r, i)
    }, n.emit = function (n, i) {
        t(n).fire(i)
    }, n
}(), TVSettings = function () {
    function r(t, i) {
        var r;
        return r = n[t], !window.is_authenticated && null == r && window.localStorage && (r = n[t]), null == r ? i : r
    }

    function f(t, i) {
        return strValue = "" + i, n[t] !== strValue && (n[t] = strValue, h(t)), this
    }

    function s(t) {
        return null != n[t] && (delete n[t], h(t)), this
    }

    function a() {
        o = void 0;
        i.length && e()
    }

    function h(t) {
        if (window.is_authenticated)i.push(t), o || (o = setTimeout(a, 12e4)); else try {
            null == n[t] ? localStorage.removeItem("tradingview." + t) : localStorage.setItem("tradingview." + t, n[t])
        } catch (r) {
        }
        TVXWindowEvents.emit("settings", JSON.stringify({key: t, value: n[t]}))
    }

    function e(t) {
        var u, f, e, o, r;
        if (!TradingView.onWidget() && window.is_authenticated && 0 !== i.length) {
            for (u = i, i = [], f = {}, e = u.length; e--;)o = u[e], r = n[o], void 0 === r && (r = null), f[o] = r;
            $.ajax({url: "/savesettings/", type: "POST", data: {delta: JSON.stringify(f)}, async: !t})
        }
    }

    function c() {
        return Object.keys(n)
    }

    var t = !1, n, i, o;
    try {
        t = !TradingView.onWidget() && parent && parent !== window && !!parent.IS_DEMO_PAGE
    } catch (v) {
    }
    if (t) {
        var l = {"widgetbar.layout-settings": {widgets: {}, settings: {minimized: !0}}, notShowMainWizard: !0}, t = function (n, t) {
            return n = l[n], null === n || void 0 === n ? t : n
        }, u = function () {
        };
        return{loaded: !1, loadedModel: !1, getValue: t, getJSON: t, getBool: t, getFloat: t, getInt: t, setValue: u, setJSON: u, remove: u, restoreDefaults: u, keys: function () {
            return Object.keys(l)
        }, keysMask: function () {
            return[]
        }, sync: u}
    }
    n = {};
    i = [];
    TVXWindowEvents.on("settings", function (t) {
        t = JSON.parse(t);
        null == t.value ? delete n[t.key] : n[t.key] = t.value
    });
    $(window).on("visibilitychange", function (n, t) {
        t || e()
    });
    $(window).on("unload", function () {
        e(!0)
    });
    return{loaded: !1, loadedModel: !1, getValue: r, getJSON: function (n, t) {
        var i = r(n, void 0);
        if (null == i)return t;
        try {
            return JSON.parse(i)
        } catch (u) {
            return s(n), t
        }
    }, getBool: function (n, t) {
        var i = r(n);
        return null == i ? t : i && "false" !== i && 0 != +i ? !0 : !1
    }, getFloat: function (n, t, i) {
        if (i = r(n, void 0, i), null == i)return t;
        if (t = parseFloat(i), !isFinite(t))throw new TypeError('"' + i + '" is not float (key: "' + n + '")');
        return t
    }, getInt: function (n, t, i) {
        if (i = r(n, void 0, i), null == i)return t;
        if (t = parseInt(i, 10), !isFinite(t))throw new TypeError('"' + i + '" is not int (key: "' + n + '")');
        return t
    }, setValue: f, setJSON: function (n, t) {
        var i = JSON.stringify(t);
        return f(n, i), this
    }, remove: s, restoreDefaults: function () {
        for (var t, n = 0; n < localStorage.length; n++)t = localStorage.key(n), "tradingview." === t.substring(0, 12) && (i = [], localStorage.removeItem(t));
        $.post("/restoredefaults/", {}, function () {
            D83.showNotice("Success", "Defaults has been successfully restored")
        }).error(function () {
        })
    }, keys: c, keysMask: function (n, t) {
        var r = c(t), u = [], i;
        for (n = new RegExp("^" + RegExpEscape(n).replace(/\\\*\\\*/gi, ".+").replace(/\\\*/gi, "[^.]+") + "$", "gi"), i = r.length - 1; 0 <= i; i--)n.test(r[i]) && u.push(r[i]), n.lastIndex = 0;
        return u
    }, sync: function (t) {
        var u, i, r, e;
        if (window.is_authenticated) {
            if (t = t || {}, n = [], window.localStorage)for (u = 0 === Object.keys(t).length, i = localStorage.length; i--;)r = localStorage.key(i), "tradingview." === r.substring(0, 12) && (u && (e = r.substring(12), f(e, localStorage.getItem(r))), localStorage.removeItem(r));
            for (i in t)n[i] = t[i] + ""
        } else if (n = [], window.localStorage)for (i = localStorage.length; i--;)t = localStorage.key(i), "tradingview." === t.substring(0, 12) && (u = t.substring(12), n[u] = localStorage.getItem(t))
    }}
}(), D13 = function () {
    return"www.tradingview.com" == location.host || "dwq4do82y8xi7.cloudfront.net" == location.host || location.host.match(/proxy\d.tradingview.com/) || location.host.match(/prod-[^.]+.tradingview.com/) ? "battle" : "beta.tradingview.com" == location.host || "beta2.tradingview.com" == location.host ? "staging" : location.host.match(/webcharts/) ? "staging_local" : (location.host.match(/^localhost(:\d+)?$/), "local")
}, D13.isLocal = function () {
    return"local" == this()
}, D13.isProd = function () {
    return"battle" == this()
}, D13.isDebug = function () {
    return!this.isProd()
}, TradingView.LOGLEVEL_NORMAL = 1, TradingView.LOGLEVEL_DEBUG = 2, D46 = [], TradingView.LOGHISTORY_LENGTH = 100, TradingView.getLogLevel = function () {
    return TVSettings.getInt("log_level", TradingView.LOGLEVEL_NORMAL)
}, TradingView.loggingOn = function () {
    TVSettings.setValue("log_level", TradingView.LOGLEVEL_DEBUG);
    TradingView.logNormal("Debug logging enabled")
}, TradingView.loggingOff = function () {
    TVSettings.setValue("log_level", TradingView.LOGLEVEL_NORMAL);
    TradingView.logNormal("Debug logging disabled")
}, TradingView.log = function () {
    var n;
    return setInterval(function () {
        n = null
    }, 1e3), function (t, i) {
        i != n && ("\n" != i && D46.unshift(i), D46.length > TradingView.LOGHISTORY_LENGTH && D46.pop(), "undefined" != typeof console && console.log && t <= TradingView.getLogLevel() && (n = i, console.log(i)))
    }
}(), TradingView.logNormal = function (n) {
    TradingView.log(TradingView.LOGLEVEL_NORMAL, n)
}, TradingView.logDebug = function (n) {
    TradingView.log(TradingView.LOGLEVEL_DEBUG, n)
}, TradingView.remoteDebug = function () {
    var n = {arguments: JSON.stringify(Array.prototype.slice.call(arguments))};
    $.ajax("/remote_debug/", {data: n})
}, TradingView.remoteDebugTouch = function () {
    Modernizr.touch && this.remoteDebug.apply(this, arguments)
}, D13.isProd() && "undefined" != typeof console && (noop = function () {
}, TradingView.remoteDebug = noop), function (n) {
    function t(t, i) {
        this.container = n(t);
        this.options = i || {};
        this.options.callbacks || (this.options.callbacks = {});
        this.column_num = 0;
        this.items = [];
        this.init();
        var r = this;
        window.addEventListener("resize", function () {
            r.resize()
        })
    }

    t.prototype.fireCallback = function (n, t) {
        "function" == typeof this.options.callbacks[n] && this.options.callbacks[n](t)
    };
    t.prototype.resize = function () {
        this.columnsCount != this.calculateColumnsCount() && (this.options.fixHeightOnRecalculate && this.container.css({height: this.container.height()}), this.removeColumns(), this.init(!0), this.options.fixHeightOnRecalculate && this.container.css({height: "auto"}))
    };
    t.prototype.getItems = function () {
        return this.container.find("> " + this.options.itemsSelector).toArray()
    };
    t.prototype.addItems = function (n, t) {
        this.items = this.items.concat(n);
        this.balance(n, t)
    };
    t.prototype.balance = function (n, t) {
        switch (this.options.balanceType) {
            case"height":
                this.balanceHeight(n, t);
                break;
            default:
                this.balanceSimple(n, t)
        }
    };
    t.prototype.balanceHeight = function (t, i) {
        var r = this;
        this.columns.forEach(function (n) {
            n.fragment || (n.fragment = document.createDocumentFragment())
        });
        n.each(t, function (t, u) {
            var f = n(u), c = f.data("cb-height") || f.outerHeight(!0), e, o, s, h;
            if (c)f.data("cb-height", c); else throw"Cant get item height";
            if (e = null, f.hasClass("two-columns-item")) {
                if (r.columns.sort(TradingView.sortMultipleFunction("index")), 2 < this.columnsCount)for (e = null, f = this.columns.length - 1; 0 < f; f--)s = Math.abs(this.columns[f].height - this.columns[f - 1].height), (null === e || s <= e) && (e = s, o = f - 1); else o = 0;
                e = this.columns[o];
                o = this.columns[o + 1];
                f = c;
                s = 0;
                e.height > o.height ? f += e.height - o.height : s = o.height - e.height;
                h = document.createElement("div");
                h.style.height = f + "px";
                h.className = "empty-space";
                o.fragment.appendChild(h);
                o.height += f;
                s && (h = document.createElement("div"), h.style.height = s + "px", h.className = "empty-space", e.fragment.appendChild(h), e.height += s)
            } else r.columns.sort(TradingView.sortMultipleFunction("height", "index")), e = r.columns[0];
            !r.options.maxRow || this.row_num < r.options.maxRow ? (e.height += c, e.fragment.appendChild(u)) : i && r.container[0].removeChild(u)
        }.bind(this))
    };
    t.prototype.balanceSimple = function (t, i) {
        var r = this;
        n.each(t, function (n, t) {
            var u = r.columns[this.column_num];
            u.fragment || (u.fragment = document.createDocumentFragment());
            !r.options.maxRow || this.row_num < r.options.maxRow ? (u.fragment.appendChild(t), u.count++) : i && r.container[0].removeChild(t);
            ++this.column_num >= r.columnsCount && (this.row_num++, this.column_num = 0)
        }.bind(this))
    };
    t.prototype.init = function (n) {
        this.row_num = this.column_num = 0;
        this.columnsCount = this.calculateColumnsCount();
        this.createLayout(this.columnsCount);
        n ? this.balance(this.items, !1) : this.addItems(this.getItems(), !0);
        this.pushFragmentsToColumns()
    };
    t.prototype.calculateColumnsCount = function () {
        var t = this.container.width(), i = this.options, n;
        if (!t)throw"Can't get container width.";
        for (n = Math.floor(t / i.columnWidth); 0 <= n && n * i.columnWidth + (n - 1) * i.gap > t;)n--;
        return n
    };
    t.prototype.createLayout = function (t) {
        var r, i, u;
        for (this.columns = [], r = document.createDocumentFragment(), i = 0; i < t; i++)u = n('<div class="cb-column"><\/div>'), this.columns.push({target: u, count: 0, height: 0, index: i}), r.appendChild(u[0]);
        this.container.prepend(r)
    };
    t.prototype.pushFragmentsToColumns = function (n) {
        for (var t, r, f, u = this.columns.length, i = 0; i < u; i++) {
            if (t = this.columns[i], n)for (r = 0; r < t.fragment.childNodes.length; r++)t.fragment.childNodes[r].className += " show-animate animate-init";
            t.target.append(t.fragment);
            delete t.fragment
        }
        f = this;
        n && setTimeout(function () {
            f.container.find(".animate-init").removeClass("animate-init")
        }, 1)
    };
    t.prototype.removeColumns = function () {
        this.columns.forEach(function (n) {
            n.target.detach()
        })
    };
    t.prototype.rescan = function () {
        this.addItems(this.getItems(), !0);
        this.pushFragmentsToColumns()
    };
    t.prototype.reset = function () {
        this.items = [];
        this.removeColumns();
        this.init()
    };
    n.fn.columnsBalancer = function (i) {
        if (n(this).length)return new t(n(this), i);
        var r = [];
        return n(this).each(function () {
            r.push(new t(n(this), i))
        }), r
    }
}(jQuery), D83 = {modalDialog: null, dialogs: [], messageInterval: null, messageDelay: 4e3, NOTIFICATION_ANIMATION_START_OFFSET: "-33px", _constrainDraggableOptionsIfNeeded: function (n) {
    return J77.enabled("constraint_dialogs_movement") && (n.containment = ".chart-page"), n
}, showIntervalMismatchDialog: function (n) {
    var r, t, i;
    r = !1;
    D83.createModalDialog("Interval is not applicable");
    t = D83.modalDialog;
    t.css({zIndex: 1e3});
    t.find(".tv-dialog").css("width", "400px");
    t = D83.modalDialog.find(".tv-dialog-content");
    t.html('<div class="main"><div class="caption-big"><p>Only <b>D, W, M<\/b> intervals are supported for this symbol/exchange. You will be automatically switched to a D interval. Intraday intervals are not available because of exchange policies.<\/p><\/div><div class="main-properties"><\/div><\/div>');
    t = t.find(".main-properties");
    t = $('<div class="dialog-buttons"><\/div>').appendTo(t);
    n && (i = $('<label class="dialog-trail-checkbox"><input type="checkbox" /> Do not show this message again<\/label>').appendTo(t).find("input"), i.attr("checked", n.silentIntervalChange.value()), i.bind("click", function () {
        n.silentIntervalChange.setValue(this.checked)
    }));
    $('<a class="tv-button ok">OK<\/a>').appendTo(t).bind("click", function () {
        D83.destroy()
    });
    D83.positionDialog();
    D83.applyHandlers(!1, {doNotCloseOnBgClickIfShadowbox: r})
}, showSignInDialog: function (n, t) {
    function r(n) {
        switch (n) {
            case"signup":
            case"register":
                break;
            case"signup-trial":
                n = "signup-trial";
                break;
            case"recover":
                n = "recover";
                break;
            default:
                n = "signin"
        }
        i.find('[name="signup_trial"]').val("signup-trial" == n ? 1 : 0);
        i.find(".show-if-signin, .show-if-signup, .show-if-recover, .show-if-signup-trial").not(".show-if-" + n).hide();
        i.find(".show-if-" + n).show().find("input:eq(0)").focus();
        D83.positionDialog()
    }

    if (!is_authenticated) {
        "function" == typeof n ? D83.onSigninSuccess = n : delete D83.onSigninSuccess;
        D83.createModalDialog("Log in", {noHeader: !0, addClass: "auth-dialog"});
        var i = D83.modalDialog.find(".tv-dialog-content");
        i.html(TradingView.templates.dialogs.auth);
        r(t && t.mode);
        i.find(".recover-link").on("click", function (n) {
            r("recover");
            n.preventDefault()
        });
        i.find(".signup-link").on("click", function (n) {
            r("signup");
            n.preventDefault()
        });
        i.find(".signin-link").on("click", function (n) {
            r("signin");
            n.preventDefault()
        });
        i.find(".auth-dialog-field").each(function () {
            function i() {
                n.toggleClass("empty", !n.val());
                t = !1
            }

            var r = $(this).find(".auth-dialog-field-placeholder"), n = $(this).find("input"), t = !1;
            i();
            n.on("blur", function () {
                r.toggleClass("disabled", !!this.value)
            });
            n.on("keypress keydown keyup input paste", function () {
                t || (t = !0, setTimeout(function () {
                    i()
                }, 0))
            })
        });
        "stocktwits google facebook twitter linkedin yahoo".split(" ").forEach(function (n) {
            var r = "/accounts/signin/" + n + "/";
            i.find(".auth-dialog-social-" + n).on("click", function (n) {
                t && "signup-trial" == t.mode && $.cookie("will_start_trial", 1, {path: "/"});
                n.preventDefault();
                window.open(r, "_blank")
            })
        });
        i.find("#signin-form").on("submit", function (n) {
            n.preventDefault();
            var t = $(this).find('[type="submit"]').addClass("process");
            D83.submit(function (n) {
                "" !== n.error ? D83.showError("Error: " + n.error) : (D83.destroy(), user = n.user, changeLoginState(!0), "function" == typeof D83.onSigninSuccess && (D83.onSigninSuccess(), delete D83.onSigninSuccess), "undefined" != typeof next && next && (location.href = next));
                t.removeClass("process")
            }, this)
        });
        i.find("#signup-form").on("submit", function (n) {
            var t = this, i;
            n.preventDefault();
            i = $(t).find('[type="submit"]').addClass("process");
            D83.submit(function (n) {
                if ($(".tv-dialog input").removeClass("error"), $(".tv-dialog-field-error").hide(), "" !== n.errors)if ("object" == typeof n.errors) {
                    for (var r in n.errors)$(t).find("input[name^=" + r + "]").addClass("error").data("error", n.errors[r][0]);
                    $(".tv-dialog input.error").first().focus();
                    D83.showError($(".tv-dialog input.error").first().data("error"))
                } else D83.showError("Error: " + n.errors); else D83.showNotice("Activate Your Account", n.message);
                i.removeClass("process")
            }, t)
        });
        i.find("#recover-form").on("submit", function (n) {
            n.preventDefault();
            var t = D83.modalDialog;
            D83.submit(function (n) {
                "" !== n.error ? D83.showError("Failed: " + n.error) : (D83.showMessage("New password is sent to your email."), setTimeout(function () {
                    D83.modalDialog === t && D83.destroy()
                }, D83.messageDelay))
            }, this)
        });
        D83.positionDialog();
        D83.applyHandlers(null)
    }
}, showPublishIntroDialog: function (n) {
    var t = $.Deferred(), r = TVSettings.getBool("publish.showIntroText", !0), i;
    if (n || r) {
        n = D83.createDialog("Please read before publishing");
        i = !1;
        n.css({width: "750px", "z-index": 130});
        n.find(".tv-dialog-content").html(Mustache.render(TradingView.templates.dialogs.publishIntro, {do_not_show: !r}));
        n.draggable(D83._constrainDraggableOptionsIfNeeded({handle: ".tv-dialog-title"}));
        n.find('input[name="donotshow"]').on("change", function () {
            TVSettings.setValue("publish.showIntroText", !$(this).is(":checked"))
        });
        $("#publish-intro-continue").click(function () {
            D83.destroy("Please read before publishing");
            t.resolve()
        });
        n.on("destroy", function () {
            i = !0;
            setTimeout(t.resolve, 0)
        });
        t.always(function () {
            i || D83.destroy("Please read before publishing")
        });
        D83.positionDialog(n);
        D83.applyHandlers(n)
    } else t.resolve();
    return t
}, showPublishChartDialog: function (n) {
    function a() {
        var i, r;
        if (t.find(".publish-related").tvtags("extractTags"), i = {name: t.find('[name="name"]').val(), description: t.find('[name="description"]').val(), direction: t.find('input[name="direction"]').val(), is_public: "1"}, n.onWidget || (i.tags = t.find(".publish-tags").tvtags("extractTags").tvtags("tagsWithPending").join(","), i.twitter = t.find('input[name="twitter"]').is(":checked") ? "1" : "", i.stocktwits = t.find('input[name="stocktwits"]').is(":checked") ? "1" : "", i.is_public = t.find('input[name="public"]').is(":checked") ? "1" : "", i.related_charts = t.find(".publish-related").tvtags("extractTags").tvtags("tagsWithPending").join(","), i.chat = t.find('input[name="chat"]').is(":checked") ? "1" : ""), n.publishSource && (i.publish_source = n.publishSource), r = {onWidget: n.onWidget, publishAllLayout: t.find('[name="publish_entire_layout"]').is(":checked")}, i.name.trim())if (i.description.trim())if (isLatin(i.name) && isLatin(i.description))if (isLatin(i.tags)) {
            if (n.onPublish)n.onPublish(i, r)
        } else D83.showError("Please use only English in tags"); else D83.showError("TradingView is only for English-language content at this time."); else D83.showError("Chart description is required", t), t.find('[name="description"]').focus(); else D83.showError("Chart title is required", t), t.find('[name="name"]').focus()
    }

    function v() {
        t.show();
        var i = TVSettings.getJSON("publishchart.size", {w: c, h: l});
        t.height(Math.max(Math.min(i.h, .9 * $(window).height()), l));
        t.width(Math.max(Math.min(i.w, .9 * $(window).width()), c));
        f();
        D83.positionDialog(t, {considerScroll: !0});
        n.onShow && n.onShow()
    }

    function y() {
        t.hide();
        n.onMinimize && n.onMinimize()
    }

    var f, o, s, h, c, l;
    n = n || {};
    var u = "edit" === n.mode, e = u ? "Edit Idea" : "Publish Idea", t = D83.createDialog(e, {addClass: "publish-dialog", hideCloseCross: !u});
    t.css("width", "700px");
    var r = t.find(".tv-dialog-content"), i = n.onWidget ? TradingView.templates.dialogs.publishChartWidget : TradingView.templates.dialogs.publishChart, p = TradingView.clone(window.user || {});
    p.editMode = u;
    r.html(Mustache.render(i, p));
    i = t.find(".tv-dialog-title");
    u || ($('<a class="tv-dialog-title-minimize"><\/a>').appendTo(i).on("click", function (n) {
        n.preventDefault();
        y()
    }), $('<span class="tv-dialog-readbefore"><a>Read before publishing<\/a><\/span>').appendTo(i));
    t.draggable(D83._constrainDraggableOptionsIfNeeded({handle: i}));
    f = function () {
        var n = r.find('textarea[name="description"]'), i = t.find(".tv-dialog-title").outerHeight();
        return r.children(".main, *[class^=main-]").eq(0), function () {
            n.css("height", t.height() - i - r.height() + n.height())
        }
    }();
    t.on("resize", function (n) {
        n.stopPropagation();
        n.preventDefault();
        f()
    });
    i = n.formData || {};
    i.name && t.find('[name="name"]').val(i.name);
    i.description && t.find('[name="description"]').val(i.description);
    i.direction && t.find('input[name="direction"]').val(i.direction);
    i.related_charts && t.find(".publish-related").val(i.related_charts);
    i.tags && t.find(".publish-tags").val(i.tags);
    $("#publish-chart-form").submit(function (n) {
        n.preventDefault();
        a()
    });
    $("#publish-dialog-do-publish").click(function (n) {
        n.preventDefault();
        a()
    });
    t.find('input[name="public"]').on("change", function () {
        $(this).is(":checked") || (o.prop("checked", !1).change(), s.prop("checked", !1).change())
    });
    o = t.find('input[name="twitter"]');
    s = t.find('input[name="stocktwits"]');
    o.change(function () {
        o.is(":checked") && (user.has_twitter || window.open("/accounts/permission/twitter/", "twitter_permission_request", "scrollbars=yes,height=400,width=700").focus())
    });
    s.change(function () {
        s.is(":checked") && authInStocktwits()
    });
    r.find(".publish-direction-buttons .tv-button").on("mousedown", function () {
        var n = $(this);
        $(".publish-direction-buttons .tv-button").removeClass("active");
        n.addClass("active");
        t.find('input[name="direction"]').val(n.data("val"))
    }).each(function () {
        $(this).toggleClass("active", +$(this).data("val") == (+t.find('input[name="direction"]').val() || 0))
    });
    t.find(".tv-dialog-readbefore a").on("click", function (n) {
        n.preventDefault();
        D83.showPublishIntroDialog(!0)
    });
    n.isPrivate && t.find('input[name="public"]').prop("checked", !1).change(), function () {
        function e(n) {
            return n = new Date(n), [n.getFullYear(), ("0" + n.getMonth()).substr(-2), ("0" + n.getDate()).substr(-2)].join("-")
        }

        function r(n) {
            return(/([0-9A-Za-z-]+)\/?$/.exec(n) || 0)[1]
        }

        var i = {}, u = t.find(".publish-related");
        n.related && u.val([].concat(n.related).join(","));
        u.tvtags("init", {suggest: function (n, t) {
            var u = location.protocol + "//" + location.host + "/v/";
            n.substr(0, u.length) === u && (n = r(n) || n);
            $.ajax("/ideas-json/", {data: {search: n}, dataType: "json"}).done(function (n) {
                n = n || [];
                n.forEach(function (n) {
                    i[n.image_url] = n;
                    n.str = u + n.image_url + "/"
                });
                t(n)
            }).error(function () {
                t(null)
            })
        }, formatSuggest: function (n) {
            var t = $(document.createElement("span")).addClass("date").text(e(1e3 * n.created) + " "), i = $(document.createElement("strong")).text(n.name);
            return n = $(document.createTextNode(" " + [n.short_name || n.pro_symbol, n.resolution].join(", "))), {content: $().add(t).add(i).add(n)}
        }, validate: function (n, t) {
            var u = r(n);
            u ? i[u] ? t(!0) : $.ajax("/ideas-json/" + u + "/", {dataType: "json"}).done(function (n) {
                n && n.length ? (i[n[0].image_url] = n[0], t(!0)) : t(!1)
            }).error(function () {
                t(!1)
            }) : t(!1)
        }, transform: r, format: function (n) {
            n = n.str;
            var t = i[n];
            return t && n ? t.name : "Idea"
        }, keys: ["\n", ",", /\s/, ";"], separator: ","}).on("change", f)
    }();
    t.find(".publish-tags").tvtags("init", {keys: ["\n", ",", /\s/, ";"], separator: ",", addClass: "no-arrow with-ears", format: function (n) {
        return{str: n.str, addClass: "tag"}
    }, transform: function (n) {
        return n.toLowerCase()
    }, suggest: function (n, t) {
        n || t(null);
        $.ajax("/tags-json/", {data: {search: n.toLowerCase()}, dataType: "json"}).done(function (n) {
            t(n)
        }).error(function () {
            t(null)
        })
    }, maxLength: 64, caseInsensitive: !0}).on("change", f);
    h = [];
    n.Q6 && function () {
        function l() {
            var n = o.value().model();
            return n ? (n = n.mainSeries(), (n.properties().shortName.value() || n.symbol()) + " (" + n.interval() + ")") : "Active Chart"
        }

        function u() {
            a.toggleClass("hidden", !("s" !== f.value() && !s.value()));
            e.is(":checked") ? (c.text("All Charts"), i.attr({"class": "tv-dialog-layout-button tv-dialog-layout-" + f.value()})) : (c.text(l()), i.attr({"class": "tv-dialog-layout-button tv-dialog-layout-s"}))
        }

        var a = r.find(".tv-dialog-layoutpicker"), f = n.Q6.layout.spawn(), o = n.Q6.activeChartWidget.spawn(), s = n.Q6.maximizeCurrentChart.spawn(), v = D45.symbol.spawn(), i, e, c;
        h = [f, o, s, v];
        i = $('<span class="tv-dialog-layout-button">');
        e = $('<input type="checkbox" name="publish_entire_layout">').hide().appendTo(i);
        $('<i class="icon"><\/i>').appendTo(i);
        c = $("<span><\/span>").appendTo(i);
        $('<span class="arrow-icon"><\/span>').appendTo(i);
        f.subscribe(u);
        o.subscribe(u);
        s.subscribe(u);
        v.subscribe(u);
        u();
        TradingView.bindPopupMenu(i, function () {
            var n = e.is(":checked");
            return[
                {addClass: "tv-dialog-layout-popup tv-dialog-layout-s", title: "Publish Only " + l(), action: function () {
                    e.attr("checked", !1);
                    u()
                }, active: !n, icon: !0},
                {addClass: "tv-dialog-layout-popup tv-dialog-layout-" + f.value(), title: "Publish All Charts", action: function () {
                    e.attr("checked", !0);
                    u()
                }, active: n, icon: !0}
            ]
        }, {direction: "up"});
        i.appendTo(a);
        t.on("destroy", function () {
            for (var n = 0; n < h.length; n++)h[n].destroy()
        })
    }();
    t.find(".tv-dialog-cancel-button").on("click", function (n) {
        n.preventDefault();
        u ? D83.destroy(e) : D83.showConfirm("Cancel publication", "Are you sure you want to abandon your post?", function () {
            D83.destroy(e)
        })
    });
    if (n.onDestroy)t.on("destroy", n.onDestroy);
    return c = t.width(), l = t.height(), t.resizable({handles: "se", minHeight: l, minWidth: c, stop: function () {
        TVSettings.setJSON("publishchart.size", {w: t.width(), h: t.height()})
    }}), D83.applyHandlers(t, {doNotCloseOnBgClickIfShadowbox: !0, doNotCloseOnEsc: !0, doNotCloseOnBgClick: !0}), v(), {dialog: t, show: v, hide: y, close: function () {
        D83.destroy(e)
    }}
}, showGoProDialog: function (n) {
    var t, i;
    n || (n = {});
    D83.createModalDialog("", {noHeader: !0, addClass: "gopro-dialog ", appearance: "flat"});
    t = D83.modalDialog;
    t.css({zIndex: 1e3});
    t = t.find(".tv-dialog-content");
    t.html(Mustache.render(TradingView.templates.dialogs.goPro.layout, {trialButton: D10 && D10.trialAvailable && D10.trialAvailable(), exchangesButton: n.exchangesButton, exchange: n.exchange}));
    i = t.find(".col-main .col-copy");
    n = n.feature ? Mustache.render(TradingView.templates.dialogs.goPro.features[n.feature], {exchangesButton: n.exchangesButton, exchange: n.exchange, options: n.featureOptions || {}}) : TradingView.templates.dialogs.goPro.defaultCopy;
    i.html(n);
    t.find(".yes-button").on("click", function (n) {
        this.href === location.href && n.preventDefault();
        D83.destroy()
    });
    t.find(".no-button").on("click", function (n) {
        n.preventDefault();
        D83.destroy()
    });
    D83.positionDialog();
    D83.applyHandlers(null)
}, showAddSymbolDialog: function (n, t) {
    var i;
    t = $.extend({}, {title: "Add Symbol", callback: function () {
    }, overlayOption: !1, overlayOptionChecked: TVSettings.getBool("showAddSymbolDialog.checkboxState", !0), okButtonTitle: "Add Symbol"}, t || {});
    i = D83.createDialog(t.title);
    i.css("min-width", 0);
    i.find(".tv-dialog-content").html(Mustache.render(TradingView.templates.dialogs.addSymbol, t)).css("min-width", 0);
    D83.applyHandlers(i);
    var r = $('<div class="symbol-edit-widget"><\/div>'), u = $('<input type="text" class="symbol-edit single" placeholder="Symbol" maxlength="30" style="text-transform: none; font-weight: normal;" autocomplete="off">').appendTo(r), f = D69.bindToInput(u, {callback: function (n) {
        var u = i.find("#tv-dialog-addsymbol-overlay-checkbox").is(":checked"), r;
        n && (r = t.callback, r(n, u), $(window).off("keyup.addOverlay"), D83.destroy(i.data("title")))
    }});
    i.find("div.symbol-edit-place").replaceWith(r);
    i.find(".tv-dialog").draggable(D83._constrainDraggableOptionsIfNeeded({handle: ".tv-dialog-title"}));
    i.find("input[type=checkbox]").on("change", function (n) {
        TVSettings.setJSON("showAddSymbolDialog.checkboxState", n.target.checked)
    });
    i.find(".ok").on("click", function () {
        f.acceptTypeIn()
    });
    i.show();
    D83.positionDialog(i);
    u.focus()
}, makeDraggable: function (n) {
    n.draggable({handle: ".tv-dialog-title"})
}, showConfirmInputsDialog: function (n, t, i) {
    function s(n) {
        var t = i.callback;
        n = n.state();
        t(n);
        D83.destroy(r.data("title"))
    }

    var r, u, f, o, e;
    for (i = $.extend({}, {title: "Confirm Inputs", callback: function () {
    }, okButtonTitle: "Apply"}, i || {}), r = D83.createDialog(i.title, {content: "<div class='main'><\/div>"}), r.css("min-width", 0), D83.applyHandlers(r, {beforeDestroy: function () {
        $(window).unbind("keyup.hideInputsConfirmDialog")
    }}), u = TradingView.merge({}, t.defaults.inputs), f = 0; f < t.inputs.length; ++f)o = t.inputs[f], o.confirm || delete u[o.id];
    e = new Property({inputs: u});
    n = new _41(e, n.model(), {metaInfo: function () {
        return t
    }}, !0).widget();
    u = r.find(".main");
    u.append(n);
    $(window).bind("keyup.hideInputsConfirmDialog", function (n) {
        "13" == n.keyCode && "textarea" !== n.target.tagName.toLowerCase() && (s(e), $(window).unbind("keyup.hideInputsConfirmDialog"))
    });
    $("select", u).each(function () {
        var n = $(this), t = "tv-select-container dialog";
        n.hasClass("tv-select-container-fontsize") && (t += " tv-select-container-fontsize");
        n.selectbox({speed: 100, classHolder: t})
    });
    $('input[type="text"]', u).addClass("tv-text-input inset dialog");
    $("input.ticker", u).TVTicker();
    r.find(".main").append("<div class='tv-dialogs-bottom-button'><span class='tv-button tv-right tv-uppercase ok'>Apply<\/span><\/div>");
    r.find(".ok").on("click", function () {
        s(e)
    });
    r.show();
    D83.positionDialog(r);
    u.find("input,select").first().focus()
}, showUpdateAccountDataDialog: function (n) {
    var t = Mustache.render('<form>{{#html}}<p>{{&html}}<\/p>{{/html}}<input type="text" value="{{value}}"><\/form>', {value: n.value || "", html: n.html});
    return D83.showCustomDialog({title: n.title, html: t, action: function (t) {
        var i = t.find(".tv-button.ok");
        return i.addClass("process"), changeUserProfileField({name: n.paramName, value: t.find("input[type=text]").val(), onSuccess: n.success, onError: function (i) {
            i = (i || []).join(" ");
            "function" == typeof n.error ? n.error(i) : D83.showError(i || "Unexpected error: can't change profile data", t)
        }, onComplete: function () {
            i.removeClass("process")
        }}), {notClose: !0}
    }, onCancel: n.cancel})
}, showProRTTrialOffer: function (n) {
    D83.createModalDialog("", {noHeader: !0, addClass: "prorttrial-dialog ", appearance: "flat"});
    var t = D83.modalDialog;
    t.css({zIndex: 1e3}).find(".tv-dialog");
    t = t.find(".tv-dialog-content");
    t.html(Mustache.render(TradingView.templates.dialogs.proRTTrialOffer));
    t.find("a.trial").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onAccept && n.callbacks.onAccept()
    });
    t.find("a.nothanks").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onDecline && n.callbacks.onDecline()
    });
    t.find("a.ordernow").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onOrder && n.callbacks.onOrder()
    });
    t.find("a.later").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onRemindLater && n.callbacks.onRemindLater()
    });
    D83.positionDialog();
    D83.applyHandlers(null, {doNotCloseOnBgClickIfShadowbox: !0, doNotCloseOnEsc: !0})
}, showTrialMessage: function (n) {
    var t;
    D83.createModalDialog("", {noHeader: !0, addClass: "prorttrial-dialog ", appearance: "flat"});
    t = D83.modalDialog;
    t.css({zIndex: 1e3}).find(".tv-dialog");
    t = t.find(".tv-dialog-content");
    t.html('<div class="main"><h3 class="title"><\/h3><div class="copy"><\/div><div class="big-buttons"><a href="javascript://" class="big-button ok">OK<\/a><\/div><\/div>');
    var i = t.find(".title"), r = t.find(".copy"), u = t.find(".big-button.ok"), f = t.find(".big-buttons");
    n && n.title ? i.html(n.title) : i.remove();
    n && n.copy ? r.html(n.copy) : r.remove();
    n && n.closeButtonCopy && u.html(n.closeButtonCopy);
    n && n.replaseCloseBtn && f.html(n.replaseCloseBtn);
    t.find("a.ok").on("click", function (t) {
        n && n.replaseCloseBtnFunc ? n.replaseCloseBtnFunc(t) : (t.preventDefault(), D83.destroy())
    });
    D83.positionDialog();
    D83.applyHandlers(null)
}, showTrialMessageSuccess: function () {
    D83.showTrialMessage({title: "PRO Plus Trial", copy: "<p>Your 30-day free PRO Plus account has been activated. You are now part of a community of 2 million+ ideas that have been created within TradingView charts. To help get the ball rolling, we'd suggest you spend a few minutes familiarizing yourself with our online <a href='/stock-charts-support/'>help section<\/a>. We hope you enjoy working with TradingView and wish you good trading!<\/p>", replaseCloseBtn: "<a href='/e/' class='big-button ok'>LAUNCH CHART<\/a>", replaseCloseBtnFunc: function () {
    }})
}, showTrialConfirmationDialog: function (n) {
    var i, t;
    n = n || {};
    D83.createModalDialog("", {noHeader: !0, addClass: "trialconfirm-dialog ", appearance: "flat"});
    i = D83.modalDialog;
    i.css({zIndex: 1e3});
    t = i.find(".tv-dialog-content");
    t.html('<div class="main"><h3 class="title">' + (n.title || "Trial confirmation dialog") + '<\/h3><div class="copy">' + (n.text || "Trial confirmation text") + '<\/div><div class="actions-block"><a class="no-button">' + (n.noText || "No, thank you") + '<\/a><a class="yes-button">START TRIAL<\/a><\/div><\/div>');
    i = t.find(".no-button");
    t = t.find(".yes-button");
    i.on("click", function (t) {
        if (t.preventDefault(), "function" == typeof n.onCancel)return n.onCancel(t);
        D83.destroy()
    });
    t.on("click", function (t) {
        if ("function" == typeof n.onSubmit)return n.onSubmit(t);
        t.preventDefault()
    });
    D83.positionDialog();
    D83.applyHandlers(null)
}, showEarlyAccessDialog: function (n) {
    var t, i;
    D83.createModalDialog("", {noHeader: !0, addClass: "prorttrial-dialog ", appearance: "flat"});
    t = D83.modalDialog;
    t.css({zIndex: 1e3}).find(".tv-dialog");
    t = t.find(".tv-dialog-content");
    i = {};
    switch (n && n.reason) {
        case"after 1 week":
            i.is_1wk = !0;
            break;
        case"after 2 weeks":
            i.is_2wk = !0;
            break;
        case"finished":
            i.is_finished = !0;
            break;
        default:
            i.is_manual = !0
    }
    t.html(Mustache.render(TradingView.templates.dialogs.earlyAccess, i));
    i = null;
    t.find("a.nothanks").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onDecline && n.callbacks.onDecline()
    });
    t.find("a.ordernow").on("click", function (t) {
        t.preventDefault();
        n && n.callbacks && n.callbacks.onOrder && n.callbacks.onOrder()
    });
    D83.positionDialog();
    D83.applyHandlers(null, {doNotCloseOnBgClickIfShadowbox: !0, doNotCloseOnEsc: !0})
}, showUnsubscribeConfirmationDialog: function (n, t, i) {
    D83.createModalDialog(n);
    D83.modalDialog.find(".tv-dialog").css("width", "450px");
    D83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big">Aww, we are sorry to see you go! If you cancel, you will no longer be billed after your current subscription period ends. Your subscription service will continue to be active until the end of the period that you paid for. Sorry, there are no refunds.<br/><br/>If you are sure you want to cancel, click Cancel, otherwise choose Do Not Cancel. If you cancel, we’d really like to know the reason why you are cancelling so we can make things better.<\/div><textarea style="width: 398px; height: 100px;"><\/textarea><\/div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide yes" type="button" value="Cancel {{text}} and send feedback" style="margin-right: 10px;"/><input class="tv-button wide no" type="button" value="Do Not Cancel"/><\/div>', {text: t}));
    var r = D83.modalDialog.find(".yes");
    r.click(function () {
        var n = D83.modalDialog.find("textarea").val();
        n ? (r.addClass("process"), i(n)) : D83.showError("Please enter your feedback")
    });
    D83.modalDialog.find(".no").click(function () {
        D83.destroy()
    });
    D83.positionDialog();
    D83.applyHandlers()
}, showChangeUserStatusDialog: function () {
    var n = D83.createDialog("Update status"), i, t;
    n.find(".tv-dialog").css("width", "400px");
    n.find(".tv-dialog-content").html('<form><div class="main"><input type="text" name="status" value="' + ("string" == typeof window.user.status ? window.user.status.replace(/"/g, "&quot;") : "") + '"><\/div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="submit" value="OK" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="Cancel"/><\/div><\/form>');
    i = n.find(".ok");
    t = n.find('[name="status"]');
    n.find("form").submit(function () {
        return i.addClass("process"), changeUserProfileField({name: "status", value: String(t.val()).replace(/^\s+|\s+$/g, ""), onSuccess: function (n) {
            var t = $("#change-profile-status"), i = n ? n : "Add status...";
            t.hasClass("tv-editable-active") ? t.find('input[type="text"], textarea').val(i) : t.text(i);
            $('[name="status"]').val(n);
            D83.destroy("Update status")
        }, onError: function (n) {
            D83.showError("We'are sorry, something went wrong. Try to reload page.");
            console.warn(n)
        }, onComplete: function () {
            i.removeClass("process")
        }}), !1
    });
    n.find(".cancel").click(function () {
        D83.destroy("Update status")
    });
    Modernizr.touch && t.val("");
    D83.positionDialog(n, {considerScroll: !0});
    D83.applyHandlers(n);
    t.focus().select()
}, showScriptSearchDialog: function (n) {
    function u() {
        if (value = f.val(), value !== r) {
            r = value;
            o.toggle(!!value);
            t && (t.abort && t.abort(), t = null);
            i.html('<div class="loading"><\/div>');
            var n = D56.suggest(r);
            t = n;
            D56.list().done(function (i) {
                n.done(function (r) {
                    n === t && s(r, i)
                })
            })
        }
    }

    function s(n, t) {
        i.empty();
        n && (n.length || $('<p class="nothing">No scripts matched your criteria<\/p>').appendTo(i), n.forEach(function (n) {
            var u, r, f;
            if (n) {
                if (u = $('<div class="item">'), n.author && (r = $('<div class="item-avatar">').appendTo(u), $("<img>").attr({src: "/avatar/" + n.author.id + "/", "class": "avatar userlink", alt: n.author.username, "data-username": n.author.username}).appendTo(r)), r = $('<div class="item-buttons"><\/div>').appendTo(u), $(Mustache.render(TradingView.templates.publishedScriptButton, {script_id_part: n.scriptIdPart, script_install_count: n.scriptInstallCount, show_script_install_count: !!n.scriptInstallCount, script_in_library: t.some(function (t) {
                    return t.scriptIdPart == n.scriptIdPart
                })})).appendTo(r), e) {
                    f = $('<a class="pubscript-try-button" title="Add this study to active chart"><span class="label">Try<\/span><\/a>');
                    f.on("click", function (t) {
                        t.preventDefault();
                        e(n)
                    });
                    f.appendTo(r)
                }
                r = $('<div class="item-main">').appendTo(u);
                f = $('<div class="item-title">').appendTo(r);
                $("<a>").attr({href: "/v/" + n.imageUrl + "/", target: "_blank"}).text(n.scriptName || n.scriptTitle || "Study").appendTo(f);
                $('<div class="item-desc">').text(n.description || "").appendTo(r);
                i.append(u)
            }
        }))
    }

    var e = n.onTry, r, t;
    n = D83.createDialog("Search for scripts published by community", {width: 815, content: TradingView.templates.dialogs.scriptSearch, addClass: "script-search-dialog"});
    var f = n.find("input[name=q]"), o = n.find(".input-reset"), i = n.find(".script-search-results");
    o.on("click", function () {
        f.val("");
        u()
    });
    r = void 0;
    t = null;
    f.on("input keyup change", u);
    return u(), D83.positionDialog(n), D83.applyHandlers(n), n
}, showPrioritySupportDialog: function () {
    D83.showCustomDialog({title: "Priority Support", html: TradingView.templates.dialogs.proiritySupport, noButtons: !0})
}, showNotice: function (n, t, i) {
    return"object" == typeof t && (i = t, t = ""), i = i || {}, doNotCloseOnBgClick = i.doNotCloseOnBgClick || !1, html = i.html || "", D83.createModalDialog(n), D83.modalDialog.find(".tv-dialog").css("width", "400px"), D83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big-center {{classSuffix}}">{{text}}' + html + "<\/div><\/div>", {classSuffix: i.classSuffix || "", text: t})), D83.positionDialog(), D83.applyHandlers(!1, {doNotCloseOnBgClickIfShadowbox: doNotCloseOnBgClick, beforeDestroy: i.onClose}), D83.modalDialog
}, showConfirm: function (n, t, i, r, u) {
    u = u || {};
    u.dontAskSetting && TVSettings.getBool(u.dontAskSetting) ? i() : (D83.createModalDialog(n, u), D83.modalDialog.find(".tv-dialog").css("width", "400px"), D83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><div class="caption-big">{{text}}<\/div>{{#dontAskSetting}}<input type="checkbox" id="confirm-dialog-checkbox" style="margin: 0; vertical-align: middle;"> <label for="confirm-dialog-checkbox" style="font-size: 11px;">Do not ask again<\/label>{{/dontAskSetting}}<\/div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="button" value="' + $.t("YES") + '" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="' + $.t("NO") + '"/><\/div>', {text: t, dontAskSetting: !!u.dontAskSetting})), u.okButtonText && D83.modalDialog.find(".ok").val(u.okButtonText), u.cancelButtonText && D83.modalDialog.find(".cancel").val(u.cancelButtonText), D83.modalDialog.find(".ok").click(function () {
        u.dontAskSetting && $("#confirm-dialog-checkbox").is(":checked") && TVSettings.setValue(u.dontAskSetting, !0);
        i();
        D83.destroy()
    }), D83.modalDialog.find(".cancel").click(function () {
        r && r();
        D83.destroy()
    }), D83.positionDialog(), D83.applyHandlers())
}, showPrompt: function (n, t, i, r, u) {
    function e() {
        var t = f.val(), n;
        if (s && (n = s(t), n)) {
            !0 === n && (n = "Wrong value");
            D83.showError(n, D83.modalDialog);
            return
        }
        D83.destroy();
        i && i(t)
    }

    var o = u && u.defaultValue, s = u && u.validate, f;
    D83.createModalDialog(n, u);
    D83.modalDialog.find(".tv-dialog").css("width", "400px");
    D83.modalDialog.find(".tv-dialog-content").html(Mustache.render('<div class="main"><form><div class="caption-big-center slim">{{text}}: <input type="text" name="prompt-value" class="prompt-value"/><\/div><\/form><\/div><div class="tv-dialogs-bottom tv-dialog-center"><input class="tv-button wide ok" type="button" value="OK" style="margin-right: 10px;"/><input class="tv-button wide cancel" type="button" value="Cancel"/><\/div>', {text: t}));
    f = D83.modalDialog.find('[name="prompt-value"]');
    o && f.val(o);
    D83.modalDialog.find("form").submit(function (n) {
        e();
        n.preventDefault()
    });
    D83.modalDialog.find(".ok").click(function (n) {
        e();
        n.preventDefault()
    });
    D83.modalDialog.find(".cancel").click(function () {
        D83.destroy();
        r && r(value)
    });
    D83.positionDialog();
    D83.applyHandlers();
    setTimeout(function () {
        f.focus().select()
    }, 0)
}, showCustomDialog: function (n) {
    function t(t) {
        var i = n.action(D83.modalDialog), r = i && i.notClose;
        (!i || i.error) && void 0 !== i || r ? i.error && D83.showError(i.error) : D83.destroy();
        t.preventDefault()
    }

    function i() {
        "function" == typeof n.onCancel ? n.onCancel() : D83.destroy()
    }

    return D83.createModalDialog(n.title || "Dialog"), D83.modalDialog.find(".tv-dialog").css("width", n.width || "400px"), D83.modalDialog.find(".tv-dialog-content").html('<div class="main">' + (n.html || "Content") + "<\/div>" + (n.noButtons ? "" : '<div class="tv-dialogs-bottom tv-dialog-center">' + (n.noButtonOk ? "" : '<input class="tv-button wide ok" type="button" value="OK" style="margin-right: 10px;"/>') + (n.noButtonCnacel ? "" : '<input class="tv-button wide cancel" type="button" value="Cancel"/>') + "<\/div>")), n.okButtonText && D83.modalDialog.find(".ok").val(n.okButtonText), n.cancelButtonText && D83.modalDialog.find(".cancel").val(n.cancelButtonText), D83.modalDialog.find(".ok").click(t), D83.modalDialog.find("form").submit(t), D83.modalDialog.find(".cancel").click(i), D83.modalDialog.find(".tv-dialog-title-close").click(i), D83.positionDialog(), D83.applyHandlers(), D83.modalDialog
}, createModalDialog: function (n, t) {
    t = t || {};
    null !== D83.modalDialog && D83.destroy();
    D83.modalDialog = $('<div class="tv-dialog-shadowbox"><div class="tv-dialog tv-dialog-modal' + (t.addClass ? " " + t.addClass : "") + '">' + (t.noHeader ? "" : '<div class="tv-dialog-title">' + (t.noClose ? "" : '<a class="tv-dialog-title-close"><\/a>') + '<span class="tv-dialog-title-text">' + n + "<\/span><\/div>") + '<div class="tv-dialog-error"><\/div><div class="tv-dialog-message"><\/div><div class="tv-dialog-content"><\/div><\/div><\/div>').appendTo($("body")).data("title", n);
    t.noShadowBox && D83.modalDialog.addClass("transparent");
    t.addClass && D83.modalDialog.addClass(t.addClass);
    t.width && D83.modalDialog.find(".tv-dialog").css({width: t.width});
    t.content && D83.modalDialog.find(".tv-dialog-content").html(t.content);
    var i = $(".fancybox-overlay");
    i.length && (i = i.css("z-index"), $(".tv-dialog-shadowbox").css("z-index", i + 1));
    t.zIndex && D83.modalDialog.css("z-index", t.zIndex)
}, createDialog: function (n, t) {
    var i, r;
    return D83.isOpen(n) ? (i = D83.get(n), i.find(".tv-dialog-content").html(""), i.data("new", !1), i) : (t = t || {}, i = $(Mustache.render('<div class="tv-dialog tv-dialog-nonmodal {{&addClass}}"><div class="tv-dialog-title{{#hideTitle}} tv-dialog-title-hidden{{/hideTitle}}{{#hideCloseCross}} tv-dialog-title-no-close{{/hideCloseCross}}">{{^hideTitle}} {{&title}}{{/hideTitle}}{{^hideCloseCross}}<a class="tv-dialog-title-close"><\/a>{{/hideCloseCross}}<\/div><div class="tv-dialog-error"><\/div><div class="tv-dialog-message"><\/div><div class="tv-dialog-content"><\/div><\/div>', {addClass: t.addClass || "", hideTitle: t.hideTitle, hideCloseCross: t.hideCloseCross, title: n})).appendTo($("body")), t.width && i.css({width: t.width}), t.content && i.find(".tv-dialog-content").html(t.content), r = 0, r = D83.dialogs && D83.dialogs.length ? MathEx.max($.map(D83.dialogs, function (n) {
        return parseInt((n.dialog || n).css("z-index"), 10)
    })) + 1 : 110, i.css("z-index", r), i.data("new", !0), i.data("title", n), i.data("id", D83.dialogs.length + 1), D83.dialogs.push({title: n, dialog: i, id: D83.dialogs.length + 1}), r = {start: function (n, t) {
        for (var u, e = t.helper.css("z-index"), r = 0, f = null, i = 0; i < D83.dialogs.length; i++)u = D83.dialogs[i].dialog.css("z-index"), u > r && (r = u, f = D83.dialogs[i].dialog);
        t.helper.css("z-index", r);
        f.css("z-index", e)
    }}, t.dragHandle ? r.handle = t.dragHandle : t.hideTitle || (r.handle = ".tv-dialog-title"), i.draggable(D83._constrainDraggableOptionsIfNeeded(r)), i)
}, positionDialog: function (n, t, i) {
    var f;
    if (i = i || {}, t = t || i.position, n) {
        var r = n.width(), u = n.height(), e = $(window).width(), o = $(window).height();
        t && t.top && t.right ? (r = i.forcePosition ? t.right : Math.max(2, Math.min(e - r - 4, t.right)) + "px", u = i.forcePosition ? t.top : Math.max(2, Math.min(o - u - 4, t.top)) + "px") : t && t.considerScroll ? (t = $(document), r = Math.round((e - r) / 2 + t.scrollLeft()) + "px", u = Math.round((o - u) / 2 + t.scrollTop()) + "px") : (r = Math.round((e - r) / 2) + "px", u = Math.round((o - u) / 2) + "px");
        i.smooth ? n.animate({right: r, top: u}) : n.css({right: r, top: u});
        i = function () {
            f.css("margin-left", -Math.round(f.outerWidth() / 2) + "px");
            f.css("margin-top", -Math.round(f.outerHeight() / 2) + "px")
        };
        n = D83.modalDialog;
        f = n.find(".tv-dialog");
        i();
        f.resize(i)
    }
}, applyHandlers: function (n, t) {
    var i = !n || n === this.modalDialog, r;
    if (t = t || {}, r = i ? function () {
        D83.destroy()
    } : function () {
        D83.destroy(n.data("title"))
    }, n || (n = D83.modalDialog.find(".tv-dialog")), t.beforeDestroy)n.on("destroy", t.beforeDestroy);
    n.find(".tv-dialog-title .tv-dialog-title-close").on("click", r);
    t.doNotCloseOnBgClick || setTimeout(function () {
        n.on("mousedownoutside", function (i) {
            i = $(i.target).parents().andSelf();
            t.doNotCloseOnBgClickIfShadowbox && i.is(".tv-dialog-shadowbox") || i.is(".colorpicker, .charts-popup-list, .tv-dialog, .tvcolorpicker-popup, .symbol-edit-popup, .ui-datepicker, .clockpicker-popover, .pac-container") || (n.unbind("mousedownoutside"), r())
        })
    }, 0);
    n.find('input[type="checkbox"]').change(function () {
        var n = $(this);
        n.next(".tv-dialog-checkbox-mask").toggleClass("disabled", n.prop("disabled")).toggleClass("tv-dialog-checkbox-mask-active", n.is(":checked"))
    });
    i = n.find('input[type="text"]').focus(function () {
        $(this).addClass("tv-dialog-content-textactive")
    }).blur(function () {
        $(this).removeClass("tv-dialog-content-textactive")
    }).first();
    Modernizr.touch || t.notFocusFirst || i.focus();
    n.find('input[type="password"]').focus(function () {
        $(this).addClass("tv-dialog-content-textactive")
    }).blur(function () {
        $(this).removeClass("tv-dialog-content-textactive")
    });
    n.find("textarea").focus(function () {
        $(this).addClass("tv-dialog-content-textareaactive")
    }).blur(function () {
        $(this).removeClass("tv-dialog-content-textareaactive")
    });
    n.find(".tv-dialog-checkbox-mask").click(function () {
        var n = $(this).prev();
        n.prop("disabled") || (n.prop("checked", !n[0].checked), n.change())
    });
    $(".tv-dialog .tv-dialog-error").mouseenter(function () {
        $(this).animate({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, opacity: 0}, "fast", function () {
            $(".tv-dialog .tv-dialog-error").hide()
        });
        clearInterval(D83.messageInterval)
    });
    $(".tv-dialog .tv-dialog-message").mouseenter(function () {
        $(this).animate({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, opacity: 0}, "fast", function () {
            $(".tv-dialog .tv-dialog-message").hide()
        });
        clearInterval(D83.messageInterval)
    });
    t.doNotCloseOnEsc || $(window).bind("keyup.hideDialog", function (t) {
        if ("27" == t.keyCode)return n ? D83.destroy(n.data("title")) : D83.destroy(), !1
    })
}, showError: function (n, t) {
    var i;
    t ? (i = t.find(".tv-dialog-error"), t.width()) : (i = $(".tv-dialog .tv-dialog-error"), $(".tv-dialog").width());
    i.text(n).css({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, left: "10px", right: "10px", opacity: "0"}).show().animate({marginTop: 0, opacity: 1}, "fast");
    clearInterval(D83.messageInterval);
    D83.messageInterval = setInterval(function () {
        $(".tv-dialog .tv-dialog-error").animate({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, opacity: 0}, "fast", function () {
            $(".tv-dialog .tv-dialog-error").hide()
        });
        clearInterval(D83.messageInterval)
    }, D83.messageDelay)
}, showMessage: function (n) {
    $(".tv-dialog .tv-dialog-message").text(n).css({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, left: "10px", right: "10px", opacity: "0"}).show().animate({marginTop: 0, opacity: 1}, "fast");
    clearInterval(D83.messageInterval);
    D83.messageInterval = setTimeout(function () {
        $(".tv-dialog .tv-dialog-message").animate({marginTop: D83.NOTIFICATION_ANIMATION_START_OFFSET, opacity: 0}, "fast", function () {
            $(".tv-dialog .tv-dialog-message").hide()
        });
        clearInterval(D83.messageInterval)
    }, D83.messageDelay)
}, showStocktwitsDialog: function (n, t) {
    return D83.showCustomDialog({title: "Send Message to stocktwits", html: Mustache.render('<textarea style="width: 100%" maxLength="120">{{text}}<\/textarea>', {text: n}), action: t})
}, isOpen: function (n) {
    for (var t = 0; t < D83.dialogs.length; t++)if (D83.dialogs[t].title == n)return!0;
    return!1
}, get: function (n) {
    for (var t = 0; t < D83.dialogs.length; t++)if (D83.dialogs[t].title == n)return D83.dialogs[t].dialog
}, submit: function (n, t) {
    var i = t ? $(t) : $(".tv-dialog form").first(), r = i.serialize(), i = i.attr("action");
    $.post(i, r, function (t) {
        void 0 !== n && n(t)
    }, "json")
}, destroy: function (n) {
    if (void 0 !== D83.chart && (D83.chart.destroy(), delete D83.chart), $(window).unbind("keyup.hideDialog"), n)for (var t = 0; t < D83.dialogs.length; t++)D83.dialogs[t].title == n && (D83.dialogs[t].dialog.trigger("destroy"), $(document).unbind("mouseup.hideDialog" + D83.dialogs[t].id), $("input", D83.dialogs[t].dialog).blur(), D83.dialogs[t].dialog.remove(), D83.dialogs.splice(t, 1)); else D83.modalDialog && (D83.modalDialog.find(".tv-dialog").trigger("destroy"), D83.modalDialog.remove(), D83.modalDialog = null)
}, changeTitle: function (n, t) {
    var i;
    if (n)for (i = 0; i < D83.dialogs.length; i++)if (D83.dialogs[i].title == n) {
        var i = D83.dialogs[i], u = i.dialog, r = u.find(".tv-dialog-title");
        i.title = t;
        u.data("title", t);
        r.html(r.html().replace(n, t));
        r.find("a").on("click", function () {
            D83.destroy(t)
        });
        break
    }
}, calcHeight: function (n, t, i) {
    return null == i && (i = 20), n += i, i = parseInt($("body").height(), 10), n > i && (t = Math.max(0, t - (n - i))), t
}, resizeContent: function (n, t, i) {
    null == i && (i = 20);
    n += i;
    i = parseInt($("body").height(), 10);
    var r = t.height();
    n > i && (r = Math.max(0, r - (n - i)), t.height(r))
}, resizeContentWidth: function (n, t, i) {
    null == i && (i = 20);
    n += i;
    i = parseInt($(window).width(), 10);
    var r = t.width();
    n > i && (r = Math.max(0, r - (n - i)), t.width(r))
}}, ChartSaver.prototype.saveToJSON = function () {
    return this._fillSavingInfo(!1, !0)
}, ChartSaver.prototype._fillAsyncInfo = function (n, t, i) {
    var u = JSON.parse(n.content), f = this.Q5, r;
    return t || (i = !0), r = $.Deferred(), i ? f.asyncState(!!t).then(function (t) {
        n.content = JSON.stringify($.extend(!0, u, t));
        r.resolve(n)
    }) : Q3.asyncState(!!t).then(function (t) {
        n.content = JSON.stringify($.extend(!0, u, t));
        r.resolve(n)
    }), r.promise()
}, ChartSaver.prototype._fillSavingInfo = function (n, t) {
    n || (t = !0);
    var i = {publish_request_id: Math.random().toString(36).substring(2)}, o = this.Q5, s = o.activeChartWidget.value(), r = o.metaInfo, e = s.model().mainSeries(), f = e.properties(), u = e.symbolInfo();
    if (!(e && e.symbolInfo() && r && u))throw new ReferenceError("Missed required data");
    for (r.id.value() && (i.id = r.id.value()), i.name = r.name.value() || "", i.description = r.description.value() || "", i.resolution = e.properties().interval.value(), i.symbol_type = u.type || "", i.exchange = u.exchange || "", i.listed_exchange = u.listed_exchange || "", e.isSpread() ? (f = u.legs[0], r = u.base_name[0], r = r.split(":")[1], i.symbol = f, i.short_name = this.verifiedShortName(f, r, s), i.expression = u.full_name) : (r = u.ticker || f.symbol.value(), f = f.shortName.value(), i.symbol = r, i.short_name = this.verifiedShortName(r, f, s)), f = [], r = 0, e = u.legs.length; r < e; r++)f.push({symbol: u.legs[r], pro_symbol: u.base_name[r]});
    return i.legs = JSON.stringify(f), i.content = t ? JSON.stringify(o.state(!!n)) : JSON.stringify(s.state(!!n)), n && (i.image = JSON.stringify(o.images({onlyActiveChart: !t}))), i.is_realtime = n ? "0" : "1", i
}, ChartSaver.prototype.publishChart = function (n) {
    function i(n, i) {
        t.onPublish(n, $.extend({}, i, {closeForm: function () {
            t._dialogCtl.close()
        }, showError: function (n) {
            D83.showError(n, t._dialogCtl.dialog)
        }}))
    }

    var t = this;
    TradingView.trackEvent("GUI", "Publish Chart");
    $(".publish-chart-button").removeClass("inprogress");
    t._dialogCtl ? t._dialogCtl.show() : t._dialogCtl = D83.showPublishChartDialog($.extend({Q6: this.Q5, onPublish: i, onMinimize: function () {
        $(".publish-chart-button").addClass("inprogress")
    }, onDestroy: function () {
        delete t._dialogCtl;
        $(".publish-chart-button").removeClass("inprogress")
    }, related: t._lastPublishUrl}, n))
}, ChartSaver.prototype.onPublish = function (n, t) {
    function u(n) {
        i.publishInProgress = !1;
        n = n.responseText;
        "ok:" === n.substr(0, 3) ? (n = n.substr(3), n = JSON.parse(n), i.Q5.metaInfo.id.value() || i.Q5.metaInfo.id.setValue(n.id), t.closeForm && t.closeForm(), i._lastPublishUrl = n.publishUrl, i.hWnd && (i.hWnd.location = n.publishUrl)) : (t.showError && t.showError(n || "Error occured while publishing"), i.hWnd && (i.hWnd.close(), i.hWnd = null))
    }

    var i = this, r;
    i.publishInProgress || (r = i._fillSavingInfo(!0, t && t.publishAllLayout), i._fillAsyncInfo(r, !0, t && t.publishAllLayout).then(function (t) {
        $.ajax({url: "/publishchart/", type: "post", dataType: "text", data: $.extend({}, t, n), complete: u})
    }), i.publishInProgress = !0, !t.onWidget && "" !== n.name && "" !== n.description && 4e3 >= n.description.length && 64 >= n.name.length && ($.cookie("publish_request_id", r.publish_request_id, {path: "/"}), i.hWnd = window.open("/loading/", "_blank")))
}, ChartSaver.prototype.verifiedShortName = function (n, t, i) {
    var r, u, f;
    return t || (t = ""), i = i.model().mainSeries(), (r = !i.isSpread()) && (u = t, f = /^[1-9]\//, r = n.replace(f, ""), u = u.replace(f, ""), r = -1 == r.indexOf(u)), r && !J77.enabled("short_name_may_differ_from_fullname") && (t = n.substr(n.indexOf(":") + 1), i.properties().shortName.setValue(t), TradingView.trackEvent("Chart", "short_name differs from full_name"), console.error("short_name differs from full_name")), t
}, ChartSaver.prototype.saveChartSilently = function (n, t, i, r) {
    var u = this.Q5.metaInfo;
    t = this._fillSavingInfo(t);
    r = r || {};
    r.chartName && (t.name = r.chartName);
    $(window).on("beforeunload.savechart", function () {
        return $.t("Your chart is being saved, please wait a moment before you leave this page.")
    });
    saveChart(t, u, n, i)
}, D71 = function (n, t, i) {
    this._$tabs = n;
    this._$pages = t;
    this.options = $.extend({}, this._DEFAULT_OPTIONS, i || {});
    this.tabChanged = new Delegate;
    this.initActivePage();
    this.initHandlers()
}, D71.prototype._DEFAULT_OPTIONS = {saveTab: !1}, D71.prototype.initActivePage = function () {
    var n = 0;
    this.options.saveTab && (n = TVSettings.getInt(this.options.saveTab, 0));
    this.setActivePage(n)
}, D71.prototype.setActivePage = function (n) {
    this._$tabs.children().removeClass("active").eq(n).addClass("active");
    this._$pages.children().removeClass("active").eq(n).addClass("active");
    this.options.saveTab && TVSettings.setValue(this.options.saveTab, n);
    this.tabChanged.fire(n)
}, D71.prototype.initHandlers = function () {
    this._$tabs.on("click", "*", this._onTabClick.bind(this))
}, D71.prototype._onTabClick = function (n) {
    n = $(n.currentTarget).index();
    this.setActivePage(n)
}, D71.prototype.addPage = function (n, t) {
    var i = this.count();
    return this._$tabs.append(n), this._$pages.append(t), i || this.setActivePage(0), i
}, D71.prototype.removePage = function (n) {
    this._$tabs.children().eq(n).remove();
    this._$pages.children().eq(n).remove();
    n = this._$tabs.children().filter(".active").length ? this._$tabs.children().filter(".active").index() : 0 <= n - 1 ? n - 1 : 0;
    this.setActivePage(n)
}, D71.prototype.count = function () {
    return this._$tabs.children().length
}, D71.prototype.index = function () {
    return this._$tabs.children().filter(".active:eq(0)").index()
}, TradingView.postMessageWrapper = function () {
    var n = {}, t = {}, i = {}, r, u = 0, f = 0;
    return window.addEventListener && window.addEventListener("message", function (i) {
        var u;
        try {
            u = JSON.parse(i.data);
            J77.enabled("charting_library_debug_mode") && console.log("PostMessage: incoming message: " + JSON.stringify(u))
        } catch (f) {
            return
        }
        u.provider && "TradingView" == u.provider && ("get" == u.type && t[u.name] ? t[u.name].call(u, u.data, function (n) {
            r.postMessage(JSON.stringify({id: u.id, type: "on", name: u.name, client_id: u.client_id, data: n, provider: "TradingView"}), "*")
        }) : "on" == u.type ? n[u.client_id] && n[u.client_id][u.id] && (n[u.client_id][u.id].call(u, u.data), delete n[u.client_id][u.id]) : "post" == u.type && "function" == typeof t[u.name] && t[u.name].call(u, u.data, function () {
        }))
    }), function (e, o) {
        return n[o] = {}, r = i[o] = e, {on: function (n, i) {
            t[n] = i
        }, get: function (t, r, f) {
            t = {id: u++, type: "get", name: t, client_id: o, data: r, provider: "TradingView"};
            n[o][t.id] = f;
            i[o].postMessage(JSON.stringify(t), "*")
        }, post: function (n, t, i) {
            t = {id: f++, type: "post", name: t, data: i, provider: "TradingView"};
            n && "function" == typeof n.postMessage && n.postMessage(JSON.stringify(t), "*")
        }}
    }
}(), TradingView.QuoteTabbedWidget = function (n, t, i) {
    this._id = n;
    this.$container = t;
    this._tabs = i || t.data("quoteTabs");
    this.visible = new WatchedValue(!0);
    this.animationInProcess = new WatchedValue(!0);
    this._init()
}, TradingView.QuoteTabbedWidget.prototype._init = function () {
    var n = this, t, i, r, u;
    n.$container.empty();
    n.$container.addClass("quote-tabbed-widget");
    t = n.$tabs = $('<div class="tabs"><\/div>');
    i = n.$pages = $('<div class="pages"><\/div>');
    n._tabs.forEach(function (n) {
        t.append(Mustache.render('<div class="tab">{{title}}<\/div>', n));
        n = $(Mustache.render('<div class="page-wrapper"><div class="page"><table>{{#symbols}}<tr data-symbol={{symbol_full}}><td class="name"><a href="/chart/{{symbol_full}}/" data-symbol={{symbol_full}} class="chart-link{{^symbol}} symbol-short-name{{/symbol}}">{{#symbol}}{{symbol}}{{/symbol}}<\/a><\/td><td class="ticker"><span class="symbol-last"><\/span>&nbsp;<span class="symbol-change-pt"><\/span><\/td><td class="chart-cell"><a href="/e/?symbol={{symbol_full}}" class="chart"><\/a><\/td><\/tr>{{/symbols}}<\/table><\/div><\/div>', n));
        i.append(n)
    });
    r = new D71(t, i, {saveTab: this._activeTabKey()});
    n._onTabChanged(r.index());
    r.tabChanged.subscribe(n, n._onTabChanged);
    u = $('<div class="tabs-wrapper"><\/div>');
    t.appendTo(u);
    n.$container.append(u);
    n.$container.append(i);
    n.visible.subscribe(function (t) {
        n.$pages.children().each(function (i) {
            i = t ? r.index() === i : !1;
            n._setPageActive($(this), i, !0)
        })
    });
    n.animationInProcess.subscribe(function (t) {
        n.$pages.children().each(function (i) {
            (i = $(this).data("chart")) && (t ? i.unbindOnResize() : n.visible.value() && i.bindOnResize())
        })
    })
}, TradingView.QuoteTabbedWidget.prototype._onTabChanged = function (n) {
    var t = this;
    t.$pages.children().each(function (i) {
        t._setPageActive($(this), n === i)
    })
}, TradingView.QuoteTabbedWidget.prototype._setPageActive = function (n, t, i) {
    function r() {
        n.find("tr").each(function (t) {
            var i, r;
            t = $(this);
            i = t.data("symbol");
            i && (t.data("quoteTicker") ? t.data("quoteTicker").enabled = !0 : (r = new TradingView.QuoteTicker(i, t, {changePercentInBrackets: !0}), t.data("quoteTicker", r)), t.data("chart") ? t.data("chart").connect() : (i = new TradingView.MiniChart(i, t.find(".chart"), {minHeight: 18, showMessage: !1, onlyLastBars: 30, chartOptions: {grid: {xIsVisible: !1, yIsVisible: !1}, xScale: {visible: !1}, yScale: {visible: !1}, plot: {line: {color: "#2e5c75", width: 1}, belowLineFillStyle: "rgba(46,94,117, 0.2)"}}}), n.resize(i.widget.onResize), t.data("chart", i)))
        })
    }

    function u() {
        n.find("tr").each(function (n) {
            n = $(this);
            n.data("quoteTicker") && (n.data("quoteTicker").enabled = !1);
            n.data("chart") && n.data("chart").disconnect()
        })
    }

    t ? (clearTimeout(n.data("turnOffTimeout")), r()) : n.data("turnOffTimeout", setTimeout(function () {
        u()
    }, 1e3 * (i ? 0 : 60)))
}, TradingView.QuoteTabbedWidget.prototype._activeTabKey = function () {
    return"undefined" != typeof this._id ? "marketsummary.quotestabbedwidget." + this._id + ".activetabindex" : null
}, $(function () {
    var n = $("#market-summary-header"), t = $("#market-summary-body");
    n.length && t.length && (TradingView.marketSummary = new TradingView.MarketSummary(n, t))
}), TradingView.MarketSummary = function (n, t) {
    this.$button = $(".market-summary-toggle");
    this.$header = n;
    this.$body = t;
    this.animationInProcess = new WatchedValue(!1);
    this.bodyIsVisible = new WatchedValue(!1);
    this.toggled = new Delegate;
    this.initHeader();
    this.$button.click(this.toggle.bind(this));
    IS_OPENED_BY_DEAFAULT = !0;
    this.toggle(TVSettings.getBool("marketsummary.opened", IS_OPENED_BY_DEAFAULT));
    loginStateChange.subscribe(this, function () {
        is_authenticated && this.toggle(TVSettings.getBool("marketsummary.opened", IS_OPENED_BY_DEAFAULT))
    })
}, TradingView.MarketSummary.POPULAR_QUOTES_TABED_WIDGET = 0, TradingView.MarketSummary.ACTIVE_QUOTES_TABED_WIDGET = 1, TradingView.MarketSummary.prototype.initHeader = function () {
    this._initQouteTickers();
    this._bindChartSearchToLinks()
}, TradingView.MarketSummary.prototype.toggle = function (n) {
    function r() {
        t.animationInProcess.setValue(!1);
        t.toggled.fire(i)
    }

    var t = this, i;
    t.animationInProcess.value() || (t.animationInProcess.setValue(!0), t.$button.toggleClass("opened", n), i = t.$button.hasClass("opened"), i ? t.$body.slideDown(function () {
        r();
        t.chart() || t._initChart();
        t.activeQuotes() || t._initActiveQuotes();
        t.popularQuotes() || t._initPopularQuotes()
    }.bind(t)) : t.$body.slideUp(r), t.bodyIsVisible.setValue(i), TVSettings.setValue("marketsummary.opened", i))
}, TradingView.MarketSummary.prototype._initQouteTickers = function () {
    this.$header.find(".market-summary-quote-ticker").each(function () {
        var n = $(this);
        new TradingView.QuoteTicker(n.data("symbol"), n)
    })
}, TradingView.MarketSummary.prototype.chart = function () {
    return this._chart
}, TradingView.MarketSummary.prototype.activeQuotes = function () {
    return this._activeQuotes
}, TradingView.MarketSummary.prototype.popularQuotes = function () {
    return this._popularQuotes
}, TradingView.MarketSummary.prototype._initChart = function () {
    function f(n, t) {
        "boolean" != typeof t && (t = !n.hasClass("chart-legend-colored"));
        var i = n.data();
        n.find("a").css("border-left-color", t ? i.color : "transparent");
        n.toggleClass("chart-legend-colored", t)
    }

    for (var r, u, n = this, e = [], t = n.$header.find(".market-summary-quote-ticker.chart-legend"), i = 0; i < t.length; i++)r = t.eq(i), u = r.data(), e.push({symbol: u.symbol, options: {line: {color: u.color}}}), f(r, !0);
    n._chart = new TradingView.MiniChart(e, n.$body.find(".tickers-chart"), {chartOptions: {minHeight: 18, grid: {xIsVisible: !1, yIsVisible: !0, line: {width: 1, style: CanvasEx.LINESTYLE_DASHED, color: "#3a3b43"}}, yScale: {visible: !0, position: "right", isPercentage: !0, paddingLeft: 10, paddingRight: 4, marginInPercents: 10, font: {size: 10, family: "Helvetica", color: "#57585d"}, drawOverPlotArea: !1, borderColor: "trnasparent", drawTickMarkLine: !1, maxTickMarkAmount: 5}, xScale: {visible: !1}, plot: {line: {width: 2}, belowLineFillStyle: "transparent", aboveLineFillStyle: "transparent"}}, showMessage: !1});
    n.bodyIsVisible.subscribe(function (i) {
        i ? n._chart.connect() : n._chart.disconnect();
        t.each(function () {
            f($(this), i)
        })
    });
    n.animationInProcess.subscribe(function (t) {
        t ? n._chart.widget().unbindOnResize() : n.bodyIsVisible.value() && n._chart.widget().bindOnResize()
    })
}, TradingView.MarketSummary.prototype._initActiveQuotes = function () {
    this._activeQuotes = this._createQuotesWidget(TradingView.MarketSummary.ACTIVE_QUOTES_TABED_WIDGET, this.$body.find(".active-quotes"))
}, TradingView.MarketSummary.prototype._initPopularQuotes = function () {
    this._popularQuotes = this._createQuotesWidget(TradingView.MarketSummary.POPULAR_QUOTES_TABED_WIDGET, this.$body.find(".populars-quotes"))
}, TradingView.MarketSummary.prototype._createQuotesWidget = function (n, t) {
    var i = new TradingView.QuoteTabbedWidget(n, t);
    return this.bodyIsVisible.subscribe(function (n) {
        i.visible.setValue(n)
    }), this.animationInProcess.subscribe(function (n) {
        i.animationInProcess.setValue(n)
    }), this._bindChartSearchToLinks(), i
}, TradingView.MarketSummary.prototype._bindChartSearchToLinks = function () {
    this.$header.add(this.$body).find("a.chart-link:not(.inited)").addClass("inited").click(function (n) {
        if (TradingView.searchCharts && TradingView.searchCharts.queryField && TradingView.searchCharts.form) {
            var t = $(this).data("symbol");
            t && (TradingView.searchCharts.queryField.val(t), TradingView.searchCharts.form.submit(), n.preventDefault())
        }
    })
}, D45 = function () {
    function o(u, o) {
        function l() {
            function w(n) {
                (J77.enabled("same_data_requery") || y.value() !== n) && (o ? o.setSymbol(n) : u.setSymbol(n))
            }

            function b() {
                n.setValue(y.value())
            }

            function k() {
                h.setValue(c.actualSymbol())
            }

            function v() {
                s.setValue(p.shortName.value());
                var n = c.symbolInfo();
                n ? (k(), f.setValue(!!n.has_intraday), n.hasOwnProperty("supported_resolutions") ? e.setValue(n.supported_resolutions) : e.setValue(void 0)) : f.deleteValue()
            }

            function d(n) {
                (J77.enabled("same_data_requery") || a.value() !== n) && (o ? o.setResolution(n) : u.setResolution(n))
            }

            function g() {
                i.setValue(a.value())
            }

            var a;
            u.modelCreated().unsubscribe(null, l);
            var c = u.model().mainSeries(), p = c.properties(), y = p.symbol;
            y.subscribe(null, b);
            n.setValue(y.value());
            n.subscribe(w);
            c.onSymbolResolved().subscribe(null, k);
            n.hook = function (n) {
                return c.symbolSameAsCurrent(n) && (n = c.actualSymbol()), n
            };
            c.onSymbolResolved().subscribe(null, v);
            c.onSymbolError().subscribe(null, v);
            v();
            a = p.interval;
            a.subscribe(null, g);
            i.setValue(a.value());
            i.subscribe(d);
            u.readOnly() && (n.writeLock = !0);
            t = function () {
                y.unsubscribe(null, b);
                n.unsubscribe(w);
                c.onSymbolResolved().unsubscribe(null, v);
                c.onSymbolError().unsubscribe(null, v);
                a.unsubscribe(null, g);
                i.unsubscribe(d);
                delete n.hook;
                delete n.writeLock;
                t = new Function;
                r = new Function
            }
        }

        t();
        r = function () {
            return u
        };
        var c = u.model();
        c ? l(c) : (u.modelCreated().subscribe(null, l), t = function () {
            u.modelCreated().unsubscribe(null, l);
            t = new Function;
            r = new Function
        }, c = u.properties().mainSeriesProperties, n.setValue(c.symbol.value()), i.setValue(c.interval.value()))
    }

    var n = new WatchedValue, s = new WatchedValue, h = new WatchedValue, i = new WatchedValue, f = new WatchedValue, e = new WatchedValue, t = new Function, r = new Function, u = new Function;
    return{symbol: n, actualSymbol: h, seriesShortSymbol: s.readonly(), interval: i, intraday: f.readonly(), supportedResolutions: e.readonly(), bindToChartWidget: o, unbindFromChartWidget: function () {
        t()
    }, getChartWidget: function () {
        return r()
    }, bindToSearchCharts: function (t) {
        function r(t) {
            i = !0;
            n.setValue(t.resolved_symbol);
            i = !1
        }

        function f(n) {
            i || t.search(n)
        }

        u();
        var i = !1;
        t.onSearchBySymbol.subscribe(null, r);
        n.subscribe(f);
        u = function () {
            t.onSearchBySymbol.unsubscribe(null, r);
            n.unsubscribe(f);
            u = new Function
        }
    }, unbindFromSearchCharts: function () {
        u()
    }, bindToChartWidgetCollection: function (n) {
        t();
        n.activeChartWidget.subscribe(function (i) {
            t();
            o(i, n)
        }, {callWithLast: !0})
    }}
}(), D15 = {force_prefix: "forcefeaturetoggle.", enableFeature: function (n) {
    localStorage[this.force_prefix + n] = "true"
}, disableFeature: function (n) {
    localStorage.removeItem(this.force_prefix + n)
}}, TradingView.Q18 = function (n) {
    function t(t) {
        return localStorage["featuretoggle." + t] = Math.random() <= n[t]
    }

    if (TradingView.pushStreamMultiplexer)TradingView.pushStreamMultiplexer.on("featuretoggle", function (i) {
        n[i.name] = i.state;
        t(i.name)
    });
    return function (i) {
        if ("true" === localStorage[D15.force_prefix + i] || window.is_authenticated && "undefined" != typeof user && user && user.settings[D15.force_prefix + i])return!0;
        if (!n[i])return!1;
        if (1 === n[i])return!0;
        var r = localStorage["featuretoggle." + i];
        return void 0 === r || null === r ? t(i) : "true" === r
    }
}(window.featureToggleState || {}), function (n) {
    if (document.createElement("canvas") && document.createElement("canvas").getContext) {
        var t = function (t) {
            return(n.devicePixelRatio || 1) / (t.backingStorePixelRatio || t.webkitBackingStorePixelRatio || t.mozBackingStorePixelRatio || t.msBackingStorePixelRatio || t.oBackingStorePixelRatio || t.backingStorePixelRatio || 1)
        }(document.createElement("canvas").getContext("2d"));
        !/hidpi/.test(location.hash) && (2 != t || !/Macintosh/.test(navigator.userAgent) || 2880 < n.innerWidth * t) || (n.hidpiCanvasRatio = t, function (n) {
            (function (n, t) {
                for (var i in n)n.hasOwnProperty(i) && t(n[i], i)
            })({fillRect: "all", clearRect: "all", strokeRect: "all", moveTo: "all", lineTo: "all", arc: [0, 1, 2], arcTo: "all", bezierCurveTo: "all", isPointinPath: "all", isPointinStroke: "all", quadraticCurveTo: "all", rect: "all", translate: "all", createRadialGradient: "all", createLinearGradient: "all", drawImage: [1, 2, 3, 4]}, function (i, r) {
                var u = n[r];
                n[r] = function () {
                    var n, r;
                    if ("all" === i)for (r = [], n = arguments.length; 0 < n--;)r[n] = arguments[n] * t; else for (r = Array.prototype.slice.call(arguments), n = i.length; 0 < n--;)r[i[n]] && (r[i[n]] *= t);
                    return u.apply(this, r)
                }
            });
            n.fillText = function (n) {
                return function () {
                    var i = Array.prototype.slice.call(arguments);
                    i[1] *= t;
                    i[2] *= t;
                    this.font = this.font.replace(/(\d+)(px|em|rem|pt)/g, function (n, i, r) {
                        return i * t + r
                    });
                    n.apply(this, i);
                    this.font = this.font.replace(/(\d+)(px|em|rem|pt)/g, function (n, i, r) {
                        return i / t + r
                    })
                }
            }(n.fillText);
            n.strokeText = function (n) {
                return function () {
                    var i = Array.prototype.slice.call(arguments);
                    i[1] *= t;
                    i[2] *= t;
                    this.font = this.font.replace(/(\d+)(px|em|rem|pt)/g, function (n, i, r) {
                        return i * t + r
                    });
                    n.apply(this, i);
                    this.font = this.font.replace(/(\d+)(px|em|rem|pt)/g, function (n, i, r) {
                        return i / t + r
                    })
                }
            }(n.strokeText)
        }(CanvasRenderingContext2D.prototype), function (n) {
            n.getContext = function (n) {
                return function (i) {
                    var r = n.call(this, i);
                    return"2d" === i && (this.style.height = this.height + "px", this.style.width = this.width + "px", this.width *= t, this.height *= t), r
                }
            }(n.getContext)
        }(HTMLCanvasElement.prototype))
    }
}(window), StudyInputsHelper = function () {
    function n(n, t) {
        var r = t.slice(0).toLowerCase(), i;
        if (n) {
            for (i = 0; i < n.size(); ++i)if (n.item(i).description.toLowerCase() === r || n.item(i).shortDescription.toLowerCase() === r)return n.item(i);
            throw Error("Can't find metainfo for `" + t + "`");
        }
        throw Error("There is no studies metainfo at all");
    }

    function i(n) {
        return n.inputs.map(function (n) {
            return{id: n.id, type: n.type, name: n.name}
        })
    }

    function u(t, r, u) {
        var s, o, e, h, f;
        u = n(u.model().studiesMetaData(), t);
        s = i(u);
        o = {};
        for (e in r)h = e.toLowerCase(), f = s.filter(function (n) {
            return n.name.toLowerCase() === h
        }), 0 === f.length ? console.warn("Uknown input `" + e + "` of `" + t + "`") : (f = f[0], o[f.id] = r[e]);
        return{id: u.id, name: t, inputs: o}
    }

    var t = {}, r = {bool: function (n) {
        return!!n
    }, integer: function (n) {
        return parseInt(n)
    }, float: function (n) {
        return parseFloat(n)
    }, string: function (n) {
        return n
    }};
    return t.getStudyRecordFromArray = function (t, u) {
        var e, f, o;
        if (u = u || Q3, f = u, isArray(t)) {
            o = t.slice(0);
            e = o[0];
            for (var f = n(f.model().studiesMetaData(), e), l = f.is_price_study, c = i(f), h, o = o.splice(1), s = 0; s < o.length; ++s)h || (h = {}), h[c[s].id] = (r[c[s].type] || r.string)(o[s]);
            e = {id: f.id, name: e, overlay: l, inputs: h}
        } else f = n(f.model().studiesMetaData(), t), e = {id: f.id, overlay: f.is_price_study};
        return e
    }, t.getStudyRecordFromObject = function (n, t, i) {
        return i = i || Q3, u(n, t, i)
    }, t
}(), D82.ChartapiMessager = function (n, t) {
    this._server = n;
    this._session = t;
    this._timezone = null
}, D82.ChartapiMessager.prototype.setTimezone = function (n) {
    this._timezone = "exchange" == n ? "exchange" : PineJsCalendar.get_timezone(n)
}, D82.ChartapiMessager.prototype.onRequestMetadata = function (n, t) {
    this._server.receiveLocalResponse({method: "studies_metadata", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onSymbolResolved = function (n, t) {
    this._server.receiveLocalResponse({method: "symbol_resolved", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onSymbolError = function (n, t) {
    this._server.receiveLocalResponse({method: "symbol_error", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onStudyError = function (n, t) {
    this._server.receiveLocalResponse({method: "study_error", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onSeriesLoading = function (n, t) {
    this._server.receiveLocalResponse({method: "series_loading", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onSeriesCompleted = function (n, t, i) {
    this._server.receiveLocalResponse({method: "series_completed", params: [this._session, n, i, t]})
}, D82.ChartapiMessager.prototype.onSeriesError = function (n, t) {
    this._server.receiveLocalResponse({method: "series_error", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onSeriesClearData = function (n, t) {
    var i = {};
    i[n] = {series: [], turnaround: t};
    this._server.receiveLocalResponse({method: "timescale_update", params: [this._session, i, {index: 0, zoffset: 0, changes: [], marks: []}]})
}, D82.ChartapiMessager.prototype.onStudyCompleted = function (n, t) {
    this._server.receiveLocalResponse({method: "study_completed", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onStudyLoading = function (n, t) {
    this._server.receiveLocalResponse({method: "study_loading", params: [this._session, n, t]})
}, D82.ChartapiMessager.prototype.onTickmarksUpdated = function (n, t, i) {
    var r, f, e, u;
    for (t = t.slice(0), r = PineJsCalendar.get_timezone(i.timezone), i = 0; i < t.length; ++i)t[i] = this.timeInTimezone(t[i], r);
    for (r = [], f = [], i = 0; i < t.length; ++i)u = t[i], r.push([this._spanByTime(u, e), u, n + i]), f.push(u), e = u;
    this._server.receiveLocalResponse({method: "tickmark_update", params: [this._session, {index: n, zoffset: 0, changes: f, marks: r}]})
}, D82.ChartapiMessager.prototype.onTimescaleUpdate = function (n, t, i, r, u) {
    var f, o, e;
    for (i = i.slice(0), f = PineJsCalendar.get_timezone(r.timezone), r = 0; r < i.length; ++r)i[r].value[0] = this.timeInTimezone(i[r].value[0], f);
    for (f = {}, f[n] = {series: i, turnaround: t}, n = [], t = [], r = 0; r < i.length; ++r)e = i[r].value[0], n.push([this._spanByTime(e, o), e, u + r]), t.push(e), o = e;
    this._server.receiveLocalResponse({method: "timescale_update", params: [this._session, f, {index: u, zoffset: 0, changes: t, marks: n}]})
}, D82.ChartapiMessager.prototype.onSeriesTimeframeUpdate = function (n, t, i, r, u) {
    this._server.receiveLocalResponse({method: "series_timeframe", params: [this._session, n, t, i, r, u]})
}, D82.ChartapiMessager.prototype.onPointsetDataUpdate = function (n, t, i, r) {
    this._onDataUpdate(n, t, i, void 0, r, 1)
}, D82.ChartapiMessager.prototype.onDataUpdate = function (n, t, i, r, u) {
    this._onDataUpdate(n, t, i, r, u, 0)
}, D82.ChartapiMessager.prototype._onDataUpdate = function (n, t, i, r, u, f) {
    i = i.slice(0);
    u = PineJsCalendar.get_timezone(u.timezone);
    for (var e = 0; e < i.length; ++e)i[e].value[f] = this.timeInTimezone(i[e].value[f], u);
    f = {};
    r = r ? JSON.stringify({offsets: r}) : "";
    f[n] = {s: i, ns: {d: r, indexes: []}, turnaround: t};
    this._server.receiveLocalResponse({method: "data_update", params: [this._session, f]})
}, D82.ChartapiMessager.prototype.onQuotesData = function (n) {
    this._server.receiveLocalResponse({method: "quote_symbol_data", params: n})
}, D82.ChartapiMessager.prototype.timeInTimezone = function (n, t) {
    return"exchange" == this._timezone ? parseInt(PineJsCalendar.utc_to_cal(t, 1e3 * n).valueOf() / 1e3) : parseInt(PineJsCalendar.utc_to_cal(this._timezone, 1e3 * n).valueOf() / 1e3)
}, D82.ChartapiMessager.prototype.timeInGMT = function (n, t) {
    return"exchange" == this._timezone ? parseInt(PineJsCalendar.cal_to_utc(t, new Date(1e3 * n)) / 1e3) : parseInt(PineJsCalendar.cal_to_utc(this._timezone, new Date(1e3 * n)) / 1e3)
}, D82.ChartapiMessager.prototype._spanByTime = function (n, t) {
    var f = [
        {divisor: 1, span: 20},
        {divisor: 3e5, span: 21},
        {divisor: 18e5, span: 22},
        {divisor: 36e5, span: 30},
        {divisor: 108e5, span: 31},
        {divisor: 216e5, span: 32},
        {divisor: 432e5, span: 33}
    ], r, u, i;
    if (t) {
        if (r = new Date(1e3 * t), u = new Date(1e3 * n), u.getYear() != r.getYear())return 70;
        if (u.getUTCMonth() != r.getUTCMonth())return 60;
        if (u.getUTCDate() != r.getUTCDate())return 50;
        for (i = f.length - 1; 0 <= i; --i)if (Math.floor(r / f[i].divisor) != Math.floor(u / f[i].divisor))return f[i].span
    } else return 20
}, ChartapiMessagerInstances = [], !J77.enabled("charting_library"))throw"ChartsStorage is intended to be used in Charting Library only";
ChartsStorage = function () {
    var n = {}, t, i, r;
    return n.initialize = function (n, u, f) {
        t = n;
        i = u;
        r = f
    }, n.getCharts = function (n) {
        return $.ajax({url: "{0}/{1}/charts?client={2}&user={3}".format(r, "1.0", t, i), type: "GET", crossDomain: !0}).done(function (t) {
            t = JSON.parse(t);
            "ok" != t.status && console.warn("Charts list request failed: " + t.message);
            t = t.data.map(function (n) {
                return{id: n.id, name: n.name, image_url: n.id, modified_iso: n.timestamp, short_symbol: n.symbol, interval: n.resolution}
            });
            n(t)
        })
    }, n.removeChart = function (n, u) {
        $.ajax({url: "{0}/{1}/charts?client={2}&user={3}&chart={4}".format(r, "1.0", t, i, n), type: "DELETE", crossDomain: !0}).done(function (n) {
            n = JSON.parse(n);
            "ok" != n.status && console.warn("Chart delete request failed: " + n.message);
            u()
        })
    }, n.saveChart = function (n, u, f, e, o, s, h) {
        var c = "{0}/{1}/charts?client={2}&user={3}".format(r, "1.0", t, i);
        "undefined" != typeof o && (c += "&chart=" + o);
        $.ajax({url: c, data: {name: n, content: JSON.stringify(e), symbol: u, resolution: f}, type: "POST", crossDomain: !0}).done(function (n) {
            n = JSON.parse(n);
            "ok" != n.status ? (console.warn("Chart save request failed: " + n.message), h()) : s(n.id)
        }).fail(function () {
            h()
        })
    }, n.loadChart = function (n) {
        $.ajax({url: "{0}/{1}/charts?client={2}&user={3}&chart={4}".format(r, "1.0", t, i, n.id), type: "GET", crossDomain: !0}).done(function (t) {
            t = JSON.parse(t);
            "ok" != t.status ? console.warn("Chart load request failed: " + t.message) : (t = JSON.parse(t.data.content), t.uid = n.id, Q17.emit("chart_load_requested", t))
        }).fail(function () {
            console.warn("Error loading chart")
        })
    }, n
}();
D82.ChartApi = function (n) {
    this._notificationHandlers = [];
    this._sessions = [];
    this.studyCounter = 0;
    this._enabled = this._connected = !1;
    this._studyEngine = new D79(n);
    this._callbacks = {};
    this._symbolIdCache = {};
    this._seriesIdCache = {};
    this._recentSeriesId = null;
    this._enableLogging = !1;
    this._enabledMoreBarsRequest = !0;
    var t = this;
    this._studyEngine.on("configuration_received", function () {
        t._fireEvent("configuration_received")
    });
    this._studyEngine.on("realtime_tick", function (n) {
        t._fireEvent("realtime_tick", {time: n.value[0] / 1e3, open: n.value[1], high: n.value[2], low: n.value[3], close: n.value[4], volume: n.value[5]})
    });
    this._autosavePause = void 0;
    this._setupAutoSave();
    TradingView.availableTimezones = [
        {id: "UTC", title: $.t("UTC")},
        {id: "exchange", title: $.t("Exchange")}
    ].concat([
        {id: "Europe/Athens", title: "Athens"},
        {id: "Europe/Berlin", title: "Berlin"},
        {id: "America/Bogota", title: "Bogota"},
        {id: "Asia/Bangkok", title: "Bangkok"},
        {id: "America/Argentina/Buenos_Aires", title: "Buenos Aires"},
        {id: "America/Chicago", title: "Chicago"},
        {id: "Asia/Hong_Kong", title: "Hong Kong"},
        {id: "Asia/Kolkata", title: "Kolkata"},
        {id: "Europe/London", title: "London"},
        {id: "America/Los_Angeles", title: "Los Angeles"},
        {id: "Europe/Madrid", title: "Madrid"},
        {id: "Europe/Moscow", title: "Moscow"},
        {id: "America/New_York", title: "New York"},
        {id: "Europe/Paris", title: "Paris"},
        {id: "America/Sao_Paulo", title: "Sao Paulo"},
        {id: "Asia/Seoul", title: "Seoul"},
        {id: "Asia/Shanghai", title: "Shanghai"},
        {id: "Asia/Singapore", title: "Singapore"},
        {id: "Australia/Sydney", title: "Sydney"},
        {id: "Asia/Taipei", title: "Taipei"},
        {id: "Asia/Tehran", title: "Tehran"},
        {id: "Asia/Tokyo", title: "Tokyo"},
        {id: "America/Toronto", title: "Toronto"},
        {id: "America/Vancouver", title: "Vancouver"},
        {id: "Europe/Warsaw", title: "Warsaw"}
    ].map(function (n) {
        return n.title = $.t(n.title), n
    }).sort(function (n, t) {
        return n.title.localeCompare(t.title)
    }))
};
D82.ChartApi.prototype.purgeCache = function () {
    this._symbolIdCache = {};
    delete this._recentSeriesId;
    this._studyEngine.purgeCache();
    this._studyEngine.purgeRangeExtensionData()
};
D82.ChartApi.prototype.setAdditionalBarsRequestEnabled = function (n) {
    this._enabledMoreBarsRequest = n
};
D82.ChartApi.prototype.setTimeFramesList = function (n) {
    var f, i;
    for (this._timeframes = [], f = /(\d+)(\w+)/, i = 0; i < n.length; ++i) {
        var r = n[i], t = f.exec(r.text), u = t[2].toLowerCase(), t = parseInt(t[1]), e = "y" == u ? 12 * t + "m" : t + u, o = PineJS.Symbol.parsePeriod(r.resolution);
        this._timeframes.push({text: t + $.t(u, {context: "dates", count: t}), value: e, targetResolution: r.resolution, requiresIntraday: o.isIntraday})
    }
};
D82.ChartApi.prototype._setupAutoSave = function () {
    var n = this, t = !1;
    D77.undoStack().onChange().subscribe(this, function () {
        n._autosavePause ? t = !0 : (n._fireEvent("onAutoSaveNeeded", void 0, !0), n._autosavePause = setTimeout(function () {
            t && n._fireEvent("onAutoSaveNeeded", void 0, !0);
            n._autosavePause = void 0;
            t = !1
        }, 5e3))
    })
};
D82.ChartApi.prototype.defaultWatchlistSymbols = function () {
    return this._watchlistSettings.default_symbols
};
D82.ChartApi.prototype.availableTimeFrames = function (n) {
    return n ? this._timeframes.filter(function (t) {
        return t.requiresIntraday && !n.has_intraday || n.supported_resolutions && 0 > n.supported_resolutions.indexOf(t.targetResolution) ? !1 : !0
    }) : []
};
D82.ChartApi.prototype.defaultResolutions = function () {
    return this._studyEngine.supportedResolutions() || {1: 1, 3: 1, 5: 1, 15: 1, 30: 1, 45: 1, 60: 1, 120: 1, 180: 1, 240: 1, D: 1, W: 1, M: 1}
};
D82.ChartApi.prototype.supportedSymbolsTypes = function () {
    return this._studyEngine.supportedSymbolsTypes()
};
D82.ChartApi.prototype.supportedExchangesList = function () {
    return this._studyEngine.supportedExchangesList()
};
D82.ChartApi.prototype.start = function () {
    this._enabled = !0;
    this._fireEvent("start_enabled")
};
D82.ChartApi.prototype._logMessage = function (n) {
    this._enableLogging && console.log(n)
};
D82.ChartApi.prototype.unsubscribe = function (n, t) {
    var i = this._callbacks[n];
    i && i.splice(i.indexOf(t), 1)
};
D82.ChartApi.prototype.on = function (n, t) {
    return this._callbacks.hasOwnProperty(n) || (this._callbacks[n] = []), this._callbacks[n].push(t), this
};
D82.ChartApi.prototype._fireEvent = function (n, t, i) {
    if (this._callbacks.hasOwnProperty(n)) {
        var r = this._callbacks[n].slice(0);
        for (i || (this._callbacks[n] = []), n = 0; n < r.length; ++n)r[n](t)
    }
};
D82.ChartApi.prototype.setAuthToken = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype.authTokenRequired = function () {
    return!1
};
D82.ChartApi.prototype.chartCreateSession = function () {
};
D82.ChartApi.prototype.chartDeleteSession = function () {
};
D82.ChartApi.prototype.createSession = function (n, t) {
    if (ChartapiMessagerInstances[n] = new D82.ChartapiMessager(this, n), this._sessions[n] = t, this._notificationHandlers[n] = t, this.connected())t.onMessage({method: "connected", params: []})
};
D82.ChartApi.prototype.removeSession = function (n) {
    delete this._sessions[n];
    delete this._notificationHandlers[n];
    this.chartDeleteSession(n)
};
D82.ChartApi.prototype.connected = function () {
    return this._connected
};
D82.ChartApi.prototype._getHost = function (n) {
    return n
};
D82.ChartApi.prototype._isSafari5 = function () {
    return!!navigator.appVersion.match(/\/5\.[^\/]*?Safari\//)
};
D82.ChartApi.prototype._isIE9 = function () {
    return!!navigator.appVersion.match(/MSIE 9/)
};
D82.ChartApi.prototype._isIOS5 = function () {
    return!!navigator.appVersion.match(/iPad, CPU 5/)
};
D82.ChartApi.prototype._getPort = function (n) {
    return this._isSafari5() || this._isIE9() ? 8081 : n
};
D82.ChartApi.prototype.connect = function () {
    if (this._enabled)this.connected() || (this._connected = !0, this.sessionid = "dummy session id", this._notifySessions({method: "connected", params: []})); else {
        var n = this;
        this.on("start_enabled", function () {
            n.connect()
        })
    }
};
D82.ChartApi.prototype.disconnect = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype.switchTimezone = function (n, t) {
    if (ChartapiMessagerInstances[n].setTimezone(t), this._recentSeriesId) {
        this._studyEngine.purgeEndOfDataFlags(this._recentSeriesId);
        var i = this;
        this._doWhenSeriesSymbolIdIsReady(this._recentSeriesId, function (t) {
            i._studyEngine.recreateSources(t.name, i._seriesIdCache[i._recentSeriesId].resolution, n);
            i._doWhenSeriesDataReceived(function () {
                var r = i._seriesIdCache[i._recentSeriesId].resolution, u = Q3.model().mainSeries().data().last();
                i._studyEngine.rebuildExtrapolatedData(n, t.name, r, t.info, 1e3 * u.value[0])
            })
        })
    }
};
D82.ChartApi.prototype.receiveLocalResponse = function (n) {
    this._logMessage("< " + n.method);
    this._dispathNotification(n);
    this._fireEvent("message_" + n.method, void 0, !0)
};
D82.ChartApi.prototype.getMarks = function (n, t, i, r, u) {
    this._studyEngine.getMarks(n, t, i, r, u)
};
D82.ChartApi.prototype.resolveSymbol = function (n, t, i, r) {
    function f(t, r) {
        ChartapiMessagerInstances[n].onSymbolError(t, r);
        u._symbolIdCache[t] = {name: i, status: "invalid_symbol"};
        u._fireEvent(t + "_resolve_fail");
        u._fireEvent("resolve_fail", t)
    }

    this._notificationHandlers[n][t] = new HandlerInfo(r, t);
    this._symbolIdCache[t] = null;
    var u = this;
    this._studyEngine.resolveSymbol(i, function (r) {
        r.errmsg ? f(t, r.errmsg) : (u._symbolIdCache[t] = {name: i, info: r, status: "ok"}, u._fireEvent(t + "_resolved", r), u._fireEvent("symbol_resolved", {symbolInfo: r, symbolId: t}), ChartapiMessagerInstances[n].onSymbolResolved(t, r))
    }, function (n) {
        f(t, n)
    })
};
D82.ChartApi.prototype._doWhenSymbolIdIsReady = function (n, t) {
    function i() {
        u && (t({name: r._symbolIdCache[n].name, info: r._symbolIdCache[n].info}), u = !1, r.unsubscribe(n + "_resolved", i), r.unsubscribe(n + "_resolve_fail", i))
    }

    var r = this, u = !0;
    this._symbolIdCache[n] ? i() : (this.on(n + "_resolved", i), this.on(n + "_resolve_fail", i))
};
D82.ChartApi.prototype._doWhenSeriesDataReceived = function (n) {
    function t() {
        Q3.model().mainSeries().onCompleted().unsubscribe(null, t);
        n()
    }

    Q3.model().mainSeries().onCompleted().subscribe(null, t)
};
D82.ChartApi.prototype._doWhenSeriesSymbolIdIsReady = function (n, t, i) {
    function u() {
        var t = r._symbolIdCache[r._seriesIdCache[n].symbolId];
        return{name: t.name, info: t.info}
    }

    function f() {
        r.unsubscribe("symbol_resolved", o);
        r.unsubscribe("resolve_fail", e)
    }

    function e(t) {
        t == r._seriesIdCache[n].symbolId && i && (f(), i())
    }

    function o(i) {
        i.symbolId == r._seriesIdCache[n].symbolId && (f(), t(u()))
    }

    var r = this;
    this._symbolIdCache[this._seriesIdCache[n].symbolId] ? t(u()) : (this.on("symbol_resolved", o), this.on("resolve_fail", e))
};
D82.ChartApi.prototype.createSeries = function (n, t, i, r, u, f, e) {
    i = i || "";
    this._notificationHandlers[n][t] = new HandlerInfo(e, t);
    this._recentSeriesId = t;
    var o = this;
    this._seriesIdCache[t] = {symbolId: r, resolution: u, turnaround: i};
    this._studyEngine.updateSeriesTurnaround(t, i);
    this._doWhenSeriesSymbolIdIsReady(t, function (r) {
        o._studyEngine.createSeries(r.name, u, n, t, i)
    })
};
D82.ChartApi.prototype.removeSeries = function (n, t, i) {
    this._notificationHandlers[n][t] = new HandlerInfo(i, t);
    this._studyEngine.removeSeries(t)
};
D82.ChartApi.prototype.setVisibleTimeRange = function (n, t, i, r) {
    function o() {
        f = Q3.model().mainSeries().data();
        var u = [f.timeToBarIndex(t, SEARCH_FROM_LEFT), f.timeToBarIndex(i, SEARCH_FROM_RIGHT)];
        ChartapiMessagerInstances[n].onSeriesTimeframeUpdate(e, s._seriesIdCache[e].turnaround, u[0], u[1], !0);
        r && r()
    }

    var f = Q3.model().mainSeries().data(), u = !!f.timeToBarIndex(t, SEARCH_FROM_LEFT), e = this._recentSeriesId, s = this;
    if (u)o(); else {
        var u = this._symbolIdCache[this._seriesIdCache[e].symbolId].info, u = PineJS.Symbol.newSession(u.timezone, u.session), u = PineJS.Symbol.newBarBuilder(this._seriesIdCache[e].resolution, u), f = Q3.model().mainSeries().bars(), h = f._valueAt(0)[0], u = PineJsBarBuilder.extrapolateBarsBackToTime(u, 1e3 * h, 1e3 * t);
        this._studyEngine.extendSeriesRange(e, n, u.length);
        this._doWhenSeriesDataReceived(o)
    }
};
D82.ChartApi.prototype._exactBarsCountOfTimeFrame = function (n, t) {
    for (var i = Q3.model().mainSeries().bars(), u = i._valueAt(i.size() - 1)[0], u = PineJsBarBuilder.alignDWMPeriodsBack(t.timezone, t.session, n.resolution, n.interval, 1e3 * u), f = i.size(), u = u / 1e3, r = 0, r = 0; r < f && !(i._valueAt(r)[0] > u); ++r);
    return f - r
};
D82.ChartApi.prototype.modifySeries = function (n, t, i, r, u, f, e) {
    i = i || "";
    var s = this._seriesIdCache[t] ? this._seriesIdCache[t].resolution : void 0, o = this;
    this._notificationHandlers[n][t] = new HandlerInfo(function (e) {
        if ("series_completed" == e.method) {
            var c = PineJS.Symbol.parsePeriod(s), h = PineJS.Symbol.parsePeriod(u);
            h.range && c.range != h.range && (c = Q3.model().mainSeries().bars().size(), h = o._exactBarsCountOfTimeFrame(h.range, o._symbolIdCache[r].info), h = Math.max(0, c - 1 - h), c = Math.max(h, c - 1), ChartapiMessagerInstances[n].onSeriesTimeframeUpdate(t, i, h, c))
        }
        f(e)
    }, t);
    this._recentSeriesId = t;
    this._studyEngine.updateSeriesTurnaround(t, i);
    this._seriesIdCache[e] = null;
    this._seriesIdCache[t] = {symbolId: r, resolution: u, turnaround: i};
    this._doWhenSeriesSymbolIdIsReady(t, function (i) {
        o._studyEngine.purgeEndOfDataFlags(t);
        o._studyEngine.purgeRangeExtensionData();
        o._studyEngine.recreateSources(i.name, u, n, !0)
    })
};
D82.ChartApi.prototype.requestMoreData = function (n, t, i, r) {
    this._enabledMoreBarsRequest && (this._notificationHandlers[n][t] = new HandlerInfo(r, t), this._studyEngine.extendSeriesRange(t, n, i))
};
D82.ChartApi.prototype.setStudiesAccessController = function (n) {
    this.studiesAccessController = n
};
D82.ChartApi.prototype.setWatchlistSettings = function (n) {
    this._watchlistSettings = n
};
D82.ChartApi.prototype.allStudiesMetadata = function () {
    return this._studyEngine.studiesMetadata()
};
D82.ChartApi.prototype.requestMetadata = function (n, t, i) {
    this._notificationHandlers[n][t] = new HandlerInfo(i, t);
    i = this.studiesAccessController.getEnabledTools();
    ChartapiMessagerInstances[n].onRequestMetadata(t, i)
};
D82.ChartApi.prototype.isCanCreateStudy = function () {
    return this.studyCounter < STUDY_COUNT_LIMIT
};
D82.ChartApi.prototype.createStudy = function (n, t, i, r, u, f, e) {
    var o, s;
    if (!this.isCanCreateStudy())throw"Exceeded the limit of studies";
    o = this;
    i = i || "";
    this._notificationHandlers[n][t] = new HandlerInfo(e, t);
    s = this._seriesIdCache[r].resolution;
    this._doWhenSymbolIdIsReady(this._seriesIdCache[r].symbolId, function (r) {
        o._studyEngine.createStudy(r.name, s, n, t, i, u, f);
        o.studyCounter++
    })
};
D82.ChartApi.prototype.removeStudy = function (n, t) {
    this._notificationHandlers[n][t] = null;
    this._studyEngine.removeStudy(t);
    this.studyCounter--
};
D82.ChartApi.prototype.modifyStudy = function (n, t, i, r, u) {
    i = i || "";
    this._notificationHandlers[n][t] = new HandlerInfo(u, t);
    [n, t, i].concat(r);
    this._studyEngine.recomputeStudy(t, r, n, i)
};
D82.ChartApi.prototype.createPointset = function (n, t, i, r, u, f, e) {
    this._notificationHandlers[n][t] = new HandlerInfo(e, t);
    var o = this;
    this._doWhenSymbolIdIsReady(r, function (i) {
        o._studyEngine.createPointset(n, t, i.info.full_name, i.info, u, f)
    })
};
D82.ChartApi.prototype.modifyPointset = function () {
    throw"This call is not implemented";
};
D82.ChartApi.prototype.removePointset = function (n, t) {
    this._notificationHandlers[n][t] = null;
    this._studyEngine.removePointset(t)
};
D82.ChartApi.prototype.requestMoreTickmarks = function (n, t, i, r) {
    this._notificationHandlers[n][t] = new HandlerInfo(r, t);
    var u = this;
    this._doWhenSeriesSymbolIdIsReady(t, function (r) {
        u._studyEngine.onMoreTickmarksRequested(n, r.name, r.info, u._seriesIdCache[t].resolution, i)
    })
};
D82.ChartApi.prototype.requestFirstBarTime = function (n, t, i, r) {
    this._notificationHandlers[n][t] = new HandlerInfo(r, t)
};
D82.ChartApi.prototype._invokeHandler = function (n, t) {
    n && n(t)
};
D82.ChartApi.prototype._sendRequest = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype._onMessage = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype._convertTimescaleResponse = function (n) {
    for (var i = n.marks, t = 0; t < i.length; ++t)i[t] = {span: i[t][0], time: i[t][1], index: i[t][2]};
    return n
};
D82.ChartApi.prototype._dispathNotification = function (n) {
    var u = n.params.shift(), r, i, f, t, e;
    if (this._notificationHandlers[u])switch (n.method) {
        case"timescale_update":
            r = n.params[0];
            n = n.params[1];
            t = this._convertTimescaleResponse(n);
            t.clear = 0 === n.changes.length && 0 === n.marks.length;
            this._notificationHandlers[u].onMessage({method: "timescale_update", params: t});
            for (i in r)t = {}, t.customId = i, t.plots = r[i].series, r[i].ns && (t.nonseries = r[i].ns), t.turnaround = r[i].turnaround, t = {method: "data_update", params: t}, this._invokeNotificationHandler(u, i, t);
            break;
        case"tickmark_update":
            t = this._convertTimescaleResponse(n.params[0]);
            t.changes = [];
            this._notificationHandlers[u].onMessage({method: "timescale_update", params: t});
            break;
        case"data_update":
            for (i in n.params[0]) {
                f = n.params[0][i];
                t = {};
                t.customId = i;
                t.plots = f.series ? f.series : f.plots;
                t.turnaround = f.turnaround;
                "s"in f && "ns"in f && (t.plots = f.s, t.nonseries = f.ns);
                for (r in t.plots)for (e in t.plots[r].value)1e100 === t.plots[r].value[e] && (t.plots[r].value[e] = void 0);
                t = {method: "data_update", params: t};
                this._invokeNotificationHandler(u, i, t)
            }
            break;
        case"index_update":
            for (i in n.params[0])t = {method: "index_update", params: n.params[0][i]}, this._invokeNotificationHandler(u, i, t);
            break;
        case"critical_error":
            TradingView.logNormal(new Date + " critical_error session:" + this.sessionid + " reason:" + n.params[0]);
            this._notificationHandlers[u].onMessage({method: "critical_error", params: n.params});
            break;
        case"quote_symbol_data":
        case"quote_list_fields":
        case"depth_symbol_error":
        case"depth_symbol_success":
        case"dd":
        case"dpu":
        case"depth_bar_last_value":
            this._notificationHandlers[u].onMessage({method: n.method, params: n.params});
            break;
        default:
            this._invokeNotificationHandler(u, n.params[0], n)
    }
};
D82.ChartApi.prototype._invokeNotificationHandler = function (n, t, i) {
    if (void 0 !== t) {
        var r = this._notificationHandlers[n][t];
        void 0 !== r && this._invokeHandler(r.handler, i);
        "series_deleted" != i.method && "study_deleted" != i.method || delete this._notificationHandlers[n][t]
    }
};
D82.ChartApi.prototype.searchSymbolsByName = function (n, t, i, r, u) {
    0 == n.length && 0 == t.length && 0 == i.length && u([]);
    this._studyEngine.searchSymbolsByName(n, t, i, u)
};
D82.ChartApi.prototype._notifySessions = function (n) {
    var t, i;
    for (t in this._sessions) {
        if (!this._sessions.hasOwnProperty(t))break;
        if (i = this._sessions[t], "function" == typeof i.onMessage)i.onMessage(n)
    }
};
D82.ChartApi.prototype.unpack = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype.reconnectTimeout = function () {
    throw"This method is not implemented";
};
D82.ChartApi.prototype.quoteCreateSession = function (n) {
    return this._studyEngine.quoteCreateSession(n)
};
D82.ChartApi.prototype.quoteDeleteSession = function (n) {
    return this._studyEngine.quoteDeleteSession(n)
};
D82.ChartApi.prototype.quoteSetFields = function (n, t) {
    return this._studyEngine.quoteSetFields(n, t)
};
D82.ChartApi.prototype.quoteAddSymbols = function (n, t) {
    return this._studyEngine.quoteAddSymbols(n, t)
};
D82.ChartApi.prototype.quoteRemoveSymbols = function (n, t) {
    return this._studyEngine.quoteRemoveSymbols(n, t)
};
D82.ChartApi.prototype.quoteFastSymbols = function (n, t) {
    return this._studyEngine.quoteFastSymbols(n, t)
};
D82.ChartApi.prototype.depthCreateSession = function () {
};
D82.ChartApi.prototype.depthDeleteSession = function () {
};
D82.ChartApi.prototype.depthSetSymbol = function () {
};
D82.ChartApi.prototype.depthClearSymbol = function () {
};
D82.ChartApi.prototype.depthSetScale = function () {
};
D82.ChartApi.prototype.createStudiesAccessController = function (n, t, i) {
    return n ? new this.StudiesAccessController(this._studyEngine, JSON.parse(n)) : new this.ObsoleteStudiesAccessController(this._studyEngine, t && JSON.parse(t), i && JSON.parse(i))
};
D82.ChartApi.prototype.StudiesAccessController = function (n, t) {
    this._studyEngine = n;
    this._studiesAccess = t
};
D82.ChartApi.prototype.StudiesAccessController.prototype._findTool = function (n) {
    for (var i, r = null, t = 0; t < this._studiesAccess.tools.length; ++t)if (i = this._studiesAccess.tools[t], i.name == n || i == n) {
        r = i;
        break
    }
    return r
};
D82.ChartApi.prototype.StudiesAccessController.prototype.getEnabledTools = function () {
    return this._studyEngine.studiesMetadata().filter(function (n) {
        return n = this._findTool(n.description), "black" == this._studiesAccess.type ? !n || n.grayed : !!n
    }, this)
};
D82.ChartApi.prototype.StudiesAccessController.prototype.isToolGrayed = function (n) {
    return(n = this._findTool(n)) && n.grayed
};
D82.ChartApi.prototype.ObsoleteStudiesAccessController = function (n, t, i) {
    this._studyEngine = n;
    this._enabledStudiesList = t;
    this._disabledStudiesList = i
};
D82.ChartApi.prototype.ObsoleteStudiesAccessController.prototype.getEnabledTools = function () {
    var n = this._studyEngine.studiesMetadata();
    return 0 < this._enabledStudiesList.length ? n = n.filter(function (n) {
        return n.is_hidden_study || 0 <= this._enabledStudiesList.indexOf(n.description)
    }, this) : 0 < this._disabledStudiesList.length && (n = n.filter(function (n) {
        return n.is_hidden_study || -1 == this._disabledStudiesList.indexOf(n.description)
    }, this)), n
};
D82.ChartApi.prototype.ObsoleteStudiesAccessController.prototype.isToolGrayed = function () {
    return!1
};
requireFullInterfaceImplementation(D82.ChartApi, "D82.ChartApi", J98, "J98");
D82.DatafeedInterface = function () {
};
D82.DatafeedInterface.prototype.getConfigurationData = function () {
};
D82.DatafeedInterface.prototype.searchSymbolsByName = function () {
};
D82.DatafeedInterface.prototype.resolveSymbol = function () {
};
D82.DatafeedInterface.prototype.getBars = function () {
};
D82.DatafeedInterface.prototype.getBarsByRange = function () {
};
D82.DatafeedInterface.prototype.subscribeBars = function () {
};
D82.DatafeedInterface.prototype.unsubscribeBars = function () {
};
declareClassAsPureInterface(D82.DatafeedInterface, "D82.DatafeedInterface");
this.TzData = TzData = function () {
    var n = {"America/New_York": {time: [-2717668562, -1633298400, -1615154400, -1601848800, -1583704800, -1570399200, -1551650400, -1536530400, -1523224800, -1504476e3, -1491775200, -1473026400, -1459720800, -1441576800, -1428271200, -1410127200, -1396821600, -1378677600, -1365372e3, -1347228e3, -1333922400, -1315173600, -1301868e3, -1283724e3, -1270418400, -1252274400, -1238968800, -1220824800, -1207519200, -1189375200, -1176069600, -1157320800, -114462e4, -1125871200, -1112565600, -1094421600, -1081116e3, -1062972e3, -1049666400, -1031522400, -1018216800, -1000072800, -986767200, -968018400, -955317600, -936568800, -923263200, -905119200, -891813600, -880236e3, -76941e4, -765410400, -747266400, -733960800, -715816800, -702511200, -684367200, -671061600, -652917600, -639612e3, -620863200, -608162400, -589413600, -576108e3, -557964e3, -544658400, -526514400, -513208800, -495064800, -481759200, -463615200, -447285600, -431560800, -415836e3, -400111200, -384386400, -368661600, -352936800, -337212e3, -321487200, -305762400, -289432800, -273708e3, -257983200, -242258400, -226533600, -210808800, -195084e3, -179359200, -163634400, -147909600, -13158e4, -11646e4, -100130400, -84405600, -68680800, -52956e3, -37231200, -21506400, -5781600, 9943200, 25668e3, 41392800, 57722400, 73447200, 89172e3, 104896800, 120621600, 126669600, 152071200, 162352800, 183520800, 199245600, 215575200, 230695200, 247024800, 262749600, 278474400, 294199200, 309924e3, 325648800, 341373600, 357098400, 372823200, 388548e3, 404877600, 419997600, 436327200, 452052e3, 467776800, 483501600, 499226400, 514951200, 530676e3, 544586400, 562125600, 576036e3, 59418e4, 607485600, 625629600, 638935200, 657079200, 670989600, 688528800, 702439200, 719978400, 733888800, 752032800, 765338400, 783482400, 796788e3, 814932e3, 828842400, 846381600, 860292e3, 877831200, 891741600, 909280800, 923191200, 941335200, 954640800, 972784800, 986090400, 1004234400, 1018144800, 1035684e3, 1049594400, 1067133600, 1081044e3, 1099188e3, 1112493600, 1130637600, 1143943200, 1162087200, 1173578400, 1194141600, 1205028e3, 1225591200, 1236477600, 1257040800, 1268532e3, 1289095200, 1299981600, 1320544800, 1331431200, 1351994400, 1362880800, 1383444e3, 1394330400, 1414893600, 142578e4, 1446343200, 1457834400, 1478397600, 1489284e3, 1509847200, 1520733600, 1541296800, 1552183200, 1572746400, 1583632800, 1604196e3, 1615687200, 1636250400, 1647136800, 16677e5, 1678586400, 1699149600, 1710036e3, 1730599200, 1741485600, 1762048800, 1772935200, 1793498400, 1804989600, 1825552800, 1836439200, 1857002400, 1867888800, 1888452e3, 1899338400, 1919901600, 1930788e3], offset: [-17762, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3]}, "America/Los_Angeles": {time: [-2717668378, -1633298400, -1615154400, -1601848800, -1583704800, -880236e3, -769420800, -765410400, -687996e3, -662680800, -620863200, -608162400, -589413600, -576108e3, -557964e3, -544658400, -526514400, -513208800, -495064800, -481759200, -463615200, -450309600, -431560800, -418255200, -400111200, -386805600, -368661600, -355356e3, -337212e3, -323906400, -305762400, -292456800, -273708e3, -261007200, -242258400, -226533600, -210808800, -195084e3, -179359200, -163634400, -147909600, -13158e4, -11646e4, -100130400, -84405600, -68680800, -52956e3, -37231200, -21506400, -5781600, 9943200, 25668e3, 41392800, 57722400, 73447200, 89172e3, 104896800, 120621600, 126669600, 152071200, 162352800, 183520800, 199245600, 215575200, 230695200, 247024800, 262749600, 278474400, 294199200, 309924e3, 325648800, 341373600, 357098400, 372823200, 388548e3, 404877600, 419997600, 436327200, 452052e3, 467776800, 483501600, 499226400, 514951200, 530676e3, 544586400, 562125600, 576036e3, 59418e4, 607485600, 625629600, 638935200, 657079200, 670989600, 688528800, 702439200, 719978400, 733888800, 752032800, 765338400, 783482400, 796788e3, 814932e3, 828842400, 846381600, 860292e3, 877831200, 891741600, 909280800, 923191200, 941335200, 954640800, 972784800, 986090400, 1004234400, 1018144800, 1035684e3, 1049594400, 1067133600, 1081044e3, 1099188e3, 1112493600, 1130637600, 1143943200, 1162087200, 1173578400, 1194141600, 1205028e3, 1225591200, 1236477600, 1257040800, 1268532e3, 1289095200, 1299981600, 1320544800, 1331431200, 1351994400, 1362880800, 1383444e3, 1394330400, 1414893600, 142578e4, 1446343200, 1457834400, 1478397600, 1489284e3, 1509847200, 1520733600, 1541296800, 1552183200, 1572746400, 1583632800, 1604196e3, 1615687200, 1636250400, 1647136800, 16677e5, 1678586400, 1699149600, 1710036e3, 1730599200, 1741485600, 1762048800, 1772935200, 1793498400, 1804989600, 1825552800, 1836439200, 1857002400, 1867888800, 1888452e3, 1899338400, 1919901600, 1930788e3], offset: [-28378, -28800, -25200, -28800, -25200, -28800, -25200, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800]}, "America/Chicago": {time: [-2717668236, -1633298400, -1615154400, -1601848800, -1583704800, -1563746400, -1551650400, -1538949600, -1520200800, -1504476e3, -1491775200, -1473026400, -1459720800, -1441576800, -1428271200, -1410127200, -1396821600, -1378677600, -1365372e3, -1347228e3, -1333922400, -1315173600, -1301868e3, -1283724e3, -1270418400, -1252274400, -1238968800, -1220824800, -1207519200, -1189375200, -1176069600, -1157320800, -114462e4, -1125871200, -1112565600, -1094421600, -1081116e3, -1067810400, -1045432800, -1031522400, -1018216800, -1000072800, -986767200, -968018400, -955317600, -936568800, -923263200, -905119200, -891813600, -880236e3, -769413600, -765410400, -747266400, -733960800, -715816800, -702511200, -684367200, -671061600, -652917600, -639612e3, -620863200, -608162400, -589413600, -576108e3, -557964e3, -544658400, -526514400, -513208800, -495064800, -481759200, -463615200, -447285600, -431560800, -415836e3, -400111200, -384386400, -368661600, -352936800, -337212e3, -321487200, -305762400, -289432800, -273708e3, -257983200, -242258400, -226533600, -210808800, -195084e3, -179359200, -163634400, -147909600, -13158e4, -11646e4, -100130400, -84405600, -68680800, -52956e3, -37231200, -21506400, -5781600, 9943200, 25668e3, 41392800, 57722400, 73447200, 89172e3, 104896800, 120621600, 126669600, 152071200, 162352800, 183520800, 199245600, 215575200, 230695200, 247024800, 262749600, 278474400, 294199200, 309924e3, 325648800, 341373600, 357098400, 372823200, 388548e3, 404877600, 419997600, 436327200, 452052e3, 467776800, 483501600, 499226400, 514951200, 530676e3, 544586400, 562125600, 576036e3, 59418e4, 607485600, 625629600, 638935200, 657079200, 670989600, 688528800, 702439200, 719978400, 733888800, 752032800, 765338400, 783482400, 796788e3, 814932e3, 828842400, 846381600, 860292e3, 877831200, 891741600, 909280800, 923191200, 941335200, 954640800, 972784800, 986090400, 1004234400, 1018144800, 1035684e3, 1049594400, 1067133600, 1081044e3, 1099188e3, 1112493600, 1130637600, 1143943200, 1162087200, 1173578400, 1194141600, 1205028e3, 1225591200, 1236477600, 1257040800, 1268532e3, 1289095200, 1299981600, 1320544800, 1331431200, 1351994400, 1362880800, 1383444e3, 1394330400, 1414893600, 142578e4, 1446343200, 1457834400, 1478397600, 1489284e3, 1509847200, 1520733600, 1541296800, 1552183200, 1572746400, 1583632800, 1604196e3, 1615687200, 1636250400, 1647136800, 16677e5, 1678586400, 1699149600, 1710036e3, 1730599200, 1741485600, 1762048800, 1772935200, 1793498400, 1804989600, 1825552800, 1836439200, 1857002400, 1867888800, 1888452e3, 1899338400, 1919901600, 1930788e3], offset: [-21036, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600, -18e3, -21600]}, "America/Toronto": {time: [-2366755200, -1632088800, -1615154400, -1601771400, -1583712e3, -1567375200, -1554681600, -1534716e3, -1524088800, -1503266400, -149238e4, -1471816800, -1460930400, -1440972e3, -1428876e3, -1409522400, -1397426400, -1378072800, -1365976800, -1346623200, -1333922400, -1315173600, -1301868e3, -1283724e3, -1270418400, -1252274400, -1238968800, -1220824800, -1207519200, -1188770400, -1176069600, -1157320800, -1144015200, -1125871200, -1112565600, -1094421600, -1081116e3, -1062972e3, -1049666400, -1031522400, -1018216800, -1000072800, -986767200, -968018400, -955317600, -936568800, -880232400, -76941e4, -765410400, -747266400, -733960800, -715824e3, -702518400, -684374400, -671068800, -652924800, -634176e3, -620863200, -602719200, -589413600, -576108e3, -557964e3, -544658400, -526514400, -513208800, -495064800, -481759200, -463615200, -450309600, -431560800, -418255200, -400111200, -384386400, -368661600, -352936800, -337212e3, -321487200, -305762400, -289432800, -273708e3, -257983200, -242258400, -226533600, -210808800, -195084e3, -179359200, -163634400, -147909600, -13158e4, -11646e4, -100130400, -84405600, -68680800, -52956e3, -37231200, -21506400, -5781600, 9943200, 25668e3, 41392800, 57722400, 73447200, 89172e3, 104896800, 120621600, 136346400, 152071200, 167796e3, 183520800, 199245600, 215575200, 230695200, 247024800, 262749600, 278474400, 294199200, 309924e3, 325648800, 341373600, 357098400, 372823200, 388548e3, 404877600, 419997600, 436327200, 452052e3, 467776800, 483501600, 499226400, 514951200, 530676e3, 544586400, 562125600, 576036e3, 59418e4, 607485600, 625629600, 638935200, 657079200, 670989600, 688528800, 702439200, 719978400, 733888800, 752032800, 765338400, 783482400, 796788e3, 814932e3, 828842400, 846381600, 860292e3, 877831200, 891741600, 909280800, 923191200, 941335200, 954640800, 972784800, 986090400, 1004234400, 1018144800, 1035684e3, 1049594400, 1067133600, 1081044e3, 1099188e3, 1112493600, 1130637600, 1143943200, 1162087200, 1173578400, 1194141600, 1205028e3, 1225591200, 1236477600, 1257040800, 1268532e3, 1289095200, 1299981600, 1320544800, 1331431200, 1351994400, 1362880800, 1383444e3, 1394330400, 1414893600, 142578e4, 1446343200, 1457834400, 1478397600, 1489284e3, 1509847200, 1520733600, 1541296800, 1552183200, 1572746400, 1583632800, 1604196e3, 1615687200, 1636250400, 1647136800, 16677e5, 1678586400, 1699149600, 1710036e3, 1730599200, 1741485600, 1762048800, 1772935200, 1793498400, 1804989600, 1825552800, 1836439200, 1857002400, 1867888800, 1888452e3, 1899338400, 1919901600, 1930788e3], offset: [-19052, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -14400, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3, -14400, -18e3]}, "America/Vancouver": {time: [-2713910400, -1632088800, -1615154400, -880236e3, -769420800, -765410400, -747266400, -732751200, -715816800, -702511200, -684367200, -671061600, -652917600, -639612e3, -620863200, -608162400, -589413600, -576108e3, -557964e3, -544658400, -526514400, -513208800, -495064800, -481759200, -463615200, -450309600, -431560800, -418255200, -400111200, -386805600, -368661600, -355356e3, -337212e3, -323906400, -305762400, -292456800, -273708e3, -261007200, -242258400, -226533600, -210808800, -195084e3, -179359200, -163634400, -147909600, -13158e4, -11646e4, -100130400, -84405600, -68680800, -52956e3, -37231200, -21506400, -5781600, 9943200, 25668e3, 41392800, 57722400, 73447200, 89172e3, 104896800, 120621600, 136346400, 152071200, 167796e3, 183520800, 199245600, 215575200, 230695200, 247024800, 262749600, 278474400, 294199200, 309924e3, 325648800, 341373600, 357098400, 372823200, 388548e3, 404877600, 419997600, 436327200, 452052e3, 467776800, 483501600, 499226400, 514951200, 530676e3, 544586400, 562125600, 576036e3, 59418e4, 607485600, 625629600, 638935200, 657079200, 670989600, 688528800, 702439200, 719978400, 733888800, 752032800, 765338400, 783482400, 796788e3, 814932e3, 828842400, 846381600, 860292e3, 877831200, 891741600, 909280800, 923191200, 941335200, 954640800, 972784800, 986090400, 1004234400, 1018144800, 1035684e3, 1049594400, 1067133600, 1081044e3, 1099188e3, 1112493600, 1130637600, 1143943200, 1162087200, 1173578400, 1194141600, 1205028e3, 1225591200, 1236477600, 1257040800, 1268532e3, 1289095200, 1299981600, 1320544800, 1331431200, 1351994400, 1362880800, 1383444e3, 1394330400, 1414893600, 142578e4, 1446343200, 1457834400, 1478397600, 1489284e3, 1509847200, 1520733600, 1541296800, 1552183200, 1572746400, 1583632800, 1604196e3, 1615687200, 1636250400, 1647136800, 16677e5, 1678586400, 1699149600, 1710036e3, 1730599200, 1741485600, 1762048800, 1772935200, 1793498400, 1804989600, 1825552800, 1836439200, 1857002400, 1867888800, 1888452e3, 1899338400, 1919901600, 1930788e3], offset: [-29548, -28800, -25200, -28800, -25200, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800, -25200, -28800]}, "America/Argentina/Buenos_Aires": {time: [-2372112e3, -1567468800, -1233446400, -1222992e3, -1205971200, -1194048e3, -117288e4, -1162512e3, -1141344e3, -1130976e3, -1109808e3, -109944e4, -1078272e3, -1067817600, -1046649600, -1036281600, -1015113600, -1004745600, -983577600, -973209600, -952041600, -941587200, -931046400, -900892800, -890352e3, -83376e4, -82728e4, -752284800, -733795200, -197337600, -190857600, -184204800, -164505600, -152668800, -132969600, -121132800, -101433600, -86832e3, -71107200, -54777600, -39052800, -23328e3, -7603200, 128131200, 136598400, 596937600, 605059200, 624412800, 636508800, 656467200, 667958400, 687916800, 699408e3, 719366400, 731462400, 938912400, 952041600, 1198972800, 1205625600, 1224374400, 1237075200, 1924981200], offset: [-14028, -15408, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -14400, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -10800, -10800, -7200, -10800, -7200, -10800]}, "America/Sao_Paulo": {time: [-1767225600, -1206968400, -1191369600, -1175385600, -1159833600, -633830400, -622076400, -602294400, -59184e4, -570758400, -560217600, -539136e3, -53136e4, -195436800, -184204800, -155174400, -150076800, -128908800, -121132800, -99964800, -89596800, -68428800, -57974400, 499737600, 511228800, 530582400, 540259200, 562118400, 571190400, 592963200, 602035200, 624412800, 634694400, 656467200, 666748800, 687916800, 697593600, 719971200, 728438400, 750816e3, 761702400, 782265600, 793152e3, 813715200, 823996800, 84456e4, 856051200, 876096e3, 888710400, 908064e3, 919555200, 938908800, 951609600, 970963200, 982454400, 1003017600, 1013904e3, 1036281600, 1045353600, 1066521600, 1076803200, 1099353600, 1108857600, 1129420800, 1140307200, 1162684800, 1172361600, 119232e4, 1203206400, 1224374400, 1234656e3, 1255824e3, 1266710400, 1287273600, 129816e4, 1318723200, 1330214400, 1350777600, 1361059200, 1382227200, 1392508800, 1413676800, 1424563200, 1445126400, 1456012800, 1476576e3, 1487462400, 1508025600, 1518912e3, 154008e4, 1550361600, 1571529600, 1581811200, 1602979200, 1613865600, 1634428800, 1645315200, 1665878400, 1677369600, 1697328e3, 1708214400, 1729382400, 1739664e3, 1760832e3, 1771718400, 1792281600, 1803168e3, 1823731200, 1834617600, 1855180800, 1866067200, 1887235200, 1897516800, 1918684800, 1928966400], offset: [-11188, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200, -10800, -7200]}, "America/Bogota": {time: [-2707689600, -1739059200, 704851200, 733881600, 1924974e3], offset: [-17776, -17776, -18e3, -14400, -18e3]}, "Europe/Moscow": {time: [-2840140800, -1688256e3, -165681e4, -1641340800, -1627956e3, -1618700400, -1596416400, -1593813600, -1589846400, -1542416400, -1539478800, -1525305600, -1522713600, -1491177600, -1247529600, 354931200, 370742400, 386467200, 402278400, 418003200, 433814400, 449625600, 465361200, 481082400, 496810800, 512532e3, 528260400, 543981600, 55971e4, 575431200, 591159600, 606880800, 622609200, 638330400, 654663600, 670388400, 686113200, 695786400, 701823600, 717548400, 733284e3, 749012400, 764733600, 780462e3, 796183200, 811911600, 828237600, 846385200, 859687200, 877834800, 891136800, 909284400, 922586400, 941338800, 954036e3, 972788400, 985485600, 1004238e3, 101754e4, 1035687600, 1048989600, 1067137200, 1080439200, 1099191600, 1111888800, 1130641200, 1143338400, 1162090800, 1174788e3, 1193540400, 1206842400, 122499e4, 1238292e3, 1256439600, 1269741600, 1288494e3, 1301191200, 1414288800, 1925002800], offset: [9017, 9017, 9079, 12679, 9079, 16279, 12679, 16279, 14400, 10800, 14400, 18e3, 14400, 10800, 7200, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 10800, 7200, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800, 14400, 10800]}, "Europe/Athens": {time: [-2344636800, -1686095940, -1182988800, -1178150400, -906854400, -904867200, -85725e4, -844473600, -828230400, -812419200, -552355200, -541641600, 166492800, 186195600, 198036e3, 213764400, 228880800, 244090800, 260330400, 275457600, 291805200, 307418400, 323395200, 338947200, 354682800, 370411200, 386132400, 401860800, 417582e3, 433310400, 449031600, 465364800, 481086e3, 496814400, 512535600, 528264e3, 543985200, 559713600, 575434800, 591163200, 606884400, 622612800, 638334e3, 654667200, 670388400, 686116800, 701838e3, 717566400, 733287600, 749016e3, 764737200, 780465600, 796186800, 811915200, 828241200, 846388800, 859690800, 877838400, 891140400, 909288e3, 92259e4, 941342400, 954039600, 972792e3, 985489200, 1004241600, 1017543600, 1035691200, 1048993200, 1067140800, 1080442800, 1099195200, 1111892400, 1130644800, 1143342e3, 1162094400, 1174791600, 1193544e3, 1206846e3, 1224993600, 1238295600, 1256443200, 1269745200, 1288497600, 1301194800, 1319947200, 1332644400, 1351396800, 1364698800, 1382846400, 1396148400, 1414296e3, 1427598e3, 1445745600, 1459047600, 14778e5, 1490497200, 1509249600, 1521946800, 1540699200, 1554001200, 1572148800, 1585450800, 1603598400, 1616900400, 1635652800, 164835e4, 1667102400, 1679799600, 1698552e3, 1711854e3, 1730001600, 1743303600, 1761451200, 1774753200, 1792900800, 1806202800, 1824955200, 1837652400, 1856404800, 1869102e3, 1887854400, 1901156400, 1919304e3, 1932606e3], offset: [5692, 5692, 7200, 10800, 7200, 10800, 7200, 3600, 7200, 3600, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200, 10800, 7200]}, "Europe/Berlin": {time: [-2422051200, -1693702800, -1680476400, -1663452e3, -1650142800, -1632002400, -1618693200, -938901600, -85725e4, -844552800, -828219600, -812498400, -79677e4, -781048800, -776552400, -765925200, -761173200, -748476e3, -733266e3, -717627600, -714603600, -71037e4, -701902800, -684972e3, -670453200, -654127200, -639003600, 323834400, 338958e3, 354679200, 370407600, 386128800, 401857200, 417578400, 433306800, 449028e3, 465361200, 481082400, 496810800, 512532e3, 528260400, 543981600, 55971e4, 575431200, 591159600, 606880800, 622609200, 638330400, 654663600, 670384800, 686113200, 701834400, 717562800, 733284e3, 749012400, 764733600, 780462e3, 796183200, 811911600, 828237600, 846385200, 859687200, 877834800, 891136800, 909284400, 922586400, 941338800, 954036e3, 972788400, 985485600, 1004238e3, 101754e4, 1035687600, 1048989600, 1067137200, 1080439200, 1099191600, 1111888800, 1130641200, 1143338400, 1162090800, 1174788e3, 1193540400, 1206842400, 122499e4, 1238292e3, 1256439600, 1269741600, 1288494e3, 1301191200, 1319943600, 1332640800, 1351393200, 1364695200, 1382842800, 1396144800, 1414292400, 1427594400, 1445742e3, 1459044e3, 1477796400, 1490493600, 1509246e3, 1521943200, 1540695600, 1553997600, 1572145200, 1585447200, 1603594800, 1616896800, 1635649200, 1648346400, 1667098800, 1679796e3, 1698548400, 1711850400, 1729998e3, 17433e5, 1761447600, 1774749600, 1792897200, 1806199200, 1824951600, 1837648800, 1856401200, 1869098400, 1887850800, 1901152800, 1919300400, 1932602400], offset: [3208, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 10800, 7200, 3600, 7200, 3600, 7200, 10800, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600]}, "Europe/London": {time: [-3852662400, -1691964e3, -1680469200, -1664143200, -1650142800, -1633903200, -1617483600, -1601848800, -1586034e3, -1570399200, -1552165200, -1538344800, -152253e4, -15075e5, -1490562e3, -1473631200, -1460926800, -1442786400, -1428872400, -1410732e3, -1396213200, -1379282400, -1364763600, -1348437600, -1333314e3, -1315778400, -1301259600, -1284328800, -126981e4, -1253484e3, -1238360400, -1221429600, -1206910800, -118998e4, -1175461200, -1159135200, -1143406800, -1126476e3, -1111957200, -1095631200, -1080507600, -1063576800, -1049058e3, -1032127200, -1017608400, -1001282400, -986158800, -969228e3, -950475600, -942012e3, -904514400, -896043600, -875484e3, -864594e3, -844034400, -832539600, -812584800, -798066e3, -781048800, -772059600, -764802e3, -748476e3, -733352400, -719445600, -717026400, -706741200, -699483600, -687996e3, -668034e3, -654732e3, -636584400, -622072800, -605739600, -590623200, -57429e4, -558568800, -542235600, -527119200, -512600400, -496274400, -481150800, -46422e4, -449701200, -432165600, -417646800, -401320800, -386197200, -369266400, -354747600, -337816800, -323298e3, -306972e3, -291848400, -276732e3, -257979600, -245282400, -22653e4, -213228e3, -195080400, -182383200, -163630800, -150933600, -132181200, -119484e3, -100731600, -88034400, -68677200, -59004e3, 57726e3, 69818400, 89175600, 101268e3, 120625200, 132717600, 152074800, 164167200, 183524400, 196221600, 214974e3, 227671200, 246423600, 259120800, 278478e3, 290570400, 309927600, 32202e4, 341377200, 354675600, 372823200, 386125200, 404272800, 417574800, 435722400, 449024400, 467776800, 481078800, 499226400, 512528400, 530676e3, 543978e3, 562125600, 575427600, 593575200, 606877200, 625629600, 638326800, 657079200, 670381200, 688528800, 701830800, 719978400, 733280400, 751428e3, 76473e4, 782877600, 796179600, 814327200, 828234e3, 846381600, 859683600, 877831200, 891133200, 909280800, 922582800, 941335200, 954032400, 972784800, 985482e3, 1004234400, 1017536400, 1035684e3, 1048986e3, 1067133600, 1080435600, 1099188e3, 1111885200, 1130637600, 1143334800, 1162087200, 1174784400, 1193536800, 1206838800, 1224986400, 1238288400, 1256436e3, 1269738e3, 1288490400, 1301187600, 131994e4, 1332637200, 1351389600, 1364691600, 1382839200, 1396141200, 1414288800, 1427590800, 1445738400, 1459040400, 1477792800, 149049e4, 1509242400, 1521939600, 1540692e3, 1553994e3, 1572141600, 1585443600, 1603591200, 1616893200, 1635645600, 1648342800, 1667095200, 1679792400, 1698544800, 1711846800, 1729994400, 1743296400, 1761444e3, 1774746e3, 1792893600, 1806195600, 1824948e3, 1837645200, 1856397600, 1869094800, 1887847200, 1901149200, 1919296800, 1932598800], offset: [-75, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 0, 3600, 0, 3600, 7200, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0]}, "Europe/Madrid": {time: [-2177452800, -1661734800, -1648425600, -1631926800, -1616889600, -1601254800, -1585353600, -1442451600, -1427673600, -1379293200, -1364774400, -1348448400, -1333324800, -1316394e3, -1301270400, -1284339600, -1269820800, -1029114e3, -1017619200, -1002848400, -986169600, -969238800, -954115200, -940208400, -873075600, -862531200, -842835600, -828230400, -811386e3, -796003200, -779936400, -765414e3, -748486800, -733881600, -652323600, -639183600, 135126e3, 150253200, 167180400, 181702800, 196815600, 212547600, 22887e4, 243997200, 260406e3, 276051600, 29178e4, 307508400, 323834400, 338958e3, 354679200, 370407600, 386128800, 401857200, 417578400, 433306800, 449028e3, 465361200, 481082400, 496810800, 512532e3, 528260400, 543981600, 55971e4, 575431200, 591159600, 606880800, 622609200, 638330400, 654663600, 670384800, 686113200, 701834400, 717562800, 733284e3, 749012400, 764733600, 780462e3, 796183200, 811911600, 828237600, 846385200, 859687200, 877834800, 891136800, 909284400, 922586400, 941338800, 954036e3, 972788400, 985485600, 1004238e3, 101754e4, 1035687600, 1048989600, 1067137200, 1080439200, 1099191600, 1111888800, 1130641200, 1143338400, 1162090800, 1174788e3, 1193540400, 1206842400, 122499e4, 1238292e3, 1256439600, 1269741600, 1288494e3, 1301191200, 1319943600, 1332640800, 1351393200, 1364695200, 1382842800, 1396144800, 1414292400, 1427594400, 1445742e3, 1459044e3, 1477796400, 1490493600, 1509246e3, 1521943200, 1540695600, 1553997600, 1572145200, 1585447200, 1603594800, 1616896800, 1635649200, 1648346400, 1667098800, 1679796e3, 1698548400, 1711850400, 1729998e3, 17433e5, 1761447600, 1774749600, 1792897200, 1806199200, 1824951600, 1837648800, 1856401200, 1869098400, 1887850800, 1901152800, 1919300400, 1932602400], offset: [-884, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600]}, "Europe/Paris": {time: [-2486678340, -1855958340, -1689814800, -1680393600, -1665363600, -1648339200, -1635123600, -1616889600, -1604278800, -158544e4, -1574038800, -1552262400, -1539997200, -1520553600, -1507510800, -1490572800, -1470618e3, -1459123200, -1444006800, -1427673600, -1411952400, -1396224e3, -1379293200, -1364774400, -1348448400, -1333324800, -1316394e3, -1301270400, -1284339600, -1269820800, -1253494800, -1238371200, -1221440400, -1206921600, -1191200400, -1175472e3, -1160355600, -1143417600, -1127696400, -1111968e3, -1096851600, -1080518400, -1063587600, -1049068800, -1033347600, -1017619200, -1002502800, -986169600, -969238800, -950486400, -942012e3, -932432400, -85725e4, -844552800, -828219600, -812498400, -800064e3, -796258800, -781048800, -766616400, 196822800, 212547600, 228880800, 244004400, 260330400, 276058800, 29178e4, 307508400, 323834400, 338958e3, 354679200, 370407600, 386128800, 401857200, 417578400, 433306800, 449028e3, 465361200, 481082400, 496810800, 512532e3, 528260400, 543981600, 55971e4, 575431200, 591159600, 606880800, 622609200, 638330400, 654663600, 670384800, 686113200, 701834400, 717562800, 733284e3, 749012400, 764733600, 780462e3, 796183200, 811911600, 828237600, 846385200, 859687200, 877834800, 891136800, 909284400, 922586400, 941338800, 954036e3, 972788400, 985485600, 1004238e3, 101754e4, 1035687600, 1048989600, 1067137200, 1080439200, 1099191600, 1111888800, 1130641200, 1143338400, 1162090800, 1174788e3, 1193540400, 1206842400, 122499e4, 1238292e3, 1256439600, 1269741600, 1288494e3, 1301191200, 1319943600, 1332640800, 1351393200, 1364695200, 1382842800, 1396144800, 1414292400, 1427594400, 1445742e3, 1459044e3, 1477796400, 1490493600, 1509246e3, 1521943200, 1540695600, 1553997600, 1572145200, 1585447200, 1603594800, 1616896800, 1635649200, 1648346400, 1667098800, 1679796e3, 1698548400, 1711850400, 1729998e3, 17433e5, 1761447600, 1774749600, 1792897200, 1806199200, 1824951600, 1837648800, 1856401200, 1869098400, 1887850800, 1901152800, 1919300400, 1932602400], offset: [561, 561, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 0, 3600, 7200, 3600, 7200, 3600, 7200, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600]}, "Europe/Warsaw": {time: [-2840140800, -1717027200, -1693702800, -1680476400, -1663452e3, -1650142800, -1632002400, -1618693200, -1600466400, -1587157200, -1501718400, -931730400, -85725e4, -844552800, -828219600, -812498400, -796600800, -778723200, -762652800, -748483200, -733266e3, -715212e3, -701902800, -684972e3, -670453200, -654127200, -639003600, -397090800, -386805600, -371084400, -355356e3, -334191600, -323301600, -307580400, -291852e3, -271292400, -260402400, -239842800, -228952800, -208393200, -197503200, -176338800, -166053600, 228877200, 244000800, 260326800, 276055200, 291776400, 307504800, 323830800, 338954400, 354675600, 370404e3, 386125200, 401853600, 417574800, 433303200, 449024400, 465357600, 481078800, 496807200, 512528400, 528256800, 543978e3, 559706400, 575431200, 591159600, 606880800, 622609200, 638330400, 654663600, 670384800, 686113200, 701834400, 717562800, 733284e3, 749012400, 764733600, 780462e3, 796183200, 811911600, 828237600, 846385200, 859687200, 877834800, 891136800, 909284400, 922586400, 941338800, 954036e3, 972788400, 985485600, 1004238e3, 101754e4, 1035687600, 1048989600, 1067137200, 1080439200, 1099191600, 1111888800, 1130641200, 1143338400, 1162090800, 1174788e3, 1193540400, 1206842400, 122499e4, 1238292e3, 1256439600, 1269741600, 1288494e3, 1301191200, 1319943600, 1332640800, 1351393200, 1364695200, 1382842800, 1396144800, 1414292400, 1427594400, 1445742e3, 1459044e3, 1477796400, 1490493600, 1509246e3, 1521943200, 1540695600, 1553997600, 1572145200, 1585447200, 1603594800, 1616896800, 1635649200, 1648346400, 1667098800, 1679796e3, 1698548400, 1711850400, 1729998e3, 17433e5, 1761447600, 1774749600, 1792897200, 1806199200, 1824951600, 1837648800, 1856401200, 1869098400, 1887850800, 1901152800, 1919300400, 1932602400], offset: [5040, 5040, 3600, 7200, 3600, 7200, 3600, 7200, 7200, 10800, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600, 7200, 3600]}, "Australia/Sydney": {time: [-2364076800, -1672531140, -1665352800, -883605600, -876088800, -860364e3, -844639200, -828309600, -813189600, 57722400, 68007600, 89172e3, 100062e3, 120621600, 131511600, 152071200, 162961200, 183520800, 195015600, 215575200, 226465200, 247024800, 257914800, 278474400, 289364400, 309924e3, 320814e3, 341373600, 352263600, 372823200, 386737200, 404877600, 415767600, 436327200, 447217200, 467776800, 478666800, 499226400, 511326e3, 530071200, 542775600, 562125600, 57483e4, 59418e4, 606279600, 625629600, 636519600, 657079200, 667969200, 688528800, 699418800, 719978400, 731473200, 752032800, 762922800, 783482400, 794372400, 814932e3, 828241200, 846381600, 859690800, 877831200, 891140400, 909280800, 92259e4, 941335200, 954039600, 967341600, 985489200, 1004234400, 1017543600, 1035684e3, 1048993200, 1067133600, 1080442800, 1099188e3, 1111892400, 1130637600, 1143946800, 1162087200, 1174791600, 1193536800, 1207450800, 1223172e3, 1238900400, 1254621600, 127035e4, 1286071200, 1301799600, 1317520800, 1333249200, 1349575200, 1365303600, 1381024800, 1396753200, 1412474400, 1428202800, 1443924e3, 1459652400, 1475373600, 1491102e3, 1506823200, 1522551600, 1538877600, 1554606e3, 1570327200, 1586055600, 1601776800, 1617505200, 1633226400, 1648954800, 1664676e3, 1680404400, 1696125600, 1712458800, 172818e4, 1743908400, 1759629600, 1775358e3, 1791079200, 1806807600, 1822528800, 1838257200, 1853978400, 1869706800, 1886032800, 1901761200, 1917482400, 1933210800], offset: [36292, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600, 36e3, 39600]}, "Asia/Tokyo": {time: [-2587678861, -2335219200, -1017792e3, -683762400, -672357600, -654732e3, -640908e3, -620258400, -609458400, -588808800, -578008800, 1925024400], offset: [33539, 32400, 32400, 32400, 36e3, 32400, 36e3, 32400, 36e3, 32400, 36e3, 32400]}, "Asia/Taipei": {time: [-2335219200, -1017792e3, -766191600, -745804800, -733795200, -716860800, -699580800, -683856e3, -670636800, -65232e4, -639100800, -620784e3, -607564800, -589248e3, -576028800, -562896e3, -541728e3, -528681600, -510192e3, -497145600, -478656e3, -465609600, -449798400, -433987200, -418176e3, -402451200, -38664e4, -370915200, -355104e3, -339379200, -323568e3, -302486400, -291945600, -270950400, -260409600, 134006400, 149817600, 165542400, 181353600, 299635200, 307584e3, 1925020800], offset: [29160, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800]}, "Asia/Singapore": {time: [-2177452800, -2038176e3, -1167609600, -1073001600, -894153600, -879638400, -766972800, -138758400, 378691200, 1925020800], offset: [24925, 24925, 25200, 26400, 26400, 27e3, 32400, 27e3, 27e3, 28800]}, "Asia/Shanghai": {time: [-2177452800, -933465600, -923097600, -908755200, -891561600, 515548800, 52704e4, 545184e3, 558489600, 576633600, 589939200, 608688e3, 621993600, 640137600, 653443200, 671587200, 684892800, 1925020800], offset: [29143, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800]}, "Asia/Seoul": {time: [-2524521600, -2053900800, -1325462400, -1199232e3, -1017792e3, -767318400, -498096e3, -303955200, -293500800, -264902400, -39484800, 547603200, 560908800, 579052800, 592358400, 1925024400], offset: [30472, 30600, 32400, 30600, 32400, 32400, 32400, 28800, 32400, 28800, 30600, 32400, 36e3, 32400, 36e3, 32400]}, "Asia/Tehran": {time: [-1704153600, -757382400, 247190400, 259286400, 277776e3, 283996800, 290822400, 306547200, 322444800, 338515200, 673228800, 685497600, 701222400, 71712e4, 732758400, 748656e3, 764294400, 780192e3, 795830400, 811728e3, 827366400, 843264e3, 858988800, 874886400, 890524800, 906422400, 922060800, 937958400, 953596800, 969494400, 985219200, 1001116800, 1016755200, 1032652800, 1048291200, 1064188800, 1079827200, 1095724800, 1111449600, 1127347200, 1206057600, 1221955200, 123768e4, 1253577600, 1269216e3, 1285113600, 1300752e3, 1316649600, 1332288e3, 1348185600, 1363910400, 1379808e3, 1395446400, 1411344e3, 1426982400, 144288e4, 1458518400, 1474416e3, 1490140800, 1506038400, 1521676800, 1537574400, 1553212800, 1569110400, 1584748800, 1600646400, 1616371200, 1632268800, 1647907200, 1663804800, 1679443200, 1695340800, 1710979200, 1726876800, 1742601600, 1758499200, 1774137600, 1790035200, 1805673600, 1821571200, 1837209600, 1853107200, 1868745600, 1884643200, 1900368e3, 1916265600, 1931904e3], offset: [12344, 12344, 12600, 14400, 18e3, 14400, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600, 16200, 12600]}, "Asia/Kolkata": {time: [-2840140800, -891561600, -872035200, -862617600, -764121600, 1925011800], offset: [21208, 21200, 23400, 19800, 23400, 19800]}, "Asia/Hong_Kong": {time: [-2056665600, -907360200, -891635400, -884217600, -766713600, -747952200, -728512200, -717021e3, -694470600, -683757e3, -668032200, -654726600, -636582600, -623277e3, -605133e3, -591827400, -573683400, -559773e3, -542320200, -528323400, -510179400, -498083400, -478729800, -466633800, -446675400, -435184200, -415225800, -403129800, -383776200, -371680200, -352326600, -340230600, -320877e3, -308781e3, -288822600, -277331400, -257373e3, -245881800, -225923400, -213827400, -194473800, -182377800, -163024200, -148509e3, -132784200, -117059400, -101334600, -85609800, -69280200, -53555400, -37830600, -22105800, -6381e3, 9343800, 25068600, 40793400, 56518200, 72243e3, 88572600, 104297400, 120022200, 126070200, 151471800, 167196600, 182921400, 198646200, 214371e3, 295414200, 309324600, 1925020800], offset: [27402, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800, 32400, 28800]}};
    return"undefined" != typeof module && module.exports ? module.exports = n : this.TzData = n, n
}(this);
this.PineJsCalendar = PineJsCalendar = function () {
    function t(n) {
        var t = i[n];
        if (t || ("UTC" !== n && "Etc/UTC" !== n && console.error("unknown timezone: " + n), t = {time: [], offset: []}), t.time.length !== t.offset.length && (console.error("timezone transition table doesn't match offset table"), t = {time: [], offset: []}), !t.time_utc) {
            n = t.time;
            for (var u = t.offset, f = n.length, e = Array(f), r = 0; r < f; r++)n[r] *= 1e3, u[r] *= 1e3, e[r] = n[r] - u[r];
            t.time_utc = e
        }
        this.tz = t
    }

    var i = this.TzData ? this.TzData : require("./tzdata.js"), n;
    return t.prototype.offset_utc = function (n) {
        return t._offset(this.tz.time_utc, this.tz.offset, n)
    }, t.prototype.offset_loc = function (n) {
        return t._offset(this.tz.time, this.tz.offset, n)
    }, t._offset = function (n, t, i) {
        var e;
        n:{
            if (e = n.length, 0 === e)n = -1; else for (var u = 0, f = e - 1, r = (u + f) / 2 | 0; ;) {
                if (n[r] > i) {
                    if (f = r - 1, f < u) {
                        n = r;
                        break n
                    }
                } else if (u = r + 1, f < u) {
                    n = r < e - 1 ? r + 1 : -1;
                    break n
                }
                r = (u + f) / 2 | 0
            }
        }
        return-1 === n ? 0 : t[n]
    }, n = {SUNDAY: 1, MONDAY: 2, TUESDAY: 3, WEDNESDAY: 4, THURSDAY: 5, FRIDAY: 6, SATURDAY: 7, JANUARY: 0, DECEMBER: 11, YEAR: 1, MONTH: 2, WEEK_OF_YEAR: 3, DAY_OF_MONTH: 5, DAY_OF_YEAR: 6, DAY_OF_WEEK: 7, HOUR_OF_DAY: 11, MINUTE: 12, SECOND: 13, minutesPerDay: 1440, secondsPerDay: 864e5, get_year: function (n) {
        return n.getUTCFullYear()
    }, get_month: function (n) {
        return n.getUTCMonth()
    }, get_hours: function (n) {
        return n.getUTCHours()
    }, get_minutes: function (n) {
        return n.getUTCMinutes()
    }, get_seconds: function (n) {
        return n.getUTCSeconds()
    }, get_day_of_month: function (n) {
        return n.getUTCDate()
    }, get_day_of_week: function (n) {
        return n.getUTCDay() + 1
    }, get_day_of_year: function (t) {
        var i = Date.UTC(t.getUTCFullYear(), 0, 1, 0, 0, 0, 0);
        return((t.getTime() - i) / n.secondsPerDay | 0) + 1
    }, get_week_of_year: function (t) {
        var i = Date.UTC(t.getUTCFullYear(), 0, 1, 0, 0, 0, 0);
        return t = n.clone(t), n.set_hms(t, 0, 0, 0, 0), t.setUTCDate(t.getUTCDate() + 4 - (t.getUTCDay() || 7)), ((t.getTime() - i) / n.secondsPerDay + 1) / 7 | 0
    }, get_minutes_from_midnight: function (t) {
        return 60 * n.get_hours(t) + n.get_minutes(t)
    }, set_hms: function (n, t, i, r, u) {
        n.setUTCHours(t);
        n.setUTCMinutes(i);
        n.setUTCSeconds(r);
        n.setUTCMilliseconds(u)
    }, add_date: function (t, i) {
        t.setTime(t.getTime() + i * n.secondsPerDay)
    }, clone: function (n) {
        return new Date(n.getTime())
    }, get_days_per_year: function (n) {
        return n = n.getUTCFullYear(), this.days_per_year(n)
    }, days_per_year: function (n) {
        return 0 != n % 4 || 0 == n % 100 && 0 != n % 400 ? 365 : 366
    }, get_part: function (t, i) {
        switch (i) {
            case n.YEAR:
                return n.get_year(t);
            case n.MONTH:
                return n.get_month(t);
            case n.DAY_OF_MONTH:
                return n.get_day_of_month(t);
            case n.WEEK_OF_YEAR:
                return n.get_week_of_year(t);
            case n.DAY_OF_WEEK:
                return n.get_day_of_week(t);
            case n.HOUR_OF_DAY:
                return n.get_hours(t);
            case n.MINUTE:
                return n.get_minutes(t);
            case n.DAY_OF_YEAR:
                return n.get_day_of_year(t);
            case n.SECOND:
                return n.get_seconds(t);
            default:
                return t.getTime()
        }
    }, time_minutes: function (n) {
        return 6e4 * n
    }, time_minutes_diff: function (n, t) {
        return((n / 1e3 | 0) - (t / 1e3 | 0)) / 60 | 0
    }, utc_to_cal: function (n, t) {
        var i = n.offset_utc(t);
        return new Date(t + i)
    }, get_cal: function (n, t, i, r) {
        return new Date(Date.UTC(t, i, r))
    }, cal_to_utc: function (n, t) {
        var i = t.getTime(), r = n.offset_loc(i);
        return i - r
    }, get_timezone: function (n) {
        return new t(n)
    }, shift_day: function (n, t) {
        var i;
        return i = n - 1 + t, 6 < i ? i %= 7 : 0 > i && (i = (7 + i % 7) % 7), i + 1
    }}, "undefined" != typeof module && module.exports ? module.exports = n : this.PineJsCalendar = n, n
}(this);
this.PineJsBarBuilder = PineJsBarBuilder = function () {
    function g(n, t, r, f) {
        return"" === n ? new u(t, r) : new i(r, f, t, nt(n, r))
    }

    function nt(n, t) {
        switch (n) {
            case"D":
                return new l(t);
            case"W":
                return new p(t);
            case"M":
                return new w(t)
        }
        return console.error("unknown dwm resolution: " + n), null
    }

    function tt(n, t, i) {
        return o(n, t, "front", function (n) {
            return n.length >= i
        })
    }

    function it(n, t, i) {
        return o(n, t, "back", function (n) {
            return n.length >= i
        })
    }

    function o(n, t, i, r) {
        var u = t, f;
        n.moveTo(u);
        for (var e = [], o = 0, s = 0; !r(e, u);) {
            if (20 < o)throw"Internal error 0x10 while extrapolating " + i;
            if (u = n.indexOfBar(u), -1 === u)u = n.startOfBar("front" == i ? 0 : -1); else if (-2 === u)u = n.startOfBar("front" == i ? -2 : 0); else {
                if (f = n.startOfBar(u), f != t) {
                    if (s && s == f)throw"Internal error 0x11 while extrapolating " + i;
                    s = f;
                    o = 0;
                    e.push(f)
                }
                u = "front" == i ? n.startOfBar(u + 1) : n.startOfBar(u - 1)
            }
            n.moveTo(u);
            o++
        }
        return"front" == i ? e : e.reverse()
    }

    function rt(n) {
        if (isNaN(n))return NaN;
        var t = this.indexOfBar(n);
        return-2 === t && (this.moveTo(n), t = this.indexOfBar(n)), 0 > t ? NaN : this.startOfBar(t)
    }

    function u(n, t) {
        this.period = n;
        this.session = t;
        this.sessionEnd = this.sessionStart = Number.MIN_VALUE
    }

    function i(n, t, i, r) {
        this.period = i;
        this.sessionTgt = n;
        this.sessionSrc = t || n;
        this.builder = r;
        this.periodStart = -Number.MAX_VALUE;
        this.periodEnd = -Number.MAX_VALUE;
        this.periodLastBarStart = -Number.MAX_VALUE
    }

    function v(t, i, r, u) {
        r = r || "front";
        var e = n.get_day_of_week(i), h = n.get_minutes_from_midnight(i), o = t.findSession(e, h), s = o.start(), l = o.dayOfWeek(), c = o.isOvernight(), f = 0;
        return"front" == r ? f = (l - e + 7) % 7 - (c ? 1 : 0) : (!t.isTradedOnWeekEnds && s > h && (f--, e = n.shift_day(e, -1)), f -= c ? 1 : 0, t.isTradedOnWeekEnds || (e == n.SUNDAY ? f -= 2 : e == n.SATURDAY && --f)), 0 !== f && n.add_date(i, f), n.set_hms(i, s / 60 | 0, s % 60, 0, 0), t = o.length(), r = new Date(i.valueOf() + 6e4 * t), i = u.offset_loc(i) / 6e4, u = u.offset_loc(r) / 6e4, t + (i - u)
    }

    function ut(t, i) {
        var r = n.get_day_of_week(i), u = n.get_minutes_from_midnight(i);
        return t.findSession(r, u).isOvernight() && n.add_date(i, 1), n.set_hms(i, 0, 0, 0, 0), i
    }

    function f(t, i, r, u) {
        return r = n.clone(r), v(i, r, u, t), n.cal_to_utc(t, r)
    }

    function e(t, i) {
        var r = n.get_day_of_week(i) - t.firstDayOfWeek;
        return 0 > r ? r + 7 : r
    }

    function y(t, i) {
        var r = i + t.firstDayOfWeek;
        return r > n.SATURDAY ? r - n.SATURDAY : r
    }

    function ft(t, i) {
        var u = n.get_day_of_year(i) - 1, r = e(t, i) - u % 7;
        return 0 == r ? u / 7 | 0 : (0 <= r && (r -= 7), (r + u) / 7 | 0)
    }

    function s(n, t, i) {
        for (var r = 0; t < i; ++t)r += n.isWeekEnd(y(n, t)) ? 1 : 0;
        return r
    }

    function ht(t, i) {
        var r = new Date(i, 11, 31, 23, 59), u;
        return r.setTime(r.valueOf() - 6e4 * r.getTimezoneOffset()), u = n.days_per_year(i) - et(t, r), n.get_day_of_week(r) !== n.SUNDAY && n.get_day_of_week(r) !== n.SATURDAY || u--, u
    }

    function et(t, i) {
        var u = n.get_day_of_year(i) - 1, o = e(t, i), r = o - u % 7, f;
        return 0 > r && (r += 7), f = 0, u < 7 - r ? f += s(t, r, o) : (u = 0 == r ? 0 : s(t, r, 7), f += s(t, 0, o) + u), f + ft(t, i) * t.weekEndsCount()
    }

    function h() {
    }

    function c(n) {
        this.sessionsSpec = n
    }

    function l(n) {
        this.session = n
    }

    function p(n) {
        this.session = n
    }

    function w(n) {
        this.session = n
    }

    function t(n, t, i) {
        this._dayOfWeek = n;
        this._start = t;
        this._length = i
    }

    function ot(n, t) {
        return n.compareTo(t)
    }

    function r(t) {
        function u(t) {
            var r = t.split(";"), u, i;
            return 2 < r.length ? (console.error("Only one `first day` specification expected @ session " + t), t) : 1 == r.length ? t : (u = 1, i = 0 <= r[0].indexOf("-") ? NaN : parseInt(r[0]), isNaN(i) && (u = 0, i = parseInt(r[1])), i < n.SUNDAY || i > n.SATURDAY) ? (console.error("Unexpected day index @ session: " + t + "; day index " + i), t) : (f.firstDayOfWeek = i, r[u])
        }

        var f = this, r, i;
        t = t || "0000-0000";
        this.entries = [];
        this.firstDayOfWeek = n.SUNDAY;
        "24x7" === t.toLowerCase() ? d.forEach(function (n) {
            this.addSessionEntry(n, 0, 0)
        }, this) : (t = u(t), r = !1, i = {}, t.split("|").forEach(function (n) {
            var t = n.split(":"), u;
            1 !== t.length && 2 !== t.length && console.error("bad session section: " + n);
            u = 1 === t.length;
            u && (r && console.error("duplicated default section: " + n), r = !0);
            (u ? st : ct(t[1])).forEach(function (n) {
                u && i[n] || (i[n] = t[0])
            }, this)
        }, this), d.forEach(function (n) {
            var r = i[n];
            r && r.split(",").forEach(function (i) {
                var r = i.split("-");
                2 !== r.length && (console.error("bad sessions spec: " + t), r = ["0000", "0000"]);
                i = parseInt(r[0]);
                r = parseInt(r[1]);
                this.addSessionEntry(n, i % 100 + 60 * (i / 100 | 0), r % 100 + 60 * (r / 100 | 0))
            }, this)
        }, this));
        this.entries.sort(ot)
    }

    function ct(n) {
        for (var r, t = [], i = 0; i < n.length; i++)r = n.charAt(i) - 0, -1 === t.indexOf(r) && t.push(r);
        return t
    }

    function b() {
    }

    function k(n, t, i) {
        var e = n.length, o;
        if (0 === e)return-1;
        for (var u = 0, f = e - 1, r = (u + f) / 2 | 0; ;) {
            if (o = i(n[r], t), 0 === o || 0 < o) {
                if (f = r - 1, f < u)return r
            } else if (u = r + 1, f < u)return r < e - 1 ? r + 1 : -1;
            r = (u + f) / 2 | 0
        }
    }

    var n = this.PineJsCalendar ? this.PineJsCalendar : require("./calendar.js"), st, d, a;
    return u.prototype.alignTime = rt, u.prototype.indexOfBar = function (t) {
        return t < this.sessionStart ? -1 : t >= this.sessionEnd ? -2 : n.time_minutes_diff(t, this.sessionStart) / this.period | 0
    }, u.prototype.startOfBar = function (t) {
        return-2 === t ? this.sessionEnd : 0 > t ? this.prevSessionEnd + n.time_minutes(this.period * t) : this.sessionStart + n.time_minutes(this.period * t)
    }, u.prototype.isLastBar = function (t, i) {
        var r = this.sessionStart + n.time_minutes(this.period * (t + 1) - 1);
        return i >= r
    }, u.prototype.moveTo = function (t) {
        var i = this.session.timezone, r = n.utc_to_cal(i, t), u;
        if (t = this.session.spec, u = v(t, r, "front", this.session.timezone), this.sessionStart = n.cal_to_utc(i, r), this.sessionEnd = this.sessionStart + n.time_minutes(u), r = n.utc_to_cal(i, this.sessionStart - n.time_minutes(this.period)), t = v(t, r, "back", this.session.timezone), i = n.cal_to_utc(i, r), this.prevSessionEnd = i + n.time_minutes(t), i == this.sessionStart)throw"Internal error 0x12";
    }, i.prototype.alignTime = rt, i.prototype.indexOfBar = function (n) {
        return n < this.periodStart ? -1 : n >= this.periodEnd ? -2 : 0
    }, i.prototype.startOfBar = function (n) {
        return-2 === n || 0 < n ? this.periodEnd : -3 === n ? this.periodLastBarStart : -1 === n ? this.prevPeriodStart : this.periodStart
    }, i.prototype.isLastBar = function (n, t) {
        return t >= this.periodLastBarStart
    }, i.prototype.moveTo = function (t) {
        var i;
        t = n.utc_to_cal(this.sessionSrc.timezone, t);
        i = ut(this.sessionSrc.spec, t);
        t = n.get_year(i);
        var u = (this.builder.indexOfPeriod(i) / this.period | 0) * this.period, e = u + this.period, i = this.sessionTgt.spec, r = this.sessionTgt.timezone;
        this.periodStart = f(r, i, this.builder.startOfPeriod(r, u, t));
        this.prevPeriodStart = f(r, i, this.builder.startOfPeriod(r, u - this.period, t), "back");
        t = this.builder.startOfPeriod(r, e, t);
        this.periodEnd = f(r, i, t);
        n.add_date(t, -1);
        this.moveToPrevWorkDay(this.sessionTgt.spec, t);
        this.periodLastBarStart = f(r, i, t);
        (this.periodLastBarStart < this.periodStart || this.periodLastBarStart === this.periodEnd) && (this.periodLastBarStart = this.periodStart)
    }, i.prototype.moveToPrevWorkDay = function (t, i) {
        for (; t.isWeekEnd(n.get_day_of_week(i));)n.add_date(i, -1)
    }, h.prototype.indexOfPeriod = function (t) {
        return n.get_day_of_year(t) - 1
    }, h.prototype.startOfPeriod = function (t, i, r) {
        return t = n.get_cal(t, r, n.JANUARY, 1), r = n.get_days_per_year(t), n.add_date(t, Math.min(i, r)), t
    }, c.prototype.uber = new h, c.prototype.indexOfPeriod = function (n) {
        return this.uber.indexOfPeriod(n) - et(this.sessionsSpec, n)
    }, c.prototype.startOfPeriod = function (t, i, r) {
        function h(n, t) {
            for (var r = 0, i = n; 7 > i && (u.sessionsSpec.isWeekEnd(y(u.sessionsSpec, i)) || !(0 > --t)); ++i)r++;
            return r
        }

        function c(n, t, i) {
            var r = 0, f = 0, e;
            for (n = i % (7 - u.sessionsSpec.weekEndsCount()) - (0 == n ? 0 : t.businessDays); 7 > f && 0 < n; ++f)e = u.sessionsSpec.isWeekEnd(y(u.sessionsSpec, f)), r = r + (e ? 1 : 0), n -= e ? 0 : 1;
            return r = t.weekEnds + r, t = (i - t.businessDays) / (7 - u.sessionsSpec.weekEndsCount()) | 0, t = r + u.sessionsSpec.weekEndsCount() * t, i + t
        }

        0 > i && (r--, i = ht(this.sessionsSpec, r) + i);
        var u = this, f = n.get_cal(t, r, n.JANUARY, 1), f = e(this.sessionsSpec, f), o = new function (n, t) {
            this.weekEnds = s(n, t, 7);
            this.calendarDays = 7 - t;
            this.businessDays = this.calendarDays - this.weekEnds
        }(this.sessionsSpec, f);
        return i = i < o.businessDays ? h(f, i) : c(f, o, i), this.uber.startOfPeriod(t, i, r)
    }, l.prototype.indexOfPeriod = function (n) {
        return this.builder().indexOfPeriod(n)
    }, l.prototype.startOfPeriod = function (n, t, i) {
        return this.builder().startOfPeriod(n, t, i)
    }, l.prototype.builder = function () {
        return this._builder || (this._builder = this.session.spec.hasWeekEnds() ? new c(this.session.spec) : new h), this._builder
    }, p.prototype.indexOfPeriod = function (n) {
        return ft(this.session.spec, n)
    }, p.prototype.startOfPeriod = function (t, i, r) {
        var u = n.get_cal(t, r, n.JANUARY, 1), f = e(this.session.spec, u);
        return(i = 0 === f ? 7 * i : 7 * (i + 1) - f, f = n.get_days_per_year(u), i > f) ? this.startOfPeriod(t, 0, r + 1) : (n.add_date(u, i), u)
    }, w.prototype.indexOfPeriod = function (t) {
        return n.get_month(t)
    }, w.prototype.startOfPeriod = function (t, i, r) {
        if (0 > i) {
            var u = (-i + 11) / 12 | 0;
            r -= u;
            i += 12 * u
        }
        return i > n.DECEMBER ? n.get_cal(t, r + 1, n.JANUARY, 1) : (t = n.get_cal(t, r, i, 1), i = e(this.session.spec, t), 4 < i && n.add_date(t, 7 - i), t)
    }, t.prototype.start = function () {
        return 0 > this._start ? this._start + n.minutesPerDay : this._start
    }, t.prototype.isOvernight = function () {
        return 0 > this._start
    }, t.prototype.dayOfWeek = function () {
        return this._dayOfWeek
    }, t.prototype.length = function () {
        return this._length
    }, t.prototype.weight = function () {
        return this._dayOfWeek * n.minutesPerDay + this._start
    }, t.prototype.compareTo = function (n) {
        var t = this.weight(), i = t + this._length;
        return n = n.weight(), t <= n && n < i ? 0 : t > n ? 1 : -1
    }, st = [n.MONDAY, n.TUESDAY, n.WEDNESDAY, n.THURSDAY, n.FRIDAY], d = [n.SUNDAY, n.MONDAY, n.TUESDAY, n.WEDNESDAY, n.THURSDAY, n.FRIDAY, n.SATURDAY], r.prototype.addSessionEntry = function (i, r, u) {
        u <= r && 0 != r && (r -= n.minutesPerDay);
        this.entries.push(new t(i, r, u == r ? n.minutesPerDay : u - r))
    }, r.prototype.isWeekEnd = function (n) {
        var i = k(this.entries, new t(n, 0, 0), function (n, t) {
            return n.dayOfWeek() - t.dayOfWeek()
        });
        return 0 > i || this.entries[i].dayOfWeek() != n
    }, r.prototype.hasWeekEnds = function () {
        return 0 < this.weekEndsCount()
    }, r.prototype.weekEndsCount = function () {
        if (void 0 == this._weekEndsCount) {
            var n = [];
            this.entries.forEach(function (t) {
                n[t.dayOfWeek()] = 1
            }, this);
            this._weekEndsCount = 7 - n.reduce(function (n, t) {
                return n + (t || 0)
            }, 0)
        }
        return this._weekEndsCount
    }, r.prototype.indexOfSession = function (n, i) {
        var r = k(this.entries, new t(n, i, 0), ot);
        return-1 === r ? 0 : r
    }, r.prototype.findSession = function (n, t) {
        return this.entries[this.indexOfSession(n, t)]
    }, b.prototype.init = function (t, i) {
        return this.timezone = "string" == typeof t ? n.get_timezone(t) : t, this.spec = new r(i), this
    }, a = {PRE_SESSION: -1, POST_SESSION: -2, LASTBAR_SESSION: -3, newBarBuilder: g, Session: b, alignDWMPeriodsBack: function (t, i, r, u, e) {
        t = n.get_timezone(t);
        var o = (new b).init(t, i);
        return i = o.spec, r = nt(r, o), e = n.utc_to_cal(t, e), o = ut(i, e), e = n.get_year(o), u = r.indexOfPeriod(o) - u, f(t, i, r.startOfPeriod(t, u, e))
    }, extrapolateBarsBackToTime: function (n, t, i) {
        return o(n, t, "back", function (n, t) {
            return t <= i
        })
    }, extrapolateBarsBackByCount: it, extrapolateBarsFrontByCount: tt, extrapolateBarsFrontToTime: function (n, t, i) {
        return o(n, t, "front", function (n, t) {
            return t > i
        })
    }, lower_bound: k, isTradingNow: function (t, i) {
        var u = g("", 1, i), r = PineJsCalendar.utc_to_cal(i.timezone, t), r = n.get_day_of_week(r);
        return i.spec.hasWeekEnds() && i.spec.isWeekEnd(r) ? !1 : (r = it(u, t, 1)[0], 12e4 > tt(u, t, 1)[0] - r)
    }}, "undefined" != typeof module && module.exports ? module.exports = a : this.PineJsBarBuilder = a, a
}.call(this);
this.PineJS = PineJS = function () {
    function l(n, t, i, r, u) {
        if (i = u, u = 0, isNaN(n.get(t - 1)))return{index: NaN, value: NaN};
        for (var f = 0; f < t; ++f)r(n.get(f), i) && (u = f, i = n.get(f));
        return{index: u, value: i}
    }

    function b(n, t) {
        return 100 * n / t
    }

    function i(t, i, r, u, f) {
        this._areaRight = t;
        this._areaLeft = i;
        this._pivotType = r;
        this._series = u;
        this._currentIndex = f.new_var(0);
        this._currentValue = f.new_var(NaN);
        this._pivotIndex = f.new_var(-1);
        this._index = n.n(f);
        this._isNewBar = f.symbol.isNewBar;
        t = this._currentIndex.get(1);
        i = this._currentValue.get(1);
        r = this._pivotIndex.get(1);
        1 < this._index && (this._currentIndex.set(t), this._currentValue.set(i), this._pivotIndex.set(r))
    }

    function e(t, r, u) {
        this._deviation = t;
        t = u.new_var(n.high(u));
        var f = u.new_var(n.low(u));
        t.get(2 * r + 1);
        f.get(2 * r + 1);
        this._pivotHigh = new i(r, r, i.HIGH, t, u);
        this._pivotLow = new i(r, r, i.LOW, f, u);
        this._lastVal = u.new_var(NaN);
        this._lastIndex = u.new_var(-1);
        this._lastType = u.new_var();
        this._index = n.n(u);
        this._isNewBar = u.symbol.isNewBar;
        this._isBarClosed = u.symbol.isBarClosed;
        r = this._lastIndex.get(1);
        u = this._lastVal.get(1);
        t = this._lastType.get(1);
        1 < this._index && this.addPivot(r, u, t);
        this.processPivot(this._pivotHigh);
        this.processPivot(this._pivotLow)
    }

    function o(n) {
        this.symbol = n;
        this.vars = [];
        this.vars_index = 0;
        this.ctx = [];
        this.ctx_index = 0
    }

    function f(n) {
        this.mindepth = 0;
        this.original = NaN;
        this.modified = !1;
        this.symbol = n
    }

    function t(n, i, r, u) {
        this.periodBase = r;
        this.tickerid = n;
        this.period = i;
        this.index = -1;
        this.updatetime = this.volume = this.close = this.low = this.high = this.open = this.time = NaN;
        this.isBarClosed = this.isNewBar = !1;
        this.session = new c.Session;
        this.other_sessions = {};
        this.script = u;
        this.ticker = t.parseTicker(n);
        n = t.parsePeriod(i);
        this.resolution = n.resolution;
        this.interval = n.interval;
        this.bb_cache = {}
    }

    function s(n, t, i, r, u, f, e) {
        this.body = u;
        this.symbols = [];
        this.runner = r;
        this.inputCallback = e;
        this.out = f;
        this.ctx = new o(this.add_sym(n, t, i));
        this.init()
    }

    function u(n) {
        this.symbols = [];
        this.barsets = [];
        this.subscription = [];
        this.host = n;
        this.isRecalculated = !1;
        this.start()
    }

    function y(n) {
        this.runner = new u(n)
    }

    function h(n, t) {
        this.info = n;
        this.bars = t || [];
        this.isBarClosed = !0
    }

    function a(n, t) {
        this.period = n;
        this.generateEmptyBars = !!t
    }

    function p() {
    }

    function w() {
    }

    var r = this.PineJsCalendar ? this.PineJsCalendar : require("./calendar.js"), c = this.PineJsBarBuilder ? this.PineJsBarBuilder : require("./barbuilder.js"), n = {max_series_size: 5e3, n: function (n) {
        return n.symbol.index + 1
    }, nz: function (n, t) {
        return t = t || 0, isFinite(n) ? n : t
    }, na: function (n) {
        return 0 == arguments.length ? NaN : isNaN(n) ? 1 : 0
    }, isZero: function (n) {
        return 1e-10 >= Math.abs(n)
    }, toBool: function (t) {
        return isFinite(t) && !n.isZero(t)
    }, eq: function (t, i) {
        return n.isZero(t - i)
    }, neq: function (t, i) {
        return!n.eq(t, i)
    }, ge: function (t, i) {
        return n.isZero(t - i) || t > i
    }, gt: function (t, i) {
        return!n.isZero(t - i) && t > i
    }, lt: function (t, i) {
        return!n.isZero(t - i) && t < i
    }, le: function (t, i) {
        return n.isZero(t - i) || t < i
    }, and: function (t, i) {
        return isNaN(t) || isNaN(i) ? NaN : n.isZero(t) || n.isZero(i) ? 0 : 1
    }, or: function (t, i) {
        return isNaN(t) || isNaN(i) ? NaN : n.isZero(t) && n.isZero(i) ? 0 : 1
    }, not: function (t) {
        return isNaN(t) ? NaN : n.isZero(t) ? 1 : 0
    }}, v;
    return n.max = Math.max, n.min = Math.min, n.pow = Math.pow, n.abs = Math.abs, n.log = Math.log, n.log10 = function (n) {
        return Math.log(n) / Math.LN10
    }, n.sqrt = Math.sqrt, n.sign = function (t) {
        return isNaN(t) ? NaN : n.isZero(t) ? 0 : 0 < t ? 1 : -1
    }, n.exp = Math.exp, n.sin = Math.sin, n.cos = Math.cos, n.tan = Math.tan, n.asin = Math.asin, n.acos = Math.acos, n.atan = Math.atan, n.floor = Math.floor, n.ceil = Math.ceil, n.round = Math.round, n.avg = function (n, t) {
        if (2 === arguments.length)return(n + t) / 2;
        for (var r = 0, i = 0; i < arguments.length; i++)r += arguments[i];
        return r / arguments.length
    }, n.open = function (n) {
        return n.symbol.open
    }, n.high = function (n) {
        return n.symbol.high
    }, n.low = function (n) {
        return n.symbol.low
    }, n.close = function (n) {
        return n.symbol.close
    }, n.hl2 = function (n) {
        return(n.symbol.high + n.symbol.low) / 2
    }, n.hlc3 = function (n) {
        return(n.symbol.high + n.symbol.low + n.symbol.close) / 3
    }, n.ohlc4 = function (n) {
        return(n.symbol.open + n.symbol.high + n.symbol.low + n.symbol.close) / 4
    }, n.volume = function (n) {
        return n.symbol.volume
    }, n.time = function (n, t, i) {
        return n.symbol.bartime(t, i)
    }, n.period = function (n) {
        return n.symbol.period
    }, n.tickerid = function (n) {
        return n.symbol.tickerid
    }, n.ticker = function (n) {
        return n.symbol.ticker
    }, n.interval = function (n) {
        return n.symbol.interval
    }, n.isdwm = function (n) {
        return n.symbol.isdwm()
    }, n.isintraday = function (n) {
        return!n.symbol.isdwm()
    }, n.isdaily = function (n) {
        return"D" === n.symbol.resolution
    }, n.isweekly = function (n) {
        return"W" === n.symbol.resolution
    }, n.ismonthly = function (n) {
        return"M" === n.symbol.resolution
    }, n.year = function (t, i) {
        return n.timepart(t.symbol, r.YEAR, i)
    }, n.month = function (t, i) {
        return n.timepart(t.symbol, r.MONTH, i)
    }, n.weekofyear = function (t, i) {
        return n.timepart(t.symbol, r.WEEK_OF_YEAR, i)
    }, n.dayofmonth = function (t, i) {
        return n.timepart(t.symbol, r.DAY_OF_MONTH, i)
    }, n.dayofweek = function (t, i) {
        return n.timepart(t.symbol, r.DAY_OF_WEEK, i)
    }, n.hour = function (t, i) {
        return n.timepart(t.symbol, r.HOUR_OF_DAY, i)
    }, n.minute = function (t, i) {
        return n.timepart(t.symbol, r.MINUTE, i)
    }, n.second = function (t, i) {
        return n.timepart(t.symbol, r.SECOND, i)
    }, n.iff = function (t, i, r) {
        return n.not(t) ? r : i
    }, n.rising = function (n, t) {
        for (var i = 1; i < t + 1; ++i)if (n.get(i) > n.get(0))return 0;
        return 1
    }, n.falling = function (n, t) {
        for (var i = 1; i < t + 1; ++i)if (n.get(i) < n.get(0))return 0;
        return 1
    }, n.timepart = function (n, t, i) {
        return n = r.utc_to_cal(n.timezone, i || n.bartime()), r.get_part(n, t)
    }, n.rsi = function (t, i) {
        return n.isZero(i) ? 100 : n.isZero(t) ? 0 : 100 - 100 / (1 + t / i)
    }, n.sum = function (t, i, r) {
        return r = r.new_var(), t = n.nz(t.get()) + n.nz(r.get(1)) - n.nz(t.get(i)), r.set(t), t
    }, n.sma = function (t, i, r) {
        return r = n.sum(t, i, r), n.na(t.get(i - 1)) ? NaN : r / i
    }, n.rma = function (t, i, r) {
        var e = n.sum(t, i, r), f = i - 1, o = t.get(f), u;
        return r = r.new_var(), u = r.get(1), t = t.get(), i = n.na(o) ? NaN : n.na(u) ? e / i : (t + u * f) / i, r.set(i), i
    }, n.fixnan = function (n, t) {
        var i = t.new_var();
        return isNaN(n) ? i.get(1) : (i.set(n), n)
    }, n.tr = function (t) {
        var i = t.new_var(n.close(t));
        return n.max(n.max(n.high(t) - n.low(t), n.abs(n.high(t) - i.get(1))), n.abs(n.low(t) - i.get(1)))
    }, n.atr = function (t, i) {
        var r = i.new_var(n.tr(i));
        return n.sma(r, t, i)
    }, n.ema = function (t, i, r) {
        var e = n.sum(t, i, r), f, u;
        return r = r.new_var(), f = t.get(0), t = t.get(i - 1), u = r.get(1), i = n.na(t) ? NaN : n.na(u) ? e / i : 2 * (f - u) / (i + 1) + u, r.set(i), i
    }, n.wma = function (n, t, i) {
        i = 0;
        for (var r = t = Math.round(t); 0 <= r; r--)i += (t - r) * n.get(r);
        return 2 * i / (t * (t + 1))
    }, n.vwma = function (t, i, r) {
        var u = r.new_var(n.volume(r));
        return t = r.new_var(t.get(0) * n.volume(r)), n.sma(t, i, r) / n.sma(u, i, r)
    }, n.swma = function (n) {
        return(n.get(0) + 2 * n.get(1) + 2 * n.get(2) + n.get(3)) / 6
    }, n.lowestbars = function (t, i, r) {
        return-l(t, i, r, function (t, i) {
            return n.lt(t, i)
        }, Number.MAX_VALUE).index
    }, n.lowest = function (t, i, r) {
        return l(t, i, r, function (t, i) {
            return n.lt(t, i)
        }, Number.MAX_VALUE).value
    }, n.highestbars = function (t, i, r) {
        return-l(t, i, r, function (t, i) {
            return n.gt(t, i)
        }, Number.MIN_VALUE).index
    }, n.highest = function (t, i, r) {
        return l(t, i, r, function (t, i) {
            return n.gt(t, i)
        }, Number.MIN_VALUE).value
    }, n.cum = function (t, i) {
        var r = i.new_var(), u = n.nz(r.get(1)) + t;
        return r.set(u), u
    }, n.accdist = function (t) {
        n.open(t);
        var i = n.high(t), r = n.low(t), u = n.close(t), f = n.volume(t);
        return n.cum(u == i && u == r || i == r ? 0 : f * (2 * u - r - i) / (i - r), t)
    }, n.correlation = function (t, i, r, u) {
        var f = n.sma(t, r, u), e = n.sma(i, r, u), o = u.new_var(t.get() * i.get());
        return(n.sma(o, r, u) - f * e) / Math.sqrt(n.variance2(t, f, r) * n.variance2(i, e, r))
    }, n.stoch = function (t, i, r, u, f) {
        return i = n.highest(i, u), r = n.lowest(r, u), n.fixnan(b(t.get() - r, i - r), f)
    }, n.tsi = function (t, i, r, u) {
        var f = u.new_var(n.change(t));
        return t = u.new_var(n.abs(n.change(t))), f = u.new_var(n.ema(f, r, u)), r = u.new_var(n.ema(t, r, u)), f = n.ema(f, i, u), i = n.ema(r, i, u), f / i
    }, n.cross = function (n, t, i) {
        return isNaN(n) || isNaN(t) ? !1 : (n = i.new_var(function (n) {
            return 0 > n ? -1 : 0 == n ? 0 : 1
        }(n - t)), !isNaN(n.get(1)) && n.get(1) != n.get())
    }, n.linreg = function (n, t, i) {
        for (var r = 0, e = 0, o = 0, s = 0, u = 0; u < t; ++u)var h = n.get(u), f = t - 1 - u + 1, r = r + f, e = e + h, o = o + f * f, s = s + h * f;
        return n = (t * s - r * e) / (t * o - r * r), e / t - n * r / t + n + n * (t - 1 - i)
    }, n.sar = function (t, i, r, u) {
        function v(n, i) {
            var r = o.get();
            return h.set(n), o.set(i), s.set(1e3 * t), a.set(r), r
        }

        var f = n.high(u), e = n.low(u), y = n.close(u), c = u.new_var(f), l = u.new_var(e), p = u.new_var(y).get(1), l = l.get(1), c = c.get(1), o = u.new_var(), h = u.new_var(), s = u.new_var(), a = u.new_var();
        if (u = a.get(1), isNaN(p))return NaN;
        if (isNaN(u) && (n.ge(y, p) ? (h.set(1), o.set(Math.max(f, c)), u = Math.min(e, l)) : (h.set(-1), u = Math.max(f, c), o.set(Math.min(e, l))), s.set(1e3 * t)), 1 == h.get()) {
            if (n.gt(f, o.get()) && (o.set(f), s.set(Math.min(s.get() + 1e3 * i, 1e3 * r))), n.le(e, u))return v(-1, e)
        } else if (n.lt(e, o.get()) && (o.set(e), s.set(Math.min(s.get() + 1e3 * i, 1e3 * r))), n.ge(f, u))return v(1, f);
        return i = u + s.get() * (o.get() - u) / 1e3, 1 == h.get() ? n.ge(i, e) && (i = e - 1e-7) : n.le(i, f) && (i = f + 1e-7), a.set(i), i
    }, n.alma = function (n, t, i, r) {
        var o, u, e, f;
        for (i = Math.floor(i * (t - 1)), o = t / r * (t / r), r = [], f = 0, u = 0; u < t; ++u)e = Math.exp(-1 * Math.pow(u - i, 2) / (2 * o)), f = f + e, r.push(e);
        for (u = 0; u < t; ++u)r[u] /= f;
        for (u = i = 0; u < t; ++u)i += r[u] * n.get(t - u - 1);
        return i
    }, n.wvap = function (n) {
        return n.get() - n.get(1)
    }, n.change = function (n) {
        return n.get() - n.get(1)
    }, n.roc = function (n, t) {
        var i = n.get(t);
        return 100 * (n.get() - i) / i
    }, n.dev = function (t, i, r) {
        return r = n.sma(t, i, r), n.dev2(t, i, r)
    }, n.dev2 = function (t, i, r) {
        for (var f = 0, u = 0; u < i; u++)var e = t.get(u), e = n.abs(e - r), f = f + e;
        return f / i
    }, n.stdev = function (t, i, r) {
        return t = n.variance(t, i, r), n.sqrt(t)
    }, n.variance = function (t, i, r) {
        return r = n.sma(t, i, r), n.variance2(t, r, i)
    }, n.variance2 = function (t, i, r) {
        for (var f = 0, u = 0; u < r; u++)var e = t.get(u), e = n.abs(e - i), f = f + e * e;
        return f / r
    }, n.percentrank = function (t, i) {
        var f;
        if (n.na(t.get(i - 1)))return NaN;
        for (var u = 0, e = t.get(), r = 1; r < i; r++)f = t.get(r), n.ge(e, f) && u++;
        return 100 * u / i
    }, i.LOW = 0, i.HIGH = 1, i.prototype.isPivotFound = function () {
        return-1 != this._pivotIndex.get()
    }, i.prototype.pivotIndex = function () {
        return this._pivotIndex.get()
    }, i.prototype.currentValue = function () {
        return this._currentValue.get()
    }, i.prototype.pivotType = function () {
        return this._pivotType
    }, i.prototype.reset = function () {
        this._currentValue.set(NaN);
        this._currentIndex.set(0);
        this._pivotIndex.set(-1)
    }, i.prototype.isRightSideOk = function (n) {
        return n - this._currentIndex.get() == this._areaRight
    }, i.prototype.isViolate = function (n, t) {
        if (1 > n || isNaN(this._currentValue.get()))return!0;
        var r = this._series.get(this._index - n);
        return isNaN(r) ? !0 : r === this._currentValue.get() ? t : this._pivotType == i.HIGH ? r > this._currentValue.get() : r < this._currentValue.get()
    }, i.prototype.processPoint = function (n) {
        this.isViolate(n, !1) && (this._currentValue.set(this._series.get()), this._currentIndex.set(n))
    }, i.prototype.isRestartNeeded = function (n) {
        return n - this._currentIndex.get() > this._areaRight
    }, i.prototype.update = function () {
        if (this._isNewBar && this.isPivotFound() && this.reset(), this.processPoint(this._index), this.isRightSideOk(this._index)) {
            if (-1 == this._pivotIndex.get()) {
                for (var t = !0, n = 0; n < this._areaLeft; ++n)if (this.isViolate(this._currentIndex.get() - 1 - n, !0)) {
                    t = !1;
                    break
                }
                t && this._pivotIndex.set(this._currentIndex.get())
            }
        } else-1 != this._pivotIndex.get() && this._pivotIndex.set(-1);
        if (this.isRestartNeeded(this._index))for (this.reset(), n = 0; n <= this._areaRight; ++n)this.processPoint(this._index - this._areaRight + n)
    }, e.prototype.addPivot = function (n, t, i) {
        this._lastIndex.set(n);
        this._lastVal.set(t);
        this._lastType.set(i)
    }, e.prototype.updatePivot = function (n, t) {
        this._lastIndex.set(n);
        this._lastVal.set(t)
    }, e.prototype.lastPrice = function () {
        return this._lastVal.get()
    }, e.prototype.lastIndex = function () {
        return this._lastIndex.get()
    }, e.prototype.addPoint = function (n, t, r) {
        if (isNaN(this._lastVal.get()))this.addPivot(n, t, r); else {
            var u = this._lastVal.get();
            this._lastType.get() == r ? (r === i.HIGH ? t > u : t < u) && this.updatePivot(n, t) : Math.abs(u - t) / t > this._deviation && this.addPivot(n, t, r)
        }
    }, e.prototype.processPivot = function (n) {
        n.update();
        this._isBarClosed && n.isPivotFound() && this.addPoint(n.pivotIndex(), n.currentValue(), n.pivotType())
    }, n.zigzag = function (n, t, i) {
        return new e(n, t, i).lastPrice()
    },n.zigzagbars = function (t, i, r) {
        return t = new e(t, i, r), -1 == t.lastIndex() ? NaN : t.lastIndex() - n.n(r)
    },o.prototype.new_sym = function (n, t, i) {
        return this.symbol.script.add_sym(n, t, i)
    },o.prototype.select_sym = function (n) {
        this.symbol = this.symbol.script.get_sym(n)
    },o.prototype.new_var = function (n) {
        var t = this.vars;
        return t.length <= this.vars_index && t.push(new f(this.symbol)), t = t[this.vars_index++], 0 < arguments.length && t.set(n), t
    },o.prototype.new_ctx = function () {
        return this.ctx.length <= this.ctx_index && this.ctx.push(new o(this.symbol)), this.ctx[this.ctx_index++]
    },o.prototype.prepare = function (n) {
        for (var t = this.vars_index = this.ctx_index = 0; t < this.vars.length; t++)this.vars[t].prepare(n);
        for (t = 0; t < this.ctx.length; t++)this.ctx[t].prepare(n)
    },o.prototype.stop = function () {
        this.vars = this.symbol = null
    },f.prototype.valueOf = function () {
        return this.get(0)
    },f.prototype.get = function (t) {
        return isNaN(t) && (t = 0), t = t || 0, this.hist ? t >= this.hist.length ? (console.error("not enough depth: " + this), NaN) : this._get(t) : (this.mindepth = n.max(this.mindepth, t), NaN)
    },f.prototype._get = function (n) {
        return n = this.hist_pos - n, 0 > n && (n += this.hist.length), this.hist[n]
    },f.prototype.set = function (n) {
        this.hist && (this.hist[this.hist_pos] = n, this.modified = !0)
    },f.prototype.prepare = function (n) {
        n === this.symbol && (n.isNewBar ? (this.original = this.get(0), !this.modified && this.hist || this.add_hist()) : this.set(this.original), this.modified = !1)
    },f.prototype.add_hist = function () {
        if (!this.hist) {
            for (var t = n.na(this.mindepth) ? n.max_series_size : n.min(this.mindepth + 1, n.max_series_size), t = Math.round(t), r = Array(t), i = 0; i < t; i++)r[i] = NaN;
            this.hist = r;
            this.hist_pos = -1
        }
        this.hist_pos = (this.hist_pos + 1) % this.hist.length;
        this.hist[this.hist_pos] = this.original
    },f.prototype.adopt = function (t, i, r) {
        this.hist || (this.mindepth = NaN);
        var u = i.get(), u = t.indexOf(u);
        return 0 !== r && (i = i.get(1), n.na(i) || (t = t.indexOf(i), u = u === t ? -1 : u)), 0 > u ? NaN : this._get(u)
    },f.prototype.indexOf = function (t) {
        if (!this.hist)return this.mindepth = NaN, -1;
        if (n.na(t))return-1;
        for (var r = this.symbol.index + 1, i = this.hist.length, u = 0, r = (r > i ? i : r) - 1, i = (r + u) / 2 | 0; ;) {
            if (this._get(i) > t) {
                if (u = i + 1, u > r)return i + 1
            } else if (r = i - 1, u > r)return i;
            i = (r + u) / 2 | 0
        }
    },t.parseTicker = function (n) {
        var t = n.indexOf(":");
        return-1 === t ? n : n.substr(t + 1)
    },t.parsePeriod = function (n) {
        var i = (n + "").slice(0), u, r;
        return 0 <= i.indexOf(",") && (n = i.split(","), u = t.parsePeriod(n[1]), i = n[0]), n = !1, r = i[i.length - 1], -1 === "DWM".indexOf(r) && (n = !0, r = ""), i = parseInt(n ? i : 1 < i.length ? i.slice(0, i.length - 1) : 1), {resolution: r, interval: i, pureResolution: [i, r].join(""), isIntraday: n, range: u}
    },t.newBarBuilder = function (n, i, r) {
        return n = t.parsePeriod(n), c.newBarBuilder(n.resolution, n.interval, i, r)
    },t.newSession = function (n, t) {
        var i = r.get_timezone(n);
        return(new c.Session).init(i, t)
    },t.prototype.set_symbolinfo = function (n) {
        n || console.error("WARN: symbolinfo isn't defined for " + this.tickerid);
        this.info = n;
        this.timezone = r.get_timezone(n.timezone);
        this.session.init(this.timezone, n.session);
        for (var t in this.other_sessions)this.other_sessions.hasOwnProperty(t) && this.other_sessions[t].init(this.timezone, t)
    },t.prototype.get_session = function (n) {
        if (!n)return this.session;
        var t = this.other_sessions[n];
        return t || (t = new c.Session, this.other_sessions[n] = t), t
    },t.prototype.isdwm = function () {
        return"" !== this.resolution
    },t.prototype.enable_dwm_aligning = function (n, i) {
        this.dwm_aligner = t.newBarBuilder(this.period, n, i)
    },t.prototype.bartime = function (n, i) {
        var e = this.time, f, u;
        if (n && (f = n, i && (f += i), u = this.bb_cache[f], u || (u = this.get_session(i), u = t.newBarBuilder(n, u), this.bb_cache[f] = u), e = u.alignTime(e)), !this.isdwm() || isNaN(e))return e;
        var f = r.utc_to_cal(this.timezone, e), s = this.session.spec, o = r.get_day_of_week(f), u = r.get_minutes_from_midnight(f), o = s.findSession(o, u), s = o.isOvernight(), u = o.start() <= u;
        return!s || !u ? e : (r.add_date(f, 1), r.cal_to_utc(this.timezone, f))
    },t.prototype.lastbar = function (n) {
        var t, i;
        isNaN(n.time) || (t = n.time, this.dwm_aligner && (this.dwm_aligner.moveTo(t), t = this.dwm_aligner.startOfBar(0)), i = this.time !== t, i && 0 <= this.index && !this.isBarClosed && (this.isNewBar = !1, this.isBarClosed = !0, this.script.calc(this)), this.time = t, this.open = n.open, this.high = n.high, this.low = n.low, this.close = n.close, this.volume = n.volume, this.updatetime = n.updatetime, this.isNewBar = i, this.isBarClosed = n.isBarClosed, this.isNewBar && this.index++, this.script.calc(this))
    },s.prototype.calc = function (n) {
        var t = this.ctx, i = this.body;
        t.prepare(n);
        n = i.main(t, this.inputCallback);
        !isNaN(t.symbol.time) && this.out && this.out(t.symbol, n)
    },s.prototype.init = function () {
        var t = this.ctx, n = this.body;
        n.init && n.init(t, this.inputCallback);
        n.main(t, this.inputCallback)
    },s.prototype.add_sym = function (n, i, r) {
        return n = this.runner.add_sym(n, i, r, this), this.symbols.push(n), n.isdwm() && (t.inputSessionForDWM || 1 < this.symbols.length) && n.enable_dwm_aligning(this.symbols[0].session, t.inputSessionForDWM || n.session), n
    },s.prototype.stop = function () {
        this.symbols = null;
        this.ctx.stop();
        this.ctx = null
    },s.prototype.get_sym = function (n) {
        return this.symbols[n]
    },u.prototype.add_sym = function (n, i, r, u) {
        return n = new t(n, i, r, u), this.symbols.push(n), n
    },u.prototype.get_sym = function (n) {
        return this.symbols[n]
    },u.prototype.start = function () {
        function f(t, r) {
            var f = u.feed.subscribe(t.tickerid, t.period, t.periodBase, function (n) {
                e.update(r, n)
            }, n.onErrorCallback, n.symbolInfo, n.rangeExtension);
            i.push(f)
        }

        var n = this.host;
        this._script = new s(n.tickerid, n.period, n.periodBase || n.period, this, n.body, n.out, n.input);
        for (var e = this, i = [], r = this.symbols, t = 0; t < r.length; t++)f(r[t], t);
        this.subscription = i
    },u.prototype.stop = function () {
        var t = this.subscription, n;
        if (t || this._script) {
            for (n = 0; n < t.length; n++)u.feed.unsubscribe(t[n]);
            this.subscription = null;
            this._script.stop();
            this.symbols = this._script = null
        } else console.warn("Recurring script engine stop happened.")
    },u.prototype.update = function (n, t) {
        var i, r;
        t ? (i = this.symbols[n], this.isRecalculated ? (r = t.bar(t.count() - 1), r.isBarClosed = t.isLastBarClosed(), i.lastbar(r)) : this.barsets[n] || (this.barsets[n] = t, i.set_symbolinfo(t.symbolinfo()), this.recalc())) : console.error("Unexpected barset = null")
    },u.prototype.recalc = function () {
        for (var u, t = this.symbols, n = 0; n < t.length; n++)if (!this.barsets[n])return;
        for (n = t.length - 1; 0 <= n; n--)for (var e = t[n], r = this.barsets[n], f = r.count(), i = 0; i < f; i++)u = r.bar(i), u.isBarClosed = i === f - 1 ? r.isLastBarClosed() : !0, e.lastbar(u);
        this.isRecalculated = !0;
        this.host.recalc()
    },u.feed = {subscribe: function () {
        console.error("must be initialized with setupFeed")
    }, unsubscribe: function () {
        console.error("must be initialized with setupFeed")
    }},y.prototype.stop = function () {
        this.runner.stop()
    },h.prototype.symbolinfo = function () {
        return this.info
    },h.prototype.isLastBarClosed = function () {
        return this.isBarClosed
    },h.prototype.bar = function (n) {
        return this.bars[n]
    },h.prototype.count = function () {
        return this.bars.length
    },h.prototype.add = function (n, t) {
        var i = this.bars, r = i.length, u = n.time, f = 0 === r ? NaN : i[r - 1].time;
        0 === r || f < u ? i.push(n) : f === u ? i[r - 1] = n : console.error("time order violation, prev: " + new Date(f).toUTCString() + ", cur: " + new Date(u).toUTCString());
        this.isBarClosed = !!t
    },a.prototype.init = function (n) {
        this.bb = t.newBarBuilder(this.period, n.symbol.session);
        this.bbEmptyBars = this.generateEmptyBars ? t.newBarBuilder(this.period, n.symbol.session) : void 0
    },a.prototype.extrapolate = function (n, t) {
        if (!isNaN(n) && !isNaN(t))return c.extrapolateBarsFrontToTime(this.bbEmptyBars, n, t)
    },a.prototype.main = function (t) {
        var e = t.symbol.time, r = this.bb.alignTime(e), o = t.new_var(r), i = n.na(r), u = o.get(1), f = n.na(u) ? 1 : n.neq(r, u), o = t.new_var(), a = t.new_var(), v = t.new_var(), y = t.new_var(), s = o.get(1), h = a.get(1), c = v.get(1), l = y.get(1), s = i ? NaN : f ? n.open(t) : s, h = i ? NaN : f ? n.high(t) : n.max(n.high(t), h), c = i ? NaN : f ? n.low(t) : n.min(n.low(t), c), p = i ? NaN : n.close(t), l = i ? NaN : f ? n.volume(t) : n.volume(t) + l, i = i ? NaN : e, e = t.symbol.isBarClosed && this.bb.isLastBar(e), u = this.generateEmptyBars && f ? this.extrapolate(u, r) : void 0;
        return t = t.new_var(n.close(t)).get(1), t = u instanceof Array ? t : NaN, o.set(s), a.set(h), v.set(c), y.set(l), [r, s, h, c, p, l, i, e, u, t]
    },p.prototype.main = function (t) {
        var r = t.new_var(n.open(t)), u = t.new_var(n.close(t)), i = r.get(1), f = u.get(1), u = n.ohlc4(t), i = n.na(r.get(1)) ? (n.open(t) + n.close(t)) / 2 : (i + f) / 2;
        r.set(i);
        var r = n.max(n.high(t), n.max(i, u)), f = n.min(n.low(t), n.min(i, u)), e = n.volume(t);
        return t = t.symbol, [t.time, i, r, f, u, e, t.updatetime, t.isBarClosed]
    },w.prototype.main = function (t) {
        var i = n.open(t), r = n.high(t), u = n.low(t), f = n.close(t);
        return t = n.volume(t), [i, r, u, f, t]
    },v = {Std: n, Series: f, Symbol: t, SymbolInfo: function (n, t) {
        this.timezone = n || "America/New_York";
        this.session = t || "0000-0000"
    }, StudyEngine: y, BarSet: h, OHLCV: w, BarBuilder: a, HeikenAshi: p, setupFeed: function (n, i) {
        u.feed = n;
        i && (t.inputSessionForDWM = t.newSession("UTC", "24x7"))
    }},"undefined" != typeof module && module.exports ? module.exports = v : this.PineJS = v,v
}(this);
PineJSFeed = function () {
    function n(n) {
        this.host = n;
        this.cache = {}
    }

    function o(n) {
        return n.has_empty_bars || n.force_session_rebuild
    }

    function s(n) {
        return 0 !== n.indexOf("=") ? {symbol: n} : (n = JSON.parse(n.slice(1)), n.type && (0 === n.type.indexOf("BarSetHeikenAshi@tv-basicstudies-") ? n.builder = new i.HeikenAshi : console.error("unknown builder type: " + n.type)), "string" != typeof n.symbol && (n.session = n.symbol.session || n.session, n.symbol = n.symbol.symbol), n)
    }

    var i = this.PineJS ? this.PineJS : require("./iljs.js"), h = this.PineJsBarBuilder ? this.PineJsBarBuilder : require("./barbuilder.js"), e = i.Symbol, c = i.StudyEngine, l = i.BarBuilder, a = i.BarSet, u, r, t, f;
    return n.prototype.getCache = function (n) {
        return this.cache[n]
    }, n.prototype.putCache = function (n, t) {
        this.cache[n] = t
    }, n.prototype.subscribe = function (n, t, i, r, u, f) {
        var e, s;
        return e = o(f) ? "_" : "", e = n + t + i + e, s = this.getCache(e), s || (s = this.createItem(n, t, i, f), this.putCache(e, s)), s.listeners.addListener(r, u), {key: e, listener: r}
    }, n.prototype.unsubscribe = function (n) {
        var t = this.getCache(n.key);
        t && t.listeners.removeListener(n.listener)
    }, n.prototype.removeUnused = function () {
        var t = [], n, i, r;
        for (n in this.cache)this.cache[n] && 0 === this.cache[n].listeners.listenersCount() && t.push(n);
        if (0 !== t.length) {
            for (n = 0; n < t.length; n++)i = t[n], r = this.cache[i], this.cache[i] = null, r.stop();
            this.removeUnused()
        }
    }, n.prototype.rebuildFrom = function (n, t, i) {
        if (n = e.parsePeriod(n), t = e.parsePeriod(t), "" !== n.resolution) {
            if (i.has_weekly_and_monthly)return n.resolution;
            if ("undefined" == typeof i.has_daily || i.has_daily)return"D";
            "" !== t.resolution && (t.resolution = "", t.interval = i.intraday_multipliers ? i.intraday_multipliers[0] : 1)
        }
        if ("undefined" != typeof i.has_intraday && !i.has_intraday)return"";
        if (t = "" !== n.resolution ? t.interval : "" === t.resolution ? Math.min(n.interval, t.interval) : n.interval, i.intraday_multipliers && (i = i.intraday_multipliers, -1 === i.indexOf(t))) {
            for (n = i.length - 1; 0 <= n; n--) {
                var r = i[n];
                if (0 == t % r)return"" + r
            }
            return""
        }
        return"" + t
    }, n.prototype.createItem = function (n, i, f, e) {
        var h = new t, c, a;
        return(n = s(n), n.builder) ? new r(h, n.symbol, i, f, n.builder, e) : (c = this.rebuildFrom(i, f, e), a = o(e), i !== c || a ? (f = e.has_empty_bars, e = $.extend({}, e), a && (e.has_empty_bars = !1, e.force_session_rebuild = !1), new r(h, n.symbol, i, c, new l(i, f), e)) : new u(h, n.symbol, i, f, n.session && "extended" !== n.session, this.host, e))
    }, u = function (n, t, i, r, u, f) {
        this.listeners = n;
        this.host = f;
        var e = this;
        this.host.resolve(t, function (n) {
            u && n.regular_session && (n.session = n.regular_session);
            var f = e.calculateFromTo(n, r || i, t);
            e.subs = e.host.subscribe(n, i, f, function (n) {
                e.listeners.fire(n)
            }, function (n) {
                e.listeners.onError(n)
            })
        }, function (n) {
            e.listeners.onError(n)
        })
    }, u.prototype.stop = function () {
        this.host.unsubscribe(this.subs)
    }, u.prototype.calculateFromTo = function (n, t, i) {
        var r = e.parsePeriod(t), u, f, o;
        return i = new Date, i = i.valueOf() - 6e4 * i.getTimezoneOffset(), i = n.expired ? PineJsCalendar.cal_to_utc(PineJsCalendar.get_timezone(n.timezone), new Date(1e3 * n.expiration_date)) || i : i, "" === r.resolution ? (u = r.interval, f = "D") : (u = 12 * ("D" === r.resolution ? 1 : "W" === r.resolution ? 5 : 30) * r.interval, f = "M"), r.range ? (u = r.range.interval, f = r.range.resolution) : this.host.calculateHistoryDepth && (r = this.host.calculateHistoryDepth(t, f, u)) && (r.intervalBack && (u = r.intervalBack), r.resolutionBack && (f = r.resolutionBack)), o = n.sessionString || n.session, r = h.alignDWMPeriodsBack(n.timezone, o, f, u, i), this.host.getRangeExtension && (u = this.host.getRangeExtension(), 0 < u && (n = PineJS.Symbol.newSession(n.timezone, o), t = PineJS.Symbol.newBarBuilder(t, n), r = PineJsBarBuilder.extrapolateBarsBackByCount(t, r, u)[0])), {from: r, to: i + 6e4}
    }, r = function (n, t, i, r, u, f) {
        if (this.listeners = n, this.isRecalculated = !1, "" === r)console.error("unsupported resolution for rebuild: " + i), this.listeners.onError("unsupported resolution for rebuild: " + i); else {
            var e = this;
            this.engine = new c({tickerid: t, period: r, periodBase: i, body: u, symbolInfo: f, recalc: function () {
                e._recalc()
            }, out: function (n, t) {
                e._out(n, t)
            }, onErrorCallback: function (n) {
                e.listeners.onError(n)
            }})
        }
    }, r.prototype.stop = function () {
        this.engine ? this.engine.stop() : console.error("Internal library error 0x1")
    }, r.prototype._recalc = function () {
        this.isRecalculated && console.error("recalc called twice!");
        this.barset && this.listeners.fire(this.barset);
        this.isRecalculated = !0
    }, r.prototype._out = function (n, t) {
        var r = t[0], o, u, f, i, e;
        if (!isNaN(r)) {
            if (r = {time: r, open: t[1], high: t[2], low: t[3], close: t[4], volume: t[5], updatetime: t[6]}, o = t[7], this.barset || (this.barset = new a(n.info)), u = t[8], u instanceof Array)for (f = 0; f < u.length; f++)i = t[9], e = u[f], this.barset.add({time: e, open: i, high: i, low: i, close: i, volume: 0, updatetime: e}, !0), this.isRecalculated && this.listeners.fire(this.barset);
            this.barset.add(r, o);
            this.isRecalculated && this.listeners.fire(this.barset)
        }
    }, t = function () {
        this.listeners = []
    }, t.prototype.listenersCount = function () {
        return this.listeners.reduce(function (n, t) {
            return n + (t ? 1 : 0)
        }, 0)
    }, t.prototype.addListener = function (n, t) {
        this.listeners.push({dataListener: n, onErrorCallback: t});
        this.barset && n(this.barset);
        this.errorMsg && t(this.errorMsg)
    }, t.prototype.removeListener = function (n) {
        var t = this.listeners.filter(function (t) {
            return t.dataListener == n
        });
        0 != t.length && (t = this.listeners.indexOf(t[0]), delete this.listeners[t])
    }, t.prototype.onError = function (n) {
        var t;
        this.errorMsg = n || "unspecified error";
        for (var r = this.listeners, u = r.length, i = 0; i < u; i++)if (t = r[i], t && t.onErrorCallback)t.onErrorCallback(n)
    }, t.prototype.fire = function (n) {
        var i;
        this.barset = n;
        for (var r = this.listeners, u = r.length, t = 0; t < u; t++)i = r[t], i && i.dataListener(n)
    }, f = {setupFeed: function (t, r) {
        n.instance = new n(t);
        i.setupFeed(n.instance, r)
    }, parseSymbol: s, unsubscribeUnused: function () {
        n.instance.removeUnused()
    }}, "undefined" != typeof module && module.exports ? module.exports = f : this.PineJSFeed = f, f
}(this);
D82.studyLibrary = [
    {name: "Accumulation/Distribution", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#808000"}}, precision: 4, inputs: {}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Accumulation/Distribution", shortDescription: "Accum/Dist", is_price_study: !1, inputs: [], id: "Accumulation/Distribution@tv-basicstudies-1", scriptIdPart: "", name: "Accumulation/Distribution"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return PineJS.Std.or(PineJS.Std.and(PineJS.Std.eq(n, t), PineJS.Std.eq(n, i)), PineJS.Std.eq(t, i)) ? 0 : (2 * n - i - t) / (t - i) * r
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this.f_0(PineJS.Std.close(this._context), PineJS.Std.high(this._context), PineJS.Std.low(this._context), PineJS.Std.volume(this._context));
            return[PineJS.Std.cum(i, this._context)]
        }
    }},
    {name: "Aroon", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF6A00"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0094FF"}}, precision: 4, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "Upper", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Lower", histogramBase: 0, joinPoints: !1}}, description: "Aroon", shortDescription: "Aroon", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Aroon@tv-basicstudies-1", scriptIdPart: "", name: "Aroon"}, constructor: function () {
        this.f_0 = function (n, t) {
            return 100 * (n + t) / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.high(this._context), u = i + 1, r = this._context.new_var(r), r = PineJS.Std.highestbars(r, u, this._context), r = this.f_0(r, i), f = PineJS.Std.low(this._context), f = this._context.new_var(f), u = PineJS.Std.lowestbars(f, u, this._context), i = this.f_0(u, i);
            return[r, i]
        }
    }},
    {name: "Advance/Decline", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 10}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Advance/Decline", shortDescription: "AD", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Advance/Decline@tv-basicstudies-1", scriptIdPart: "", name: "Advance/Decline"}, constructor: function () {
        this.f_0 = function (n, t) {
            return PineJS.Std.gt(n, t)
        };
        this.f_1 = function (n, t) {
            return PineJS.Std.lt(n, t)
        };
        this.f_2 = function (n, t) {
            return n / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this.f_0(PineJS.Std.close(this._context), PineJS.Std.open(this._context)), r = this._context.new_var(r), r = PineJS.Std.sum(r, i, this._context), u = this.f_1(PineJS.Std.close(this._context), PineJS.Std.open(this._context)), u = this._context.new_var(u), i = PineJS.Std.sum(u, i, this._context);
            return[this.f_2(r, i)]
        }
    }},
    {name: "Average True Range", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Average True Range", shortDescription: "ATR", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Average True Range@tv-basicstudies-1", scriptIdPart: "", name: "Average True Range"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), i = PineJS.Std.tr(this._context), i = this._context.new_var(i);
            return[PineJS.Std.sma(i, r, this._context)]
        }
    }},
    {name: "Awesome Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 1, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, palettes: {palette_0: {colors: {0: {color: "#FF0000", width: 1, style: 0}, 1: {color: "#008000", width: 1, style: 0}}}}, inputs: {}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", palette: "palette_0", target: "plot_0", type: "colorer"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Awesome Oscillator", shortDescription: "AO", is_price_study: !1, palettes: {palette_0: {colors: {0: {name: "Color 0"}, 1: {name: "Color 1"}}}}, inputs: [], id: "Awesome Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Awesome Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.f_1 = function (n) {
            return PineJS.Std.le(n, 0) ? 0 : 1
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.hl2(this._context), r = this._context.new_var(i), r = PineJS.Std.sma(r, 5, this._context), i = this._context.new_var(i), i = PineJS.Std.sma(i, 34, this._context), r = this.f_0(r, i), i = this._context.new_var(r), i = PineJS.Std.change(i), i = this.f_1(i);
            return[r, i]
        }
    }},
    {name: "Bollinger Bands Width", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 20, in_1: 2}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Bollinger Bands Width", shortDescription: "BBW", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "mult", defval: 2, type: "float", min: .001, max: 50}
    ], id: "Bollinger Bands Width@tv-basicstudies-1", scriptIdPart: "", name: "Bollinger Bands Width"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n * t
        };
        this.f_1 = function (n, t) {
            return n + t
        };
        this.f_2 = function (n, t) {
            return n - t
        };
        this.f_3 = function (n, t, i) {
            return(n - t) / i
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = PineJS.Std.close(this._context), i = this._input(0), f = this._input(1), r = this._context.new_var(u), r = PineJS.Std.sma(r, i, this._context), u = this._context.new_var(u), i = PineJS.Std.stdev(u, i, this._context), i = this.f_0(f, i), f = this.f_1(r, i), i = this.f_2(r, i);
            return[this.f_3(f, i, r)]
        }
    }},
    {name: "Balance of Power", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Balance of Power", shortDescription: "Balance of Power", is_price_study: !1, inputs: [], id: "Balance of Power@tv-basicstudies-1", scriptIdPart: "", name: "Balance of Power"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return(n - t) / (i - r)
        };
        this.main = function (n, t) {
            return this._context = n, this._input = t, [this.f_0(PineJS.Std.close(this._context), PineJS.Std.open(this._context), PineJS.Std.high(this._context), PineJS.Std.low(this._context))]
        }
    }},
    {name: "Bollinger Bands", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, filledAreasStyle: {fill_0: {color: "#000080", transparency: 90, visible: !0}}, inputs: {in_0: 20, in_1: 2}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Median", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Upper", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Lower", histogramBase: 0, joinPoints: !1}}, description: "Bollinger Bands", shortDescription: "BB", is_price_study: !0, filledAreas: [
        {id: "fill_0", objAId: "plot_1", objBId: "plot_2", type: "plot_plot", title: "Plots Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "mult", defval: 2, type: "float", min: .001, max: 50}
    ], id: "Bollinger Bands@tv-basicstudies-1", scriptIdPart: "", name: "Bollinger Bands"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n * t
        };
        this.f_1 = function (n, t) {
            return n + t
        };
        this.f_2 = function (n, t) {
            return n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = PineJS.Std.close(this._context), i = this._input(0), f = this._input(1), r = this._context.new_var(u), r = PineJS.Std.sma(r, i, this._context), u = this._context.new_var(u), i = PineJS.Std.stdev(u, i, this._context), i = this.f_0(f, i), f = this.f_1(r, i), i = this.f_2(r, i);
            return[r, f, i]
        }
    }},
    {name: "Bollinger Bands %B", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008080"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 1},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], filledAreasStyle: {fill_0: {color: "#008080", transparency: 90, visible: !0}}, inputs: {in_0: 20, in_1: 2}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Bollinger Bands %B", shortDescription: "BB %B", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "mult", defval: 2, type: "float", min: .001, max: 50}
    ], id: "Bollinger Bands %B@tv-basicstudies-1", scriptIdPart: "", name: "Bollinger Bands %B"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n * t
        };
        this.f_1 = function (n, t) {
            return n + t
        };
        this.f_2 = function (n, t) {
            return n - t
        };
        this.f_3 = function (n, t, i) {
            return(n - t) / (i - t)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = PineJS.Std.close(this._context), i = this._input(0), f = this._input(1), r = this._context.new_var(u), r = PineJS.Std.sma(r, i, this._context), e = this._context.new_var(u), i = PineJS.Std.stdev(e, i, this._context), i = this.f_0(f, i), f = this.f_1(r, i), r = this.f_2(r, i);
            return[this.f_3(u, r, f)]
        }
    }},
    {name: "Chaikin Money Flow", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 20}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Chaikin Money Flow", shortDescription: "CMF", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12}
    ], id: "Chaikin Money Flow@tv-basicstudies-1", scriptIdPart: "", name: "Chaikin Money Flow"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return PineJS.Std.or(PineJS.Std.and(PineJS.Std.eq(n, t), PineJS.Std.eq(n, i)), PineJS.Std.eq(t, i)) ? 0 : (2 * n - i - t) / (t - i) * r
        };
        this.f_1 = function (n, t) {
            return n / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this.f_0(PineJS.Std.close(this._context), PineJS.Std.high(this._context), PineJS.Std.low(this._context), PineJS.Std.volume(this._context)), r = this._context.new_var(r), r = PineJS.Std.sum(r, i, this._context), u = PineJS.Std.volume(this._context), u = this._context.new_var(u), i = PineJS.Std.sum(u, i, this._context);
            return[this.f_1(r, i)]
        }
    }},
    {name: "Chaikin Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 3, in_1: 10}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Chaikin Oscillator", shortDescription: "Chaikin Osc", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "short", defval: 3, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "long", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Chaikin Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Chaikin Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), i = PineJS.Std.accdist(this._context), f = this._context.new_var(i), r = PineJS.Std.ema(f, r, this._context), i = this._context.new_var(i), u = PineJS.Std.ema(i, u, this._context);
            return[this.f_0(r, u)]
        }
    }},
    {name: "Chande Kroll Stop", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 10, in_1: 1, in_2: 9}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "Long", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Short", histogramBase: 0, joinPoints: !1}}, description: "Chande Kroll Stop", shortDescription: "Chande Kroll Stop", is_price_study: !0, inputs: [
        {id: "in_0", name: "p", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "x", defval: 1, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "q", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Chande Kroll Stop@tv-basicstudies-1", scriptIdPart: "", name: "Chande Kroll Stop"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return n - t * i
        };
        this.f_1 = function (n, t, i) {
            return n + t * i
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this._input(1), e = this._input(2), u = PineJS.Std.high(this._context), f = this._context.new_var(u), o = PineJS.Std.highest(f, i, this._context), f = PineJS.Std.atr(i, this._context), o = this.f_0(o, r, f), u = this._context.new_var(u), i = PineJS.Std.lowest(u, i, this._context), r = this.f_1(i, r, f), i = this._context.new_var(o), i = PineJS.Std.highest(i, e, this._context), r = this._context.new_var(r);
            return[PineJS.Std.lowest(r, e, this._context), i]
        }
    }},
    {name: "Chande Momentum Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008080"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Chande Momentum Oscillator", shortDescription: "ChandeMO", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Chande Momentum Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Chande Momentum Oscillator"}, constructor: function () {
        this.f_0 = function (n) {
            return PineJS.Std.ge(n, 0) ? n : 0
        };
        this.f_1 = function (n) {
            return PineJS.Std.ge(n, 0) ? 0 : -n
        };
        this.f_2 = function (n, t) {
            return 100 * n / t
        };
        this.f_3 = function (n, t) {
            return this.f_2(n - t, n + t)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), i = PineJS.Std.close(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i), u = this.f_0(i), i = this.f_1(i), u = this._context.new_var(u), u = PineJS.Std.sum(u, r, this._context), i = this._context.new_var(i), r = PineJS.Std.sum(i, r, this._context);
            return[this.f_3(u, r)]
        }
    }},
    {name: "Commodity Channel Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#808000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 100},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: -100}
    ], filledAreasStyle: {fill_0: {color: "#808000", transparency: 90, visible: !0}}, inputs: {in_0: 20}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Commodity Channel Index", shortDescription: "CCI", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12}
    ], id: "Commodity Channel Index@tv-basicstudies-1", scriptIdPart: "", name: "Commodity Channel Index"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return(n - t) / (.015 * i)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), u = this._context.new_var(i), u = PineJS.Std.sma(u, r, this._context), f = this._context.new_var(i), r = PineJS.Std.dev(f, r, this._context);
            return[this.f_0(i, u, r)]
        }
    }},
    {name: "Choppiness Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 61.8},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 38.2}
    ], filledAreasStyle: {fill_0: {color: "#008000", transparency: 90, visible: !0}}, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Choppiness Index", shortDescription: "CHOP", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Choppiness Index@tv-basicstudies-1", scriptIdPart: "", name: "Choppiness Index"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return 100 * PineJS.Std.log10(n / (t - i)) / r
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.atr(1, this._context), r = this._context.new_var(r), r = PineJS.Std.sum(r, i, this._context), u = PineJS.Std.high(this._context), u = this._context.new_var(u), u = PineJS.Std.highest(u, i, this._context), f = PineJS.Std.low(this._context), f = this._context.new_var(f), f = PineJS.Std.lowest(f, i, this._context), i = PineJS.Std.log10(i);
            return[this.f_0(r, u, f, i)]
        }
    }},
    {name: "Directional Movement Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF7F00"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 14, in_1: 14}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "+DI", histogramBase: 0, joinPoints: !1}, plot_1: {title: "-DI", histogramBase: 0, joinPoints: !1}, plot_2: {title: "ADX", histogramBase: 0, joinPoints: !1}}, description: "Directional Movement Index", shortDescription: "DMI", is_price_study: !1, inputs: [
        {id: "in_0", name: "DI Length", defval: 14, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "ADX Smoothing", defval: 14, type: "integer", min: 1, max: 50}
    ], id: "Directional Movement Index@tv-basicstudies-1", scriptIdPart: "", name: "Directional Movement Index"}, constructor: function () {
        this.f_0 = function (n) {
            return-n
        };
        this.f_1 = function (n, t) {
            return PineJS.Std.and(PineJS.Std.gt(n, t), PineJS.Std.gt(n, 0)) ? n : 0
        };
        this.f_2 = function (n, t) {
            return 100 * n / t
        };
        this.f_3 = function (n, t) {
            return n + t
        };
        this.f_4 = function (n, t, i) {
            return PineJS.Std.abs(n - t) / (PineJS.Std.eq(i, 0) ? 1 : i)
        };
        this.f_5 = function (n) {
            return 100 * n
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), f = this._input(1), i = PineJS.Std.high(this._context), i = this._context.new_var(i), u = PineJS.Std.change(i), i = PineJS.Std.low(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i), e = this.f_0(i), i = PineJS.Std.tr(this._context), i = this._context.new_var(i), o = PineJS.Std.rma(i, r, this._context), i = this.f_1(u, e), i = this._context.new_var(i), i = PineJS.Std.rma(i, r, this._context), i = this.f_2(i, o), i = PineJS.Std.fixnan(i, this._context), u = this.f_1(e, u), u = this._context.new_var(u), r = PineJS.Std.rma(u, r, this._context), r = this.f_2(r, o), r = PineJS.Std.fixnan(r, this._context), u = this.f_3(i, r), u = this.f_4(i, r, u), u = this._context.new_var(u), f = PineJS.Std.rma(u, f, this._context), f = this.f_5(f);
            return[i, r, f]
        }
    }},
    {name: "Correlation Coeff", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 4, trackPrice: !1, transparency: 40, visible: !0, color: "#800080"}}, precision: 4, inputs: {in_0: "AAPL", in_1: 20}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Correlation Coeff", shortDescription: "CC", is_price_study: !1, inputs: [
        {id: "in_0", name: "sym", defval: "AAPL", type: "symbol"},
        {id: "in_1", name: "length", defval: 20, type: "integer", min: 1, max: 1e12}
    ], id: "Correlation Coeff@tv-basicstudies-1", scriptIdPart: "", name: "Correlation Coeff"}, constructor: function () {
        this.init = function (n, t) {
            this._context = n;
            this._input = t;
            this._context.new_sym(this._input(0), PineJS.Std.period(this._context), PineJS.Std.period(this._context))
        };
        this.main = function (n, t) {
            var i, r, u;
            this._context = n;
            this._input = t;
            i = this._context.new_var(this._context.symbol.time);
            this._input(0);
            PineJS.Std.period(this._context);
            r = PineJS.Std.close(this._context);
            u = this._input(1);
            this._context.select_sym(1);
            var e = this._context.new_var(this._context.symbol.time), f = PineJS.Std.close(this._context), f = this._context.new_var(f);
            return this._context.select_sym(0), i = f.adopt(e, i, 0), r = this._context.new_var(r), i = this._context.new_var(i), [PineJS.Std.correlation(r, i, u, this._context)]
        }
    }},
    {name: "Donchian Channels", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF7F00"}}, precision: 4, filledAreasStyle: {fill_0: {color: "#0000FF", transparency: 90, visible: !0}}, inputs: {in_0: 20}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Donchian Channels", shortDescription: "DC", is_price_study: !0, filledAreas: [
        {id: "fill_0", objAId: "plot_1", objBId: "plot_0", type: "plot_plot", title: "Plots Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 20, type: "integer", min: 1, max: 1e12}
    ], id: "Donchian Channels@tv-basicstudies-1", scriptIdPart: "", name: "Donchian Channels"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.low(this._context), r = this._context.new_var(r), r = PineJS.Std.lowest(r, i, this._context), u = PineJS.Std.high(this._context), u = this._context.new_var(u), i = PineJS.Std.highest(u, i, this._context), u = PineJS.Std.avg(i, r);
            return[r, i, u]
        }
    }},
    {name: "Double Exponential Moving Average", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Double Exponential Moving Average", shortDescription: "DEMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Double Exponential Moving Average@tv-basicstudies-1", scriptIdPart: "", name: "Double Exponential Moving Average"}, constructor: function () {
        this.f_0 = function (n, t) {
            return 2 * n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), i = PineJS.Std.close(this._context), i = this._context.new_var(i), i = PineJS.Std.ema(i, r, this._context), u = this._context.new_var(i), r = PineJS.Std.ema(u, r, this._context);
            return[this.f_0(i, r)]
        }
    }},
    {name: "Ease of Movement", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#808000"}}, precision: 4, inputs: {in_0: 1e4, in_1: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Ease of Movement", shortDescription: "EOM", is_price_study: !1, inputs: [
        {id: "in_0", name: "Divisor", defval: 1e4, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Ease of Movement@tv-basicstudies-1", scriptIdPart: "", name: "Ease of Movement"}, constructor: function () {
        this.f_0 = function (n, t, i, r, u) {
            return n * t * (i - r) / u
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), u = this._input(1), r = PineJS.Std.hl2(this._context), r = this._context.new_var(r), r = PineJS.Std.change(r), i = this.f_0(i, r, PineJS.Std.high(this._context), PineJS.Std.low(this._context), PineJS.Std.volume(this._context)), i = this._context.new_var(i);
            return[PineJS.Std.sma(i, u, this._context)]
        }
    }},
    {name: "Elders Force Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 13}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Elders Force Index", shortDescription: "EFI", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 13, type: "integer", min: 1, max: 1e12}
    ], id: "Elders Force Index@tv-basicstudies-1", scriptIdPart: "", name: "Elders Force Index"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n * t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), i = PineJS.Std.close(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i), i = this.f_0(i, PineJS.Std.volume(this._context)), i = this._context.new_var(i);
            return[PineJS.Std.sma(i, r, this._context)]
        }
    }},
    {name: "Envelope", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF7F00"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, filledAreasStyle: {fill_0: {color: "#0000FF", transparency: 90, visible: !0}}, inputs: {in_0: 20, in_1: 10, in_2: !1}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Median", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Upper", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Lower", histogramBase: 0, joinPoints: !1}}, description: "Envelope", shortDescription: "Env", is_price_study: !0, filledAreas: [
        {id: "fill_0", objAId: "plot_1", objBId: "plot_2", type: "plot_plot", title: "Plots Background"}
    ], inputs: [
        {id: "in_0", name: "Length", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "percent", defval: 10, type: "float", min: -1e12, max: 1e12},
        {id: "in_2", name: "exponential", defval: !1, type: "bool"}
    ], id: "Envelope@tv-basicstudies-1", scriptIdPart: "", name: "Envelope"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return n ? t : i
        };
        this.f_1 = function (n, t) {
            return n * (1 + t)
        };
        this.f_2 = function (n, t) {
            return n * (1 - t)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = PineJS.Std.close(this._context), i = this._input(0), f = this._input(1), r = this._input(2), e = this._context.new_var(u), e = PineJS.Std.ema(e, i, this._context), u = this._context.new_var(u), i = PineJS.Std.sma(u, i, this._context), r = this.f_0(r, e, i), i = f / 100, f = this.f_1(r, i), i = this.f_2(r, i);
            return[r, f, i]
        }
    }},
    {name: "Ichimoku Cloud", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}, plot_3: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800080"}, plot_4: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800080"}}, precision: 4, filledAreasStyle: {fill_0: {color: "#000080", transparency: 90, visible: !0}}, inputs: {in_0: 9, in_1: 26, in_2: 52, in_3: 26}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"},
        {id: "plot_3", type: "line"},
        {id: "plot_4", type: "line"}
    ], styles: {plot_0: {title: "Tenkan-sen", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Kijun-sen", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Chikou span", histogramBase: 0, joinPoints: !1}, plot_3: {title: "Senkou A", histogramBase: 0, joinPoints: !1}, plot_4: {title: "Senkou B", histogramBase: 0, joinPoints: !1}}, description: "Ichimoku Cloud", shortDescription: "Ichimoku", is_price_study: !0, filledAreas: [
        {id: "fill_0", objAId: "plot_3", objBId: "plot_4", type: "plot_plot", title: "Plots Background"}
    ], inputs: [
        {id: "in_0", name: "Short", defval: 9, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "Middle", defval: 26, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "Long", defval: 52, type: "integer", min: 1, max: 1e12},
        {id: "in_3", name: "displacement", defval: 26, type: "integer", min: 1, max: 1e12}
    ], id: "Ichimoku Cloud@tv-basicstudies-1", scriptIdPart: "", name: "Ichimoku Cloud"}, constructor: function () {
        this.f_0 = function (n) {
            return-n
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), e = this._input(2), s = this._input(3), f = PineJS.Std.low(this._context), i = this._context.new_var(f), o = PineJS.Std.lowest(i, r, this._context), i = PineJS.Std.high(this._context), h = this._context.new_var(i), r = PineJS.Std.highest(h, r, this._context), r = PineJS.Std.avg(o, r), o = this._context.new_var(f), o = PineJS.Std.lowest(o, u, this._context), h = this._context.new_var(i), u = PineJS.Std.highest(h, u, this._context), u = PineJS.Std.avg(o, u), o = PineJS.Std.avg(r, u), f = this._context.new_var(f), f = PineJS.Std.lowest(f, e, this._context), i = this._context.new_var(i), e = PineJS.Std.highest(i, e, this._context), e = PineJS.Std.avg(f, e), i = PineJS.Std.close(this._context);
            return[r, u, {value: i, offset: this.f_0(s)}, {value: o, offset: s}, {value: e, offset: s}]
        }
    }},
    {name: "Klinger Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, inputs: {}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Signal", histogramBase: 0, joinPoints: !1}}, description: "Klinger Oscillator", shortDescription: "Klinger Oscillator", is_price_study: !1, inputs: [], id: "Klinger Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Klinger Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return PineJS.Std.ge(n, 0) ? t : -t
        };
        this.f_1 = function (n, t) {
            return n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.hlc3(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i), r = this.f_0(i, PineJS.Std.volume(this._context)), i = this._context.new_var(r), i = PineJS.Std.ema(i, 34, this._context), r = this._context.new_var(r), r = PineJS.Std.ema(r, 55, this._context), i = this.f_1(i, r), r = this._context.new_var(i), r = PineJS.Std.ema(r, 13, this._context);
            return[i, r]
        }
    }},
    {name: "Hull MA", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Hull MA", shortDescription: "HMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Hull MA@tv-basicstudies-1", scriptIdPart: "", name: "Hull MA"}, constructor: function () {
        this.f_0 = function (n, t) {
            return 2 * n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), u = r / 2, f = this._context.new_var(i), u = PineJS.Std.wma(f, u, this._context), i = this._context.new_var(i), i = PineJS.Std.wma(i, r, this._context), i = this.f_0(u, i), r = PineJS.Std.sqrt(r), r = PineJS.Std.round(r), i = this._context.new_var(i);
            return[PineJS.Std.wma(i, r, this._context)]
        }
    }},
    {name: "Keltner Channels", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, filledAreasStyle: {fill_0: {color: "#0000FF", transparency: 90, visible: !0}}, inputs: {in_0: !0, in_1: 20, in_2: 1}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Upper", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Middle", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Lower", histogramBase: 0, joinPoints: !1}}, description: "Keltner Channels", shortDescription: "KC", is_price_study: !0, filledAreas: [
        {id: "fill_0", objAId: "plot_0", objBId: "plot_2", type: "plot_plot", title: "Plots Background"}
    ], inputs: [
        {id: "in_0", name: "useTrueRange", defval: !0, type: "bool"},
        {id: "in_1", name: "length", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "mult", defval: 1, type: "float", min: -1e12, max: 1e12}
    ], id: "Keltner Channels@tv-basicstudies-1", scriptIdPart: "", name: "Keltner Channels"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return n ? t : i - r
        };
        this.f_1 = function (n, t, i) {
            return n + t * i
        };
        this.f_2 = function (n, t, i) {
            return n - t * i
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), u = this._input(1), f = this._input(2), i = this._context.new_var(i), i = PineJS.Std.ema(i, u, this._context), r = this.f_0(r, PineJS.Std.tr(this._context), PineJS.Std.high(this._context), PineJS.Std.low(this._context)), r = this._context.new_var(r), r = PineJS.Std.ema(r, u, this._context), u = this.f_1(i, r, f), f = this.f_2(i, r, f);
            return[u, i, f]
        }
    }},
    {name: "Linear Regression Curve", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Linear Regression Curve", shortDescription: "LRC", is_price_study: !0, inputs: [
        {id: "in_0", name: "Length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Linear Regression Curve@tv-basicstudies-1", scriptIdPart: "", name: "Linear Regression Curve"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), i = this._context.new_var(i);
            return[PineJS.Std.linreg(i, r, 0)]
        }
    }},
    {name: "Know Sure Thing", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 10, in_1: 15, in_2: 20, in_3: 30, in_4: 10, in_5: 10, in_6: 10, in_7: 15, in_8: 9}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "KST", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Signal", histogramBase: 0, joinPoints: !1}}, description: "Know Sure Thing", shortDescription: "KST", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "roclen1", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "roclen2", defval: 15, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "roclen3", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_3", name: "roclen4", defval: 30, type: "integer", min: 1, max: 1e12},
        {id: "in_4", name: "smalen1", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_5", name: "smalen2", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_6", name: "smalen3", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_7", name: "smalen4", defval: 15, type: "integer", min: 1, max: 1e12},
        {id: "in_8", name: "siglen", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Know Sure Thing@tv-basicstudies-1", scriptIdPart: "", name: "Know Sure Thing"}, constructor: function () {
        this.f_0 = function (n, t, i, r) {
            return n + 2 * t + 3 * i + 4 * r
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), o = this._input(2), f = this._input(3), s = this._input(4), h = this._input(5), c = this._input(6), e = this._input(7), l = this._input(8), i = PineJS.Std.close(this._context), a = this._context.new_var(i), r = PineJS.Std.roc(a, r), r = this._context.new_var(r), s = PineJS.Std.sma(r, s, this._context), r = this._context.new_var(i), u = PineJS.Std.roc(r, u), u = this._context.new_var(u), h = PineJS.Std.sma(u, h, this._context), u = this._context.new_var(i), o = PineJS.Std.roc(u, o), o = this._context.new_var(o), c = PineJS.Std.sma(o, c, this._context), i = this._context.new_var(i), f = PineJS.Std.roc(i, f), f = this._context.new_var(f), e = PineJS.Std.sma(f, e, this._context), e = this.f_0(s, h, c, e), f = this._context.new_var(e), l = PineJS.Std.sma(f, l, this._context);
            return[e, l]
        }
    }},
    {name: "MA Cross", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}, plot_2: {linestyle: 0, linewidth: 4, plottype: 3, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 9, in_1: 26}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Short", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Long", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Crosses", histogramBase: 0, joinPoints: !1}}, description: "MA Cross", shortDescription: "MA Cross", is_price_study: !0, inputs: [
        {id: "in_0", name: "Short", defval: 9, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "Long", defval: 26, type: "integer", min: 1, max: 1e12}
    ], id: "MA Cross@tv-basicstudies-1", scriptIdPart: "", name: "MA Cross"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n ? t : PineJS.Std.na()
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), i = PineJS.Std.close(this._context), f = this._context.new_var(i), r = PineJS.Std.sma(f, r, this._context), i = this._context.new_var(i), u = PineJS.Std.sma(i, u, this._context), i = PineJS.Std.cross(r, u, this._context), i = this.f_0(i, r);
            return[r, u, i]
        }
    }},
    {name: "Money Flow", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#459915"}}, precision: 4, bands: [
        {color: "#c0c0c0", linestyle: 2, linewidth: 1, visible: !0, value: 80},
        {color: "#c0c0c0", linestyle: 2, linewidth: 1, visible: !0, value: 20}
    ], filledAreasStyle: {fill_0: {color: "#9915ff", transparency: 90, visible: !0}}, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Money Flow", shortDescription: "MFI", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "Length", defval: 14, type: "integer", min: 1, max: 2e3}
    ], id: "Money Flow@tv-basicstudies-1", scriptIdPart: "", name: "Money Flow"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return n * (PineJS.Std.le(t, 0) ? 0 : i)
        };
        this.f_1 = function (n, t, i) {
            return n * (PineJS.Std.ge(t, 0) ? 0 : i)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = this._input(0), i = PineJS.Std.hlc3(this._context), r = this._context.new_var(i), f = PineJS.Std.change(r), r = this.f_0(PineJS.Std.volume(this._context), f, i), r = this._context.new_var(r), r = PineJS.Std.sum(r, u, this._context), i = this.f_1(PineJS.Std.volume(this._context), f, i), i = this._context.new_var(i), u = PineJS.Std.sum(i, u, this._context);
            return[PineJS.Std.rsi(r, u)]
        }
    }},
    {name: "Mass Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 10}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Mass Index", shortDescription: "Mass Index", is_price_study: !1, inputs: [
        {id: "in_0", name: "length", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Mass Index@tv-basicstudies-1", scriptIdPart: "", name: "Mass Index"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.f_1 = function (n, t) {
            return n / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var u = this._input(0), i = this.f_0(PineJS.Std.high(this._context), PineJS.Std.low(this._context)), i = this._context.new_var(i), i = PineJS.Std.ema(i, 9, this._context), r = this._context.new_var(i), r = PineJS.Std.ema(r, 9, this._context), i = this.f_1(i, r), i = this._context.new_var(i);
            return[PineJS.Std.sum(i, u, this._context)]
        }
    }},
    {name: "Moving Average Exponential", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Moving Average Exponential", shortDescription: "EMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "Length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Moving Average Exponential@tv-basicstudies-1", scriptIdPart: "", name: "Moving Average Exponential"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), i = this._context.new_var(i);
            return[PineJS.Std.ema(i, r, this._context)]
        }
    }},
    {name: "Net Volume", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Net Volume", shortDescription: "Net Volume", is_price_study: !1, inputs: [], id: "Net Volume@tv-basicstudies-1", scriptIdPart: "", name: "Net Volume"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return PineJS.Std.gt(n, 0) ? t : PineJS.Std.lt(i, 0) ? -t : 0 * t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i);
            return[this.f_0(i, PineJS.Std.volume(this._context), i)]
        }
    }},
    {name: "Moving Average Convergence/Divergence", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 1, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 12, in_1: 26, in_2: 9}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Histogram", histogramBase: 0, joinPoints: !1}, plot_1: {title: "MACD", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Signal", histogramBase: 0, joinPoints: !1}}, description: "MACD", shortDescription: "MACD", is_price_study: !1, inputs: [
        {id: "in_0", name: "fastLength", defval: 12, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "slowLength", defval: 26, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "signalLength", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Moving Average Convergence/Divergence@tv-basicstudies-1", scriptIdPart: "", name: "MACD"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = PineJS.Std.close(this._context), f = this._input(0), i = this._input(1), u = this._input(2), e = this._context.new_var(r), f = PineJS.Std.ema(e, f, this._context), r = this._context.new_var(r), i = PineJS.Std.ema(r, i, this._context), i = this.f_0(f, i), r = this._context.new_var(i), u = PineJS.Std.sma(r, u, this._context);
            return[this.f_0(i, u), i, u]
        }
    }},
    {name: "Moving Average", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Moving Average", shortDescription: "MA", is_price_study: !0, inputs: [
        {id: "in_0", name: "Length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Moving Average@tv-basicstudies-1", scriptIdPart: "", name: "Moving Average"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), i = this._context.new_var(i);
            return[PineJS.Std.sma(i, r, this._context)]
        }
    }},
    {name: "Moving Average Weighted", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Moving Average Weighted", shortDescription: "WMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "Length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Moving Average Weighted@tv-basicstudies-1", scriptIdPart: "", name: "Moving Average Weighted"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), i = this._context.new_var(i);
            return[PineJS.Std.wma(i, r, this._context)]
        }
    }},
    {name: "Parabolic SAR", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 3, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: .02, in_1: .02, in_2: .2}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Parabolic SAR", shortDescription: "SAR", is_price_study: !0, inputs: [
        {id: "in_0", name: "start", defval: .02, type: "float", min: -1e12, max: 1e12},
        {id: "in_1", name: "increment", defval: .02, type: "float", min: -1e12, max: 1e12},
        {id: "in_2", name: "maximum", defval: .2, type: "float", min: -1e12, max: 1e12}
    ], id: "Parabolic SAR@tv-basicstudies-1", scriptIdPart: "", name: "Parabolic SAR"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this._input(1), u = this._input(2);
            return[PineJS.Std.sar(i, r, u, this._context)]
        }
    }},
    {name: "On Balance Volume", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "On Balance Volume", shortDescription: "OBV", is_price_study: !1, inputs: [], id: "On Balance Volume@tv-basicstudies-1", scriptIdPart: "", name: "On Balance Volume"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return PineJS.Std.gt(n, 0) ? t : PineJS.Std.lt(i, 0) ? -t : 0 * t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), i = this._context.new_var(i), i = PineJS.Std.change(i), i = this.f_0(i, PineJS.Std.volume(this._context), i);
            return[PineJS.Std.cum(i, this._context)]
        }
    }},
    {name: "Price Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 10, in_1: 21}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Price Oscillator", shortDescription: "PPO", is_price_study: !1, inputs: [
        {id: "in_0", name: "shortlen", defval: 10, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "longlen", defval: 21, type: "integer", min: 1, max: 1e12}
    ], id: "Price Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Price Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return(n - t) / t * 100
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), u = this._input(1), f = this._context.new_var(i), r = PineJS.Std.sma(f, r, this._context), i = this._context.new_var(i), u = PineJS.Std.sma(i, u, this._context);
            return[this.f_0(r, u)]
        }
    }},
    {name: "Relative Strength Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800080"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 70},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 30}
    ], filledAreasStyle: {fill_0: {color: "#800080", transparency: 90, visible: !0}}, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Relative Strength Index", shortDescription: "RSI", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "Length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Relative Strength Index@tv-basicstudies-1", scriptIdPart: "", name: "Relative Strength Index"}, constructor: function () {
        this.f_0 = function (n) {
            return PineJS.Std.max(n, 0)
        };
        this.f_1 = function (n) {
            return-PineJS.Std.min(n, 0)
        };
        this.f_2 = function (n, t) {
            return PineJS.Std.eq(n, 0) ? 100 : PineJS.Std.eq(t, 0) ? 0 : 100 - 100 / (1 + t / n)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), u = this._input(0), i = this._context.new_var(i), r = PineJS.Std.change(i), i = this.f_0(r), i = this._context.new_var(i), i = PineJS.Std.rma(i, u, this._context), r = this.f_1(r), r = this._context.new_var(r), u = PineJS.Std.rma(r, u, this._context);
            return[this.f_2(u, i)]
        }
    }},
    {name: "Relative Vigor Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 10}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "RVGI", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Signal", histogramBase: 0, joinPoints: !1}}, description: "Relative Vigor Index", shortDescription: "RVGI", is_price_study: !1, inputs: [
        {id: "in_0", name: "Length", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Relative Vigor Index@tv-basicstudies-1", scriptIdPart: "", name: "Relative Vigor Index"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.f_1 = function (n, t) {
            return n / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), i = this.f_0(PineJS.Std.close(this._context), PineJS.Std.open(this._context)), i = this._context.new_var(i), i = PineJS.Std.swma(i, this._context), i = this._context.new_var(i), i = PineJS.Std.sum(i, r, this._context), u = this.f_0(PineJS.Std.high(this._context), PineJS.Std.low(this._context)), u = this._context.new_var(u), u = PineJS.Std.swma(u, this._context), u = this._context.new_var(u), r = PineJS.Std.sum(u, r, this._context), r = this.f_1(i, r), i = this._context.new_var(r), i = PineJS.Std.swma(i, this._context);
            return[r, i]
        }
    }},
    {name: "Relative Volatility Index", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 80},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 20}
    ], filledAreasStyle: {fill_0: {color: "#808000", transparency: 90, visible: !0}}, inputs: {in_0: 10}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Relative Volatility Index", shortDescription: "RVI", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Relative Volatility Index@tv-basicstudies-1", scriptIdPart: "", name: "Relative Volatility Index"}, constructor: function () {
        this.f_0 = function (n, t) {
            return PineJS.Std.le(n, 0) ? 0 : t
        };
        this.f_1 = function (n, t) {
            return PineJS.Std.gt(n, 0) ? 0 : t
        };
        this.f_2 = function (n, t) {
            return n / (n + t) * 100
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.close(this._context), u = this._context.new_var(r), i = PineJS.Std.stdev(u, i, this._context), r = this._context.new_var(r), u = PineJS.Std.change(r), r = this.f_0(u, i), r = this._context.new_var(r), r = PineJS.Std.ema(r, 14, this._context), i = this.f_1(u, i), i = this._context.new_var(i), i = PineJS.Std.ema(i, 14, this._context);
            return[this.f_2(r, i)]
        }
    }},
    {name: "SMI Ergodic Indicator/Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF7F00"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 1, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, inputs: {in_0: 5, in_1: 20, in_2: 5}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Indicator", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Signal", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Oscillator", histogramBase: 0, joinPoints: !1}}, description: "SMI Ergodic Indicator/Oscillator", shortDescription: "SMIIO", is_price_study: !1, inputs: [
        {id: "in_0", name: "shortlen", defval: 5, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "longlen", defval: 20, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "siglen", defval: 5, type: "integer", min: 1, max: 1e12}
    ], id: "SMI Ergodic Indicator/Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "SMI Ergodic Indicator/Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n - t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this._input(1), u = this._input(2), f = PineJS.Std.close(this._context), f = this._context.new_var(f), i = PineJS.Std.tsi(f, i, r, this._context), r = this._context.new_var(i), u = PineJS.Std.ema(r, u, this._context), r = this.f_0(i, u);
            return[i, u, r]
        }
    }},
    {name: "Stochastic", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 80},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 20}
    ], filledAreasStyle: {fill_0: {color: "#800080", transparency: 75, visible: !0}}, inputs: {in_0: 14, in_1: 1, in_2: 3}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "%D", histogramBase: 0, joinPoints: !1}, plot_1: {title: "%K", histogramBase: 0, joinPoints: !1}}, description: "Stochastic", shortDescription: "Stoch", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 14, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "smoothK", defval: 1, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "smoothD", defval: 3, type: "integer", min: 1, max: 1e12}
    ], id: "Stochastic@tv-basicstudies-1", scriptIdPart: "", name: "Stochastic"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this._input(1), u = this._input(2), f = PineJS.Std.close(this._context), e = PineJS.Std.high(this._context), o = PineJS.Std.low(this._context), f = this._context.new_var(f), e = this._context.new_var(e), o = this._context.new_var(o), i = PineJS.Std.stoch(f, e, o, i, this._context), i = this._context.new_var(i), r = PineJS.Std.sma(i, r, this._context), i = this._context.new_var(r), u = PineJS.Std.sma(i, u, this._context);
            return[r, u]
        }
    }},
    {name: "TRIX", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 18}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "TRIX", histogramBase: 0, joinPoints: !1}}, description: "TRIX", shortDescription: "TRIX", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 18, type: "integer", min: 1, max: 1e12}
    ], id: "TRIX@tv-basicstudies-1", scriptIdPart: "", name: "TRIX"}, constructor: function () {
        this.f_0 = function (n) {
            return PineJS.Std.log(n)
        };
        this.f_1 = function (n) {
            return 1e4 * n
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this.f_0(PineJS.Std.close(this._context)), r = this._context.new_var(r), r = PineJS.Std.ema(r, i, this._context), r = this._context.new_var(r), r = PineJS.Std.ema(r, i, this._context), r = this._context.new_var(r), i = PineJS.Std.ema(r, i, this._context), i = this._context.new_var(i), i = PineJS.Std.change(i);
            return[this.f_1(i)]
        }
    }},
    {name: "Stochastic RSI", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 80},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 20}
    ], filledAreasStyle: {fill_0: {color: "#800080", transparency: 80, visible: !0}}, inputs: {in_0: 14, in_1: 14, in_2: 3, in_3: 3}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"}
    ], styles: {plot_0: {title: "%D", histogramBase: 0, joinPoints: !1}, plot_1: {title: "%K", histogramBase: 0, joinPoints: !1}}, description: "Stochastic RSI", shortDescription: "Stoch RSI", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "lengthRSI", defval: 14, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "lengthStoch", defval: 14, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "smoothK", defval: 3, type: "integer", min: 1, max: 1e12},
        {id: "in_3", name: "smoothD", defval: 3, type: "integer", min: 1, max: 1e12}
    ], id: "Stochastic RSI@tv-basicstudies-1", scriptIdPart: "", name: "Stochastic RSI"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var f = PineJS.Std.close(this._context), e = this._input(0), i = this._input(1), u = this._input(2), o = this._input(3), r = PineJS.Std.rsi(f, e), f = this._context.new_var(r), e = this._context.new_var(r), r = this._context.new_var(r), i = PineJS.Std.stoch(f, e, r, i, this._context), i = this._context.new_var(i), u = PineJS.Std.sma(i, u, this._context), i = this._context.new_var(u), o = PineJS.Std.sma(i, o, this._context);
            return[u, o]
        }
    }},
    {name: "Triple EMA", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, inputs: {in_0: 9}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Triple EMA", shortDescription: "TEMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "length", defval: 9, type: "integer", min: 1, max: 1e12}
    ], id: "Triple EMA@tv-basicstudies-1", scriptIdPart: "", name: "Triple EMA"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return 3 * (n - t) + i
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.close(this._context), r = this._context.new_var(r), r = PineJS.Std.ema(r, i, this._context), u = this._context.new_var(r), u = PineJS.Std.ema(u, i, this._context), f = this._context.new_var(u), i = PineJS.Std.ema(f, i, this._context);
            return[this.f_0(r, u, i)]
        }
    }},
    {name: "VWMA", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}}, precision: 4, inputs: {in_0: 20}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "VWMA", shortDescription: "VWMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "len", defval: 20, type: "integer", min: 1, max: 1e12}
    ], id: "VWMA@tv-basicstudies-1", scriptIdPart: "", name: "VWMA"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), i = this._context.new_var(i);
            return[PineJS.Std.vwma(i, r, this._context)]
        }
    }},
    {name: "Volume Oscillator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: 0}
    ], inputs: {in_0: 5, in_1: 10}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Volume Oscillator", shortDescription: "Volume Osc", is_price_study: !1, bands: [
        {id: "hline_0", name: "Zero"}
    ], inputs: [
        {id: "in_0", name: "shortlen", defval: 5, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "longlen", defval: 10, type: "integer", min: 1, max: 1e12}
    ], id: "Volume Oscillator@tv-basicstudies-1", scriptIdPart: "", name: "Volume Oscillator"}, constructor: function () {
        this.f_0 = function (n, t) {
            return 100 * (n - t) / t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), i = PineJS.Std.volume(this._context), f = this._context.new_var(i), r = PineJS.Std.ema(f, r, this._context), i = this._context.new_var(i), u = PineJS.Std.ema(i, u, this._context);
            return[this.f_0(r, u)]
        }
    }},
    {name: "Williams Alligator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#0000FF"}, plot_1: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#FF0000"}, plot_2: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, inputs: {in_0: 21, in_1: 13, in_2: 8}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", type: "line"},
        {id: "plot_2", type: "line"}
    ], styles: {plot_0: {title: "Jaw", histogramBase: 0, joinPoints: !1}, plot_1: {title: "Teeth", histogramBase: 0, joinPoints: !1}, plot_2: {title: "Lips", histogramBase: 0, joinPoints: !1}}, description: "Williams Alligator", shortDescription: "Alligator", is_price_study: !0, inputs: [
        {id: "in_0", name: "jawLength", defval: 21, type: "integer", min: 1, max: 1e12},
        {id: "in_1", name: "teethLength", defval: 13, type: "integer", min: 1, max: 1e12},
        {id: "in_2", name: "lipsLength", defval: 8, type: "integer", min: 1, max: 1e12}
    ], id: "Williams Alligator@tv-basicstudies-1", scriptIdPart: "", name: "Williams Alligator"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), f = this._input(2), i = PineJS.Std.hl2(this._context), e = this._context.new_var(i), r = PineJS.Std.ema(e, r, this._context), e = this._context.new_var(i), u = PineJS.Std.ema(e, u, this._context), i = this._context.new_var(i), f = PineJS.Std.ema(i, f, this._context);
            return[
                {value: r, offset: 8},
                {value: u, offset: 5},
                {value: f, offset: 3}
            ]
        }
    }},
    {name: "Willams %R", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, bands: [
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: -20},
        {color: "#808080", linestyle: 2, linewidth: 1, visible: !0, value: -80}
    ], filledAreasStyle: {fill_0: {color: "#000080", transparency: 90, visible: !0}}, inputs: {in_0: 14}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Willams %R", shortDescription: "%R", is_price_study: !1, bands: [
        {id: "hline_0", name: "UpperLimit"},
        {id: "hline_1", name: "LowerLimit"}
    ], filledAreas: [
        {id: "fill_0", objAId: "hline_0", objBId: "hline_1", type: "hline_hline", title: "Hlines Background"}
    ], inputs: [
        {id: "in_0", name: "length", defval: 14, type: "integer", min: 1, max: 1e12}
    ], id: "Willams %R@tv-basicstudies-1", scriptIdPart: "", name: "Willams %R"}, constructor: function () {
        this.f_0 = function (n, t, i) {
            return 100 * (n - t) / (t - i)
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = PineJS.Std.high(this._context), r = this._context.new_var(r), r = PineJS.Std.highest(r, i, this._context), u = PineJS.Std.low(this._context), u = this._context.new_var(u), i = PineJS.Std.lowest(u, i, this._context);
            return[this.f_0(PineJS.Std.close(this._context), r, i)]
        }
    }},
    {name: "Coppock Curve", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 10, in_1: 14, in_2: 11}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Coppock Curve", shortDescription: "Coppock Curve", is_price_study: !1, inputs: [
        {id: "in_0", name: "WMA Length", defval: 10, type: "integer", min: -1e12, max: 1e12},
        {id: "in_1", name: "Long RoC Length", defval: 14, type: "integer", min: -1e12, max: 1e12},
        {id: "in_2", name: "Short RoC Length", defval: 11, type: "integer", min: -1e12, max: 1e12}
    ], id: "Coppock Curve@tv-basicstudies-1", scriptIdPart: "", name: "Coppock Curve"}, constructor: function () {
        this.f_0 = function (n, t) {
            return n + t
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var f = this._input(0), u = this._input(1), i = this._input(2), r = PineJS.Std.close(this._context), e = this._context.new_var(r), u = PineJS.Std.roc(e, u), r = this._context.new_var(r), i = PineJS.Std.roc(r, i), i = this.f_0(u, i), i = this._context.new_var(i);
            return[PineJS.Std.wma(i, f, this._context)]
        }
    }},
    {name: "Least Squares Moving Average", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 25, in_1: 0}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Least Squares Moving Average", shortDescription: "LSMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "Length", defval: 25, type: "integer", min: -1e12, max: 1e12},
        {id: "in_1", name: "Offset", defval: 0, type: "integer", min: -1e12, max: 1e12}
    ], id: "Least Squares Moving Average@tv-basicstudies-1", scriptIdPart: "", name: "Least Squares Moving Average"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), i = PineJS.Std.close(this._context), i = this._context.new_var(i);
            return[PineJS.Std.linreg(i, r, u)]
        }
    }},
    {name: "Arnaud Legoux Moving Average", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 9, in_1: .85, in_2: 6}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "Arnaud Legoux Moving Average", shortDescription: "ALMA", is_price_study: !0, inputs: [
        {id: "in_0", name: "Window Size", defval: 9, type: "integer", min: -1e12, max: 1e12},
        {id: "in_1", name: "Offset", defval: .85, type: "float", min: -1e12, max: 1e12},
        {id: "in_2", name: "Sigma", defval: 6, type: "float", min: -1e12, max: 1e12}
    ], id: "Arnaud Legoux Moving Average@tv-basicstudies-1", scriptIdPart: "", name: "Arnaud Legoux Moving Average"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = PineJS.Std.close(this._context), r = this._input(0), u = this._input(1), f = this._input(2), i = this._context.new_var(i);
            return[PineJS.Std.alma(i, r, u, f)]
        }
    }},
    {name: "True Strength Indicator", metainfo: {_metainfoVersion: 27, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 1, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#000080"}}, precision: 4, inputs: {in_0: 25, in_1: 13}}, plots: [
        {id: "plot_0", type: "line"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "True Strength Indicator", shortDescription: "True Strength Indicator", is_price_study: !1, inputs: [
        {id: "in_0", name: "long", defval: 25, type: "integer", min: -1e12, max: 1e12},
        {id: "in_1", name: "short", defval: 13, type: "integer", min: -1e12, max: 1e12}
    ], id: "True Strength Indicator@tv-basicstudies-1", scriptIdPart: "", name: "True Strength Indicator"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = this._input(1), i = PineJS.Std.close(this._context), i = this._context.new_var(i);
            return[PineJS.Std.tsi(i, u, r, this._context)]
        }
    }}
];
D82.studyLibrary = D82.studyLibrary.concat([
    {name: "Compare", metainfo: {_metainfoVersion: 15, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !0, defaults: {styles: {compare: {linestyle: 0, linewidth: 2, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#800080"}}, precision: 4, inputs: {source: "close", symbol: ""}}, plots: [
        {id: "compare", type: "line"}
    ], styles: {compare: {title: "Plot", histogramBase: 0}}, description: "Compare", shortDescription: "Compare", is_price_study: !0, inputs: [
        {defval: "close", id: "source", name: "Source", options: "open high low close hl2 hlc3 ohlc4".split(" "), type: "text"},
        {id: "symbol", name: "Symbol", type: "symbol"}
    ], id: "Compare@tv-basicstudies-1"}, constructor: function () {
        this.init = function (n, t) {
            this._context = n;
            this._context.new_sym(t(1), PineJS.Std.period(this._context), PineJS.Std.period(this._context))
        };
        this.main = function (n, t) {
            var i;
            this._context = n;
            i = this._context.new_var(this._context.symbol.time);
            PineJS.Std.period(this._context);
            this._context.select_sym(1);
            var u = this._context.new_var(this._context.symbol.time), r = PineJS.Std[t(0)](this._context), r = this._context.new_var(r);
            return this._context.select_sym(0), [r.adopt(u, i, 0)]
        }
    }},
    {name: "Overlay", metainfo: {_metainfoVersion: 15, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !0, defaults: {styles: {}, precision: 4, inputs: {}}, plots: [
        {id: "open", type: "line"},
        {id: "high", type: "line"},
        {id: "low", type: "line"},
        {id: "close", type: "line"}
    ], styles: {open: {}, high: {}, low: {}, close: {}}, description: "Overlay", shortDescription: "Overlay", is_price_study: !1, inputs: [
        {id: "symbol", name: "symbol", defval: "", type: "symbol", isHidden: !0}
    ], id: "Overlay@tv-basicstudies-1"}, constructor: function () {
        this.init = function (n, t) {
            this._context = n;
            this._context.new_sym(t(0), PineJS.Std.period(this._context), PineJS.Std.period(this._context))
        };
        this.main = function (n) {
            var t;
            this._context = n;
            t = this._context.new_var(this._context.symbol.time);
            this._context.select_sym(1);
            var i = this._context.new_var(this._context.symbol.time), r = this._context.new_var(PineJS.Std.open(this._context)), u = this._context.new_var(PineJS.Std.high(this._context)), f = this._context.new_var(PineJS.Std.low(this._context)), e = this._context.new_var(PineJS.Std.close(this._context));
            return this._context.select_sym(0), [r.adopt(i, t, 0), u.adopt(i, t, 0), f.adopt(i, t, 0), e.adopt(i, t, 0)]
        }
    }},
    {name: "Volume", metainfo: {_metainfoVersion: 15, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, transparency: 65, defaults: {styles: {vol: {linestyle: 0, linewidth: 1, plottype: 5, trackPrice: !1, transparency: 65, visible: !0, color: "#000080"}, vol_ma: {linestyle: 0, linewidth: 1, plottype: 4, trackPrice: !1, transparency: 65, visible: !0, color: "#0496FF"}}, precision: 0, palettes: {volumePalette: {colors: {0: {color: "#FF0000", width: 1, style: 0}, 1: {color: "#008000", width: 1, style: 0}}}}, inputs: {showMA: !1}}, plots: [
        {id: "vol", type: "line"},
        {id: "volumePalette", palette: "volumePalette", target: "vol", type: "colorer"},
        {id: "vol_ma", type: "line"}
    ], styles: {vol: {title: "Volume", histogramBase: 0}, vol_ma: {title: "Volume MA", histogramBase: 0}}, description: "Volume", shortDescription: "Volume", is_price_study: !1, palettes: {volumePalette: {colors: {0: {name: "Color 0"}, 1: {name: "Color 1"}}}}, inputs: [
        {id: "showMA", name: "show MA", defval: !1, type: "bool"}
    ], id: "Volume@tv-basicstudies-1"}, constructor: function () {
        this.f_0 = function (n, t) {
            return PineJS.Std.gt(n, t) ? 0 : 1
        };
        this.f_1 = function (n, t) {
            return n ? t : PineJS.Std.na()
        };
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var r = this._input(0), u = PineJS.Std.volume(this._context), f = this.f_0(PineJS.Std.open(this._context), PineJS.Std.close(this._context)), i = PineJS.Std.volume(this._context), i = this._context.new_var(i), i = PineJS.Std.sma(i, 20, this._context), r = this.f_1(r, i);
            return[u, f, r]
        }
    }},
    {name: "ZigZag", metainfo: {_metainfoVersion: 23, isTVScript: !1, isTVScriptStub: !1, is_hidden_study: !1, defaults: {styles: {plot_0: {linestyle: 0, linewidth: 2, plottype: 0, trackPrice: !1, transparency: 35, visible: !0, color: "#008000"}}, precision: 4, inputs: {in_0: 5, in_1: 10}}, plots: [
        {id: "plot_0", type: "line"},
        {id: "plot_1", target: "plot_0", type: "dataoffset"}
    ], styles: {plot_0: {title: "Plot", histogramBase: 0, joinPoints: !1}}, description: "ZigZag", shortDescription: "ZigZag", is_price_study: !0, classId: "ScriptWithDataOffset", inputs: [
        {id: "in_0", name: "deviation", defval: 5, type: "integer", min: 1, max: 100},
        {id: "in_1", name: "depth", defval: 10, type: "integer", min: 2, max: 1e3}
    ], id: "ZigZag@tv-basicstudies-1"}, constructor: function () {
        this.main = function (n, t) {
            this._context = n;
            this._input = t;
            var i = this._input(0), r = this._input(1), i = i / 100, u = r / 2, r = PineJS.Std.zigzag(i, u, this._context), i = PineJS.Std.zigzagbars(i, u, this._context);
            return[r, i]
        }
    }}
]);
D81 = function () {
    this._sets = {}
};
D81.prototype._cacheKey = function (n) {
    return n
};
D81.prototype.createPointset = function (n, t, i, r, u, f) {
    var e, o;
    for (t = this._cacheKey(t, i), this._sets.hasOwnProperty(t) || (this._sets[t] = []), i = [], e = 0; e < r.length; ++e)0 !== r[e][1] ? (o = u.getPointTimeUTC(r[e][0], r[e][1], f), i.push(o)) : i.push(r[e][0]);
    this._sets[t].push({guid: n, points: i})
};
D81.prototype.removePointset = function (n) {
    var r, i, t;
    for (r in this._sets)for (i = this._sets[r], t = 0; t < i.length; ++t)if (i[t].guid == n) {
        i.splice(t, 1);
        return
    }
};
D81.prototype._refreshPointsetData = function (n, t, i, r) {
    for (var e, o, f = [], u = 0; u < n.points.length; ++u)e = n.points[u], o = this._indexOfTime(t, e, i, r), f.push({index: u, value: [o, e]});
    return f
};
D81.prototype.broadcastPointsetsUpdates = function (n, t, i, r, u, f) {
    var e, o, s;
    if (n = this._cacheKey(n, t), this._sets.hasOwnProperty(n))for (t = this._sets[n].length, e = 0; e < t; ++e)o = this._sets[n][e], s = this._refreshPointsetData(o, i, r, u), f(o.guid, s)
};
D81.prototype._indexOfTime = function (n, t, i, r) {
    var u = PineJsBarBuilder.lower_bound(n, 1e3 * t, function (n, t) {
        return n.value[0] > t ? 1 : n.value[0] < t ? -1 : 0
    });
    return 0 <= u && t < n[n.length - 1].value[0] ? n[u].index : i.indexOfBar(t, r)
};
D82.ExtrapolationManager = function () {
    this._storages = {}
};
D82.ExtrapolationManager.prototype._storageKey = function (n, t, i) {
    return n + "," + t + "," + i
};
D82.ExtrapolationManager.prototype.remove = function (n, t, i) {
    delete this._storages[this._storageKey(n, t, i)]
};
D82.ExtrapolationManager.prototype.storage = function (n, t, i) {
    return(i = PineJS.Symbol.parsePeriod(i), t = this._storageKey(n, t, i.pureResolution), this._storages[t]) ? this._storages[t] : (this._storages[t] = new D80(ChartapiMessagerInstances[n], i.pureResolution), this._storages[t])
};
D80 = function (n, t) {
    this._chartApiMessager = n;
    this._lastRealBarIndex = this._lastRealBarTime = null;
    this._resolution = t;
    this._extrapolatedBarsCache = [];
    this._onReadyCallbacks = []
};
D80.prototype.ready = function () {
    return!!this._lastRealBarTime
};
D80.prototype.rebuild = function (n, t) {
    this._lastRealBarTime = n;
    this._extrapolatedBarsCache = [];
    this.ensureExtrapolatedToBar(t, this._lastRealBarIndex)
};
D80.prototype.getPointTimeUTC = function (n, t, i) {
    return n = this.indexOfBar(n, i) - this._lastRealBarIndex, this.ensureExtrapolatedToBar(i, n + t + 1), this._extrapolatedBarsCache[n + t]
};
D80.prototype.indexOfBar = function (n, t) {
    this._ensureExtrapolatedToTime(t, 1e3 * n);
    var i = PineJsBarBuilder.lower_bound(this._extrapolatedBarsCache, n, function (n, t) {
        return n > t ? 1 : n < t ? -1 : 0
    });
    return this._lastRealBarIndex + i
};
D80.prototype._extrapolateData = function (n, t) {
    var i, r, u;
    if (!this.ready())throw"No real bars known, so cannot extrapolate anything";
    if (i = t(this._lastRealBarTime), i && 0 !== i.length) {
        for (PineJsCalendar.get_timezone(n.timezone), r = 0; r < i.length; ++r)i[r] /= 1e3;
        for (i[0] == this._lastRealBarTime / 1e3 && (i = i.slice(1)), this._extrapolatedBarsCache = i, u = i.slice(0), u.sort(), r = 0; r < u.length - 1; ++r)u[r] == u[r + 1] && console.error("Duplicating extrapolated bars: duplicated " + new Date(1e3 * u[r]));
        this._chartApiMessager.onTickmarksUpdated(this._lastRealBarIndex + 1, i, n)
    } else this._chartApiMessager.onTickmarksUpdated(this._lastRealBarIndex + 1, this._extrapolatedBarsCache, n)
};
D80.prototype.onTickmarksNeeded = function (n, t) {
    if (this.ready())this.ensureExtrapolatedToBar(n, t); else {
        var i = this;
        this._onReadyCallbacks.push(function () {
            i.ensureExtrapolatedToBar(n, t)
        })
    }
};
D80.prototype.ensureExtrapolatedToBar = function (n, t) {
    var i = this;
    return this._extrapolateData(n, function (r) {
        return i._extrapolatedBarsCache.length >= t || !i._shouldExtrapolateMore() ? null : PineJsBarBuilder.extrapolateBarsFrontByCount(i.newBarBuilder(n), r, t)
    })
};
D80.prototype._ensureExtrapolatedToTime = function (n, t) {
    var i = this;
    return this._extrapolateData(n, function (r) {
        return r >= t || !i._shouldExtrapolateMore() ? null : (r = PineJsBarBuilder.extrapolateBarsFrontToTime(i.newBarBuilder(n), r, t), r[r.length - 1] < t && console.warn("Extrapolation error: not enough data created"), r)
    })
};
D80.prototype.newBarBuilder = function (n) {
    return n = PineJS.Symbol.newSession(n.timezone, n.session), PineJS.Symbol.newBarBuilder(this._resolution, n)
};
D80.prototype._shouldExtrapolateMore = function () {
    return 100 > this._extrapolatedBarsCache.length
};
D80.prototype.setLastBarTime = function (n, t) {
    this._lastRealBarTime = t;
    this._lastRealBarIndex = n;
    for (var i = 0; i < this._onReadyCallbacks.length; ++i)this._onReadyCallbacks[i]();
    this._onReadyCallbacks = []
};
D79 = function (n) {
    var t = this;
    this._studiesCache = {};
    this._metainfoCache = [];
    this._symbolInfoCache = {};
    this._extrapolationManager = new D82.ExtrapolationManager;
    this._externalDatafeed = n;
    this._datafeedConfiguration = null;
    this._callbacks = {};
    this._externalDatafeed.onReady(function (n) {
        t._logMessage("Datafeed settings received: {0}".format(JSON.stringify(n)));
        t._datafeedConfiguration = t._adoptConfigurationData(n);
        t._fireEvent("configuration_received")
    });
    this._pointsetsManager = new D81;
    this._rangeExtensionData = {summary: 0};
    this._quotesInfo = [];
    this._endOfData = {};
    this._extendedRange = function () {
        return t._rangeExtensionData.summary
    };
    PineJSFeed.setupFeed({resolve: function (n, i, r) {
        t.resolveSymbol(n, i, r)
    }, subscribe: function (n, i, r, u, f) {
        var e = n.ticker, s = e + "," + i, h = parseInt(r.from / 1e3), o;
        return r = parseInt(r.to / 1e3), J77.enabled("log_data_request_time") && (o = new Date, console.log(o.toLocaleTimeString() + ":" + o.getMilliseconds() + "> Requesting data")), t._logMessage("Requesting data: `{0}` in [{1} ... {2}] ".format(e, h, r)), t._externalDatafeed.getBars(n, i, h, r, function (r) {
            var f = new PineJS.BarSet(n, r);
            0 < r.length ? t._logMessage("Receiving bars: `{0}` total {1} bars in [{2} ... {3}] ".format(e, r.length, r[0].time, r[r.length - 1].time)) : t._logMessage("Receiving bars: barset is empty");
            u(f);
            n.expired || t._externalDatafeed.subscribeBars(n, i, function (n) {
                f.add(n);
                u(f)
            }, s)
        }, f), s
    }, unsubscribe: function (n) {
        t._externalDatafeed.unsubscribeBars(n)
    }, calculateHistoryDepth: this._externalDatafeed.calculateHistoryDepth, getRangeExtension: this._extendedRange}, !J77.enabled("disable_resolution_rebuild"))
};
D79.prototype.purgeCache = function () {
    this._endOfData = {};
    this._symbolInfoCache = {}
};
D79.prototype._logMessage = function (n) {
    J77.enabled("charting_library_debug_mode") && console.log(n)
};
D79.prototype._extendRange = function (n) {
    this._rangeExtensionData.summary += n
};
D79.prototype.on = function (n, t) {
    return this._callbacks.hasOwnProperty(n) || (this._callbacks[n] = []), this._callbacks[n].push(t), this
};
D79.prototype._fireEvent = function (n, t) {
    if (this._callbacks.hasOwnProperty(n)) {
        for (var r = this._callbacks[n], i = 0; i < r.length; ++i)r[i](t);
        this._callbacks[n] = []
    }
};
D79.prototype._adoptConfigurationData = function (n) {
    var t, i, r, u;
    if (n = TradingView.merge({}, n), t = n.supported_resolutions, !t || 0 === t.length)return n.supported_resolutions = void 0, n;
    for (i = {}, r = 0; r < t.length; r++) {
        if (u = t[r], i.hasOwnProperty(u))throw"Duplicating resolution `" + u + "`";
        i[u] = 1
    }
    return n.supported_resolutions = i, n
};
D79.prototype.supportedResolutions = function () {
    return this._datafeedConfiguration.supported_resolutions
};
D79.prototype.supportedSymbolsTypes = function () {
    return this._datafeedConfiguration.symbols_types || []
};
D79.prototype.supportedExchangesList = function () {
    return this._datafeedConfiguration.exchanges || []
};
D79.prototype._createStudyLogicObject = function (n) {
    var i = n.split("@")[0], t = D82.studyLibrary.filter(function (t) {
        return t.metainfo.id == n || t.metainfo.shortDescription == i
    });
    if (0 === t.length)throw"Study `" + n + "` not found";
    return new t[0].constructor
};
D79.prototype.getMarks = function (n, t, i, r, u) {
    function e(n) {
        function i(t, i) {
            return isArray(n[t]) ? n[t][i] : n[t]
        }

        if (isArray(n))return n;
        for (var r = [], t = 0; t < n.id.length; ++t)r.push({id: i("id", t), time: i("time", t), color: i("color", t), text: i("text", t), label: i("label", t), labelFontColor: i("labelFontColor", t), minSize: i("minSize", t)});
        return r
    }

    var o = {red: 6, green: 5, blue: 4, yellow: 3}, f;
    this._externalDatafeed.getMarks && this._datafeedConfiguration.supports_marks && (this._logMessage("Requesting bars marks: symbol {0}, resolution {1}, range [{2} ... {3}]".format(n.full_name, u, t, i)), f = this, this._externalDatafeed.getMarks(n, t, i, function (t) {
        t = e(t).map(function (n) {
            return n.time = parseInt(n.time), n
        });
        f._logMessage("Received bars marks: symbol {0}, resolution {1}, marks {2}".format(n.full_name, u, JSON.stringify(t)));
        t = t.map(function (n) {
            return n.tickmark = n.time, n.direction = o[n.color], n.onClicked = function () {
                Q17.emit("onMarkClick", n.id)
            }, n.label = !!n.label && n.label[0], n
        });
        r(t)
    }, u))
};
D79.prototype._computeStudy = function (n, t, i, r, u, f, e, o) {
    var c = !0, s = [], h = {}, l = 0, a = this;
    this.resolveSymbol(t, function (v) {
        if (PineJS.Symbol.parsePeriod(i).isIntraday && !v.has_intraday)o("Unsupported resolution"); else {
            var y = new PineJS.StudyEngine({tickerid: t, symbolInfo: v, period: i, body: n, onErrorCallback: o, input: function (n) {
                return u[n]
            }, out: function (n, t) {
                for (var i, f = n.time, u = "number" == typeof i ? [t] : t, r = 0; r < u.length; ++r)i = u[r], i && "object" == typeof i && (h["plot_" + r] = i.offset, i = i.value, l++), "number" == typeof i && isNaN(i) && (i = void 0), u[r] = i;
                r = s.length - 1;
                (i = 0 > r || f > s[r].value[0]) ? s.push({index: s.length, value: [f].concat(u)}) : s[r].value = [f].concat(u);
                c || e([s[s.length - 1]], i, s.length, h, v)
            }, recalc: function () {
                c = !1;
                f(s, 0 < l ? h : void 0, v)
            }});
            if (!a._studiesCache[r])throw"This should never happen";
            a._studiesCache[r].engine = y
        }
    }, function (n) {
        o(n)
    })
};
D79.prototype._createStudy = function (n, t, i, r, u, f, e) {
    var o = this;
    ChartapiMessagerInstances[r].onStudyLoading(u, f);
    o._computeStudy(i, n, t, u, e, function (i, e, s) {
        ChartapiMessagerInstances[r].onDataUpdate(u, f, o._convertBarsTimeToUnix(i), e, s, o._extendedRange(n, t));
        ChartapiMessagerInstances[r].onStudyCompleted(u, f)
    }, function (i, e, s, h, c) {
        ChartapiMessagerInstances[r].onDataUpdate(u, f, o._convertBarsTimeToUnix(i), h, c, o._extendedRange(n, t))
    }, function (n) {
        ChartapiMessagerInstances[r].onStudyError(u, n)
    })
};
D79.prototype.purgeEndOfDataFlags = function (n) {
    for (var t in this._studiesCache)n && n != t || (this._studiesCache[t].firstBarTime = null)
};
D79.prototype.recreateSources = function (n, t, i, r) {
    var f, u;
    for (f in this._studiesCache)u = this._studiesCache[f], u && u.engine && u.engine.stop();
    PineJSFeed.unsubscribeUnused();
    for (f in this._studiesCache)(u = this._studiesCache[f]) && (u.symbol = n, u.resolution = t, "series" == u.type && this.createSeries(n, t, i, f, u.turnaround, r));
    for (f in this._studiesCache)(u = this._studiesCache[f]) && "study" == u.type && this._createStudy(n, t, u.studyObject, i, f, u.turnaround, u.inputs)
};
D79.prototype.removeStudy = function (n) {
    this._studiesCache[n] && this._studiesCache[n].engine && (this._studiesCache[n].engine.stop(), PineJSFeed.unsubscribeUnused());
    this._studiesCache[n] = null
};
D79.prototype.removeSeries = function (n) {
    this.removeStudy(n)
};
D79.prototype.recomputeStudy = function (n, t, i, r) {
    var u = this._studiesCache[n];
    if (!u)throw"This should never happen";
    u.inputs = t;
    u.turnaround = r;
    u.engine && u.engine.stop();
    this._createStudy(u.symbol, u.resolution, u.studyObject, i, n, r, t)
};
D79.prototype._convertBarsTimeToUnix = function (n) {
    for (var r, i = [], t = 0; t < n.length; ++t)r = {index: n[t].index, value: [].concat(n[t].value)}, r.value[0] /= 1e3, i.push(r);
    return i
};
D79.prototype.createStudy = function (n, t, i, r, u, f, e) {
    f = this._createStudyLogicObject(f);
    this._studiesCache[r] = {studyObject: f, symbol: n, resolution: t, guid: r, type: "study", inputs: e, turnaround: u};
    this._createStudy(n, t, f, i, r, u, e)
};
D79.prototype.purgeRangeExtensionData = function () {
    this._rangeExtensionData = {summary: 0}
};
D79.prototype.extendSeriesRange = function (n, t, i) {
    var r = this._studiesCache[n], u, f;
    if (!r)throw"This should never happen";
    this._isEndOfData(t, n, r.turnaround) ? (u = r.engine.runner.host.symbolInfo.data_status, setTimeout(function () {
        ChartapiMessagerInstances[t].onSeriesCompleted(n, r.turnaround, u)
    }, 0)) : (this._extendRange(i + 10), f = this, setTimeout(function () {
        f.recreateSources(r.symbol, r.resolution, t, !0)
    }, 0))
};
D79.prototype.updateSeriesTurnaround = function (n, t) {
    this._studiesCache[n] || (this._studiesCache[n] = {});
    this._studiesCache[n].turnaround = t
};
D79.prototype.createSeries = function (n, t, i, r, u, f) {
    function o(n, r, u) {
        e._extrapolationManager.storage(i, n.full_name, t).setLastBarTime(r, u)
    }

    var s = new PineJS.OHLCV, h = this._studiesCache[r], c = h && h.firstBarTime, e;
    this._studiesCache[r] = {symbol: n, resolution: t, studyObject: s, guid: r, type: "series", turnaround: u};
    ChartapiMessagerInstances[i].onSeriesLoading(r, u);
    e = this;
    this._computeStudy(s, n, t, r, [], function (n, s, h) {
        MarketStatusWatcher.onMainSeriesSymbolChanged(h.session, h.timezone, h.expired);
        if (s = e._studiesCache[r], !s)throw"This should never happen";
        var l = e._convertBarsTimeToUnix(n), a = 0 < l.length ? 1e3 * l[0].value[0] : void 0;
        if (0 === l.length || c === a) {
            if (e._logMessage("Series has no more data on server: {0}".format(h.full_name)), e._setEndOfData(i, r, u), 0 === l.length)ChartapiMessagerInstances[i].onSeriesClearData(r, u);
            ChartapiMessagerInstances[i].onSeriesCompleted(r, u, h.data_status)
        } else {
            if (s.firstBarTime = a, o(h, l.length - 1, 1e3 * l[l.length - 1].value[0]), f)ChartapiMessagerInstances[i].onSeriesClearData(r, u);
            ChartapiMessagerInstances[i].onTimescaleUpdate(r, u, l, h, 0);
            ChartapiMessagerInstances[i].onSeriesCompleted(r, u, h.data_status);
            s = e._extrapolationManager.storage(i, h.full_name, t);
            e._pointsetsManager.broadcastPointsetsUpdates(h.full_name, t, n, s, h, function (n, t) {
                ChartapiMessagerInstances[i].onPointsetDataUpdate(n, u, t, h)
            })
        }
    }, function (n, t, f, s, h) {
        var c = e._convertBarsTimeToUnix(n);
        if (s = c[c.length - 1], t) {
            if (!e._studiesCache[r])throw"This should never happen";
            t = f - 1;
            e._logMessage("New bar arrived: symbol {0}, bar {1}".format(h.full_name, JSON.stringify(s)));
            ChartapiMessagerInstances[i].onTimescaleUpdate(r, u, [s], h, t);
            o(h, t, 1e3 * s.value[0])
        } else e._logMessage("Last bar update: symbol {0}, bar {1}".format(h.full_name, JSON.stringify(s))), ChartapiMessagerInstances[i].onDataUpdate(r, u, c, void 0, h);
        e._fireEvent("realtime_tick", n[n.length - 1])
    }, function (n) {
        e._logMessage("Series error: {0}".format(n));
        ChartapiMessagerInstances[i].onSeriesError(r, n)
    })
};
D79.prototype.onMoreTickmarksRequested = function (n, t, i, r, u) {
    this._extrapolationManager.storage(n, i.full_name, r).onTickmarksNeeded(i, u)
};
D79.prototype.removePointset = function (n) {
    this._pointsetsManager.removePointset(n)
};
D79.prototype.rebuildExtrapolatedData = function (n, t, i, r, u) {
    this._extrapolationManager.storage(n, r.full_name, i).rebuild(u, r)
};
D79.prototype.createPointset = function (n, t, i, r, u, f) {
    var o = this._extrapolationManager.storage(n, r.full_name, u), e;
    for (f = f.slice(0), e = 0; e < f.length; ++e)f[e][0] = ChartapiMessagerInstances[n].timeInGMT(f[e][0], PineJsCalendar.get_timezone(r.timezone));
    this._pointsetsManager.createPointset(t, i, u, f, o, r)
};
D79.prototype.studiesMetadata = function () {
    return 0 === this._metainfoCache.length && (this._metainfoCache = D82.studyLibrary.map(function (n) {
        return n.metainfo
    })), this._metainfoCache
};
D79.prototype.searchSymbolsByName = function (n, t, i, r) {
    this._logMessage("Symbol search requested: user input `{0}`, exchange: `{1}`, type `{2}`".format(n, t, i));
    var u = this;
    this._externalDatafeed.searchSymbolsByName(n, t, i, function (n) {
        u._logMessage("Symbol search response: {0}".format(JSON.stringify(n)));
        r(n)
    })
};
D79.prototype.resolveSymbol = function (n, t, i) {
    function f(n) {
        u._logMessage("Symbol resolve failed: `{0}`, reason: `{1}`".format(r, n));
        i(n)
    }

    var r = PineJSFeed.parseSymbol(n).symbol, u = this;
    this._symbolInfoCache.hasOwnProperty(r) ? t(this._symbolInfoCache[r]) : (this._logMessage("Symbol resolve requested: `{0}` ".format(r)), this._externalDatafeed.resolveSymbol(r, function (n) {
        u._logMessage("Symbol resolved: `{0}`, SymbolInfo in server response {1}".format(r, JSON.stringify(n)));
        n.base_name || (n.base_name = [n.name]);
        n.legs || (n.legs = [n.name]);
        n.exchange || (n.exchange = n["exchange-listed"]);
        n.full_name || (n.full_name = n.symbol || n.exchange + ":" + n.name);
        n.data_status || (n.data_status = "streaming");
        n.ticker || (n.ticker = n.symbol);
        n.id || (n.id = n.id);
        !n.session && n["session-regular"] && (n.session = n["session-regular"]);
        !n.minmov && n.minmovement && (n.minmov = n.minmovement);
        u._logMessage("Symbol info after post-processing: `{0}`, SymbolInfo {1}".format(r, JSON.stringify(n)));
        u._symbolInfoCache[r] = u._symbolInfoCache[n.symbol] = n;
        t(n)
    }, f))
};
D79.prototype._stopQuotesSubscription = function (n) {
    this._quotesInfo[n].listenerGUID && (this._externalDatafeed.unsubscribeQuotes(this._quotesInfo[n].listenerGUID), this._quotesInfo[n].listenerGUID = void 0)
};
D79.prototype._startQuotesSubscription = function (n) {
    function i(t) {
        t.forEach(function (t) {
            t.symbolname = t.n;
            t.status = t.s;
            t.values = t.v;
            t.values.change = t.v.ch;
            t.values.last_price = t.v.lp;
            t.values.change_percent = t.v.chp;
            ChartapiMessagerInstances[n].onQuotesData([n].concat([t]))
        })
    }

    if (0 !== this._quotesInfo[n].symbols.length) {
        var t = this;
        this._externalDatafeed.getQuotes(this._quotesInfo[n].symbols, function (r) {
            i(r);
            t._quotesInfo[n].listenerGUID = n;
            t._externalDatafeed.subscribeQuotes(t._quotesInfo[n].symbols, t._quotesInfo[n].fastSymbols, i, t._quotesInfo[n].listenerGUID)
        })
    }
};
D79.prototype._restartQuotesSubscription = function (n) {
    this._stopQuotesSubscription(n);
    this._startQuotesSubscription(n)
};
D79.prototype.quoteCreateSession = function (n) {
    this._quotesInfo[n] = {symbols: [], fastSymbols: [], listenerGUID: void 0}
};
D79.prototype.quoteDeleteSession = function (n) {
    this._stopQuotesSubscription(n);
    this._quotesInfo[n] = null
};
D79.prototype.quoteSetFields = function () {
};
D79.prototype.quoteAddSymbols = function (n, t) {
    this._quotesInfo[n].symbols = this._filteredSymbols(this._quotesInfo[n].symbols.concat(t));
    this._restartQuotesSubscription(n)
};
D79.prototype.quoteRemoveSymbols = function (n, t) {
    this._quotesInfo[n].symbols = this._quotesInfo[n].symbols.filter(function (n) {
        return 0 > t.indexOf(n)
    });
    this._restartQuotesSubscription(n)
};
D79.prototype.quoteFastSymbols = function (n, t) {
    this._quotesInfo[n].fastSymbols = this._filteredSymbols(t);
    this._restartQuotesSubscription(n)
};
D79.prototype._filteredSymbols = function (n) {
    var t = [];
    return n.forEach(function (n) {
        n instanceof Object || 0 > t.indexOf(n) && t.push(n)
    }), t
};
D79.prototype._isEndOfData = function (n, t, i) {
    return!!this._endOfData[n + "!" + t + "@" + i]
};
D79.prototype._setEndOfData = function (n, t, i) {
    this._endOfData[n + "!" + t + "@" + i] = !0
};
MetainfoTuner = function () {
    function n(n) {
        J77.enabled("charting_library_debug_mode") && console.warn("Overrides:" + n)
    }

    var u = {"volume.volume.transparency": "volume.!transparency"}, r = {}, t, i;
    if (Object.keys(TradingView.StudyConsts).forEach(function (n) {
        0 == n.indexOf("PLOT_") && 0 != n.indexOf("PLOT_TYPE_") && (r[n.toLowerCase().substring(5)] = TradingView.StudyConsts[n])
    }), t = {setProperty: function (t, i) {
        var o, s, f, e, l, c, h;
        t = u[t] || t;
        o = t.split(".");
        n:{
            for (s = o[0], f = D82.studyLibrary, e = 0; e < f.length; ++e)if (l = f[e].metainfo, l.description.toLowerCase() == s.toLowerCase() || l.shortDescription.toLowerCase() == s.toLowerCase()) {
                s = l;
                break n
            }
            s = null
        }
        if (s)if (0 == o[1].indexOf("!"))s[o[1].slice(1)] = i; else {
            n:{
                f = s;
                e = o[1];
                for (c in f.styles)if (f.styles[c].title.toLowerCase() == e.toLowerCase())break n;
                c = null
            }
            n:{
                for (f = s, e = o[1], l = 0; l < f.inputs.length; ++l)if (f.inputs[l].name.toLowerCase() == e.toLowerCase()) {
                    f = {id: f.inputs[l].id, index: l};
                    break n
                }
                f = null
            }
            if (e = "options" == o[1], c || f || e)if (c && f || c && e || f && e)n("Study `{0}`: ambiguous identifier `{1}`".format(o[0], o[1])); else if (c)if (f = i, e = o[2], "color" == e) {
                n:{
                    for (h in s.plots)if ("colorer" == s.plots[h].type && s.plots[h].target == c) {
                        h = s.defaults.palettes[s.plots[h].palette];
                        break n
                    }
                    h = null
                }
                e = 3 < o.length ? parseInt(o[3]) : NaN;
                null == h && !isNaN(e) && 0 < e ? n("Plot `{1}` of `{0}` does not have color #{2}".format(o[0], o[1], e)) : 0 == e || isNaN(e) ? (s.defaults.styles[c].color = f, null != h && (h.colors[0].color = f)) : h.colors[e].color = f
            } else s.defaults.styles[c].hasOwnProperty(e) ? ("plottype" == e && (f = r[f]), s.defaults.styles[c][e] = f) : n("Plot `{1}` of `{0}` does not have property `{2}`".format(o[0], o[1], e)); else f ? (o = s, h = f.index, o.defaults.inputs[f.id] = i, o.inputs[h].defval = i) : s[o[2]] = i; else n("Study `{0}` has no plot or input `{1}`".format(o[0], o[1]))
        } else n("Study `{0}` not found".format(o[0]))
    }}, "undefined" != typeof __initialMetainfoOverrides && __initialMetainfoOverrides)for (i in __initialMetainfoOverrides)t.setProperty(i, __initialMetainfoOverrides[i]);
    return t
}();
MarketStatusWatcher = function () {
    function t() {
        if (n)if (r)Q3.Q0.mainSeries().marketStatus.setValue("out_of_session"); else {
            var t = new Date, t = t.valueOf() - 60 * t.getTimezoneOffset(), t = PineJsBarBuilder.isTradingNow(t, n) ? "market" : "out_of_session";
            Q3.Q0.mainSeries().marketStatus.setValue(t)
        }
    }

    var i = {}, n, r;
    return i.onMainSeriesSymbolChanged = function (i, u, f) {
        u = PineJsCalendar.get_timezone(u);
        n = (new PineJsBarBuilder.Session).init(u, i);
        r = f;
        t()
    }, setInterval(t, 6e4), i
}();
_89 = function () {
};
TradingView.study_PivotPointsStandard = function () {
};
TradingView.study_PivotPointsHighLow = function () {
};
TradingView.study_ZigZag = function () {
};
TradingView.study_LinearRegression = function () {
};
TradingView.study_ElliottWave = function () {
};
TradingView.ESDStudyBase = function () {
};
D55 = function () {
    this.hasPackage = function () {
        return!1
    }
};
user = {is_pro: !1, settings: {}};
D55.prototype.getStudies = function () {
    return[]
};
D55.prototype.getProduct = function () {
    return{}
};
D55.prototype.getStudiesOrder = function () {
    return[]
};
TradingView.LineToolRegressionTrend = function () {
};
TradingView.templates = {dialogs: {addSymbol: ' <div class="main"> <div class="symbol-edit-place"><\/div>{{#overlayOption}} <div class="tv-dialog-relative">\t<input id="tv-dialog-addsymbol-overlay-checkbox" type="checkbox" name="addsymbol-overlay" {{#overlayOptionChecked}}checked="checked"{{/overlayOptionChecked}} />\t<span class="tv-dialog-checkbox-mask tv-dialog-checkbox-mask{{#overlayOptionChecked}}-active{{/overlayOptionChecked}}"><\/span>\t<label for="tv-dialog-addsymbol-overlay-checkbox"> Overlay the main chart<\/label> <\/div>{{/overlayOption}} <div class="tv-dialogs-bottom-button"> <span class="tv-button tv-right tv-uppercase ok">{{okButtonTitle}}<\/span> <\/div> <\/div>', symbolSearch: '<div class="symbol-block"><div class="spread-actions"><\/div><div class="symbol-block-inputspacer"><input maxlength="' + TradingView.SYMBOL_SEARCH_MAX_LENGTH + '" /><div class="search-cion"><\/div><\/div><\/div><div class="filter"><\/div><div class="results"><\/div>'}};
TradingView.AlertLabel = function () {
};
TradingView.getDataVendorString = function () {
};
D72 = {sendReport: function () {
}};
TradingView.study_VbPVisible = function () {
};
TradingView.study_VbPSessions = function () {
};
TradingView.LineToolVbPFixed = function () {
};
MockupRequestedCache = function (n) {
    n && n([])
};
MockupRequestedCache.Q20 = function () {
};
TradingView.getStudyTemplatesList = MockupRequestedCache;
TradingView.getThemesList = MockupRequestedCache;
urlParams = function () {
    for (var i, f = /\+/g, e = /([^&=]+)=?([^&]*)/g, u = function (n) {
        return decodeURIComponent(n.replace(f, " "))
    }, o = window.location.hash.substring(1), n = {}, r, t; i = e.exec(o);)n[u(i[1])] = u(i[2]);
    r = window.parent[n.uid];
    for (t in r)t != "datafeed" && (n[t] = JSON.stringify(r[t]));
    return n
}();
var customIndicatorsPresent = !!urlParams.indicatorsFile, customIndicatorsLodaded = $.Deferred(), chartApiInitializationTimePassed = $.Deferred();
$.when(customIndicatorsLodaded, chartApiInitializationTimePassed).done(function () {
    Q16.start()
});
customIndicatorsPresent ? $.getScript(urlParams.indicatorsFile).done(function () {
    typeof __customIndicators != "undefined" && isArray(__customIndicators) && (D82.studyLibrary = D82.studyLibrary.concat(__customIndicators), console.log("{0} custom indicators loaded.".format(__customIndicators.length)), customIndicatorsLodaded.resolve())
}).fail(function (n) {
    console.warn("Error loading custom indicators @ `{0}`: {1} ({2}) ".format(urlParams.indicatorsFile, n.statusText, n.status));
    customIndicatorsLodaded.resolve()
}) : customIndicatorsLodaded.resolve();
pm = TradingView.postMessageWrapper(window.parent);
pm.__delayedMesssages = [];
pm.on("widgetReady", function (n, t) {
    pm.__delayedMesssages.push({data: n, cb: t})
});
localizationReady = $.Deferred();
datafeedReady = $.Deferred();
$.when(localizationReady, datafeedReady).done(function () {
    if (createChart(), J77.enabled("google_analytics")) {
        (function (n, t, i, r, u, f, e) {
            n.GoogleAnalyticsObject = u;
            n[u] = n[u] || function () {
                (n[u].q = n[u].q || []).push(arguments)
            };
            n[u].l = 1 * new Date;
            f = t.createElement(i);
            e = t.getElementsByTagName(i)[0];
            f.async = 1;
            f.src = r;
            e.parentNode.insertBefore(f, e)
        })(window, document, "script", "//www.google-analytics.com/analytics.js", "ga");
        var n = document.URL.match(new RegExp("(:?.*://)([^/]+)/.*"))[2];
        ga("create", "UA-53174009-1", "auto");
        ga("set", {hostname: n, page: n, referrer: n});
        ga("send", "pageview")
    }
});
window.parent[urlParams.uid].datafeed.onReady(function () {
    datafeedReady.resolve()
});
$(function () {
    var n = {lng: urlParams.locale, load: "unspecific", resGetPath: "localization/translations/__lng__.json", keyseparator: "@", nsseparator: "@", fallbackLng: "en"};
    $.i18n.init(n, function () {
        $("html").i18n();
        localizationReady.resolve();
        $(window).resize();
        $(".loading-indicator").hide()
    })
});
g_days = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
j_days = [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29];
JalaliDate = {g_days_in_month: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], j_days_in_month: [31, 31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 29]};
JalaliDate.jalaliToGregorian = function (n, t, i) {
    var r, f, e, u, h, c;
    n = parseInt(n);
    t = parseInt(t);
    i = parseInt(i);
    var o = n - 979, l = t - 1, a = i - 1, s = 365 * o + parseInt(o / 33) * 8 + parseInt((o % 33 + 3) / 4);
    for (u = 0; u < l; ++u)s += JalaliDate.j_days_in_month[u];
    for (s += a, r = s + 79, f = 1600 + 400 * parseInt(r / 146097), r = r % 146097, e = !0, r >= 36525 && (r--, f += 100 * parseInt(r / 36524), r = r % 36524, r >= 365 ? r++ : e = !1), f += 4 * parseInt(r / 1461), r %= 1461, r >= 366 && (e = !1, r--, f += parseInt(r / 365), r = r % 365), u = 0; r >= JalaliDate.g_days_in_month[u] + (u == 1 && e); u++)r -= JalaliDate.g_days_in_month[u] + (u == 1 && e);
    return h = u + 1, c = r + 1, [f, h, c]
};
JalaliDate.checkDate = function (n, t, i) {
    return!(n < 0 || n > 32767 || t < 1 || t > 12 || i < 1 || i > JalaliDate.j_days_in_month[t - 1] + (t == 12 && !((n - 979) % 33 % 4)))
};
JalaliDate.gregorianToJalali = function (n, t, i) {
    var r, h, o, u, c, l;
    n = parseInt(n);
    t = parseInt(t);
    i = parseInt(i);
    var f = n - 1600, s = t - 1, a = i - 1, e = 365 * f + parseInt((f + 3) / 4) - parseInt((f + 99) / 100) + parseInt((f + 399) / 400);
    for (u = 0; u < s; ++u)e += JalaliDate.g_days_in_month[u];
    for (s > 1 && (f % 4 == 0 && f % 100 != 0 || f % 400 == 0) && ++e, e += a, r = e - 79, h = parseInt(r / 12053), r %= 12053, o = 979 + 33 * h + 4 * parseInt(r / 1461), r %= 1461, r >= 366 && (o += parseInt((r - 1) / 365), r = (r - 1) % 365), u = 0; u < 11 && r >= JalaliDate.j_days_in_month[u]; ++u)r -= JalaliDate.j_days_in_month[u];
    return c = u + 1, l = r + 1, [o, c, l]
};