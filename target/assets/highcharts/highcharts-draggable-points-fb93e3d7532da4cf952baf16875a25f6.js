(function(e){function i(e,t,n){var i=t.options,s=r(i["dragMin"+n],undefined),o=r(i["dragMax"+n],undefined);if(e<s){e=s}else if(e>o){e=o}return e}var t=e.addEvent,n=e.each,r=e.pick;e.dragdrop={mouseDown:function(e,t){var n=t.hoverPoint,r;if(n){r=n.series.options;if(r.draggableX){dragPoint=n;dragX=e.changedTouches?e.changedTouches[0].pageX:e.pageX;dragPlotX=dragPoint.plotX}if(r.draggableY){dragPoint=n;dragY=e.changedTouches?e.changedTouches[0].pageY:e.pageY;dragPlotY=dragPoint.plotY+(t.plotHeight-(dragPoint.yBottom||t.plotHeight))}if(dragPoint){t.mouseIsDown=false}}}};e.Chart.prototype.callbacks.push(function(e){function f(t){if(r){if(t){var n=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:t.pageX,f=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageY:t.pageY,l=r.draggableX,c=r.draggableY,h=s-n,p=o-f,d=r.series,v=d.type==="bubble"||d.type==="scatter",m=v?u-h:u-h-r.series.xAxis.minPixelPadding,g=e.plotHeight-a+p,y=s===undefined?r.x:r.series.xAxis.translate(m,true),b=o===undefined?r.y:r.series.yAxis.translate(g,true);y=i(y,d,"X");b=i(b,d,"Y");r.update({x:l?y:r.x,y:c?b:r.y})}r.firePointEvent("drop")}r=s=o=undefined}var n=e.container,r,s,o,u,a;e.redraw();t(n,"mousedown touchstart",function(t){var n=e.hoverPoint;if(n){if(n.draggableX){r=n;s=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:t.pageX;u=r.plotX}if(n.draggableY){r=n;o=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageY:t.pageY;a=r.plotY+(e.plotHeight-(r.yBottom||e.plotHeight))}if(r){e.mouseIsDown=false}}});t(n,"mousemove touchmove",function(t){t.preventDefault();if(r){var n=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageX:t.pageX,l=t.originalEvent.changedTouches?t.originalEvent.changedTouches[0].pageY:t.pageY,c=o-l,h=s-n,p=r.draggableX,d=r.draggableY,v=r.series,m=v.type==="bubble"||v.type==="scatter",g=m?u-h:u-h-r.series.xAxis.minPixelPadding,y=e.plotHeight-a+c,b=s===undefined?r.x:r.series.xAxis.translate(g,true),w=o===undefined?r.y:r.series.yAxis.translate(y,true),E;b=i(b,v,"X");w=i(w,v,"Y");r.firePointEvent("drag",{newX:p?b:r.x,newY:d?w:r.y},function(){E=true;r.update({x:p?b:r.x,y:d?w:r.y},false);if(e.tooltip){e.tooltip.refresh(e.tooltip.shared?[r]:r)}if(v.stackKey){e.redraw()}else{v.redraw()}});if(!E){f()}}});t(document,"mouseup touchend",f);t(n,"mouseleave",f)});e.wrap(e.seriesTypes.column.prototype,"drawTracker",function(e){var t=this;e.apply(t);n(t.points,function(e){if(e.draggableX||e.draggableY){e.graphic.attr(e.shapeArgs.height<3?{stroke:"black","stroke-width":2,dashstyle:"shortdot"}:{"stroke-width":t.options.borderWidth,dashstyle:t.options.dashStyle||"solid"})}})});e.wrap(e.seriesTypes.line.prototype,"drawTracker",function(e){var t=this;e.apply(t);n(t.points,function(e){if(e.draggableX||e.draggableY){}})})})(Highcharts)