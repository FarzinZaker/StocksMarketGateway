(function(e){"use strict";var t=e.getOptions(),n=t.plotOptions,r=e.seriesTypes,i=e.merge,s=function(){},o=e.each;n.funnel=i(n.pie,{animation:false,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:false,dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:true,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});r.funnel=e.extendClass(r.pie,{type:"funnel",animate:s,singularTooltips:true,translate:function(){var e=function(e,t){return/%$/.test(e)?t*parseInt(e,10)/100:parseInt(e,10)},t=0,n=this,r=n.chart,i=n.options,u=i.reversed,a=r.plotWidth,f=r.plotHeight,l=0,c=i.center,h=e(c[0],a),p=e(c[0],f),d=e(i.width,a),v,m,g=e(i.height,f),y=e(i.neckWidth,a),b=e(i.neckHeight,f),w=g-b,E=n.data,S,x,T=i.dataLabels.position==="left"?1:0,N,C,k,L,A,O,M;n.getWidthAt=m=function(e){return e>g-b||g===b?y:y+(d-y)*((g-b-e)/(g-b))};n.getX=function(e,t){return h+(t?-1:1)*(m(u?f-e:e)/2+i.dataLabels.distance)};n.center=[h,p,g];n.centerX=h;o(E,function(e){t+=e.y});o(E,function(e){M=null;x=t?e.y/t:0;C=p-g/2+l*g;A=C+x*g;v=m(C);N=h-v/2;k=N+v;v=m(A);L=h-v/2;O=L+v;if(C>w){N=L=h-y/2;k=O=h+y/2}else if(A>w){M=A;v=m(w);L=h-v/2;O=L+v;A=w}if(u){C=g-C;A=g-A;M=M?g-M:null}S=["M",N,C,"L",k,C,O,A];if(M){S.push(O,M,L,M)}S.push(L,A,"Z");e.shapeType="path";e.shapeArgs={d:S};e.percentage=x*100;e.plotX=h;e.plotY=(C+(M||A))/2;e.tooltipPos=[h,e.plotY];e.slice=s;e.half=T;l+=x})},drawPoints:function(){var e=this,t=e.options,n=e.chart,r=n.renderer;o(e.data,function(n){var i=n.graphic,s=n.shapeArgs;if(!i){n.graphic=r.path(s).attr({fill:n.color,stroke:t.borderColor,"stroke-width":t.borderWidth}).add(e.group)}else{i.animate(s)}})},sortByAngle:function(e){e.sort(function(e,t){return e.plotY-t.plotY})},drawDataLabels:function(){var e=this.data,t=this.options.dataLabels.distance,n,i,s,o=e.length,u,a;this.center[2]-=2*t;while(o--){s=e[o];n=s.half;i=n?1:-1;a=s.plotY;u=this.getX(a,n);s.labelPos=[0,a,u+(t-5)*i,a,u+t*i,a,n?"right":"left",0]}r.pie.prototype.drawDataLabels.call(this)}});t.plotOptions.pyramid=e.merge(t.plotOptions.funnel,{neckWidth:"0%",neckHeight:"0%",reversed:true});e.seriesTypes.pyramid=e.extendClass(e.seriesTypes.funnel,{type:"pyramid"})})(Highcharts)