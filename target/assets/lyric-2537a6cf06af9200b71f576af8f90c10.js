function buildModel(e,t){if(!t)t=DEFAULT_POLYNOMIAL_DEGREE;var n=generateInputMatrix(e["x"],t);var r=$M(e["y"]);var i=generateTheta(n,r);return i}function applyModel(e,t,n){if(!n)n=DEFAULT_POLYNOMIAL_DEGREE;var r=generateInputMatrix(e["x"],n).transpose();var s=r.x(t).transpose();var o=new Array;for(i=0;i<e["x"].length;i++){if(e["label"])o[i]={x:e["label"][i],y:s.e(1,i+1)};else o[i]={x:e["x"][i],y:s.e(1,i+1)}}return o}function generateTheta(e,t){Xt=e.transpose();var n=e.x(Xt);var r=n.inverse();var i=e.x(t);var s=r.x(i);return s}function generateInputMatrix(e,t){var n=[];for(i=0;i<e.length;i++){n[i]=1}var r=[];r[0]=n;r[1]=e;var s=$M(e);r[2]=matrixPower(s,2).transpose().elements[0];for(i=3;i<=t;i++){r[i]=matrixPower(s,i).transpose().elements[0]}var o=$M(r);return o}function matrixPower(e,t){var n=Matrix.Zero(e.rows(),e.cols());for(row=1;row<=e.rows();row++){for(col=1;col<=e.cols();col++){var r=e.e(row,col);r=Math.pow(r,t);n.elements[row-1][col-1]=r}}return n}function ordinalize(e){var t=[];t["x"]=[];t["y"]=[];t["label"]=[];$.each(e["x"],function(n,r){t["label"][n]=e["x"][n];t["x"][n]=n;t["y"][n]=e["y"][n]});return t}function applyRegression(e,t,n){var r=[];r["x"]=[];r["y"]=[];for(var i=0;i<e.length;i++){r["x"][i]=i;r["y"][i]=e.dataset[serieIndex].data[i].value.toString()}var s=buildModel(r,t);var o=[];o["x"]=[];for(i=0;i<n;i++){o["x"][i]=e.dataset[serieIndex].data.length-n+i}var u=applyModel(o,s,t);for(i=0;i<n;i++){e.dataset[serieIndex].data[e.dataset[serieIndex].data.length-n+i].value=u[i].y}return e}var DEFAULT_POLYNOMIAL_DEGREE=2